!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("mux.js"),require("tippy.js"),require("popper.js")):"function"==typeof define&&define.amd?define(["react","mux.js","tippy.js","popper.js"],t):"object"==typeof exports?exports.shakaplayer=t(require("react"),require("mux.js"),require("tippy.js"),require("popper.js")):e.shakaplayer=t(e.react,e["mux.js"],e["tippy.js"],e["popper.js"])}(this,function(__WEBPACK_EXTERNAL_MODULE__0__,__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__5__,__WEBPACK_EXTERNAL_MODULE__13__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__0__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(module,__webpack_exports__,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */__webpack_require__.d(__webpack_exports__,"a",function(){return ShakaDemoUtils});var ShakaDemoUtils=function(){function ShakaDemoUtils(){_classCallCheck(this,ShakaDemoUtils)}return _createClass(ShakaDemoUtils,null,[{key:"runThroughHashParams",value:function(e,t){var n=[],r=function(t,r){n.push(r),e(t,r)};r("audiolang","preferredAudioLanguage"),r("textlang","preferredTextLanguage"),r("channels","preferredAudioChannelCount"),n.push("abr.enabled"),n.push("streaming.jumpLargeGaps"),n.push("drm.advanced"),n.push("drm.servers");var i=[],a=[];!function e(t){for(var n in t){i.includes(n)&&!a.includes(n)&&a.push(n),i.push(n);var r=t[n];"number"!=typeof r&&"string"!=typeof r&&"boolean"!=typeof r&&e(r)}}(t);!function t(r,i){for(var s in r){var o=s,l=i+s;if(!n.includes(l)){a.includes(s)&&(o=l);var u=r[s];"number"==typeof u||"string"==typeof u||"boolean"==typeof u?e(o,l):t(u,l+".")}}}(t,"")}},{key:"browserSupportsUncompiledMode",value:function browserSupportsUncompiledMode(){try{return eval("async ()=>{}"),!0}catch(e){return!1}}}]),ShakaDemoUtils}()},function(e,t,n){!function(){function t(e){var t=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};this.label=t.label||t.value,this.value=t.value}function n(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function r(e,t){return s.call((t||document).querySelectorAll(e))}function i(){r("input.awesomplete").forEach(function(e){new a(e)})}var a=function(e,t){var r=this;Awesomplete.count=(Awesomplete.count||0)+1,this.count=Awesomplete.count,this.isOpened=!1,this.input=n(e),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns","awesomplete_list_"+this.count),this.input.setAttribute("role","combobox"),t=t||{},function(e,t,n){for(var r in t){var i=t[r],a=e.input.getAttribute("data-"+r.toLowerCase());"number"==typeof i?e[r]=parseInt(a):!1===i?e[r]=null!==a:i instanceof Function?e[r]=null:e[r]=a,e[r]||0===e[r]||(e[r]=r in n?n[r]:i)}}(this,{minChars:2,maxItems:10,autoFirst:!1,data:a.DATA,filter:a.FILTER_CONTAINS,sort:!1!==t.sort&&a.SORT_BYLENGTH,item:a.ITEM,replace:a.REPLACE},t),this.index=-1,this.container=n.create("div",{className:"awesomplete",around:e}),this.ul=n.create("ul",{hidden:"hidden",role:"listbox",id:"awesomplete_list_"+this.count,inside:this.container}),this.status=n.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!=this.minChars?"Type "+this.minChars+" or more characters for results.":"Begin typing for results."}),this._events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown:function(e){var t=e.keyCode;r.opened&&(13===t&&r.selected?(e.preventDefault(),r.select()):27===t?r.close({reason:"esc"}):38!==t&&40!==t||(e.preventDefault(),r[38===t?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown:function(e){e.preventDefault()},click:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),r.select(t,e.target))}}}},n.bind(this.input,this._events.input),n.bind(this.input.form,this._events.form),n.bind(this.ul,this._events.ul),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||t.list||[],a.all.push(this)};a.prototype={set list(e){if(Array.isArray(e))this._list=e;else if("string"==typeof e&&e.indexOf(",")>-1)this._list=e.split(/\s*,\s*/);else if((e=n(e))&&e.children){var t=[];s.apply(e.children).forEach(function(e){if(!e.disabled){var n=e.textContent.trim(),r=e.value||n,i=e.label||n;""!==r&&t.push({label:i,value:r})}}),this._list=t}document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return this.isOpened},close:function(e){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),n.fire(this.input,"awesomplete-close",e||{}))},open:function(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),n.fire(this.input,"awesomplete-open")},destroy:function(){n.unbind(this.input,this._events.input),n.unbind(this.input.form,this._events.form);var e=this.container.parentNode;e.insertBefore(this.input,this.container),e.removeChild(this.container),this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");var t=a.all.indexOf(this);-1!==t&&a.all.splice(t,1)},next:function(){var e=this.ul.children.length;this.goto(this.index<e-1?this.index+1:e?0:-1)},previous:function(){var e=this.ul.children.length,t=this.index-1;this.goto(this.selected&&-1!==t?t:e-1)},goto:function(e){var t=this.ul.children;this.selected&&t[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&t.length>0&&(t[e].setAttribute("aria-selected","true"),this.status.textContent=t[e].textContent+", list item "+(e+1)+" of "+t.length,this.input.setAttribute("aria-activedescendant",this.ul.id+"_item_"+this.index),this.ul.scrollTop=t[e].offsetTop-this.ul.clientHeight+t[e].clientHeight,n.fire(this.input,"awesomplete-highlight",{text:this.suggestions[this.index]}))},select:function(e,t){if(e?this.index=n.siblingIndex(e):e=this.ul.children[this.index],e){var r=this.suggestions[this.index];n.fire(this.input,"awesomplete-select",{text:r,origin:t||e})&&(this.replace(r),this.close({reason:"select"}),n.fire(this.input,"awesomplete-selectcomplete",{text:r}))}},evaluate:function(){var e=this,n=this.input.value;n.length>=this.minChars&&this._list&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.map(function(r){return new t(e.data(r,n))}).filter(function(t){return e.filter(t,n)}),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems),this.suggestions.forEach(function(t,r){e.ul.appendChild(e.item(t,n,r))}),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=this.ul.children.length+" results found")):(this.close({reason:"nomatches"}),this.status.textContent="No results found")}},a.all=[],a.FILTER_CONTAINS=function(e,t){return RegExp(n.regExpEscape(t.trim()),"i").test(e)},a.FILTER_STARTSWITH=function(e,t){return RegExp("^"+n.regExpEscape(t.trim()),"i").test(e)},a.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:e<t?-1:1},a.ITEM=function(e,t,r){return n.create("li",{innerHTML:""===t.trim()?e:e.replace(RegExp(n.regExpEscape(t.trim()),"gi"),"<mark>$&</mark>"),"aria-selected":"false",id:"awesomplete_list_"+this.count+"_item_"+r})},a.REPLACE=function(e){this.input.value=e.value},a.DATA=function(e){return e},Object.defineProperty(t.prototype=Object.create(String.prototype),"length",{get:function(){return this.label.length}}),t.prototype.toString=t.prototype.valueOf=function(){return""+this.label};var s=Array.prototype.slice;n.create=function(e,t){var r=document.createElement(e);for(var i in t){var a=t[i];if("inside"===i)n(a).appendChild(r);else if("around"===i){var s=n(a);s.parentNode.insertBefore(r,s),r.appendChild(s)}else i in r?r[i]=a:r.setAttribute(i,a)}return r},n.bind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.addEventListener(t,r)})}},n.unbind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.removeEventListener(t,r)})}},n.fire=function(e,t,n){var r=document.createEvent("HTMLEvents");for(var i in r.initEvent(t,!0,!0),n)r[i]=n[i];return e.dispatchEvent(r)},n.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},n.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?i():document.addEventListener("DOMContentLoaded",i)),a.$=n,a.$$=r,"undefined"!=typeof self&&(self.Awesomplete=a),e.exports&&(e.exports=a)}()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__5__},function(e){e.exports={FULL_SCREEN:"Full screen",EXIT_FULL_SCREEN:"Exit full screen",FAST_FORWARD:"Fast-forward",REWIND:"Rewind",MUTE:"Mute",UNMUTE:"Unmute",PAUSE:"Pause",PLAY:"Play",SEEK:"Seek",VOLUME:"Volume",SKIP_TO_LIVE:"Skip ahead to live",LIVE:"Live",MORE_SETTINGS:"More settings",BACK:"Back",CAPTIONS:"Captions",RESOLUTION:"Resolution",AUTO_QUALITY:"Auto",CAST:"Cast...",LANGUAGE:"Language",UNRECOGNIZED_LANGUAGE:"Unrecognized",UNDETERMINED_LANGUAGE:"Undetermined",MULTIPLE_LANGUAGES:"Multiple languages",NOT_APPLICABLE:"Not applicable",ENTER_PICTURE_IN_PICTURE:"Enter Picture-in-Picture",EXIT_PICTURE_IN_PICTURE:"Exit Picture-in-Picture",PICTURE_IN_PICTURE:"Picture-in-Picture",ON:"On",OFF:"Off"}},function(e,t,n){},function(e,t,n){},function(e,t){
/**
 * material-design-lite - Material Design Components in CSS, JS and HTML
 * @version v1.3.0
 * @license Apache-2.0
 * @copyright 2015 Google, Inc.
 * @link https://github.com/google/material-design-lite
 */
!function(){"use strict";function e(e,t){if(e){if(t.element_.classList.contains(t.CssClasses_.MDL_JS_RIPPLE_EFFECT)){var n=document.createElement("span");n.classList.add(t.CssClasses_.MDL_RIPPLE_CONTAINER),n.classList.add(t.CssClasses_.MDL_JS_RIPPLE_EFFECT);var r=document.createElement("span");r.classList.add(t.CssClasses_.MDL_RIPPLE),n.appendChild(r),e.appendChild(n)}e.addEventListener("click",function(n){if("#"===e.getAttribute("href").charAt(0)){n.preventDefault();var r=e.href.split("#")[1],i=t.element_.querySelector("#"+r);t.resetTabState_(),t.resetPanelState_(),e.classList.add(t.CssClasses_.ACTIVE_CLASS),i.classList.add(t.CssClasses_.ACTIVE_CLASS)}})}}function t(e,t,n,r){function i(){var i=e.href.split("#")[1],a=r.content_.querySelector("#"+i);r.resetTabState_(t),r.resetPanelState_(n),e.classList.add(r.CssClasses_.IS_ACTIVE),a.classList.add(r.CssClasses_.IS_ACTIVE)}if(r.tabBar_.classList.contains(r.CssClasses_.JS_RIPPLE_EFFECT)){var a=document.createElement("span");a.classList.add(r.CssClasses_.RIPPLE_CONTAINER),a.classList.add(r.CssClasses_.JS_RIPPLE_EFFECT);var s=document.createElement("span");s.classList.add(r.CssClasses_.RIPPLE),a.appendChild(s),e.appendChild(a)}r.tabBar_.classList.contains(r.CssClasses_.TAB_MANUAL_SWITCH)||e.addEventListener("click",function(t){"#"===e.getAttribute("href").charAt(0)&&(t.preventDefault(),i())}),e.show=i}var n={upgradeDom:function(e,t){},upgradeElement:function(e,t){},upgradeElements:function(e){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(e,t){},register:function(e){},downgradeElements:function(e){}};(n=function(){function e(e,t){for(var n=0;n<o.length;n++)if(o[n].className===e)return void 0!==t&&(o[n]=t),o[n];return!1}function t(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function n(e,n){return-1!==t(e).indexOf(n)}function r(e,t,n){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(e,{bubbles:t,cancelable:n});var r=document.createEvent("Events");return r.initEvent(e,t,n),r}function i(t,n){if(void 0===t&&void 0===n)for(var r=0;r<o.length;r++)i(o[r].className,o[r].cssClass);else{var s=t;if(void 0===n){var l=e(s);l&&(n=l.cssClass)}for(var u=document.querySelectorAll("."+n),c=0;c<u.length;c++)a(u[c],s)}}function a(i,a){if(!("object"==typeof i&&i instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var s=r("mdl-componentupgrading",!0,!0);if(i.dispatchEvent(s),!s.defaultPrevented){var c=t(i),d=[];if(a)n(i,a)||d.push(e(a));else{var h=i.classList;o.forEach(function(e){h.contains(e.cssClass)&&-1===d.indexOf(e)&&!n(i,e.className)&&d.push(e)})}for(var f,p=0,m=d.length;p<m;p++){if(!(f=d[p]))throw new Error("Unable to find a registered component for the given class.");c.push(f.className),i.setAttribute("data-upgraded",c.join(","));var v=new f.classConstructor(i);v[u]=f,l.push(v);for(var g=0,y=f.callbacks.length;g<y;g++)f.callbacks[g](i);f.widget&&(i[f.className]=v);var _=r("mdl-componentupgraded",!0,!1);i.dispatchEvent(_)}}}function s(e){if(e){var t=l.indexOf(e);l.splice(t,1);var n=e.element_.getAttribute("data-upgraded").split(","),i=n.indexOf(e[u].classAsString);n.splice(i,1),e.element_.setAttribute("data-upgraded",n.join(","));var a=r("mdl-componentdowngraded",!0,!1);e.element_.dispatchEvent(a)}}var o=[],l=[],u="mdlComponentConfigInternal_";return{upgradeDom:i,upgradeElement:a,upgradeElements:function e(t){Array.isArray(t)||(t=t instanceof Element?[t]:Array.prototype.slice.call(t));for(var n,r=0,i=t.length;r<i;r++)(n=t[r])instanceof HTMLElement&&(a(n),n.children.length>0&&e(n.children))},upgradeAllRegistered:function(){for(var e=0;e<o.length;e++)i(o[e].className)},registerUpgradedCallback:function(t,n){var r=e(t);r&&r.callbacks.push(n)},register:function(t){var n=!0;void 0===t.widget&&void 0===t.widget||(n=t.widget||t.widget);var r={classConstructor:t.constructor||t.constructor,className:t.classAsString||t.classAsString,cssClass:t.cssClass||t.cssClass,widget:n,callbacks:[]};if(o.forEach(function(e){if(e.cssClass===r.cssClass)throw new Error("The provided cssClass has already been registered: "+e.cssClass);if(e.className===r.className)throw new Error("The provided className has already been registered")}),t.constructor.prototype.hasOwnProperty(u))throw new Error("MDL component classes must not have "+u+" defined as a property.");e(t.classAsString,r)||o.push(r)},downgradeElements:function(e){var t=function(e){l.filter(function(t){return t.element_===e}).forEach(s)};if(e instanceof Array||e instanceof NodeList)for(var n=0;n<e.length;n++)t(e[n]);else{if(!(e instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");t(e)}}}}()).ComponentConfigPublic,n.ComponentConfig,n.Component,n.upgradeDom=n.upgradeDom,n.upgradeElement=n.upgradeElement,n.upgradeElements=n.upgradeElements,n.upgradeAllRegistered=n.upgradeAllRegistered,n.registerUpgradedCallback=n.registerUpgradedCallback,n.register=n.register,n.downgradeElements=n.downgradeElements,window.componentHandler=n,window.componentHandler=n,window.addEventListener("load",function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),n.upgradeAllRegistered()):(n.upgradeElement=function(){},n.register=function(){})}),Date.now||(Date.now=function(){return(new Date).getTime()},Date.now=Date.now);for(var r=["webkit","moz"],i=0;i<r.length&&!window.requestAnimationFrame;++i){var a=r[i];window.requestAnimationFrame=window[a+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a+"CancelAnimationFrame"]||window[a+"CancelRequestAnimationFrame"],window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var s=0;window.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(s+16,t);return setTimeout(function(){e(s=n)},n-t)},window.cancelAnimationFrame=clearTimeout,window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}var o=function(e){this.element_=e,this.init()};window.MaterialButton=o,o.prototype.Constant_={},o.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},o.prototype.blurHandler_=function(e){e&&this.element_.blur()},o.prototype.disable=function(){this.element_.disabled=!0},o.prototype.disable=o.prototype.disable,o.prototype.enable=function(){this.element_.disabled=!1},o.prototype.enable=o.prototype.enable,o.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),e.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(e)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},n.register({constructor:o,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0});var l=function(e){this.element_=e,this.init()};window.MaterialCheckbox=l,l.prototype.Constant_={TINY_TIMEOUT:.001},l.prototype.CssClasses_={INPUT:"mdl-checkbox__input",BOX_OUTLINE:"mdl-checkbox__box-outline",FOCUS_HELPER:"mdl-checkbox__focus-helper",TICK_OUTLINE:"mdl-checkbox__tick-outline",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-checkbox__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded"},l.prototype.onChange_=function(e){this.updateClasses_()},l.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},l.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},l.prototype.onMouseUp_=function(e){this.blur_()},l.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},l.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},l.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},l.prototype.checkToggleState=l.prototype.checkToggleState,l.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},l.prototype.checkDisabled=l.prototype.checkDisabled,l.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},l.prototype.disable=l.prototype.disable,l.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},l.prototype.enable=l.prototype.enable,l.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},l.prototype.check=l.prototype.check,l.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},l.prototype.uncheck=l.prototype.uncheck,l.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("span");e.classList.add(this.CssClasses_.BOX_OUTLINE);var t=document.createElement("span");t.classList.add(this.CssClasses_.FOCUS_HELPER);var n=document.createElement("span");if(n.classList.add(this.CssClasses_.TICK_OUTLINE),e.appendChild(n),this.element_.appendChild(t),this.element_.appendChild(e),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(r),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementMouseUp),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:l,classAsString:"MaterialCheckbox",cssClass:"mdl-js-checkbox",widget:!0});var u=function(e){this.element_=e,this.init()};window.MaterialIconToggle=u,u.prototype.Constant_={TINY_TIMEOUT:.001},u.prototype.CssClasses_={INPUT:"mdl-icon-toggle__input",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-icon-toggle__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},u.prototype.onChange_=function(e){this.updateClasses_()},u.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},u.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},u.prototype.onMouseUp_=function(e){this.blur_()},u.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},u.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},u.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},u.prototype.checkToggleState=u.prototype.checkToggleState,u.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},u.prototype.checkDisabled=u.prototype.checkDisabled,u.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},u.prototype.disable=u.prototype.disable,u.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},u.prototype.enable=u.prototype.enable,u.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},u.prototype.check=u.prototype.check,u.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},u.prototype.uncheck=u.prototype.uncheck,u.prototype.init=function(){if(this.element_){if(this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.element_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.JS_RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(e),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementOnMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementOnMouseUp),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},n.register({constructor:u,classAsString:"MaterialIconToggle",cssClass:"mdl-js-icon-toggle",widget:!0});var c=function(e){this.element_=e,this.init()};window.MaterialMenu=c,c.prototype.Constant_={TRANSITION_DURATION_SECONDS:.3,TRANSITION_DURATION_FRACTION:.8,CLOSE_TIMEOUT:150},c.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32,UP_ARROW:38,DOWN_ARROW:40},c.prototype.CssClasses_={CONTAINER:"mdl-menu__container",OUTLINE:"mdl-menu__outline",ITEM:"mdl-menu__item",ITEM_RIPPLE_CONTAINER:"mdl-menu__item-ripple-container",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_UPGRADED:"is-upgraded",IS_VISIBLE:"is-visible",IS_ANIMATING:"is-animating",BOTTOM_LEFT:"mdl-menu--bottom-left",BOTTOM_RIGHT:"mdl-menu--bottom-right",TOP_LEFT:"mdl-menu--top-left",TOP_RIGHT:"mdl-menu--top-right",UNALIGNED:"mdl-menu--unaligned"},c.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),this.container_=e;var t=document.createElement("div");t.classList.add(this.CssClasses_.OUTLINE),this.outline_=t,e.insertBefore(t,this.element_);var n=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for"),r=null;n&&((r=document.getElementById(n))&&(this.forElement_=r,r.addEventListener("click",this.handleForClick_.bind(this)),r.addEventListener("keydown",this.handleForKeyboardEvent_.bind(this))));var i=this.element_.querySelectorAll("."+this.CssClasses_.ITEM);this.boundItemKeydown_=this.handleItemKeyboardEvent_.bind(this),this.boundItemClick_=this.handleItemClick_.bind(this);for(var a=0;a<i.length;a++)i[a].addEventListener("click",this.boundItemClick_),i[a].tabIndex="-1",i[a].addEventListener("keydown",this.boundItemKeydown_);if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT))for(this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),a=0;a<i.length;a++){var s=i[a],o=document.createElement("span");o.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);var l=document.createElement("span");l.classList.add(this.CssClasses_.RIPPLE),o.appendChild(l),s.appendChild(o),s.classList.add(this.CssClasses_.RIPPLE_EFFECT)}this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT),this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT),this.element_.classList.contains(this.CssClasses_.TOP_LEFT)&&this.outline_.classList.add(this.CssClasses_.TOP_LEFT),this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)&&this.outline_.classList.add(this.CssClasses_.TOP_RIGHT),this.element_.classList.contains(this.CssClasses_.UNALIGNED)&&this.outline_.classList.add(this.CssClasses_.UNALIGNED),e.classList.add(this.CssClasses_.IS_UPGRADED)}},c.prototype.handleForClick_=function(e){if(this.element_&&this.forElement_){var t=this.forElement_.getBoundingClientRect(),n=this.forElement_.parentElement.getBoundingClientRect();this.element_.classList.contains(this.CssClasses_.UNALIGNED)||(this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?(this.container_.style.right=n.right-t.right+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"):this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.bottom=n.bottom-t.top+"px"):this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(this.container_.style.right=n.right-t.right+"px",this.container_.style.bottom=n.bottom-t.top+"px"):(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"))}this.toggle(e)},c.prototype.handleForKeyboardEvent_=function(e){if(this.element_&&this.container_&&this.forElement_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)&&(e.keyCode===this.Keycodes_.UP_ARROW?(e.preventDefault(),t[t.length-1].focus()):e.keyCode===this.Keycodes_.DOWN_ARROW&&(e.preventDefault(),t[0].focus()))}},c.prototype.handleItemKeyboardEvent_=function(e){if(this.element_&&this.container_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");if(t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)){var n=Array.prototype.slice.call(t).indexOf(e.target);if(e.keyCode===this.Keycodes_.UP_ARROW)e.preventDefault(),n>0?t[n-1].focus():t[t.length-1].focus();else if(e.keyCode===this.Keycodes_.DOWN_ARROW)e.preventDefault(),t.length>n+1?t[n+1].focus():t[0].focus();else if(e.keyCode===this.Keycodes_.SPACE||e.keyCode===this.Keycodes_.ENTER){e.preventDefault();var r=new MouseEvent("mousedown");e.target.dispatchEvent(r),r=new MouseEvent("mouseup"),e.target.dispatchEvent(r),e.target.click()}else e.keyCode===this.Keycodes_.ESCAPE&&(e.preventDefault(),this.hide())}}},c.prototype.handleItemClick_=function(e){e.target.hasAttribute("disabled")?e.stopPropagation():(this.closing_=!0,window.setTimeout(function(e){this.hide(),this.closing_=!1}.bind(this),this.Constant_.CLOSE_TIMEOUT))},c.prototype.applyClip_=function(e,t){this.element_.classList.contains(this.CssClasses_.UNALIGNED)?this.element_.style.clip="":this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?this.element_.style.clip="rect(0 "+t+"px 0 "+t+"px)":this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?this.element_.style.clip="rect("+e+"px 0 "+e+"px 0)":this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?this.element_.style.clip="rect("+e+"px "+t+"px "+e+"px "+t+"px)":this.element_.style.clip=""},c.prototype.removeAnimationEndListener_=function(e){e.target.classList.remove(c.prototype.CssClasses_.IS_ANIMATING)},c.prototype.addAnimationEndListener_=function(){this.element_.addEventListener("transitionend",this.removeAnimationEndListener_),this.element_.addEventListener("webkitTransitionEnd",this.removeAnimationEndListener_)},c.prototype.show=function(e){if(this.element_&&this.container_&&this.outline_){var t=this.element_.getBoundingClientRect().height,n=this.element_.getBoundingClientRect().width;this.container_.style.width=n+"px",this.container_.style.height=t+"px",this.outline_.style.width=n+"px",this.outline_.style.height=t+"px";for(var r=this.Constant_.TRANSITION_DURATION_SECONDS*this.Constant_.TRANSITION_DURATION_FRACTION,i=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),a=0;a<i.length;a++){var s;s=this.element_.classList.contains(this.CssClasses_.TOP_LEFT)||this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(t-i[a].offsetTop-i[a].offsetHeight)/t*r+"s":i[a].offsetTop/t*r+"s",i[a].style.transitionDelay=s}this.applyClip_(t,n),window.requestAnimationFrame(function(){this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.element_.style.clip="rect(0 "+n+"px "+t+"px 0)",this.container_.classList.add(this.CssClasses_.IS_VISIBLE)}.bind(this)),this.addAnimationEndListener_();var o=function(t){t===e||this.closing_||t.target.parentNode===this.element_||(document.removeEventListener("click",o),this.hide())}.bind(this);document.addEventListener("click",o)}},c.prototype.show=c.prototype.show,c.prototype.hide=function(){if(this.element_&&this.container_&&this.outline_){for(var e=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),t=0;t<e.length;t++)e[t].style.removeProperty("transition-delay");var n=this.element_.getBoundingClientRect(),r=n.height,i=n.width;this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.applyClip_(r,i),this.container_.classList.remove(this.CssClasses_.IS_VISIBLE),this.addAnimationEndListener_()}},c.prototype.hide=c.prototype.hide,c.prototype.toggle=function(e){this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)?this.hide():this.show(e)},c.prototype.toggle=c.prototype.toggle,n.register({constructor:c,classAsString:"MaterialMenu",cssClass:"mdl-js-menu",widget:!0});var d=function(e){this.element_=e,this.init()};window.MaterialProgress=d,d.prototype.Constant_={},d.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},d.prototype.setProgress=function(e){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=e+"%")},d.prototype.setProgress=d.prototype.setProgress,d.prototype.setBuffer=function(e){this.bufferbar_.style.width=e+"%",this.auxbar_.style.width=100-e+"%"},d.prototype.setBuffer=d.prototype.setBuffer,d.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.className="progressbar bar bar1",this.element_.appendChild(e),this.progressbar_=e,(e=document.createElement("div")).className="bufferbar bar bar2",this.element_.appendChild(e),this.bufferbar_=e,(e=document.createElement("div")).className="auxbar bar bar3",this.element_.appendChild(e),this.auxbar_=e,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},n.register({constructor:d,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0});var h=function(e){this.element_=e,this.init()};window.MaterialRadio=h,h.prototype.Constant_={TINY_TIMEOUT:.001},h.prototype.CssClasses_={IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded",JS_RADIO:"mdl-js-radio",RADIO_BTN:"mdl-radio__button",RADIO_OUTER_CIRCLE:"mdl-radio__outer-circle",RADIO_INNER_CIRCLE:"mdl-radio__inner-circle",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-radio__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple"},h.prototype.onChange_=function(e){for(var t=document.getElementsByClassName(this.CssClasses_.JS_RADIO),n=0;n<t.length;n++){t[n].querySelector("."+this.CssClasses_.RADIO_BTN).getAttribute("name")===this.btnElement_.getAttribute("name")&&void 0!==t[n].MaterialRadio&&t[n].MaterialRadio.updateClasses_()}},h.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},h.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},h.prototype.onMouseup_=function(e){this.blur_()},h.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},h.prototype.blur_=function(){window.setTimeout(function(){this.btnElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},h.prototype.checkDisabled=function(){this.btnElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},h.prototype.checkDisabled=h.prototype.checkDisabled,h.prototype.checkToggleState=function(){this.btnElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},h.prototype.checkToggleState=h.prototype.checkToggleState,h.prototype.disable=function(){this.btnElement_.disabled=!0,this.updateClasses_()},h.prototype.disable=h.prototype.disable,h.prototype.enable=function(){this.btnElement_.disabled=!1,this.updateClasses_()},h.prototype.enable=h.prototype.enable,h.prototype.check=function(){this.btnElement_.checked=!0,this.onChange_(null)},h.prototype.check=h.prototype.check,h.prototype.uncheck=function(){this.btnElement_.checked=!1,this.onChange_(null)},h.prototype.uncheck=h.prototype.uncheck,h.prototype.init=function(){if(this.element_){this.btnElement_=this.element_.querySelector("."+this.CssClasses_.RADIO_BTN),this.boundChangeHandler_=this.onChange_.bind(this),this.boundFocusHandler_=this.onChange_.bind(this),this.boundBlurHandler_=this.onBlur_.bind(this),this.boundMouseUpHandler_=this.onMouseup_.bind(this);var e=document.createElement("span");e.classList.add(this.CssClasses_.RADIO_OUTER_CIRCLE);var t,n=document.createElement("span");if(n.classList.add(this.CssClasses_.RADIO_INNER_CIRCLE),this.element_.appendChild(e),this.element_.appendChild(n),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),(t=document.createElement("span")).classList.add(this.CssClasses_.RIPPLE_CONTAINER),t.classList.add(this.CssClasses_.RIPPLE_EFFECT),t.classList.add(this.CssClasses_.RIPPLE_CENTER),t.addEventListener("mouseup",this.boundMouseUpHandler_);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),t.appendChild(r),this.element_.appendChild(t)}this.btnElement_.addEventListener("change",this.boundChangeHandler_),this.btnElement_.addEventListener("focus",this.boundFocusHandler_),this.btnElement_.addEventListener("blur",this.boundBlurHandler_),this.element_.addEventListener("mouseup",this.boundMouseUpHandler_),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:h,classAsString:"MaterialRadio",cssClass:"mdl-js-radio",widget:!0});var f=function(e){this.element_=e,this.isIE_=window.navigator.msPointerEnabled,this.init()};window.MaterialSlider=f,f.prototype.Constant_={},f.prototype.CssClasses_={IE_CONTAINER:"mdl-slider__ie-container",SLIDER_CONTAINER:"mdl-slider__container",BACKGROUND_FLEX:"mdl-slider__background-flex",BACKGROUND_LOWER:"mdl-slider__background-lower",BACKGROUND_UPPER:"mdl-slider__background-upper",IS_LOWEST_VALUE:"is-lowest-value",IS_UPGRADED:"is-upgraded"},f.prototype.onInput_=function(e){this.updateValueStyles_()},f.prototype.onChange_=function(e){this.updateValueStyles_()},f.prototype.onMouseUp_=function(e){e.target.blur()},f.prototype.onContainerMouseDown_=function(e){if(e.target===this.element_.parentElement){e.preventDefault();var t=new MouseEvent("mousedown",{target:e.target,buttons:e.buttons,clientX:e.clientX,clientY:this.element_.getBoundingClientRect().y});this.element_.dispatchEvent(t)}},f.prototype.updateValueStyles_=function(){var e=(this.element_.value-this.element_.min)/(this.element_.max-this.element_.min);0===e?this.element_.classList.add(this.CssClasses_.IS_LOWEST_VALUE):this.element_.classList.remove(this.CssClasses_.IS_LOWEST_VALUE),this.isIE_||(this.backgroundLower_.style.flex=e,this.backgroundLower_.style.webkitFlex=e,this.backgroundUpper_.style.flex=1-e,this.backgroundUpper_.style.webkitFlex=1-e)},f.prototype.disable=function(){this.element_.disabled=!0},f.prototype.disable=f.prototype.disable,f.prototype.enable=function(){this.element_.disabled=!1},f.prototype.enable=f.prototype.enable,f.prototype.change=function(e){void 0!==e&&(this.element_.value=e),this.updateValueStyles_()},f.prototype.change=f.prototype.change,f.prototype.init=function(){if(this.element_){if(this.isIE_){var e=document.createElement("div");e.classList.add(this.CssClasses_.IE_CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_)}else{var t=document.createElement("div");t.classList.add(this.CssClasses_.SLIDER_CONTAINER),this.element_.parentElement.insertBefore(t,this.element_),this.element_.parentElement.removeChild(this.element_),t.appendChild(this.element_);var n=document.createElement("div");n.classList.add(this.CssClasses_.BACKGROUND_FLEX),t.appendChild(n),this.backgroundLower_=document.createElement("div"),this.backgroundLower_.classList.add(this.CssClasses_.BACKGROUND_LOWER),n.appendChild(this.backgroundLower_),this.backgroundUpper_=document.createElement("div"),this.backgroundUpper_.classList.add(this.CssClasses_.BACKGROUND_UPPER),n.appendChild(this.backgroundUpper_)}this.boundInputHandler=this.onInput_.bind(this),this.boundChangeHandler=this.onChange_.bind(this),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.boundContainerMouseDownHandler=this.onContainerMouseDown_.bind(this),this.element_.addEventListener("input",this.boundInputHandler),this.element_.addEventListener("change",this.boundChangeHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.element_.parentElement.addEventListener("mousedown",this.boundContainerMouseDownHandler),this.updateValueStyles_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:f,classAsString:"MaterialSlider",cssClass:"mdl-js-slider",widget:!0});var p=function(e){if(this.element_=e,this.textElement_=this.element_.querySelector("."+this.cssClasses_.MESSAGE),this.actionElement_=this.element_.querySelector("."+this.cssClasses_.ACTION),!this.textElement_)throw new Error("There must be a message element for a snackbar.");if(!this.actionElement_)throw new Error("There must be an action element for a snackbar.");this.active=!1,this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.queuedNotifications_=[],this.setActionHidden_(!0)};window.MaterialSnackbar=p,p.prototype.Constant_={ANIMATION_LENGTH:250},p.prototype.cssClasses_={SNACKBAR:"mdl-snackbar",MESSAGE:"mdl-snackbar__text",ACTION:"mdl-snackbar__action",ACTIVE:"mdl-snackbar--active"},p.prototype.displaySnackbar_=function(){this.element_.setAttribute("aria-hidden","true"),this.actionHandler_&&(this.actionElement_.textContent=this.actionText_,this.actionElement_.addEventListener("click",this.actionHandler_),this.setActionHidden_(!1)),this.textElement_.textContent=this.message_,this.element_.classList.add(this.cssClasses_.ACTIVE),this.element_.setAttribute("aria-hidden","false"),setTimeout(this.cleanup_.bind(this),this.timeout_)},p.prototype.showSnackbar=function(e){if(void 0===e)throw new Error("Please provide a data object with at least a message to display.");if(void 0===e.message)throw new Error("Please provide a message to be displayed.");if(e.actionHandler&&!e.actionText)throw new Error("Please provide action text with the handler.");this.active?this.queuedNotifications_.push(e):(this.active=!0,this.message_=e.message,e.timeout?this.timeout_=e.timeout:this.timeout_=2750,e.actionHandler&&(this.actionHandler_=e.actionHandler),e.actionText&&(this.actionText_=e.actionText),this.displaySnackbar_())},p.prototype.showSnackbar=p.prototype.showSnackbar,p.prototype.checkQueue_=function(){this.queuedNotifications_.length>0&&this.showSnackbar(this.queuedNotifications_.shift())},p.prototype.cleanup_=function(){this.element_.classList.remove(this.cssClasses_.ACTIVE),setTimeout(function(){this.element_.setAttribute("aria-hidden","true"),this.textElement_.textContent="",Boolean(this.actionElement_.getAttribute("aria-hidden"))||(this.setActionHidden_(!0),this.actionElement_.textContent="",this.actionElement_.removeEventListener("click",this.actionHandler_)),this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.active=!1,this.checkQueue_()}.bind(this),this.Constant_.ANIMATION_LENGTH)},p.prototype.setActionHidden_=function(e){e?this.actionElement_.setAttribute("aria-hidden","true"):this.actionElement_.removeAttribute("aria-hidden")},n.register({constructor:p,classAsString:"MaterialSnackbar",cssClass:"mdl-js-snackbar",widget:!0});var m=function(e){this.element_=e,this.init()};window.MaterialSpinner=m,m.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},m.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},m.prototype.createLayer=function(e){var t=document.createElement("div");t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+e);var n=document.createElement("div");n.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),n.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var r=document.createElement("div");r.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var i=document.createElement("div");i.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),i.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var a=[n,r,i],s=0;s<a.length;s++){var o=document.createElement("div");o.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),a[s].appendChild(o)}t.appendChild(n),t.appendChild(r),t.appendChild(i),this.element_.appendChild(t)},m.prototype.createLayer=m.prototype.createLayer,m.prototype.stop=function(){this.element_.classList.remove("is-active")},m.prototype.stop=m.prototype.stop,m.prototype.start=function(){this.element_.classList.add("is-active")},m.prototype.start=m.prototype.start,m.prototype.init=function(){if(this.element_){for(var e=1;e<=this.Constant_.MDL_SPINNER_LAYER_COUNT;e++)this.createLayer(e);this.element_.classList.add("is-upgraded")}},n.register({constructor:m,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0});var v=function(e){this.element_=e,this.init()};window.MaterialSwitch=v,v.prototype.Constant_={TINY_TIMEOUT:.001},v.prototype.CssClasses_={INPUT:"mdl-switch__input",TRACK:"mdl-switch__track",THUMB:"mdl-switch__thumb",FOCUS_HELPER:"mdl-switch__focus-helper",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-switch__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},v.prototype.onChange_=function(e){this.updateClasses_()},v.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},v.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},v.prototype.onMouseUp_=function(e){this.blur_()},v.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},v.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},v.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},v.prototype.checkDisabled=v.prototype.checkDisabled,v.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},v.prototype.checkToggleState=v.prototype.checkToggleState,v.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},v.prototype.disable=v.prototype.disable,v.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},v.prototype.enable=v.prototype.enable,v.prototype.on=function(){this.inputElement_.checked=!0,this.updateClasses_()},v.prototype.on=v.prototype.on,v.prototype.off=function(){this.inputElement_.checked=!1,this.updateClasses_()},v.prototype.off=v.prototype.off,v.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("div");e.classList.add(this.CssClasses_.TRACK);var t=document.createElement("div");t.classList.add(this.CssClasses_.THUMB);var n=document.createElement("span");if(n.classList.add(this.CssClasses_.FOCUS_HELPER),t.appendChild(n),this.element_.appendChild(e),this.element_.appendChild(t),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.rippleContainerElement_.addEventListener("mouseup",this.boundMouseUpHandler);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(r),this.element_.appendChild(this.rippleContainerElement_)}this.boundChangeHandler=this.onChange_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.inputElement_.addEventListener("change",this.boundChangeHandler),this.inputElement_.addEventListener("focus",this.boundFocusHandler),this.inputElement_.addEventListener("blur",this.boundBlurHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},n.register({constructor:v,classAsString:"MaterialSwitch",cssClass:"mdl-js-switch",widget:!0});var g=function(e){this.element_=e,this.init()};window.MaterialTabs=g,g.prototype.Constant_={},g.prototype.CssClasses_={TAB_CLASS:"mdl-tabs__tab",PANEL_CLASS:"mdl-tabs__panel",ACTIVE_CLASS:"is-active",UPGRADED_CLASS:"is-upgraded",MDL_JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",MDL_RIPPLE_CONTAINER:"mdl-tabs__ripple-container",MDL_RIPPLE:"mdl-ripple",MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events"},g.prototype.initTabs_=function(){this.element_.classList.contains(this.CssClasses_.MDL_JS_RIPPLE_EFFECT)&&this.element_.classList.add(this.CssClasses_.MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS),this.tabs_=this.element_.querySelectorAll("."+this.CssClasses_.TAB_CLASS),this.panels_=this.element_.querySelectorAll("."+this.CssClasses_.PANEL_CLASS);for(var t=0;t<this.tabs_.length;t++)new e(this.tabs_[t],this);this.element_.classList.add(this.CssClasses_.UPGRADED_CLASS)},g.prototype.resetTabState_=function(){for(var e=0;e<this.tabs_.length;e++)this.tabs_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},g.prototype.resetPanelState_=function(){for(var e=0;e<this.panels_.length;e++)this.panels_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},g.prototype.init=function(){this.element_&&this.initTabs_()},n.register({constructor:g,classAsString:"MaterialTabs",cssClass:"mdl-js-tabs"});var y=function(e){this.element_=e,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=y,y.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},y.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},y.prototype.onKeyDown_=function(e){var t=e.target.value.split("\n").length;13===e.keyCode&&t>=this.maxRows&&e.preventDefault()},y.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},y.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},y.prototype.onReset_=function(e){this.updateClasses_()},y.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},y.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},y.prototype.checkDisabled=y.prototype.checkDisabled,y.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},y.prototype.checkFocus=y.prototype.checkFocus,y.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},y.prototype.checkValidity=y.prototype.checkValidity,y.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},y.prototype.checkDirty=y.prototype.checkDirty,y.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},y.prototype.disable=y.prototype.disable,y.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},y.prototype.enable=y.prototype.enable,y.prototype.change=function(e){this.input_.value=e||"",this.updateClasses_()},y.prototype.change=y.prototype.change,y.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var e=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),e&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},n.register({constructor:y,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0});var _=function(e){this.element_=e,this.init()};window.MaterialTooltip=_,_.prototype.Constant_={},_.prototype.CssClasses_={IS_ACTIVE:"is-active",BOTTOM:"mdl-tooltip--bottom",LEFT:"mdl-tooltip--left",RIGHT:"mdl-tooltip--right",TOP:"mdl-tooltip--top"},_.prototype.handleMouseEnter_=function(e){var t=e.target.getBoundingClientRect(),n=t.left+t.width/2,r=t.top+t.height/2,i=this.element_.offsetWidth/2*-1,a=this.element_.offsetHeight/2*-1;this.element_.classList.contains(this.CssClasses_.LEFT)||this.element_.classList.contains(this.CssClasses_.RIGHT)?(n=t.width/2,r+a<0?(this.element_.style.top="0",this.element_.style.marginTop="0"):(this.element_.style.top=r+"px",this.element_.style.marginTop=a+"px")):n+i<0?(this.element_.style.left="0",this.element_.style.marginLeft="0"):(this.element_.style.left=n+"px",this.element_.style.marginLeft=i+"px"),this.element_.classList.contains(this.CssClasses_.TOP)?this.element_.style.top=t.top-this.element_.offsetHeight-10+"px":this.element_.classList.contains(this.CssClasses_.RIGHT)?this.element_.style.left=t.left+t.width+10+"px":this.element_.classList.contains(this.CssClasses_.LEFT)?this.element_.style.left=t.left-this.element_.offsetWidth-10+"px":this.element_.style.top=t.top+t.height+10+"px",this.element_.classList.add(this.CssClasses_.IS_ACTIVE)},_.prototype.hideTooltip_=function(){this.element_.classList.remove(this.CssClasses_.IS_ACTIVE)},_.prototype.init=function(){if(this.element_){var e=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for");e&&(this.forElement_=document.getElementById(e)),this.forElement_&&(this.forElement_.hasAttribute("tabindex")||this.forElement_.setAttribute("tabindex","0"),this.boundMouseEnterHandler=this.handleMouseEnter_.bind(this),this.boundMouseLeaveAndScrollHandler=this.hideTooltip_.bind(this),this.forElement_.addEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("touchend",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("mouseleave",this.boundMouseLeaveAndScrollHandler,!1),window.addEventListener("scroll",this.boundMouseLeaveAndScrollHandler,!0),window.addEventListener("touchstart",this.boundMouseLeaveAndScrollHandler))}},n.register({constructor:_,classAsString:"MaterialTooltip",cssClass:"mdl-tooltip"});var w=function(e){this.element_=e,this.init()};window.MaterialLayout=w,w.prototype.Constant_={MAX_WIDTH:"(max-width: 1024px)",TAB_SCROLL_PIXELS:100,RESIZE_TIMEOUT:100,MENU_ICON:"&#xE5D2;",CHEVRON_LEFT:"chevron_left",CHEVRON_RIGHT:"chevron_right"},w.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32},w.prototype.Mode_={STANDARD:0,SEAMED:1,WATERFALL:2,SCROLL:3},w.prototype.CssClasses_={CONTAINER:"mdl-layout__container",HEADER:"mdl-layout__header",DRAWER:"mdl-layout__drawer",CONTENT:"mdl-layout__content",DRAWER_BTN:"mdl-layout__drawer-button",ICON:"material-icons",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-layout__tab-ripple-container",RIPPLE:"mdl-ripple",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",HEADER_SEAMED:"mdl-layout__header--seamed",HEADER_WATERFALL:"mdl-layout__header--waterfall",HEADER_SCROLL:"mdl-layout__header--scroll",FIXED_HEADER:"mdl-layout--fixed-header",OBFUSCATOR:"mdl-layout__obfuscator",TAB_BAR:"mdl-layout__tab-bar",TAB_CONTAINER:"mdl-layout__tab-bar-container",TAB:"mdl-layout__tab",TAB_BAR_BUTTON:"mdl-layout__tab-bar-button",TAB_BAR_LEFT_BUTTON:"mdl-layout__tab-bar-left-button",TAB_BAR_RIGHT_BUTTON:"mdl-layout__tab-bar-right-button",TAB_MANUAL_SWITCH:"mdl-layout__tab-manual-switch",PANEL:"mdl-layout__tab-panel",HAS_DRAWER:"has-drawer",HAS_TABS:"has-tabs",HAS_SCROLLING_HEADER:"has-scrolling-header",CASTING_SHADOW:"is-casting-shadow",IS_COMPACT:"is-compact",IS_SMALL_SCREEN:"is-small-screen",IS_DRAWER_OPEN:"is-visible",IS_ACTIVE:"is-active",IS_UPGRADED:"is-upgraded",IS_ANIMATING:"is-animating",ON_LARGE_SCREEN:"mdl-layout--large-screen-only",ON_SMALL_SCREEN:"mdl-layout--small-screen-only"},w.prototype.contentScrollHandler_=function(){if(!this.header_.classList.contains(this.CssClasses_.IS_ANIMATING)){var e=!this.element_.classList.contains(this.CssClasses_.IS_SMALL_SCREEN)||this.element_.classList.contains(this.CssClasses_.FIXED_HEADER);this.content_.scrollTop>0&&!this.header_.classList.contains(this.CssClasses_.IS_COMPACT)?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.header_.classList.add(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING)):this.content_.scrollTop<=0&&this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.header_.classList.remove(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING))}},w.prototype.keyboardEventHandler_=function(e){e.keyCode===this.Keycodes_.ESCAPE&&this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)&&this.toggleDrawer()},w.prototype.screenSizeHandler_=function(){this.screenSizeMediaQuery_.matches?this.element_.classList.add(this.CssClasses_.IS_SMALL_SCREEN):(this.element_.classList.remove(this.CssClasses_.IS_SMALL_SCREEN),this.drawer_&&(this.drawer_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN)))},w.prototype.drawerToggleHandler_=function(e){if(e&&"keydown"===e.type){if(e.keyCode!==this.Keycodes_.SPACE&&e.keyCode!==this.Keycodes_.ENTER)return;e.preventDefault()}this.toggleDrawer()},w.prototype.headerTransitionEndHandler_=function(){this.header_.classList.remove(this.CssClasses_.IS_ANIMATING)},w.prototype.headerClickHandler_=function(){this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING))},w.prototype.resetTabState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},w.prototype.resetPanelState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},w.prototype.toggleDrawer=function(){var e=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);this.drawer_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)?(this.drawer_.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true")):(this.drawer_.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"))},w.prototype.toggleDrawer=w.prototype.toggleDrawer,w.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER);var n=this.element_.querySelector(":focus");this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),n&&n.focus();for(var r=this.element_.childNodes,i=r.length,a=0;a<i;a++){var s=r[a];s.classList&&s.classList.contains(this.CssClasses_.HEADER)&&(this.header_=s),s.classList&&s.classList.contains(this.CssClasses_.DRAWER)&&(this.drawer_=s),s.classList&&s.classList.contains(this.CssClasses_.CONTENT)&&(this.content_=s)}window.addEventListener("pageshow",function(e){e.persisted&&(this.element_.style.overflowY="hidden",requestAnimationFrame(function(){this.element_.style.overflowY=""}.bind(this)))}.bind(this),!1),this.header_&&(this.tabBar_=this.header_.querySelector("."+this.CssClasses_.TAB_BAR));var o=this.Mode_.STANDARD;if(this.header_&&(this.header_.classList.contains(this.CssClasses_.HEADER_SEAMED)?o=this.Mode_.SEAMED:this.header_.classList.contains(this.CssClasses_.HEADER_WATERFALL)?(o=this.Mode_.WATERFALL,this.header_.addEventListener("transitionend",this.headerTransitionEndHandler_.bind(this)),this.header_.addEventListener("click",this.headerClickHandler_.bind(this))):this.header_.classList.contains(this.CssClasses_.HEADER_SCROLL)&&(o=this.Mode_.SCROLL,e.classList.add(this.CssClasses_.HAS_SCROLLING_HEADER)),o===this.Mode_.STANDARD?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.add(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.SEAMED||o===this.Mode_.SCROLL?(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.remove(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.WATERFALL&&(this.content_.addEventListener("scroll",this.contentScrollHandler_.bind(this)),this.contentScrollHandler_())),this.drawer_){var l=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);if(!l){(l=document.createElement("div")).setAttribute("aria-expanded","false"),l.setAttribute("role","button"),l.setAttribute("tabindex","0"),l.classList.add(this.CssClasses_.DRAWER_BTN);var u=document.createElement("i");u.classList.add(this.CssClasses_.ICON),u.innerHTML=this.Constant_.MENU_ICON,l.appendChild(u)}this.drawer_.classList.contains(this.CssClasses_.ON_LARGE_SCREEN)?l.classList.add(this.CssClasses_.ON_LARGE_SCREEN):this.drawer_.classList.contains(this.CssClasses_.ON_SMALL_SCREEN)&&l.classList.add(this.CssClasses_.ON_SMALL_SCREEN),l.addEventListener("click",this.drawerToggleHandler_.bind(this)),l.addEventListener("keydown",this.drawerToggleHandler_.bind(this)),this.element_.classList.add(this.CssClasses_.HAS_DRAWER),this.element_.classList.contains(this.CssClasses_.FIXED_HEADER)?this.header_.insertBefore(l,this.header_.firstChild):this.element_.insertBefore(l,this.content_);var c=document.createElement("div");c.classList.add(this.CssClasses_.OBFUSCATOR),this.element_.appendChild(c),c.addEventListener("click",this.drawerToggleHandler_.bind(this)),this.obfuscator_=c,this.drawer_.addEventListener("keydown",this.keyboardEventHandler_.bind(this)),this.drawer_.setAttribute("aria-hidden","true")}if(this.screenSizeMediaQuery_=window.matchMedia(this.Constant_.MAX_WIDTH),this.screenSizeMediaQuery_.addListener(this.screenSizeHandler_.bind(this)),this.screenSizeHandler_(),this.header_&&this.tabBar_){this.element_.classList.add(this.CssClasses_.HAS_TABS);var d=document.createElement("div");d.classList.add(this.CssClasses_.TAB_CONTAINER),this.header_.insertBefore(d,this.tabBar_),this.header_.removeChild(this.tabBar_);var h=document.createElement("div");h.classList.add(this.CssClasses_.TAB_BAR_BUTTON),h.classList.add(this.CssClasses_.TAB_BAR_LEFT_BUTTON);var f=document.createElement("i");f.classList.add(this.CssClasses_.ICON),f.textContent=this.Constant_.CHEVRON_LEFT,h.appendChild(f),h.addEventListener("click",function(){this.tabBar_.scrollLeft-=this.Constant_.TAB_SCROLL_PIXELS}.bind(this));var p=document.createElement("div");p.classList.add(this.CssClasses_.TAB_BAR_BUTTON),p.classList.add(this.CssClasses_.TAB_BAR_RIGHT_BUTTON);var m=document.createElement("i");m.classList.add(this.CssClasses_.ICON),m.textContent=this.Constant_.CHEVRON_RIGHT,p.appendChild(m),p.addEventListener("click",function(){this.tabBar_.scrollLeft+=this.Constant_.TAB_SCROLL_PIXELS}.bind(this)),d.appendChild(h),d.appendChild(this.tabBar_),d.appendChild(p);var v=function(){this.tabBar_.scrollLeft>0?h.classList.add(this.CssClasses_.IS_ACTIVE):h.classList.remove(this.CssClasses_.IS_ACTIVE),this.tabBar_.scrollLeft<this.tabBar_.scrollWidth-this.tabBar_.offsetWidth?p.classList.add(this.CssClasses_.IS_ACTIVE):p.classList.remove(this.CssClasses_.IS_ACTIVE)}.bind(this);this.tabBar_.addEventListener("scroll",v),v();var g=function(){this.resizeTimeoutId_&&clearTimeout(this.resizeTimeoutId_),this.resizeTimeoutId_=setTimeout(function(){v(),this.resizeTimeoutId_=null}.bind(this),this.Constant_.RESIZE_TIMEOUT)}.bind(this);window.addEventListener("resize",g),this.tabBar_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)&&this.tabBar_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);for(var y=this.tabBar_.querySelectorAll("."+this.CssClasses_.TAB),_=this.content_.querySelectorAll("."+this.CssClasses_.PANEL),w=0;w<y.length;w++)new t(y[w],y,_,this)}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},window.MaterialLayoutTab=t,n.register({constructor:w,classAsString:"MaterialLayout",cssClass:"mdl-js-layout"});var E=function(e){this.element_=e,this.init()};window.MaterialDataTable=E,E.prototype.Constant_={},E.prototype.CssClasses_={DATA_TABLE:"mdl-data-table",SELECTABLE:"mdl-data-table--selectable",SELECT_ELEMENT:"mdl-data-table__select",IS_SELECTED:"is-selected",IS_UPGRADED:"is-upgraded"},E.prototype.selectRow_=function(e,t,n){return t?function(){e.checked?t.classList.add(this.CssClasses_.IS_SELECTED):t.classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):n?function(){var t;if(e.checked)for(t=0;t<n.length;t++)n[t].querySelector("td").querySelector(".mdl-checkbox").MaterialCheckbox.check(),n[t].classList.add(this.CssClasses_.IS_SELECTED);else for(t=0;t<n.length;t++)n[t].querySelector("td").querySelector(".mdl-checkbox").MaterialCheckbox.uncheck(),n[t].classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):void 0},E.prototype.createCheckbox_=function(e,t){var r=document.createElement("label"),i=["mdl-checkbox","mdl-js-checkbox","mdl-js-ripple-effect",this.CssClasses_.SELECT_ELEMENT];r.className=i.join(" ");var a=document.createElement("input");return a.type="checkbox",a.classList.add("mdl-checkbox__input"),e?(a.checked=e.classList.contains(this.CssClasses_.IS_SELECTED),a.addEventListener("change",this.selectRow_(a,e))):t&&a.addEventListener("change",this.selectRow_(a,null,t)),r.appendChild(a),n.upgradeElement(r,"MaterialCheckbox"),r},E.prototype.init=function(){if(this.element_){var e=this.element_.querySelector("th"),t=Array.prototype.slice.call(this.element_.querySelectorAll("tbody tr")),n=Array.prototype.slice.call(this.element_.querySelectorAll("tfoot tr")),r=t.concat(n);if(this.element_.classList.contains(this.CssClasses_.SELECTABLE)){var i=document.createElement("th"),a=this.createCheckbox_(null,r);i.appendChild(a),e.parentElement.insertBefore(i,e);for(var s=0;s<r.length;s++){var o=r[s].querySelector("td");if(o){var l=document.createElement("td");if("TBODY"===r[s].parentNode.nodeName.toUpperCase()){var u=this.createCheckbox_(r[s]);l.appendChild(u)}r[s].insertBefore(l,o)}}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}}},n.register({constructor:E,classAsString:"MaterialDataTable",cssClass:"mdl-js-data-table"});var b=function(e){this.element_=e,this.init()};window.MaterialRipple=b,b.prototype.Constant_={INITIAL_SCALE:"scale(0.0001, 0.0001)",INITIAL_SIZE:"1px",INITIAL_OPACITY:"0.4",FINAL_OPACITY:"0",FINAL_SCALE:""},b.prototype.CssClasses_={RIPPLE_CENTER:"mdl-ripple--center",RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_ANIMATING:"is-animating",IS_VISIBLE:"is-visible"},b.prototype.downHandler_=function(e){if(!this.rippleElement_.style.width&&!this.rippleElement_.style.height){var t=this.element_.getBoundingClientRect();this.boundHeight=t.height,this.boundWidth=t.width,this.rippleSize_=2*Math.sqrt(t.width*t.width+t.height*t.height)+2,this.rippleElement_.style.width=this.rippleSize_+"px",this.rippleElement_.style.height=this.rippleSize_+"px"}if(this.rippleElement_.classList.add(this.CssClasses_.IS_VISIBLE),"mousedown"===e.type&&this.ignoringMouseDown_)this.ignoringMouseDown_=!1;else{if("touchstart"===e.type&&(this.ignoringMouseDown_=!0),this.getFrameCount()>0)return;this.setFrameCount(1);var n,r,i=e.currentTarget.getBoundingClientRect();if(0===e.clientX&&0===e.clientY)n=Math.round(i.width/2),r=Math.round(i.height/2);else{var a=void 0!==e.clientX?e.clientX:e.touches[0].clientX,s=void 0!==e.clientY?e.clientY:e.touches[0].clientY;n=Math.round(a-i.left),r=Math.round(s-i.top)}this.setRippleXY(n,r),this.setRippleStyles(!0),window.requestAnimationFrame(this.animFrameHandler.bind(this))}},b.prototype.upHandler_=function(e){e&&2!==e.detail&&window.setTimeout(function(){this.rippleElement_.classList.remove(this.CssClasses_.IS_VISIBLE)}.bind(this),0)},b.prototype.init=function(){if(this.element_){var e=this.element_.classList.contains(this.CssClasses_.RIPPLE_CENTER);this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT_IGNORE_EVENTS)||(this.rippleElement_=this.element_.querySelector("."+this.CssClasses_.RIPPLE),this.frameCount_=0,this.rippleSize_=0,this.x_=0,this.y_=0,this.ignoringMouseDown_=!1,this.boundDownHandler=this.downHandler_.bind(this),this.element_.addEventListener("mousedown",this.boundDownHandler),this.element_.addEventListener("touchstart",this.boundDownHandler),this.boundUpHandler=this.upHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundUpHandler),this.element_.addEventListener("mouseleave",this.boundUpHandler),this.element_.addEventListener("touchend",this.boundUpHandler),this.element_.addEventListener("blur",this.boundUpHandler),this.getFrameCount=function(){return this.frameCount_},this.setFrameCount=function(e){this.frameCount_=e},this.getRippleElement=function(){return this.rippleElement_},this.setRippleXY=function(e,t){this.x_=e,this.y_=t},this.setRippleStyles=function(t){if(null!==this.rippleElement_){var n,r,i="translate("+this.x_+"px, "+this.y_+"px)";t?(r=this.Constant_.INITIAL_SCALE,this.Constant_.INITIAL_SIZE):(r=this.Constant_.FINAL_SCALE,this.rippleSize_+"px",e&&(i="translate("+this.boundWidth/2+"px, "+this.boundHeight/2+"px)")),n="translate(-50%, -50%) "+i+r,this.rippleElement_.style.webkitTransform=n,this.rippleElement_.style.msTransform=n,this.rippleElement_.style.transform=n,t?this.rippleElement_.classList.remove(this.CssClasses_.IS_ANIMATING):this.rippleElement_.classList.add(this.CssClasses_.IS_ANIMATING)}},this.animFrameHandler=function(){this.frameCount_-- >0?window.requestAnimationFrame(this.animFrameHandler.bind(this)):this.setRippleStyles(!1)})}},n.register({constructor:b,classAsString:"MaterialRipple",cssClass:"mdl-js-ripple-effect",widget:!1})}()},function(e,t,n){e.exports=function(){"use strict";var e=window.CustomEvent;function t(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement}return null}function n(e){e&&e.blur&&e!==document.body&&e.blur()}function r(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1}function i(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function a(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window){var t=new MutationObserver(this.maybeHideModal.bind(this));t.observe(e,{attributes:!0,attributeFilter:["open"]})}else{var n,r=!1,i=function(){r?this.downgradeModal():this.maybeHideModal(),r=!1}.bind(this),a=function(t){if(t.target===e){var a="DOMNodeRemoved";r|=t.type.substr(0,a.length)===a,window.clearTimeout(n),n=window.setTimeout(i,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(t){e.addEventListener(t,a)})}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}e&&"object"!=typeof e||((e=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),n}).prototype=window.Event.prototype),a.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),s.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var n=document.createEvent("MouseEvents");n.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(n),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),!e){var t=["button","input","keygen","select","textarea"].map(function(e){return e+":not([disabled])"});t.push('[tabindex]:not([disabled]):not([tabindex=""])'),e=this.dialog_.querySelector(t.join(", "))}n(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!s.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),n=function(e,n){return!(void 0===t[e]||t[e]===n)};if(t.opacity<1||n("zIndex","auto")||n("transform","none")||n("mixBlendMode","normal")||n("filter","none")||n("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,s.needsCentering(this.dialog_)?(s.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==t&&(this.dialog_.returnValue=t);var n=new e("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(n)}};var s={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,n=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,n)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var n=document.styleSheets[t],i=null;try{i=n.cssRules}catch(e){}if(i)for(var a=0;a<i.length;++a){var s=i[a],o=null;try{o=document.querySelectorAll(s.selectorText)}catch(e){}if(o&&r(o,e)){var l=s.style.getPropertyValue("top"),u=s.style.getPropertyValue("bottom");if(l&&"auto"!==l||u&&"auto"!==u)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||s.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new a(e)},registerDialog:function(e){e.showModal||s.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(t){var n=[];t.forEach(function(e){for(var t,r=0;t=e.removedNodes[r];++r)t instanceof Element&&("dialog"===t.localName&&n.push(t),n=n.concat(t.querySelectorAll("dialog")))}),n.length&&e(n)}))}};if(s.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},s.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},s.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,n=0;e=this.pendingDialogStack[n];++n)e.updateZIndex(--t,--t),0===n&&(this.overlay.style.zIndex=--t);var r=this.pendingDialogStack[0];r?(r.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},s.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=t(e);){for(var n,r=0;n=this.pendingDialogStack[r];++r)if(n.dialog===e)return 0===r;e=e.parentElement}return!1},s.DialogManager.prototype.handleFocus_=function(e){if(!this.containedByTopDialog_(e.target)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),n(e.target),void 0!==this.forwardTab_)){var t=this.pendingDialogStack[0];return t.dialog.compareDocumentPosition(e.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?t.focus_():e.target!==document.documentElement&&document.documentElement.focus()),!1}},s.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,27===t.keyCode){t.preventDefault(),t.stopPropagation();var n=new e("cancel",{bubbles:!1,cancelable:!0}),r=this.pendingDialogStack[0];r&&r.dialog.dispatchEvent(n)&&r.dialog.close()}else 9===t.keyCode&&(this.forwardTab_=!t.shiftKey)},s.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach(function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()})},s.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},s.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},s.dm=new s.DialogManager,s.formSubmitter=null,s.useValue=null,void 0===window.HTMLDialogElement){var o=document.createElement("form");if(o.setAttribute("method","dialog"),"dialog"!==o.method){var l=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(l){var u=l.get;l.get=function(){return i(this)?"dialog":u.call(this)};var c=l.set;l.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):c.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",l)}}document.addEventListener("click",function(e){if(s.formSubmitter=null,s.useValue=null,!e.defaultPrevented){var n=e.target;if(n&&i(n.form)){var r="submit"===n.type&&["button","input"].indexOf(n.localName)>-1;if(!r){if("input"!==n.localName||"image"!==n.type)return;s.useValue=e.offsetX+","+e.offsetY}var a=t(n);a&&(s.formSubmitter=n)}}},!1);var d=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!i(this))return d.call(this);var e=t(this);e&&e.close()},document.addEventListener("submit",function(e){var n=e.target;if(i(n)){e.preventDefault();var r=t(n);if(r){var a=s.formSubmitter;a&&a.form===n?r.close(s.useValue||a.value):r.close(),s.formSubmitter=null}}},!0)}return s}()},function(e,t,n){(function(t){e.exports=function(){"use strict";function e(e){return e&&"[object Function]"==={}.toString.call(e)}function n(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView,r=n.getComputedStyle(e,null);return t?r[t]:r}function r(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function i(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=n(e),a=t.overflow,s=t.overflowX,o=t.overflowY;return/(auto|scroll|overlay)/.test(a+o+s)?e:i(r(e))}function a(e){return 11===e?Y:10===e?X:Y||X}function s(e){if(!e)return document.documentElement;for(var t=a(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var i=r&&r.nodeName;return i&&"BODY"!==i&&"HTML"!==i?-1!==["TH","TD","TABLE"].indexOf(r.nodeName)&&"static"===n(r,"position")?s(r):r:e?e.ownerDocument.documentElement:document.documentElement}function o(e){return null===e.parentNode?e:o(e.parentNode)}function l(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=n?e:t,i=n?t:e,a=document.createRange();a.setStart(r,0),a.setEnd(i,0);var u=a.commonAncestorContainer;if(e!==u&&t!==u||r.contains(i))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||s(e.firstElementChild)===e)}(u)?u:s(u);var c=o(e);return c.host?l(c.host,t):l(e,o(t).host)}function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",n="top"===t?"scrollTop":"scrollLeft",r=e.nodeName;if("BODY"===r||"HTML"===r){var i=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||i;return a[n]}return e[n]}function c(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=u(t,"top"),i=u(t,"left"),a=n?-1:1;return e.top+=r*a,e.bottom+=r*a,e.left+=i*a,e.right+=i*a,e}function d(e,t){var n="x"===t?"Left":"Top",r="Left"==n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"],10)+parseFloat(e["border"+r+"Width"],10)}function h(e,t,n,r){return G(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],a(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function f(e){var t=e.body,n=e.documentElement,r=a(10)&&getComputedStyle(n);return{height:h("Height",t,n,r),width:h("Width",t,n,r)}}function p(e){return J({},e,{right:e.left+e.width,bottom:e.top+e.height})}function m(e){var t={};try{if(a(10)){t=e.getBoundingClientRect();var r=u(e,"top"),i=u(e,"left");t.top+=r,t.left+=i,t.bottom+=r,t.right+=i}else t=e.getBoundingClientRect()}catch(e){}var s={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?f(e.ownerDocument):{},l=o.width||e.clientWidth||s.right-s.left,c=o.height||e.clientHeight||s.bottom-s.top,h=e.offsetWidth-l,m=e.offsetHeight-c;if(h||m){var v=n(e);h-=d(v,"x"),m-=d(v,"y"),s.width-=h,s.height-=m}return p(s)}function v(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=a(10),o="HTML"===t.nodeName,l=m(e),u=m(t),d=i(e),h=n(t),f=parseFloat(h.borderTopWidth,10),v=parseFloat(h.borderLeftWidth,10);r&&o&&(u.top=G(u.top,0),u.left=G(u.left,0));var g=p({top:l.top-u.top-f,left:l.left-u.left-v,width:l.width,height:l.height});if(g.marginTop=0,g.marginLeft=0,!s&&o){var y=parseFloat(h.marginTop,10),_=parseFloat(h.marginLeft,10);g.top-=f-y,g.bottom-=f-y,g.left-=v-_,g.right-=v-_,g.marginTop=y,g.marginLeft=_}return(s&&!r?t.contains(d):t===d&&"BODY"!==d.nodeName)&&(g=c(g,t)),g}function g(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,r=v(e,n),i=G(n.clientWidth,window.innerWidth||0),a=G(n.clientHeight,window.innerHeight||0),s=t?0:u(n),o=t?0:u(n,"left"),l={top:s-r.top+r.marginTop,left:o-r.left+r.marginLeft,width:i,height:a};return p(l)}function y(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===n(e,"position"))return!0;var i=r(e);return!!i&&y(i)}function _(e){if(!e||!e.parentElement||a())return document.documentElement;for(var t=e.parentElement;t&&"none"===n(t,"transform");)t=t.parentElement;return t||document.documentElement}function w(e,t,n,a){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o={top:0,left:0},u=s?_(e):l(e,t);if("viewport"===a)o=g(u,s);else{var c;"scrollParent"===a?"BODY"===(c=i(r(t))).nodeName&&(c=e.ownerDocument.documentElement):c="window"===a?e.ownerDocument.documentElement:a;var d=v(c,u,s);if("HTML"!==c.nodeName||y(u))o=d;else{var h=f(e.ownerDocument),p=h.height,m=h.width;o.top+=d.top-d.marginTop,o.bottom=p+d.top,o.left+=d.left-d.marginLeft,o.right=m+d.left}}var w="number"==typeof(n=n||0);return o.left+=w?n:n.left||0,o.top+=w?n:n.top||0,o.right-=w?n:n.right||0,o.bottom-=w?n:n.bottom||0,o}function E(e){var t=e.width,n=e.height;return t*n}function b(e,t,n,r,i){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=w(n,r,a,i),o={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(o).map(function(e){return J({key:e},o[e],{area:E(o[e])})}).sort(function(e,t){return t.area-e.area}),u=l.filter(function(e){var t=e.width,r=e.height;return t>=n.clientWidth&&r>=n.clientHeight}),c=0<u.length?u[0].key:l[0].key,d=e.split("-")[1];return c+(d?"-"+d:"")}function S(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=r?_(t):l(t,n);return v(n,i,r)}function T(e){var t=e.ownerDocument.defaultView,n=t.getComputedStyle(e),r=parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0),i=parseFloat(n.marginLeft||0)+parseFloat(n.marginRight||0),a={width:e.offsetWidth+i,height:e.offsetHeight+r};return a}function k(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function C(e,t,n){n=n.split("-")[0];var r=T(e),i={width:r.width,height:r.height},a=-1!==["right","left"].indexOf(n),s=a?"top":"left",o=a?"left":"top",l=a?"height":"width",u=a?"width":"height";return i[s]=t[s]+t[l]/2-r[l]/2,i[o]=n===o?t[o]-r[u]:t[k(o)],i}function I(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function A(t,n,r){var i=void 0===r?t:t.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[t]===n});var r=I(e,function(e){return e[t]===n});return e.indexOf(r)}(t,"name",r));return i.forEach(function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var r=t.function||t.fn;t.enabled&&e(r)&&(n.offsets.popper=p(n.offsets.popper),n.offsets.reference=p(n.offsets.reference),n=r(n,t))}),n}function L(e,t){return e.some(function(e){var n=e.name,r=e.enabled;return r&&n===t})}function R(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var i=t[r],a=i?""+i+n:e;if(void 0!==document.body.style[a])return a}return null}function x(e){var t=e.ownerDocument;return t?t.defaultView:window}function N(e,t,n,r){n.updateBound=r,x(e).addEventListener("resize",n.updateBound,{passive:!0});var a=i(e);return function e(t,n,r,a){var s="BODY"===t.nodeName,o=s?t.ownerDocument.defaultView:t;o.addEventListener(n,r,{passive:!0}),s||e(i(o.parentNode),n,r,a),a.push(o)}(a,"scroll",n.updateBound,n.scrollParents),n.scrollElement=a,n.eventsEnabled=!0,n}function M(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,x(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function P(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function O(e,t){Object.keys(t).forEach(function(n){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&P(t[n])&&(r="px"),e.style[n]=t[n]+r})}function D(e,t,n){var r=I(e,function(e){var n=e.name;return n===t}),i=!!r&&e.some(function(e){return e.name===n&&e.enabled&&e.order<r.order});if(!i){var a="`"+t+"`";console.warn("`"+n+"` modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return i}function U(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=ne.indexOf(e),r=ne.slice(n+1).concat(ne.slice(0,n));return t?r.reverse():r}function F(e,t,n,r){var i=[0,0],a=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map(function(e){return e.trim()}),o=s.indexOf(I(s,function(e){return-1!==e.search(/,|\s/)}));s[o]&&-1===s[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=-1===o?[s]:[s.slice(0,o).concat([s[o].split(l)[0]]),[s[o].split(l)[1]].concat(s.slice(o+1))];return(u=u.map(function(e,r){var i=(1===r?!a:a)?"height":"width",s=!1;return e.reduce(function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)},[]).map(function(e){return function(e,t,n,r){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+i[1],s=i[2];if(!a)return e;if(0===s.indexOf("%")){var o;switch(s){case"%p":o=n;break;case"%":case"%r":default:o=r}var l=p(o);return l[t]/100*a}return"vh"===s||"vw"===s?("vh"===s?G(document.documentElement.clientHeight,window.innerHeight||0):G(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,i,t,n)})})).forEach(function(e,t){e.forEach(function(n,r){P(n)&&(i[t]+=n*("-"===e[r-1]?-1:1))})}),i}for(var B=Math.min,V=Math.floor,H=Math.round,G=Math.max,j="undefined"!=typeof window&&"undefined"!=typeof document,K=["Edge","Trident","Firefox"],W=0,q=0;q<K.length;q+=1)if(j&&0<=navigator.userAgent.indexOf(K[q])){W=1;break}var z=j&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},W))}},Y=j&&!(!window.MSInputMethodContext||!document.documentMode),X=j&&/MSIE 10/.test(navigator.userAgent),$=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Q=function(){function e(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Z=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},J=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ee=j&&/Firefox/i.test(navigator.userAgent),te=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ne=te.slice(3),re={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},ie=function(){function t(n,r){var i=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};$(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=z(this.update.bind(this)),this.options=J({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=n&&n.jquery?n[0]:n,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(J({},t.Defaults.modifiers,a.modifiers)).forEach(function(e){i.options.modifiers[e]=J({},t.Defaults.modifiers[e]||{},a.modifiers?a.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return J({name:e},i.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(t){t.enabled&&e(t.onLoad)&&t.onLoad(i.reference,i.popper,i.options,t,i.state)}),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return Q(t,[{key:"update",value:function(){return function(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=S(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=b(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=C(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=A(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,L(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[R("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=N(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return M.call(this)}}]),t}();return ie.Utils=("undefined"==typeof window?t:window).PopperUtils,ie.placements=te,ie.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],r=t.split("-")[1];if(r){var i=e.offsets,a=i.reference,s=i.popper,o=-1!==["bottom","top"].indexOf(n),l=o?"left":"top",u=o?"width":"height",c={start:Z({},l,a[l]),end:Z({},l,a[l]+a[u]-s[u])};e.offsets.popper=J({},s,c[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n,r=t.offset,i=e.placement,a=e.offsets,s=a.popper,o=a.reference,l=i.split("-")[0];return n=P(+r)?[+r,0]:F(r,s,o,l),"left"===l?(s.top+=n[0],s.left-=n[1]):"right"===l?(s.top+=n[0],s.left+=n[1]):"top"===l?(s.left+=n[0],s.top-=n[1]):"bottom"===l&&(s.left+=n[0],s.top+=n[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||s(e.instance.popper);e.instance.reference===n&&(n=s(n));var r=R("transform"),i=e.instance.popper.style,a=i.top,o=i.left,l=i[r];i.top="",i.left="",i[r]="";var u=w(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);i.top=a,i.left=o,i[r]=l,t.boundaries=u;var c=t.priority,d=e.offsets.popper,h={primary:function(e){var n=d[e];return d[e]<u[e]&&!t.escapeWithReference&&(n=G(d[e],u[e])),Z({},e,n)},secondary:function(e){var n="right"===e?"left":"top",r=d[n];return d[e]>u[e]&&!t.escapeWithReference&&(r=B(d[n],u[e]-("right"===e?d.width:d.height))),Z({},n,r)}};return c.forEach(function(e){var t=-1===["left","top"].indexOf(e)?"secondary":"primary";d=J({},d,h[t](e))}),e.offsets.popper=d,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,i=e.placement.split("-")[0],a=V,s=-1!==["top","bottom"].indexOf(i),o=s?"right":"bottom",l=s?"left":"top",u=s?"width":"height";return n[o]<a(r[l])&&(e.offsets.popper[l]=a(r[l])-n[u]),n[l]>a(r[o])&&(e.offsets.popper[l]=a(r[o])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var r;if(!D(e.instance.modifiers,"arrow","keepTogether"))return e;var i=t.element;if("string"==typeof i){if(!(i=e.instance.popper.querySelector(i)))return e}else if(!e.instance.popper.contains(i))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],s=e.offsets,o=s.popper,l=s.reference,u=-1!==["left","right"].indexOf(a),c=u?"height":"width",d=u?"Top":"Left",h=d.toLowerCase(),f=u?"left":"top",m=u?"bottom":"right",v=T(i)[c];l[m]-v<o[h]&&(e.offsets.popper[h]-=o[h]-(l[m]-v)),l[h]+v>o[m]&&(e.offsets.popper[h]+=l[h]+v-o[m]),e.offsets.popper=p(e.offsets.popper);var g=l[h]+l[c]/2-v/2,y=n(e.instance.popper),_=parseFloat(y["margin"+d],10),w=parseFloat(y["border"+d+"Width"],10),E=g-e.offsets.popper[h]-_-w;return E=G(B(o[c]-v,E),0),e.arrowElement=i,e.offsets.arrow=(Z(r={},h,H(E)),Z(r,f,""),r),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(L(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=w(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],i=k(r),a=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case re.FLIP:s=[r,i];break;case re.CLOCKWISE:s=U(r);break;case re.COUNTERCLOCKWISE:s=U(r,!0);break;default:s=t.behavior}return s.forEach(function(o,l){if(r!==o||s.length===l+1)return e;r=e.placement.split("-")[0],i=k(r);var u=e.offsets.popper,c=e.offsets.reference,d=V,h="left"===r&&d(u.right)>d(c.left)||"right"===r&&d(u.left)<d(c.right)||"top"===r&&d(u.bottom)>d(c.top)||"bottom"===r&&d(u.top)<d(c.bottom),f=d(u.left)<d(n.left),p=d(u.right)>d(n.right),m=d(u.top)<d(n.top),v=d(u.bottom)>d(n.bottom),g="left"===r&&f||"right"===r&&p||"top"===r&&m||"bottom"===r&&v,y=-1!==["top","bottom"].indexOf(r),_=!!t.flipVariations&&(y&&"start"===a&&f||y&&"end"===a&&p||!y&&"start"===a&&m||!y&&"end"===a&&v),w=!!t.flipVariationsByContent&&(y&&"start"===a&&p||y&&"end"===a&&f||!y&&"start"===a&&v||!y&&"end"===a&&m),E=_||w;(h||g||E)&&(e.flipped=!0,(h||g)&&(r=s[l+1]),E&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=r+(a?"-"+a:""),e.offsets.popper=J({},e.offsets.popper,C(e.instance.popper,e.offsets.reference,e.placement)),e=A(e.instance.modifiers,e,"flip"))}),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,i=r.popper,a=r.reference,s=-1!==["left","right"].indexOf(n),o=-1===["top","left"].indexOf(n);return i[s?"left":"top"]=a[n]-(o?i[s?"width":"height"]:0),e.placement=k(t),e.offsets.popper=p(i),e}},hide:{order:800,enabled:!0,fn:function(e){if(!D(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=I(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,i=e.offsets.popper,a=I(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,l,u=void 0===a?t.gpuAcceleration:a,c=s(e.instance.popper),d=m(c),h={position:i.position},f=function(e,t){var n=e.offsets,r=n.popper,i=n.reference,a=H,s=function(e){return e},o=a(i.width),l=a(r.width),u=-1!==["left","right"].indexOf(e.placement),c=-1!==e.placement.indexOf("-"),d=t?u||c||o%2==l%2?a:V:s,h=t?a:s;return{left:d(1==o%2&&1==l%2&&!c&&t?r.left-1:r.left),top:h(r.top),bottom:h(r.bottom),right:d(r.right)}}(e,2>window.devicePixelRatio||!ee),p="bottom"===n?"top":"bottom",v="right"===r?"left":"right",g=R("transform");if(l="bottom"==p?"HTML"===c.nodeName?-c.clientHeight+f.bottom:-d.height+f.bottom:f.top,o="right"==v?"HTML"===c.nodeName?-c.clientWidth+f.right:-d.width+f.right:f.left,u&&g)h[g]="translate3d("+o+"px, "+l+"px, 0)",h[p]=0,h[v]=0,h.willChange="transform";else{var y="bottom"==p?-1:1,_="right"==v?-1:1;h[p]=l*y,h[v]=o*_,h.willChange=p+", "+v}var w={"x-placement":e.placement};return e.attributes=J({},w,e.attributes),e.styles=J({},h,e.styles),e.arrowStyles=J({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return O(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach(function(n){var r=t[n];!1===r?e.removeAttribute(n):e.setAttribute(n,t[n])})}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&O(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,i){var a=S(i,t,e,n.positionFixed),s=b(n.placement,a,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",s),O(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},ie}()}).call(this,n(4))},function(e,t,n){e.exports=function(e){"use strict";function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}e=e&&e.hasOwnProperty("default")?e.default:e;var n="undefined"!=typeof window&&"undefined"!=typeof document,r=n?navigator.userAgent:"",i=/MSIE |Trident\//.test(r),a=/UCBrowser\//.test(r),s=n&&/iPhone|iPad|iPod/.test(navigator.platform)&&!window.MSStream,o={a11y:!0,allowHTML:!0,animateFill:!0,animation:"shift-away",appendTo:function(){return document.body},aria:"describedby",arrow:!1,arrowType:"sharp",boundary:"scrollParent",content:"",delay:0,distance:10,duration:[325,275],flip:!0,flipBehavior:"flip",flipOnUpdate:!1,followCursor:!1,hideOnClick:!0,ignoreAttributes:!1,inertia:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,lazy:!0,maxWidth:350,multiple:!1,offset:0,onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},placement:"top",popperOptions:{},role:"tooltip",showOnInit:!1,size:"regular",sticky:!1,target:"",theme:"dark",touch:!0,touchHold:!1,trigger:"mouseenter focus",triggerTarget:null,updateDuration:0,wait:null,zIndex:9999},l=["arrow","arrowType","boundary","distance","flip","flipBehavior","flipOnUpdate","offset","placement","popperOptions"],u=n?Element.prototype:{},c=u.matches||u.matchesSelector||u.webkitMatchesSelector||u.mozMatchesSelector||u.msMatchesSelector;function d(e){return[].slice.call(e)}function h(e,t){return f(e,function(e){return c.call(e,t)})}function f(e,t){for(;e;){if(t(e))return e;e=e.parentElement}return null}var p={passive:!0},m=4,v="x-placement",g="x-out-of-boundaries",y="tippy-iOS",_="tippy-active",w="tippy-popper",E="tippy-tooltip",b="tippy-content",S="tippy-backdrop",T="tippy-arrow",k="tippy-roundarrow",C=".".concat(w),I=".".concat(E),A=".".concat(b),L=".".concat(S),R=".".concat(T),x=".".concat(k),N=!1;function M(){N||(N=!0,s&&document.body.classList.add(y),window.performance&&document.addEventListener("mousemove",O))}var P=0;function O(){var e=performance.now();e-P<20&&(N=!1,document.removeEventListener("mousemove",O),s||document.body.classList.remove(y)),P=e}function D(){var e=document.activeElement;e&&e.blur&&e._tippy&&e.blur()}var U=Object.keys(o);function F(e,t){return{}.hasOwnProperty.call(e,t)}function B(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?n:r}return e}function V(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)};var n}function H(e,t){return e&&e.modifiers&&e.modifiers[t]}function G(e,t){return e.indexOf(t)>-1}function j(e){return e instanceof Element}function K(e){return!(!e||!F(e,"isVirtual"))||j(e)}function W(e,t){return"function"==typeof e?e.apply(null,t):e}function q(e,t){e.filter(function(e){return"flip"===e.name})[0].enabled=t}function z(){return document.createElement("div")}function Y(e,t){e.forEach(function(e){e&&(e.style.transitionDuration="".concat(t,"ms"))})}function X(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function $(e,n){var r=t({},n,{content:W(n.content,[e])},n.ignoreAttributes?{}:function(e){return U.reduce(function(t,n){var r=(e.getAttribute("data-tippy-".concat(n))||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t},{})}(e));return(r.arrow||a)&&(r.animateFill=!1),r}function Q(e,t){Object.keys(e).forEach(function(e){if(!F(t,e))throw new Error("[tippy]: `".concat(e,"` is not a valid option"))})}function Z(e,t){e.innerHTML=j(t)?t.innerHTML:t}function J(e,t){j(t.content)?(Z(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(e[t.allowHTML?"innerHTML":"textContent"]=t.content)}function ee(e){return{tooltip:e.querySelector(I),backdrop:e.querySelector(L),content:e.querySelector(A),arrow:e.querySelector(R)||e.querySelector(x)}}function te(e){e.setAttribute("data-inertia","")}function ne(e){var t=z();return"round"===e?(t.className=k,Z(t,'<svg viewBox="0 0 18 7" xmlns="http://www.w3.org/2000/svg"><path d="M0 7s2.021-.015 5.253-4.218C6.584 1.051 7.797.007 9 0c1.203-.007 2.416 1.035 3.761 2.782C16.012 7.005 18 7 18 7H0z"/></svg>')):t.className=T,t}function re(){var e=z();return e.className=S,e.setAttribute("data-state","hidden"),e}function ie(e,t){e.setAttribute("tabindex","-1"),t.setAttribute("data-interactive","")}function ae(e,t,n){var r=a&&void 0!==document.body.style.webkitTransition?"webkitTransitionEnd":"transitionend";e[t+"EventListener"](r,n)}function se(e){var t=e.getAttribute(v);return t?t.split("-")[0]:""}function oe(e,t,n){n.split(" ").forEach(function(n){e.classList[t](n+"-theme")})}function le(e,t){var n=z();n.className=w,n.id="tippy-".concat(e),n.style.zIndex=""+t.zIndex,n.style.position="absolute",n.style.top="0",n.style.left="0",t.role&&n.setAttribute("role",t.role);var r=z();r.className=E,r.style.maxWidth=t.maxWidth+("number"==typeof t.maxWidth?"px":""),r.setAttribute("data-size",t.size),r.setAttribute("data-animation",t.animation),r.setAttribute("data-state","hidden"),oe(r,"add",t.theme);var i=z();return i.className=b,i.setAttribute("data-state","hidden"),t.interactive&&ie(n,r),t.arrow&&r.appendChild(ne(t.arrowType)),t.animateFill&&(r.appendChild(re()),r.setAttribute("data-animatefill","")),t.inertia&&te(r),J(i,t),r.appendChild(i),n.appendChild(r),n}function ue(e,t,n){var r=ee(e),i=r.tooltip,a=r.content,s=r.backdrop,o=r.arrow;e.style.zIndex=""+n.zIndex,i.setAttribute("data-size",n.size),i.setAttribute("data-animation",n.animation),i.style.maxWidth=n.maxWidth+("number"==typeof n.maxWidth?"px":""),n.role?e.setAttribute("role",n.role):e.removeAttribute("role"),t.content!==n.content&&J(a,n),!t.animateFill&&n.animateFill?(i.appendChild(re()),i.setAttribute("data-animatefill","")):t.animateFill&&!n.animateFill&&(i.removeChild(s),i.removeAttribute("data-animatefill")),!t.arrow&&n.arrow?i.appendChild(ne(n.arrowType)):t.arrow&&!n.arrow&&i.removeChild(o),t.arrow&&n.arrow&&t.arrowType!==n.arrowType&&i.replaceChild(ne(n.arrowType),o),!t.interactive&&n.interactive?ie(e,i):t.interactive&&!n.interactive&&function(e,t){e.removeAttribute("tabindex"),t.removeAttribute("data-interactive")}(e,i),!t.inertia&&n.inertia?te(i):t.inertia&&!n.inertia&&function(e){e.removeAttribute("data-inertia")}(i),t.theme!==n.theme&&(oe(i,"remove",t.theme),oe(i,"add",n.theme))}var ce=1,de=[];function he(n,r){var a,s,u,y,w,E=$(n,r);if(!E.multiple&&n._tippy)return null;var b,S,T,k,I,A=!1,L=!1,R=!1,x=!1,M=[],P=V(ge,E.interactiveDebounce),O=ce++,D=le(O,E),U=ee(D),K={id:O,reference:n,popper:D,popperChildren:U,popperInstance:null,props:E,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},clearDelayTimeouts:Ae,set:Le,setContent:function(e){Le({content:e})},show:Re,hide:xe,enable:function(){K.state.isEnabled=!0},disable:function(){K.state.isEnabled=!1},destroy:function(e){if(!K.state.isDestroyed){L=!0,K.state.isMounted&&xe(0),pe(),delete n._tippy;var t=K.props.target;t&&e&&j(n)&&d(n.querySelectorAll(t)).forEach(function(e){e._tippy&&e._tippy.destroy()}),K.popperInstance&&K.popperInstance.destroy(),L=!1,K.state.isDestroyed=!0}}};return n._tippy=K,D._tippy=K,fe(),E.lazy||Te(),E.showOnInit&&ke(),!E.a11y||E.target||!j(I=J())||c.call(I,"a[href],area[href],button,details,input,textarea,select,iframe,[tabindex]")&&!I.hasAttribute("disabled")||J().setAttribute("tabindex","0"),D.addEventListener("mouseenter",function(e){K.props.interactive&&K.state.isVisible&&"mouseenter"===a&&ke(e,!0)}),D.addEventListener("mouseleave",function(){K.props.interactive&&"mouseenter"===a&&document.addEventListener("mousemove",P)}),K;function z(){document.removeEventListener("mousemove",me)}function Z(){document.body.removeEventListener("mouseleave",Ce),document.removeEventListener("mousemove",P),de=de.filter(function(e){return e!==P})}function J(){return K.props.triggerTarget||n}function te(){document.addEventListener("click",Ie,!0)}function ne(){return[K.popperChildren.tooltip,K.popperChildren.backdrop,K.popperChildren.content]}function re(){var e=K.props.followCursor;return e&&"focus"!==a||N&&"initial"===e}function ie(e,t){var n=K.popperChildren.tooltip;function r(e){e.target===n&&(ae(n,"remove",r),t())}if(0===e)return t();ae(n,"remove",T),ae(n,"add",r),T=r}function oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];J().addEventListener(e,t,n),M.push({eventType:e,handler:t,options:n})}function fe(){K.props.touchHold&&!K.props.target&&(oe("touchstart",ve,p),oe("touchend",ye,p)),K.props.trigger.trim().split(" ").forEach(function(e){if("manual"!==e)if(K.props.target)switch(e){case"mouseenter":oe("mouseover",we),oe("mouseout",Ee);break;case"focus":oe("focusin",we),oe("focusout",Ee);break;case"click":oe(e,we)}else switch(oe(e,ve),e){case"mouseenter":oe("mouseleave",ye);break;case"focus":oe(i?"focusout":"blur",_e)}})}function pe(){M.forEach(function(e){var t=e.eventType,n=e.handler,r=e.options;J().removeEventListener(t,n,r)}),M=[]}function me(e){var r=s=e,i=r.clientX,a=r.clientY;if(k){var o=f(e.target,function(e){return e===n}),l=n.getBoundingClientRect(),u=K.props.followCursor,c="horizontal"===u,d="vertical"===u,h=G(["top","bottom"],se(D)),p=D.getAttribute(v),m=!!p&&!!p.split("-")[1],g=h?D.offsetWidth:D.offsetHeight,y=g/2,_=h?0:m?g:y,w=h?m?g:y:0;!o&&K.props.interactive||(K.popperInstance.reference=t({},K.popperInstance.reference,{clientWidth:0,clientHeight:0,getBoundingClientRect:function(){return{width:h?g:0,height:h?0:g,top:(c?l.top:a)-_,bottom:(c?l.bottom:a)+_,left:(d?l.left:i)-w,right:(d?l.right:i)+w}}}),K.popperInstance.update()),"initial"===u&&K.state.isVisible&&z()}}function ve(e){K.state.isEnabled&&!be(e)&&(K.state.isVisible||(a=e.type,e instanceof MouseEvent&&(s=e,de.forEach(function(t){return t(e)}))),"click"===e.type&&!1!==K.props.hideOnClick&&K.state.isVisible?Ce():ke(e))}function ge(e){var t=h(e.target,C)===D,r=f(e.target,function(e){return e===n});t||r||function(e,t,n,r){if(!e)return!0;var i=n.clientX,a=n.clientY,s=r.interactiveBorder,o=r.distance,l=t.top-a>("top"===e?s+o:s),u=a-t.bottom>("bottom"===e?s+o:s),c=t.left-i>("left"===e?s+o:s),d=i-t.right>("right"===e?s+o:s);return l||u||c||d}(se(D),D.getBoundingClientRect(),e,K.props)&&(Z(),Ce())}function ye(e){if(!be(e))return K.props.interactive?(document.body.addEventListener("mouseleave",Ce),document.addEventListener("mousemove",P),void de.push(P)):void Ce()}function _e(e){e.target===J()&&(K.props.interactive&&e.relatedTarget&&D.contains(e.relatedTarget)||Ce())}function we(e){h(e.target,K.props.target)&&ke(e)}function Ee(e){h(e.target,K.props.target)&&Ce()}function be(e){var t="ontouchstart"in window,n=G(e.type,"touch"),r=K.props.touchHold;return t&&N&&r&&!n||N&&!r&&n}function Se(){!x&&S&&(x=!0,D.offsetHeight,S())}function Te(){var r=K.props.popperOptions,i=K.popperChildren,a=i.tooltip,s=i.arrow,o=H(r,"preventOverflow");function l(e){K.props.flip&&!K.props.flipOnUpdate&&(e.flipped&&(K.popperInstance.options.placement=e.placement),q(K.popperInstance.modifiers,!1)),a.setAttribute(v,e.placement),!1!==e.attributes[g]?a.setAttribute(g,""):a.removeAttribute(g),b&&b!==e.placement&&R&&(a.style.transition="none",requestAnimationFrame(function(){a.style.transition=""})),b=e.placement,R=K.state.isVisible;var n=se(D),r=a.style;r.top=r.bottom=r.left=r.right="",r[n]=-(K.props.distance-10)+"px";var i=o&&void 0!==o.padding?o.padding:m,s="number"==typeof i,l=t({top:s?i:i.top,bottom:s?i:i.bottom,left:s?i:i.left,right:s?i:i.right},!s&&i);l[n]=s?i+K.props.distance:(i[n]||0)+K.props.distance,K.popperInstance.modifiers.filter(function(e){return"preventOverflow"===e.name})[0].padding=l,k=l}var u=t({eventsEnabled:!1,placement:K.props.placement},r,{modifiers:t({},r?r.modifiers:{},{preventOverflow:t({boundariesElement:K.props.boundary,padding:m},o),arrow:t({element:s,enabled:!!s},H(r,"arrow")),flip:t({enabled:K.props.flip,padding:K.props.distance+m,behavior:K.props.flipBehavior},H(r,"flip")),offset:t({offset:K.props.offset},H(r,"offset"))}),onCreate:function(e){l(e),Se(),r&&r.onCreate&&r.onCreate(e)},onUpdate:function(e){l(e),Se(),r&&r.onUpdate&&r.onUpdate(e)}});K.popperInstance=new e(n,D,u)}function ke(e,n){if(Ae(),!K.state.isVisible){if(K.props.target)return function(e){if(e){var n=h(e.target,K.props.target);n&&!n._tippy&&he(n,t({},K.props,{content:W(r.content,[n]),appendTo:r.appendTo,target:"",showOnInit:!0}))}}(e);if(A=!0,e&&!n&&K.props.onTrigger(K,e),K.props.wait)return K.props.wait(K,e);re()&&!K.state.isMounted&&(K.popperInstance||Te(),document.addEventListener("mousemove",me)),te();var i=B(K.props.delay,0,o.delay);i?u=setTimeout(function(){Re()},i):Re()}}function Ce(){if(Ae(),!K.state.isVisible)return z();A=!1;var e=B(K.props.delay,1,o.delay);e?y=setTimeout(function(){K.state.isVisible&&xe()},e):w=requestAnimationFrame(function(){xe()})}function Ie(e){if(!K.props.interactive||!D.contains(e.target)){if(J().contains(e.target)){if(N)return;if(K.state.isVisible&&G(K.props.trigger,"click"))return}!0===K.props.hideOnClick&&(Ae(),xe())}}function Ae(){clearTimeout(u),clearTimeout(y),cancelAnimationFrame(w)}function Le(e){Q(e=e||{},o),pe();var r=K.props,i=$(n,t({},K.props,e,{ignoreAttributes:!0}));i.ignoreAttributes=F(e,"ignoreAttributes")?e.ignoreAttributes||!1:r.ignoreAttributes,K.props=i,fe(),Z(),P=V(ge,i.interactiveDebounce),ue(D,r,i),K.popperChildren=ee(D),K.popperInstance&&(l.some(function(t){return F(e,t)&&e[t]!==r[t]})?(K.popperInstance.destroy(),Te(),K.state.isVisible&&K.popperInstance.enableEventListeners(),K.props.followCursor&&s&&me(s)):K.popperInstance.update())}function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(K.props.duration,0,o.duration[1]);if(!K.state.isDestroyed&&K.state.isEnabled&&(!N||K.props.touch)&&!J().hasAttribute("disabled")&&!1!==K.props.onShow(K)){te(),D.style.visibility="visible",K.state.isVisible=!0,K.props.interactive&&J().classList.add(_);var t=ne();Y(t.concat(D),0),S=function(){if(K.state.isVisible){var n=re();n&&s?me(s):n||K.popperInstance.update(),K.popperChildren.backdrop&&(K.popperChildren.content.style.transitionDelay=Math.round(e/12)+"ms"),K.props.sticky&&(Y([D],i?0:K.props.updateDuration),function e(){K.popperInstance.scheduleUpdate(),K.state.isMounted?requestAnimationFrame(e):Y([D],0)}()),Y([D],K.props.updateDuration),Y(t,e),X(t,"visible"),function(e,t){ie(e,function(){K.props.aria&&J().setAttribute("aria-".concat(K.props.aria),D.id),K.props.onShown(K),K.state.isShown=!0})}(e)}},function(){x=!1;var e=re();K.popperInstance?(q(K.popperInstance.modifiers,K.props.flip),e||(K.popperInstance.reference=n,K.popperInstance.enableEventListeners()),K.popperInstance.scheduleUpdate()):(Te(),e||K.popperInstance.enableEventListeners());var t=K.props.appendTo,r="parent"===t?n.parentNode:W(t,[n]);r.contains(D)||(r.appendChild(D),K.props.onMount(K),K.state.isMounted=!0)}()}}function xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(K.props.duration,1,o.duration[1]);if(!K.state.isDestroyed&&(K.state.isEnabled||L)&&(!1!==K.props.onHide(K)||L)){document.removeEventListener("click",Ie,!0),D.style.visibility="hidden",K.state.isVisible=!1,K.state.isShown=!1,R=!1,K.props.interactive&&J().classList.remove(_);var t=ne();Y(t,e),X(t,"hidden"),function(e,t){ie(e,function(){!K.state.isVisible&&D.parentNode&&D.parentNode.contains(D)&&(A||z(),K.props.aria&&J().removeAttribute("aria-".concat(K.props.aria)),K.popperInstance.disableEventListeners(),K.popperInstance.options.placement=K.props.placement,D.parentNode.removeChild(D),K.props.onHidden(K),K.state.isMounted=!1)})}(e)}}}var fe=!1;function pe(e,n){Q(n||{},o),fe||(document.addEventListener("touchstart",M,p),window.addEventListener("blur",D),fe=!0);var r,i=t({},o,n);r=e,"[object Object]"!=={}.toString.call(r)||r.addEventListener||function(e){var t={isVirtual:!0,attributes:e.attributes||{},contains:function(){},setAttribute:function(t,n){e.attributes[t]=n},getAttribute:function(t){return e.attributes[t]},removeAttribute:function(t){delete e.attributes[t]},hasAttribute:function(t){return t in e.attributes},addEventListener:function(){},removeEventListener:function(){},classList:{classNames:{},add:function(t){e.classList.classNames[t]=!0},remove:function(t){delete e.classList.classNames[t]},contains:function(t){return t in e.classList.classNames}}};for(var n in t)e[n]=t[n]}(e);var a=function(e){if(K(e))return[e];if(e instanceof NodeList)return d(e);if(Array.isArray(e))return e;try{return d(document.querySelectorAll(e))}catch(e){return[]}}(e).reduce(function(e,t){var n=t&&he(t,i);return n&&e.push(n),e},[]);return K(e)?a[0]:a}return pe.version="4.3.4",pe.defaults=o,pe.setDefaults=function(e){Object.keys(e).forEach(function(t){o[t]=e[t]})},pe.hideAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.exclude,n=e.duration;d(document.querySelectorAll(C)).forEach(function(e){var r,i=e._tippy;if(i){var a=!1;t&&(a=(r=t)._tippy&&!c.call(r,C)?i.reference===t:e===t.popper),a||i.hide(n)}})},pe.group=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.delay,i=void 0===r?e[0].props.delay:r,a=n.duration,s=void 0===a?0:a,o=!1;function l(e){o=e,h()}function u(t){t._originalProps.onShow(t),e.forEach(function(e){e.set({duration:s}),e.state.isVisible&&e.hide()}),l(!0)}function c(e){e._originalProps.onHide(e),l(!1)}function d(e){e._originalProps.onShown(e),e.set({duration:e._originalProps.duration})}function h(){e.forEach(function(e){e.set({onShow:u,onShown:d,onHide:c,delay:o?[0,Array.isArray(i)?i[1]:i]:i,duration:o?s:e._originalProps.duration})})}e.forEach(function(e){e._originalProps?e.set(e._originalProps):e._originalProps=t({},e.props)}),h()},n&&setTimeout(function(){d(document.querySelectorAll("[data-tippy]")).forEach(function(e){var t=e.getAttribute("data-tippy");t&&pe(e,{content:t})})}),pe}(n(13))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__13__},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.goog=window.goog||{};window.goog;window.asserts=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"assert",value:function(e,t){console.assert&&console.assert(e,t)}}],(r=null)&&n(t.prototype,r),i&&n(t,i),e}(),window.asserts.ENABLE_ASSERTS&&console.assert&&(window.asserts.assert=function(e,t){return console.assert(e,t)})},function(e,t,n){(function(t,n){var r;e.exports=function e(t,n,i){function a(o,l){if(!n[o]){if(!t[o]){var u="function"==typeof r&&r;if(!l&&u)return r(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n||e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof r&&r,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){var r=e("./utils").addDataAttr,i=e("./browser");t.exports=function(e,t){r(t,i.currentScript(e)),void 0===t.isFileProtocol&&(t.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(e.location.protocol)),t.async=t.async||!1,t.fileAsync=t.fileAsync||!1,t.poll=t.poll||(t.isFileProtocol?1e3:1500),t.env=t.env||("127.0.0.1"==e.location.hostname||"0.0.0.0"==e.location.hostname||"localhost"==e.location.hostname||e.location.port&&e.location.port.length>0||t.isFileProtocol?"development":"production");var n=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(e.location.hash);n&&(t.dumpLineNumbers=n[1]),void 0===t.useFileCache&&(t.useFileCache=!0),void 0===t.onReady&&(t.onReady=!0),t.relativeUrls&&(t.rewriteUrls="all")}},{"./browser":3,"./utils":11}],2:[function(e,t,n){e("promise/polyfill");var r=e("../less/default-options")();if(window.less)for(key in window.less)window.less.hasOwnProperty(key)&&(r[key]=window.less[key]);e("./add-default-options")(window,r),r.plugins=r.plugins||[],window.LESS_PLUGINS&&(r.plugins=r.plugins.concat(window.LESS_PLUGINS));var i,a,s,o=t.exports=e("./index")(window,r);function l(e){e.filename&&console.warn(e),r.async||a.removeChild(s)}window.less=o,r.onReady&&(/!watch/.test(window.location.hash)&&o.watch(),r.async||(i="body { display: none !important }",a=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("style")).type="text/css",s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),a.appendChild(s)),o.registerStylesheetsImmediately(),o.pageLoadFinished=o.refresh("development"===o.env).then(l,l))},{"../less/default-options":17,"./add-default-options":1,"./index":8,"promise/polyfill":104}],3:[function(e,t,n){var r=e("./utils");t.exports={createCSS:function(e,t,n){var i=n.href||"",a="less:"+(n.title||r.extractId(i)),s=e.getElementById(a),o=!1,l=e.createElement("style");l.setAttribute("type","text/css"),n.media&&l.setAttribute("media",n.media),l.id=a,l.styleSheet||(l.appendChild(e.createTextNode(t)),o=null!==s&&s.childNodes.length>0&&l.childNodes.length>0&&s.firstChild.nodeValue===l.firstChild.nodeValue);var u=e.getElementsByTagName("head")[0];if(null===s||!1===o){var c=n&&n.nextSibling||null;c?c.parentNode.insertBefore(l,c):u.appendChild(l)}if(s&&!1===o&&s.parentNode.removeChild(s),l.styleSheet)try{l.styleSheet.cssText=t}catch(e){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(e){var t,n=e.document;return n.currentScript||(t=n.getElementsByTagName("script"))[t.length-1]}}},{"./utils":11}],4:[function(e,t,n){t.exports=function(e,t,n){var r=null;if("development"!==t.env)try{r=void 0===e.localStorage?null:e.localStorage}catch(e){}return{setCSS:function(e,t,i,a){if(r){n.info("saving "+e+" to cache.");try{r.setItem(e,a),r.setItem(e+":timestamp",t),i&&r.setItem(e+":vars",JSON.stringify(i))}catch(t){n.error('failed to save "'+e+'" to local storage for caching.')}}},getCSS:function(e,t,n){var i=r&&r.getItem(e),a=r&&r.getItem(e+":timestamp"),s=r&&r.getItem(e+":vars");if(n=n||{},s=s||"{}",a&&t.lastModified&&new Date(t.lastModified).valueOf()===new Date(a).valueOf()&&JSON.stringify(n)===s)return i}}}},{}],5:[function(e,t,n){var r=e("./utils"),i=e("./browser");t.exports=function(e,t,n){return{add:function(a,s){n.errorReporting&&"html"!==n.errorReporting?"console"===n.errorReporting?function(e,r){var i=e.filename||r,a=[],s=(e.type||"Syntax")+"Error: "+(e.message||"There is an error in your .less file")+" in "+i,o=function(e,t,n){void 0!==e.extract[t]&&a.push("{line} {content}".replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};e.line&&(o(e,0,""),o(e,1,"line"),o(e,2,""),s+=" on line "+e.line+", column "+(e.column+1)+":\n"+a.join("\n")),e.stack&&(e.extract||n.logLevel>=4)&&(s+="\nStack Trace\n"+e.stack),t.logger.error(s)}(a,s):"function"==typeof n.errorReporting&&n.errorReporting("add",a,s):function(t,a){var s,o,l="less-error-message:"+r.extractId(a||""),u=e.document.createElement("div"),c=[],d=t.filename||a,h=d.match(/([^\/]+(\?.*)?)$/)[1];u.id=l,u.className="less-error-message",o="<h3>"+(t.type||"Syntax")+"Error: "+(t.message||"There is an error in your .less file")+'</h3><p>in <a href="'+d+'">'+h+"</a> ";var f=function(e,t,n){void 0!==e.extract[t]&&c.push('<li><label>{line}</label><pre class="{class}">{content}</pre></li>'.replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};t.line&&(f(t,0,""),f(t,1,"line"),f(t,2,""),o+="on line "+t.line+", column "+(t.column+1)+":</p><ul>"+c.join("")+"</ul>"),t.stack&&(t.extract||n.logLevel>=4)&&(o+="<br/>Stack Trace</br />"+t.stack.split("\n").slice(1).join("<br/>")),u.innerHTML=o,i.createCSS(e.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),u.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===n.env&&(s=setInterval(function(){var t=e.document,n=t.body;n&&(t.getElementById(l)?n.replaceChild(u,t.getElementById(l)):n.insertBefore(u,n.firstChild),clearInterval(s))},10))}(a,s)},remove:function(t){n.errorReporting&&"html"!==n.errorReporting?"console"===n.errorReporting||"function"==typeof n.errorReporting&&n.errorReporting("remove",t):function(t){var n=e.document.getElementById("less-error-message:"+r.extractId(t));n&&n.parentNode.removeChild(n)}(t)}}}},{"./browser":3,"./utils":11}],6:[function(e,t,n){t.exports=function(t,n){var r=e("../less/environment/abstract-file-manager.js"),i={},a=function(){};return(a.prototype=new r).alwaysMakePathsAbsolute=function(){return!0},a.prototype.join=function(e,t){return e?this.extractUrlParts(t,e).path:t},a.prototype.doXHR=function(e,r,i,a){var s=new XMLHttpRequest,o=!t.isFileProtocol||t.fileAsync;function l(t,n,r){t.status>=200&&t.status<300?n(t.responseText,t.getResponseHeader("Last-Modified")):"function"==typeof r&&r(t.status,e)}"function"==typeof s.overrideMimeType&&s.overrideMimeType("text/css"),n.debug("XHR: Getting '"+e+"'"),s.open("GET",e,o),s.setRequestHeader("Accept",r||"text/x-less, text/css; q=0.9, */*; q=0.5"),s.send(null),t.isFileProtocol&&!t.fileAsync?0===s.status||s.status>=200&&s.status<300?i(s.responseText):a(s.status,e):o?s.onreadystatechange=function(){4==s.readyState&&l(s,i,a)}:l(s,i,a)},a.prototype.supports=function(e,t,n,r){return!0},a.prototype.clearFileCache=function(){i={}},a.prototype.loadFile=function(e,t,n,r){t&&!this.isPathAbsolute(e)&&(e=t+e),e=n.ext?this.tryAppendExtension(e,n.ext):e,n=n||{};var a=this.extractUrlParts(e,window.location.href),s=a.url,o=this;return new Promise(function(e,t){if(n.useFileCache&&i[s])try{var r=i[s];return e({contents:r,filename:s,webInfo:{lastModified:new Date}})}catch(e){return t({filename:s,message:"Error loading file "+s+" error was "+e.message})}o.doXHR(s,n.mime,function(t,n){i[s]=t,e({contents:t,filename:s,webInfo:{lastModified:n}})},function(e,n){t({type:"File",message:"'"+n+"' wasn't found ("+e+")",href:s})})})},a}},{"../less/environment/abstract-file-manager.js":18}],7:[function(e,t,n){t.exports=function(){var t=e("./../less/functions/function-registry");function n(){throw{type:"Runtime",message:"Image size functions are not supported in browser version of less"}}var r={"image-size":function(e){return n(),-1},"image-width":function(e){return n(),-1},"image-height":function(e){return n(),-1}};t.addMultiple(r)}},{"./../less/functions/function-registry":27}],8:[function(e,t,n){var r=e("./utils").addDataAttr,i=e("./browser");t.exports=function(t,n){var a=t.document,s=e("../less")();s.options=n;var o=s.environment,l=e("./file-manager")(n,s.logger),u=new l;o.addFileManager(u),s.FileManager=l,s.PluginLoader=e("./plugin-loader"),e("./log-listener")(s,n);var c=e("./error-reporting")(t,s,n),d=s.cache=n.cache||e("./cache")(t,n,s.logger);e("./image-size")(s.environment),n.functions&&s.functions.functionRegistry.addMultiple(n.functions);var h=/^text\/(x-)?less$/;function f(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function p(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var r=n.concat(Array.prototype.slice.call(arguments,0));return e.apply(t,r)}}function m(e){for(var t,r=a.getElementsByTagName("style"),i=0;i<r.length;i++)if((t=r[i]).type.match(h)){var o=f(n);o.modifyVars=e;var l=t.innerHTML||"";o.filename=a.location.href.replace(/#.*$/,""),s.render(l,o,p(function(e,t,n){t?c.add(t,"inline"):(e.type="text/css",e.styleSheet?e.styleSheet.cssText=n.css:e.innerHTML=n.css)},null,t))}}function v(e,t,i,a,l){var h=f(n);r(h,e),h.mime=e.type,l&&(h.modifyVars=l),u.loadFile(e.href,null,h,o).then(function(n){!function(n){var r=n.contents,o=n.filename,l=n.webInfo,f={currentDirectory:u.getPath(o),filename:o,rootFilename:o,rewriteUrls:h.rewriteUrls};if(f.entryPath=f.currentDirectory,f.rootpath=h.rootpath||f.currentDirectory,l){l.remaining=a;var p=d.getCSS(o,l,h.modifyVars);if(!i&&p)return l.local=!0,void t(null,p,r,e,l,o)}c.remove(o),h.rootFileInfo=f,s.render(r,h,function(n,i){n?(n.href=o,t(n)):(d.setCSS(e.href,l.lastModified,h.modifyVars,i.css),t(null,i.css,r,e,l,o))})}(n)}).catch(function(e){console.log(e),t(e)})}function g(e,t,n){for(var r=0;r<s.sheets.length;r++)v(s.sheets[r],e,t,s.sheets.length-(r+1),n)}return s.watch=function(){return s.watchMode||(s.env="development","development"===s.env&&(s.watchTimer=setInterval(function(){s.watchMode&&(u.clearFileCache(),g(function(e,n,r,a,s){e?c.add(e,e.href||a.href):n&&i.createCSS(t.document,n,a)}))},n.poll))),this.watchMode=!0,!0},s.unwatch=function(){return clearInterval(s.watchTimer),this.watchMode=!1,!1},s.registerStylesheetsImmediately=function(){var e=a.getElementsByTagName("link");s.sheets=[];for(var t=0;t<e.length;t++)("stylesheet/less"===e[t].rel||e[t].rel.match(/stylesheet/)&&e[t].type.match(h))&&s.sheets.push(e[t])},s.registerStylesheets=function(){return new Promise(function(e,t){s.registerStylesheetsImmediately(),e()})},s.modifyVars=function(e){return s.refresh(!0,e,!1)},s.refresh=function(e,n,r){return(e||r)&&!1!==r&&u.clearFileCache(),new Promise(function(r,a){var o,l,u,d;o=l=new Date,0===(d=s.sheets.length)?(l=new Date,u=l-o,s.logger.info("Less has finished and no sheets were loaded."),r({startTime:o,endTime:l,totalMilliseconds:u,sheets:s.sheets.length})):g(function(e,n,h,f,p){if(e)return c.add(e,e.href||f.href),void a(e);p.local?s.logger.info("Loading "+f.href+" from cache."):s.logger.info("Rendered "+f.href+" successfully."),i.createCSS(t.document,n,f),s.logger.info("CSS for "+f.href+" generated in "+(new Date-l)+"ms"),0==--d&&(u=new Date-o,s.logger.info("Less has finished. CSS generated in "+u+"ms"),r({startTime:o,endTime:l,totalMilliseconds:u,sheets:s.sheets.length})),l=new Date},e,n),m(n)})},s.refreshStyles=m,s}},{"../less":37,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./image-size":7,"./log-listener":9,"./plugin-loader":10,"./utils":11}],9:[function(e,t,n){t.exports=function(e,t){t.logLevel=void 0!==t.logLevel?t.logLevel:"development"===t.env?3:1,t.loggers||(t.loggers=[{debug:function(e){t.logLevel>=4&&console.log(e)},info:function(e){t.logLevel>=3&&console.log(e)},warn:function(e){t.logLevel>=2&&console.warn(e)},error:function(e){t.logLevel>=1&&console.error(e)}}]);for(var n=0;n<t.loggers.length;n++)e.logger.addListener(t.loggers[n])}},{}],10:[function(e,t,n){var r=e("../less/environment/abstract-plugin-loader.js"),i=function(e){this.less=e};(i.prototype=new r).loadPlugin=function(e,t,n,r,i){return new Promise(function(a,s){i.loadFile(e,t,n,r).then(a).catch(s)})},t.exports=i},{"../less/environment/abstract-plugin-loader.js":19}],11:[function(e,t,n){t.exports={extractId:function(e){return e.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(e,t){for(var n in t.dataset)if(t.dataset.hasOwnProperty(n))if("env"===n||"dumpLineNumbers"===n||"rootpath"===n||"errorReporting"===n)e[n]=t.dataset[n];else try{e[n]=JSON.parse(t.dataset[n])}catch(e){}}}},{}],12:[function(e,t,n){t.exports={Math:{ALWAYS:0,PARENS_DIVISION:1,PARENS:2,STRICT_LEGACY:3},RewriteUrls:{OFF:0,LOCAL:1,ALL:2}}},{}],13:[function(e,t,n){var r={};t.exports=r;var i=e("./constants"),a=function(e,t,n){if(e)for(var r=0;r<n.length;r++)e.hasOwnProperty(n[r])&&(t[n[r]]=e[n[r]])},s=["paths","rewriteUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","pluginManager"];r.Parse=function(e){a(e,this,s),"string"==typeof this.paths&&(this.paths=[this.paths])};var o=["paths","compress","ieCompat","math","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope","rewriteUrls"];function l(e){return!/^(?:[a-z-]+:|\/|#)/i.test(e)}function u(e){return"."===e.charAt(0)}r.Eval=function(e,t){a(e,this,o),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=t||[],this.importantScope=this.importantScope||[]},r.Eval.prototype.enterCalc=function(){this.calcStack||(this.calcStack=[]),this.calcStack.push(!0),this.inCalc=!0},r.Eval.prototype.exitCalc=function(){this.calcStack.pop(),this.calcStack||(this.inCalc=!1)},r.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},r.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},r.Eval.prototype.inCalc=!1,r.Eval.prototype.mathOn=!0,r.Eval.prototype.isMathOn=function(e){return!!this.mathOn&&!!("/"!==e||this.math===i.Math.ALWAYS||this.parensStack&&this.parensStack.length)&&(!(this.math>i.Math.PARENS_DIVISION)||this.parensStack&&this.parensStack.length)},r.Eval.prototype.pathRequiresRewrite=function(e){var t=this.rewriteUrls===i.RewriteUrls.LOCAL?u:l;return t(e)},r.Eval.prototype.rewritePath=function(e,t){var n;return t=t||"",n=this.normalizePath(t+e),u(e)&&l(t)&&!1===u(n)&&(n="./"+n),n},r.Eval.prototype.normalizePath=function(e){var t,n=e.split("/").reverse();for(e=[];0!==n.length;)switch(t=n.pop()){case".":break;case"..":0===e.length||".."===e[e.length-1]?e.push(t):e.pop();break;default:e.push(t)}return e.join("/")}},{"./constants":12}],14:[function(e,t,n){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],15:[function(e,t,n){t.exports={colors:e("./colors"),unitConversions:e("./unit-conversions")}},{"./colors":14,"./unit-conversions":16}],16:[function(e,t,n){t.exports={length:{m:1,cm:.01,mm:.001,in:.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],17:[function(e,t,n){t.exports=function(){return{javascriptEnabled:!1,depends:!1,compress:!1,lint:!1,paths:[],color:!0,strictImports:!1,insecure:!1,rootpath:"",rewriteUrls:!1,ieCompat:!1,math:0,strictUnits:!1,globalVars:null,modifyVars:null,urlArgs:""}}},{}],18:[function(e,t,n){var r=function(){};r.prototype.getPath=function(e){var t=e.lastIndexOf("?");return t>0&&(e=e.slice(0,t)),(t=e.lastIndexOf("/"))<0&&(t=e.lastIndexOf("\\")),t<0?"":e.slice(0,t+1)},r.prototype.tryAppendExtension=function(e,t){return/(\.[a-z]*$)|([\?;].*)$/.test(e)?e:e+t},r.prototype.tryAppendLessExtension=function(e){return this.tryAppendExtension(e,".less")},r.prototype.supportsSync=function(){return!1},r.prototype.alwaysMakePathsAbsolute=function(){return!1},r.prototype.isPathAbsolute=function(e){return/^(?:[a-z-]+:|\/|\\|#)/i.test(e)},r.prototype.join=function(e,t){return e?e+t:t},r.prototype.pathDiff=function(e,t){var n,r,i,a,s=this.extractUrlParts(e),o=this.extractUrlParts(t),l="";if(s.hostPart!==o.hostPart)return"";for(r=Math.max(o.directories.length,s.directories.length),n=0;n<r&&o.directories[n]===s.directories[n];n++);for(a=o.directories.slice(n),i=s.directories.slice(n),n=0;n<a.length-1;n++)l+="../";for(n=0;n<i.length-1;n++)l+=i[n]+"/";return l},r.prototype.extractUrlParts=function(e,t){var n,r,i=/^((?:[a-z-]+:)?\/{2}(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,a=e.match(i),s={},o=[],l=[];if(!a)throw new Error("Could not parse sheet href - '"+e+"'");if(t&&(!a[1]||a[2])){if(!(r=t.match(i)))throw new Error("Could not parse page url - '"+t+"'");a[1]=a[1]||r[1]||"",a[2]||(a[3]=r[3]+a[3])}if(a[3])for(o=a[3].replace(/\\/g,"/").split("/"),n=0;n<o.length;n++)".."===o[n]?l.pop():"."!==o[n]&&l.push(o[n]);return s.hostPart=a[1],s.directories=l,s.rawPath=(a[1]||"")+o.join("/"),s.path=(a[1]||"")+l.join("/"),s.filename=a[4],s.fileUrl=s.path+(a[4]||""),s.url=s.fileUrl+(a[5]||""),s},t.exports=r},{}],19:[function(e,t,n){var r=e("../functions/function-registry"),i=e("../less-error"),a=function(){this.require=function(){return null}};a.prototype.evalPlugin=function(e,t,n,a,s){var o,l,u,c,d,h;c=t.pluginManager,s&&(d="string"==typeof s?s:s.filename);var f=(new this.less.FileManager).extractUrlParts(d).filename;if(d&&(l=c.get(d))){if(h=this.trySetOptions(l,d,f,a))return h;try{l.use&&l.use.call(this.context,l)}catch(e){return e.message=e.message||"Error during @plugin call",new i(e,n,d)}return l}u={exports:{},pluginManager:c,fileInfo:s},o=r.create();try{new Function("module","require","registerPlugin","functions","tree","less","fileInfo",e)(u,this.require(d),function(e){l=e},o,this.less.tree,this.less,s)}catch(e){return new i(e,n,d)}if(l||(l=u.exports),(l=this.validatePlugin(l,d,f))instanceof i)return l;if(!l)return new i({message:"Not a valid plugin"},n,d);if(l.imports=n,l.filename=d,(!l.minVersion||this.compareVersion("3.0.0",l.minVersion)<0)&&(h=this.trySetOptions(l,d,f,a)))return h;if(c.addPlugin(l,s.filename,o),l.functions=o.getLocalFunctions(),h=this.trySetOptions(l,d,f,a))return h;try{l.use&&l.use.call(this.context,l)}catch(e){return e.message=e.message||"Error during @plugin call",new i(e,n,d)}return l},a.prototype.trySetOptions=function(e,t,n,r){if(r&&!e.setOptions)return new i({message:"Options have been provided but the plugin "+n+" does not support any options."});try{e.setOptions&&e.setOptions(r)}catch(e){return new i(e)}},a.prototype.validatePlugin=function(e,t,n){return e?("function"==typeof e&&(e=new e),e.minVersion&&this.compareVersion(e.minVersion,this.less.version)<0?new i({message:"Plugin "+n+" requires version "+this.versionToString(e.minVersion)}):e):null},a.prototype.compareVersion=function(e,t){"string"==typeof e&&(e=e.match(/^(\d+)\.?(\d+)?\.?(\d+)?/)).shift();for(var n=0;n<e.length;n++)if(e[n]!==t[n])return parseInt(e[n])>parseInt(t[n])?-1:1;return 0},a.prototype.versionToString=function(e){for(var t="",n=0;n<e.length;n++)t+=(t?".":"")+e[n];return t},a.prototype.printUsage=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.printUsage&&n.printUsage()}},t.exports=a},{"../functions/function-registry":27,"../less-error":38}],20:[function(e,t,n){var r=e("../logger"),i=function(e,t){this.fileManagers=t||[],e=e||{};for(var n=[],r=n.concat(["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"]),i=0;i<r.length;i++){var a=r[i],s=e[a];s?this[a]=s.bind(e):i<n.length&&this.warn("missing required function in environment - "+a)}};i.prototype.getFileManager=function(e,t,n,i,a){e||r.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==t&&r.warn("getFileManager called with null directory.. Please report this issue. continuing.");var s=this.fileManagers;n.pluginManager&&(s=[].concat(s).concat(n.pluginManager.getFileManagers()));for(var o=s.length-1;o>=0;o--){var l=s[o];if(l[a?"supportsSync":"supports"](e,t,n,i))return l}return null},i.prototype.addFileManager=function(e){this.fileManagers.push(e)},i.prototype.clearFileManagers=function(){this.fileManagers=[]},t.exports=i},{"../logger":39}],21:[function(e,t,n){var r=e("./function-registry"),i=e("../tree/anonymous"),a=e("../tree/keyword");r.addMultiple({boolean:function(e){return e?a.True:a.False},if:function(e,t,n){return e?t:n||new i}})},{"../tree/anonymous":50,"../tree/keyword":70,"./function-registry":27}],22:[function(e,t,n){var r=e("../tree/color"),i=e("./function-registry");function a(e,t,n){var i,a,s,o,l=t.alpha,u=n.alpha,c=[];s=u+l*(1-u);for(var d=0;d<3;d++)i=t.rgb[d]/255,a=n.rgb[d]/255,o=e(i,a),s&&(o=(u*a+l*(i-u*(i+a-o)))/s),c[d]=255*o;return new r(c,s)}var s={multiply:function(e,t){return e*t},screen:function(e,t){return e+t-e*t},overlay:function(e,t){return(e*=2)<=1?s.multiply(e,t):s.screen(e-1,t)},softlight:function(e,t){var n=1,r=e;return t>.5&&(r=1,n=e>.25?Math.sqrt(e):((16*e-12)*e+4)*e),e-(1-2*t)*r*(n-e)},hardlight:function(e,t){return s.overlay(t,e)},difference:function(e,t){return Math.abs(e-t)},exclusion:function(e,t){return e+t-2*e*t},average:function(e,t){return(e+t)/2},negation:function(e,t){return 1-Math.abs(e+t-1)}};for(var o in s)s.hasOwnProperty(o)&&(a[o]=a.bind(null,s[o]));i.addMultiple(a)},{"../tree/color":55,"./function-registry":27}],23:[function(e,t,n){var r,i=e("../tree/dimension"),a=e("../tree/color"),s=e("../tree/quoted"),o=e("../tree/anonymous"),l=e("./function-registry");function u(e){return Math.min(1,Math.max(0,e))}function c(e,t){var n=r.hsla(t.h,t.s,t.l,t.a);if(n)return e.value&&/^(rgb|hsl)/.test(e.value)?n.value=e.value:n.value="rgb",n}function d(e){if(e instanceof i)return parseFloat(e.unit.is("%")?e.value/100:e.value);if("number"==typeof e)return e;throw{type:"Argument",message:"color functions take numbers as parameters"}}r={rgb:function(e,t,n){var i=r.rgba(e,t,n,1);if(i)return i.value="rgb",i},rgba:function(e,t,n,r){try{if(e instanceof a)return r=t?d(t):e.alpha,new a(e.rgb,r,"rgba");var s=[e,t,n].map(function(e){return n=255,(t=e)instanceof i&&t.unit.is("%")?parseFloat(t.value*n/100):d(t);var t,n});return r=d(r),new a(s,r,"rgba")}catch(e){}},hsl:function(e,t,n){var i=r.hsla(e,t,n,1);if(i)return i.value="hsl",i},hsla:function(e,t,n,r){try{if(e instanceof a)return r=t?d(t):e.alpha,new a(e.rgb,r,"hsla");var i,s;function o(e){return 6*(e=e<0?e+1:e>1?e-1:e)<1?i+(s-i)*e*6:2*e<1?s:3*e<2?i+(s-i)*(2/3-e)*6:i}e=d(e)%360/360,t=u(d(t)),n=u(d(n)),r=u(d(r)),i=2*n-(s=n<=.5?n*(t+1):n+t-n*t);var l=[255*o(e+1/3),255*o(e),255*o(e-1/3)];return r=d(r),new a(l,r,"hsla")}catch(e){}},hsv:function(e,t,n){return r.hsva(e,t,n,1)},hsva:function(e,t,n,i){var a,s;e=d(e)%360/360*360,t=d(t),n=d(n),i=d(i),a=Math.floor(e/60%6);var o=[n,n*(1-t),n*(1-(s=e/60-a)*t),n*(1-(1-s)*t)],l=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return r.rgba(255*o[l[a][0]],255*o[l[a][1]],255*o[l[a][2]],i)},hue:function(e){return new i(e.toHSL().h)},saturation:function(e){return new i(100*e.toHSL().s,"%")},lightness:function(e){return new i(100*e.toHSL().l,"%")},hsvhue:function(e){return new i(e.toHSV().h)},hsvsaturation:function(e){return new i(100*e.toHSV().s,"%")},hsvvalue:function(e){return new i(100*e.toHSV().v,"%")},red:function(e){return new i(e.rgb[0])},green:function(e){return new i(e.rgb[1])},blue:function(e){return new i(e.rgb[2])},alpha:function(e){return new i(e.toHSL().a)},luma:function(e){return new i(e.luma()*e.alpha*100,"%")},luminance:function(e){var t=.2126*e.rgb[0]/255+.7152*e.rgb[1]/255+.0722*e.rgb[2]/255;return new i(t*e.alpha*100,"%")},saturate:function(e,t,n){if(!e.rgb)return null;var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.s+=r.s*t.value/100:r.s+=t.value/100,r.s=u(r.s),c(e,r)},desaturate:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.s-=r.s*t.value/100:r.s-=t.value/100,r.s=u(r.s),c(e,r)},lighten:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.l+=r.l*t.value/100:r.l+=t.value/100,r.l=u(r.l),c(e,r)},darken:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.l-=r.l*t.value/100:r.l-=t.value/100,r.l=u(r.l),c(e,r)},fadein:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.a+=r.a*t.value/100:r.a+=t.value/100,r.a=u(r.a),c(e,r)},fadeout:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.a-=r.a*t.value/100:r.a-=t.value/100,r.a=u(r.a),c(e,r)},fade:function(e,t){var n=e.toHSL();return n.a=t.value/100,n.a=u(n.a),c(e,n)},spin:function(e,t){var n=e.toHSL(),r=(n.h+t.value)%360;return n.h=r<0?360+r:r,c(e,n)},mix:function(e,t,n){e.toHSL&&t.toHSL||(console.log(t.type),console.dir(t)),n||(n=new i(50));var r=n.value/100,s=2*r-1,o=e.toHSL().a-t.toHSL().a,l=((s*o==-1?s:(s+o)/(1+s*o))+1)/2,u=1-l,c=[e.rgb[0]*l+t.rgb[0]*u,e.rgb[1]*l+t.rgb[1]*u,e.rgb[2]*l+t.rgb[2]*u],d=e.alpha*r+t.alpha*(1-r);return new a(c,d)},greyscale:function(e){return r.desaturate(e,new i(100))},contrast:function(e,t,n,i){if(!e.rgb)return null;if(void 0===n&&(n=r.rgba(255,255,255,1)),void 0===t&&(t=r.rgba(0,0,0,1)),t.luma()>n.luma()){var a=n;n=t,t=a}return i=void 0===i?.43:d(i),e.luma()<i?n:t},argb:function(e){return new o(e.toARGB())},color:function(e){if(e instanceof s&&/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})$/i.test(e.value)){var t=e.value.slice(1);return new a(t,void 0,"#"+t)}if(e instanceof a||(e=a.fromKeyword(e.value)))return e.value=void 0,e;throw{type:"Argument",message:"argument must be a color keyword or 3|4|6|8 digit hex e.g. #FFF"}},tint:function(e,t){return r.mix(r.rgb(255,255,255),e,t)},shade:function(e,t){return r.mix(r.rgb(0,0,0),e,t)}},l.addMultiple(r)},{"../tree/anonymous":50,"../tree/color":55,"../tree/dimension":62,"../tree/quoted":80,"./function-registry":27}],24:[function(e,t,n){t.exports=function(t){var n=e("../tree/quoted"),r=e("../tree/url"),i=e("../utils"),a=e("./function-registry"),s=function(e,t){return new r(t,e.index,e.currentFileInfo).eval(e.context)},o=e("../logger");a.add("data-uri",function(e,a){a||(a=e,e=null);var l=e&&e.value,u=a.value,c=this.currentFileInfo,d=c.rewriteUrls?c.currentDirectory:c.entryPath,h=u.indexOf("#"),f="";-1!==h&&(f=u.slice(h),u=u.slice(0,h));var p=i.clone(this.context);p.rawBuffer=!0;var m=t.getFileManager(u,d,p,t,!0);if(!m)return s(this,a);var v=!1;if(e)v=/;base64$/.test(l);else{if("image/svg+xml"===(l=t.mimeLookup(u)))v=!1;else{var g=t.charsetLookup(l);v=["US-ASCII","UTF-8"].indexOf(g)<0}v&&(l+=";base64")}var y=m.loadFileSync(u,d,p,t);if(!y.contents)return o.warn("Skipped data-uri embedding of "+u+" because file not found"),s(this,a||e);var _=y.contents;if(v&&!t.encodeBase64)return s(this,a);_=v?t.encodeBase64(_):encodeURIComponent(_);var w="data:"+l+","+_+f;return w.length>=32768&&!1!==this.context.ieCompat?(o.warn("Skipped data-uri embedding of "+u+" because its size ("+w.length+" characters) exceeds IE8-safe 32768 characters!"),s(this,a||e)):new r(new n('"'+w+'"',w,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":39,"../tree/quoted":80,"../tree/url":85,"../utils":89,"./function-registry":27}],25:[function(e,t,n){var r=e("../tree/keyword"),i=e("./function-registry"),a={eval:function(){var e=this.value_,t=this.error_;if(t)throw t;if(null!=e)return e?r.True:r.False},value:function(e){this.value_=e},error:function(e){this.error_=e},reset:function(){this.value_=this.error_=null}};i.add("default",a.eval.bind(a)),t.exports=a},{"../tree/keyword":70,"./function-registry":27}],26:[function(e,t,n){var r=e("../tree/expression"),i=function(e,t,n,r){this.name=e.toLowerCase(),this.index=n,this.context=t,this.currentFileInfo=r,this.func=t.frames[0].functionRegistry.get(this.name)};i.prototype.isValid=function(){return Boolean(this.func)},i.prototype.call=function(e){return Array.isArray(e)&&(e=e.filter(function(e){return"Comment"!==e.type}).map(function(e){if("Expression"===e.type){var t=e.value.filter(function(e){return"Comment"!==e.type});return 1===t.length?t[0]:new r(t)}return e})),this.func.apply(this,e)},t.exports=i},{"../tree/expression":64}],27:[function(e,t,n){t.exports=function e(t){return{_data:{},add:function(e,t){e=e.toLowerCase(),this._data.hasOwnProperty(e),this._data[e]=t},addMultiple:function(e){Object.keys(e).forEach(function(t){this.add(t,e[t])}.bind(this))},get:function(e){return this._data[e]||t&&t.get(e)},getLocalFunctions:function(){return this._data},inherit:function(){return e(this)},create:function(t){return e(t)}}}(null)},{}],28:[function(e,t,n){t.exports=function(t){var n={functionRegistry:e("./function-registry"),functionCaller:e("./function-caller")};return e("./boolean"),e("./default"),e("./color"),e("./color-blending"),e("./data-uri")(t),e("./list"),e("./math"),e("./number"),e("./string"),e("./svg")(t),e("./types"),n}},{"./boolean":21,"./color":23,"./color-blending":22,"./data-uri":24,"./default":25,"./function-caller":26,"./function-registry":27,"./list":29,"./math":31,"./number":32,"./string":33,"./svg":34,"./types":35}],29:[function(e,t,n){var r=e("../tree/comment"),i=e("../tree/dimension"),a=e("../tree/declaration"),s=e("../tree/expression"),o=e("../tree/ruleset"),l=e("../tree/selector"),u=e("../tree/element"),c=e("./function-registry"),d=function(e){var t=Array.isArray(e.value)?e.value:Array(e);return t};c.addMultiple({_SELF:function(e){return e},extract:function(e,t){return t=t.value-1,d(e)[t]},length:function(e){return new i(d(e).length)},range:function(e,t,n){var r,a,o=1,l=[];t?(a=t,r=e.value,n&&(o=n.value)):(r=1,a=e);for(var u=r;u<=a.value;u+=o)l.push(new i(u,a.unit));return new s(l)},each:function(e,t){var n,s,c=[];s=e.value?Array.isArray(e.value)?e.value:[e.value]:e.ruleset?e.ruleset.rules:e.rules?e.rules:Array.isArray(e)?e:[e];var d="@value",h="@key",f="@index";t.params?(d=t.params[0]&&t.params[0].name,h=t.params[1]&&t.params[1].name,f=t.params[2]&&t.params[2].name,t=t.rules):t=t.ruleset;for(var p=0;p<s.length;p++){var m,v,g=s[p];g instanceof a?(m="string"==typeof g.name?g.name:g.name[0].value,v=g.value):(m=new i(p+1),v=g),g instanceof r||(n=t.rules.slice(0),d&&n.push(new a(d,v,!1,!1,this.index,this.currentFileInfo)),f&&n.push(new a(f,new i(p+1),!1,!1,this.index,this.currentFileInfo)),h&&n.push(new a(h,m,!1,!1,this.index,this.currentFileInfo)),c.push(new o([new l([new u("","&")])],n,t.strictImports,t.visibilityInfo())))}return new o([new l([new u("","&")])],c,t.strictImports,t.visibilityInfo()).eval(this.context)}})},{"../tree/comment":57,"../tree/declaration":60,"../tree/dimension":62,"../tree/element":63,"../tree/expression":64,"../tree/ruleset":81,"../tree/selector":82,"./function-registry":27}],30:[function(e,t,n){var r=e("../tree/dimension"),i=function(){};i._math=function(e,t,n){if(!(n instanceof r))throw{type:"Argument",message:"argument must be a number"};return null==t?t=n.unit:n=n.unify(),new r(e(parseFloat(n.value)),t)},t.exports=i},{"../tree/dimension":62}],31:[function(e,t,n){var r=e("./function-registry"),i=e("./math-helper.js"),a={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var s in a)a.hasOwnProperty(s)&&(a[s]=i._math.bind(null,Math[s],a[s]));a.round=function(e,t){var n=void 0===t?0:t.value;return i._math(function(e){return e.toFixed(n)},null,e)},r.addMultiple(a)},{"./function-registry":27,"./math-helper.js":30}],32:[function(e,t,n){var r=e("../tree/dimension"),i=e("../tree/anonymous"),a=e("./function-registry"),s=e("./math-helper.js"),o=function(e,t){switch((t=Array.prototype.slice.call(t)).length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var n,a,s,o,l,u,c,d,h=[],f={};for(n=0;n<t.length;n++)if((s=t[n])instanceof r)if(o=""===s.unit.toString()&&void 0!==d?new r(s.value,d).unify():s.unify(),u=""===o.unit.toString()&&void 0!==c?c:o.unit.toString(),c=""!==u&&void 0===c||""!==u&&""===h[0].unify().unit.toString()?u:c,d=""!==u&&void 0===d?s.unit.toString():d,void 0!==(a=void 0!==f[""]&&""!==u&&u===c?f[""]:f[u]))l=""===h[a].unit.toString()&&void 0!==d?new r(h[a].value,d).unify():h[a].unify(),(e&&o.value<l.value||!e&&o.value>l.value)&&(h[a]=s);else{if(void 0!==c&&u!==c)throw{type:"Argument",message:"incompatible types"};f[u]=h.length,h.push(s)}else Array.isArray(t[n].value)&&Array.prototype.push.apply(t,Array.prototype.slice.call(t[n].value));return 1==h.length?h[0]:(t=h.map(function(e){return e.toCSS(this.context)}).join(this.context.compress?",":", "),new i((e?"min":"max")+"("+t+")"))};a.addMultiple({min:function(){return o(!0,arguments)},max:function(){return o(!1,arguments)},convert:function(e,t){return e.convertTo(t.value)},pi:function(){return new r(Math.PI)},mod:function(e,t){return new r(e.value%t.value,e.unit)},pow:function(e,t){if("number"==typeof e&&"number"==typeof t)e=new r(e),t=new r(t);else if(!(e instanceof r&&t instanceof r))throw{type:"Argument",message:"arguments must be numbers"};return new r(Math.pow(e.value,t.value),e.unit)},percentage:function(e){var t=s._math(function(e){return 100*e},"%",e);return t}})},{"../tree/anonymous":50,"../tree/dimension":62,"./function-registry":27,"./math-helper.js":30}],33:[function(e,t,n){var r=e("../tree/quoted"),i=e("../tree/anonymous"),a=e("../tree/javascript"),s=e("./function-registry");s.addMultiple({e:function(e){return new i(e instanceof a?e.evaluated:e.value)},escape:function(e){return new i(encodeURI(e.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(e,t,n,i){var a=e.value;return n="Quoted"===n.type?n.value:n.toCSS(),a=a.replace(new RegExp(t.value,i?i.value:""),n),new r(e.quote||"",a,e.escaped)},"%":function(e){for(var t=Array.prototype.slice.call(arguments,1),n=e.value,i=0;i<t.length;i++)n=n.replace(/%[sda]/i,function(e){var n="Quoted"===t[i].type&&e.match(/s/i)?t[i].value:t[i].toCSS();return e.match(/[A-Z]$/)?encodeURIComponent(n):n});return n=n.replace(/%%/g,"%"),new r(e.quote||"",n,e.escaped)}})},{"../tree/anonymous":50,"../tree/javascript":68,"../tree/quoted":80,"./function-registry":27}],34:[function(e,t,n){t.exports=function(t){var n=e("../tree/dimension"),r=e("../tree/color"),i=e("../tree/expression"),a=e("../tree/quoted"),s=e("../tree/url"),o=e("./function-registry");o.add("svg-gradient",function(e){var t,o,l,u,c,d,h,f,p="linear",m='x="0" y="0" width="1" height="1"',v={compress:!1},g=e.toCSS(v);function y(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}switch(2==arguments.length?(arguments[1].value.length<2&&y(),t=arguments[1].value):arguments.length<3?y():t=Array.prototype.slice.call(arguments,1),g){case"to bottom":o='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":o='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":o='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":o='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":p="radial",o='cx="50%" cy="50%" r="75%"',m='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><'+p+'Gradient id="g" '+o+">",u=0;u<t.length;u+=1)t[u]instanceof i?(c=t[u].value[0],d=t[u].value[1]):(c=t[u],d=void 0),c instanceof r&&((0===u||u+1===t.length)&&void 0===d||d instanceof n)||y(),h=d?d.toCSS(v):0===u?"0%":"100%",f=c.alpha,l+='<stop offset="'+h+'" stop-color="'+c.toRGB()+'"'+(f<1?' stop-opacity="'+f+'"':"")+"/>";return l+="</"+p+"Gradient><rect "+m+' fill="url(#g)" /></svg>',l=encodeURIComponent(l),new s(new a("'"+(l="data:image/svg+xml,"+l)+"'",l,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":55,"../tree/dimension":62,"../tree/expression":64,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],35:[function(e,t,n){var r=e("../tree/keyword"),i=e("../tree/detached-ruleset"),a=e("../tree/dimension"),s=e("../tree/color"),o=e("../tree/quoted"),l=e("../tree/anonymous"),u=e("../tree/url"),c=e("../tree/operation"),d=e("./function-registry"),h=function(e,t){return e instanceof t?r.True:r.False},f=function(e,t){if(void 0===t)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(t="string"==typeof t.value?t.value:t))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return e instanceof a&&e.unit.is(t)?r.True:r.False};d.addMultiple({isruleset:function(e){return h(e,i)},iscolor:function(e){return h(e,s)},isnumber:function(e){return h(e,a)},isstring:function(e){return h(e,o)},iskeyword:function(e){return h(e,r)},isurl:function(e){return h(e,u)},ispixel:function(e){return f(e,"px")},ispercentage:function(e){return f(e,"%")},isem:function(e){return f(e,"em")},isunit:f,unit:function(e,t){if(!(e instanceof a))throw{type:"Argument",message:"the first argument to unit must be a number"+(e instanceof c?". Have you forgotten parenthesis?":"")};return t=t?t instanceof r?t.value:t.toCSS():"",new a(e.value,t)},"get-unit":function(e){return new l(e.unit)}})},{"../tree/anonymous":50,"../tree/color":55,"../tree/detached-ruleset":61,"../tree/dimension":62,"../tree/keyword":70,"../tree/operation":77,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],36:[function(e,t,n){var r=e("./contexts"),i=e("./parser/parser"),a=e("./less-error"),s=e("./utils"),o=("undefined"==typeof Promise?e("promise"):Promise,e("./logger"));t.exports=function(e){var t=function(e,t,n){this.less=e,this.rootFilename=n.filename,this.paths=t.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=t.mime,this.error=null,this.context=t,this.queue=[],this.files={}};return t.prototype.push=function(t,n,l,u,c){var d=this,h=this.context.pluginManager.Loader;this.queue.push(t);var f=function(e,n,r){d.queue.splice(d.queue.indexOf(t),1);var i=r===d.rootFilename;u.optional&&e?(c(null,{rules:[]},!1,null),o.info("The file "+r+" was skipped because it was not found and the import was marked optional.")):(d.files[r]||u.inline||(d.files[r]={root:n,options:u}),e&&!d.error&&(d.error=e),c(e,n,i,r))},p={rewriteUrls:this.context.rewriteUrls,entryPath:l.entryPath,rootpath:l.rootpath,rootFilename:l.rootFilename},m=e.getFileManager(t,l.currentDirectory,this.context,e);if(m){var v,g=function(e){var t,n=e.filename,s=e.contents.replace(/^\uFEFF/,"");p.currentDirectory=m.getPath(n),p.rewriteUrls&&(p.rootpath=m.join(d.context.rootpath||"",m.pathDiff(p.currentDirectory,p.entryPath)),!m.isPathAbsolute(p.rootpath)&&m.alwaysMakePathsAbsolute()&&(p.rootpath=m.join(p.entryPath,p.rootpath))),p.filename=n;var o=new r.Parse(d.context);o.processImports=!1,d.contents[n]=s,(l.reference||u.reference)&&(p.reference=!0),u.isPlugin?(t=h.evalPlugin(s,o,d,u.pluginArgs,p))instanceof a?f(t,null,n):f(null,t,n):u.inline?f(null,s,n):!d.files[n]||d.files[n].options.multiple||u.multiple?new i(o,d,p).parse(s,function(e,t){f(e,t,n)}):f(null,d.files[n].root,n)},y=s.clone(this.context);n&&(y.ext=u.isPlugin?".js":".less"),(v=u.isPlugin?h.loadPlugin(t,l.currentDirectory,y,e,m):m.loadFile(t,l.currentDirectory,y,e,function(e,t){e?f(e):g(t)}))&&v.then(g,f)}else f({message:"Could not find a file-manager for "+t})},t}},{"./contexts":13,"./less-error":38,"./logger":39,"./parser/parser":44,"./utils":89,promise:void 0}],37:[function(e,t,n){t.exports=function(t,n){var r,i,a,s,o,l,u={version:[3,9,0],data:e("./data"),tree:e("./tree"),Environment:o=e("./environment/environment"),AbstractFileManager:e("./environment/abstract-file-manager"),AbstractPluginLoader:e("./environment/abstract-plugin-loader"),environment:t=new o(t,n),visitors:e("./visitors"),Parser:e("./parser/parser"),functions:e("./functions")(t),contexts:e("./contexts"),SourceMapOutput:r=e("./source-map-output")(t),SourceMapBuilder:i=e("./source-map-builder")(r,t),ParseTree:a=e("./parse-tree")(i),ImportManager:s=e("./import-manager")(t),render:e("./render")(t,a,s),parse:e("./parse")(t,a,s),LessError:e("./less-error"),transformTree:e("./transform-tree"),utils:e("./utils"),PluginManager:e("./plugin-manager"),logger:e("./logger")},c=function(e){return function(){var t=Object.create(e.prototype);return e.apply(t,Array.prototype.slice.call(arguments,0)),t}},d=Object.create(u);for(var h in u.tree)if("function"==typeof(l=u.tree[h]))d[h.toLowerCase()]=c(l);else for(var f in d[h]=Object.create(null),l)d[h][f.toLowerCase()]=c(l[f]);return d}},{"./contexts":13,"./data":15,"./environment/abstract-file-manager":18,"./environment/abstract-plugin-loader":19,"./environment/environment":20,"./functions":28,"./import-manager":36,"./less-error":38,"./logger":39,"./parse":41,"./parse-tree":40,"./parser/parser":44,"./plugin-manager":45,"./render":46,"./source-map-builder":47,"./source-map-output":48,"./transform-tree":49,"./tree":67,"./utils":89,"./visitors":93}],38:[function(e,t,n){var r=e("./utils"),i=t.exports=function(e,t,n){Error.call(this);var i=e.filename||n;if(this.message=e.message,this.stack=e.stack,t&&i){var a=t.contents[i],s=r.getLocation(e.index,a),o=s.line,l=s.column,u=e.call&&r.getLocation(e.call,a).line,c=a?a.split("\n"):"";if(this.type=e.type||"Syntax",this.filename=i,this.index=e.index,this.line="number"==typeof o?o+1:null,this.column=l,!this.line&&this.stack){var d=this.stack.match(/(<anonymous>|Function):(\d+):(\d+)/);d&&(d[2]&&(this.line=parseInt(d[2])-2),d[3]&&(this.column=parseInt(d[3])))}this.callLine=u+1,this.callExtract=c[u],this.extract=[c[this.line-2],c[this.line-1],c[this.line]]}};if(void 0===Object.create){var a=function(){};a.prototype=Error.prototype,i.prototype=new a}else i.prototype=Object.create(Error.prototype);i.prototype.constructor=i,i.prototype.toString=function(e){e=e||{};var t="",n=this.extract||[],r=[],i=function(e){return e};if(e.stylize){var a=typeof e.stylize;if("function"!==a)throw Error("options.stylize should be a function, got a "+a+"!");i=e.stylize}if(null!==this.line){if("string"==typeof n[0]&&r.push(i(this.line-1+" "+n[0],"grey")),"string"==typeof n[1]){var s=this.line+" ";n[1]&&(s+=n[1].slice(0,this.column)+i(i(i(n[1].substr(this.column,1),"bold")+n[1].slice(this.column+1),"red"),"inverse")),r.push(s)}"string"==typeof n[2]&&r.push(i(this.line+1+" "+n[2],"grey")),r=r.join("\n")+i("","reset")+"\n"}return t+=i(this.type+"Error: "+this.message,"red"),this.filename&&(t+=i(" in ","red")+this.filename),this.line&&(t+=i(" on line "+this.line+", column "+(this.column+1)+":","grey")),t+="\n"+r,this.callLine&&(t+=i("from ","red")+(this.filename||"")+"/n",t+=i(this.callLine,"grey")+" "+this.callExtract+"/n"),t}},{"./utils":89}],39:[function(e,t,n){t.exports={error:function(e){this._fireEvent("error",e)},warn:function(e){this._fireEvent("warn",e)},info:function(e){this._fireEvent("info",e)},debug:function(e){this._fireEvent("debug",e)},addListener:function(e){this._listeners.push(e)},removeListener:function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)},_fireEvent:function(e,t){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n][e];r&&r(t)}},_listeners:[]}},{}],40:[function(e,t,n){var r=e("./less-error"),i=e("./transform-tree"),a=e("./logger");t.exports=function(e){var t=function(e,t){this.root=e,this.imports=t};return t.prototype.toCSS=function(t){var n,s,o={};try{n=i(this.root,t)}catch(e){throw new r(e,this.imports)}try{var l=Boolean(t.compress);l&&a.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var u={compress:l,dumpLineNumbers:t.dumpLineNumbers,strictUnits:Boolean(t.strictUnits),numPrecision:8};t.sourceMap?(s=new e(t.sourceMap),o.css=s.toCSS(n,u,this.imports)):o.css=n.toCSS(u)}catch(e){throw new r(e,this.imports)}if(t.pluginManager)for(var c=t.pluginManager.getPostProcessors(),d=0;d<c.length;d++)o.css=c[d].process(o.css,{sourceMap:s,options:t,imports:this.imports});for(var h in t.sourceMap&&(o.map=s.getExternalSourceMap()),o.imports=[],this.imports.files)this.imports.files.hasOwnProperty(h)&&h!==this.imports.rootFilename&&o.imports.push(h);return o},t}},{"./less-error":38,"./logger":39,"./transform-tree":49}],41:[function(e,t,n){var r,i=e("./contexts"),a=e("./parser/parser"),s=e("./plugin-manager"),o=e("./less-error"),l=e("./utils");t.exports=function(t,n,u){var c=function(t,n,d){if("function"==typeof n?(d=n,n=l.copyOptions(this.options,{})):n=l.copyOptions(this.options,n||{}),!d){r||(r="undefined"==typeof Promise?e("promise"):Promise);var h=this;return new r(function(e,r){c.call(h,t,n,function(t,n){t?r(t):e(n)})})}var f,p,m=new s(this,!n.reUsePluginManager);if(n.pluginManager=m,f=new i.Parse(n),n.rootFileInfo)p=n.rootFileInfo;else{var v=n.filename||"input",g=v.replace(/[^\/\\]*$/,"");(p={filename:v,rewriteUrls:f.rewriteUrls,rootpath:f.rootpath||"",currentDirectory:g,entryPath:g,rootFilename:v}).rootpath&&"/"!==p.rootpath.slice(-1)&&(p.rootpath+="/")}var y=new u(this,f,p);this.importManager=y,n.plugins&&n.plugins.forEach(function(e){var t,n;if(e.fileContent){if(n=e.fileContent.replace(/^\uFEFF/,""),(t=m.Loader.evalPlugin(n,f,y,e.options,e.filename))instanceof o)return d(t)}else m.addPlugin(e)}),new a(f,y,p).parse(t,function(e,t){if(e)return d(e);d(null,t,y,n)},n)};return c}},{"./contexts":13,"./less-error":38,"./parser/parser":44,"./plugin-manager":45,"./utils":89,promise:void 0}],42:[function(e,t,n){t.exports=function(e,t){var n,r,i,a,s,o,l,u,c,d=e.length,h=0,f=0,p=[],m=0;function v(t){var n=s-m;n<512&&!t||!n||(p.push(e.slice(m,s+1)),m=s+1)}for(s=0;s<d;s++)if(!((l=e.charCodeAt(s))>=97&&l<=122||l<34))switch(l){case 40:f++,r=s;continue;case 41:if(--f<0)return t("missing opening `(`",s);continue;case 59:f||v();continue;case 123:h++,n=s;continue;case 125:if(--h<0)return t("missing opening `{`",s);h||f||v();continue;case 92:if(s<d-1){s++;continue}return t("unescaped `\\`",s);case 34:case 39:case 96:for(c=0,o=s,s+=1;s<d;s++)if(!((u=e.charCodeAt(s))>96)){if(u==l){c=1;break}if(92==u){if(s==d-1)return t("unescaped `\\`",s);s++}}if(c)continue;return t("unmatched `"+String.fromCharCode(l)+"`",o);case 47:if(f||s==d-1)continue;if(47==(u=e.charCodeAt(s+1)))for(s+=2;s<d&&(!((u=e.charCodeAt(s))<=13)||10!=u&&13!=u);s++);else if(42==u){for(i=o=s,s+=2;s<d-1&&(125==(u=e.charCodeAt(s))&&(a=s),42!=u||47!=e.charCodeAt(s+1));s++);if(s==d-1)return t("missing closing `*/`",o);s++}continue;case 42:if(s<d-1&&47==e.charCodeAt(s+1))return t("unmatched `/*`",s);continue}return 0!==h?t(i>n&&a>i?"missing closing `}` or `*/`":"missing closing `}`",n):0!==f?t("missing closing `)`",r):(v(!0),p)}},{}],43:[function(e,t,n){var r=e("./chunker");t.exports=function(){var e,t,n,i,a,s,o,l=[],u={},c=32,d=9,h=10,f=13,p=47;function m(n){for(var r,i,l,v=u.i,g=t,y=u.i-o,_=u.i+s.length-y,w=u.i+=n,E=e;u.i<_;u.i++){if(r=E.charCodeAt(u.i),u.autoCommentAbsorb&&r===p){if("/"===(i=E.charAt(u.i+1))){l={index:u.i,isLineComment:!0};var b=E.indexOf("\n",u.i+2);b<0&&(b=_),u.i=b,l.text=E.substr(l.index,u.i-l.index),u.commentStore.push(l);continue}if("*"===i){var S=E.indexOf("*/",u.i+2);if(S>=0){l={index:u.i,text:E.substr(u.i,S+2-u.i),isLineComment:!1},u.i+=l.text.length-1,u.commentStore.push(l);continue}}break}if(r!==c&&r!==h&&r!==d&&r!==f)break}if(s=s.slice(n+u.i-w+y),o=u.i,!s.length){if(t<a.length-1)return s=a[++t],m(0),!0;u.finished=!0}return v!==u.i||g!==t}return u.save=function(){o=u.i,l.push({current:s,i:u.i,j:t})},u.restore=function(e){(u.i>n||u.i===n&&e&&!i)&&(n=u.i,i=e);var r=l.pop();s=r.current,o=u.i=r.i,t=r.j},u.forget=function(){l.pop()},u.isWhitespace=function(t){var n=u.i+(t||0),r=e.charCodeAt(n);return r===c||r===f||r===d||r===h},u.$re=function(e){u.i>o&&(s=s.slice(u.i-o),o=u.i);var t=e.exec(s);return t?(m(t[0].length),"string"==typeof t?t:1===t.length?t[0]:t):null},u.$char=function(t){return e.charAt(u.i)!==t?null:(m(1),t)},u.$str=function(t){for(var n=t.length,r=0;r<n;r++)if(e.charAt(u.i+r)!==t.charAt(r))return null;return m(n),t},u.$quoted=function(t){var n=t||u.i,r=e.charAt(n);if("'"===r||'"'===r){for(var i=e.length,a=n,s=1;s+a<i;s++){var o=e.charAt(s+a);switch(o){case"\\":s++;continue;case"\r":case"\n":break;case r:var l=e.substr(a,s+1);return t||0===t?[r,l]:(m(s+1),l)}}return null}},u.$parseUntil=function(t){var n,r="",i=null,a=!1,s=0,o=[],l=[],c=e.length,d=u.i,h=u.i,f=u.i,p=!0;n="string"==typeof t?function(e){return e===t}:function(e){return t.test(e)};do{var v=e.charAt(f);if(0===s&&n(v))(i=e.substr(h,f-h))?l.push(i):l.push(" "),i=l,m(f-d),p=!1;else{if(a){"*"===v&&"/"===e.charAt(f+1)&&(f++,s--,a=!1),f++;continue}switch(v){case"\\":f++,v=e.charAt(f),l.push(e.substr(h,f-h+1)),h=f+1;break;case"/":"*"===e.charAt(f+1)&&(f++,a=!0,s++);break;case"'":case'"':(r=u.$quoted(f))?(l.push(e.substr(h,f-h),r),f+=r[1].length-1,h=f+1):(m(f-d),i=v,p=!1);break;case"{":o.push("}"),s++;break;case"(":o.push(")"),s++;break;case"[":o.push("]"),s++;break;case"}":case")":case"]":var g=o.pop();v===g?s--:(m(f-d),i=g,p=!1)}++f>c&&(p=!1)}}while(p);return i||null},u.autoCommentAbsorb=!0,u.commentStore=[],u.finished=!1,u.peek=function(t){if("string"==typeof t){for(var n=0;n<t.length;n++)if(e.charAt(u.i+n)!==t.charAt(n))return!1;return!0}return t.test(s)},u.peekChar=function(t){return e.charAt(u.i)===t},u.currentChar=function(){return e.charAt(u.i)},u.prevChar=function(){return e.charAt(u.i-1)},u.getInput=function(){return e},u.peekNotNumeric=function(){var t=e.charCodeAt(u.i);return t>57||t<43||t===p||44===t},u.start=function(i,l,c){e=i,u.i=t=o=n=0,a=l?r(i,c):[i],s=a[0],m(0)},u.end=function(){var t,r=u.i>=e.length;return u.i<n&&(t=i,u.i=n),{isFinished:r,furthest:u.i,furthestPossibleErrorMessage:t,furthestReachedEnd:u.i>=e.length-1,furthestChar:e[u.i]}},u}},{"./chunker":42}],44:[function(e,t,n){var r=e("../less-error"),i=e("../tree"),a=e("../visitors"),s=e("./parser-input"),o=e("../utils"),l=e("../functions/function-registry"),u=function e(t,n,u){var c,d=s();function h(e,t){throw new r({index:d.i,filename:u.filename,type:t||"Syntax",message:e},n)}function f(e,t){var n=e instanceof Function?e.call(c):d.$re(e);if(n)return n;h(t||("string"==typeof e?"expected '"+e+"' got '"+d.currentChar()+"'":"unexpected token"))}function p(e,t){if(d.$char(e))return e;h(t||"expected '"+e+"' got '"+d.currentChar()+"'")}function m(e){var t=u.filename;return{lineNumber:o.getLocation(e,d.getInput()).line+1,fileName:t}}return{parserInput:d,imports:n,fileInfo:u,parseNode:function(e,t,i,a,s){var o,l=[],u=d;try{u.start(e,!1,function(e,t){s({message:e,index:t+i})});for(var h,f,p=0;h=t[p];p++)f=u.i,(o=c[h]())?(o._index=f+i,o._fileInfo=a,l.push(o)):l.push(null);var m=u.end();m.isFinished?s(null,l):s(!0,null)}catch(e){throw new r({index:e.index+i,message:e.message},n,a.filename)}},parse:function(s,o,c){var h,f,p,m,v=null,g="";if(f=c&&c.globalVars?e.serializeVars(c.globalVars)+"\n":"",p=c&&c.modifyVars?"\n"+e.serializeVars(c.modifyVars):"",t.pluginManager)for(var y=t.pluginManager.getPreProcessors(),_=0;_<y.length;_++)s=y[_].process(s,{context:t,imports:n,fileInfo:u});(f||c&&c.banner)&&(g=(c&&c.banner?c.banner:"")+f,(m=n.contentsIgnoredChars)[u.filename]=m[u.filename]||0,m[u.filename]+=g.length),s=s.replace(/\r\n?/g,"\n"),s=g+s.replace(/^\uFEFF/,"")+p,n.contents[u.filename]=s;try{d.start(s,t.chunkInput,function(e,t){throw new r({index:t,type:"Parse",message:e,filename:u.filename},n)}),i.Node.prototype.parse=this,h=new i.Ruleset(null,this.parsers.primary()),i.Node.prototype.rootNode=h,h.root=!0,h.firstRoot=!0,h.functionRegistry=l.inherit()}catch(e){return o(new r(e,n,u.filename))}var w=d.end();if(!w.isFinished){var E=w.furthestPossibleErrorMessage;E||(E="Unrecognised input","}"===w.furthestChar?E+=". Possibly missing opening '{'":")"===w.furthestChar?E+=". Possibly missing opening '('":w.furthestReachedEnd&&(E+=". Possibly missing something")),v=new r({type:"Parse",message:E,index:w.furthest,filename:u.filename},n)}var b=function(e){return(e=v||e||n.error)?(e instanceof r||(e=new r(e,n,u.filename)),o(e)):o(null,h)};if(!1===t.processImports)return b();new a.ImportVisitor(n,b).run(h)},parsers:c={primary:function(){for(var e,t=this.mixin,n=[];;){for(;e=this.comment();)n.push(e);if(d.finished)break;if(d.peek("}"))break;if(e=this.extendRule())n=n.concat(e);else if(e=t.definition()||this.declaration()||this.ruleset()||t.call(!1,!1)||this.variableCall()||this.entities.call()||this.atrule())n.push(e);else{for(var r=!1;d.$char(";");)r=!0;if(!r)break}}return n},comment:function(){if(d.commentStore.length){var e=d.commentStore.shift();return new i.Comment(e.text,e.isLineComment,e.index,u)}},entities:{mixinLookup:function(){return c.mixin.call(!0,!0)},quoted:function(e){var t,n=d.i,r=!1;if(d.save(),d.$char("~"))r=!0;else if(e)return void d.restore();if(t=d.$quoted())return d.forget(),new i.Quoted(t.charAt(0),t.substr(1,t.length-2),r,n,u);d.restore()},keyword:function(){var e=d.$char("%")||d.$re(/^\[?(?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+\]?/);if(e)return i.Color.fromKeyword(e)||new i.Keyword(e)},call:function(){var e,t,n,r=d.i;if(!d.peek(/^url\(/i))if(d.save(),e=d.$re(/^([\w-]+|%|progid:[\w\.]+)\(/)){if(e=e[1],(n=this.customFuncCall(e))&&(t=n.parse())&&n.stop)return d.forget(),t;if(t=this.arguments(t),d.$char(")"))return d.forget(),new i.Call(e,t,r,u);d.restore("Could not parse call arguments or missing ')'")}else d.forget()},customFuncCall:function(e){return{alpha:t(c.ieAlpha,!0),boolean:t(n),if:t(n)}[e.toLowerCase()];function t(e,t){return{parse:e,stop:t}}function n(){return[f(c.condition,"expected condition")]}},arguments:function(e){var t,n,r=e||[],a=[];for(d.save();;){if(e)e=!1;else{if(!(n=c.detachedRuleset()||this.assignment()||c.expression()))break;n.value&&1==n.value.length&&(n=n.value[0]),r.push(n)}d.$char(",")||(d.$char(";")||t)&&(t=!0,n=r.length<1?r[0]:new i.Value(r),a.push(n),r=[])}return d.forget(),t?a:r},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var e,t;if(d.save(),e=d.$re(/^\w+(?=\s?=)/i))if(d.$char("=")){if(t=c.entity())return d.forget(),new i.Assignment(e,t);d.restore()}else d.restore();else d.restore()},url:function(){var e,t=d.i;if(d.autoCommentAbsorb=!1,d.$str("url("))return e=this.quoted()||this.variable()||this.property()||d.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",d.autoCommentAbsorb=!0,p(")"),new i.URL(null!=e.value||e instanceof i.Variable||e instanceof i.Property?e:new i.Anonymous(e,t),t,u);d.autoCommentAbsorb=!0},variable:function(){var e,t,n=d.i;if(d.save(),"@"===d.currentChar()&&(t=d.$re(/^@@?[\w-]+/))){if("("===(e=d.currentChar())||"["===e&&!d.prevChar().match(/^\s/)){var r=c.variableCall(t);if(r)return d.forget(),r}return d.forget(),new i.Variable(t,n,u)}d.restore()},variableCurly:function(){var e,t=d.i;if("@"===d.currentChar()&&(e=d.$re(/^@\{([\w-]+)\}/)))return new i.Variable("@"+e[1],t,u)},property:function(){var e,t=d.i;if("$"===d.currentChar()&&(e=d.$re(/^\$[\w-]+/)))return new i.Property(e,t,u)},propertyCurly:function(){var e,t=d.i;if("$"===d.currentChar()&&(e=d.$re(/^\$\{([\w-]+)\}/)))return new i.Property("$"+e[1],t,u)},color:function(){var e;if("#"===d.currentChar()&&(e=d.$re(/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})/)))return new i.Color(e[1],void 0,e[0])},colorKeyword:function(){d.save();var e=d.autoCommentAbsorb;d.autoCommentAbsorb=!1;var t=d.$re(/^[_A-Za-z-][_A-Za-z0-9-]+/);if(d.autoCommentAbsorb=e,t){d.restore();var n=i.Color.fromKeyword(t);return n?(d.$str(t),n):void 0}d.forget()},dimension:function(){if(!d.peekNotNumeric()){var e=d.$re(/^([+-]?\d*\.?\d+)(%|[a-z_]+)?/i);return e?new i.Dimension(e[1],e[2]):void 0}},unicodeDescriptor:function(){var e;if(e=d.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))return new i.UnicodeDescriptor(e[0])},javascript:function(){var e,t=d.i;d.save();var n=d.$char("~"),r=d.$char("`");if(r){if(e=d.$re(/^[^`]*`/))return d.forget(),new i.JavaScript(e.substr(0,e.length-1),Boolean(n),t,u);d.restore("invalid javascript definition")}else d.restore()}},variable:function(){var e;if("@"===d.currentChar()&&(e=d.$re(/^(@[\w-]+)\s*:/)))return e[1]},variableCall:function(e){var t,n,r=d.i,a=!!e,s=e;if(d.save(),s||"@"===d.currentChar()&&(s=d.$re(/^(@[\w-]+)(\(\s*\))?/))){if(!(t=this.mixin.ruleLookups())&&(a&&"()"!==d.$str("()")||"()"!==s[2]))return void d.restore("Missing '[...]' lookup in variable call");a||(s=s[1]),t&&c.important()&&(n=!0);var o=new i.VariableCall(s,r,u);return!a&&c.end()?(d.forget(),o):(d.forget(),new i.NamespaceValue(o,t,n,r,u))}d.restore()},extend:function(e){var t,n,r,a,s,o=d.i;if(d.$str(e?"&:extend(":":extend(")){do{for(r=null,t=null;!(r=d.$re(/^(all)(?=\s*(\)|,))/))&&(n=this.element());)t?t.push(n):t=[n];r=r&&r[1],t||h("Missing target selector for :extend()."),s=new i.Extend(new i.Selector(t),r,o,u),a?a.push(s):a=[s]}while(d.$char(","));return f(/^\)/),e&&f(/^;/),a}},extendRule:function(){return this.extend(!0)},mixin:{call:function(e,t){var n,r,a,s,o=d.currentChar(),l=!1,h=d.i;if("."===o||"#"===o){if(d.save(),r=this.elements()){if(d.$char("(")&&(a=this.args(!0).args,p(")"),s=!0),!1!==t&&(n=this.ruleLookups()),!0===t&&!n)return void d.restore();if(e&&!n&&!s)return void d.restore();if(!e&&c.important()&&(l=!0),e||c.end()){d.forget();var f=new i.mixin.Call(r,a,h,u,!n&&l);return n?new i.NamespaceValue(f,n,l):f}}d.restore()}},elements:function(){for(var e,t,n,r,a,s=/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/;a=d.i,t=d.$re(s);)r=new i.Element(n,t,!1,a,u),e?e.push(r):e=[r],n=d.$char(">");return e},args:function(e){var t,n,r,a,s,o,l,u=c.entities,f={args:null,variadic:!1},p=[],m=[],v=[],g=!0;for(d.save();;){if(e)o=c.detachedRuleset()||c.expression();else{if(d.commentStore.length=0,d.$str("...")){f.variadic=!0,d.$char(";")&&!t&&(t=!0),(t?m:v).push({variadic:!0});break}o=u.variable()||u.property()||u.literal()||u.keyword()||this.call(!0)}if(!o||!g)break;a=null,o.throwAwayComments&&o.throwAwayComments(),s=o;var y=null;if(e?o.value&&1==o.value.length&&(y=o.value[0]):y=o,y&&(y instanceof i.Variable||y instanceof i.Property))if(d.$char(":")){if(p.length>0&&(t&&h("Cannot mix ; and , as delimiter types"),n=!0),!(s=c.detachedRuleset()||c.expression())){if(!e)return d.restore(),f.args=[],f;h("could not understand value for named argument")}a=r=y.name}else if(d.$str("...")){if(!e){f.variadic=!0,d.$char(";")&&!t&&(t=!0),(t?m:v).push({name:o.name,variadic:!0});break}l=!0}else e||(r=a=y.name,s=null);s&&p.push(s),v.push({name:a,value:s,expand:l}),d.$char(",")?g=!0:((g=";"===d.$char(";"))||t)&&(n&&h("Cannot mix ; and , as delimiter types"),t=!0,p.length>1&&(s=new i.Value(p)),m.push({name:r,value:s,expand:l}),r=null,p=[],n=!1)}return d.forget(),f.args=t?m:v,f},definition:function(){var e,t,n,r,a=[],s=!1;if(!("."!==d.currentChar()&&"#"!==d.currentChar()||d.peek(/^[^{]*\}/)))if(d.save(),t=d.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){e=t[1];var o=this.args(!1);if(a=o.args,s=o.variadic,!d.$char(")"))return void d.restore("Missing closing ')'");if(d.commentStore.length=0,d.$str("when")&&(r=f(c.conditions,"expected condition")),n=c.block())return d.forget(),new i.mixin.Definition(e,a,n,r,s);d.restore()}else d.forget()},ruleLookups:function(){var e,t=[];if("["===d.currentChar()){for(;;){if(d.save(),!(e=this.lookupValue())&&""!==e){d.restore();break}t.push(e),d.forget()}return t.length>0?t:void 0}},lookupValue:function(){if(d.save(),d.$char("[")){var e=d.$re(/^(?:[@$]{0,2})[_a-zA-Z0-9-]*/);if(d.$char("]"))return e||""===e?(d.forget(),e):void d.restore();d.restore()}else d.restore()}},entity:function(){var e=this.entities;return this.comment()||e.literal()||e.variable()||e.url()||e.property()||e.call()||e.keyword()||this.mixin.call(!0)||e.javascript()},end:function(){return d.$char(";")||d.peek("}")},ieAlpha:function(){var e;if(d.$re(/^opacity=/i))return(e=d.$re(/^\d+/))||(e="@{"+(e=f(c.entities.variable,"Could not parse alpha")).name.slice(1)+"}"),p(")"),new i.Quoted("","alpha(opacity="+e+")")},element:function(){var e,t,n,r=d.i;if(t=this.combinator(),(e=d.$re(/^(?:\d+\.\d+|\d+)%/)||d.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||d.$char("*")||d.$char("&")||this.attribute()||d.$re(/^\([^&()@]+\)/)||d.$re(/^[\.#:](?=@)/)||this.entities.variableCurly())||(d.save(),d.$char("(")?(n=this.selector(!1))&&d.$char(")")?(e=new i.Paren(n),d.forget()):d.restore("Missing closing ')'"):d.forget()),e)return new i.Element(t,e,e instanceof i.Variable,r,u)},combinator:function(){var e=d.currentChar();if("/"===e){d.save();var t=d.$re(/^\/[a-z]+\//i);if(t)return d.forget(),new i.Combinator(t);d.restore()}if(">"===e||"+"===e||"~"===e||"|"===e||"^"===e){for(d.i++,"^"===e&&"^"===d.currentChar()&&(e="^^",d.i++);d.isWhitespace();)d.i++;return new i.Combinator(e)}return d.isWhitespace(-1)?new i.Combinator(" "):new i.Combinator(null)},selector:function(e){var t,n,r,a,s,o,l,c=d.i;for(e=!1!==e;(e&&(n=this.extend())||e&&(o=d.$str("when"))||(a=this.element()))&&(o?l=f(this.conditions,"expected condition"):l?h("CSS guard can only be used at the end of selector"):n?s=s?s.concat(n):n:(s&&h("Extend can only be used at the end of selector"),r=d.currentChar(),t?t.push(a):t=[a],a=null),"{"!==r&&"}"!==r&&";"!==r&&","!==r&&")"!==r););if(t)return new i.Selector(t,s,l,c,u);s&&h("Extend must be used to extend a selector, it cannot be used on its own")},selectors:function(){for(var e,t;(e=this.selector())&&(t?t.push(e):t=[e],d.commentStore.length=0,e.condition&&t.length>1&&h("Guards are only currently allowed on a single selector."),d.$char(","));)e.condition&&h("Guards are only currently allowed on a single selector."),d.commentStore.length=0;return t},attribute:function(){if(d.$char("[")){var e,t,n,r=this.entities;return(e=r.variableCurly())||(e=f(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),(n=d.$re(/^[|~*$^]?=/))&&(t=r.quoted()||d.$re(/^[0-9]+%/)||d.$re(/^[\w-]+/)||r.variableCurly()),p("]"),new i.Attribute(e,n,t)}},block:function(){var e;if(d.$char("{")&&(e=this.primary())&&d.$char("}"))return e},blockRuleset:function(){var e=this.block();return e&&(e=new i.Ruleset(null,e)),e},detachedRuleset:function(){var e,t,n;if(d.save(),!d.$re(/^[.#]\(/)||(e=this.mixin.args(!1),t=e.args,n=e.variadic,d.$char(")"))){var r=this.blockRuleset();if(r)return d.forget(),t?new i.mixin.Definition(null,t,r,null,n):new i.DetachedRuleset(r);d.restore()}else d.restore()},ruleset:function(){var e,n,r;if(d.save(),t.dumpLineNumbers&&(r=m(d.i)),(e=this.selectors())&&(n=this.block())){d.forget();var a=new i.Ruleset(e,n,t.strictImports);return t.dumpLineNumbers&&(a.debugInfo=r),a}d.restore()},declaration:function(){var e,t,n,r,a,s,o=d.i,l=d.currentChar();if("."!==l&&"#"!==l&&"&"!==l&&":"!==l)if(d.save(),e=this.variable()||this.ruleProperty()){if((s="string"==typeof e)&&(t=this.detachedRuleset())&&(n=!0),d.commentStore.length=0,!t){if(a=!s&&e.length>1&&e.pop().value,t=e[0].value&&"--"===e[0].value.slice(0,2)?this.permissiveValue():this.anonymousValue())return d.forget(),new i.Declaration(e,t,!1,a,o,u);t||(t=this.value()),t?r=this.important():s&&(t=this.permissiveValue())}if(t&&(this.end()||n))return d.forget(),new i.Declaration(e,t,r,a,o,u);d.restore()}else d.restore()},anonymousValue:function(){var e=d.i,t=d.$re(/^([^.#@\$+\/'"*`(;{}-]*);/);if(t)return new i.Anonymous(t[1],e)},permissiveValue:function(e){var t,n,r,a,s=e||";",o=d.i,l=[];function c(){var e=d.currentChar();return"string"==typeof s?e===s:s.test(e)}if(!c()){a=[];do{(n=this.comment())?a.push(n):(n=this.entity())&&a.push(n)}while(n);if(r=c(),a.length>0){if(a=new i.Expression(a),r)return a;l.push(a)," "===d.prevChar()&&l.push(new i.Anonymous(" ",o))}if(d.save(),a=d.$parseUntil(s)){if("string"==typeof a&&h("Expected '"+a+"'","Parse"),1===a.length&&" "===a[0])return d.forget(),new i.Anonymous("",o);var f;for(t=0;t<a.length;t++)if(f=a[t],Array.isArray(f))l.push(new i.Quoted(f[0],f[1],!0,o,u));else{t===a.length-1&&(f=f.trim());var p=new i.Quoted("'",f,!0,o,u);p.variableRegex=/@([\w-]+)/g,p.propRegex=/\$([\w-]+)/g,l.push(p)}return d.forget(),new i.Expression(l,!0)}d.restore()}},import:function(){var e,t,n=d.i,r=d.$re(/^@import?\s+/);if(r){var a=(r?this.importOptions():null)||{};if(e=this.entities.quoted()||this.entities.url())return t=this.mediaFeatures(),d.$char(";")||(d.i=n,h("missing semi-colon or unrecognised media features on import")),t=t&&new i.Value(t),new i.Import(e,t,a,n,u);d.i=n,h("malformed import statement")}},importOptions:function(){var e,t,n,r={};if(!d.$char("("))return null;do{if(e=this.importOption()){switch(n=!0,t=e){case"css":t="less",n=!1;break;case"once":t="multiple",n=!1}if(r[t]=n,!d.$char(","))break}}while(e);return p(")"),r},importOption:function(){var e=d.$re(/^(less|css|multiple|once|inline|reference|optional)/);if(e)return e[1]},mediaFeature:function(){var e,t,n=this.entities,r=[];d.save();do{(e=n.keyword()||n.variable()||n.mixinLookup())?r.push(e):d.$char("(")&&(t=this.property(),e=this.value(),d.$char(")")?t&&e?r.push(new i.Paren(new i.Declaration(t,e,null,null,d.i,u,!0))):e?r.push(new i.Paren(e)):h("badly formed media feature definition"):h("Missing closing ')'","Parse"))}while(e);if(d.forget(),r.length>0)return new i.Expression(r)},mediaFeatures:function(){var e,t=this.entities,n=[];do{if(e=this.mediaFeature()){if(n.push(e),!d.$char(","))break}else if((e=t.variable()||t.mixinLookup())&&(n.push(e),!d.$char(",")))break}while(e);return n.length>0?n:null},media:function(){var e,n,r,a,s=d.i;if(t.dumpLineNumbers&&(a=m(s)),d.save(),d.$str("@media"))return e=this.mediaFeatures(),(n=this.block())||h("media definitions require block statements after any features"),d.forget(),r=new i.Media(n,e,s,u),t.dumpLineNumbers&&(r.debugInfo=a),r;d.restore()},plugin:function(){var e,t,n,r=d.i,a=d.$re(/^@plugin?\s+/);if(a){if(t=this.pluginArgs(),n=t?{pluginArgs:t,isPlugin:!0}:{isPlugin:!0},e=this.entities.quoted()||this.entities.url())return d.$char(";")||(d.i=r,h("missing semi-colon on @plugin")),new i.Import(e,null,n,r,u);d.i=r,h("malformed @plugin statement")}},pluginArgs:function(){if(d.save(),!d.$char("("))return d.restore(),null;var e=d.$re(/^\s*([^\);]+)\)\s*/);return e[1]?(d.forget(),e[1].trim()):(d.restore(),null)},atrule:function(){var e,n,r,a,s,o,l,c=d.i,f=!0,p=!0;if("@"===d.currentChar()){if(n=this.import()||this.plugin()||this.media())return n;if(d.save(),e=d.$re(/^@[a-z-]+/)){switch(a=e,"-"==e.charAt(1)&&e.indexOf("-",2)>0&&(a="@"+e.slice(e.indexOf("-",2)+1)),a){case"@charset":s=!0,f=!1;break;case"@namespace":o=!0,f=!1;break;case"@keyframes":case"@counter-style":s=!0;break;case"@document":case"@supports":l=!0,p=!1;break;default:l=!0}if(d.commentStore.length=0,s?(n=this.entity())||h("expected "+e+" identifier"):o?(n=this.expression())||h("expected "+e+" expression"):l&&(n=this.permissiveValue(/^[{;]/),f="{"===d.currentChar(),n?n.value||(n=null):f||";"===d.currentChar()||h(e+" rule is missing block or ending semi-colon")),f&&(r=this.blockRuleset()),r||!f&&n&&d.$char(";"))return d.forget(),new i.AtRule(e,n,r,c,u,t.dumpLineNumbers?m(c):null,p);d.restore("at-rule options not recognised")}}},value:function(){var e,t=[],n=d.i;do{if((e=this.expression())&&(t.push(e),!d.$char(",")))break}while(e);if(t.length>0)return new i.Value(t,n)},important:function(){if("!"===d.currentChar())return d.$re(/^! *important/)},sub:function(){var e,t;if(d.save(),d.$char("("))return(e=this.addition())&&d.$char(")")?(d.forget(),(t=new i.Expression([e])).parens=!0,t):void d.restore("Expected ')'");d.restore()},multiplication:function(){var e,t,n,r,a;if(e=this.operand()){for(a=d.isWhitespace(-1);!d.peek(/^\/[*\/]/);){if(d.save(),!(n=d.$char("/")||d.$char("*")||d.$str("./"))){d.forget();break}if(!(t=this.operand())){d.restore();break}d.forget(),e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],a),a=d.isWhitespace(-1)}return r||e}},addition:function(){var e,t,n,r,a;if(e=this.multiplication()){for(a=d.isWhitespace(-1);(n=d.$re(/^[-+]\s+/)||!a&&(d.$char("+")||d.$char("-")))&&(t=this.multiplication());)e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],a),a=d.isWhitespace(-1);return r||e}},conditions:function(){var e,t,n,r=d.i;if(e=this.condition(!0)){for(;d.peek(/^,\s*(not\s*)?\(/)&&d.$char(",")&&(t=this.condition(!0));)n=new i.Condition("or",n||e,t,r);return n||e}},condition:function(e){var t,n,r;if(t=this.conditionAnd(e)){if(n=d.$str("or")){if(!(r=this.condition(e)))return;t=new i.Condition(n,t,r)}return t}},conditionAnd:function(e){var t,n,r,a,s=this;if(a=s.negatedCondition(e)||s.parenthesisCondition(e),t=a||e?a:s.atomicCondition(e)){if(n=d.$str("and")){if(!(r=this.conditionAnd(e)))return;t=new i.Condition(n,t,r)}return t}},negatedCondition:function(e){if(d.$str("not")){var t=this.parenthesisCondition(e);return t&&(t.negate=!t.negate),t}},parenthesisCondition:function(e){var t;if(d.save(),d.$str("(")){if(t=function(t){var n;if(d.save(),n=t.condition(e)){if(d.$char(")"))return d.forget(),n;d.restore()}else d.restore()}(this))return d.forget(),t;if(t=this.atomicCondition(e)){if(d.$char(")"))return d.forget(),t;d.restore("expected ')' got '"+d.currentChar()+"'")}else d.restore()}else d.restore()},atomicCondition:function(e){var t,n,r,a,s=this.entities,o=d.i;function l(){return this.addition()||s.keyword()||s.quoted()||s.mixinLookup()}if(l=l.bind(this),t=l())return d.$char(">")?a=d.$char("=")?">=":">":d.$char("<")?a=d.$char("=")?"<=":"<":d.$char("=")&&(a=d.$char(">")?"=>":d.$char("<")?"=<":"="),a?(n=l())?r=new i.Condition(a,t,n,o,!1):h("expected expression"):r=new i.Condition("=",t,new i.Keyword("true"),o,!1),r},operand:function(){var e,t=this.entities;d.peek(/^-[@\$\(]/)&&(e=d.$char("-"));var n=this.sub()||t.dimension()||t.color()||t.variable()||t.property()||t.call()||t.quoted(!0)||t.colorKeyword()||t.mixinLookup();return e&&(n.parensInOp=!0,n=new i.Negative(n)),n},expression:function(){var e,t,n=[],r=d.i;do{(e=this.comment())?n.push(e):(e=this.addition()||this.entity())&&(n.push(e),d.peek(/^\/[\/*]/)||(t=d.$char("/"))&&n.push(new i.Anonymous(t,r)))}while(e);if(n.length>0)return new i.Expression(n)},property:function(){var e=d.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);if(e)return e[1]},ruleProperty:function(){var e,t,n=[],r=[];d.save();var a=d.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(a)return n=[new i.Keyword(a[1])],d.forget(),n;function s(e){var t=d.i,i=d.$re(e);if(i)return r.push(t),n.push(i[1])}for(s(/^(\*?)/);s(/^((?:[\w-]+)|(?:[@\$]\{[\w-]+\}))/););if(n.length>1&&s(/^((?:\+_|\+)?)\s*:/)){for(d.forget(),""===n[0]&&(n.shift(),r.shift()),t=0;t<n.length;t++)e=n[t],n[t]="@"!==e.charAt(0)&&"$"!==e.charAt(0)?new i.Keyword(e):"@"===e.charAt(0)?new i.Variable("@"+e.slice(2,-1),r[t],u):new i.Property("$"+e.slice(2,-1),r[t],u);return n}d.restore()}}}};u.serializeVars=function(e){var t="";for(var n in e)if(Object.hasOwnProperty.call(e,n)){var r=e[n];t+=("@"===n[0]?"":"@")+n+": "+r+(";"===String(r).slice(-1)?"":";")}return t},t.exports=u},{"../functions/function-registry":27,"../less-error":38,"../tree":67,"../utils":89,"../visitors":93,"./parser-input":43}],45:[function(e,t,n){var r,i=function(e){this.less=e,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[],this.iterator=-1,this.pluginCache={},this.Loader=new e.PluginLoader(e)};i.prototype.addPlugins=function(e){if(e)for(var t=0;t<e.length;t++)this.addPlugin(e[t])},i.prototype.addPlugin=function(e,t,n){this.installedPlugins.push(e),t&&(this.pluginCache[t]=e),e.install&&e.install(this.less,this,n||this.less.functions.functionRegistry)},i.prototype.get=function(e){return this.pluginCache[e]},i.prototype.addVisitor=function(e){this.visitors.push(e)},i.prototype.addPreProcessor=function(e,t){var n;for(n=0;n<this.preProcessors.length&&!(this.preProcessors[n].priority>=t);n++);this.preProcessors.splice(n,0,{preProcessor:e,priority:t})},i.prototype.addPostProcessor=function(e,t){var n;for(n=0;n<this.postProcessors.length&&!(this.postProcessors[n].priority>=t);n++);this.postProcessors.splice(n,0,{postProcessor:e,priority:t})},i.prototype.addFileManager=function(e){this.fileManagers.push(e)},i.prototype.getPreProcessors=function(){for(var e=[],t=0;t<this.preProcessors.length;t++)e.push(this.preProcessors[t].preProcessor);return e},i.prototype.getPostProcessors=function(){for(var e=[],t=0;t<this.postProcessors.length;t++)e.push(this.postProcessors[t].postProcessor);return e},i.prototype.getVisitors=function(){return this.visitors},i.prototype.visitor=function(){var e=this;return{first:function(){return e.iterator=-1,e.visitors[e.iterator]},get:function(){return e.iterator+=1,e.visitors[e.iterator]}}},i.prototype.getFileManagers=function(){return this.fileManagers},t.exports=function(e,t){return!t&&r||(r=new i(e)),r}},{}],46:[function(e,t,n){var r,i=e("./utils");t.exports=function(t,n,a){var s=function(t,a,o){if("function"==typeof a?(o=a,a=i.copyOptions(this.options,{})):a=i.copyOptions(this.options,a||{}),!o){r||(r="undefined"==typeof Promise?e("promise"):Promise);var l=this;return new r(function(e,n){s.call(l,t,a,function(t,r){t?n(t):e(r)})})}this.parse(t,a,function(e,t,r,i){if(e)return o(e);var a;try{var s=new n(t,r);a=s.toCSS(i)}catch(e){return o(e)}o(null,a)})};return s}},{"./utils":89,promise:void 0}],47:[function(e,t,n){t.exports=function(e,t){var n=function(e){this.options=e};return n.prototype.toCSS=function(t,n,r){var i=new e({contentsIgnoredCharsMap:r.contentsIgnoredChars,rootNode:t,contentsMap:r.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),a=i.toCSS(n);return this.sourceMap=i.sourceMap,this.sourceMapURL=i.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=i.normalizeFilename(this.options.sourceMapInputFilename)),void 0!==this.options.sourceMapBasepath&&void 0!==this.sourceMapURL&&(this.sourceMapURL=i.removeBasepath(this.sourceMapURL)),a+this.getCSSAppendage()},n.prototype.getCSSAppendage=function(){var e=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";e="data:application/json;base64,"+t.encodeBase64(this.sourceMap)}return e?"/*# sourceMappingURL="+e+" */":""},n.prototype.getExternalSourceMap=function(){return this.sourceMap},n.prototype.setExternalSourceMap=function(e){this.sourceMap=e},n.prototype.isInline=function(){return this.options.sourceMapFileInline},n.prototype.getSourceMapURL=function(){return this.sourceMapURL},n.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},n.prototype.getInputFilename=function(){return this.sourceMapInputFilename},n}},{}],48:[function(e,t,n){t.exports=function(e){var t=function(t){this._css=[],this._rootNode=t.rootNode,this._contentsMap=t.contentsMap,this._contentsIgnoredCharsMap=t.contentsIgnoredCharsMap,t.sourceMapFilename&&(this._sourceMapFilename=t.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=t.outputFilename,this.sourceMapURL=t.sourceMapURL,t.sourceMapBasepath&&(this._sourceMapBasepath=t.sourceMapBasepath.replace(/\\/g,"/")),t.sourceMapRootpath?(this._sourceMapRootpath=t.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=t.outputSourceFiles,this._sourceMapGeneratorConstructor=e.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return t.prototype.removeBasepath=function(e){return this._sourceMapBasepath&&0===e.indexOf(this._sourceMapBasepath)&&("\\"!==(e=e.substring(this._sourceMapBasepath.length)).charAt(0)&&"/"!==e.charAt(0)||(e=e.substring(1))),e},t.prototype.normalizeFilename=function(e){return e=e.replace(/\\/g,"/"),e=this.removeBasepath(e),(this._sourceMapRootpath||"")+e},t.prototype.add=function(e,t,n,r){if(e){var i,a,s,o,l;if(t&&t.filename){var u=this._contentsMap[t.filename];this._contentsIgnoredCharsMap[t.filename]&&((n-=this._contentsIgnoredCharsMap[t.filename])<0&&(n=0),u=u.slice(this._contentsIgnoredCharsMap[t.filename])),u=u.substring(0,n),a=u.split("\n"),o=a[a.length-1]}if(i=e.split("\n"),s=i[i.length-1],t&&t.filename)if(r)for(l=0;l<i.length;l++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+l+1,column:0===l?this._column:0},original:{line:a.length+l,column:0===l?o.length:0},source:this.normalizeFilename(t.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:a.length,column:o.length},source:this.normalizeFilename(t.filename)});1===i.length?this._column+=s.length:(this._lineNumber+=i.length-1,this._column=s.length),this._css.push(e)}},t.prototype.isEmpty=function(){return 0===this._css.length},t.prototype.toCSS=function(e){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var t in this._contentsMap)if(this._contentsMap.hasOwnProperty(t)){var n=this._contentsMap[t];this._contentsIgnoredCharsMap[t]&&(n=n.slice(this._contentsIgnoredCharsMap[t])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(t),n)}if(this._rootNode.genCSS(e,this),this._css.length>0){var r,i=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?r=this.sourceMapURL:this._sourceMapFilename&&(r=this._sourceMapFilename),this.sourceMapURL=r,this.sourceMap=i}return this._css.join("")},t}},{}],49:[function(e,t,n){var r=e("./contexts"),i=e("./visitors"),a=e("./tree");t.exports=function(e,t){var n,s=(t=t||{}).variables,o=new r.Eval(t);"object"!=typeof s||Array.isArray(s)||(s=Object.keys(s).map(function(e){var t=s[e];return t instanceof a.Value||(t instanceof a.Expression||(t=new a.Expression([t])),t=new a.Value([t])),new a.Declaration("@"+e,t,!1,null,0)}),o.frames=[new a.Ruleset(null,s)]);var l,u,c=[new i.JoinSelectorVisitor,new i.MarkVisibleSelectorsVisitor(!0),new i.ExtendVisitor,new i.ToCSSVisitor({compress:Boolean(t.compress)})],d=[];if(t.pluginManager){u=t.pluginManager.visitor();for(var h=0;h<2;h++)for(u.first();l=u.get();)l.isPreEvalVisitor?0!==h&&-1!==d.indexOf(l)||(d.push(l),l.run(e)):0!==h&&-1!==c.indexOf(l)||(l.isPreVisitor?c.unshift(l):c.push(l))}n=e.eval(o);for(var h=0;h<c.length;h++)c[h].run(n);if(t.pluginManager)for(u.first();l=u.get();)-1===c.indexOf(l)&&-1===d.indexOf(l)&&l.run(n);return n}},{"./contexts":13,"./tree":67,"./visitors":93}],50:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r,i,a){this.value=e,this._index=t,this._fileInfo=n,this.mapLines=r,this.rulesetLike=void 0!==i&&i,this.allowRoot=!0,this.copyVisibilityInfo(a)};(i.prototype=new r).type="Anonymous",i.prototype.eval=function(){return new i(this.value,this._index,this._fileInfo,this.mapLines,this.rulesetLike,this.visibilityInfo())},i.prototype.compare=function(e){return e.toCSS&&this.toCSS()===e.toCSS()?0:void 0},i.prototype.isRulesetLike=function(){return this.rulesetLike},i.prototype.genCSS=function(e,t){this.nodeVisible=Boolean(this.value),this.nodeVisible&&t.add(this.value,this._fileInfo,this._index,this.mapLines)},t.exports=i},{"./node":76}],51:[function(e,t,n){var r=e("./node"),i=function(e,t){this.key=e,this.value=t};(i.prototype=new r).type="Assignment",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.eval=function(e){return this.value.eval?new i(this.key,this.value.eval(e)):this},i.prototype.genCSS=function(e,t){t.add(this.key+"="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value)},t.exports=i},{"./node":76}],52:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=e("./ruleset"),s=e("./anonymous"),o=function(e,t,n,a,o,l,u,c){var d;if(this.name=e,this.value=t instanceof r?t:t?new s(t):t,n){for(Array.isArray(n)?this.rules=n:(this.rules=[n],this.rules[0].selectors=new i([],null,null,a,o).createEmptySelectors()),d=0;d<this.rules.length;d++)this.rules[d].allowImports=!0;this.setParent(this.rules,this)}this._index=a,this._fileInfo=o,this.debugInfo=l,this.isRooted=u||!1,this.copyVisibilityInfo(c),this.allowRoot=!0};(o.prototype=new r).type="AtRule",o.prototype.accept=function(e){var t=this.value,n=this.rules;n&&(this.rules=e.visitArray(n)),t&&(this.value=e.visit(t))},o.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},o.prototype.isCharset=function(){return"@charset"===this.name},o.prototype.genCSS=function(e,t){var n=this.value,r=this.rules;t.add(this.name,this.fileInfo(),this.getIndex()),n&&(t.add(" "),n.genCSS(e,t)),r?this.outputRuleset(e,t,r):t.add(";")},o.prototype.eval=function(e){var t,n,r=this.value,i=this.rules;return t=e.mediaPath,n=e.mediaBlocks,e.mediaPath=[],e.mediaBlocks=[],r&&(r=r.eval(e)),i&&((i=[i[0].eval(e)])[0].root=!0),e.mediaPath=t,e.mediaBlocks=n,new o(this.name,r,i,this.getIndex(),this.fileInfo(),this.debugInfo,this.isRooted,this.visibilityInfo())},o.prototype.variable=function(e){if(this.rules)return a.prototype.variable.call(this.rules[0],e)},o.prototype.find=function(){if(this.rules)return a.prototype.find.apply(this.rules[0],arguments)},o.prototype.rulesets=function(){if(this.rules)return a.prototype.rulesets.apply(this.rules[0])},o.prototype.outputRuleset=function(e,t,n){var r,i=n.length;if(e.tabLevel=1+(0|e.tabLevel),e.compress){for(t.add("{"),r=0;r<i;r++)n[r].genCSS(e,t);return t.add("}"),void e.tabLevel--}var a="\n"+Array(e.tabLevel).join("  "),s=a+"  ";if(i){for(t.add(" {"+s),n[0].genCSS(e,t),r=1;r<i;r++)t.add(s),n[r].genCSS(e,t);t.add(a+"}")}else t.add(" {"+a+"}");e.tabLevel--},t.exports=o},{"./anonymous":50,"./node":76,"./ruleset":81,"./selector":82}],53:[function(e,t,n){var r=e("./node"),i=function(e,t,n){this.key=e,this.op=t,this.value=n};(i.prototype=new r).type="Attribute",i.prototype.eval=function(e){return new i(this.key.eval?this.key.eval(e):this.key,this.op,this.value&&this.value.eval?this.value.eval(e):this.value)},i.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},i.prototype.toCSS=function(e){var t=this.key.toCSS?this.key.toCSS(e):this.key;return this.op&&(t+=this.op,t+=this.value.toCSS?this.value.toCSS(e):this.value),"["+t+"]"},t.exports=i},{"./node":76}],54:[function(e,t,n){var r=e("./node"),i=e("./anonymous"),a=e("../functions/function-caller"),s=function(e,t,n,r){this.name=e,this.args=t,this.calc="calc"===e,this._index=n,this._fileInfo=r};(s.prototype=new r).type="Call",s.prototype.accept=function(e){this.args&&(this.args=e.visitArray(this.args))},s.prototype.eval=function(e){var t=e.mathOn;e.mathOn=!this.calc,(this.calc||e.inCalc)&&e.enterCalc();var n=this.args.map(function(t){return t.eval(e)});(this.calc||e.inCalc)&&e.exitCalc(),e.mathOn=t;var o,l=new a(this.name,e,this.getIndex(),this.fileInfo());if(l.isValid()){try{o=l.call(n)}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.getIndex(),filename:this.fileInfo().filename,line:e.lineNumber,column:e.columnNumber}}if(null!=o)return o instanceof r||(o=new i(o&&!0!==o?o.toString():null)),o._index=this._index,o._fileInfo=this._fileInfo,o}return new s(this.name,n,this.getIndex(),this.fileInfo())},s.prototype.genCSS=function(e,t){t.add(this.name+"(",this.fileInfo(),this.getIndex());for(var n=0;n<this.args.length;n++)this.args[n].genCSS(e,t),n+1<this.args.length&&t.add(", ");t.add(")")},t.exports=s},{"../functions/function-caller":26,"./anonymous":50,"./node":76}],55:[function(e,t,n){var r=e("./node"),i=e("../data/colors"),a=function(e,t,n){var r=this;Array.isArray(e)?this.rgb=e:e.length>=6?(this.rgb=[],e.match(/.{2}/g).map(function(e,t){t<3?r.rgb.push(parseInt(e,16)):r.alpha=parseInt(e,16)/255})):(this.rgb=[],e.split("").map(function(e,t){t<3?r.rgb.push(parseInt(e+e,16)):r.alpha=parseInt(e+e,16)/255})),this.alpha=this.alpha||("number"==typeof t?t:1),void 0!==n&&(this.value=n)};function s(e,t){return Math.min(Math.max(e,0),t)}function o(e){return"#"+e.map(function(e){return((e=s(Math.round(e),255))<16?"0":"")+e.toString(16)}).join("")}(a.prototype=new r).type="Color",a.prototype.luma=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),n=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),.2126*e+.7152*t+.0722*n},a.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},a.prototype.toCSS=function(e,t){var n,r,i,a=e&&e.compress&&!t,o=[];if(r=this.fround(e,this.alpha),this.value)if(0===this.value.indexOf("rgb"))r<1&&(i="rgba");else{if(0!==this.value.indexOf("hsl"))return this.value;i=r<1?"hsla":"hsl"}else r<1&&(i="rgba");switch(i){case"rgba":o=this.rgb.map(function(e){return s(Math.round(e),255)}).concat(s(r,1));break;case"hsla":o.push(s(r,1));case"hsl":n=this.toHSL(),o=[this.fround(e,n.h),this.fround(e,100*n.s)+"%",this.fround(e,100*n.l)+"%"].concat(o)}if(i)return i+"("+o.join(","+(a?"":" "))+")";if(n=this.toRGB(),a){var l=n.split("");l[1]===l[2]&&l[3]===l[4]&&l[5]===l[6]&&(n="#"+l[1]+l[3]+l[5])}return n},a.prototype.operate=function(e,t,n){for(var r=new Array(3),i=this.alpha*(1-n.alpha)+n.alpha,s=0;s<3;s++)r[s]=this._operate(e,t,this.rgb[s],n.rgb[s]);return new a(r,i)},a.prototype.toRGB=function(){return o(this.rgb)},a.prototype.toHSL=function(){var e,t,n=this.rgb[0]/255,r=this.rgb[1]/255,i=this.rgb[2]/255,a=this.alpha,s=Math.max(n,r,i),o=Math.min(n,r,i),l=(s+o)/2,u=s-o;if(s===o)e=t=0;else{switch(t=l>.5?u/(2-s-o):u/(s+o),s){case n:e=(r-i)/u+(r<i?6:0);break;case r:e=(i-n)/u+2;break;case i:e=(n-r)/u+4}e/=6}return{h:360*e,s:t,l:l,a:a}},a.prototype.toHSV=function(){var e,t,n=this.rgb[0]/255,r=this.rgb[1]/255,i=this.rgb[2]/255,a=this.alpha,s=Math.max(n,r,i),o=Math.min(n,r,i),l=s,u=s-o;if(t=0===s?0:u/s,s===o)e=0;else{switch(s){case n:e=(r-i)/u+(r<i?6:0);break;case r:e=(i-n)/u+2;break;case i:e=(n-r)/u+4}e/=6}return{h:360*e,s:t,v:l,a:a}},a.prototype.toARGB=function(){return o([255*this.alpha].concat(this.rgb))},a.prototype.compare=function(e){return e.rgb&&e.rgb[0]===this.rgb[0]&&e.rgb[1]===this.rgb[1]&&e.rgb[2]===this.rgb[2]&&e.alpha===this.alpha?0:void 0},a.fromKeyword=function(e){var t,n=e.toLowerCase();if(i.hasOwnProperty(n)?t=new a(i[n].slice(1)):"transparent"===n&&(t=new a([0,0,0],0)),t)return t.value=e,t},t.exports=a},{"../data/colors":14,"./node":76}],56:[function(e,t,n){var r=e("./node"),i=function(e){" "===e?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=e?e.trim():"",this.emptyOrWhitespace=""===this.value)};(i.prototype=new r).type="Combinator";var a={"":!0," ":!0,"|":!0};i.prototype.genCSS=function(e,t){var n=e.compress||a[this.value]?"":" ";t.add(n+this.value+n)},t.exports=i},{"./node":76}],57:[function(e,t,n){var r=e("./node"),i=e("./debug-info"),a=function(e,t,n,r){this.value=e,this.isLineComment=t,this._index=n,this._fileInfo=r,this.allowRoot=!0};(a.prototype=new r).type="Comment",a.prototype.genCSS=function(e,t){this.debugInfo&&t.add(i(e,this),this.fileInfo(),this.getIndex()),t.add(this.value)},a.prototype.isSilent=function(e){var t=e.compress&&"!"!==this.value[2];return this.isLineComment||t},t.exports=a},{"./debug-info":59,"./node":76}],58:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r,i){this.op=e.trim(),this.lvalue=t,this.rvalue=n,this._index=r,this.negate=i};(i.prototype=new r).type="Condition",i.prototype.accept=function(e){this.lvalue=e.visit(this.lvalue),this.rvalue=e.visit(this.rvalue)},i.prototype.eval=function(e){var t=function(e,t,n){switch(e){case"and":return t&&n;case"or":return t||n;default:switch(r.compare(t,n)){case-1:return"<"===e||"=<"===e||"<="===e;case 0:return"="===e||">="===e||"=<"===e||"<="===e;case 1:return">"===e||">="===e;default:return!1}}}(this.op,this.lvalue.eval(e),this.rvalue.eval(e));return this.negate?!t:t},t.exports=i},{"./node":76}],59:[function(e,t,n){var r=function(e,t,n){var i="";if(e.dumpLineNumbers&&!e.compress)switch(e.dumpLineNumbers){case"comments":i=r.asComment(t);break;case"mediaquery":i=r.asMediaQuery(t);break;case"all":i=r.asComment(t)+(n||"")+r.asMediaQuery(t)}return i};r.asComment=function(e){return"/* line "+e.debugInfo.lineNumber+", "+e.debugInfo.fileName+" */\n"},r.asMediaQuery=function(e){var t=e.debugInfo.fileName;return/^[a-z]+:\/\//i.test(t)||(t="file://"+t),"@media -sass-debug-info{filename{font-family:"+t.replace(/([.:\/\\])/g,function(e){return"\\"==e&&(e="/"),"\\"+e})+"}line{font-family:\\00003"+e.debugInfo.lineNumber+"}}\n"},t.exports=r},{}],60:[function(e,t,n){var r=e("./node"),i=e("./value"),a=e("./keyword"),s=e("./anonymous"),o=e("../constants").Math,l=function(e,t,n,a,o,l,u,c){this.name=e,this.value=t instanceof r?t:new i([t?new s(t):null]),this.important=n?" "+n.trim():"",this.merge=a,this._index=o,this._fileInfo=l,this.inline=u||!1,this.variable=void 0!==c?c:e.charAt&&"@"===e.charAt(0),this.allowRoot=!0,this.setParent(this.value,this)};(l.prototype=new r).type="Declaration",l.prototype.genCSS=function(e,t){t.add(this.name+(e.compress?":":": "),this.fileInfo(),this.getIndex());try{this.value.genCSS(e,t)}catch(e){throw e.index=this._index,e.filename=this._fileInfo.filename,e}t.add(this.important+(this.inline||e.lastRule&&e.compress?"":";"),this._fileInfo,this._index)},l.prototype.eval=function(e){var t,n,r=!1,i=this.name,s=this.variable;"string"!=typeof i&&(i=1===i.length&&i[0]instanceof a?i[0].value:function(e,t){var n,r="",i=t.length,a={add:function(e){r+=e}};for(n=0;n<i;n++)t[n].eval(e).genCSS(e,a);return r}(e,i),s=!1),"font"===i&&e.math===o.ALWAYS&&(r=!0,t=e.math,e.math=o.PARENS_DIVISION);try{if(e.importantScope.push({}),n=this.value.eval(e),!this.variable&&"DetachedRuleset"===n.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.getIndex(),filename:this.fileInfo().filename};var u=this.important,c=e.importantScope.pop();return!u&&c.important&&(u=c.important),new l(i,n,u,this.merge,this.getIndex(),this.fileInfo(),this.inline,s)}catch(e){throw"number"!=typeof e.index&&(e.index=this.getIndex(),e.filename=this.fileInfo().filename),e}finally{r&&(e.math=t)}},l.prototype.makeImportant=function(){return new l(this.name,this.value,"!important",this.merge,this.getIndex(),this.fileInfo(),this.inline)},t.exports=l},{"../constants":12,"./anonymous":50,"./keyword":70,"./node":76,"./value":86}],61:[function(e,t,n){var r=e("./node"),i=e("../contexts"),a=e("../utils"),s=function(e,t){this.ruleset=e,this.frames=t,this.setParent(this.ruleset,this)};(s.prototype=new r).type="DetachedRuleset",s.prototype.evalFirst=!0,s.prototype.accept=function(e){this.ruleset=e.visit(this.ruleset)},s.prototype.eval=function(e){var t=this.frames||a.copyArray(e.frames);return new s(this.ruleset,t)},s.prototype.callEval=function(e){return this.ruleset.eval(this.frames?new i.Eval(e,this.frames.concat(e.frames)):e)},t.exports=s},{"../contexts":13,"../utils":89,"./node":76}],62:[function(e,t,n){var r=e("./node"),i=e("../data/unit-conversions"),a=e("./unit"),s=e("./color"),o=function(e,t){if(this.value=parseFloat(e),isNaN(this.value))throw new Error("Dimension is not a number.");this.unit=t&&t instanceof a?t:new a(t?[t]:void 0),this.setParent(this.unit,this)};(o.prototype=new r).type="Dimension",o.prototype.accept=function(e){this.unit=e.visit(this.unit)},o.prototype.eval=function(e){return this},o.prototype.toColor=function(){return new s([this.value,this.value,this.value])},o.prototype.genCSS=function(e,t){if(e&&e.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var n=this.fround(e,this.value),r=String(n);if(0!==n&&n<1e-6&&n>-1e-6&&(r=n.toFixed(20).replace(/0+$/,"")),e&&e.compress){if(0===n&&this.unit.isLength())return void t.add(r);n>0&&n<1&&(r=r.substr(1))}t.add(r),this.unit.genCSS(e,t)},o.prototype.operate=function(e,t,n){var r=this._operate(e,t,this.value,n.value),i=this.unit.clone();if("+"===t||"-"===t)if(0===i.numerator.length&&0===i.denominator.length)i=n.unit.clone(),this.unit.backupUnit&&(i.backupUnit=this.unit.backupUnit);else if(0===n.unit.numerator.length&&0===i.denominator.length);else{if(n=n.convertTo(this.unit.usedUnits()),e.strictUnits&&n.unit.toString()!==i.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+i.toString()+"' and '"+n.unit.toString()+"'.");r=this._operate(e,t,this.value,n.value)}else"*"===t?(i.numerator=i.numerator.concat(n.unit.numerator).sort(),i.denominator=i.denominator.concat(n.unit.denominator).sort(),i.cancel()):"/"===t&&(i.numerator=i.numerator.concat(n.unit.denominator).sort(),i.denominator=i.denominator.concat(n.unit.numerator).sort(),i.cancel());return new o(r,i)},o.prototype.compare=function(e){var t,n;if(e instanceof o){if(this.unit.isEmpty()||e.unit.isEmpty())t=this,n=e;else if(t=this.unify(),n=e.unify(),0!==t.unit.compare(n.unit))return;return r.numericCompare(t.value,n.value)}},o.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},o.prototype.convertTo=function(e){var t,n,r,a,s,l=this.value,u=this.unit.clone(),c={};if("string"==typeof e){for(t in i)i[t].hasOwnProperty(e)&&((c={})[t]=e);e=c}for(n in s=function(e,t){return r.hasOwnProperty(e)?(t?l/=r[e]/r[a]:l*=r[e]/r[a],a):e},e)e.hasOwnProperty(n)&&(a=e[n],r=i[n],u.map(s));return u.cancel(),new o(l,u)},t.exports=o},{"../data/unit-conversions":16,"./color":55,"./node":76,"./unit":84}],63:[function(e,t,n){var r=e("./node"),i=e("./paren"),a=e("./combinator"),s=function(e,t,n,r,i,s){this.combinator=e instanceof a?e:new a(e),this.value="string"==typeof t?t.trim():t||"",this.isVariable=n,this._index=r,this._fileInfo=i,this.copyVisibilityInfo(s),this.setParent(this.combinator,this)};(s.prototype=new r).type="Element",s.prototype.accept=function(e){var t=this.value;this.combinator=e.visit(this.combinator),"object"==typeof t&&(this.value=e.visit(t))},s.prototype.eval=function(e){return new s(this.combinator,this.value.eval?this.value.eval(e):this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},s.prototype.clone=function(){return new s(this.combinator,this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},s.prototype.genCSS=function(e,t){t.add(this.toCSS(e),this.fileInfo(),this.getIndex())},s.prototype.toCSS=function(e){e=e||{};var t=this.value,n=e.firstSelector;return t instanceof i&&(e.firstSelector=!0),t=t.toCSS?t.toCSS(e):t,e.firstSelector=n,""===t&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(e)+t},t.exports=s},{"./combinator":56,"./node":76,"./paren":78}],64:[function(e,t,n){var r=e("./node"),i=e("./paren"),a=e("./comment"),s=e("./dimension"),o=e("../constants").Math,l=function(e,t){if(this.value=e,this.noSpacing=t,!e)throw new Error("Expression requires an array parameter")};(l.prototype=new r).type="Expression",l.prototype.accept=function(e){this.value=e.visitArray(this.value)},l.prototype.eval=function(e){var t,n=e.isMathOn(),r=this.parens&&(e.math!==o.STRICT_LEGACY||!this.parensInOp),a=!1;return r&&e.inParenthesis(),this.value.length>1?t=new l(this.value.map(function(t){return t.eval?t.eval(e):t}),this.noSpacing):1===this.value.length?(!this.value[0].parens||this.value[0].parensInOp||e.inCalc||(a=!0),t=this.value[0].eval(e)):t=this,r&&e.outOfParenthesis(),!this.parens||!this.parensInOp||n||a||t instanceof s||(t=new i(t)),t},l.prototype.genCSS=function(e,t){for(var n=0;n<this.value.length;n++)this.value[n].genCSS(e,t),!this.noSpacing&&n+1<this.value.length&&t.add(" ")},l.prototype.throwAwayComments=function(){this.value=this.value.filter(function(e){return!(e instanceof a)})},t.exports=l},{"../constants":12,"./comment":57,"./dimension":62,"./node":76,"./paren":78}],65:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=function e(t,n,r,i,a){switch(this.selector=t,this.option=n,this.object_id=e.next_id++,this.parent_ids=[this.object_id],this._index=r,this._fileInfo=i,this.copyVisibilityInfo(a),this.allowRoot=!0,n){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}this.setParent(this.selector,this)};a.next_id=0,(a.prototype=new r).type="Extend",a.prototype.accept=function(e){this.selector=e.visit(this.selector)},a.prototype.eval=function(e){return new a(this.selector.eval(e),this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.clone=function(e){return new a(this.selector,this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.findSelfSelectors=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t].elements,t>0&&n.length&&""===n[0].combinator.value&&(n[0].combinator.value=" "),r=r.concat(e[t].elements);this.selfSelectors=[new i(r)],this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo())},t.exports=a},{"./node":76,"./selector":82}],66:[function(e,t,n){var r=e("./node"),i=e("./media"),a=e("./url"),s=e("./quoted"),o=e("./ruleset"),l=e("./anonymous"),u=e("../utils"),c=e("../less-error"),d=function(e,t,n,r,i,a){if(this.options=n,this._index=r,this._fileInfo=i,this.path=e,this.features=t,this.allowRoot=!0,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var s=this.getPath();s&&/[#\.\&\?]css([\?;].*)?$/.test(s)&&(this.css=!0)}this.copyVisibilityInfo(a),this.setParent(this.features,this),this.setParent(this.path,this)};(d.prototype=new r).type="Import",d.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.path=e.visit(this.path),this.options.isPlugin||this.options.inline||!this.root||(this.root=e.visit(this.root))},d.prototype.genCSS=function(e,t){this.css&&void 0===this.path._fileInfo.reference&&(t.add("@import ",this._fileInfo,this._index),this.path.genCSS(e,t),this.features&&(t.add(" "),this.features.genCSS(e,t)),t.add(";"))},d.prototype.getPath=function(){return this.path instanceof a?this.path.value.value:this.path.value},d.prototype.isVariableImport=function(){var e=this.path;return e instanceof a&&(e=e.value),!(e instanceof s)||e.containsVariables()},d.prototype.evalForImport=function(e){var t=this.path;return t instanceof a&&(t=t.value),new d(t.eval(e),this.features,this.options,this._index,this._fileInfo,this.visibilityInfo())},d.prototype.evalPath=function(e){var t=this.path.eval(e),n=this._fileInfo;if(!(t instanceof a)){var r=t.value;n&&r&&e.pathRequiresRewrite(r)?t.value=e.rewritePath(r,n.rootpath):t.value=e.normalizePath(t.value)}return t},d.prototype.eval=function(e){var t=this.doEval(e);return(this.options.reference||this.blocksVisibility())&&(t.length||0===t.length?t.forEach(function(e){e.addVisibilityBlock()}):t.addVisibilityBlock()),t},d.prototype.doEval=function(e){var t,n,r=this.features&&this.features.eval(e);if(this.options.isPlugin){if(this.root&&this.root.eval)try{this.root.eval(e)}catch(e){throw e.message="Plugin error during evaluation",new c(e,this.root.imports,this.root.filename)}return(n=e.frames[0]&&e.frames[0].functionRegistry)&&this.root&&this.root.functions&&n.addMultiple(this.root.functions),[]}if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var a=new l(this.root,0,{filename:this.importedFilename,reference:this.path._fileInfo&&this.path._fileInfo.reference},!0,!0);return this.features?new i([a],this.features.value):[a]}if(this.css){var s=new d(this.evalPath(e),r,this.options,this._index);if(!s.css&&this.error)throw this.error;return s}return(t=new o(null,u.copyArray(this.root.rules))).evalImports(e),this.features?new i(t.rules,this.features.value):t.rules},t.exports=d},{"../less-error":38,"../utils":89,"./anonymous":50,"./media":71,"./node":76,"./quoted":80,"./ruleset":81,"./url":85}],67:[function(e,t,n){var r=Object.create(null);r.Node=e("./node"),r.Color=e("./color"),r.AtRule=e("./atrule"),r.DetachedRuleset=e("./detached-ruleset"),r.Operation=e("./operation"),r.Dimension=e("./dimension"),r.Unit=e("./unit"),r.Keyword=e("./keyword"),r.Variable=e("./variable"),r.Property=e("./property"),r.Ruleset=e("./ruleset"),r.Element=e("./element"),r.Attribute=e("./attribute"),r.Combinator=e("./combinator"),r.Selector=e("./selector"),r.Quoted=e("./quoted"),r.Expression=e("./expression"),r.Declaration=e("./declaration"),r.Call=e("./call"),r.URL=e("./url"),r.Import=e("./import"),r.mixin={Call:e("./mixin-call"),Definition:e("./mixin-definition")},r.Comment=e("./comment"),r.Anonymous=e("./anonymous"),r.Value=e("./value"),r.JavaScript=e("./javascript"),r.Assignment=e("./assignment"),r.Condition=e("./condition"),r.Paren=e("./paren"),r.Media=e("./media"),r.UnicodeDescriptor=e("./unicode-descriptor"),r.Negative=e("./negative"),r.Extend=e("./extend"),r.VariableCall=e("./variable-call"),r.NamespaceValue=e("./namespace-value"),t.exports=r},{"./anonymous":50,"./assignment":51,"./atrule":52,"./attribute":53,"./call":54,"./color":55,"./combinator":56,"./comment":57,"./condition":58,"./declaration":60,"./detached-ruleset":61,"./dimension":62,"./element":63,"./expression":64,"./extend":65,"./import":66,"./javascript":68,"./keyword":70,"./media":71,"./mixin-call":72,"./mixin-definition":73,"./namespace-value":74,"./negative":75,"./node":76,"./operation":77,"./paren":78,"./property":79,"./quoted":80,"./ruleset":81,"./selector":82,"./unicode-descriptor":83,"./unit":84,"./url":85,"./value":86,"./variable":88,"./variable-call":87}],68:[function(e,t,n){var r=e("./js-eval-node"),i=e("./dimension"),a=e("./quoted"),s=e("./anonymous"),o=function(e,t,n,r){this.escaped=t,this.expression=e,this._index=n,this._fileInfo=r};(o.prototype=new r).type="JavaScript",o.prototype.eval=function(e){var t=this.evaluateJavaScript(this.expression,e),n=typeof t;return"number"!==n||isNaN(t)?"string"===n?new a('"'+t+'"',t,this.escaped,this._index):Array.isArray(t)?new s(t.join(", ")):new s(t):new i(t)},t.exports=o},{"./anonymous":50,"./dimension":62,"./js-eval-node":69,"./quoted":80}],69:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=function(){};(a.prototype=new r).evaluateJavaScript=function(e,t){var n,r=this,a={};if(!t.javascriptEnabled)throw{message:"Inline JavaScript is not enabled. Is it set in your options?",filename:this.fileInfo().filename,index:this.getIndex()};e=e.replace(/@\{([\w-]+)\}/g,function(e,n){return r.jsify(new i("@"+n,r.getIndex(),r.fileInfo()).eval(t))});try{e=new Function("return ("+e+")")}catch(t){throw{message:"JavaScript evaluation error: "+t.message+" from `"+e+"`",filename:this.fileInfo().filename,index:this.getIndex()}}var s=t.frames[0].variables();for(var o in s)s.hasOwnProperty(o)&&(a[o.slice(1)]={value:s[o].value,toJS:function(){return this.value.eval(t).toCSS()}});try{n=e.call(a)}catch(e){throw{message:"JavaScript evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:this.fileInfo().filename,index:this.getIndex()}}return n},a.prototype.jsify=function(e){return Array.isArray(e.value)&&e.value.length>1?"["+e.value.map(function(e){return e.toCSS()}).join(", ")+"]":e.toCSS()},t.exports=a},{"./node":76,"./variable":88}],70:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="Keyword",i.prototype.genCSS=function(e,t){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};t.add(this.value)},i.True=new i("true"),i.False=new i("false"),t.exports=i},{"./node":76}],71:[function(e,t,n){var r=e("./ruleset"),i=e("./value"),a=e("./selector"),s=e("./anonymous"),o=e("./expression"),l=e("./atrule"),u=e("../utils"),c=function(e,t,n,s,o){this._index=n,this._fileInfo=s;var l=new a([],null,null,this._index,this._fileInfo).createEmptySelectors();this.features=new i(t),this.rules=[new r(l,e)],this.rules[0].allowImports=!0,this.copyVisibilityInfo(o),this.allowRoot=!0,this.setParent(l,this),this.setParent(this.features,this),this.setParent(this.rules,this)};(c.prototype=new l).type="Media",c.prototype.isRulesetLike=function(){return!0},c.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.rules&&(this.rules=e.visitArray(this.rules))},c.prototype.genCSS=function(e,t){t.add("@media ",this._fileInfo,this._index),this.features.genCSS(e,t),this.outputRuleset(e,t,this.rules)},c.prototype.eval=function(e){e.mediaBlocks||(e.mediaBlocks=[],e.mediaPath=[]);var t=new c(null,[],this._index,this._fileInfo,this.visibilityInfo());return this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,t.debugInfo=this.debugInfo),t.features=this.features.eval(e),e.mediaPath.push(t),e.mediaBlocks.push(t),this.rules[0].functionRegistry=e.frames[0].functionRegistry.inherit(),e.frames.unshift(this.rules[0]),t.rules=[this.rules[0].eval(e)],e.frames.shift(),e.mediaPath.pop(),0===e.mediaPath.length?t.evalTop(e):t.evalNested(e)},c.prototype.evalTop=function(e){var t=this;if(e.mediaBlocks.length>1){var n=new a([],null,null,this.getIndex(),this.fileInfo()).createEmptySelectors();(t=new r(n,e.mediaBlocks)).multiMedia=!0,t.copyVisibilityInfo(this.visibilityInfo()),this.setParent(t,this)}return delete e.mediaBlocks,delete e.mediaPath,t},c.prototype.evalNested=function(e){var t,n,a=e.mediaPath.concat([this]);for(t=0;t<a.length;t++)n=a[t].features instanceof i?a[t].features.value:a[t].features,a[t]=Array.isArray(n)?n:[n];return this.features=new i(this.permute(a).map(function(e){for(e=e.map(function(e){return e.toCSS?e:new s(e)}),t=e.length-1;t>0;t--)e.splice(t,0,new s("and"));return new o(e)})),this.setParent(this.features,this),new r([],[])},c.prototype.permute=function(e){if(0===e.length)return[];if(1===e.length)return e[0];for(var t=[],n=this.permute(e.slice(1)),r=0;r<n.length;r++)for(var i=0;i<e[0].length;i++)t.push([e[0][i]].concat(n[r]));return t},c.prototype.bubbleSelectors=function(e){e&&(this.rules=[new r(u.copyArray(e),[this.rules[0]])],this.setParent(this.rules,this))},t.exports=c},{"../utils":89,"./anonymous":50,"./atrule":52,"./expression":64,"./ruleset":81,"./selector":82,"./value":86}],72:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=e("./mixin-definition"),s=e("../functions/default"),o=function(e,t,n,r,a){this.selector=new i(e),this.arguments=t||[],this._index=n,this._fileInfo=r,this.important=a,this.allowRoot=!0,this.setParent(this.selector,this)};(o.prototype=new r).type="MixinCall",o.prototype.accept=function(e){this.selector&&(this.selector=e.visit(this.selector)),this.arguments.length&&(this.arguments=e.visitArray(this.arguments))},o.prototype.eval=function(e){var t,n,r,i,o,l,u,c,d,h,f,p,m,v,g,y=[],_=[],w=!1,E=[],b=[],S=-1,T=0,k=1,C=2;function I(t,n){var r,i,a;for(r=0;r<2;r++){for(b[r]=!0,s.value(r),i=0;i<n.length&&b[r];i++)(a=n[i]).matchCondition&&(b[r]=b[r]&&a.matchCondition(null,e));t.matchCondition&&(b[r]=b[r]&&t.matchCondition(y,e))}return b[0]||b[1]?b[0]!=b[1]?b[1]?k:C:T:S}for(this.selector=this.selector.eval(e),l=0;l<this.arguments.length;l++)if(i=this.arguments[l],o=i.value.eval(e),i.expand&&Array.isArray(o.value))for(o=o.value,u=0;u<o.length;u++)y.push({value:o[u]});else y.push({name:i.name,value:o});for(g=function(t){return t.matchArgs(null,e)},l=0;l<e.frames.length;l++)if((t=e.frames[l].find(this.selector,null,g)).length>0){for(h=!0,u=0;u<t.length;u++){for(n=t[u].rule,r=t[u].path,d=!1,c=0;c<e.frames.length;c++)if(!(n instanceof a)&&n===(e.frames[c].originalRuleset||e.frames[c])){d=!0;break}d||n.matchArgs(y,e)&&((f={mixin:n,group:I(n,r)}).group!==S&&E.push(f),w=!0)}for(s.reset(),m=[0,0,0],u=0;u<E.length;u++)m[E[u].group]++;if(m[T]>0)p=C;else if(p=k,m[k]+m[C]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(y)+"`",index:this.getIndex(),filename:this.fileInfo().filename};for(u=0;u<E.length;u++)if((f=E[u].group)===T||f===p)try{(n=E[u].mixin)instanceof a||(v=n.originalRuleset||n,(n=new a("",[],n.rules,null,!1,null,v.visibilityInfo())).originalRuleset=v);var A=n.evalCall(e,y,this.important).rules;this._setVisibilityToReplacement(A),Array.prototype.push.apply(_,A)}catch(e){throw{message:e.message,index:this.getIndex(),filename:this.fileInfo().filename,stack:e.stack}}if(w)return _}throw h?{type:"Runtime",message:"No matching definition was found for `"+this.format(y)+"`",index:this.getIndex(),filename:this.fileInfo().filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.getIndex(),filename:this.fileInfo().filename}},o.prototype._setVisibilityToReplacement=function(e){var t;if(this.blocksVisibility())for(t=0;t<e.length;t++)e[t].addVisibilityBlock()},o.prototype.format=function(e){return this.selector.toCSS().trim()+"("+(e?e.map(function(e){var t="";return e.name&&(t+=e.name+":"),e.value.toCSS?t+=e.value.toCSS():t+="???",t}).join(", "):"")+")"},t.exports=o},{"../functions/default":25,"./mixin-definition":73,"./node":76,"./selector":82}],73:[function(e,t,n){var r=e("./selector"),i=e("./element"),a=e("./ruleset"),s=e("./declaration"),o=e("./detached-ruleset"),l=e("./expression"),u=e("../contexts"),c=e("../utils"),d=function(e,t,n,a,s,o,l){this.name=e||"anonymous mixin",this.selectors=[new r([new i(null,e,!1,this._index,this._fileInfo)])],this.params=t,this.condition=a,this.variadic=s,this.arity=t.length,this.rules=n,this._lookups={};var u=[];this.required=t.reduce(function(e,t){return!t.name||t.name&&!t.value?e+1:(u.push(t.name),e)},0),this.optionalParameters=u,this.frames=o,this.copyVisibilityInfo(l),this.allowRoot=!0};(d.prototype=new a).type="MixinDefinition",d.prototype.evalFirst=!0,d.prototype.accept=function(e){this.params&&this.params.length&&(this.params=e.visitArray(this.params)),this.rules=e.visitArray(this.rules),this.condition&&(this.condition=e.visit(this.condition))},d.prototype.evalParams=function(e,t,n,r){var i,d,h,f,p,m,v,g,y=new a(null,null),_=c.copyArray(this.params),w=0;if(t.frames&&t.frames[0]&&t.frames[0].functionRegistry&&(y.functionRegistry=t.frames[0].functionRegistry.inherit()),t=new u.Eval(t,[y].concat(t.frames)),n)for(n=c.copyArray(n),w=n.length,h=0;h<w;h++)if(d=n[h],m=d&&d.name){for(v=!1,f=0;f<_.length;f++)if(!r[f]&&m===_[f].name){r[f]=d.value.eval(e),y.prependRule(new s(m,d.value.eval(e))),v=!0;break}if(v){n.splice(h,1),h--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+n[h].name+" not found"}}for(g=0,h=0;h<_.length;h++)if(!r[h]){if(d=n&&n[g],m=_[h].name)if(_[h].variadic){for(i=[],f=g;f<w;f++)i.push(n[f].value.eval(e));y.prependRule(new s(m,new l(i).eval(e)))}else{if(p=d&&d.value)p=Array.isArray(p)?new o(new a("",p)):p.eval(e);else{if(!_[h].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+w+" for "+this.arity+")"};p=_[h].value.eval(t),y.resetCache()}y.prependRule(new s(m,p)),r[h]=p}if(_[h].variadic&&n)for(f=g;f<w;f++)r[f]=n[f].value.eval(e);g++}return y},d.prototype.makeImportant=function(){var e=this.rules?this.rules.map(function(e){return e.makeImportant?e.makeImportant(!0):e}):this.rules,t=new d(this.name,this.params,e,this.condition,this.variadic,this.frames);return t},d.prototype.eval=function(e){return new d(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||c.copyArray(e.frames))},d.prototype.evalCall=function(e,t,n){var r,i,o=[],d=this.frames?this.frames.concat(e.frames):e.frames,h=this.evalParams(e,new u.Eval(e,d),t,o);return h.prependRule(new s("@arguments",new l(o).eval(e))),r=c.copyArray(this.rules),(i=new a(null,r)).originalRuleset=this,i=i.eval(new u.Eval(e,[this,h].concat(d))),n&&(i=i.makeImportant()),i},d.prototype.matchCondition=function(e,t){return!(this.condition&&!this.condition.eval(new u.Eval(t,[this.evalParams(t,new u.Eval(t,this.frames?this.frames.concat(t.frames):t.frames),e,[])].concat(this.frames||[]).concat(t.frames))))},d.prototype.matchArgs=function(e,t){var n,r=e&&e.length||0,i=this.optionalParameters,a=e?e.reduce(function(e,t){return i.indexOf(t.name)<0?e+1:e},0):0;if(this.variadic){if(a<this.required-1)return!1}else{if(a<this.required)return!1;if(r>this.params.length)return!1}n=Math.min(a,this.arity);for(var s=0;s<n;s++)if(!this.params[s].name&&!this.params[s].variadic&&e[s].value.eval(t).toCSS()!=this.params[s].value.eval(t).toCSS())return!1;return!0},t.exports=d},{"../contexts":13,"../utils":89,"./declaration":60,"./detached-ruleset":61,"./element":63,"./expression":64,"./ruleset":81,"./selector":82}],74:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./ruleset"),s=e("./selector"),o=function(e,t,n,r,i){this.value=e,this.lookups=t,this.important=n,this._index=r,this._fileInfo=i};(o.prototype=new r).type="NamespaceValue",o.prototype.eval=function(e){var t,n,r=this.value.eval(e);for(t=0;t<this.lookups.length;t++){if(n=this.lookups[t],Array.isArray(r)&&(r=new a([new s],r)),""===n)r=r.lastDeclaration();else if("@"===n.charAt(0)){if("@"===n.charAt(1)&&(n="@"+new i(n.substr(1)).eval(e).value),r.variables&&(r=r.variable(n)),!r)throw{type:"Name",message:"variable "+n+" not found",filename:this.fileInfo().filename,index:this.getIndex()}}else{if(n="$@"===n.substring(0,2)?"$"+new i(n.substr(1)).eval(e).value:"$"===n.charAt(0)?n:"$"+n,r.properties&&(r=r.property(n)),!r)throw{type:"Name",message:'property "'+n.substr(1)+'" not found',filename:this.fileInfo().filename,index:this.getIndex()};r=r[r.length-1]}r.value&&(r=r.eval(e).value),r.ruleset&&(r=r.ruleset.eval(e))}return r},t.exports=o},{"./node":76,"./ruleset":81,"./selector":82,"./variable":88}],75:[function(e,t,n){var r=e("./node"),i=e("./operation"),a=e("./dimension"),s=function(e){this.value=e};(s.prototype=new r).type="Negative",s.prototype.genCSS=function(e,t){t.add("-"),this.value.genCSS(e,t)},s.prototype.eval=function(e){return e.isMathOn()?new i("*",[new a(-1),this.value]).eval(e):new s(this.value.eval(e))},t.exports=s},{"./dimension":62,"./node":76,"./operation":77}],76:[function(e,t,n){var r=function(){this.parent=null,this.visibilityBlocks=void 0,this.nodeVisible=void 0,this.rootNode=null,this.parsed=null;var e=this;Object.defineProperty(this,"currentFileInfo",{get:function(){return e.fileInfo()}}),Object.defineProperty(this,"index",{get:function(){return e.getIndex()}})};r.prototype.setParent=function(e,t){function n(e){e&&e instanceof r&&(e.parent=t)}Array.isArray(e)?e.forEach(n):n(e)},r.prototype.getIndex=function(){return this._index||this.parent&&this.parent.getIndex()||0},r.prototype.fileInfo=function(){return this._fileInfo||this.parent&&this.parent.fileInfo()||{}},r.prototype.isRulesetLike=function(){return!1},r.prototype.toCSS=function(e){var t=[];return this.genCSS(e,{add:function(e,n,r){t.push(e)},isEmpty:function(){return 0===t.length}}),t.join("")},r.prototype.genCSS=function(e,t){t.add(this.value)},r.prototype.accept=function(e){this.value=e.visit(this.value)},r.prototype.eval=function(){return this},r.prototype._operate=function(e,t,n,r){switch(t){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r}},r.prototype.fround=function(e,t){var n=e&&e.numPrecision;return n?Number((t+2e-16).toFixed(n)):t},r.compare=function(e,t){if(e.compare&&"Quoted"!==t.type&&"Anonymous"!==t.type)return e.compare(t);if(t.compare)return-t.compare(e);if(e.type===t.type){if(e=e.value,t=t.value,!Array.isArray(e))return e===t?0:void 0;if(e.length===t.length){for(var n=0;n<e.length;n++)if(0!==r.compare(e[n],t[n]))return;return 0}}},r.numericCompare=function(e,t){return e<t?-1:e===t?0:e>t?1:void 0},r.prototype.blocksVisibility=function(){return null==this.visibilityBlocks&&(this.visibilityBlocks=0),0!==this.visibilityBlocks},r.prototype.addVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks+1},r.prototype.removeVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks-1},r.prototype.ensureVisibility=function(){this.nodeVisible=!0},r.prototype.ensureInvisibility=function(){this.nodeVisible=!1},r.prototype.isVisible=function(){return this.nodeVisible},r.prototype.visibilityInfo=function(){return{visibilityBlocks:this.visibilityBlocks,nodeVisible:this.nodeVisible}},r.prototype.copyVisibilityInfo=function(e){e&&(this.visibilityBlocks=e.visibilityBlocks,this.nodeVisible=e.nodeVisible)},t.exports=r},{}],77:[function(e,t,n){var r=e("./node"),i=e("./color"),a=e("./dimension"),s=e("../constants").Math,o=function(e,t,n){this.op=e.trim(),this.operands=t,this.isSpaced=n};(o.prototype=new r).type="Operation",o.prototype.accept=function(e){this.operands=e.visit(this.operands)},o.prototype.eval=function(e){var t,n=this.operands[0].eval(e),r=this.operands[1].eval(e);if(e.isMathOn(this.op)){if(t="./"===this.op?"/":this.op,n instanceof a&&r instanceof i&&(n=n.toColor()),r instanceof a&&n instanceof i&&(r=r.toColor()),!n.operate){if(n instanceof o&&"/"===n.op&&e.math===s.PARENS_DIVISION)return new o(this.op,[n,r],this.isSpaced);throw{type:"Operation",message:"Operation on an invalid type"}}return n.operate(e,t,r)}return new o(this.op,[n,r],this.isSpaced)},o.prototype.genCSS=function(e,t){this.operands[0].genCSS(e,t),this.isSpaced&&t.add(" "),t.add(this.op),this.isSpaced&&t.add(" "),this.operands[1].genCSS(e,t)},t.exports=o},{"../constants":12,"./color":55,"./dimension":62,"./node":76}],78:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="Paren",i.prototype.genCSS=function(e,t){t.add("("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){return new i(this.value.eval(e))},t.exports=i},{"./node":76}],79:[function(e,t,n){var r=e("./node"),i=e("./declaration"),a=function(e,t,n){this.name=e,this._index=t,this._fileInfo=n};(a.prototype=new r).type="Property",a.prototype.eval=function(e){var t,n=this.name,r=e.pluginManager.less.visitors.ToCSSVisitor.prototype._mergeRules;if(this.evaluating)throw{type:"Name",message:"Recursive property reference for "+n,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var a,s=t.property(n);if(s){for(var o=0;o<s.length;o++)a=s[o],s[o]=new i(a.name,a.value,a.important,a.merge,a.index,a.currentFileInfo,a.inline,a.variable);if(r(s),(a=s[s.length-1]).important){var l=e.importantScope[e.importantScope.length-1];l.important=a.important}return a=a.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"Property '"+n+"' is undefined",filename:this.currentFileInfo.filename,index:this.index}},a.prototype.find=function(e,t){for(var n,r=0;r<e.length;r++)if(n=t.call(e,e[r]))return n;return null},t.exports=a},{"./declaration":60,"./node":76}],80:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./property"),s=function(e,t,n,r,i){this.escaped=null==n||n,this.value=t||"",this.quote=e.charAt(0),this._index=r,this._fileInfo=i,this.variableRegex=/@\{([\w-]+)\}/g,this.propRegex=/\$\{([\w-]+)\}/g};(s.prototype=new r).type="Quoted",s.prototype.genCSS=function(e,t){this.escaped||t.add(this.quote,this.fileInfo(),this.getIndex()),t.add(this.value),this.escaped||t.add(this.quote)},s.prototype.containsVariables=function(){return this.value.match(this.variableRegex)},s.prototype.eval=function(e){var t=this,n=this.value;function r(e,t,n){var r=e;do{r=(e=r).replace(t,n)}while(e!==r);return r}return n=r(n,this.variableRegex,function(n,r){var a=new i("@"+r,t.getIndex(),t.fileInfo()).eval(e,!0);return a instanceof s?a.value:a.toCSS()}),n=r(n,this.propRegex,function(n,r){var i=new a("$"+r,t.getIndex(),t.fileInfo()).eval(e,!0);return i instanceof s?i.value:i.toCSS()}),new s(this.quote+n+this.quote,n,this.escaped,this.getIndex(),this.fileInfo())},s.prototype.compare=function(e){return"Quoted"!==e.type||this.escaped||e.escaped?e.toCSS&&this.toCSS()===e.toCSS()?0:void 0:r.numericCompare(this.value,e.value)},t.exports=s},{"./node":76,"./property":79,"./variable":88}],81:[function(e,t,n){var r=e("./node"),i=e("./declaration"),a=e("./keyword"),s=e("./comment"),o=e("./paren"),l=e("./selector"),u=e("./element"),c=e("./anonymous"),d=e("../contexts"),h=e("../functions/function-registry"),f=e("../functions/default"),p=e("./debug-info"),m=e("../utils"),v=function(e,t,n,r){this.selectors=e,this.rules=t,this._lookups={},this._variables=null,this._properties=null,this.strictImports=n,this.copyVisibilityInfo(r),this.allowRoot=!0,this.setParent(this.selectors,this),this.setParent(this.rules,this)};(v.prototype=new r).type="Ruleset",v.prototype.isRuleset=!0,v.prototype.isRulesetLike=function(){return!0},v.prototype.accept=function(e){this.paths?this.paths=e.visitArray(this.paths,!0):this.selectors&&(this.selectors=e.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=e.visitArray(this.rules))},v.prototype.eval=function(e){var t,n,a,s,o,l=!1;if(this.selectors&&(n=this.selectors.length)){for(t=new Array(n),f.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),s=0;s<n;s++){a=this.selectors[s].eval(e);for(var u=0;u<a.elements.length;u++)if(a.elements[u].isVariable){o=!0;break}t[s]=a,a.evaldCondition&&(l=!0)}if(o){var c=new Array(n);for(s=0;s<n;s++)a=t[s],c[s]=a.toCSS(e);this.parse.parseNode(c.join(","),["selectors"],t[0].getIndex(),t[0].fileInfo(),function(e,n){n&&(t=m.flattenArray(n))})}f.reset()}else l=!0;var d,p,g=this.rules?m.copyArray(this.rules):null,y=new v(t,g,this.strictImports,this.visibilityInfo());y.originalRuleset=this,y.root=this.root,y.firstRoot=this.firstRoot,y.allowImports=this.allowImports,this.debugInfo&&(y.debugInfo=this.debugInfo),l||(g.length=0),y.functionRegistry=function(e){for(var t,n=0,r=e.length;n!==r;++n)if(t=e[n].functionRegistry)return t;return h}(e.frames).inherit();var _=e.frames;_.unshift(y);var w=e.selectors;w||(e.selectors=w=[]),w.unshift(this.selectors),(y.root||y.allowImports||!y.strictImports)&&y.evalImports(e);var E=y.rules;for(s=0;d=E[s];s++)d.evalFirst&&(E[s]=d.eval(e));var b=e.mediaBlocks&&e.mediaBlocks.length||0;for(s=0;d=E[s];s++)"MixinCall"===d.type?(g=d.eval(e).filter(function(e){return!(e instanceof i&&e.variable&&y.variable(e.name))}),E.splice.apply(E,[s,1].concat(g)),s+=g.length-1,y.resetCache()):"VariableCall"===d.type&&(g=d.eval(e).rules.filter(function(e){return!(e instanceof i&&e.variable)}),E.splice.apply(E,[s,1].concat(g)),s+=g.length-1,y.resetCache());for(s=0;d=E[s];s++)d.evalFirst||(E[s]=d=d.eval?d.eval(e):d);for(s=0;d=E[s];s++)if(d instanceof v&&d.selectors&&1===d.selectors.length&&d.selectors[0]&&d.selectors[0].isJustParentSelector()){E.splice(s--,1);for(var u=0;p=d.rules[u];u++)p instanceof r&&(p.copyVisibilityInfo(d.visibilityInfo()),p instanceof i&&p.variable||E.splice(++s,0,p))}if(_.shift(),w.shift(),e.mediaBlocks)for(s=b;s<e.mediaBlocks.length;s++)e.mediaBlocks[s].bubbleSelectors(t);return y},v.prototype.evalImports=function(e){var t,n,r=this.rules;if(r)for(t=0;t<r.length;t++)"Import"===r[t].type&&((n=r[t].eval(e))&&(n.length||0===n.length)?(r.splice.apply(r,[t,1].concat(n)),t+=n.length-1):r.splice(t,1,n),this.resetCache())},v.prototype.makeImportant=function(){var e=new v(this.selectors,this.rules.map(function(e){return e.makeImportant?e.makeImportant():e}),this.strictImports,this.visibilityInfo());return e},v.prototype.matchArgs=function(e){return!e||0===e.length},v.prototype.matchCondition=function(e,t){var n=this.selectors[this.selectors.length-1];return!(!n.evaldCondition||n.condition&&!n.condition.eval(new d.Eval(t,t.frames)))},v.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._properties=null,this._lookups={}},v.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(e,t){if(t instanceof i&&!0===t.variable&&(e[t.name]=t),"Import"===t.type&&t.root&&t.root.variables){var n=t.root.variables();for(var r in n)n.hasOwnProperty(r)&&(e[r]=t.root.variable(r))}return e},{}):{}),this._variables},v.prototype.properties=function(){return this._properties||(this._properties=this.rules?this.rules.reduce(function(e,t){if(t instanceof i&&!0!==t.variable){var n=1===t.name.length&&t.name[0]instanceof a?t.name[0].value:t.name;e["$"+n]?e["$"+n].push(t):e["$"+n]=[t]}return e},{}):{}),this._properties},v.prototype.variable=function(e){var t=this.variables()[e];if(t)return this.parseValue(t)},v.prototype.property=function(e){var t=this.properties()[e];if(t)return this.parseValue(t)},v.prototype.lastDeclaration=function(){for(var e=this.rules.length;e>0;e--){var t=this.rules[e-1];if(t instanceof i)return this.parseValue(t)}},v.prototype.parseValue=function(e){var t=this;function n(e){return e.value instanceof c&&!e.parsed?("string"==typeof e.value.value?this.parse.parseNode(e.value.value,["value","important"],e.value.getIndex(),e.fileInfo(),function(t,n){t&&(e.parsed=!0),n&&(e.value=n[0],e.important=n[1]||"",e.parsed=!0)}):e.parsed=!0,e):e}if(Array.isArray(e)){var r=[];return e.forEach(function(e){r.push(n.call(t,e))}),r}return n.call(t,e)},v.prototype.rulesets=function(){if(!this.rules)return[];var e,t,n=[],r=this.rules;for(e=0;t=r[e];e++)t.isRuleset&&n.push(t);return n},v.prototype.prependRule=function(e){var t=this.rules;t?t.unshift(e):this.rules=[e],this.setParent(e,this)},v.prototype.find=function(e,t,n){t=t||this;var r,i,a=[],s=e.toCSS();return s in this._lookups?this._lookups[s]:(this.rulesets().forEach(function(s){if(s!==t)for(var o=0;o<s.selectors.length;o++)if(r=e.match(s.selectors[o])){if(e.elements.length>r){if(!n||n(s)){i=s.find(new l(e.elements.slice(r)),t,n);for(var u=0;u<i.length;++u)i[u].path.push(s);Array.prototype.push.apply(a,i)}}else a.push({rule:s,path:[]});break}}),this._lookups[s]=a,a)},v.prototype.genCSS=function(e,t){var n,r,i,a,o,l=[];e.tabLevel=e.tabLevel||0,this.root||e.tabLevel++;var u,c=e.compress?"":Array(e.tabLevel+1).join("  "),d=e.compress?"":Array(e.tabLevel).join("  "),h=0,f=0;for(n=0;a=this.rules[n];n++)a instanceof s?(f===n&&f++,l.push(a)):a.isCharset&&a.isCharset()?(l.splice(h,0,a),h++,f++):"Import"===a.type?(l.splice(f,0,a),f++):l.push(a);if(l=[].concat(l),!this.root){(i=p(e,this,d))&&(t.add(i),t.add(d));var m,v=this.paths,g=v.length;for(u=e.compress?",":",\n"+d,n=0;n<g;n++)if(o=v[n],m=o.length)for(n>0&&t.add(u),e.firstSelector=!0,o[0].genCSS(e,t),e.firstSelector=!1,r=1;r<m;r++)o[r].genCSS(e,t);t.add((e.compress?"{":" {\n")+c)}for(n=0;a=l[n];n++){n+1===l.length&&(e.lastRule=!0);var y=e.lastRule;a.isRulesetLike(a)&&(e.lastRule=!1),a.genCSS?a.genCSS(e,t):a.value&&t.add(a.value.toString()),e.lastRule=y,!e.lastRule&&a.isVisible()?t.add(e.compress?"":"\n"+c):e.lastRule=!1}this.root||(t.add(e.compress?"}":"\n"+d+"}"),e.tabLevel--),t.isEmpty()||e.compress||!this.firstRoot||t.add("\n")},v.prototype.joinSelectors=function(e,t,n){for(var r=0;r<n.length;r++)this.joinSelector(e,t,n[r])},v.prototype.joinSelector=function(e,t,n){function r(e,t){var n,r;if(0===e.length)n=new o(e[0]);else{var i=new Array(e.length);for(r=0;r<e.length;r++)i[r]=new u(null,e[r],t.isVariable,t._index,t._fileInfo);n=new o(new l(i))}return n}function i(e,t,n,r){var i,a,s;if(i=[],e.length>0?(i=m.copyArray(e),a=i.pop(),s=r.createDerived(m.copyArray(a.elements))):s=r.createDerived([]),t.length>0){var o=n.combinator,l=t[0].elements[0];o.emptyOrWhitespace&&!l.combinator.emptyOrWhitespace&&(o=l.combinator),s.elements.push(new u(o,l.value,n.isVariable,n._index,n._fileInfo)),s.elements=s.elements.concat(t[0].elements.slice(1))}if(0!==s.elements.length&&i.push(s),t.length>1){var c=t.slice(1);c=c.map(function(e){return e.createDerived(e.elements,[])}),i=i.concat(c)}return i}function a(e,t,n,r,a){var s;for(s=0;s<e.length;s++){var o=i(e[s],t,n,r);a.push(o)}return a}function s(e,t){var n,r;if(0!==e.length)if(0!==t.length)for(n=0;r=t[n];n++)r.length>0?r[r.length-1]=r[r.length-1].createDerived(r[r.length-1].elements.concat(e)):r.push(new l(e));else t.push([new l(e)])}function c(e,t){var n=t.createDerived(t.elements,t.extendList,t.evaldCondition);return n.copyVisibilityInfo(e),n}var d,h;if(!function e(t,n,c){var d,h,f,p,m,v,g,y,_,w,E,b,S,T=!1;function k(e){var t;return e.value instanceof o&&(t=e.value.value)instanceof l?t:null}for(p=[],m=[[]],d=0;y=c.elements[d];d++)if("&"!==y.value){var C=k(y);if(null!=C){s(p,m);var I,A=[],L=[];for(I=e(A,n,C),T=T||I,f=0;f<A.length;f++){var R=(E=r(A[f],y),S=void 0,S=new u(null,E,(b=y).isVariable,b._index,b._fileInfo),new l([S]));a(m,[R],y,c,L)}m=L,p=[]}else p.push(y)}else{for(T=!0,v=[],s(p,m),h=0;h<m.length;h++)if(g=m[h],0===n.length)g.length>0&&g[0].elements.push(new u(y.combinator,"",y.isVariable,y._index,y._fileInfo)),v.push(g);else for(f=0;f<n.length;f++){var x=i(g,n[f],y,c);v.push(x)}m=v,p=[]}for(s(p,m),d=0;d<m.length;d++)(_=m[d].length)>0&&(t.push(m[d]),w=m[d][_-1],m[d][_-1]=w.createDerived(w.elements,c.extendList));return T}(h=[],t,n))if(t.length>0)for(h=[],d=0;d<t.length;d++){var f=t[d].map(c.bind(this,n.visibilityInfo()));f.push(n),h.push(f)}else h=[[n]];for(d=0;d<h.length;d++)e.push(h[d])},t.exports=v},{"../contexts":13,"../functions/default":25,"../functions/function-registry":27,"../utils":89,"./anonymous":50,"./comment":57,"./debug-info":59,"./declaration":60,"./element":63,"./keyword":70,"./node":76,"./paren":78,"./selector":82}],82:[function(e,t,n){var r=e("./node"),i=e("./element"),a=e("../less-error"),s=function(e,t,n,r,i,a){this.extendList=t,this.condition=n,this.evaldCondition=!n,this._index=r,this._fileInfo=i,this.elements=this.getElements(e),this.mixinElements_=void 0,this.copyVisibilityInfo(a),this.setParent(this.elements,this)};(s.prototype=new r).type="Selector",s.prototype.accept=function(e){this.elements&&(this.elements=e.visitArray(this.elements)),this.extendList&&(this.extendList=e.visitArray(this.extendList)),this.condition&&(this.condition=e.visit(this.condition))},s.prototype.createDerived=function(e,t,n){e=this.getElements(e);var r=new s(e,t||this.extendList,null,this.getIndex(),this.fileInfo(),this.visibilityInfo());return r.evaldCondition=null!=n?n:this.evaldCondition,r.mediaEmpty=this.mediaEmpty,r},s.prototype.getElements=function(e){return e?("string"==typeof e&&this.parse.parseNode(e,["selector"],this._index,this._fileInfo,function(t,n){if(t)throw new a({index:t.index,message:t.message},this.parse.imports,this._fileInfo.filename);e=n[0].elements}),e):[new i("","&",!1,this._index,this._fileInfo)]},s.prototype.createEmptySelectors=function(){var e=new i("","&",!1,this._index,this._fileInfo),t=[new s([e],null,null,this._index,this._fileInfo)];return t[0].mediaEmpty=!0,t},s.prototype.match=function(e){var t,n,r=this.elements,i=r.length;if(e=e.mixinElements(),0===(t=e.length)||i<t)return 0;for(n=0;n<t;n++)if(r[n].value!==e[n])return 0;return t},s.prototype.mixinElements=function(){if(this.mixinElements_)return this.mixinElements_;var e=this.elements.map(function(e){return e.combinator.value+(e.value.value||e.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);return e?"&"===e[0]&&e.shift():e=[],this.mixinElements_=e},s.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},s.prototype.eval=function(e){var t=this.condition&&this.condition.eval(e),n=this.elements,r=this.extendList;return n=n&&n.map(function(t){return t.eval(e)}),r=r&&r.map(function(t){return t.eval(e)}),this.createDerived(n,r,t)},s.prototype.genCSS=function(e,t){var n;for(e&&e.firstSelector||""!==this.elements[0].combinator.value||t.add(" ",this.fileInfo(),this.getIndex()),n=0;n<this.elements.length;n++)this.elements[n].genCSS(e,t)},s.prototype.getIsOutput=function(){return this.evaldCondition},t.exports=s},{"../less-error":38,"./element":63,"./node":76}],83:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="UnicodeDescriptor",t.exports=i},{"./node":76}],84:[function(e,t,n){var r=e("./node"),i=e("../data/unit-conversions"),a=e("../utils"),s=function(e,t,n){this.numerator=e?a.copyArray(e).sort():[],this.denominator=t?a.copyArray(t).sort():[],n?this.backupUnit=n:e&&e.length&&(this.backupUnit=e[0])};(s.prototype=new r).type="Unit",s.prototype.clone=function(){return new s(a.copyArray(this.numerator),a.copyArray(this.denominator),this.backupUnit)},s.prototype.genCSS=function(e,t){var n=e&&e.strictUnits;1===this.numerator.length?t.add(this.numerator[0]):!n&&this.backupUnit?t.add(this.backupUnit):!n&&this.denominator.length&&t.add(this.denominator[0])},s.prototype.toString=function(){var e,t=this.numerator.join("*");for(e=0;e<this.denominator.length;e++)t+="/"+this.denominator[e];return t},s.prototype.compare=function(e){return this.is(e.toString())?0:void 0},s.prototype.is=function(e){return this.toString().toUpperCase()===e.toUpperCase()},s.prototype.isLength=function(){return RegExp("^(px|em|ex|ch|rem|in|cm|mm|pc|pt|ex|vw|vh|vmin|vmax)$","gi").test(this.toCSS())},s.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},s.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},s.prototype.map=function(e){var t;for(t=0;t<this.numerator.length;t++)this.numerator[t]=e(this.numerator[t],!1);for(t=0;t<this.denominator.length;t++)this.denominator[t]=e(this.denominator[t],!0)},s.prototype.usedUnits=function(){var e,t,n,r={};for(n in t=function(t){return e.hasOwnProperty(t)&&!r[n]&&(r[n]=t),t},i)i.hasOwnProperty(n)&&(e=i[n],this.map(t));return r},s.prototype.cancel=function(){var e,t,n={};for(t=0;t<this.numerator.length;t++)e=this.numerator[t],n[e]=(n[e]||0)+1;for(t=0;t<this.denominator.length;t++)e=this.denominator[t],n[e]=(n[e]||0)-1;for(e in this.numerator=[],this.denominator=[],n)if(n.hasOwnProperty(e)){var r=n[e];if(r>0)for(t=0;t<r;t++)this.numerator.push(e);else if(r<0)for(t=0;t<-r;t++)this.denominator.push(e)}this.numerator.sort(),this.denominator.sort()},t.exports=s},{"../data/unit-conversions":16,"../utils":89,"./node":76}],85:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r){this.value=e,this._index=t,this._fileInfo=n,this.isEvald=r};(i.prototype=new r).type="Url",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.genCSS=function(e,t){t.add("url("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){var t,n=this.value.eval(e);if(!this.isEvald&&("string"==typeof(t=this.fileInfo()&&this.fileInfo().rootpath)&&"string"==typeof n.value&&e.pathRequiresRewrite(n.value)?(n.quote||(t=t.replace(/[\(\)'"\s]/g,function(e){return"\\"+e})),n.value=e.rewritePath(n.value,t)):n.value=e.normalizePath(n.value),e.urlArgs&&!n.value.match(/^\s*data:/))){var r=-1===n.value.indexOf("?")?"?":"&",a=r+e.urlArgs;-1!==n.value.indexOf("#")?n.value=n.value.replace("#",a+"#"):n.value+=a}return new i(n,this.getIndex(),this.fileInfo(),!0)},t.exports=i},{"./node":76}],86:[function(e,t,n){var r=e("./node"),i=function(e){if(!e)throw new Error("Value requires an array argument");Array.isArray(e)?this.value=e:this.value=[e]};(i.prototype=new r).type="Value",i.prototype.accept=function(e){this.value&&(this.value=e.visitArray(this.value))},i.prototype.eval=function(e){return 1===this.value.length?this.value[0].eval(e):new i(this.value.map(function(t){return t.eval(e)}))},i.prototype.genCSS=function(e,t){var n;for(n=0;n<this.value.length;n++)this.value[n].genCSS(e,t),n+1<this.value.length&&t.add(e&&e.compress?",":", ")},t.exports=i},{"./node":76}],87:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./ruleset"),s=e("./detached-ruleset"),o=e("../less-error"),l=function(e,t,n){this.variable=e,this._index=t,this._fileInfo=n,this.allowRoot=!0};(l.prototype=new r).type="VariableCall",l.prototype.eval=function(e){var t,n=new i(this.variable,this.getIndex(),this.fileInfo()).eval(e),r=new o({message:"Could not evaluate variable call "+this.variable});if(!n.ruleset){if(n.rules)t=n;else if(Array.isArray(n))t=new a("",n);else{if(!Array.isArray(n.value))throw r;t=new a("",n.value)}n=new s(t)}if(n.ruleset)return n.callEval(e);throw r},t.exports=l},{"../less-error":38,"./detached-ruleset":61,"./node":76,"./ruleset":81,"./variable":88}],88:[function(e,t,n){var r=e("./node"),i=e("./call"),a=function(e,t,n){this.name=e,this._index=t,this._fileInfo=n};(a.prototype=new r).type="Variable",a.prototype.eval=function(e){var t,n=this.name;if(0===n.indexOf("@@")&&(n="@"+new a(n.slice(1),this.getIndex(),this.fileInfo()).eval(e).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+n,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var r=t.variable(n);if(r){if(r.important){var a=e.importantScope[e.importantScope.length-1];a.important=r.important}return e.inCalc?new i("_SELF",[r.value]).eval(e):r.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"variable "+n+" is undefined",filename:this.fileInfo().filename,index:this.getIndex()}},a.prototype.find=function(e,t){for(var n,r=0;r<e.length;r++)if(n=t.call(e,e[r]))return n;return null},t.exports=a},{"./call":54,"./node":76}],89:[function(e,t,n){var r=e("./constants"),i=e("clone"),a={getLocation:function(e,t){for(var n=e+1,r=null,i=-1;--n>=0&&"\n"!==t.charAt(n);)i++;return"number"==typeof e&&(r=(t.slice(0,e).match(/\n/g)||"").length),{line:r,column:i}},copyArray:function(e){var t,n=e.length,r=new Array(n);for(t=0;t<n;t++)r[t]=e[t];return r},clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},copyOptions:function(e,t){if(t&&t._defaults)return t;var n=a.defaults(e,t);if(n.strictMath&&(n.math=r.Math.STRICT_LEGACY),n.relativeUrls&&(n.rewriteUrls=r.RewriteUrls.ALL),"string"==typeof n.math)switch(n.math.toLowerCase()){case"always":n.math=r.Math.ALWAYS;break;case"parens-division":n.math=r.Math.PARENS_DIVISION;break;case"strict":case"parens":n.math=r.Math.PARENS;break;case"strict-legacy":n.math=r.Math.STRICT_LEGACY}if("string"==typeof n.rewriteUrls)switch(n.rewriteUrls.toLowerCase()){case"off":n.rewriteUrls=r.RewriteUrls.OFF;break;case"local":n.rewriteUrls=r.RewriteUrls.LOCAL;break;case"all":n.rewriteUrls=r.RewriteUrls.ALL}return n},defaults:function(e,t){var n=t||{};if(!t._defaults){n={};var r=i(e);n._defaults=r;var a=t?i(t):{};Object.assign(n,r,a)}return n},merge:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},flattenArray:function(e,t){t=t||[];for(var n=0,r=e.length;n<r;n++){var i=e[n];Array.isArray(i)?a.flattenArray(i,t):void 0!==i&&t.push(i)}return t}};t.exports=a},{"./constants":12,clone:100}],90:[function(e,t,n){var r=e("../tree"),i=e("./visitor"),a=e("../logger"),s=e("../utils"),o=function(){this._visitor=new i(this),this.contexts=[],this.allExtendsStack=[[]]};o.prototype={run:function(e){return(e=this._visitor.visit(e)).allExtends=this.allExtendsStack[0],e},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var n,i,a,o,l=[],u=e.rules,c=u?u.length:0;for(n=0;n<c;n++)e.rules[n]instanceof r.Extend&&(l.push(u[n]),e.extendOnEveryPath=!0);var d=e.paths;for(n=0;n<d.length;n++){var h=d[n],f=h[h.length-1],p=f.extendList;for((o=p?s.copyArray(p).concat(l):l)&&(o=o.map(function(e){return e.clone()})),i=0;i<o.length;i++)this.foundExtends=!0,(a=o[i]).findSelfSelectors(h),a.ruleset=e,0===i&&(a.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(a)}this.contexts.push(e.selectors)}},visitRulesetOut:function(e){e.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitMediaOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1},visitAtRule:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitAtRuleOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1}};var l=function(){this._visitor=new i(this)};l.prototype={run:function(e){var t=new o;if(this.extendIndices={},t.run(e),!t.foundExtends)return e;e.allExtends=e.allExtends.concat(this.doExtendChaining(e.allExtends,e.allExtends)),this.allExtendsStack=[e.allExtends];var n=this._visitor.visit(e);return this.checkExtendsForNonMatched(e.allExtends),n},checkExtendsForNonMatched:function(e){var t=this.extendIndices;e.filter(function(e){return!e.hasFoundMatches&&1==e.parent_ids.length}).forEach(function(e){var n="_unknown_";try{n=e.selector.toCSS({})}catch(e){}t[e.index+" "+n]||(t[e.index+" "+n]=!0,a.warn("extend '"+n+"' has no matches"))})},doExtendChaining:function(e,t,n){var i,a,s,o,l,u,c,d,h=[],f=this;for(n=n||0,i=0;i<e.length;i++)for(a=0;a<t.length;a++)u=e[i],c=t[a],u.parent_ids.indexOf(c.object_id)>=0||(l=[c.selfSelectors[0]],(s=f.findMatch(u,l)).length&&(u.hasFoundMatches=!0,u.selfSelectors.forEach(function(e){var t=c.visibilityInfo();o=f.extendSelector(s,l,e,u.isVisible()),(d=new r.Extend(c.selector,c.option,0,c.fileInfo(),t)).selfSelectors=o,o[o.length-1].extendList=[d],h.push(d),d.ruleset=c.ruleset,d.parent_ids=d.parent_ids.concat(c.parent_ids,u.parent_ids),c.firstExtendOnThisSelectorPath&&(d.firstExtendOnThisSelectorPath=!0,c.ruleset.paths.push(o))})));if(h.length){if(this.extendChainCount++,n>100){var p="{unable to calculate}",m="{unable to calculate}";try{p=h[0].selfSelectors[0].toCSS(),m=h[0].selector.toCSS()}catch(e){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+p+":extend("+m+")"}}return h.concat(f.doExtendChaining(h,t,n+1))}return h},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitSelector:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var n,r,i,a,s=this.allExtendsStack[this.allExtendsStack.length-1],o=[],l=this;for(i=0;i<s.length;i++)for(r=0;r<e.paths.length;r++)if(a=e.paths[r],!e.extendOnEveryPath){var u=a[a.length-1].extendList;u&&u.length||(n=this.findMatch(s[i],a)).length&&(s[i].hasFoundMatches=!0,s[i].selfSelectors.forEach(function(e){var t;t=l.extendSelector(n,a,e,s[i].isVisible()),o.push(t)}))}e.paths=e.paths.concat(o)}},findMatch:function(e,t){var n,r,i,a,s,o,l,u=e.selector.elements,c=[],d=[];for(n=0;n<t.length;n++)for(r=t[n],i=0;i<r.elements.length;i++)for(a=r.elements[i],(e.allowBefore||0===n&&0===i)&&c.push({pathIndex:n,index:i,matched:0,initialCombinator:a.combinator}),o=0;o<c.length;o++)l=c[o],""===(s=a.combinator.value)&&0===i&&(s=" "),!this.isElementValuesEqual(u[l.matched].value,a.value)||l.matched>0&&u[l.matched].combinator.value!==s?l=null:l.matched++,l&&(l.finished=l.matched===u.length,l.finished&&!e.allowAfter&&(i+1<r.elements.length||n+1<t.length)&&(l=null)),l?l.finished&&(l.length=u.length,l.endPathIndex=n,l.endPathElementIndex=i+1,c.length=0,d.push(l)):(c.splice(o,1),o--);return d},isElementValuesEqual:function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;if(e instanceof r.Attribute)return e.op===t.op&&e.key===t.key&&(e.value&&t.value?(e=e.value.value||e.value,t=t.value.value||t.value,e===t):!e.value&&!t.value);if(e=e.value,t=t.value,e instanceof r.Selector){if(!(t instanceof r.Selector)||e.elements.length!==t.elements.length)return!1;for(var n=0;n<e.elements.length;n++){if(e.elements[n].combinator.value!==t.elements[n].combinator.value&&(0!==n||(e.elements[n].combinator.value||" ")!==(t.elements[n].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(e.elements[n].value,t.elements[n].value))return!1}return!0}return!1},extendSelector:function(e,t,n,i){var a,s,o,l,u,c=0,d=0,h=[];for(a=0;a<e.length;a++)l=e[a],s=t[l.pathIndex],o=new r.Element(l.initialCombinator,n.elements[0].value,n.elements[0].isVariable,n.elements[0].getIndex(),n.elements[0].fileInfo()),l.pathIndex>c&&d>0&&(h[h.length-1].elements=h[h.length-1].elements.concat(t[c].elements.slice(d)),d=0,c++),u=s.elements.slice(d,l.index).concat([o]).concat(n.elements.slice(1)),c===l.pathIndex&&a>0?h[h.length-1].elements=h[h.length-1].elements.concat(u):(h=h.concat(t.slice(c,l.pathIndex))).push(new r.Selector(u)),c=l.endPathIndex,(d=l.endPathElementIndex)>=t[c].elements.length&&(d=0,c++);return c<t.length&&d>0&&(h[h.length-1].elements=h[h.length-1].elements.concat(t[c].elements.slice(d)),c++),h=(h=h.concat(t.slice(c,t.length))).map(function(e){var t=e.createDerived(e.elements);return i?t.ensureVisibility():t.ensureInvisibility(),t})},visitMedia:function(e,t){var n=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);n=n.concat(this.doExtendChaining(n,e.allExtends)),this.allExtendsStack.push(n)},visitMediaOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t},visitAtRule:function(e,t){var n=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);n=n.concat(this.doExtendChaining(n,e.allExtends)),this.allExtendsStack.push(n)},visitAtRuleOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t}},t.exports=l},{"../logger":39,"../tree":67,"../utils":89,"./visitor":97}],91:[function(e,t,n){function r(e){this.imports=[],this.variableImports=[],this._onSequencerEmpty=e,this._currentDepth=0}r.prototype.addImport=function(e){var t=this,n={callback:e,args:null,isReady:!1};return this.imports.push(n),function(){n.args=Array.prototype.slice.call(arguments,0),n.isReady=!0,t.tryRun()}},r.prototype.addVariableImport=function(e){this.variableImports.push(e)},r.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var e=this.imports[0];if(!e.isReady)return;this.imports=this.imports.slice(1),e.callback.apply(null,e.args)}if(0===this.variableImports.length)break;var t=this.variableImports[0];this.variableImports=this.variableImports.slice(1),t()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},t.exports=r},{}],92:[function(e,t,n){var r=e("../contexts"),i=e("./visitor"),a=e("./import-sequencer"),s=e("../utils"),o=function(e,t){this._visitor=new i(this),this._importer=e,this._finish=t,this.context=new r.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new a(this._onSequencerEmpty.bind(this))};o.prototype={isReplacing:!1,run:function(e){try{this._visitor.visit(e)}catch(e){this.error=e}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(e,t){var n=e.options.inline;if(!e.css||n){var i=new r.Eval(this.context,s.copyArray(this.context.frames)),a=i.frames[0];this.importCount++,e.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,e,i,a)):this.processImportNode(e,i,a)}t.visitDeeper=!1},processImportNode:function(e,t,n){var r,i=e.options.inline;try{r=e.evalForImport(t)}catch(t){t.filename||(t.index=e.getIndex(),t.filename=e.fileInfo().filename),e.css=!0,e.error=t}if(!r||r.css&&!i)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{r.options.multiple&&(t.importMultiple=!0);for(var a=void 0===r.css,s=0;s<n.rules.length;s++)if(n.rules[s]===e){n.rules[s]=r;break}var o=this.onImported.bind(this,r,t),l=this._sequencer.addImport(o);this._importer.push(r.getPath(),a,r.fileInfo(),r.options,l)}},onImported:function(e,t,n,r,i,a){n&&(n.filename||(n.index=e.getIndex(),n.filename=e.fileInfo().filename),this.error=n);var s=this,o=e.options.inline,l=e.options.isPlugin,u=e.options.optional,c=i||a in s.recursionDetector;if(t.importMultiple||(e.skip=!!c||function(){return a in s.onceFileDetectionMap||(s.onceFileDetectionMap[a]=!0,!1)}),!a&&u&&(e.skip=!0),r&&(e.root=r,e.importedFilename=a,!o&&!l&&(t.importMultiple||!c))){s.recursionDetector[a]=!0;var d=this.context;this.context=t;try{this._visitor.visit(r)}catch(n){this.error=n}this.context=d}s.importCount--,s.isFinished&&s._sequencer.tryRun()},visitDeclaration:function(e,t){"DetachedRuleset"===e.value.type?this.context.frames.unshift(e):t.visitDeeper=!1},visitDeclarationOut:function(e){"DetachedRuleset"===e.value.type&&this.context.frames.shift()},visitAtRule:function(e,t){this.context.frames.unshift(e)},visitAtRuleOut:function(e){this.context.frames.shift()},visitMixinDefinition:function(e,t){this.context.frames.unshift(e)},visitMixinDefinitionOut:function(e){this.context.frames.shift()},visitRuleset:function(e,t){this.context.frames.unshift(e)},visitRulesetOut:function(e){this.context.frames.shift()},visitMedia:function(e,t){this.context.frames.unshift(e.rules[0])},visitMediaOut:function(e){this.context.frames.shift()}},t.exports=o},{"../contexts":13,"../utils":89,"./import-sequencer":91,"./visitor":97}],93:[function(e,t,n){var r={Visitor:e("./visitor"),ImportVisitor:e("./import-visitor"),MarkVisibleSelectorsVisitor:e("./set-tree-visibility-visitor"),ExtendVisitor:e("./extend-visitor"),JoinSelectorVisitor:e("./join-selector-visitor"),ToCSSVisitor:e("./to-css-visitor")};t.exports=r},{"./extend-visitor":90,"./import-visitor":92,"./join-selector-visitor":94,"./set-tree-visibility-visitor":95,"./to-css-visitor":96,"./visitor":97}],94:[function(e,t,n){var r=e("./visitor"),i=function(){this.contexts=[[]],this._visitor=new r(this)};i.prototype={run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){var n,r=this.contexts[this.contexts.length-1],i=[];this.contexts.push(i),e.root||((n=e.selectors)&&(n=n.filter(function(e){return e.getIsOutput()}),e.selectors=n.length?n:n=null,n&&e.joinSelectors(i,r,n)),n||(e.rules=null),e.paths=i)},visitRulesetOut:function(e){this.contexts.length=this.contexts.length-1},visitMedia:function(e,t){var n=this.contexts[this.contexts.length-1];e.rules[0].root=0===n.length||n[0].multiMedia},visitAtRule:function(e,t){var n=this.contexts[this.contexts.length-1];e.rules&&e.rules.length&&(e.rules[0].root=e.isRooted||0===n.length||null)}},t.exports=i},{"./visitor":97}],95:[function(e,t,n){var r=function(e){this.visible=e};r.prototype.run=function(e){this.visit(e)},r.prototype.visitArray=function(e){if(!e)return e;var t,n=e.length;for(t=0;t<n;t++)this.visit(e[t]);return e},r.prototype.visit=function(e){return e?e.constructor===Array?this.visitArray(e):!e.blocksVisibility||e.blocksVisibility()?e:(this.visible?e.ensureVisibility():e.ensureInvisibility(),e.accept(this),e):e},t.exports=r},{}],96:[function(e,t,n){var r=e("../tree"),i=e("./visitor"),a=function(e){this._visitor=new i(this),this._context=e};a.prototype={containsSilentNonBlockedChild:function(e){var t;if(!e)return!1;for(var n=0;n<e.length;n++)if((t=e[n]).isSilent&&t.isSilent(this._context)&&!t.blocksVisibility())return!0;return!1},keepOnlyVisibleChilds:function(e){e&&e.rules&&(e.rules=e.rules.filter(function(e){return e.isVisible()}))},isEmpty:function(e){return!e||!e.rules||0===e.rules.length},hasVisibleSelector:function(e){return!(!e||!e.paths)&&e.paths.length>0},resolveVisibility:function(e,t){if(!e.blocksVisibility()){if(this.isEmpty(e)&&!this.containsSilentNonBlockedChild(t))return;return e}var n=e.rules[0];if(this.keepOnlyVisibleChilds(n),!this.isEmpty(n))return e.ensureVisibility(),e.removeVisibilityBlock(),e},isVisibleRuleset:function(e){return!!e.firstRoot||!this.isEmpty(e)&&!(!e.root&&!this.hasVisibleSelector(e))}};var s=function(e){this._visitor=new i(this),this._context=e,this.utils=new a(e)};s.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){if(!e.blocksVisibility()&&!e.variable)return e},visitMixinDefinition:function(e,t){e.frames=[]},visitExtend:function(e,t){},visitComment:function(e,t){if(!e.blocksVisibility()&&!e.isSilent(this._context))return e},visitMedia:function(e,t){var n=e.rules[0].rules;return e.accept(this._visitor),t.visitDeeper=!1,this.utils.resolveVisibility(e,n)},visitImport:function(e,t){if(!e.blocksVisibility())return e},visitAtRule:function(e,t){return e.rules&&e.rules.length?this.visitAtRuleWithBody(e,t):this.visitAtRuleWithoutBody(e,t)},visitAnonymous:function(e,t){if(!e.blocksVisibility())return e.accept(this._visitor),e},visitAtRuleWithBody:function(e,t){var n=function(e){var t=e.rules;return function(e){var t=e.rules;return 1===t.length&&(!t[0].paths||0===t[0].paths.length)}(e)?t[0].rules:t}(e);return e.accept(this._visitor),t.visitDeeper=!1,this.utils.isEmpty(e)||this._mergeRules(e.rules[0].rules),this.utils.resolveVisibility(e,n)},visitAtRuleWithoutBody:function(e,t){if(!e.blocksVisibility()){if("@charset"===e.name){if(this.charset){if(e.debugInfo){var n=new r.Comment("/* "+e.toCSS(this._context).replace(/\n/g,"")+" */\n");return n.debugInfo=e.debugInfo,this._visitor.visit(n)}return}this.charset=!0}return e}},checkValidNodes:function(e,t){if(e)for(var n=0;n<e.length;n++){var i=e[n];if(t&&i instanceof r.Declaration&&!i.variable)throw{message:"Properties must be inside selector blocks. They cannot be in the root",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename};if(i instanceof r.Call)throw{message:"Function '"+i.name+"' is undefined",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename};if(i.type&&!i.allowRoot)throw{message:i.type+" node returned by a function is not valid here",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename}}},visitRuleset:function(e,t){var n,r=[];if(this.checkValidNodes(e.rules,e.firstRoot),e.root)e.accept(this._visitor),t.visitDeeper=!1;else{this._compileRulesetPaths(e);for(var i=e.rules,a=i?i.length:0,s=0;s<a;)(n=i[s])&&n.rules?(r.push(this._visitor.visit(n)),i.splice(s,1),a--):s++;a>0?e.accept(this._visitor):e.rules=null,t.visitDeeper=!1}return e.rules&&(this._mergeRules(e.rules),this._removeDuplicateRules(e.rules)),this.utils.isVisibleRuleset(e)&&(e.ensureVisibility(),r.splice(0,0,e)),1===r.length?r[0]:r},_compileRulesetPaths:function(e){e.paths&&(e.paths=e.paths.filter(function(e){var t;for(" "===e[0].elements[0].combinator.value&&(e[0].elements[0].combinator=new r.Combinator("")),t=0;t<e.length;t++)if(e[t].isVisible()&&e[t].getIsOutput())return!0;return!1}))},_removeDuplicateRules:function(e){if(e){var t,n,i,a={};for(i=e.length-1;i>=0;i--)if((n=e[i])instanceof r.Declaration)if(a[n.name]){(t=a[n.name])instanceof r.Declaration&&(t=a[n.name]=[a[n.name].toCSS(this._context)]);var s=n.toCSS(this._context);-1!==t.indexOf(s)?e.splice(i,1):t.push(s)}else a[n.name]=n}},_mergeRules:function(e){if(e){for(var t={},n=[],i=0;i<e.length;i++){var a=e[i];if(a.merge){var s=a.name;t[s]?e.splice(i--,1):n.push(t[s]=[]),t[s].push(a)}}n.forEach(function(e){if(e.length>0){var t=e[0],n=[],i=[new r.Expression(n)];e.forEach(function(e){"+"===e.merge&&n.length>0&&i.push(new r.Expression(n=[])),n.push(e.value),t.important=t.important||e.important}),t.value=new r.Value(i)}})}}},t.exports=s},{"../tree":67,"./visitor":97}],97:[function(e,t,n){var r=e("../tree"),i={visitDeeper:!0},a=!1;function s(e){return e}var o=function(e){this._implementation=e,this._visitInCache={},this._visitOutCache={},a||(function e(t,n){var r,i;for(r in t)switch(typeof(i=t[r])){case"function":i.prototype&&i.prototype.type&&(i.prototype.typeIndex=n++);break;case"object":n=e(i,n)}return n}(r,1),a=!0)};o.prototype={visit:function(e){if(!e)return e;var t=e.typeIndex;if(!t)return e.value&&e.value.typeIndex&&this.visit(e.value),e;var n,r=this._implementation,a=this._visitInCache[t],o=this._visitOutCache[t],l=i;if(l.visitDeeper=!0,a||(n="visit"+e.type,a=r[n]||s,o=r[n+"Out"]||s,this._visitInCache[t]=a,this._visitOutCache[t]=o),a!==s){var u=a.call(r,e,l);e&&r.isReplacing&&(e=u)}return l.visitDeeper&&e&&e.accept&&e.accept(this),o!=s&&o.call(r,e),e},visitArray:function(e,t){if(!e)return e;var n,r=e.length;if(t||!this._implementation.isReplacing){for(n=0;n<r;n++)this.visit(e[n]);return e}var i=[];for(n=0;n<r;n++){var a=this.visit(e[n]);void 0!==a&&(a.splice?a.length&&this.flatten(a,i):i.push(a))}return i},flatten:function(e,t){var n,r,i,a,s,o;for(t||(t=[]),r=0,n=e.length;r<n;r++)if(void 0!==(i=e[r]))if(i.splice)for(s=0,a=i.length;s<a;s++)void 0!==(o=i[s])&&(o.splice?o.length&&this.flatten(o,t):t.push(o));else t.push(i);return t}},t.exports=o},{"../tree":67}],98:[function(e,t,n){"use strict";var r=e("./raw"),i=[],a=[],s=r.makeRequestCallFromTimer(function(){if(a.length)throw a.shift()});function o(e){var t;(t=i.length?i.pop():new l).task=e,r(t)}function l(){this.task=null}t.exports=o,l.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(a.push(e),s())}finally{this.task=null,i[i.length]=this}}},{"./raw":99}],99:[function(e,n,r){(function(e){"use strict";function t(e){i.length||r(),i[i.length]=e}n.exports=t;var r,i=[],a=0,s=1024;function o(){for(;a<i.length;){var e=a;if(a+=1,i[e].call(),a>s){for(var t=0,n=i.length-a;t<n;t++)i[t]=i[t+a];i.length-=a,a=0}}i.length=0,a=0}var l,u,c,d=void 0!==e?e:self,h=d.MutationObserver||d.WebKitMutationObserver;function f(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof h?(l=1,u=new h(o),c=document.createTextNode(""),u.observe(c,{characterData:!0}),r=function(){l=-l,c.data=l}):r=f(o),t.requestFlush=r,t.makeRequestCallFromTimer=f}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],100:[function(e,t,r){var i=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,r,i;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{i=Promise}catch(e){i=function(){}}function a(s,l,u,c,d){"object"==typeof l&&(u=l.depth,c=l.prototype,d=l.includeNonEnumerable,l=l.circular);var h=[],f=[],p=void 0!==n;return void 0===l&&(l=!0),void 0===u&&(u=1/0),function s(u,m){if(null===u)return null;if(0===m)return u;var v,g;if("object"!=typeof u)return u;if(e(u,t))v=new t;else if(e(u,r))v=new r;else if(e(u,i))v=new i(function(e,t){u.then(function(t){e(s(t,m-1))},function(e){t(s(e,m-1))})});else if(a.__isArray(u))v=[];else if(a.__isRegExp(u))v=new RegExp(u.source,o(u)),u.lastIndex&&(v.lastIndex=u.lastIndex);else if(a.__isDate(u))v=new Date(u.getTime());else{if(p&&n.isBuffer(u))return v=n.allocUnsafe?n.allocUnsafe(u.length):new n(u.length),u.copy(v),v;e(u,Error)?v=Object.create(u):void 0===c?(g=Object.getPrototypeOf(u),v=Object.create(g)):(v=Object.create(c),g=c)}if(l){var y=h.indexOf(u);if(-1!=y)return f[y];h.push(u),f.push(v)}for(var _ in e(u,t)&&u.forEach(function(e,t){var n=s(t,m-1),r=s(e,m-1);v.set(n,r)}),e(u,r)&&u.forEach(function(e){var t=s(e,m-1);v.add(t)}),u){var w;g&&(w=Object.getOwnPropertyDescriptor(g,_)),w&&null==w.set||(v[_]=s(u[_],m-1))}if(Object.getOwnPropertySymbols)for(var E=Object.getOwnPropertySymbols(u),_=0;_<E.length;_++){var b=E[_],S=Object.getOwnPropertyDescriptor(u,b);(!S||S.enumerable||d)&&(v[b]=s(u[b],m-1),S.enumerable||Object.defineProperty(v,b,{enumerable:!1}))}if(d)for(var T=Object.getOwnPropertyNames(u),_=0;_<T.length;_++){var k=T[_],S=Object.getOwnPropertyDescriptor(u,k);S&&S.enumerable||(v[k]=s(u[k],m-1),Object.defineProperty(v,k,{enumerable:!1}))}return v}(s,u)}function s(e){return Object.prototype.toString.call(e)}function o(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=s,a.__isDate=function(e){return"object"==typeof e&&"[object Date]"===s(e)},a.__isArray=function(e){return"object"==typeof e&&"[object Array]"===s(e)},a.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===s(e)},a.__getRegExpFlags=o,a}();"object"==typeof t&&t.exports&&(t.exports=i)},{}],101:[function(e,t,n){"use strict";var r=e("asap/raw");function i(){}var a=null,s={};function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._40=0,this._65=0,this._55=null,this._72=null,e!==i&&f(e,this)}function l(e,t){for(;3===e._65;)e=e._55;if(o._37&&o._37(e),0===e._65)return 0===e._40?(e._40=1,void(e._72=t)):1===e._40?(e._40=2,void(e._72=[e._72,t])):void e._72.push(t);!function(e,t){r(function(){var n=1===e._65?t.onFulfilled:t.onRejected;if(null!==n){var r=function(e,t){try{return e(t)}catch(e){return a=e,s}}(n,e._55);r===s?c(t.promise,a):u(t.promise,r)}else 1===e._65?u(t.promise,e._55):c(t.promise,e._55)})}(e,t)}function u(e,t){if(t===e)return c(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=function(e){try{return e.then}catch(e){return a=e,s}}(t);if(n===s)return c(e,a);if(n===e.then&&t instanceof o)return e._65=3,e._55=t,void d(e);if("function"==typeof n)return void f(n.bind(t),e)}e._65=1,e._55=t,d(e)}function c(e,t){e._65=2,e._55=t,o._87&&o._87(e,t),d(e)}function d(e){if(1===e._40&&(l(e,e._72),e._72=null),2===e._40){for(var t=0;t<e._72.length;t++)l(e,e._72[t]);e._72=null}}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1,r=function(e,t,n){try{e(t,n)}catch(e){return a=e,s}}(e,function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,c(t,e))});n||r!==s||(n=!0,c(t,a))}t.exports=o,o._37=null,o._87=null,o._61=i,o.prototype.then=function(e,t){if(this.constructor!==o)return function(e,t,n){return new e.constructor(function(r,a){var s=new o(i);s.then(r,a),l(e,new h(t,n,s))})}(this,e,t);var n=new o(i);return l(this,new h(e,t,n)),n}},{"asap/raw":99}],102:[function(e,t,n){"use strict";var r=e("./core.js");t.exports=r;var i=c(!0),a=c(!1),s=c(null),o=c(void 0),l=c(0),u=c("");function c(e){var t=new r(r._61);return t._65=1,t._55=e,t}r.resolve=function(e){if(e instanceof r)return e;if(null===e)return s;if(void 0===e)return o;if(!0===e)return i;if(!1===e)return a;if(0===e)return l;if(""===e)return u;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new r(t.bind(e))}catch(e){return new r(function(t,n){n(e)})}return c(e)},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);var i=t.length;function a(s,o){if(o&&("object"==typeof o||"function"==typeof o)){if(o instanceof r&&o.then===r.prototype.then){for(;3===o._65;)o=o._55;return 1===o._65?a(s,o._55):(2===o._65&&n(o._55),void o.then(function(e){a(s,e)},n))}var l=o.then;if("function"==typeof l){var u=new r(l.bind(o));return void u.then(function(e){a(s,e)},n)}}t[s]=o,0==--i&&e(t)}for(var s=0;s<t.length;s++)a(s,t[s])})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){e.forEach(function(e){r.resolve(e).then(t,n)})})},r.prototype.catch=function(e){return this.then(null,e)}},{"./core.js":101}],103:[function(e,t,n){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(e,t){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(e){setTimeout(function(){throw e},0)})})},{}],104:[function(e,t,n){e("asap"),"undefined"==typeof Promise&&(Promise=e("./lib/core.js"),e("./lib/es6-extensions.js")),e("./polyfill-done.js")},{"./lib/core.js":101,"./lib/es6-extensions.js":102,"./polyfill-done.js":103,asap:98}]},{},[2])(2)}).call(this,n(4),n(16).Buffer)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(17),i=n(18),a=n(19);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=o(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?o(e,0):h(e,t);if("Buffer"===t.type&&a(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=o(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var a,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(a=n;a<o;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){for(var d=!0,h=0;h<l;h++)if(u(e,a+h)!==u(t,h)){d=!1;break}if(d)return a}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[n+s]=o}return s}function _(e,t,n,r){return G(V(t,e.length-n),e,n,r)}function w(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return w(e,t,n,r)}function b(e,t,n,r){return G(H(t),e,n,r)}function S(e,t,n,r){return G(function(e,t){for(var n,r,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,s,o,l,u=e[i],c=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[i+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[i+1],s=e[i+2],128==(192&a)&&128==(192&s)&&(l=(15&u)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[i+1],s=e[i+2],o=e[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),o=Math.min(a,s),u=this.slice(r,i),c=e.slice(t,n),d=0;d<o;++d)if(u[d]!==c[d]){a=u[d],s=c[d];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function L(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function R(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function P(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,a){return a||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,a){return a||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<n&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=l.isBuffer(e)?e:V(new l(e,r).toString()),o=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(4))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=u(e),r=n[0],s=n[1],o=new a(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),l=0,c=s>0?r-4:r,d=0;d<c;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],o[l++]=t>>16&255,o[l++]=t>>8&255,o[l++]=255&t;2===s&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,o[l++]=255&t);1===s&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,o[l++]=t>>8&255,o[l++]=255&t);return o},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=0,o=n-i;s<o;s+=16383)a.push(c(e,s,s+16383>o?o:s+16383));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+d],d+=h,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=r;c>0;s=256*s+e[t+d],d+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=u}return(f?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var s,o,l,u=8*a-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&o,f+=p,o/=256,i-=8);for(s=s<<i|o,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};var i=window.shaka;window.goog=window.goog||{};var a,s=window.goog;(i.log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"alwaysError",value:function(){}},{key:"alwaysWarn",value:function(){}},{key:"error",value:function(){}},{key:"warning",value:function(){}},{key:"info",value:function(){}},{key:"debug",value:function(){}},{key:"v1",value:function(){}},{key:"v2",value:function(){}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}(),i.log.Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,V1:5,V2:6},i.log.MAX_LOG_LEVEL=3,window.console)&&(i.log.logMap_=(n(a={},i.log.Level.ERROR,function(){var e;return(e=console).error.apply(e,arguments)}),n(a,i.log.Level.WARNING,function(){var e;return(e=console).warn.apply(e,arguments)}),n(a,i.log.Level.INFO,function(){var e;return(e=console).info.apply(e,arguments)}),n(a,i.log.Level.DEBUG,function(){var e;return(e=console).log.apply(e,arguments)}),n(a,i.log.Level.V1,function(){var e;return(e=console).debug.apply(e,arguments)}),n(a,i.log.Level.V2,function(){var e;return(e=console).debug.apply(e,arguments)}),a),i.log.alwaysWarn=i.log.logMap_[i.log.Level.WARNING],i.log.alwaysError=i.log.logMap_[i.log.Level.ERROR],s.DEBUG?(i.log.currentLevel,i.log.setLevel=function(e){var t=function(t){return t<=e?(window.asserts.assert(i.log.logMap_[t],"Unexpected log level"),i.log.logMap_[t]):function(){}};i.log.currentLevel=e,i.log.error=t(i.log.Level.ERROR),i.log.warning=t(i.log.Level.WARNING),i.log.info=t(i.log.Level.INFO),i.log.debug=t(i.log.Level.DEBUG),i.log.v1=t(i.log.Level.V1),i.log.v2=t(i.log.Level.V2)},i.log.setLevel(i.log.MAX_LOG_LEVEL)):(i.log.MAX_LOG_LEVEL>=i.log.Level.ERROR&&(i.log.error=i.log.logMap_[i.log.Level.ERROR]),i.log.MAX_LOG_LEVEL>=i.log.Level.WARNING&&(i.log.warning=i.log.logMap_[i.log.Level.WARNING]),i.log.MAX_LOG_LEVEL>=i.log.Level.INFO&&(i.log.info=i.log.logMap_[i.log.Level.INFO]),i.log.MAX_LOG_LEVEL>=i.log.Level.DEBUG&&(i.log.debug=i.log.logMap_[i.log.Level.DEBUG]),i.log.MAX_LOG_LEVEL>=i.log.Level.V1&&(i.log.v1=i.log.logMap_[i.log.Level.V1]),i.log.MAX_LOG_LEVEL>=i.log.Level.V2&&(i.log.v2=i.log.logMap_[i.log.Level.V2])))},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=(n(7),n(8),n(9),n(10),n(3)),s=n.n(a),o=(n(11),n(12),n(14),n(15),{UNKNOWN:"Unknown",CUSTOM:"Custom",SHAKA:"Shaka",AXINOM:"Axinom",UNIFIED_STREAMING:"Unified Streaming",DASH_IF:"DASH-IF",WOWZA:"Wowza",BITCODIN:"Bitcodin",NIMBLE_STREAMER:"Nimble Streamer",AZURE_MEDIA_SERVICES:"Azure Media Services",GPAC:"GPAC",UPLYNK:"Verizon Digital Media Services"}),l={CLEAR_KEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps.1_0",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha",CLEAR:"no drm protection"},u={MULTIKEY:"multiple keys",MULTIPERIOD:"multiple Periods",ENCRYPTED_WITH_CLEAR:"mixing encrypted and unencrypted periods",AESCTR_16_BYTE_IV:"encrypted with AES CTR Mode using a 16 byte IV",AESCTR_8_BYTE_IV:"encrypted with AES CTR Mode using a 8 byte IV",TRICK_MODE:"Special trick mode track",XLINK:"XLink",SUBTITLES:"Subtitles",CAPTIONS:"Captions",EMBEDDED_TEXT:"embedded text",MULTIPLE_LANGUAGES:"multiple languages",AUDIO_ONLY:"audio only",OFFLINE:"Downloadable",STORED:"Downloaded",LIVE:"Live",WEBM:"WebM",MP4:"MP4",MP2TS:"MPEG-2 TS",TTML:"TTML",WEBVTT:"WebVTT",HIGH_DEFINITION:"High definition",ULTRA_HIGH_DEFINITION:"Ultra-high definition",SURROUND:"Surround sound",DASH:"DASH",HLS:"HLS"};function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var h=window.shaka,f=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"defaultEquals",value:function(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}},{key:"remove",value:function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},{key:"count",value:function(e,t){var n=0,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){n+=t(s.value)?1:0}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"hasSameElements",value:function(e,t,n){if(n||(n=h.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;var r=t.slice(),i=!0,a=!1,s=void 0;try{for(var o,l=function(){var e=o.value,t=r.findIndex(function(t){return n(e,t)});if(-1==t)return{v:!1};r[t]=r[r.length-1],r.pop()},u=e[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var d=l();if("object"===c(d))return d.v}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return 0==r.length}}],(n=null)&&d(t.prototype,n),r&&d(t,r),e}());
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operations_=[]}var t,n,r;return t=e,(n=[{key:"manage",value:function(e){var t=this;this.operations_.push(e.finally(function(){f.remove(t.operations_,e)}))}},{key:"destroy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.operations_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;s.promise.catch(function(){}),e.push(s.abort())}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return this.operations_=[],Promise.all(e)}}])&&p(t.prototype,n),r&&p(t,r),e}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"cloneObject",value:function(e){var t=new Set;return function e(n){switch(v(n)){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;case"object":default:if(!n)return n;if(n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var r=n.constructor==Array;if(n.constructor!=Object&&!r)return null;t.add(n);var i=r?[]:{};for(var a in n)i[a]=e(n[a]);return r&&(i.length=n.length),i}}(e)}}],(n=null)&&g(t.prototype,n),r&&g(t,r),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n)Object.defineProperty(this,r,{value:n[r],writable:!0,enumerable:!0});this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1}var t,n,r;return t=e,(n=[{key:"preventDefault",value:function(){this.cancelable&&(this.defaultPrevented=!0)}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}])&&_(t.prototype,n),r&&_(t,r),e}();function E(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map_={}}var t,n,r;return t=e,(n=[{key:"push",value:function(e,t){this.map_.hasOwnProperty(e)?this.map_[e].push(t):this.map_[e]=[t]}},{key:"get",value:function(e){var t=this.map_[e];return t?t.slice():null}},{key:"getAll",value:function(){var e=[];for(var t in this.map_)e.push.apply(e,E(this.map_[t]));return e}},{key:"remove",value:function(e,t){var n=this.map_[e];if(n)for(var r=0;r<n.length;++r)n[r]===t&&(n.splice(r,1),--r)}},{key:"clear",value:function(){this.map_={}}},{key:"forEach",value:function(e){for(var t in this.map_)e(t,this.map_[t])}}])&&b(t.prototype,n),r&&b(t,r),e}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};var k=window.shaka;k.util;window.goog=window.goog||{};window.goog;var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners_=new S,this.dispatchTarget=this}var t,n,r;return t=e,(n=[{key:"addEventListener",value:function(e,t,n){this.listeners_.push(e,t)}},{key:"removeEventListener",value:function(e,t,n){this.listeners_.remove(e,t)}},{key:"dispatchEvent",value:function(e){window.asserts.assert(e instanceof w,"FakeEventTarget can only dispatch FakeEvents!");var t=this.listeners_.get(e.type)||[],n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;try{o.handleEvent?o.handleEvent(e):o.call(this,e)}catch(e){k.log.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.stopped)break}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e.defaultPrevented}}])&&T(t.prototype,n),r&&T(t,r),e}();function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var A=function(){function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Promise(function(e,r){t=e,n=r});return r.resolve=t,r.reject=n,r}var t,n,r;return t=e,(n=[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}])&&I(t.prototype,n),r&&I(t,r),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka;var x=window.goog,N=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"severity",{RECOVERABLE:1,CRITICAL:2}),R(this,"category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9}),R(this,"code",{UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013});for(var i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];if(this.data=a,this.handled=!1,x.DEBUG){var o="UNKNOWN",l="UNKNOWN";for(var u in e.Category)e.Category[u]==this.category&&(o=u);for(var c in e.Code)e.Code[c]==this.code&&(l=c);if(this.message="Shaka Error "+o+"."+l+" ("+this.data.toString()+")",e.createStack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}}}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Error "+JSON.stringify(this,null,"  ")}}])&&L(t.prototype,n),r&&L(t,r),e}();x.DEBUG&&(N.createStack=!0);var M=N;function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var O=new M,D=(window.shaka,function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.promise=t,this.onAbort_=n,this.aborted_=!1}var t,n,r;return t=e,r=[{key:"failed",value:function(t){return new e(Promise.reject(t),function(){return Promise.resolve()})}},{key:"aborted",value:function(){var t=Promise.reject(new M(O.severity.CRITICAL,O.category.PLAYER,O.code.OPERATION_ABORTED));return t.catch(function(){}),new e(t,function(){return Promise.resolve()})}},{key:"completed",value:function(t){return new e(Promise.resolve(t),function(){return Promise.resolve()})}},{key:"notAbortable",value:function(t){return new e(t,function(){return t.catch(function(){})})}},{key:"all",value:function(t){return new e(Promise.all(t.map(function(e){return e.promise})),function(){return Promise.all(t.map(function(e){return e.abort()}))})}},{key:"wrapChainCallback_",value:function(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then(function(){}).catch(function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}}],(n=[{key:"abort",value:function(){return this.aborted_=!0,this.onAbort_()}},{key:"finally",value:function(e){return this.promise.then(function(t){return e(!0)},function(t){return e(!1)}),this}},{key:"chain",value:function(t,n){var r=this,i=new A,a=function(){return i.reject(new M(O.severity.CRITICAL,O.category.PLAYER,O.code.OPERATION_ABORTED)),r.abort()};return this.promise.then(function(n){r.aborted_?i.reject(new M(O.severity.CRITICAL,O.category.PLAYER,O.code.OPERATION_ABORTED)):t?a=e.wrapChainCallback_(t,n,i):i.resolve(n)},function(t){n?a=e.wrapChainCallback_(n,t,i):i.reject(t)}),new e(i,function(){return a()})}}])&&P(t.prototype,n),r&&P(t,r),e}());D.prototype.promise={};var U=D;function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onTick_=t,this.cancelPending_=null}var t,n,r;return t=e,(n=[{key:"tickAfter",value:function(e){var t=this;this.stop();var n=!0,r=null;this.cancelPending_=function(){window.clearTimeout(r),n=!1};return r=window.setTimeout(function(){n&&t.onTick_()},1e3*e),this}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}])&&F(t.prototype,n),r&&F(t,r),e}();function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onTick_=t,this.ticker_=null}var t,n,r;return t=e,(n=[{key:"tickNow",value:function(){return this.stop(),this.onTick_(),this}},{key:"tickAfter",value:function(e){var t=this;return this.stop(),this.ticker_=new B(function(){t.onTick_()}).tickAfter(e),this}},{key:"tickEvery",value:function(e){var t=this;return this.stop(),this.ticker_=new B(function(){t.ticker_.tickAfter(e),t.onTick_()}).tickAfter(e),this}},{key:"stop",value:function(){this.ticker_&&(this.ticker_.stop(),this.ticker_=null)}}])&&V(t.prototype,n),r&&V(t,r),e}();function G(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var K=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=e.defaultRetryParameters();this.maxAttempts_=null==t.maxAttempts?r.maxAttempts:t.maxAttempts,window.asserts.assert(this.maxAttempts_>=1,"maxAttempts should be >= 1"),this.baseDelay_=null==t.baseDelay?r.baseDelay:t.baseDelay,window.asserts.assert(this.baseDelay_>=0,"baseDelay should be >= 0"),this.fuzzFactor_=null==t.fuzzFactor?r.fuzzFactor:t.fuzzFactor,window.asserts.assert(this.fuzzFactor_>=0,"fuzzFactor should be >= 0"),this.backoffFactor_=null==t.backoffFactor?r.backoffFactor:t.backoffFactor,window.asserts.assert(this.backoffFactor_>=0,"backoffFactor should be >= 0"),this.numAttempts_=0,this.nextUnfuzzedDelay_=this.baseDelay_,this.autoReset_=n,this.autoReset_&&(window.asserts.assert(this.maxAttempts_>=2,"maxAttempts must be >= 2 for autoReset == true"),this.numAttempts_=1)}var t,n,r;return t=e,n=[{key:"attempt",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.numAttempts_>=this.maxAttempts_)){t.next=6;break}if(!this.autoReset_){t.next=5;break}this.reset_(),t.next=6;break;case 5:throw new Error(Error.Severity.CRITICAL,Error.Category.PLAYER,Error.Code.ATTEMPTS_EXHAUSTED);case 6:if(n=this.numAttempts_,this.numAttempts_++,0!=n){t.next=11;break}return window.asserts.assert(!this.autoReset_,"Failed to delay with auto-reset!"),t.abrupt("return");case 11:return r=e.fuzz_(this.nextUnfuzzedDelay_,this.fuzzFactor_),t.next=14,new Promise(function(t){e.defer(r,t)});case 14:this.nextUnfuzzedDelay_*=this.backoffFactor_;case 15:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){G(a,r,i,s,o,"next",e)}function o(e){G(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()},{key:"reset_",value:function(){window.asserts.assert(this.autoReset_,"Should only be used for auto-reset!"),this.numAttempts_=1,this.nextUnfuzzedDelay_=this.baseDelay_}}],r=[{key:"defaultRetryParameters",value:function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}},{key:"fuzz_",value:function(e,t){return e*(1+(2*Math.random()-1)*t)}},{key:"defer",value:function(e,t){new H(t).tickAfter(e/1e3)}}],n&&j(t.prototype,n),r&&j(t,r),e}(),W=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),q={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7},z=function(e){return e.match(W)},Y=Y||{};Y.global=window,Y.isDef=function(e){return void 0!==e},Y.exportPath_=function(e,t,n){var r,i=e.split("."),a=n||Y.global;i[0]in a||!a.execScript||a.execScript("var "+i[0]);for(;i.length&&(r=i.shift());)!i.length&&Y.isDef(t)?a[r]=t:a=a[r]?a[r]:a[r]={}},Y.define=function(e,t){var n=t;Y.exportPath_(e,n)},Y.DEBUG=!0,Y.define("goog.LOCALE","en"),Y.define("goog.TRUSTED_SITE",!0),Y.define("goog.STRICT_MODE_COMPATIBLE",!1),Y.provide=function(e){if(Y.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete Y.implicitNamespaces_[e];for(var t=e;(t=t.substring(0,t.lastIndexOf(".")))&&!Y.getObjectByName(t);)Y.implicitNamespaces_[t]=!0;Y.exportPath_(e)},Y.forwardDeclare=function(e){},Y.isProvided_=function(e){return!Y.implicitNamespaces_[e]&&Y.isDefAndNotNull(Y.getObjectByName(e))},Y.implicitNamespaces_={},Y.getObjectByName=function(e,t){for(var n,r=e.split("."),i=t||Y.global;n=r.shift();){if(!Y.isDefAndNotNull(i[n]))return null;i=i[n]}return i},Y.globalize=function(e,t){for(var n in t=t||Y.global,e)t[n]=e[n]},Y.addDependency=function(e,t,n){if(Y.DEPENDENCIES_ENABLED){for(var r,i,a=e.replace(/\\/g,"/"),s=Y.dependencies_,o=0;r=t[o];o++)s.nameToPath[r]=a;for(var l=0;i=n[l];l++)a in s.requires||(s.requires[a]={}),s.requires[a][i]=!0}},Y.define("goog.ENABLE_DEBUG_LOADER",!0),Y.logToConsole_=function(e){Y.global.console&&Y.global.console.error(e)},Y.require=function(e){if(Y.isProvided_(e))return null;if(Y.ENABLE_DEBUG_LOADER){var t=Y.getPathFromDeps_(e);if(t)return Y.included_[t]=!0,Y.writeScripts_(),null}var n="goog.require could not find: "+e;throw Y.logToConsole_(n),Error(n)},Y.basePath="",Y.global.CLOSURE_BASE_PATH,Y.global.CLOSURE_NO_DEPS=!0,Y.global.CLOSURE_IMPORT_SCRIPT,Y.DEPENDENCIES_ENABLED=Y.ENABLE_DEBUG_LOADER,Y.DEPENDENCIES_ENABLED&&(Y.included_={},Y.dependencies_={nameToPath:{},requires:{},visited:{},written:{}},Y.inHtmlDocument_=function(){var e=Y.global.document;return void 0!==e&&"write"in e},Y.findBasePath_=function(){if(Y.global.CLOSURE_BASE_PATH)Y.basePath=Y.global.CLOSURE_BASE_PATH;else if(Y.inHtmlDocument_())for(var e=Y.global.document.getElementsByTagName("script"),t=e.length-1;t>=0;--t){var n=e[t].src,r=n.lastIndexOf("?"),i=-1==r?n.length:r;if("base.js"==n.substr(i-7,7))return void(Y.basePath=n.substr(0,i-7))}},Y.importScript_=function(e,t){(Y.global.CLOSURE_IMPORT_SCRIPT||Y.writeScriptTag_)(e,t)&&(Y.dependencies_.written[e]=!0)},Y.writeScriptTag_=function(e,t){if(Y.inHtmlDocument_()){var n=Y.global.document;if("complete"==n.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}return void 0===t?n.write('<script type="text/javascript" src="'+e+'"><\/script>'):n.write('<script type="text/javascript">'+t+"<\/script>"),!0}return!1},Y.writeScripts_=function(){var e=[],t={},n=Y.dependencies_;function r(i){if(!(i in n.written))if(i in n.visited)i in t||(t[i]=!0,e.push(i));else{if(n.visited[i]=!0,i in n.requires)for(var a in n.requires[i])if(!Y.isProvided_(a)){if(!(a in n.nameToPath))throw Error("Undefined nameToPath for "+a);r(n.nameToPath[a])}i in t||(t[i]=!0,e.push(i))}}for(var i in Y.included_)n.written[i]||r(i);for(var a=0;a<e.length;a++){i=e[a];Y.dependencies_.written[i]=!0}for(a=0;a<e.length;a++){(i=e[a])&&Y.importScript_(Y.basePath+i)}},Y.getPathFromDeps_=function(e){return e in Y.dependencies_.nameToPath?Y.dependencies_.nameToPath[e]:null},Y.findBasePath_(),Y.global.CLOSURE_NO_DEPS||Y.importScript_(Y.basePath+"deps.js")),Y.isDefAndNotNull=function(e){return null!=e},Y.isString=function(e){return"string"==typeof e},Y.exportSymbol=function(e,t,n){Y.exportPath_(e,t,n)},Y.exportProperty=function(e,t,n){e[t]=n},Y.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.base=function(e,n,r){var i=Array.prototype.slice.call(arguments,2);return t.prototype[n].apply(e,i)}},Y.global.COMPILED=!1;var X=Y;function $(e){var t;e instanceof $?(this.setScheme(e.getScheme()),this.setUserInfo(e.getUserInfo()),this.setDomain(e.getDomain()),this.setPort(e.getPort()),this.setPath(e.getPath()),this.setQueryData(e.getQueryData().clone()),this.setFragment(e.getFragment())):e&&(t=z(String(e)))?(this.setScheme(t[q.SCHEME]||"",!0),this.setUserInfo(t[q.USER_INFO]||"",!0),this.setDomain(t[q.DOMAIN]||"",!0),this.setPort(t[q.PORT]),this.setPath(t[q.PATH]||"",!0),this.setQueryData(t[q.QUERY_DATA]||"",!0),this.setFragment(t[q.FRAGMENT]||"",!0)):this.queryData_=new $.QueryData(null,null)}function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t,n){return t&&J(e.prototype,t),n&&J(e,n),e}function te(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$.prototype.scheme_="",$.prototype.userInfo_="",$.prototype.domain_="",$.prototype.port_=null,$.prototype.path_="",$.prototype.queryData_,$.prototype.fragment_="",$.prototype.toString=function(){var e=[],t=this.getScheme();t&&e.push($.encodeSpecialChars_(t,$.reDisallowedInSchemeOrUserInfo_,!0),":");var n=this.getDomain();if(n){e.push("//");var r=this.getUserInfo();r&&e.push($.encodeSpecialChars_(r,$.reDisallowedInSchemeOrUserInfo_,!0),"@"),e.push($.removeDoubleEncoding_(encodeURIComponent(n)));var i=this.getPort();null!=i&&e.push(":",String(i))}var a=this.getPath();a&&(this.hasDomain()&&"/"!=a.charAt(0)&&e.push("/"),e.push($.encodeSpecialChars_(a,"/"==a.charAt(0)?$.reDisallowedInAbsolutePath_:$.reDisallowedInRelativePath_,!0)));var s=this.getEncodedQuery();s&&e.push("?",s);var o=this.getFragment();return o&&e.push("#",$.encodeSpecialChars_(o,$.reDisallowedInFragment_)),e.join("")},$.prototype.resolve=function(e){var t=this.clone();"data"===t.scheme_&&(t=new $);var n=e.hasScheme();n?t.setScheme(e.getScheme()):n=e.hasUserInfo(),n?t.setUserInfo(e.getUserInfo()):n=e.hasDomain(),n?t.setDomain(e.getDomain()):n=e.hasPort();var r=e.getPath();if(n)t.setPort(e.getPort());else if(n=e.hasPath()){if("/"!=r.charAt(0))if(this.hasDomain()&&!this.hasPath())r="/"+r;else{var i=t.getPath().lastIndexOf("/");-1!=i&&(r=t.getPath().substr(0,i+1)+r)}r=$.removeDotSegments(r)}return n?t.setPath(r):n=e.hasQuery(),n?t.setQueryData(e.getQueryData().clone()):n=e.hasFragment(),n&&t.setFragment(e.getFragment()),t},$.prototype.clone=function(){return new $(this)},$.prototype.getScheme=function(){return this.scheme_},$.prototype.setScheme=function(e,t){return this.scheme_=t?$.decodeOrEmpty_(e,!0):e,this.scheme_&&(this.scheme_=this.scheme_.replace(/:$/,"")),this},$.prototype.hasScheme=function(){return!!this.scheme_},$.prototype.getUserInfo=function(){return this.userInfo_},$.prototype.setUserInfo=function(e,t){return this.userInfo_=t?$.decodeOrEmpty_(e):e,this},$.prototype.hasUserInfo=function(){return!!this.userInfo_},$.prototype.getDomain=function(){return this.domain_},$.prototype.setDomain=function(e,t){return this.domain_=t?$.decodeOrEmpty_(e,!0):e,this},$.prototype.hasDomain=function(){return!!this.domain_},$.prototype.getPort=function(){return this.port_},$.prototype.setPort=function(e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);this.port_=e}else this.port_=null;return this},$.prototype.hasPort=function(){return null!=this.port_},$.prototype.getPath=function(){return this.path_},$.prototype.setPath=function(e,t){return this.path_=t?$.decodeOrEmpty_(e,!0):e,this},$.prototype.hasPath=function(){return!!this.path_},$.prototype.hasQuery=function(){return""!==this.queryData_.toString()},$.prototype.setQueryData=function(e,t){return e instanceof $.QueryData?this.queryData_=e:(t||(e=$.encodeSpecialChars_(e,$.reDisallowedInQuery_)),this.queryData_=new $.QueryData(e,null)),this},$.prototype.getEncodedQuery=function(){return this.queryData_.toString()},$.prototype.getDecodedQuery=function(){return this.queryData_.toDecodedString()},$.prototype.getQueryData=function(){return this.queryData_},$.prototype.getFragment=function(){return this.fragment_},$.prototype.setFragment=function(e,t){return this.fragment_=t?$.decodeOrEmpty_(e):e,this},$.prototype.hasFragment=function(){return!!this.fragment_},$.removeDotSegments=function(e){if(".."==e||"."==e)return"";if(-1==e.indexOf("./")&&-1==e.indexOf("/."))return e;for(var t=0==e.lastIndexOf("/",0),n=e.split("/"),r=[],i=0;i<n.length;){var a=n[i++];"."==a?t&&i==n.length&&r.push(""):".."==a?((r.length>1||1==r.length&&""!=r[0])&&r.pop(),t&&i==n.length&&r.push("")):(r.push(a),t=!0)}return r.join("/")},$.decodeOrEmpty_=function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""},$.encodeSpecialChars_=function(e,t,n){if(X.isString(e)){var r=encodeURI(e).replace(t,$.encodeChar_);return n&&(r=$.removeDoubleEncoding_(r)),r}return null},$.encodeChar_=function(e){var t=e.charCodeAt(0);return"%"+(t>>4&15).toString(16)+(15&t).toString(16)},$.removeDoubleEncoding_=function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")},$.reDisallowedInSchemeOrUserInfo_=/[#\/\?@]/g,$.reDisallowedInRelativePath_=/[\#\?:]/g,$.reDisallowedInAbsolutePath_=/[\#\?]/g,$.reDisallowedInQuery_=/[\#\?@]/g,$.reDisallowedInFragment_=/#/g,$.QueryData=function(e,t){this.encodedQuery_=e||null},$.QueryData.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_={},this.count_=0,this.encodedQuery_))for(var e=this.encodedQuery_.split("&"),t=0;t<e.length;t++){var n=e[t].indexOf("="),r=null,i=null;n>=0?(r=e[t].substring(0,n),i=e[t].substring(n+1)):r=e[t],r=decodeURIComponent(r.replace(/\+/g," ")),i=i||"",this.add(r,decodeURIComponent(i.replace(/\+/g," ")))}},$.QueryData.prototype.keyMap_=null,$.QueryData.prototype.count_=null,$.QueryData.prototype.getCount=function(){return this.ensureKeyMapInitialized_(),this.count_},$.QueryData.prototype.add=function(e,t){this.ensureKeyMapInitialized_(),this.encodedQuery_=null;var n=this.keyMap_.hasOwnProperty(e)&&this.keyMap_[e];return n||(this.keyMap_[e]=n=[]),n.push(t),this.count_++,this},$.QueryData.prototype.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_)return"";var e=[];for(var t in this.keyMap_)for(var n=encodeURIComponent(t),r=this.keyMap_[t],i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),e.push(a)}return this.encodedQuery_=e.join("&")},$.QueryData.prototype.toDecodedString=function(){return $.decodeOrEmpty_(this.toString())},$.QueryData.prototype.clone=function(){var e=new $.QueryData;if(e.encodedQuery_=this.encodedQuery_,this.keyMap_){var t={};for(var n in this.keyMap_)t[n]=this.keyMap_[n].concat();e.keyMap_=t,e.count_=this.count_}return e};var ae=new M,se=(window.shaka,window.goog,function(e){function t(e){var n;return Z(this,t),(n=te(this,ne(t).call(this))).destroyed_=!1,n.operationManager_=new m,n.requestFilters_=new Set,n.responseFilters_=new Set,n.onProgressUpdated_=e||null,n}return re(t,C),ee(t,[{key:"registerRequestFilter",value:function(e){this.requestFilters_.add(e)}},{key:"unregisterRequestFilter",value:function(e){this.requestFilters_.delete(e)}},{key:"clearAllRequestFilters",value:function(){this.requestFilters_.clear()}},{key:"registerResponseFilter",value:function(e){this.responseFilters_.add(e)}},{key:"unregisterResponseFilter",value:function(e){this.responseFilters_.delete(e)}},{key:"clearAllResponseFilters",value:function(){this.responseFilters_.clear()}},{key:"destroy",value:function(){return this.destroyed_=!0,this.requestFilters_.clear(),this.responseFilters_.clear(),this.operationManager_.destroy()}},{key:"request",value:function(e,n){var r=this,i=new t.NumBytesRemainingClass;if(this.destroyed_){var a=Promise.reject(new M(M.Severity.CRITICAL,M.Category.PLAYER,M.Code.OPERATION_ABORTED));return a.catch(function(){}),new t.PendingRequest(a,function(){return Promise.resolve()},i)}window.asserts.assert(n.uris&&n.uris.length,"Request without URIs!"),n.method=n.method||"GET",n.headers=n.headers||{},n.retryParameters=n.retryParameters?y.cloneObject(n.retryParameters):t.defaultRetryParameters(),n.uris=y.cloneObject(n.uris);var s=this.filterRequest_(e,n),o=s.chain(function(){return r.makeRequestWithRetry_(e,n,i)}),l=o.chain(function(t){return r.filterResponse_(e,t)}),u=Date.now(),c=0;s.promise.then(function(){c=Date.now()-u},function(){});var d=0;o.promise.then(function(){d=Date.now()},function(){});var h=l.chain(function(n){var i=Date.now()-d,a=n.response;return a.timeMs+=c,a.timeMs+=i,n.gotProgress||!r.onProgressUpdated_||a.fromCache||e!=t.RequestType.SEGMENT||r.onProgressUpdated_(a.timeMs,a.data.byteLength),a},function(e){throw e&&(window.asserts.assert(e instanceof M,"Wrong error type"),e.severity=ae.severity.CRITICAL),e}),f=new t.PendingRequest(h.promise,h.onAbort_,i);return this.operationManager_.manage(f),f}},{key:"filterRequest_",value:function(e,t){var n=U.completed(void 0),r=!0,i=!1,a=void 0;try{for(var s,o=function(){var r=s.value;n=n.chain(function(){return r(e,t)})},l=this.requestFilters_[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)o()}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}return n.chain(void 0,function(e){if(e&&e.code==M.Code.OPERATION_ABORTED)throw e;throw new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.REQUEST_FILTER_ERROR,e)})}},{key:"makeRequestWithRetry_",value:function(e,t,n){var r=new K(t.retryParameters,!1);return this.send_(e,t,r,0,null,n)}},{key:"send_",value:function(e,n,r,i,a,s){var o=this,l=new $(n.uris[i]),u=l.getScheme(),c=!1;u||(u=t.getLocationProtocol_(),window.asserts.assert(":"==u[u.length-1],"location.protocol expected to end with a colon!"),u=u.slice(0,-1),l.setScheme(u),n.uris[i]=l.toString());var d,h=t.schemes_[u],f=h?h.plugin:null;return f?U.notAbortable(r.attempt()).chain(function(){if(o.destroyed_)return U.aborted();d=Date.now();var r=t.RequestType.SEGMENT;return f(n.uris[i],n,e,function(t,n,i){o.onProgressUpdated_&&e==r&&(o.onProgressUpdated_(t,n),c=!0,s.setBytes(i))})}).chain(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-d),{response:e,gotProgress:c}},function(t){if(o.destroyed_)return U.aborted();if(t.code==ae.code.OPERATION_ABORTED)throw t;if(t.code==ae.code.ATTEMPTS_EXHAUSTED)throw window.asserts.assert(a,"Should have last error"),a;if(t.severity==ae.severity.RECOVERABLE){var l=new w("retry",{error:t instanceof M?t:null});o.dispatchEvent(l),i=(i+1)%n.uris.length;var u=t;return o.send_(e,n,r,i,u,s)}throw t}):U.failed(new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.UNSUPPORTED_SCHEME,l))}},{key:"filterResponse_",value:function(e,t){var n=U.completed(void 0),r=!0,i=!1,a=void 0;try{for(var s,o=function(){var r=s.value;n=n.chain(function(){return r(e,t.response)})},l=this.responseFilters_[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)o()}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}return n.chain(function(){return t},function(e){if(e&&e.code==M.Code.OPERATION_ABORTED)throw e;var t=M.Severity.CRITICAL;throw e instanceof M&&(t=e.severity),new M(t,M.Category.NETWORK,M.Code.RESPONSE_FILTER_ERROR,e)})}}],[{key:"registerScheme",value:function(e,n,r){window.asserts.assert(null==r||r>0,"explicit priority must be > 0"),r=r||t.PluginPriority.APPLICATION;var i=t.schemes_[e];(!i||r>=i.priority)&&(t.schemes_[e]={priority:r,plugin:n})}},{key:"unregisterScheme",value:function(e){delete t.schemes_[e]}},{key:"defaultRetryParameters",value:function(){return K.defaultRetryParameters()}},{key:"makeRequest",value:function(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null}}},{key:"getLocationProtocol_",value:function(){return window.location.protocol}}]),t}());se.NumBytesRemainingClass=function(){function e(){Z(this,e),this.bytesToLoad_=0}return ee(e,[{key:"setBytes",value:function(e){this.bytesToLoad_=e}},{key:"getBytes",value:function(){return this.bytesToLoad_}}]),e}(),se.PendingRequest=function(e){function t(e,n,r){var i;return Z(this,t),(i=te(this,ne(t).call(this,e,n))).bytesRemaining_=r,i}return re(t,U),ee(t,[{key:"getBytesRemaining",value:function(){return this.bytesRemaining_.getBytes()}}]),t}(),se.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},se.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3},se.SchemeObject={},se.schemes_={},se.ResponseAndGotProgress={};var oe=se;function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;var ce=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.shortName="",this.iconUri=n,this.manifestUri=r,this.source=i,this.focus=!1,this.disabled=!1,this.extraText=[],this.certificateUri=null,this.description="",this.isFeatured=!1,this.drm=[l.CLEAR],this.features=[],this.licenseServers=new Map,this.licenseRequestHeaders=new Map,this.requestFilter=null,this.responseFilter=null,this.drmCallback=null,this.clearKeys=new Map,this.extraConfig=null,this.storeCallback=null,this.unstoreCallback=null,this.storedContent=null,this.storedProgress=1}var t,n,r;return t=e,r=[{key:"caseLessAlphaComparator_",value:function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}},{key:"makeBlankAsset",value:function(){return new e("","","",o.CUSTOM)}},{key:"fromJSON",value:function(t){var n={};for(var r in t){var i=t[r];if(i&&"object"==le(i)&&"map"===i.__type__){var a=new Map;for(var s in i)"__type__"!==s&&a.set(s,i[s]);n[r]=a}else n[r]=i}var o=e.makeBlankAsset();return Object.assign(o,n),o}}],(n=[{key:"addDescription",value:function(e){return this.description=e,this}},{key:"addCertificateUri",value:function(e){return this.certificateUri=e,this}},{key:"addFeature",value:function(t){return this.features.push(t),this.features.sort(e.caseLessAlphaComparator_),this}},{key:"addKeySystem",value:function(t){return 1===this.drm.length&&this.drm[0]===l.CLEAR&&(this.drm=[]),this.drm.push(t),this.drm.sort(e.caseLessAlphaComparator_),this}},{key:"setExtraConfig",value:function(e){return this.extraConfig=e,this}},{key:"setRequestFilter",value:function(e){return this.requestFilter=e,this}},{key:"setResponseFilter",value:function(e){return this.responseFilter=e,this}},{key:"addLicenseServer",value:function(e,t){return this.licenseServers.set(e,t),this}},{key:"addLicenseRequestHeader",value:function(e,t){return this.licenseRequestHeaders.set(e,t),this}},{key:"addExtraText",value:function(e){return this.extraText.push(e),this}},{key:"markAsFocused",value:function(){return this.focus=!0,this}},{key:"markAsFeatured",value:function(e){return this.isFeatured=!0,this.shortName=e||this.shortName,this}},{key:"markAsDisabled",value:function(){return this.disabled=!0,this}},{key:"toJSON",value:function(){var e={};for(var t in this){var n=this[t];if(n instanceof Map){var r={__type__:"map"},i=!0,a=!1,s=void 0;try{for(var o,l=n.entries()[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;r[u[0]]=u[1]}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}e[t]=r}else e[t]=n}return e}},{key:"applyFilters",value:function(e){var t=this;if(e.clearAllRequestFilters(),e.clearAllResponseFilters(),this.licenseRequestHeaders.size){e.registerRequestFilter(function(e,n){return t.addLicenseRequestHeaders_(t.licenseRequestHeaders,e,n)})}this.requestFilter&&e.registerRequestFilter(this.requestFilter),this.responseFilter&&e.registerResponseFilter(this.responseFilter)}},{key:"getConfiguration",value:function(){var e={drm:{},manifest:{dash:{}}};if(this.licenseServers.size&&(e.drm.servers={},this.licenseServers.forEach(function(t,n){e.drm.servers[n]=t})),this.drmCallback&&(e.manifest.dash.customScheme=this.drmCallback),this.clearKeys.size&&(e.drm.clearKeys={},this.clearKeys.forEach(function(t,n){e.drm.clearKeys[n]=t})),this.extraConfig)for(var t in this.extraConfig)e[t]=this.extraConfig[t];return e}},{key:"addLicenseRequestHeaders_",value:function(e,t,n){t===oe.RequestType.LICENSE&&e.forEach(function(e,t){n.headers[t]=e})}},{key:"isStored",value:function(){return null!=this.storedContent}}])&&ue(t.prototype,n),r&&ue(t,r),e}();window.shaka=window.shaka||{};var de=window.shaka,he={};he.Source=o,he.Feature=u,he.KeySystem=l,he.ExtraText={},he.lastUplynkPrefix="",he.UplynkResponseFilter=function(e,t){e===oe.RequestType.MANIFEST&&(t.headers["x-uplynk-prefix"]?he.lastUplynkPrefix=t.headers["x-uplynk-prefix"]:he.lastUplynkPrefix="")},he.UplynkRequestFilter=function(e,t){e===de.net.NetworkingEngine.RequestType.LICENSE&&(t.uris[0].includes("wv")&&he.lastUplynkPrefix?t.uris[0]=he.lastUplynkPrefix.concat("/wv"):t.uris[0].includes("ck")&&he.lastUplynkPrefix?t.uris[0]=he.lastUplynkPrefix.concat("/ck"):t.uris[0].includes("pr")&&he.lastUplynkPrefix&&(t.uris[0]=he.lastUplynkPrefix.concat("/pr")))},he.testAssets=[new ce("Big Buck Bunny: the Dark Truths of a Video Dev Cartoon (DASH)","https://storage.googleapis.com/shaka-asset-icons/dark_truth.png","https://storage.googleapis.com/shaka-demo-assets/bbb-dark-truths/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.WEBM).addFeature(u.OFFLINE),new ce("Big Buck Bunny: the Dark Truths of a Video Dev Cartoon (HLS)","https://storage.googleapis.com/shaka-asset-icons/dark_truth.png","https://storage.googleapis.com/shaka-demo-assets/bbb-dark-truths-hls/hls.m3u8",o.SHAKA).addDescription("A serious documentary about a problem plaguing video developers.").markAsFeatured("Big Buck Bunny: the Dark Truths").addFeature(u.HLS).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.OFFLINE),new ce("Angel One (multicodec, multilingual)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd",o.SHAKA).addDescription("A clip from a classic Star Trek TNG episode, presented in MPEG-DASH.").markAsFeatured("Angel One").addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Angel One (multicodec, multilingual, Widevine)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine/dash.mpd",o.SHAKA).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.MULTIKEY).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new ce("Angel One (multicodec, multilingual, ClearKey server)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-clearkey/dash.mpd",o.SHAKA).addKeySystem(l.CLEAR_KEY).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE).addLicenseServer("org.w3.clearkey","https://cwip-shaka-proxy.appspot.com/clearkey?_u3wDe7erb7v8Lqt8A3QDQ=ABEiM0RVZneImaq7zN3u_w"),new ce("Angel One (HLS, MP4, multilingual)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-hls/hls.m3u8",o.SHAKA).addFeature(u.HLS).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.SURROUND).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Angel One (HLS, MP4, multilingual, Widevine)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine-hls/hls.m3u8",o.SHAKA).addKeySystem(l.WIDEVINE).addFeature(u.HLS).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.SURROUND).addFeature(u.MULTIKEY).addFeature(u.WEBVTT).addFeature(u.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new ce("Sintel 4k (multicodec)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Sintel w/ trick mode (MP4 only, 720p)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-trickplay/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.TRICK_MODE).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Sintel 4k (WebM only)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-webm-only/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Sintel 4k (MP4 only)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-mp4-only/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Sintel 4k (multicodec, Widevine)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-widevine/dash.mpd",o.SHAKA).addDescription("A Blender Foundation short film, protected by Widevine encryption.").markAsFeatured("Sintel").addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIKEY).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBM).addFeature(u.WEBVTT).addFeature(u.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new ce("Sintel 4k (multicodec, VTT in MP4)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-mp4-wvtt/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Sintel w/ 44 subtitle languages","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-many-subs/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.SURROUND).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Heliocentrism (multicodec, multiperiod)","https://storage.googleapis.com/shaka-asset-icons/heliocentricism.png","https://storage.googleapis.com/shaka-demo-assets/heliocentrism/heliocentrism.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPERIOD).addFeature(u.WEBM).addFeature(u.OFFLINE),new ce("Heliocentrism (multicodec, multiperiod, xlink)","https://storage.googleapis.com/shaka-asset-icons/heliocentricism.png","https://storage.googleapis.com/shaka-demo-assets/heliocentrism-xlink/heliocentrism.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPERIOD).addFeature(u.WEBM).addFeature(u.XLINK).addFeature(u.OFFLINE),new ce('"Dig the Uke" by Stefan Kartenberg (audio only, multicodec)',"https://storage.googleapis.com/shaka-asset-icons/audio_only.png","https://storage.googleapis.com/shaka-demo-assets/dig-the-uke-clear/dash.mpd",o.SHAKA).addDescription("An audio-only presentation performed by Stefan Kartenberg.").markAsFeatured("Dig the Uke").addFeature(u.DASH).addFeature(u.MP4).addFeature(u.AUDIO_ONLY).addFeature(u.WEBM).addFeature(u.OFFLINE),new ce('"Dig the Uke" by Stefan Kartenberg (audio only, multicodec, Widevine)',"https://storage.googleapis.com/shaka-asset-icons/audio_only.png","https://storage.googleapis.com/shaka-demo-assets/dig-the-uke/dash.mpd",o.SHAKA).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.AUDIO_ONLY).addFeature(u.WEBM).addFeature(u.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new ce("Tears of Steel (multicodec, TTML)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://storage.googleapis.com/shaka-demo-assets/tos-ttml/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.TTML).addFeature(u.WEBM).addFeature(u.OFFLINE),new ce("Tears of Steel (multicodec, surround + stereo)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://storage.googleapis.com/shaka-demo-assets/tos-surround/dash.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.SURROUND).addFeature(u.WEBM).addFeature(u.OFFLINE),new ce("Shaka Player History (multicodec, live, DASH)","https://storage.googleapis.com/shaka-asset-icons/shaka.png","https://storage.googleapis.com/shaka-live-assets/player-source.mpd",o.SHAKA).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.LIVE).addFeature(u.MP4).addFeature(u.WEBM),new ce("Shaka Player History (live, HLS)","https://storage.googleapis.com/shaka-asset-icons/shaka.png","https://storage.googleapis.com/shaka-live-assets/player-source.m3u8",o.SHAKA).addDescription("A self-indulgent HLS livestream.").markAsFeatured("Shaka Player History").addFeature(u.HIGH_DEFINITION).addFeature(u.HLS).addFeature(u.LIVE).addFeature(u.MP4),new ce("Multi-DRM","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-SingleKey/Manifest.mpd",o.AXINOM).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.TTML).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiOWViNDA1MGQtZTQ0Yi00ODAyLTkzMmUtMjdkNzUwODNlMjY2IiwiZW5jcnlwdGVkX2tleSI6ImxLM09qSExZVzI0Y3Iya3RSNzRmbnc9PSJ9XX19.4lWwW46k-oWcah8oN18LPj5OLS5ZU-_AQv7fe0JhNjA"),new ce("Multi-DRM, multi-key","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-MultiKey/Manifest.mpd",o.AXINOM).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.MULTIKEY).addFeature(u.SUBTITLES).addFeature(u.TTML).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiODAzOTliZjUtOGEyMS00MDE0LTgwNTMtZTI3ZTc0OGU5OGMwIiwiZW5jcnlwdGVkX2tleSI6ImxpTkpxVmFZa05oK01LY3hKRms3SWc9PSJ9LHsiaWQiOiI5MDk1M2UwOS02Y2IyLTQ5YTMtYTI2MC03YTVmZWZlYWQ0OTkiLCJlbmNyeXB0ZWRfa2V5Ijoia1l0SEh2cnJmQ01lVmRKNkxrYmtuZz09In0seyJpZCI6IjBlNGRhOTJiLWQwZTgtNGE2Ni04YzNmLWMyNWE5N2ViNjUzMiIsImVuY3J5cHRlZF9rZXkiOiI3dzdOWkhITE1nSjRtUUtFSzVMVE1RPT0ifSx7ImlkIjoiNTg1ZjIzM2YtMzA3Mi00NmYxLTlmYTQtNmRjMjJjNjZhMDE0IiwiZW5jcnlwdGVkX2tleSI6IkFjNFVVbVl0Qko1blBROU4xNXJjM2c9PSJ9LHsiaWQiOiI0MjIyYmQ3OC1iYzQ1LTQxYmYtYjYzZS02ZjgxNGRjMzkxZGYiLCJlbmNyeXB0ZWRfa2V5IjoiTzZGTzBmcVNXb3BwN2JqYy9ENGxNQT09In1dfX0.uF6YlKAREOmbniAeYiH070HSJhV0YS7zSKjlCtiDR5Y"),new ce("Multi-DRM, multi-key, multi-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-MultiKey-MultiPeriod/Manifest.mpd",o.AXINOM).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.SUBTITLES).addFeature(u.MULTIKEY).addFeature(u.MULTIPERIOD).addFeature(u.TTML).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiMDg3Mjc4NmUtZjllNy00NjVmLWEzYTItNGU1YjBlZjhmYTQ1IiwiZW5jcnlwdGVkX2tleSI6IlB3NitlRVlOY3ZqWWJmc2gzWDNmbWc9PSJ9LHsiaWQiOiJjMTRmMDcwOS1mMmI5LTQ0MjctOTE2Yi02MWI1MjU4NjUwNmEiLCJlbmNyeXB0ZWRfa2V5IjoiLzErZk5paDM4bXFSdjR5Y1l6bnQvdz09In0seyJpZCI6IjhiMDI5ZTUxLWQ1NmEtNDRiZC05MTBmLWQ0YjVmZDkwZmJhMiIsImVuY3J5cHRlZF9rZXkiOiJrcTBKdVpFanBGTjhzYVRtdDU2ME9nPT0ifSx7ImlkIjoiMmQ2ZTkzODctNjBjYS00MTQ1LWFlYzItYzQwODM3YjRiMDI2IiwiZW5jcnlwdGVkX2tleSI6IlRjUlFlQld4RW9IT0tIcmFkNFNlVlE9PSJ9LHsiaWQiOiJkZTAyZjA3Zi1hMDk4LTRlZTAtYjU1Ni05MDdjMGQxN2ZiYmMiLCJlbmNyeXB0ZWRfa2V5IjoicG9lbmNTN0dnbWVHRmVvSjZQRUFUUT09In0seyJpZCI6IjkxNGU2OWY0LTBhYjMtNDUzNC05ZTlmLTk4NTM2MTVlMjZmNiIsImVuY3J5cHRlZF9rZXkiOiJlaUkvTXNsbHJRNHdDbFJUL0xObUNBPT0ifSx7ImlkIjoiZGE0NDQ1YzItZGI1ZS00OGVmLWIwOTYtM2VmMzQ3YjE2YzdmIiwiZW5jcnlwdGVkX2tleSI6IjJ3K3pkdnFycERWM3hSMGJKeTR1Z3c9PSJ9LHsiaWQiOiIyOWYwNWU4Zi1hMWFlLTQ2ZTQtODBlOS0yMmRjZDQ0Y2Q3YTEiLCJlbmNyeXB0ZWRfa2V5IjoiL3hsU0hweHdxdTNnby9nbHBtU2dhUT09In0seyJpZCI6IjY5ZmU3MDc3LWRhZGQtNGI1NS05NmNkLWMzZWRiMzk5MTg1MyIsImVuY3J5cHRlZF9rZXkiOiJ6dTZpdXpOMnBzaTBaU3hRaUFUa1JRPT0ifV19fQ.BXr93Et1krYMVs-CUnf7F3ywJWFRtxYdkR7Qn4w3-to"),new ce("Clear, single-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-Clear/Manifest.mpd",o.AXINOM).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.TTML).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Clear, multi-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-Clear/Manifest_MultiPeriod.mpd",o.AXINOM).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.MULTIPERIOD).addFeature(u.TTML).addFeature(u.SUBTITLES).addFeature(u.ULTRA_HIGH_DEFINITION).addFeature(u.WEBVTT).addFeature(u.OFFLINE),new ce("Clear, Live DASH","https://storage.googleapis.com/shaka-asset-icons/axinom_test.png","https://akamai-axtest.akamaized.net/routes/lapd-v1-acceptance/www_c4/Manifest.mpd",o.AXINOM).addFeature(u.LIVE).addFeature(u.MP4).addFeature(u.DASH).addFeature(u.MULTIPERIOD).addFeature(u.HIGH_DEFINITION).addFeature(u.WEBVTT),new ce("Clear, Live HLS","https://storage.googleapis.com/shaka-asset-icons/axinom_test.png","https://akamai-axtest.akamaized.net/routes/lapd-v1-acceptance/www_c4/Manifest.m3u8",o.AXINOM).addFeature(u.HLS).addFeature(u.LIVE).addFeature(u.MP4).addFeature(u.HIGH_DEFINITION),new ce("Tears of Steel","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel.ism/.mpd",o.UNIFIED_STREAMING).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.OFFLINE),new ce("Tears of Steel (Widevine)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-dash-widevine.ism/.mpd",o.UNIFIED_STREAMING).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.TTML).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new ce("Tears of Steel (PlayReady)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-dash-playready.ism/.mpd",o.UNIFIED_STREAMING).addKeySystem(l.PLAYREADY).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.TTML).addLicenseServer("com.microsoft.playready","https://test.playready.microsoft.com/service/rightsmanager.asmx?PlayRight=1&UseSimpleNonPersistentLicense=1"),new ce("Tears of Steel (subtitles)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-en.ism/.mpd",o.UNIFIED_STREAMING).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.TTML).addFeature(u.OFFLINE),new ce("Big Buck Bunny (DASH-IF)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://dash.akamaized.net/dash264/TestCases/1c/qualcomm/2/MultiRate.mpd",o.DASH_IF).addFeature(u.MP4).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.OFFLINE),new ce("Live sim (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/utc_head/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(u.LIVE).addFeature(u.MP4).addFeature(u.DASH),new ce("Live sim SegmentTimeline w $Time$ (6s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimeline_1/utc_head/testpic_6s/Manifest.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.LIVE).addFeature(u.MP4),new ce("Live sim SegmentTimeline w $Number$ (6s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimelinenr_1/utc_head/testpic_6s/Manifest.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.LIVE).addFeature(u.MP4),new ce("Live sim SegmentTimeline StartOver [-20s, +20s] (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimeline_1/startrel_-20/stoprel_20/timeoffset_0/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.MP4),new ce("Live sim StartOver SegTmpl Duration [-20s, +20s] (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/startrel_-20/stoprel_20/timeoffset_0/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.MP4),new ce("Live sim SegTmpl Duration (multi-period 60s)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/utc_head/periods_60/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.LIVE).addFeature(u.MP4).addFeature(u.MULTIPERIOD),new ce("Live sim TTML Image Subtitles embedded (VoD)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/dash/vod/testpic_2s/img_subs.mpd",o.DASH_IF).addFeature(u.DASH).addFeature(u.SUBTITLES).addFeature(u.MP4).addFeature(u.TTML),new ce("Big Buck Bunny (Live)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://wowzaec2demo.streamlock.net/live/bigbuckbunny/manifest_mpm4sav_mvtime.mpd",o.WOWZA).addFeature(u.DASH).addFeature(u.LIVE).addFeature(u.MP4),new ce("Art of Motion (DASH)","https://storage.googleapis.com/shaka-asset-icons/art_of_motion.png","https://bitdash-a.akamaihd.net/content/MI201109210084_1/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd",o.BITCODIN).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.OFFLINE),new ce("Art of Motion (HLS, TS)","https://storage.googleapis.com/shaka-asset-icons/art_of_motion.png","https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8",o.BITCODIN).markAsDisabled().addFeature(u.HIGH_DEFINITION).addFeature(u.HLS).addFeature(u.MP2TS).addFeature(u.OFFLINE),new ce("Sintel (HLS, TS, 4k)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",o.BITCODIN).markAsDisabled().addFeature(u.HIGH_DEFINITION).addFeature(u.HLS).addFeature(u.MP2TS).addFeature(u.OFFLINE),new ce("Big Buck Bunny (Nimble)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://video.wmspanel.com/local/raw/BigBuckBunny_320x180.mp4/manifest.mpd",o.NIMBLE_STREAMER).markAsDisabled().addFeature(u.DASH).addFeature(u.MP4).addFeature(u.HIGH_DEFINITION),new ce("Azure Trailer","https://storage.googleapis.com/shaka-asset-icons/azure.png","https://amssamples.streaming.mediaservices.windows.net/91492735-c523-432b-ba01-faba6c2206a2/AzureMediaServicesPromo.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.HIGH_DEFINITION).addFeature(u.OFFLINE),new ce("Big Buck Bunny (Azure)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://amssamples.streaming.mediaservices.windows.net/622b189f-ec39-43f2-93a2-201ac4e31ce1/BigBuckBunny.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.HIGH_DEFINITION).addFeature(u.MP4).addFeature(u.OFFLINE).addLicenseServer("com.widevine.alpha","https://amssamples.keydelivery.mediaservices.windows.net/Widevine/?KID=1ab45440-532c-4399-94dc-5c5ad9584bac").addLicenseServer("com.microsoft.playready","https://amssamples.keydelivery.mediaservices.windows.net/PlayReady/"),new ce("Tears of Steel (external text)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TearsOfSteel_WAMEH264SmoothStreaming720p.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.WEBVTT).addFeature(u.OFFLINE).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-en.vtt",language:"en",kind:"subtitle",mime:"text/vtt"}).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-es.vtt",language:"es",kind:"subtitle",mime:"text/vtt"}).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-fr.vtt",language:"fr",kind:"subtitle",mime:"text/vtt"}),new ce("live profile","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-live/mp4-live-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(u.DASH).addFeature(u.MP4),new ce("live profile with five periods","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-live-periods/mp4-live-periods-mpd.mpd",o.GPAC).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPERIOD).addFeature(u.HIGH_DEFINITION).addFeature(u.OFFLINE),new ce("main profile, single file","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-single/mp4-main-single-mpd-AV-NBS.mpd",o.GPAC).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.HIGH_DEFINITION).addFeature(u.OFFLINE),new ce("main profile, multiple files","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-multi/mp4-main-multi-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(u.DASH).addFeature(u.MP4),new ce("onDemand profile","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-onDemand/mp4-onDemand-mpd-AV.mpd",o.GPAC).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.HIGH_DEFINITION).addFeature(u.OFFLINE),new ce("main profile, open GOP","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-ogop/mp4-main-ogop-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(u.DASH).addFeature(u.MP4),new ce("full profile, gradual decoding refresh","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-full-gdr/mp4-full-gdr-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(u.DASH).addFeature(u.MP4),new ce("Multi DRM - 8 Byte IV","https://storage.googleapis.com/shaka-asset-icons/azure.png","https://content.uplynk.com/847859273a4b4a81959d8fea181672a4.mpd?pr.version=2&pr.playenabler=B621D91F-EDCC-4035-8D4B-DC71760D43E9&pr.securitylevel=150",o.UPLYNK).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIKEY).addFeature(u.AESCTR_8_BYTE_IV).addFeature(u.HIGH_DEFINITION).addLicenseServer("com.microsoft.playready","https://content.uplynk.com/pr").addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(he.UplynkRequestFilter).setResponseFilter(he.UplynkResponseFilter),new ce("Multi DRM - MultiPeriod - 8 Byte IV","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://content.uplynk.com/054225d59be2454fabdca3e96912d847.mpd?ad=cleardash&pr.version=2&pr.playenabler=B621D91F-EDCC-4035-8D4B-DC71760D43E9&pr.securitylevel=150",o.UPLYNK).addKeySystem(l.PLAYREADY).addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.SUBTITLES).addFeature(u.MULTIKEY).addFeature(u.MULTIPERIOD).addFeature(u.WEBVTT).addFeature(u.AESCTR_8_BYTE_IV).addFeature(u.HIGH_DEFINITION).addLicenseServer("com.microsoft.playready","https://content.uplynk.com/pr").addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(he.UplynkRequestFilter).setResponseFilter(he.UplynkResponseFilter),new ce("Widevine - 16 Byte IV","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://content.uplynk.com/224ac8717e714b68831997ab6cea4015.mpd",o.UPLYNK).markAsDisabled().addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIKEY).addFeature(u.AESCTR_16_BYTE_IV).addFeature(u.HIGH_DEFINITION).addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(he.UplynkRequestFilter).setResponseFilter(he.UplynkResponseFilter),new ce("Widevine - 16 Byte IV - (mix of encrypted and unencrypted periods)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://content.uplynk.com/1eb40d8e64234f5c9879db7045c3d48c.mpd?ad=cleardash&rays=cdefg",o.UPLYNK).markAsDisabled().addKeySystem(l.WIDEVINE).addFeature(u.DASH).addFeature(u.MP4).addFeature(u.MULTIPLE_LANGUAGES).addFeature(u.MULTIPERIOD).addFeature(u.MULTIKEY).addFeature(u.HIGH_DEFINITION).addFeature(u.AESCTR_16_BYTE_IV).addFeature(u.ENCRYPTED_WITH_CLEAR).addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(he.UplynkRequestFilter).setResponseFilter(he.UplynkResponseFilter)];var fe=he,pe=n(2),me=n(5),ve=n.n(me);function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ye=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"make",value:function(e,t){ve()(e,{content:t,placement:"bottom",arrow:!0,animation:"scale",size:"large"})}}],(n=null)&&ge(t.prototype,n),r&&ge(t,r),e}(),_e={ARIA_LABEL:"aria-label",SEEK_BAR_BASE_COLOR:"rgba(255, 255, 255, 0.3)",SEEK_BAR_PLAYED_COLOR:"rgb(255, 255, 255)",SEEK_BAR_BUFFERED_COLOR:"rgba(255, 255, 255, 0.54)",VOLUME_BAR_VOLUME_LEVEL_COLOR:"rgb(255, 255, 255)",VOLUME_BAR_BASE_COLOR:"rgba(255, 255, 255, 0.54)",MIN_SEEK_WINDOW_TO_SHOW_SEEKBAR:5,KEYCODE_TAB:9,KEYCODE_SHIFT:16,KEYCODE_ESCAPE:27},we=_e,Ee={MaterialDesignIcons:{FULLSCREEN:"fullscreen",EXIT_FULLSCREEN:"fullscreen_exit",CLOSED_CAPTIONS:"closed_caption",CHECKMARK:"done",LANGUAGE:"language",PIP:"picture_in_picture_alt",EXIT_PIP:"branding_watermark",BACK:"arrow_back",RESOLUTION:"settings",MUTE:"volume_up",UNMUTE:"volume_off",CAST:"cast",EXIT_CAST:"cast_connected",OPEN_OVERFLOW:"more_vert",REWIND:"fast_rewind",FAST_FORWARD:"fast_forward",PLAY:"play_arrow",PAUSE:"pause"},Opacity:{TRANSPARENT:0,OPAQUE:1}},be=Ee,Se={addTo:function(e){e.insert("ar",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",'   "  "'],["EXIT_FULL_SCREEN","   "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN"," "],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS"," "],["MUTE"," "],["NOT_APPLICABLE"," "],["OFF",""],["ON",""],["PAUSE"," "],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK","  "],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE"," "],["UNMUTE","  "],["UNRECOGNIZED_LANGUAGE"," "],["VOLUME",""]])),e.insert("de",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Zurck"],["CAPTIONS","Untertitel"],["CAST","Streamen"],["ENTER_PICTURE_IN_PICTURE","Bild-im-Bild-Modus aktivieren"],["EXIT_FULL_SCREEN","Vollbildmodus beenden"],["EXIT_PICTURE_IN_PICTURE","Bild-im-Bild-Modus beenden"],["FAST_FORWARD","Vorspulen"],["FULL_SCREEN","Vollbild"],["LANGUAGE","Sprache"],["LIVE","Live"],["MORE_SETTINGS","Weitere Einstellungen"],["MULTIPLE_LANGUAGES","mehrere Sprachen"],["MUTE","Stummschalten"],["NOT_APPLICABLE","Nicht zutreffend"],["OFF","Aus"],["ON","An"],["PAUSE","Pausieren"],["PICTURE_IN_PICTURE","Bild-in-Bild"],["PLAY","Wiedergeben"],["RESOLUTION","Auflsung"],["REWIND","Zurckspulen"],["SEEK","Schieberegler fr Suche"],["SKIP_TO_LIVE","Live"],["UNDETERMINED_LANGUAGE","Unbestimmt"],["UNMUTE","Stummschaltung aufheben"],["UNRECOGNIZED_LANGUAGE","Unerkannt"],["VOLUME","Lautstrke"]])),e.insert("en",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),e.insert("en-GB",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),e.insert("es",new Map([["AUTO_QUALITY","Automtica"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Reparto..."],["ENTER_PICTURE_IN_PICTURE","abrir el modo imagen en imagen"],["EXIT_FULL_SCREEN","Salir del modo de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","salir del modo imagen en imagen"],["FAST_FORWARD","Avance rpido"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["MORE_SETTINGS","Ms ajustes"],["MULTIPLE_LANGUAGES","varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","No"],["ON","activado"],["PAUSE","Pausa"],["PICTURE_IN_PICTURE","Imagen en imagen"],["PLAY","Reproducir"],["RESOLUTION","Resolucin"],["REWIND","Retroceder"],["SEEK","Barra deslizante de bsqueda"],["SKIP_TO_LIVE","En directo"],["UNDETERMINED_LANGUAGE","Desconocido"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","Desconocido"],["VOLUME","volumen"]])),e.insert("es-419",new Map([["AUTO_QUALITY","Auto"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Transmitir"],["ENTER_PICTURE_IN_PICTURE","ingresar al modo de pantalla en pantalla"],["EXIT_FULL_SCREEN","Salir de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","salir del modo de pantalla en pantalla"],["FAST_FORWARD","Avance rpido"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En vivo"],["MORE_SETTINGS","Ms opciones de configuracin"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","activado"],["PAUSE","Detener"],["PICTURE_IN_PICTURE","Pantalla en pantalla"],["PLAY","Jugar"],["RESOLUTION","Resolucin"],["REWIND","Retroceder"],["SEEK","Barra deslizante de bsqueda"],["SKIP_TO_LIVE","En vivo"],["UNDETERMINED_LANGUAGE","Desconocido"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","Desconocido"],["VOLUME","volumen"]])),e.insert("fr",new Map([["AUTO_QUALITY","Auto"],["BACK","Retour"],["CAPTIONS","Sous-titres"],["CAST","Caster sur"],["ENTER_PICTURE_IN_PICTURE","utiliser le mode PIP"],["EXIT_FULL_SCREEN","Quitter le mode plein cran"],["EXIT_PICTURE_IN_PICTURE","quitter le mode PIP"],["FAST_FORWARD","Avance rapide"],["FULL_SCREEN","Plein cran"],["LANGUAGE","Langue"],["LIVE","En direct"],["MORE_SETTINGS","Autres paramtres"],["MULTIPLE_LANGUAGES","plusieurs langues"],["MUTE","Dsactiver le son"],["NOT_APPLICABLE","Non applicable"],["OFF","Dsactive"],["ON","activ"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Lire"],["RESOLUTION","Rsolution"],["REWIND","Retour arrire"],["SEEK","Barre de recherche"],["SKIP_TO_LIVE","Aller au direct"],["UNDETERMINED_LANGUAGE","Inconnue"],["UNMUTE","Activer le son"],["UNRECOGNIZED_LANGUAGE","Inconnue"],["VOLUME","volume"]])),e.insert("it",new Map([["AUTO_QUALITY","Auto"],["BACK","Indietro"],["CAPTIONS","Sottotitoli"],["CAST","Trasmetti"],["ENTER_PICTURE_IN_PICTURE","attiva picture in picture"],["EXIT_FULL_SCREEN","Esci dalla modalit a schermo intero"],["EXIT_PICTURE_IN_PICTURE","esci da picture in picture"],["FAST_FORWARD","Avanti veloce"],["FULL_SCREEN","Schermo intero"],["LANGUAGE","Lingua"],["LIVE","Dal vivo"],["MORE_SETTINGS","Altre impostazioni"],["MUTE","Disattiva audio"],["NOT_APPLICABLE","Non applicable"],["OFF","Disattivato"],["ON","on"],["PAUSE","Metti in pausa"],["PICTURE_IN_PICTURE","Picture in picture"],["PLAY","Riproduci"],["RESOLUTION","Risoluzione"],["REWIND","Riavvolgi"],["SEEK","Dispositivo di scorrimento"],["SKIP_TO_LIVE","Dal vivo"],["UNDETERMINED_LANGUAGE","Sconosciuto"],["UNMUTE","Riattiva audio"],["UNRECOGNIZED_LANGUAGE","Sconosciuto"],["VOLUME","volume"]])),e.insert("ja",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE","  "],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE","  "],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE","--"],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK"," "],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.insert("ko",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE","PIP  "],["EXIT_FULL_SCREEN"," "],["EXIT_PICTURE_IN_PICTURE","PIP  "],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES"," "],["MUTE",""],["NOT_APPLICABLE","  "],["OFF"," "],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","PIP "],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK"," "],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE","  "],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE","  "],["VOLUME",""]])),e.insert("nl",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Terug"],["CAPTIONS","Ondertiteling"],["CAST","Casten..."],["ENTER_PICTURE_IN_PICTURE","scherm-in-scherm openen"],["EXIT_FULL_SCREEN","Volledig scherm afsluiten"],["EXIT_PICTURE_IN_PICTURE","scherm-in-scherm afsluiten"],["FAST_FORWARD","Vooruitspoelen"],["FULL_SCREEN","Volledig scherm"],["LANGUAGE","Taal"],["LIVE","Live"],["MORE_SETTINGS","Meer instellingen"],["MUTE","Dempen"],["NOT_APPLICABLE","Niet van toepassing"],["OFF","Uit"],["ON","aan"],["PAUSE","Onderbreken"],["PICTURE_IN_PICTURE","Scherm-in-scherm"],["PLAY","Afspelen"],["RESOLUTION","Resolutie"],["REWIND","Terugspoelen"],["SEEK","Zoekschuifbalk"],["SKIP_TO_LIVE","Live"],["UNDETERMINED_LANGUAGE","Onbekend"],["UNMUTE","Dempen opheffen"],["UNRECOGNIZED_LANGUAGE","Onbekend"],["VOLUME","volume"]])),e.insert("pl",new Map([["AUTO_QUALITY","Automatyczna"],["BACK","Wstecz"],["CAPTIONS","Napisy"],["CAST","Przelij..."],["ENTER_PICTURE_IN_PICTURE","wcz tryb obrazu w obrazie"],["EXIT_FULL_SCREEN","Zamknij peny ekran"],["EXIT_PICTURE_IN_PICTURE","wycz tryb obrazu w obrazie"],["FAST_FORWARD","Przewi do przodu"],["FULL_SCREEN","Peny ekran"],["LANGUAGE","Jzyk"],["LIVE","Na ywo"],["MORE_SETTINGS","Wicej ustawie"],["MUTE","Wycisz"],["NOT_APPLICABLE","Nie dotyczy"],["OFF","Wyczone"],["ON","w."],["PAUSE","Wstrzymaj"],["PICTURE_IN_PICTURE","Obraz w obrazie"],["PLAY","Odtwarzaj"],["RESOLUTION","Rozdzielczo"],["REWIND","Przewi do tyu"],["SEEK","Suwak przewijania"],["SKIP_TO_LIVE","Na ywo"],["UNDETERMINED_LANGUAGE","Nieznane"],["UNMUTE","Wycz wyciszenie"],["UNRECOGNIZED_LANGUAGE","Nieznane"],["VOLUME","gono"]])),e.insert("pt",new Map([["AUTO_QUALITY","Automtico"],["BACK","Voltar"],["CAPTIONS","Legendas ocultas"],["CAST","Elenco..."],["ENTER_PICTURE_IN_PICTURE","entrar no modo picture-in-picture"],["EXIT_FULL_SCREEN","Sair da tela inteira"],["EXIT_PICTURE_IN_PICTURE","sair de picture-in-picture"],["FAST_FORWARD","Avanar"],["FULL_SCREEN","Tela inteira"],["LANGUAGE","Idioma"],["LIVE","Ao vivo"],["MORE_SETTINGS","Mais configuraes"],["MULTIPLE_LANGUAGES","vrios idiomas"],["MUTE","Desativar som"],["NOT_APPLICABLE","No aplicvel"],["OFF","Desativado"],["ON","ativado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Reproduzir"],["RESOLUTION","Resoluo"],["REWIND","Retroceder"],["SEEK","Boto deslizante de busca"],["SKIP_TO_LIVE","Ao vivo"],["UNDETERMINED_LANGUAGE","Desconhecido"],["UNMUTE","Ativar som"],["UNRECOGNIZED_LANGUAGE","Desconhecido"],["VOLUME","volume"]])),e.insert("ru",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST",""],["ENTER_PICTURE_IN_PICTURE",'  "  "'],["EXIT_FULL_SCREEN","   "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN","  "],["LANGUAGE",""],["LIVE"," "],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES","  "],["MUTE"," "],["NOT_APPLICABLE",""],["OFF","."],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION",""],["REWIND"," "],["SEEK"," "],["SKIP_TO_LIVE","  "],["UNDETERMINED_LANGUAGE",""],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.insert("th",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.insert("tr",new Map([["AUTO_QUALITY","Otomatik"],["BACK","Geri"],["CAPTIONS","Altyazlar"],["CAST","Yaynla..."],["ENTER_PICTURE_IN_PICTURE","pencere iinde pencere moduna gir"],["EXIT_FULL_SCREEN","Tam ekrandan k"],["EXIT_PICTURE_IN_PICTURE","pencere iinde pencere modundan kn"],["FAST_FORWARD","leri sar"],["FULL_SCREEN","Tam ekran"],["LANGUAGE","Dil"],["LIVE","Canl"],["MORE_SETTINGS","Dier ayarlar"],["MUTE","Sesi kapat"],["NOT_APPLICABLE","Kullanlmyor"],["OFF","Kapal"],["ON","ak"],["PAUSE","Duraklat"],["PICTURE_IN_PICTURE","Pencere iinde Pencere"],["PLAY","Oynat"],["RESOLUTION","znrlk"],["REWIND","Geri sar"],["SEEK","Arama kaydrma ubuu"],["SKIP_TO_LIVE","Canl"],["UNDETERMINED_LANGUAGE","Bilinmiyor"],["UNMUTE","Sesi a"],["UNRECOGNIZED_LANGUAGE","Bilinmiyor"],["VOLUME","ses dzeyi"]])),e.insert("zh",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.insert("zh-TW",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]]))},Ids:{ENTER_PICTURE_IN_PICTURE:"ENTER_PICTURE_IN_PICTURE",MULTIPLE_LANGUAGES:"MULTIPLE_LANGUAGES",BACK:"BACK",VOLUME:"VOLUME",EXIT_FULL_SCREEN:"EXIT_FULL_SCREEN",NOT_APPLICABLE:"NOT_APPLICABLE",SEEK:"SEEK",LANGUAGE:"LANGUAGE",SKIP_TO_LIVE:"SKIP_TO_LIVE",FULL_SCREEN:"FULL_SCREEN",CAST:"CAST",LIVE:"LIVE",UNRECOGNIZED_LANGUAGE:"UNRECOGNIZED_LANGUAGE",RESOLUTION:"RESOLUTION",PICTURE_IN_PICTURE:"PICTURE_IN_PICTURE",PLAY:"PLAY",PAUSE:"PAUSE",OFF:"OFF",MUTE:"MUTE",UNDETERMINED_LANGUAGE:"UNDETERMINED_LANGUAGE",CAPTIONS:"CAPTIONS",AUTO_QUALITY:"AUTO_QUALITY",ON:"ON",MORE_SETTINGS:"MORE_SETTINGS",EXIT_PICTURE_IN_PICTURE:"EXIT_PICTURE_IN_PICTURE",UNMUTE:"UNMUTE",FAST_FORWARD:"FAST_FORWARD",REWIND:"REWIND"}},Te=Se;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"map",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;n.push(t(l))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"every",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){if(!t(a.value))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0}},{key:"some",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){if(t(a.value))return!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}},{key:"filter",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;t(l)&&n.push(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}}],(n=null)&&ke(t.prototype,n),r&&ke(t,r),e}();function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createFallbackPromiseChain",value:function(e,t){return e.reduce(function(e,n){return e.catch(function(){return t(n)})},Promise.reject())}},{key:"collapseArrays",value:function(e,t){return e.concat(t)}},{key:"noop",value:function(){}},{key:"isNotNull",value:function(e){return null!=e}}],(n=null)&&Ie(t.prototype,n),r&&Ie(t,r),e}();function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"resolveUris",value:function(e,t){if(0==t.length)return e;var n=t.map(function(e){return new $(e)});return e.map(function(e){return new $(e)}).map(function(e){return n.map(function(t){return e.resolve(t)})}).reduce(Ae.collapseArrays,[]).map(function(e){return e.toString()})}},{key:"createDrmInfo",value:function(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}}],(n=null)&&Le(t.prototype,n),r&&Le(t,r),e}();function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Re.ContentType={VIDEO:"video",AUDIO:"audio",TEXT:"text",APPLICATION:"application"},Re.TextStreamKind={SUBTITLE:"subtitle",CLOSED_CAPTION:"caption"},Re.GAP_OVERLAP_TOLERANCE_SECONDS=1/15;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"areLocaleCompatible",value:function(t,n){return(t=e.normalize(t))==(n=e.normalize(n))}},{key:"areLanguageCompatible",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return r[0]==i[0]}},{key:"isParentOf",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return r[0]==i[0]&&1==r.length&&2==i.length}},{key:"isSiblingOf",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return 2==r.length&&2==i.length&&r[0]==i[0]}},{key:"normalize",value:function(t){var n=t.split("-"),r=n[0]||"",i=n[1]||"";return r=r.toLowerCase(),r=e.isoMap_.get(r)||r,(i=i.toUpperCase())?r+"-"+i:r}},{key:"areSiblings",value:function(t,n){var r=e.getBase(t),i=e.getBase(n);return t!=r&&n!=i&&r==i}},{key:"getBase",value:function(t){var n,r=t.indexOf("-");return n=(n=r>=0?t.substring(0,r):t).toLowerCase(),n=e.isoMap_.get(n)||n}},{key:"getLocaleForText",value:function(t){var n=Re.ContentType;window.asserts.assert(t.type==n.TEXT,"Can only get language from text streams");var r=t.language||"und";return e.normalize(r)}},{key:"getLocaleForVariant",value:function(t){return t.language?e.normalize(t.language):t.audio&&t.audio.language?e.normalize(t.audio.language):t.video&&t.video.language?e.normalize(t.video.language):"und"}},{key:"findClosestLocale",value:function(t,n){var r=e.normalize(t),i=new Set,a=!0,s=!1,o=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;i.add(e.normalize(c))}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}var d=!0,h=!1,f=void 0;try{for(var p,m=i[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v==r)return v}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}var g=!0,y=!1,_=void 0;try{for(var w,E=i[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var b=w.value;if(e.isParentOf(b,r))return b}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}var S=!0,T=!1,k=void 0;try{for(var C,I=i[Symbol.iterator]();!(S=(C=I.next()).done);S=!0){var A=C.value;if(e.isSiblingOf(A,r))return A}}catch(e){T=!0,k=e}finally{try{S||null==I.return||I.return()}finally{if(T)throw k}}var L=!0,R=!1,x=void 0;try{for(var N,M=i[Symbol.iterator]();!(L=(N=M.next()).done);L=!0){var P=N.value;if(e.isParentOf(r,P))return P}}catch(e){R=!0,x=e}finally{try{L||null==M.return||M.return()}finally{if(R)throw x}}return null}},{key:"disassembleLocale_",value:function(e){var t=e.split("-");return window.asserts.assert(t.length<=2,["Locales should not have more than 2 components. ",e," has too many components."].join()),t}}],(n=null)&&xe(t.prototype,n),r&&xe(t,r),e}();function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ne.isoMap_=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Pe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fallbackLocale_=Ne.normalize(t),this.currentMap_=new Map,this.currentLocales_=new Set,this.localizations_=new Map,this.events_=new C}var t,n,r;return t=e,r=[{key:"findMissingKeys_",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;e.get(l)||n.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}}],(n=[{key:"addEventListener",value:function(e,t,n){this.events_.addEventListener(e,t,n)}},{key:"removeEventListener",value:function(e,t,n){this.events_.removeEventListener(e,t,n||void 0)}},{key:"dispatchEvent",value:function(e){return this.events_.dispatchEvent(e)}},{key:"changeLocale",value:function(t){var n=this,r=e;this.currentLocales_.clear();var i=!0,a=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;this.currentLocales_.add(Ne.normalize(u))}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}this.updateCurrentMap_(),this.events_.dispatchEvent(new w(r.LOCALE_CHANGED));var c=Ce.filter(this.currentLocales_,function(e){return!n.localizations_.has(e)});if(c.length){var d={locales:c};this.events_.dispatchEvent(new w(r.UNKNOWN_LOCALES,d))}}},{key:"insert",value:function(t,n,r){var i=e,a=e.ConflictResolution;t=Ne.normalize(t),void 0===r&&(r=a.USE_NEW);var s=this.localizations_.get(t)||new Map;return n.forEach(function(e,t){s.has(t)&&r!=a.USE_NEW||s.set(t,e)}),this.localizations_.set(t,s),this.updateCurrentMap_(),this.events_.dispatchEvent(new w(i.LOCALE_UPDATED)),this}},{key:"resolveDictionary",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.keys()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.set(s,this.resolve(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"resolve",value:function(t){var n=e,r=this.currentMap_.get(t);if(r)return r;var i={locales:Array.from(this.currentLocales_),missing:t};return this.events_.dispatchEvent(new w(n.UNKNOWN_LOCALIZATION,i)),""}},{key:"updateCurrentMap_",value:function(){var t=this,n=this.localizations_,r=this.fallbackLocale_,i=this.currentLocales_,a=new Set,s=!0,o=!1,l=void 0;try{for(var u,c=function(){var e=u.value;a.add(e),a.add(Ne.getBase(e));var t=Ce.filter(n.keys(),function(t){return Ne.areSiblings(t,e)});t.sort();var r=!0,i=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;a.add(c)}}catch(e){i=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw s}}var d=Ce.filter(n.keys(),function(t){return Ne.getBase(t)==e});d.sort();var h=!0,f=!1,p=void 0;try{for(var m,v=d[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;a.add(g)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}},d=i[Symbol.iterator]();!(s=(u=d.next()).done);s=!0)c()}catch(e){o=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(o)throw l}}a.add(r);var h=[],f=!0,p=!1,m=void 0;try{for(var v,g=a[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value,_=n.get(y);_&&h.push(_)}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}h.reverse(),this.currentMap_.clear();for(var E=0,b=h;E<b.length;E++){b[E].forEach(function(e,n){t.currentMap_.set(n,e)})}var S=this.currentMap_.keys(),T=new Set,k=!0,C=!1,I=void 0;try{for(var A,L=this.currentLocales_[Symbol.iterator]();!(k=(A=L.next()).done);k=!0){var R=A.value,x=this.localizations_.get(R)||new Map;e.findMissingKeys_(x,S,T)}}catch(e){C=!0,I=e}finally{try{k||null==L.return||L.return()}finally{if(C)throw I}}if(T.size>0){var N={locales:Array.from(i),missing:Array.from(T)};this.events_.dispatchEvent(new w(e.MISSING_LOCALIZATIONS,N))}}}])&&Me(t.prototype,n),r&&Me(t,r),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Pe.ConflictResolution={USE_OLD:0,USE_NEW:1},Pe.UNKNOWN_LOCALES="unknown-locales",Pe.UNKNOWN_LOCALIZATION="unknown-localization",Pe.MISSING_LOCALIZATIONS="missing-localizations",Pe.LOCALE_CHANGED="locale-changed",Pe.LOCALE_UPDATED="locale-updated",Pe.UnknownLocalesEvent,Pe.UnknownLocalizationEvent,Pe.MissingLocalizationsEvent;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var De=window.shaka,Ue=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createHTMLElement",value:function(e){return document.createElement(e)}},{key:"createVideoElement",value:function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}},{key:"asHTMLElement",value:function(e){return e}},{key:"asHTMLMediaElement",value:function(e){return e}},{key:"getElementByClassName",value:function(e,t){var n=t.getElementsByClassName(e);return window.asserts.assert(1==n.length,"Should only be one element with class name "+e),De.util.Dom.asHTMLElement(n[0])}},{key:"removeAllChildren",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}}],(n=null)&&Oe(t.prototype,n),r&&Oe(t,r),e}());function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getFirstDescendantWithClassName",value:function(t,n){return e.getDescendantIfExists(t,n)}},{key:"getDescendantIfExists",value:function(e,t){var n=e.getElementsByClassName(t);return n.length?n[0]:null}},{key:"focusOnTheChosenItem",value:function(t){if(t){var n=e.getDescendantIfExists(t,"shaka-chosen-item");n&&n.parentElement.focus()}}},{key:"checkmarkIcon",value:function(){var e=Ue.createHTMLElement("i");return e.classList.add("material-icons"),e.classList.add("shaka-chosen-item"),e.textContent=be.MaterialDesignIcons.CHECKMARK,e.setAttribute("aria-hidden","true"),e}},{key:"setDisplay",value:function(e,t){e&&(t?(e.classList.add("shaka-displayed"),e.classList.remove("shaka-hidden")):(e.classList.add("shaka-hidden"),e.classList.remove("shaka-displayed")))}}],(n=null)&&Fe(t.prototype,n),r&&Fe(t,r),e}();
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t,n){return t&&He(e.prototype,t),n&&He(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je=function(){function e(){Ve(this,e),this.bindingMap_=new S}return Ge(e,[{key:"release",value:function(){this.removeAll(),this.bindingMap_=null}},{key:"listen",value:function(t,n,r,i){if(this.bindingMap_){var a=new e.Binding_(t,n,r,i);this.bindingMap_.push(n,a)}}},{key:"listenOnce",value:function(e,t,n,r){var i=this;this.listen(e,t,function r(a){i.unlisten(e,t,r),n(a)},r)}},{key:"unlisten",value:function(e,t,n){if(this.bindingMap_){var r=this.bindingMap_.get(t)||[],i=!0,a=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;u.target===e&&(n!==u.listener&&n||(u.unlisten(),this.bindingMap_.remove(t,u)))}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}}}},{key:"removeAll",value:function(){if(this.bindingMap_){var e=this.bindingMap_.getAll(),t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.unlisten()}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.bindingMap_.clear()}}}]),e}();je.ListenerType=null,je.Binding_=function(){function e(t,n,r,i){Ve(this,e),this.target=t,this.type=n,this.listener=r,this.options=je.Binding_.convertOptions_(t,i),this.target.addEventListener(n,r,this.options)}return Ge(e,[{key:"unlisten",value:function(){window.asserts.assert(this.target,"Missing target"),this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=!1}}],[{key:"convertOptions_",value:function(e,t){if(void 0===t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]),r=Object.keys(t).filter(function(e){return!n.has(e)});return window.asserts.assert(0===r.length,"Unsupported flag(s) to addEventListener: "+r.join(",")),je.Binding_.doesSupportObject_(e)?t:t.capture||!1}},{key:"doesSupportObject_",value:function(e){var t=je.Binding_.supportsObject_;if(void 0===t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r);var i=function(){};e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}je.Binding_.supportsObject_=t}return t||!1}}]),e}(),je.Binding_.supportsObject_=void 0;var Ke=je;function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"serialize",value:function(t){return JSON.stringify(t,function(t,n){if("function"!=typeof n){if(n instanceof Event||n instanceof w){var r={};for(var i in n){var a=n[i];a&&"object"==We(a)?"detail"==i&&(r[i]=a):i in Event||(r[i]=a)}return r}return n instanceof TimeRanges?e.unpackTimeRanges_(n):n instanceof Uint8Array?e.unpackUint8Array_(n):"number"==typeof n?isNaN(n)?"NaN":isFinite(n)?n:n<0?"-Infinity":"Infinity":n}})}},{key:"deserialize",value:function(t){return JSON.parse(t,function(t,n){return"NaN"==n?NaN:"-Infinity"==n?-1/0:"Infinity"==n?1/0:n&&"object"==We(n)&&"TimeRanges"==n.__type__?e.simulateTimeRanges_(n):n&&"object"==We(n)&&"Uint8Array"==n.__type__?e.makeUint8Array_(n):n})}},{key:"unpackTimeRanges_",value:function(e){for(var t={__type__:"TimeRanges",length:e.length,start:[],end:[]},n=0;n<e.length;++n)t.start.push(e.start(n)),t.end.push(e.end(n));return t}},{key:"simulateTimeRanges_",value:function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}},{key:"unpackUint8Array_",value:function(e){return{__type__:"Uint8Array",entries:Array.from(e)}}},{key:"makeUint8Array_",value:function(e){return new Uint8Array(e.entries)}}],(n=null)&&qe(t.prototype,n),r&&qe(t,r),e}();function Ye(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ze.VideoEvents=["ended","play","playing","pause","pausing","ratechange","seeked","seeking","timeupdate","volumechange"],ze.VideoAttributes=["buffered","currentTime","duration","ended","loop","muted","paused","playbackRate","seeking","videoHeight","videoWidth","volume"],ze.VideoInitStateAttributes=["loop","playbackRate"],ze.VideoVoidMethods=["pause","play"],ze.PlayerEvents=["abrstatuschanged","adaptation","buffering","emsg","error","loading","streaming","texttrackvisibility","timelineregionadded","timelineregionenter","timelineregionexit","trackschanged","unloading","variantchanged","textchanged"],ze.PlayerGetterMethods={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},ze.PlayerGetterMethodsThatRequireLive={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},ze.PlayerInitState=[["getConfiguration","configure"]],ze.PlayerInitAfterLoadState=[["isTextTrackVisible","setTextTrackVisibility"]],ze.PlayerVoidMethods=["addTextTrack","cancelTrickPlay","configure","resetConfiguration","retryStreaming","selectAudioLanguage","selectEmbeddedTextTrack","selectTextLanguage","selectTextTrack","selectVariantTrack","setTextTrackVisibility","trickPlay"],ze.PlayerPromiseMethods=["attach","detach","load","unload"],ze.InitStateType,ze.SHAKA_MESSAGE_NAMESPACE="urn:x-cast:com.google.shaka.v2",ze.GENERIC_MESSAGE_NAMESPACE="urn:x-cast:com.google.cast.media";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $e=window.shaka,Qe=function(){function e(t,n,r,i,a,s){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.receiverAppId_=t,this.statusChangeTimer_=new H(n),this.onFirstCastStateUpdate_=r,this.hasJoinedExistingSession_=!1,this.onRemoteEvent_=i,this.onResumeLocal_=a,this.onInitStateRequired_=s,this.apiReady_=!1,this.isCasting_=!1,this.receiverName_="",this.appData_=null,this.onConnectionStatusChangedBound_=function(){return o.onConnectionStatusChanged_()},this.onMessageReceivedBound_=function(e,t){return o.onMessageReceived_(e,t)},this.cachedProperties_={video:{},player:{}},this.nextAsyncCallId_=0,this.asyncCallPromises_={},this.castPromise_=null,e.instances_.add(this)}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return e.instances_.delete(this),this.rejectAllPromises_(),e.session_&&this.removeListeners_(),this.statusChangeTimer_&&(this.statusChangeTimer_.stop(),this.statusChangeTimer_=null),this.onRemoteEvent_=null,this.onResumeLocal_=null,this.apiReady_=!1,this.isCasting_=!1,this.appData_=null,this.cachedProperties_=null,this.asyncCallPromises_=null,this.castPromise_=null,this.onConnectionStatusChangedBound_=null,this.onMessageReceivedBound_=null,Promise.resolve()}},{key:"apiReady",value:function(){return this.apiReady_}},{key:"hasReceivers",value:function(){return e.hasReceivers_}},{key:"isCasting",value:function(){return this.isCasting_}},{key:"receiverName",value:function(){return this.receiverName_}},{key:"hasRemoteProperties",value:function(){return 0!=Object.keys(this.cachedProperties_.video).length}},{key:"init",value:function(){var t=this;if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.apiReady_=!0,this.statusChangeTimer_.tickNow();var n=new chrome.cast.SessionRequest(this.receiverAppId_),r=new chrome.cast.ApiConfig(n,function(e){return t.onExistingSessionJoined_(e)},function(e){return t.onReceiverStatusChanged_(e)},"origin_scoped");chrome.cast.initialize(r,function(){$e.log.debug("CastSender: init")},function(e){$e.log.error("CastSender: init error",e)}),e.hasReceivers_&&this.statusChangeTimer_.tickAfter(e.STATUS_DELAY);var i=e.session_;i&&i.status!=chrome.cast.SessionStatus.STOPPED?($e.log.debug("CastSender: re-using existing connection"),this.onExistingSessionJoined_(i)):e.session_=null}}},{key:"setAppData",value:function(e){this.appData_=e,this.isCasting_&&this.sendMessage_({type:"appData",appData:this.appData_})}},{key:"cast",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(n){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.apiReady_){t.next=2;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.CAST_API_UNAVAILABLE);case 2:if(e.hasReceivers_){t.next=4;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.NO_CAST_RECEIVERS);case 4:if(!this.isCasting_){t.next=6;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.ALREADY_CASTING);case 6:return this.castPromise_=new A,chrome.cast.requestSession(function(e){return r.onSessionInitiated_(n,e)},function(e){return r.onConnectionError_(e)}),t.next=10,this.castPromise_;case 10:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){Ye(a,r,i,s,o,"next",e)}function o(e){Ye(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return n.apply(this,arguments)}}()},{key:"showDisconnectDialog",value:function(){var e=this;if(this.isCasting_){var t=this.onInitStateRequired_();chrome.cast.requestSession(function(n){return e.onSessionInitiated_(t,n)},function(t){return e.onConnectionError_(t)})}}},{key:"forceDisconnect",value:function(){this.isCasting_&&(this.rejectAllPromises_(),e.session_&&(this.removeListeners_(),e.session_.stop(function(){},function(){}),e.session_=null))}},{key:"get",value:function(e,t){var n=this;window.asserts.assert("video"==e||"player"==e,"Unexpected target name");var r=r;if("video"==e){if(r.VideoVoidMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteCall_.apply(n,[e,t].concat(i))}}else if("player"==e){if(r.PlayerGetterMethodsThatRequireLive[t]){var i=this.get("player","isLive")();if(window.asserts.assert(i,t+" should be called on a live stream!"),!i)return function(){}}if(r.PlayerVoidMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteCall_.apply(n,[e,t].concat(i))};if(r.PlayerPromiseMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteAsyncCall_.apply(n,[e,t].concat(i))};if(r.PlayerGetterMethods[t])return function(){return n.propertyGetter_(e,t)}}return this.propertyGetter_(e,t)}},{key:"set",value:function(e,t,n){window.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]=n,this.sendMessage_({type:"set",targetName:e,property:t,value:n})}},{key:"onSessionInitiated_",value:function(e,t){$e.log.debug("CastSender: onSessionInitiated"),this.onSessionCreated_(t),this.sendMessage_({type:"init",initState:e,appData:this.appData_}),this.castPromise_.resolve()}},{key:"onConnectionError_",value:function(e){var t=Error.Code.UNEXPECTED_CAST_ERROR;switch(e.code){case"cancel":t=Error.Code.CAST_CANCELED_BY_USER;break;case"timeout":t=Error.Code.CAST_CONNECTION_TIMED_OUT;break;case"receiver_unavailable":t=Error.Code.CAST_RECEIVER_APP_UNAVAILABLE}this.castPromise_.reject(new Error(Error.Severity.CRITICAL,Error.Category.CAST,t,e))}},{key:"propertyGetter_",value:function(e,t){return window.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]}},{key:"remoteCall_",value:function(e,t){window.asserts.assert("video"==e||"player"==e,"Unexpected target name");for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];this.sendMessage_({type:"call",targetName:e,methodName:t,args:r})}},{key:"remoteAsyncCall_",value:function(e,t){window.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=new A,r=this.nextAsyncCallId_.toString();this.nextAsyncCallId_++,this.asyncCallPromises_[r]=n;for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];return this.sendMessage_({type:"asyncCall",targetName:e,methodName:t,args:a,id:r}),n}},{key:"onExistingSessionJoined_",value:function(e){$e.log.debug("CastSender: onExistingSessionJoined");var t=this.onInitStateRequired_();this.castPromise_=new A,this.hasJoinedExistingSession_=!0,this.onSessionInitiated_(t,e)}},{key:"onReceiverStatusChanged_",value:function(t){$e.log.debug("CastSender: receiver status",t),e.hasReceivers_="available"==t,this.statusChangeTimer_.tickNow()}},{key:"onSessionCreated_",value:function(t){e.session_=t,t.addUpdateListener(this.onConnectionStatusChangedBound_),t.addMessageListener(CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_),this.onConnectionStatusChanged_()}},{key:"removeListeners_",value:function(){var t=e.session_;t.removeUpdateListener(this.onConnectionStatusChangedBound_),t.removeMessageListener(CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_)}},{key:"onConnectionStatusChanged_",value:function(){var t=!!e.session_&&"connected"==e.session_.status;if($e.log.debug("CastSender: connection status",t),this.isCasting_&&!t){for(var n in this.onResumeLocal_(),this.cachedProperties_)this.cachedProperties_[n]={};this.rejectAllPromises_()}this.isCasting_=t,this.receiverName_=t?e.session_.receiver.friendlyName:"",this.statusChangeTimer_.tickNow()}},{key:"rejectAllPromises_",value:function(){for(var e in this.asyncCallPromises_){var t=this.asyncCallPromises_[e];delete this.asyncCallPromises_[e],t.reject(new Error(Error.Severity.RECOVERABLE,Error.Category.PLAYER,Error.Code.LOAD_INTERRUPTED))}}},{key:"onMessageReceived_",value:function(e,t){var n=CastUtils.deserialize(t);switch($e.log.v2("CastSender: message",n),n.type){case"event":var r=n.targetName,i=n.event,a=new w(i.type,i);this.onRemoteEvent_(r,a);break;case"update":var s=n.update;for(var o in s){var l=this.cachedProperties_[o]||{};for(var u in s[o])l[u]=s[o][u]}this.hasJoinedExistingSession_&&(this.onFirstCastStateUpdate_(),this.hasJoinedExistingSession_=!1);break;case"asyncComplete":var c=n.id,d=n.error,h=this.asyncCallPromises_[c];if(delete this.asyncCallPromises_[c],window.asserts.assert(h,"Unexpected async id"),!h)break;if(d){var f=new Error(d.severity,d.category,d.code);for(var p in d)f[p]=d[p];h.reject(f)}else h.resolve()}}},{key:"sendMessage_",value:function(t){var n=CastUtils.serialize(t);e.session_.sendMessage(CastUtils.SHAKA_MESSAGE_NAMESPACE,n,function(){},$e.log.error)}}])&&Xe(t.prototype,n),r&&Xe(t,r),e}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function et(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Je(a,r,i,s,o,"next",e)}function o(e){Je(a,r,i,s,o,"throw",e)}s(void 0)})}}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qe.STATUS_DELAY=.02,Qe.hasReceivers_=!1,Qe.session_=null,Qe.instances_=new Set,Qe.onSdkLoaded_=function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Qe.instances_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.init()}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},window.__onGCastApiAvailable=Qe.onSdkLoaded_;var at=window.shaka,st=(window.goog,function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=nt(this,rt(t).call(this))).localVideo_=e,i.localPlayer_=n,i.videoProxy_=null,i.playerProxy_=null,i.videoEventTarget_=null,i.playerEventTarget_=null,i.eventManager_=null,i.receiverAppId_=r,i.receiverAppId_&&(i.sender_=new Qe(r,function(){return i.onCastStatusChanged_()},function(){return i.onFirstCastStateUpdate_()},function(e,t){return i.onRemoteEvent_(e,t)},function(){return i.onResumeLocal_()},function(){return i.getInitState_()})),i.init_(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(t,C),n=t,(r=[{key:"destroy",value:function(e){e&&this.sender_&&this.sender_.forceDisconnect(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null);var t=[];return this.localPlayer_&&(t.push(this.localPlayer_.destroy()),this.localPlayer_=null),this.sender_&&(t.push(this.sender_.destroy()),this.sender_=null),this.localVideo_=null,this.videoProxy_=null,this.playerProxy_=null,Promise.all(t)}},{key:"getVideo",value:function(){return this.videoProxy_}},{key:"getPlayer",value:function(){return this.playerProxy_}},{key:"canCast",value:function(){return!!this.sender_&&(this.sender_.apiReady()&&this.sender_.hasReceivers())}},{key:"isCasting",value:function(){return!!this.sender_&&this.sender_.isCasting()}},{key:"receiverName",value:function(){return this.sender_?this.sender_.receiverName():""}},{key:"cast",value:function(){var e=et(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender_){e.next=2;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.CAST_RECEIVER_APP_ID_MISSING);case 2:return t=this.getInitState_(),e.next=5,this.sender_.cast(t);case 5:if(this.localPlayer_){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.localPlayer_.unload();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setAppData",value:function(e){this.sender_&&this.sender_.setAppData(e)}},{key:"suggestDisconnect",value:function(){this.sender_&&this.sender_.showDisconnectDialog()}},{key:"forceDisconnect",value:function(){this.sender_&&this.sender_.forceDisconnect()}},{key:"changeReceiverId",value:function(){var e=et(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!=this.receiverAppId_){e.next=2;break}return e.abrupt("return");case 2:if(this.receiverAppId_=t,!this.sender_){e.next=8;break}return this.sender_.forceDisconnect(),e.next=7,this.sender_.destroy();case 7:this.sender_=null;case 8:this.sender_=new Qe(t,function(){return n.onCastStatusChanged_()},function(){return n.onFirstCastStateUpdate_()},function(e,t){return n.onRemoteEvent_(e,t)},function(){return n.onResumeLocal_()},function(){return n.getInitState_()}),this.sender_.init();case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"init_",value:function(){var e=this;this.sender_&&this.sender_.init(),this.eventManager_=new Ke;var t=!0,n=!1,r=void 0;try{for(var i,a=ze.VideoEvents[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.eventManager_.listen(this.localVideo_,s,function(t){return e.videoProxyLocalEvent_(t)})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,l=!1,u=void 0;try{for(var c,d=ze.PlayerEvents[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;this.eventManager_.listen(this.localPlayer_,h,function(t){return e.playerProxyLocalEvent_(t)})}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}this.videoProxy_={};var f=function(t){Object.defineProperty(e.videoProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.videoProxyGet_(t)},set:function(n){return e.videoProxySet_(t,n)}})};for(var p in this.localVideo_)f(p);this.playerProxy_={},this.iterateOverPlayerMethods_(function(t,n){window.asserts.assert(e.playerProxy_,"Must have player proxy!"),Object.defineProperty(e.playerProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.playerProxyGet_(t)}})}),this.videoEventTarget_=new C,this.videoEventTarget_.dispatchTarget=this.videoProxy_,this.playerEventTarget_=new C,this.playerEventTarget_.dispatchTarget=this.playerProxy_}},{key:"iterateOverPlayerMethods_",value:function(e){window.asserts.assert(this.localPlayer_,"Must have player!");var t=this.localPlayer_,n=new Set;for(var r in t)n.has(r)||(n.add(r),e(r,t[r]));for(var i=Object.getPrototypeOf(t),a=Object.getPrototypeOf({});i&&i!=a;){var s=!0,o=!1,l=void 0;try{for(var u,c=Object.getOwnPropertyNames(i)[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;if(!d.endsWith("_")&&"constructor"!=d){var h=t[d];"function"==typeof h&&(n.has(d)||(n.add(d),e(d,h)))}}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}i=Object.getPrototypeOf(i)}}},{key:"getInitState_",value:function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.localPlayer_.getAssetUri(),startTime:null};this.localVideo_.pause();var t=!0,n=!1,r=void 0;try{for(var i,a=ze.VideoInitStateAttributes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.video[s]=this.localVideo_[s]}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.localVideo_.ended||(e.startTime=this.localVideo_.currentTime);var o=!0,l=!1,u=void 0;try{for(var c,d=ze.PlayerInitState[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=h[0],p=h[1],m=this.localPlayer_[f]();e.player[p]=m}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}var v=!0,g=!1,y=void 0;try{for(var _,w=ze.PlayerInitAfterLoadState[Symbol.iterator]();!(v=(_=w.next()).done);v=!0){var E=_.value,b=E[0],S=E[1],T=this.localPlayer_[b]();e.playerAfterLoad[S]=T}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}return e}},{key:"onCastStatusChanged_",value:function(){var e=new w("caststatuschanged");this.dispatchEvent(e)}},{key:"onFirstCastStateUpdate_",value:function(){var e=this.videoProxy_.paused?"pause":"play",t=new w(e);this.videoEventTarget_.dispatchEvent(t)}},{key:"onResumeLocal_",value:function(){var e=this;window.asserts.assert(this.sender_,"Cast sender should not be null!");var t=!0,n=!1,r=void 0;try{for(var i,a=ze.PlayerInitState[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s[0],l=s[1],u=this.sender_.get("player",o)();this.localPlayer_[l](u)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var c=this.sender_.get("player","getAssetUri")(),d=this.sender_.get("video","ended"),h=Promise.resolve(),f=this.localVideo_.autoplay,p=null;d||(p=this.sender_.get("video","currentTime")),c&&(this.localVideo_.autoplay=!1,h=this.localPlayer_.load(c,p));var m={},v=!0,g=!1,y=void 0;try{for(var _,E=ze.VideoInitStateAttributes[Symbol.iterator]();!(v=(_=E.next()).done);v=!0){var b=_.value;m[b]=this.sender_.get("video",b)}}catch(e){g=!0,y=e}finally{try{v||null==E.return||E.return()}finally{if(g)throw y}}h.then(function(){if(e.localVideo_){var t=!0,n=!1,r=void 0;try{for(var i,a=ze.VideoInitStateAttributes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.localVideo_[s]=m[s]}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,l=!1,u=void 0;try{for(var d,h=ze.PlayerInitAfterLoadState[Symbol.iterator]();!(o=(d=h.next()).done);o=!0){var p=d.value,v=p[0],g=p[1],y=e.sender_.get("player",v)();e.localPlayer_[g](y)}}catch(e){l=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw u}}e.localVideo_.autoplay=f,c&&e.localVideo_.play()}},function(t){window.asserts.assert(t instanceof Error,"Wrong error type!");var n=new w("error",{detail:t});e.localPlayer_.dispatchEvent(n)})}},{key:"videoProxyGet_",value:function(e){var t=this;if("addEventListener"==e)return function(e,n,r){return t.videoEventTarget_.addEventListener(e,n,r)};if("removeEventListener"==e)return function(e,n,r){return t.videoEventTarget_.removeEventListener(e,n,r)};if(this.sender_&&this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()){var n=this.localVideo_[e];if("function"!=typeof n)return n}if(!this.sender_||!this.sender_.isCasting()){var r=this.localVideo_[e];return"function"==typeof r&&(r=r.bind(this.localVideo_)),r}return this.sender_.get("video",e)}},{key:"videoProxySet_",value:function(e,t){this.sender_&&this.sender_.isCasting()?this.sender_.set("video",e,t):this.localVideo_[e]=t}},{key:"videoProxyLocalEvent_",value:function(e){if(!this.sender_||!this.sender_.isCasting()){var t=new w(e.type,e);this.videoEventTarget_.dispatchEvent(t)}}},{key:"playerProxyGet_",value:function(e){var t=this;if("addEventListener"==e)return function(e,n,r){return t.playerEventTarget_.addEventListener(e,n,r)};if("removeEventListener"==e)return function(e,n,r){return t.playerEventTarget_.removeEventListener(e,n,r)};if("getMediaElement"==e)return function(){return t.videoProxy_};if("getSharedConfiguration"==e)return at.log.warning("Can't share configuration across a network. Returning copy."),this.sender_?this.sender_.get("player","getConfiguration"):this.localPlayer_.getConfiguration();if("getNetworkingEngine"==e)return this.sender_.isCasting()&&at.log.warning("NOTE: getNetworkingEngine() is always local!"),function(){return t.localPlayer_.getNetworkingEngine()};if(this.sender_&&this.sender_.isCasting()){if("getManifest"==e||"drmInfo"==e)return function(){return at.log.alwaysWarn(e+"() does not work while casting!"),null};if("getManifestUri"==e)return at.Deprecate.deprecateFeature(2,6,"getManifestUri",'Please use "getAssetUri" instead.'),this.playerProxyGet_("getAssetUri");if("attach"==e||"detach"==e)return function(){return at.log.alwaysWarn(e+"() does not work while casting!"),Promise.resolve()}}if(this.sender_&&this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()&&ze.PlayerGetterMethods[e]){var n=this.localPlayer_[e];return window.asserts.assert("function"==typeof n,"only methods on Player"),n.bind(this.localPlayer_)}if(!this.sender_||!this.sender_.isCasting()){var r=this.localPlayer_[e];return window.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_)}return this.sender_.get("player",e)}},{key:"playerProxyLocalEvent_",value:function(e){this.sender_&&this.sender_.isCasting()||this.playerEventTarget_.dispatchEvent(e)}},{key:"onRemoteEvent_",value:function(e,t){window.asserts.assert(this.sender_&&this.sender_.isCasting(),"Should only receive remote events while casting"),this.sender_.isCasting()&&("video"==e?this.videoEventTarget_.dispatchEvent(t):"player"==e&&this.playerEventTarget_.dispatchEvent(t))}}])&&tt(n.prototype,r),i&&tt(n,i),t}());function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lt(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e,t){return!t||"object"!==ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka=window.shaka||{};var ft=window.shaka;window.goog=window.goog||{};window.goog;var pt=function(e){function t(e,n,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=ct(this,dt(t).call(this))).enabled_=!0,a.overrideCssShowControls_=!1,a.config_=i,a.castProxy_=new st(r,e,a.config_.castReceiverAppId),a.castAllowed_=!0,a.video_=a.castProxy_.getVideo(),a.localVideo_=r,a.player_=a.castProxy_.getPlayer(),a.localPlayer_=e,a.videoContainer_=n,a.isSeeking_=!1,a.seekTimer_=new H(function(){window.asserts.assert(null!=a.seekBar_,"Seekbar should not be null!"),a.video_.currentTime=parseFloat(a.seekBar_.value)}),a.mouseStillTimer_=new H(function(){a.onMouseStill_()}),a.hideSettingsMenusTimer_=new H(function(){var e,t=!0,n=!1,r=void 0;try{for(var i,s=a.settingsMenus_[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;e=o,Be.setDisplay(e,!1)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}),a.timeAndSeekRangeTimer_=new H(function(){a.updateTimeAndSeekRange_()}),a.lastTouchEventTime_=null,a.elements_=[],a.localization_=t.createLocalization_(),a.eventManager_=new Ke,a.configure(a.config_),a.updateLocalizedStrings_(),a.pressedKeys_=new Set,a.onCastStatusChange_(),a.timeAndSeekRangeTimer_.tickEvery(.125),a}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,C),n=t,r=[{key:"destroy",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.seekTimer_&&(this.seekTimer_.stop(),this.seekTimer_=null),this.mouseStillTimer_&&(this.mouseStillTimer_.stop(),this.mouseStillTimer_=null),this.hideSettingsMenusTimer_&&(this.hideSettingsMenusTimer_.stop(),this.hideSettingsMenusTimer_=null),this.timeAndSeekRangeTimer_&&(this.timeAndSeekRangeTimer_.stop(),this.timeAndSeekRangeTimer_=null),!this.castProxy_){e.next=9;break}return e.next=8,this.castProxy_.destroy();case 8:this.castProxy_=null;case 9:if(!this.localPlayer_){e.next=13;break}return e.next=12,this.localPlayer_.destroy();case 12:this.localPlayer_=null;case 13:return this.player_=null,this.localVideo_=null,this.video_=null,this.localization_=null,this.pressedKeys_.clear(),e.next=20,Promise.all(this.elements_.map(function(e){return e.destroy()}));case 20:this.elements_=[];case 21:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){lt(a,r,i,s,o,"next",e)}function o(e){lt(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"allowCast",value:function(e){this.castAllowed_=e,this.onCastStatusChange_()}},{key:"loadComplete",value:function(){this.onPlayStateChange_()}},{key:"configure",value:function(e){this.config_=e,this.castProxy_.changeReceiverId(e.castReceiverAppId),this.controlsContainer_?(Ue.removeAllChildren(this.controlsContainer_),this.videoContainer_.removeChild(this.spinnerContainer_)):this.addControlsContainer_(),this.createDOM_(),this.addEventListeners_()}},{key:"setEnabledShakaControls",value:function(e){this.enabled_=e,e?(Be.setDisplay(this.controlsContainer_,!0),Be.setDisplay(this.spinnerContainer_,this.player_.isBuffering()),this.video_.tabIndex=-1,this.video_.controls=!1):(Be.setDisplay(this.controlsContainer_,!1),Be.setDisplay(this.spinnerContainer_,!1)),this.onPlayStateChange_()}},{key:"setEnabledNativeControls",value:function(e){this.video_.controls=e,this.video_.tabIndex=e?0:-1,e&&this.setEnabledShakaControls(!1)}},{key:"getCastProxy",value:function(){return this.castProxy_}},{key:"getLocalization",value:function(){return this.localization_}},{key:"getVideoContainer",value:function(){return this.videoContainer_}},{key:"getVideo",value:function(){return this.video_}},{key:"getLocalVideo",value:function(){return this.localVideo_}},{key:"getPlayer",value:function(){return this.player_}},{key:"getLocalPlayer",value:function(){return this.localPlayer_}},{key:"getControlsContainer",value:function(){return this.controlsContainer_}},{key:"getConfig",value:function(){return this.config_}},{key:"isSeeking",value:function(){return this.isSeeking_}},{key:"isCastAllowed",value:function(){return this.castAllowed_}},{key:"getDisplayTime",value:function(){return this.isSeeking_?Number(this.seekBar_.value):Number(this.video_.currentTime)}},{key:"setLastTouchEventTime",value:function(e){this.lastTouchEventTime_=e}},{key:"overrideCssShowControls",value:function(){this.overrideCssShowControls_=!0}},{key:"anySettingsMenusAreOpen",value:function(){return this.settingsMenus_.some(function(e){return e.classList.contains("shaka-displayed")})}},{key:"hideSettingsMenus",value:function(){this.hideSettingsMenusTimer_.tickNow()}},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.seekBar_&&this.seekBar_.setAttribute(we.ARIA_LABEL,this.localization_.resolve(e.SEEK));var t=this.video_.paused&&!this.isSeeking_?e.PLAY:e.PAUSE;this.playButton_.setAttribute(we.ARIA_LABEL,this.localization_.resolve(t))}},{key:"createDOM_",value:function(){if(this.seekBarContainer_=null,this.seekBar_=null,this.videoContainer_.classList.add("shaka-video-container"),this.video_.classList.add("shaka-video"),this.addPlayButton_(),this.addBufferingSpinner_(),this.addControlsButtonPanel_(),this.config_.addSeekBar&&this.addSeekBar_(),this.settingsMenus_=Array.from(this.videoContainer_.getElementsByClassName("shaka-settings-menu")),!this.seekBar_){var e=!0,t=!1,n=void 0;try{for(var r,i=this.settingsMenus_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.classList.add("shaka-low-position")}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}},{key:"addControlsContainer_",value:function(){var e=this;this.controlsContainer_=Ue.createHTMLElement("div"),this.controlsContainer_.classList.add("shaka-controls-container"),this.videoContainer_.appendChild(this.controlsContainer_),this.eventManager_.listen(this.controlsContainer_,"touchstart",function(t){e.onContainerTouch_(t)},{passive:!1}),this.eventManager_.listen(this.controlsContainer_,"click",function(){e.onContainerClick_()})}},{key:"addPlayButton_",value:function(){this.playButtonContainer_=Ue.createHTMLElement("div"),this.playButtonContainer_.classList.add("shaka-play-button-container"),this.controlsContainer_.appendChild(this.playButtonContainer_),this.playButton_=Ue.createHTMLElement("button"),this.playButton_.classList.add("shaka-play-button"),this.playButtonContainer_.appendChild(this.playButton_),this.onPlayStateChange_()}},{key:"addBufferingSpinner_",value:function(){this.spinnerContainer_=Ue.createHTMLElement("div"),this.spinnerContainer_.classList.add("shaka-spinner-container"),this.videoContainer_.appendChild(this.spinnerContainer_);var e=Ue.createHTMLElement("div");e.classList.add("shaka-spinner"),this.spinnerContainer_.appendChild(e);var t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("class","shaka-spinner-svg"),n.setAttribute("viewBox","0 0 30 30"),e.appendChild(n);var r=document.createElementNS(t,"circle");r.setAttribute("class","shaka-spinner-path"),r.setAttribute("cx","15"),r.setAttribute("cy","15"),r.setAttribute("r","14.5"),r.setAttribute("fill","none"),r.setAttribute("stroke-width","1"),r.setAttribute("stroke-miterlimit","10"),n.appendChild(r)}},{key:"addControlsButtonPanel_",value:function(){this.bottomControls_=Ue.createHTMLElement("div"),this.bottomControls_.classList.add("shaka-bottom-controls"),this.controlsContainer_.appendChild(this.bottomControls_),this.controlsButtonPanel_=Ue.createHTMLElement("div"),this.controlsButtonPanel_.classList.add("shaka-controls-button-panel"),this.controlsButtonPanel_.classList.add("shaka-no-propagation"),this.controlsButtonPanel_.classList.add("shaka-show-controls-on-mouse-over"),this.bottomControls_.appendChild(this.controlsButtonPanel_);for(var e=0;e<this.config_.controlPanelElements.length;e++){var t=this.config_.controlPanelElements[e];if(mt.elementNamesToFactories_.get(t)){var n=mt.elementNamesToFactories_.get(t);this.elements_.push(n.create(this.controlsButtonPanel_,this))}else ft.log.alwaysWarn("Unrecognized control panel element requested:",t)}}},{key:"addEventListeners_",value:function(){var e=this;this.eventManager_.listen(this.player_,"buffering",function(){e.onBufferingStateChange_()}),this.onBufferingStateChange_(),this.eventManager_.listen(window,"keydown",function(t){return e.onKeyDown_(t)}),this.eventManager_.listen(this.video_,"play",function(){e.onPlayStateChange_()}),this.eventManager_.listen(this.video_,"pause",function(){e.onPlayStateChange_()}),this.eventManager_.listen(this.video_,"ended",function(){e.onPlayStateChange_()}),this.seekBar_&&(this.eventManager_.listen(this.seekBar_,"mousedown",function(){e.onSeekStart_()}),this.eventManager_.listen(this.seekBar_,"touchstart",function(){e.onSeekStart_()},{passive:!0}),this.eventManager_.listen(this.seekBar_,"input",function(){e.onSeekInput_()}),this.eventManager_.listen(this.seekBar_,"touchend",function(){e.onSeekEnd_()}),this.eventManager_.listen(this.seekBar_,"mouseup",function(){e.onSeekEnd_()}));var t=this.videoContainer_.getElementsByClassName("shaka-no-propagation"),n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;this.eventManager_.listen(o,"click",function(e){e.stopPropagation()})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var l=this.videoContainer_.getElementsByClassName("shaka-show-controls-on-mouse-over"),u=!0,c=!1,d=void 0;try{for(var h,f=l[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;this.eventManager_.listen(p,"mouseover",function(){e.overrideCssShowControls_=!0}),this.eventManager_.listen(p,"mouseleave",function(){e.overrideCssShowControls_=!1})}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}this.eventManager_.listen(this.videoContainer_,"mousemove",function(t){e.onMouseMove_(t)}),this.eventManager_.listen(this.videoContainer_,"touchmove",function(t){e.onMouseMove_(t)},{passive:!0}),this.eventManager_.listen(this.videoContainer_,"touchend",function(t){e.onMouseMove_(t)},{passive:!0}),this.eventManager_.listen(this.videoContainer_,"mouseleave",function(){e.onMouseLeave_()}),this.eventManager_.listen(this.controlsButtonPanel_,"click",function(){e.hideSettingsMenus()}),this.eventManager_.listen(this.castProxy_,"caststatuschanged",function(){e.onCastStatusChange_()}),this.eventManager_.listen(this.videoContainer_,"keyup",function(t){e.onKeyUp_(t)}),this.eventManager_.listen(this.localization_,Pe.LOCALE_UPDATED,function(t){return e.updateLocalizedStrings_()}),this.eventManager_.listen(this.localization_,Pe.LOCALE_CHANGED,function(t){return e.updateLocalizedStrings_()})}},{key:"addSeekBar_",value:function(){this.seekBarContainer_=Ue.createHTMLElement("div"),this.seekBarContainer_.classList.add("shaka-seek-bar-container"),this.seekBar_=document.createElement("input"),this.seekBar_.classList.add("shaka-seek-bar"),this.seekBar_.type="range",this.seekBar_.setAttribute("step","any"),this.seekBar_.setAttribute("min","0"),this.seekBar_.setAttribute("max","1"),this.seekBar_.value="0",this.seekBar_.classList.add("shaka-no-propagation"),this.seekBar_.classList.add("shaka-show-controls-on-mouse-over"),this.seekBarContainer_.appendChild(this.seekBar_),this.bottomControls_.appendChild(this.seekBarContainer_)}},{key:"onMouseMove_",value:function(e){"mousemove"==e.type&&this.controlsContainer_.classList.remove("shaka-keyboard-navigation"),"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"keyup"==e.type?this.lastTouchEventTime_=Date.now():this.lastTouchEventTime_+1e3<Date.now()&&(this.lastTouchEventTime_=null),this.lastTouchEventTime_&&"mousemove"==e.type||(this.videoContainer_.style.cursor="",this.hideSettingsMenusTimer_.stop(),this.setControlsOpacity_(be.Opacity.OPAQUE),this.updateTimeAndSeekRange_(),this.mouseStillTimer_.stop(),"touchend"!=e.type&&"keyup"!=e.type&&this.lastTouchEventTime_||this.mouseStillTimer_.tickAfter(3))}},{key:"onMouseLeave_",value:function(){this.lastTouchEventTime_||this.mouseStillTimer_.tickNow()}},{key:"onMouseStill_",value:function(){this.videoContainer_.style.cursor="none",this.video_.paused&&!this.isSeeking_||this.overrideCssShowControls_?this.setControlsOpacity_(be.Opacity.OPAQUE):this.setControlsOpacity_(be.Opacity.TRANSPARENT)}},{key:"onContainerTouch_",value:function(e){this.video_.duration&&(this.isOpaque_()?this.lastTouchEventTime_=Date.now():(this.onMouseMove_(e),e.preventDefault()))}},{key:"onContainerClick_",value:function(){this.enabled_&&(this.anySettingsMenusAreOpen()?this.hideSettingsMenusTimer_.tickNow():this.onPlayPauseClick_())}},{key:"onPlayPauseClick_",value:function(){this.enabled_&&this.video_.duration&&(this.player_.cancelTrickPlay(),this.video_.paused?this.video_.play():this.video_.pause())}},{key:"onCastStatusChange_",value:function(){var e=this.castProxy_.isCasting();this.dispatchEvent(new w("caststatuschanged",{newStatus:e})),e?this.controlsContainer_.setAttribute("casting","true"):this.controlsContainer_.removeAttribute("casting")}},{key:"onPlayStateChange_",value:function(){this.video_.ended&&!this.video_.paused&&this.video_.pause(),this.enabled_&&this.video_.paused&&!this.isSeeking_?(this.playButton_.setAttribute("icon","play"),this.playButton_.setAttribute(we.ARIA_LABEL,this.localization_.resolve(Te.Ids.PLAY))):(this.playButton_.setAttribute("icon","pause"),this.playButton_.setAttribute(we.ARIA_LABEL,this.localization_.resolve(Te.Ids.PAUSE)))}},{key:"onSeekStart_",value:function(){this.enabled_&&(this.isSeeking_=!0,this.video_.pause())}},{key:"onSeekInput_",value:function(){this.enabled_&&this.video_.duration&&(this.updateTimeAndSeekRange_(),this.seekTimer_.tickAfter(.125))}},{key:"onSeekEnd_",value:function(){this.enabled_&&(this.seekTimer_.tickNow(),this.isSeeking_=!1,this.video_.play())}},{key:"onKeyUp_",value:function(e){var t=e.key,n=document.activeElement,r=!(!n||!n.classList)&&n.classList.contains("shaka-volume-bar"),i=n&&n.classList&&n.classList.contains("shaka-seek-bar");switch(this.controlsContainer_.contains(n)&&this.onMouseMove_(e),this.pressedKeys_.delete(e.keyCode),t){case"ArrowLeft":r||this.seek_(this.video_.currentTime-5,e);break;case"ArrowRight":r||this.seek_(this.video_.currentTime+5,e);break;case"Home":this.seek_(this.player_.seekRange().start,e);break;case"End":this.seek_(this.player_.seekRange().end,e);break;case" ":i&&this.onPlayPauseClick_()}}},{key:"onBufferingStateChange_",value:function(){this.enabled_&&Be.setDisplay(this.spinnerContainer_,this.player_.isBuffering())}},{key:"isOpaque_",value:function(){return!!this.enabled_&&(!(!this.castProxy_||!this.castProxy_.isCasting())||null!=this.controlsContainer_.getAttribute("shown"))}},{key:"seek_",value:function(e,t){this.video_.currentTime=e,this.updateTimeAndSeekRange_()}},{key:"updateTimeAndSeekRange_",value:function(){if(this.isOpaque_()){var e=this.isSeeking_?Number(this.seekBar_.value):Number(this.video_.currentTime),t=this.video_.buffered.length,n=t?this.video_.buffered.start(0):0,r=t?this.video_.buffered.end(t-1):0,i=this.player_.seekRange(),a=i.end-i.start;if(this.seekBar_&&(this.seekBar_.min=i.start,this.seekBar_.max=i.end),this.player_.isLive()){var s=Math.floor(i.end-e);e=Math.max(0,s),!this.isSeeking_&&this.seekBar_&&(this.seekBar_.value=i.end-e)}else!this.isSeeking_&&this.seekBar_&&(this.seekBar_.value=e);if(this.seekBar_){var o=this.player_.seekRange();if(o.end-o.start<we.MIN_SEEK_WINDOW_TO_SHOW_SEEKBAR){Be.setDisplay(this.seekBarContainer_,!1);var l=!0,u=!1,c=void 0;try{for(var d,h=this.settingsMenus_[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){d.value.classList.add("shaka-low-position")}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}else{Be.setDisplay(this.seekBarContainer_,!0);var f=!0,p=!1,m=void 0;try{for(var v,g=this.settingsMenus_[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){v.value.classList.remove("shaka-low-position")}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}var y=["to right"];if(0==t)y.push("#000 0%");else{var _=Math.max(n,o.start),E=Math.min(r,o.end),b=(_-o.start)/a||0,S=(E-o.start)/a||0,T=(e-o.start)/a||0;y.push(we.SEEK_BAR_BASE_COLOR+" "+100*b+"%"),y.push(we.SEEK_BAR_PLAYED_COLOR+" "+100*b+"%"),y.push(we.SEEK_BAR_PLAYED_COLOR+" "+100*T+"%"),y.push(we.SEEK_BAR_BUFFERED_COLOR+" "+100*T+"%"),y.push(we.SEEK_BAR_BUFFERED_COLOR+" "+100*S+"%"),y.push(we.SEEK_BAR_BASE_COLOR+" "+100*S+"%")}this.seekBarContainer_.style.background="linear-gradient("+y.join(",")+")"}}this.dispatchEvent(new w("timeandseekrangeupdated"))}}},{key:"onKeyDown_",value:function(e){var t=this;this.pressedKeys_.add(e.keyCode);var n=this.anySettingsMenusAreOpen();e.keyCode==we.KEYCODE_TAB&&(this.controlsContainer_.classList.add("shaka-keyboard-navigation"),this.eventManager_.listen(window,"mousedown",function(){return t.onMouseDown_()})),e.keyCode==we.KEYCODE_ESCAPE&&this.hideSettingsMenusTimer_.tickNow(),n&&this.pressedKeys_.has(we.KEYCODE_TAB)&&this.keepFocusInMenu_(e)}},{key:"keepFocusInMenu_",value:function(e){var t=this.settingsMenus_.filter(function(e){return e.classList.contains("shaka-displayed")})[0];if(t.childNodes.length){for(var n=t.firstElementChild;n&&n.classList.contains("shaka-hidden");)n=n.nextElementSibling;for(var r=t.lastElementChild;r&&r.classList.contains("shaka-hidden");)r=r.previousElementSibling;var i=document.activeElement;this.pressedKeys_.has(we.KEYCODE_SHIFT)?i==n&&(e.preventDefault(),r.focus()):i==r&&(e.preventDefault(),n.focus())}}},{key:"onMouseDown_",value:function(){var e=this;this.eventManager_.unlisten(window,"mousedown"),this.eventManager_.listen(window,"keydown",function(t){return e.onKeyDown_(t)})}},{key:"setControlsOpacity_",value:function(e){e==be.Opacity.OPAQUE?this.controlsContainer_.setAttribute("shown","true"):(this.controlsContainer_.removeAttribute("shown"),this.hideSettingsMenusTimer_.tickAfter(2))}}],i=[{key:"registerElement",value:function(e,t){mt.elementNamesToFactories_.set(e,t)}},{key:"createLocalization_",value:function(){var e=new Pe("en");return Te.addTo(e),e.changeLocale(navigator.languages||[]),e}}],r&&ut(n.prototype,r),i&&ut(n,i),t}(),mt={};function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t,n){return t&&gt(e.prototype,t),n&&gt(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mt.elementNamesToFactories_=new Map;var _t=function(){function e(t,n){vt(this,e),this.parent=t,this.button_=document.createElement("button"),this.button_.classList.add("material-icons"),this.button_.classList.add("close-button"),this.button_.textContent="close",this.parent.appendChild(this.button_),this.button_.addEventListener("click",function(){document.fullscreenElement&&document.exitFullscreen(),document.pictureInPictureElement&&document.exitPictureInPicture(),Za.unload()})}return yt(e,[{key:"destroy",value:function(){return Promise.resolve()}}]),e}();function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}_t.Factory=function(){function e(){vt(this,e)}return yt(e,[{key:"create",value:function(e,t){return new _t(e,t)}}]),e}();
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bt=window.shaka,St=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"mergeConfigObjects",value:function(t,n,r,i,a){window.asserts.assert(t,"Destination config must not be null!");var s=a in i,o=!0;for(var l in n){var u=a+"."+l,c=s?i[a]:r[l];if(s||l in r)if(void 0===n[l])void 0===c||s?delete t[l]:t[l]=ObjectUtils.cloneObject(c);else if(c.constructor==Object&&n[l]&&n[l].constructor==Object){t[l]||(t[l]=ObjectUtils.cloneObject(c));var d=e.mergeConfigObjects(t[l],n[l],c,i,u);o=o&&d}else wt(n[l])!=wt(c)||null==n[l]||n[l].constructor!=c.constructor?(bt.log.error("Invalid config, wrong type for "+u),o=!1):"function"==typeof r[l]&&r[l].length!=n[l].length?(bt.log.warning("Invalid config, wrong number of arguments for "+u),t[l]=n[l]):t[l]=n[l];else bt.log.error("Invalid config, unrecognized key "+u),o=!1}return o}},{key:"convertToConfigObject",value:function(e,t){for(var n={},r=n,i=0,a=0;;){var s=e.indexOf(".",i);if(s<0)break;if(0==s||"\\"!=e[s-1]){var o=e.substring(a,s).replace(/\\\./g,".");r[o]={},r=r[o],a=s+1}i=s+1}return r[e.substring(a).replace(/\\\./g,".")]=t,n}}],(n=null)&&Et(t.prototype,n),r&&Et(t,r),e}());function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var kt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.asserts.assert(t>0,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/t),this.estimate_=0,this.totalWeight_=0}var t,n,r;return t=e,(n=[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e),r=t*(1-n)+n*this.estimate_;isNaN(r)||(this.estimate_=r,this.totalWeight_+=e)}},{key:"getEstimate",value:function(){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}}])&&Tt(t.prototype,n),r&&Tt(t,r),e}();function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var It=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fast_=new kt(2),this.slow_=new kt(5),this.bytesSampled_=0,this.minTotalBytes_=128e3,this.minBytes_=16e3}var t,n,r;return t=e,(n=[{key:"sample",value:function(e,t){if(!(t<this.minBytes_)){var n=8e3*t/e,r=e/1e3;this.bytesSampled_+=t,this.fast_.sample(r,n),this.slow_.sample(r,n)}}},{key:"getBandwidthEstimate",value:function(e){return this.bytesSampled_<this.minTotalBytes_?e:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}},{key:"hasGoodEstimate",value:function(){return this.bytesSampled_>=this.minTotalBytes_}}])&&Ct(t.prototype,n),r&&Ct(t,r),e}();function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lt=window.shaka,Rt=(window.goog,function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.destroyed_=!1,this.waitOnDestroy_=new A,this.onDestroy_=t}var t,n,r;return t=e,r=[{key:"destroyedError",value:function(e){return new Lt.util.Error(Lt.util.Error.Severity.CRITICAL,Lt.util.Error.Category.PLAYER,Lt.util.Error.Code.OBJECT_DESTROYED,e)}}],(n=[{key:"destroyed",value:function(){return this.destroyed_}},{key:"destroy",value:function(){var e=this;return this.destroyed_?this.waitOnDestroy_:(this.destroyed_=!0,this.onDestroy_().then(function(){e.waitOnDestroy_.resolve()},function(){e.waitOnDestroy_.resolve()}))}},{key:"ensureNotDestroyed",value:function(e){if(this.destroyed_)throw e&&e.code==Lt.util.Error.Code.OBJECT_DESTROYED?e:Lt.util.Destroyer.destroyedError(e)}}])&&At(t.prototype,n),r&&At(t,r),e}());function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"asMap",value:function(e){for(var t=new Map,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.set(i,e[i])}return t}},{key:"asObject",value:function(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}}],(n=null)&&xt(t.prototype,n),r&&xt(t,r),e}();function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Pt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getFullType",value:function(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}},{key:"getExtendedType",value:function(t){var n=[t.mimeType];return e.EXTENDED_MIME_PARAMETERS_.forEach(function(e,r){var i=t[r];i&&n.push(e+'="'+i+'"')}),n.join(";")}},{key:"splitCodecs",value:function(e){return e.split(",")}},{key:"getCodecBase",value:function(t){return e.getCodecParts_(t)[0]}},{key:"getCodecParts_",value:function(e){var t=e.split("."),n=t[0];return t.pop(),[n,t.join(".")]}}],(n=null)&&Mt(t.prototype,n),r&&Mt(t,r),e}();Pt.EXTENDED_MIME_PARAMETERS_=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),Pt.CLOSED_CAPTION_MIMETYPE="application/cea-608";var Ot=Pt;function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ut=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"supportsMediaSource",value:function(){return!!window.MediaSource&&!!MediaSource.isTypeSupported}},{key:"supportsMediaType",value:function(t){return""!=e.anyMediaElement_().canPlayType(t)}},{key:"isEdge",value:function(){return e.userAgentContains_("Edge/")}},{key:"isIE",value:function(){return e.userAgentContains_("Trident/")}},{key:"isTizen",value:function(){return e.userAgentContains_("Tizen")}},{key:"isTizen3",value:function(){return e.userAgentContains_("Tizen 3")}},{key:"isWebOS",value:function(){return e.userAgentContains_("Web0S")}},{key:"isChromecast",value:function(){return e.userAgentContains_("CrKey")}},{key:"isChrome",value:function(){return e.userAgentContains_("Chrome")&&!e.isEdge()}},{key:"isApple",value:function(){return!!navigator.vendor&&navigator.vendor.includes("Apple")}},{key:"isMobile",value:function(){return/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)}},{key:"userAgentContains_",value:function(e){return(navigator.userAgent||"").includes(e)}},{key:"anyMediaElement_",value:function(){return e.cachedMediaElement_?e.cachedMediaElement_:(e.cacheExpirationTimer_||(e.cacheExpirationTimer_=new H(function(){e.cachedMediaElement_=null})),e.cachedMediaElement_=document.querySelector("video")||document.querySelector("audio"),e.cachedMediaElement_||(e.cachedMediaElement_=document.createElement("video")),e.cacheExpirationTimer_.tickAfter(1),e.cachedMediaElement_)}}],(n=null)&&Dt(t.prototype,n),r&&Dt(t,r),e}();Ut.cacheExpirationTimer_=null,Ut.cachedMediaElement_=null;var Ft=Ut;function Bt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ht=window.shaka,Gt=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fromUTF8",value:function(t){if(!t)return"";var n=new Uint8Array(t);239==n[0]&&187==n[1]&&191==n[2]&&(n=n.subarray(3));var r=e.fromCharCode(n),i=escape(r);try{return decodeURIComponent(i)}catch(e){throw new Ht.util.Error(Ht.util.Error.Severity.CRITICAL,Ht.util.Error.Category.TEXT,Ht.util.Error.Code.BAD_ENCODING)}}},{key:"fromUTF16",value:function(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw Ht.log.error("Data has an incorrect length, must be even."),new Ht.util.Error(Ht.util.Error.Severity.CRITICAL,Ht.util.Error.Category.TEXT,Ht.util.Error.Code.BAD_ENCODING);var r;if(e instanceof ArrayBuffer)r=e;else{var i=new Uint8Array(e.byteLength);i.set(new Uint8Array(e)),r=i.buffer}for(var a=Math.floor(e.byteLength/2),s=new Uint16Array(a),o=new DataView(r),l=0;l<a;l++)s[l]=o.getUint16(2*l,t);return Ht.util.StringUtils.fromCharCode(s)}},{key:"fromBytesAutoDetect",value:function(e){var t=Ht.util.StringUtils,n=new Uint8Array(e);if(239==n[0]&&187==n[1]&&191==n[2])return t.fromUTF8(n);if(254==n[0]&&255==n[1])return t.fromUTF16(n.subarray(2),!1);if(255==n[0]&&254==n[1])return t.fromUTF16(n.subarray(2),!0);var r=function(e){return n.byteLength<=e||n[e]>=32&&n[e]<=126};if(Ht.log.debug("Unable to find byte-order-mark, making an educated guess."),0==n[0]&&0==n[2])return t.fromUTF16(e,!1);if(0==n[1]&&0==n[3])return t.fromUTF16(e,!0);if(r(0)&&r(1)&&r(2)&&r(3))return t.fromUTF8(e);throw new Ht.util.Error(Ht.util.Error.Severity.CRITICAL,Ht.util.Error.Category.TEXT,Ht.util.Error.Code.UNABLE_TO_DETECT_ENCODING)}},{key:"toUTF8",value:function(e){for(var t=encodeURIComponent(e),n=unescape(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r.buffer}},{key:"toUTF16",value:function(e,t){for(var n=new Uint8Array(2*e.length),r=new DataView(n.buffer),i=0;i<e.length;++i){var a=e.charCodeAt(i);r.setUint16(2*i,a,t)}return n.buffer}},{key:"fromCharCode",value:function(t){if(!e.fromCharCodeImpl_)for(var n=function(t){if(function(e){try{var t=new Uint8Array(e),n=String.fromCharCode.apply(String,Bt(t));return window.asserts.assert(n,"Should get value"),!0}catch(e){return!1}}(t))return e.fromCharCodeImpl_=function(e){for(var n="",r=0;r<e.length;r+=t){var i=e.subarray(r,r+t);n+=String.fromCharCode.apply(String,Bt(i))}return n},"break"},r=65536;r>0;r/=2){if("break"===n(r))break}return window.asserts.assert(e.fromCharCodeImpl_,"Unable to create a fromCharCode method"),e.fromCharCodeImpl_(t)}}],(n=null)&&Vt(t.prototype,n),r&&Vt(t,r),e}());function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Gt.fromCharCodeImpl_=null;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Kt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"toStandardBase64",value:function(e){var t=Gt.fromCharCode(e);return btoa(t)}},{key:"toBase64",value:function(t,n){n=null==n||n;var r=e.toStandardBase64(t).replace(/\+/g,"-").replace(/\//g,"_");return n?r:r.replace(/[=]*$/,"")}},{key:"fromBase64",value:function(e){for(var t=window.atob(e.replace(/-/g,"+").replace(/_/g,"/")),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}},{key:"fromHex",value:function(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=window.parseInt(e.substr(n,2),16);return t}},{key:"toHex",value:function(e){for(var t="",n=0;n<e.length;++n){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t}},{key:"equal",value:function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0}},{key:"concat",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)e+=n[i].length;for(var a=new Uint8Array(e),s=0,o=0;o<n.length;++o)a.set(n[o],s),s+=n[o].length;return a}},{key:"toDataView",value:function(e){return e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength)}}],(n=null)&&jt(t.prototype,n),r&&jt(t,r),e}();function Wt(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function qt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Wt(a,r,i,s,o,"next",e)}function o(e){Wt(a,r,i,s,o,"throw",e)}s(void 0)})}}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yt=new M,Xt=window.shaka,$t=(window.goog,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playerInterface_=t,this.supportedTypes_=new Set,this.mediaKeys_=null,this.video_=null,this.initialized_=!1,this.currentDrmInfo_=null,this.eventManager_=new Ke,this.activeSessions_=new Map,this.offlineSessionIds_=[],this.allSessionsLoaded_=new A,this.config_=null,this.onError_=function(e){n.allSessionsLoaded_.reject(e),t.onError(e)},this.keyStatusByKeyId_=new Map,this.announcedKeyStatusByKeyId_=new Map,this.keyStatusTimer_=new H(function(){return n.processKeyStatusChanges_()}),this.usePersistentLicenses_=!1,this.mediaKeyMessageEvents_=[],this.initialRequestsSent_=!1,this.expirationTimer_=new H(function(){n.pollExpiration_()}).tickEvery(1);this.allSessionsLoaded_.catch(function(){}),this.destroyer_=new Rt(function(){return n.destroyNow_()})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"destroyNow_",value:function(){var t=qt(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.eventManager_.release(),this.eventManager_=null,this.allSessionsLoaded_.reject(),this.expirationTimer_.stop(),this.expirationTimer_=null,this.keyStatusTimer_.stop(),this.keyStatusTimer_=null,n=Array.from(this.activeSessions_.keys()),this.activeSessions_.clear(),t.next=11,Promise.all(n.map(function(t){return Promise.resolve().then(qt(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Xt.log.v1("Closing session",t.sessionId),n.prev=1,n.next=4,e.closeSession_(t);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])})))}));case 11:if(!this.video_){t.next=21;break}return window.asserts.assert(!this.video_.src,"video src must be removed first!"),t.prev=13,t.next=16,this.video_.setMediaKeys(null);case 16:t.next=20;break;case 18:t.prev=18,t.t0=t.catch(13);case 20:this.video_=null;case 21:this.currentDrmInfo_=null,this.supportedTypes_.clear(),this.mediaKeys_=null,this.offlineSessionIds_=[],this.config_=null,this.onError_=function(){},this.playerInterface_=null;case 28:case"end":return t.stop()}},t,this,[[13,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"configure",value:function(e){this.config_=e}},{key:"initForStorage",value:function(e,t){return this.offlineSessionIds_=[],this.usePersistentLicenses_=t,this.init_(e)}},{key:"initForPlayback",value:function(e,t){return this.offlineSessionIds_=t,this.usePersistentLicenses_=t.length>0,this.init_(e)}},{key:"initForRemoval",value:function(e,t,n,r,i){var a=new Map;return a.set(e,{audioCapabilities:r,videoCapabilities:i,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e,drmInfos:[{keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:n,initData:null,keyIds:null}]}),this.queryMediaKeys_(a)}},{key:"init_",value:function(t){window.asserts.assert(this.config_,"DrmEngine configure() must be called before init()!");var n=t.some(function(e){return e.drmInfos.length>0});if(!n){var r=Nt.asMap(this.config_.servers);e.replaceDrmInfo_(t,r)}var i=this.configureClearKey_();if(i){var a=!0,s=!1,o=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){l.value.drmInfos=[i]}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}}var c=!0,d=!1,h=void 0;try{for(var f,p=t[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=!0,g=!1,y=void 0;try{for(var _,w=m.drmInfos[Symbol.iterator]();!(v=(_=w.next()).done);v=!0){var E=_.value;e.fillInDrmInfoDefaults_(E,Nt.asMap(this.config_.servers),Nt.asMap(this.config_.advanced||{}))}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var b=this.prepareMediaKeyConfigsForVariants_(t);if(!b.size)return this.initialized_=!0,Promise.resolve();var S=this.queryMediaKeys_(b);return n?S:S.catch(function(){})}},{key:"attach",value:function(){var e=qt(regeneratorRuntime.mark(function e(t){var n,r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaKeys_){e.next=3;break}return this.eventManager_.listenOnce(t,"encrypted",function(e){a.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO))}),e.abrupt("return");case 3:return this.video_=t,this.eventManager_.listenOnce(this.video_,"play",function(){return a.onPlay_()}),n=(n=this.video_.setMediaKeys(this.mediaKeys_)).catch(function(e){return Promise.reject(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_ATTACH_TO_VIDEO,e.message))}),r=this.setServerCertificate(),e.next=10,Promise.all([n,r]);case 10:this.destroyer_.ensureNotDestroyed(),this.createOrLoad(),this.currentDrmInfo_.initData.length||this.offlineSessionIds_.length||(i=function(e){return a.newInitData(e.initDataType,new Uint8Array(e.initData))},this.eventManager_.listen(this.video_,"encrypted",i));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setServerCertificate",value:function(){var e=qt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(this.initialized_,"Must call init() before setServerCertificate"),!(this.mediaKeys_&&this.currentDrmInfo_&&this.currentDrmInfo_.serverCertificate&&this.currentDrmInfo_.serverCertificate.length)){e.next=12;break}return e.prev=2,e.next=5,this.mediaKeys_.setServerCertificate(this.currentDrmInfo_.serverCertificate);case 5:e.sent||Xt.log.warning("Server certificates are not supported by the key system.  The server certificate has been ignored."),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(2),new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.INVALID_SERVER_CERTIFICATE,e.t0.message);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"removeSession",value:function(){var e=qt(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.mediaKeys_,"Must call init() before removeSession"),e.next=3,this.loadOfflineSession_(t);case 3:if(n=e.sent){e.next=7;break}return Xt.log.v2("Ignoring attempt to remove missing session",t),e.abrupt("return");case 7:return r=[],(i=this.activeSessions_.get(n))&&(i.updatePromise=new A,r.push(i.updatePromise)),Xt.log.v2("Attempting to remove session",t),r.push(n.remove()),e.next=14,Promise.all(r);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createOrLoad",value:function(){var e=(this.currentDrmInfo_?this.currentDrmInfo_.initData:[])||[],t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.createTemporarySession_(s.initDataType,s.initData)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,l=!1,u=void 0;try{for(var c,d=this.offlineSessionIds_[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;this.loadOfflineSession_(h)}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}return e.length||this.offlineSessionIds_.length||this.allSessionsLoaded_.resolve(),this.allSessionsLoaded_}},{key:"newInitData",value:function(e,t){var n=this.activeSessions_.values(),r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;if(Kt.equal(t,l.initData))return void Xt.log.debug("Ignoring duplicate init data.")}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}this.createTemporarySession_(e,t)}},{key:"initialized",value:function(){return this.initialized_}},{key:"keySystem",value:function(){return this.currentDrmInfo_?this.currentDrmInfo_.keySystem:""}},{key:"willSupport",value:function(e){return!!Ft.isEdge()||this.supportedTypes_.has(e)}},{key:"getSessionIds",value:function(){var e=this.activeSessions_.keys(),t=Ce.map(e,function(e){return e.sessionId});return Array.from(t)}},{key:"getExpiration",value:function(){var e=1/0,t=this.activeSessions_.keys(),n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;isNaN(o.expiration)||(e=Math.min(e,o.expiration))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e}},{key:"getDrmInfo",value:function(){return this.currentDrmInfo_}},{key:"getKeyStatuses",value:function(){return Nt.asObject(this.announcedKeyStatusByKeyId_)}},{key:"prepareMediaKeyConfigsForVariants_",value:function(t){var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=!0,c=!1,d=void 0;try{for(var h,f=l.drmInfos[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;n.add(p)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var m=!0,v=!1,g=void 0;try{for(var y,_=n[Symbol.iterator]();!(m=(y=_.next()).done);m=!0){var w=y.value;e.fillInDrmInfoDefaults_(w,Nt.asMap(this.config_.servers),Nt.asMap(this.config_.advanced||{}))}}catch(e){v=!0,g=e}finally{try{m||null==_.return||_.return()}finally{if(v)throw g}}var E=this.usePersistentLicenses_?"required":"optional",b=this.usePersistentLicenses_?["persistent-license"]:["temporary"],S=new Map,T=!0,k=!1,C=void 0;try{for(var I,A=n[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){var L=I.value,R={audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:E,sessionTypes:b,label:L.keySystem,drmInfos:[]};S.set(L.keySystem,R)}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}var x=!0,N=!1,M=void 0;try{for(var P,O=t[Symbol.iterator]();!(x=(P=O.next()).done);x=!0){var D=P.value,U=D.audio,F=D.video,B=U?Ot.getFullType(U.mimeType,U.codecs):"",V=F?Ot.getFullType(F.mimeType,F.codecs):"",H=!0,G=!1,j=void 0;try{for(var K,W=D.drmInfos[Symbol.iterator]();!(H=(K=W.next()).done);H=!0){var q=K.value,z=S.get(q.keySystem);if(window.asserts.assert(z,"Any missing configs should have be filled in before."),z.drmInfos.push(q),q.distinctiveIdentifierRequired&&(z.distinctiveIdentifier="required"),q.persistentStateRequired&&(z.persistentState="required"),U){var Y={robustness:q.audioRobustness||"",contentType:B};z.audioCapabilities.push(Y)}if(F){var X={robustness:q.videoRobustness||"",contentType:V};z.videoCapabilities.push(X)}}}catch(e){G=!0,j=e}finally{try{H||null==W.return||W.return()}finally{if(G)throw j}}}}catch(e){N=!0,M=e}finally{try{x||null==O.return||O.return()}finally{if(N)throw M}}return S}},{key:"queryMediaKeys_",value:function(){var t=qt(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,w,E,b,S,T,k,C,I,A,L,R,x,N,P,O,D;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=n.size||!n.has("")){t.next=2;break}throw new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.NO_RECOGNIZED_KEY_SYSTEMS);case 2:for(r=!0,i=!1,a=void 0,t.prev=5,s=n.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)0==(l=o.value).audioCapabilities.length&&delete l.audioCapabilities,0==l.videoCapabilities.length&&delete l.videoCapabilities;t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),i=!0,a=t.t0;case 13:t.prev=13,t.prev=14,r||null==s.return||s.return();case 16:if(t.prev=16,!i){t.next=19;break}throw a;case 19:return t.finish(16);case 20:return t.finish(13);case 21:c=0,d=[!0,!1];case 22:if(!(c<d.length)){t.next=67;break}h=d[c],f=!0,p=!1,m=void 0,t.prev=27,v=n.keys()[Symbol.iterator]();case 29:if(f=(g=v.next()).done){t.next=48;break}if(y=g.value,_=n.get(y),_.drmInfos.some(function(e){return!!e.licenseServerUri})==h){t.next=35;break}return t.abrupt("continue",45);case 35:return t.prev=35,t.next=38,navigator.requestMediaKeySystemAccess(y,[_]);case 38:return u=t.sent,t.abrupt("break",48);case 42:t.prev=42,t.t1=t.catch(35);case 44:this.destroyer_.ensureNotDestroyed();case 45:f=!0,t.next=29;break;case 48:t.next=54;break;case 50:t.prev=50,t.t2=t.catch(27),p=!0,m=t.t2;case 54:t.prev=54,t.prev=55,f||null==v.return||v.return();case 57:if(t.prev=57,!p){t.next=60;break}throw m;case 60:return t.finish(57);case 61:return t.finish(54);case 62:if(!u){t.next=64;break}return t.abrupt("break",67);case 64:c++,t.next=22;break;case 67:if(u){t.next=69;break}throw new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE);case 69:for(this.destroyer_.ensureNotDestroyed(),t.prev=70,this.supportedTypes_.clear(),w=u.getConfiguration(),E=w.audioCapabilities||[],b=w.videoCapabilities||[],S=!0,T=!1,k=void 0,t.prev=78,C=E[Symbol.iterator]();!(S=(I=C.next()).done);S=!0)A=I.value,this.supportedTypes_.add(A.contentType);t.next=86;break;case 82:t.prev=82,t.t3=t.catch(78),T=!0,k=t.t3;case 86:t.prev=86,t.prev=87,S||null==C.return||C.return();case 89:if(t.prev=89,!T){t.next=92;break}throw k;case 92:return t.finish(89);case 93:return t.finish(86);case 94:for(L=!0,R=!1,x=void 0,t.prev=97,N=b[Symbol.iterator]();!(L=(P=N.next()).done);L=!0)O=P.value,this.supportedTypes_.add(O.contentType);t.next=105;break;case 101:t.prev=101,t.t4=t.catch(97),R=!0,x=t.t4;case 105:t.prev=105,t.prev=106,L||null==N.return||N.return();case 108:if(t.prev=108,!R){t.next=111;break}throw x;case 111:return t.finish(108);case 112:return t.finish(105);case 113:if(window.asserts.assert(this.supportedTypes_.size,"We should get at least one supported MIME type"),this.currentDrmInfo_=e.createDrmInfoFor_(u.keySystem,n.get(u.keySystem)),this.currentDrmInfo_.licenseServerUri){t.next=117;break}throw new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.NO_LICENSE_SERVER_GIVEN,this.currentDrmInfo_.keySystem);case 117:return t.next=119,u.createMediaKeys();case 119:D=t.sent,this.destroyer_.ensureNotDestroyed(),Xt.log.info("Created MediaKeys object for key system",this.currentDrmInfo_.keySystem),this.mediaKeys_=D,this.initialized_=!0,t.next=134;break;case 126:if(t.prev=126,t.t5=t.catch(70),this.destroyer_.ensureNotDestroyed(t.t5),this.currentDrmInfo_=null,this.supportedTypes_.clear(),!(t.t5 instanceof M)){t.next=133;break}throw t.t5;case 133:throw new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_CREATE_CDM,t.t5.message);case 134:case"end":return t.stop()}},t,this,[[5,9,13,21],[14,,16,20],[27,50,54,62],[35,42],[55,,57,61],[70,126],[78,82,86,94],[87,,89,93],[97,101,105,113],[106,,108,112]])}));return function(e){return t.apply(this,arguments)}}()},{key:"configureClearKey_",value:function(){var e=Nt.asMap(this.config_.clearKeys);if(0==e.size)return null;var t=[],n=[];e.forEach(function(e,r){var i=Kt.fromHex(r),a=Kt.fromHex(e),s={kty:"oct",kid:Kt.toBase64(i,!1),k:Kt.toBase64(a,!1)};t.push(s),n.push(s.kid)});var r={keys:t},i=JSON.stringify(r),a=JSON.stringify({kids:n}),s=[{initData:new Uint8Array(Gt.toUTF8(a)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(i),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:s,keyIds:[]}}},{key:"loadOfflineSession_",value:function(){var e=qt(regeneratorRuntime.mark(function e(t){var n,r,i,a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,Xt.log.v1("Attempting to load an offline session",t),n=this.mediaKeys_.createSession("persistent-license"),e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),r=new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_CREATE_SESSION,e.t0.message),this.onError_(r),e.abrupt("return",Promise.reject(r));case 10:return this.eventManager_.listen(n,"message",function(e){return s.onSessionMessage_(e)}),this.eventManager_.listen(n,"keystatuseschange",function(e){return s.onKeyStatusesChange_(e)}),i={initData:null,loaded:!1,oldExpiration:1/0,updatePromise:null},this.activeSessions_.set(n,i),e.prev=14,e.next=17,n.load(t);case 17:if(a=e.sent,this.destroyer_.ensureNotDestroyed(),Xt.log.v2("Loaded offline session",t,a),a){e.next=24;break}return this.activeSessions_.delete(n),this.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.OFFLINE_SESSION_REMOVED)),e.abrupt("return",Promise.resolve());case 24:return i.loaded=!0,this.areAllSessionsLoaded_()&&this.allSessionsLoaded_.resolve(),e.abrupt("return",n);case 29:e.prev=29,e.t1=e.catch(14),this.destroyer_.ensureNotDestroyed(e.t1),this.activeSessions_.delete(n),this.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_CREATE_SESSION,e.t1.message));case 34:return e.abrupt("return",Promise.resolve());case 35:case"end":return e.stop()}},e,this,[[0,5],[14,29]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createTemporarySession_",value:function(e,t){var n,r=this;try{this.usePersistentLicenses_?(Xt.log.v1("Creating new persistent session"),n=this.mediaKeys_.createSession("persistent-license")):(Xt.log.v1("Creating new temporary session"),n=this.mediaKeys_.createSession())}catch(e){return void this.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_CREATE_SESSION,e.message))}this.eventManager_.listen(n,"message",function(e){return r.onSessionMessage_(e)}),this.eventManager_.listen(n,"keystatuseschange",function(e){return r.onKeyStatusesChange_(e)});var i={initData:t,loaded:!1,oldExpiration:1/0,updatePromise:null};this.activeSessions_.set(n,i),n.generateRequest(e,t.buffer).catch(function(e){var t;r.destroyer_.destroyed()||(r.activeSessions_.delete(n),e.errorCode&&e.errorCode.systemCode&&((t=e.errorCode.systemCode)<0&&(t+=Math.pow(2,32)),t="0x"+t.toString(16)),r.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.FAILED_TO_GENERATE_LICENSE_REQUEST,e.message,e,t)))})}},{key:"onSessionMessage_",value:function(e){this.delayLicenseRequest_()?this.mediaKeyMessageEvents_.push(e):this.sendLicenseRequest_(e)}},{key:"delayLicenseRequest_",value:function(){return this.config_.delayLicenseRequestUntilPlayed&&this.video_.paused&&!this.initialRequestsSent_}},{key:"sendLicenseRequest_",value:function(){var t=qt(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d,h,f,p=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.target,Xt.log.v2("Sending license request for session",r.sessionId),i=this.activeSessions_.get(r),a=this.currentDrmInfo_.licenseServerUri,s=this.config_.advanced[this.currentDrmInfo_.keySystem],"individualization-request"==n.messageType&&s&&s.individualizationServer&&(a=s.individualizationServer),o=oe.RequestType.LICENSE,(l=oe.makeRequest([a],this.config_.retryParameters)).body=n.message,l.method="POST",l.licenseRequestType=n.messageType,"com.microsoft.playready"!=this.currentDrmInfo_.keySystem&&"com.chromecast.playready"!=this.currentDrmInfo_.keySystem||this.unpackPlayReadyRequest_(l),this.currentDrmInfo_.keySystem.startsWith("com.apple.fps")&&this.formatFairPlayRequest_(l),t.prev=13,c=this.playerInterface_.netEngine.request(o,l),t.next=17,c.promise;case 17:u=t.sent,t.next=27;break;case 20:return t.prev=20,t.t0=t.catch(13),window.asserts.assert(t.t0 instanceof M,"Wrong NetworkingEngine error type!"),d=new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.LICENSE_REQUEST_FAILED,t.t0),this.onError_(d),i&&i.updatePromise&&i.updatePromise.reject(d),t.abrupt("return");case 27:if(!this.destroyer_.destroyed()){t.next=29;break}return t.abrupt("return");case 29:return this.currentDrmInfo_.keySystem.startsWith("com.apple.fps")&&this.parseFairPlayResponse_(u),t.prev=30,t.next=33,r.update(u.data);case 33:t.next=41;break;case 35:return t.prev=35,t.t1=t.catch(30),h=new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.LICENSE_RESPONSE_REJECTED,t.t1.message),this.onError_(h),i&&i.updatePromise&&i.updatePromise.reject(h),t.abrupt("return");case 41:f=new w("drmsessionupdate"),this.playerInterface_.onEvent(f),i&&(i.updatePromise&&i.updatePromise.resolve(),new H(function(){i.loaded=!0,p.areAllSessionsLoaded_()&&p.allSessionsLoaded_.resolve()}).tickAfter(e.SESSION_LOAD_TIMEOUT_));case 44:case"end":return t.stop()}},t,this,[[13,20],[30,35]])}));return function(e){return t.apply(this,arguments)}}()},{key:"unpackPlayReadyRequest_",value:function(e){var t=Gt.fromUTF16(e.body,!0,!0);if(!t.includes("PlayReadyKeyMessage"))return Xt.log.debug("PlayReady request is already unwrapped."),void(e.headers["Content-Type"]="text/xml; charset=utf-8");Xt.log.debug("Unwrapping PlayReady request.");var n=(new DOMParser).parseFromString(t,"application/xml"),r=n.getElementsByTagName("HttpHeader"),i=!0,a=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=u.querySelector("name"),d=u.querySelector("value");window.asserts.assert(c&&d,"Malformed PlayReady headers!"),e.headers[c.textContent]=d.textContent}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var h=n.querySelector("Challenge");window.asserts.assert(h,"Malformed PlayReady challenge!"),window.asserts.assert("base64encoded"==h.getAttribute("encoding"),"Unexpected PlayReady challenge encoding!"),e.body=Kt.fromBase64(h.textContent).buffer}},{key:"formatFairPlayRequest_",value:function(e){var t=new Uint8Array(e.body),n="spc="+Kt.toStandardBase64(t);e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=Gt.toUTF8(encodeURIComponent(n))}},{key:"parseFairPlayResponse_",value:function(e){var t;try{t=Gt.fromUTF8(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=Kt.fromBase64(t).buffer}},{key:"onKeyStatusesChange_",value:function(t){var n=this,r=t.target;Xt.log.v2("Key status changed for session",r.sessionId);var i=this.activeSessions_.get(r),a=r.keyStatuses,s=!1;a.forEach(function(e,t){if("string"==typeof t){var r=t;t=e,e=r}if("com.microsoft.playready"==n.currentDrmInfo_.keySystem&&16==t.byteLength&&!Ft.isTizen()){var a=Kt.toDataView(t),o=a.getUint32(0,!0),l=a.getUint16(4,!0),u=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,l,!1),a.setUint16(6,u,!1)}"com.microsoft.playready"==n.currentDrmInfo_.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(i.loaded=!0),i||window.asserts.assert("usable"!=e,"Usable keys found in closed session"),"expired"==e&&(s=!0);var c=Kt.toHex(new Uint8Array(t));n.keyStatusByKeyId_.set(c,e)});var o=r.expiration-Date.now();(o<0||s&&o<1e3)&&i&&!i.updatePromise&&(Xt.log.debug("Session has expired",r.sessionId),this.activeSessions_.delete(r),r.close().catch(function(){})),this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.keyStatusTimer_.tickAfter(e.KEY_STATUS_BATCH_TIME))}},{key:"processKeyStatusChanges_",value:function(){var e=this.keyStatusByKeyId_,t=this.announcedKeyStatusByKeyId_;t.clear(),e.forEach(function(e,n){return t.set(n,e)});var n=Array.from(t.values());n.length&&n.every(function(e){return"expired"==e})&&this.onError_(new M(Yt.severity.CRITICAL,Yt.category.DRM,Yt.code.EXPIRED)),this.playerInterface_.onKeyStatus(Nt.asObject(t))}},{key:"onPlay_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.mediaKeyMessageEvents_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.sendLicenseRequest_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.initialRequestsSent_=!0,this.mediaKeyMessageEvents_=[]}},{key:"supportsVariant",value:function(e){var t=e.audio,n=e.video;if(t&&t.encrypted){var r=Ot.getFullType(t.mimeType,t.codecs);if(!this.willSupport(r))return!1}if(n&&n.encrypted){var i=Ot.getFullType(n.mimeType,n.codecs);if(!this.willSupport(i))return!1}var a=this.keySystem();return 0==e.drmInfos.length||e.drmInfos.some(function(e){return e.keySystem==a})}},{key:"pollExpiration_",value:function(){var e=this;this.activeSessions_.forEach(function(t,n){var r=t.oldExpiration,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.playerInterface_.onExpirationUpdated(n.sessionId,i),t.oldExpiration=i)})}},{key:"areAllSessionsLoaded_",value:function(){var e=this.activeSessions_.values();return Ce.every(e,function(e){return e.loaded})}}],r=[{key:"isBrowserSupported",value:function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)}},{key:"probeSupport",value:function(){var t=qt(regeneratorRuntime.mark(function t(){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert(e.isBrowserSupported(),"Must have basic EME support"),n=["org.w3.clearkey","com.widevine.alpha","com.microsoft.playready","com.apple.fps.3_0","com.apple.fps.2_0","com.apple.fps.1_0","com.apple.fps","com.adobe.primetime"],i=[{videoCapabilities:r=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:r}],a=new Map,s=function(){var e=qt(regeneratorRuntime.mark(function e(t){var n,r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.requestMediaKeySystemAccess(t,i);case 3:return n=e.sent,r=n.getConfiguration().sessionTypes,s=!!r&&r.includes("persistent-license"),Ft.isTizen3()&&(s=!1),a.set(t,{persistentState:s}),e.next=10,n.createMediaKeys();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),a.set(t,null);case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),o=n.map(function(e){return s(e)}),t.next=11,Promise.all(o);case 11:return t.abrupt("return",Nt.asObject(a));case 12:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"areDrmCompatible",value:function(t,n){return!t.length||!n.length||e.getCommonDrmInfos(t,n).length>0}},{key:"getCommonDrmInfos",value:function(e,t){if(!e.length)return t;if(!t.length)return e;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=!0,c=!1,d=void 0;try{for(var h,f=t[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;if(l.keySystem==p.keySystem){var m=[];m=(m=m.concat(l.initData||[])).concat(p.initData||[]);var v=[];v=(v=v.concat(l.keyIds)).concat(p.keyIds);var g={keySystem:l.keySystem,licenseServerUri:l.licenseServerUri||p.licenseServerUri,distinctiveIdentifierRequired:l.distinctiveIdentifierRequired||p.distinctiveIdentifierRequired,persistentStateRequired:l.persistentStateRequired||p.persistentStateRequired,videoRobustness:l.videoRobustness||p.videoRobustness,audioRobustness:l.audioRobustness||p.audioRobustness,serverCertificate:l.serverCertificate||p.serverCertificate,initData:m,keyIds:v};n.push(g);break}}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"replaceDrmInfo_",value:function(e,t){var n=[];t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});var r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.drmInfos=n}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"createDrmInfoFor_",value:function(t,n){var r=[],i=[],a=[],s=[];e.processDrmInfos_(n.drmInfos,r,i,a,s),i.length>1&&Xt.log.warning("Multiple unique server certificates found! Only the first will be used."),r.length>1&&Xt.log.warning("Multiple unique license server URIs found! Only the first will be used.");var o=n.audioCapabilities?n.audioCapabilities[0].robustness:"",l=n.videoCapabilities?n.videoCapabilities[0].robustness:"",u=n.distinctiveIdentifier;return{keySystem:t,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==u,persistentStateRequired:"required"==n.persistentState,audioRobustness:o,videoRobustness:l,serverCertificate:i[0],initData:a,keyIds:s}}},{key:"processDrmInfos_",value:function(e,t,n,r,i){var a=!0,s=!1,o=void 0;try{for(var l,u=function(){var e=l.value;(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate)&&(n.some(function(t){return Kt.equal(t,e.serverCertificate)})||n.push(e.serverCertificate));if(e.initData){var a=!0,s=!1,o=void 0;try{for(var u,c=function(){var e=u.value;r.some(function(t){return r=e,!(!(n=t).keyId||n.keyId!=r.keyId)||n.initDataType==r.initDataType&&Kt.equal(n.initData,r.initData);var n,r})||r.push(e)},d=e.initData[Symbol.iterator]();!(a=(u=d.next()).done);a=!0)c()}catch(e){s=!0,o=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw o}}}if(e.keyIds){var h=!0,f=!1,p=void 0;try{for(var m,v=e.keyIds[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;i.includes(g)||i.push(g)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}},c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)u()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}}},{key:"fillInDrmInfoDefaults_",value:function(e,t,n){if(e.keySystem&&("org.w3.clearkey"!=e.keySystem||!e.licenseServerUri)){if(t.size){var r=t.get(e.keySystem)||"";e.licenseServerUri=r}e.keyIds||(e.keyIds=[]);var i=n.get(e.keySystem);i&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=i.persistentStateRequired),e.videoRobustness||(e.videoRobustness=i.videoRobustness),e.audioRobustness||(e.audioRobustness=i.audioRobustness),e.serverCertificate||(e.serverCertificate=i.serverCertificate)),window.cast&&window.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready")}}},{key:"closeSession_",value:function(){var t=qt(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Promise(function(t){new H(t).tickAfter(e.CLOSE_TIMEOUT_)}),t.next=3,Promise.race([n.close().then(function(){return!0}),r.then(function(){return!1})]);case 3:t.sent||Xt.log.warning("Timeout waiting for session close");case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}],n&&zt(t.prototype,n),r&&zt(t,r),e}());$t.SessionMetaData={},$t.PlayerInterface={},$t.CLOSE_TIMEOUT_=1,$t.SESSION_LOAD_TIMEOUT_=5,$t.KEY_STATUS_BATCH_TIME=.5;var Qt=$t,Zt=n(1),Jt=n.n(Zt);function en(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nn(e,t,n){return t&&tn(e.prototype,t),n&&tn(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka;var rn=function(){function e(){en(this,e),this.muxCaptionParser_=new Jt.a.mp4.CaptionParser,this.videoTrackIds_=[],this.timescales_={}}return nn(e,[{key:"init",value:function(e){var t=Jt.a.mp4.probe,n=new Uint8Array(e);this.videoTrackIds_=t.videoTrackIds(n),this.timescales_=t.timescale(n),this.muxCaptionParser_.init()}},{key:"parseFrom",value:function(e,t){var n=new Uint8Array(e),r=this.muxCaptionParser_.parse(n,this.videoTrackIds_,this.timescales_);r&&r.captions&&t(r.captions),this.muxCaptionParser_.clearParsedCaptions()}},{key:"reset",value:function(){this.muxCaptionParser_.resetCaptionStream()}}],[{key:"isSupported",value:function(){return!!Jt.a}}]),e}(),an=function(){function e(){en(this,e)}return nn(e,[{key:"init",value:function(e){}},{key:"parseFrom",value:function(e,t){}},{key:"reset",value:function(){}}]),e}();function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var on=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"bufferStart",value:function(e){return e?1==e.length&&e.end(0)-e.start(0)<1e-6?null:1==e.length&&e.start(0)<0?0:e.length?e.start(0):null:null}},{key:"bufferEnd",value:function(e){return e?1==e.length&&e.end(0)-e.start(0)<1e-6?null:e.length?e.end(e.length-1):null:null}},{key:"isBuffered",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!(!e||!e.length)&&(!(1==e.length&&e.end(0)-e.start(0)<1e-6)&&(!(t>e.end(e.length-1))&&t+n>=e.start(0)))}},{key:"bufferedAheadOf",value:function(e,t){if(!e||!e.length)return 0;if(1==e.length&&e.end(0)-e.start(0)<1e-6)return 0;for(var n=0,r=e.length-1;r>=0&&e.end(r)>t;--r)n+=e.end(r)-Math.max(e.start(r),t);return n}},{key:"getGapIndex",value:function(e,t){if(!e||!e.length)return null;if(1==e.length&&e.end(0)-e.start(0)<1e-6)return null;for(var n=Ft.isEdge()||Ft.isIE()||Ft.isTizen()||Ft.isChromecast()?.5:.1,r=0;r<e.length;r++)if(e.start(r)>t&&(0==r||e.end(r-1)-t<=n))return r;return null}},{key:"getBufferedInfo",value:function(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}}],(n=null)&&sn(t.prototype,n),r&&sn(t,r),e}();function ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var un=window.shaka,cn=function e(t,n,r){ln(this,e),this.startTime=t,this.direction=e.direction.HORIZONTAL_LEFT_TO_RIGHT,this.endTime=n,this.payload=r,this.region=new un.text.CueRegion,this.position=null,this.positionAlign=e.positionAlign.AUTO,this.size=100,this.textAlign=e.textAlign.CENTER,this.writingMode=e.writingMode.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=e.lineInterpretation.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=e.lineAlign.START,this.displayAlign=e.displayAlign.AFTER,this.color="",this.backgroundColor="",this.backgroundImage=null,this.fontSize="",this.fontWeight=e.fontWeight.NORMAL,this.fontStyle=e.fontStyle.NORMAL,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id=""};cn.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},cn.textAlign={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},cn.displayAlign={BEFORE:"before",CENTER:"center",AFTER:"after"},cn.direction={HORIZONTAL_LEFT_TO_RIGHT:"ltr",HORIZONTAL_RIGHT_TO_LEFT:"rtl"},cn.writingMode={HORIZONTAL_TOP_TO_BOTTOM:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},cn.lineInterpretation={LINE_NUMBER:0,PERCENTAGE:1},cn.lineAlign={CENTER:"center",START:"start",END:"end"},cn.fontWeight={NORMAL:400,BOLD:700},cn.fontStyle={NORMAL:"normal",ITALIC:"italic",OBLIQUE:"oblique"},cn.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var dn=function e(){ln(this,e),this.id="",this.viewportAnchorX=0,this.viewportAnchorY=0,this.regionAnchorX=0,this.regionAnchorY=0,this.width=100,this.height=100,this.heightUnits=e.units.PERCENTAGE,this.widthUnits=e.units.PERCENTAGE,this.viewportAnchorUnits=e.units.PERCENTAGE,this.scroll=e.scrollMode.NONE};function hn(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function fn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){hn(a,r,i,s,o,"next",e)}function o(e){hn(a,r,i,s,o,"throw",e)}s(void 0)})}}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}dn.units={PX:0,PERCENTAGE:1,LINES:2},dn.scrollMode={NONE:"",UP:"up"};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var mn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parser_=null,this.displayer_=t,this.timestampOffset_=0,this.appendWindowStart_=0,this.appendWindowEnd_=1/0,this.bufferStart_=null,this.bufferEnd_=null,this.selectedClosedCaptionId_="",this.closedCaptionsMap_=new Map}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.parser_=null,this.displayer_=null,this.closedCaptionsMap_.clear(),Promise.resolve()}},{key:"setDisplayer",value:function(e){this.displayer_=e}},{key:"initParser",value:function(t){if(t!=Ot.CLOSED_CAPTION_MIMETYPE){var n=e.parserMap_[t];window.asserts.assert(n,"Text type negotiation should have happened already"),this.parser_=new n}}},{key:"getStartTime",value:function(e){window.asserts.assert(this.parser_,"The parser should already be initialized");try{return this.parser_.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.UNABLE_TO_EXTRACT_CUE_START_TIME,e)}}},{key:"appendBuffer",value:function(){var e=fn(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.parser_,"The parser should already be initialized"),e.next=3,Promise.resolve();case 3:if(this.parser_&&this.displayer_){e.next=5;break}return e.abrupt("return");case 5:if(null!=n&&null!=r){e.next=8;break}return this.parser_.parseInit(new Uint8Array(t)),e.abrupt("return");case 8:i={periodStart:this.timestampOffset_,segmentStart:n,segmentEnd:r},a=this.parser_.parseMedia(new Uint8Array(t),i),s=a.filter(function(e){return e.startTime>=o.appendWindowStart_&&e.startTime<o.appendWindowEnd_}),this.displayer_.append(s),null==this.bufferStart_?this.bufferStart_=Math.max(n,this.appendWindowStart_):(window.asserts.assert(null!=this.bufferEnd_,"There should already be a buffered range end."),window.asserts.assert(n-this.bufferEnd_<=1,"There should not be a gap in text references >1s")),this.bufferEnd_=Math.min(r,this.appendWindowEnd_);case 14:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=fn(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:this.displayer_&&this.displayer_.remove(t,n)&&(null==this.bufferStart_?window.asserts.assert(null==this.bufferEnd_,"end must be null if startTime is null"):(window.asserts.assert(null!=this.bufferEnd_,"end must be non-null if startTime is non-null"),n<=this.bufferStart_||t>=this.bufferEnd_||(t<=this.bufferStart_&&n>=this.bufferEnd_?this.bufferStart_=this.bufferEnd_=null:t<=this.bufferStart_&&n<this.bufferEnd_?this.bufferStart_=n:t>this.bufferStart_&&n>=this.bufferEnd_?this.bufferEnd_=t:window.asserts.assert(!1,"removal from the middle is not supported by TextEngine"))));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setTimestampOffset",value:function(e){this.timestampOffset_=e}},{key:"setAppendWindow",value:function(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t}},{key:"bufferStart",value:function(){return this.bufferStart_}},{key:"bufferEnd",value:function(){return this.bufferEnd_}},{key:"isBuffered",value:function(e){return null!=this.bufferStart_&&null!=this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)}},{key:"bufferedAheadOf",value:function(e){return null==this.bufferEnd_||this.bufferEnd_<e?0:(window.asserts.assert(null!=this.bufferStart_,"start should not be null if end is not null"),this.bufferEnd_-Math.max(e,this.bufferStart_))}},{key:"appendCues",value:function(e){this.displayer_.append(e)}},{key:"setSelectedClosedCaptionId",value:function(e,t){this.selectedClosedCaptionId_=e;var n=this.closedCaptionsMap_.get(e);if(n){var r=!0,i=!1,a=void 0;try{for(var s,o=n.keys()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=n.get(l);u&&(u=u.filter(function(e){return e.endTime<=t}),this.displayer_.append(u))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}}},{key:"storeAndAppendClosedCaptions",value:function(e,t,n,r){var i=t+" "+n,a=new Map,s=!0,o=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value,h=d.stream;if(a.has(h)||a.set(h,new Map),a.get(h).has(i)||a.get(h).set(i,[]),d.startTime+=r,d.endTime+=r,d.startTime>=this.appendWindowStart_&&d.startTime<this.appendWindowEnd_){var f=new cn(d.startTime,d.endTime,d.text);a.get(h).get(i).push(f),h==this.selectedClosedCaptionId_&&this.displayer_.append([f])}}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}var p=!0,m=!1,v=void 0;try{for(var g,y=a.keys()[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value;this.closedCaptionsMap_.has(_)||this.closedCaptionsMap_.set(_,new Map);var w=!0,E=!1,b=void 0;try{for(var S,T=a.get(_).keys()[Symbol.iterator]();!(w=(S=T.next()).done);w=!0){var k=S.value,C=a.get(_).get(k);this.closedCaptionsMap_.get(_).set(k,C)}}catch(e){E=!0,b=e}finally{try{w||null==T.return||T.return()}finally{if(E)throw b}}}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}null==this.bufferStart_?this.bufferStart_=Math.max(t,this.appendWindowStart_):this.bufferStart_=Math.min(this.bufferStart_,Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.max(this.bufferEnd_,Math.min(n,this.appendWindowEnd_))}},{key:"getNumberOfClosedCaptionChannels",value:function(){return this.closedCaptionsMap_.size}},{key:"getNumberOfClosedCaptionsInChannel",value:function(e){var t=this.closedCaptionsMap_.get(e);return t?t.size:0}}],r=[{key:"registerParser",value:function(t,n){e.parserMap_[t]=n}},{key:"unregisterParser",value:function(t){delete e.parserMap_[t]}},{key:"isTypeSupported",value:function(t){return!!e.parserMap_[t]||!(!Jt.a||t!==Ot.CLOSED_CAPTION_MIMETYPE)}}],n&&pn(t.prototype,n),r&&pn(t,r),e}();mn.parserMap_={};var vn=mn;function gn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var _n=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.muxTransmuxer_=new Jt.a.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.transmuxPromise_=null,this.transmuxedData_=[],this.captions_=[],this.isTransmuxing_=!1,this.muxTransmuxer_.on("data",function(e){return t.onTransmuxed_(e)}),this.muxTransmuxer_.on("done",function(){return t.onTransmuxDone_()})}var t,n,r;return t=e,r=[{key:"isSupported",value:function(t,n){if(!Jt.a||!e.isTsContainer(t))return!1;var r=e.convertTsCodecs;if(n)return MediaSource.isTypeSupported(r(n,t));var i=Re.ContentType;return MediaSource.isTypeSupported(r(i.AUDIO,t))||MediaSource.isTypeSupported(r(i.VIDEO,t))}},{key:"isTsContainer",value:function(e){return"mp2t"==e.split(";")[0].split("/")[1]}},{key:"convertTsCodecs",value:function(e,t){var n=Re.ContentType,r=t.replace("mp2t","mp4");e==n.AUDIO&&(r=r.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(r);if(i){var a="avc1.",s=i[1];"66"==s?a+="4200":"77"==s?a+="4d00":(window.asserts.assert("100"==s,"Legacy avc1 parsing code out of sync with regex!"),a+="6400");var o=Number(i[2]);window.asserts.assert(o<256,"Invalid legacy avc1 level number!"),a+=(o>>4).toString(16),a+=(15&o).toString(16),r=r.replace(i[0],a)}return r}}],(n=[{key:"destroy",value:function(){return this.muxTransmuxer_.dispose(),this.muxTransmuxer_=null,Promise.resolve()}},{key:"transmux",value:function(e){window.asserts.assert(!this.isTransmuxing_,"No transmuxing should be in progress."),this.isTransmuxing_=!0,this.transmuxPromise_=new A,this.transmuxedData_=[],this.captions_=[];var t=new Uint8Array(e);return this.muxTransmuxer_.push(t),this.muxTransmuxer_.flush(),this.isTransmuxing_&&this.transmuxPromise_.reject(new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.TRANSMUXING_FAILED)),this.transmuxPromise_}},{key:"onTransmuxed_",value:function(e){this.captions_=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.transmuxedData_.push(t)}},{key:"onTransmuxDone_",value:function(){var e={data:Kt.concat.apply(Kt,gn(this.transmuxedData_)),captions:this.captions_};this.transmuxPromise_.resolve(e),this.isTransmuxing_=!1}}])&&yn(t.prototype,n),r&&yn(t,r),e}();function wn(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function En(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){wn(a,r,i,s,o,"next",e)}function o(e){wn(a,r,i,s,o,"throw",e)}s(void 0)})}}function bn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Sn=new M,Tn=window.shaka,kn=window.goog,Cn=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=t,this.textDisplayer_=r,this.sourceBuffers_={},this.textEngine_=null,this.queues_={},this.eventManager_=new Ke,this.transmuxers_={},this.captionParser_=n,this.mediaSourceOpen_=new A,this.mediaSource_=this.createMediaSource(this.mediaSourceOpen_),this.destroyer_=new Rt(function(){return i.doDestroy_()})}var t,n,r;return t=e,n=[{key:"createMediaSource",value:function(t){var n=new MediaSource;return this.eventManager_.listenOnce(n,"sourceopen",t.resolve),console.log(e.createObjectURL(n)),this.video_.src=e.createObjectURL(n),n}},{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=En(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=[],this.queues_)for(r=this.queues_[n],i=r[0],this.queues_[n]=r.slice(0,1),i&&t.push(i.p.catch(Ae.noop)),a=1;a<r.length;++a)r[a].p.reject(Rt.destroyedError());for(s in this.textEngine_&&t.push(this.textEngine_.destroy()),this.textDisplayer_&&t.push(this.textDisplayer_.destroy()),this.transmuxers_)t.push(this.transmuxers_[s].destroy());return e.next=7,Promise.all(t);case 7:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.video_&&(this.video_.removeAttribute("src"),this.video_.load(),this.video_=null),this.mediaSource_=null,this.textEngine_=null,this.textDisplayer_=null,this.sourceBuffers_={},this.transmuxers_={},this.captionParser_=null,kn.DEBUG)for(o in this.queues_)window.asserts.assert(0==this.queues_[o].length,o+" queue should be empty after destroy!");this.queues_={};case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"open",value:function(){return this.mediaSourceOpen_}},{key:"init",value:function(){var t=En(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,l,u,c,d=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=Re.ContentType,t.next=3,this.mediaSourceOpen_;case 3:for(a=!0,s=!1,o=void 0,t.prev=6,l=function(){var t=c.value,a=n.get(t);window.asserts.assert(e.isStreamSupported(a),"Type negotiation should happen before MediaSourceEngine.init!");var s=Ot.getFullType(a.mimeType,a.codecs);if(t==i.TEXT)d.reinitText(s);else{!r&&MediaSource.isTypeSupported(s)||!_n.isSupported(s,t)||(d.transmuxers_[t]=new _n,s=_n.convertTsCodecs(t,s));var o=d.mediaSource_.addSourceBuffer(s);console.log({sourceBuffer:o}),d.eventManager_.listen(o,"error",function(){return d.onError_(t)}),d.eventManager_.listen(o,"updateend",function(){return d.onUpdateEnd_(t)}),d.sourceBuffers_[t]=o,d.queues_[t]=[]}},u=n.keys()[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)l();t.next=15;break;case 11:t.prev=11,t.t0=t.catch(6),s=!0,o=t.t0;case 15:t.prev=15,t.prev=16,a||null==u.return||u.return();case 18:if(t.prev=18,!s){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}},t,this,[[6,11,15,23],[16,,18,22]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"reinitText",value:function(e){this.textEngine_||(this.textEngine_=new vn(this.textDisplayer_)),this.textEngine_.initParser(e)}},{key:"ended",value:function(){return!this.mediaSource_||"ended"==this.mediaSource_.readyState}},{key:"bufferStart",value:function(e){return e==Re.ContentType.TEXT?this.textEngine_.bufferStart():on.bufferStart(this.getBuffered_(e))}},{key:"bufferEnd",value:function(e){return e==Re.ContentType.TEXT?this.textEngine_.bufferEnd():on.bufferEnd(this.getBuffered_(e))}},{key:"isBuffered",value:function(e,t,n){if(e==Re.ContentType.TEXT)return this.textEngine_.isBuffered(t);var r=this.getBuffered_(e);return on.isBuffered(r,t,n)}},{key:"bufferedAheadOf",value:function(e,t){if(e==Re.ContentType.TEXT)return this.textEngine_.bufferedAheadOf(t);var n=this.getBuffered_(e);return on.bufferedAheadOf(n,t)}},{key:"getBufferedInfo",value:function(e){var t=Re.ContentType,n=on.getBufferedInfo;if(e.total=n(this.video_.buffered),e.audio=n(this.getBuffered_(t.AUDIO)),e.video=n(this.getBuffered_(t.VIDEO)),e.text=[],this.textEngine_){var r=this.textEngine_.bufferStart(),i=this.textEngine_.bufferEnd();null!=r&&null!=i&&e.text.push({start:r,end:i})}}},{key:"getBuffered_",value:function(e){try{return this.sourceBuffers_[e].buffered}catch(t){return e in this.sourceBuffers_&&Tn.log.error("failed to get buffered range for "+e,t),null}}},{key:"appendBuffer",value:function(){var e=En(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,l,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Re.ContentType,t!=s.TEXT){e.next=6;break}return e.next=4,this.textEngine_.appendBuffer(n,r,i);case 4:e.next=25;break;case 6:if(!this.transmuxers_[t]){e.next=16;break}return e.next=9,this.transmuxers_[t].transmux(n);case 9:return o=e.sent,this.textEngine_||this.reinitText("text/vtt"),o.captions&&(l=this.sourceBuffers_[s.VIDEO].timestampOffset,this.textEngine_.storeAndAppendClosedCaptions(o.captions,r,i,l)),e.next=14,this.enqueueOperation_(t,function(){return u.append_(t,o.data.buffer)});case 14:e.next=25;break;case 16:if(!a||!Jt.a){e.next=23;break}return this.textEngine_||this.reinitText("text/vtt"),null==r&&null==i?this.captionParser_.init(n):this.captionParser_.parseFrom(n,function(e){if(e.length){var t=u.sourceBuffers_[s.VIDEO].timestampOffset;u.textEngine_.storeAndAppendClosedCaptions(e,r,i,t)}}),e.next=21,this.enqueueOperation_(t,function(){return u.append_(t,n)});case 21:e.next=25;break;case 23:return e.next=25,this.enqueueOperation_(t,function(){return u.append_(t,n)});case 25:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"setSelectedClosedCaptionId",value:function(e){var t=Re.ContentType.VIDEO,n=this.bufferEnd(t)||0;this.textEngine_.setSelectedClosedCaptionId(e,n)}},{key:"remove",value:function(){var e=En(regeneratorRuntime.mark(function e(t,n,r){var i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(r<Number.MAX_VALUE,"remove() with MAX_VALUE or Infinity is not IE-compatible!"),i=Re.ContentType,t!=i.TEXT){e.next=7;break}return e.next=5,this.textEngine_.remove(n,r);case 5:e.next=9;break;case 7:return e.next=9,this.enqueueOperation_(t,function(){return a.remove_(t,n,r)});case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"clear",value:function(){var e=En(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Re.ContentType,t!=n.TEXT){e.next=9;break}if(this.textEngine_){e.next=4;break}return e.abrupt("return");case 4:return this.captionParser_.reset(),e.next=7,this.textEngine_.remove(0,1/0);case 7:e.next=11;break;case 9:return e.next=11,this.enqueueOperation_(t,function(){return r.remove_(t,0,r.mediaSource_.duration)});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"flush",value:function(){var e=En(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Re.ContentType,t!=n.TEXT){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.enqueueOperation_(t,function(){return r.flush_(t)});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setStreamProperties",value:function(){var e=En(regeneratorRuntime.mark(function e(t,n,r,i){var a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Re.ContentType,t!=a.TEXT){e.next=5;break}return this.textEngine_.setTimestampOffset(n),this.textEngine_.setAppendWindow(r,i),e.abrupt("return");case 5:return e.next=7,Promise.all([this.enqueueOperation_(t,function(){return s.abort_(t)}),this.enqueueOperation_(t,function(){return s.setTimestampOffset_(t,n)}),this.enqueueOperation_(t,function(){return s.setAppendWindow_(t,r,i)})]);case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"endOfStream",value:function(){var e=En(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enqueueBlockingOperation_(function(){t?n.mediaSource_.endOfStream(t):n.mediaSource_.endOfStream()});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setDuration",value:function(){var e=En(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(isNaN(this.mediaSource_.duration)||this.mediaSource_.duration<=t,"duration cannot decrease: "+this.mediaSource_.duration+" -> "+t),e.next=3,this.enqueueBlockingOperation_(function(){n.mediaSource_.duration=t});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getDuration",value:function(){return this.mediaSource_.duration}},{key:"append_",value:function(e,t){this.sourceBuffers_[e].appendBuffer(t)}},{key:"remove_",value:function(e,t,n){n<=t?this.onUpdateEnd_(e):this.sourceBuffers_[e].remove(t,n)}},{key:"abort_",value:function(e){var t=this.sourceBuffers_[e].appendWindowStart,n=this.sourceBuffers_[e].appendWindowEnd;this.sourceBuffers_[e].abort(),this.sourceBuffers_[e].appendWindowStart=t,this.sourceBuffers_[e].appendWindowEnd=n,this.onUpdateEnd_(e)}},{key:"flush_",value:function(e){window.asserts.assert(0==this.video_.buffered.length,"MediaSourceEngine.flush_ should only be used after clearing all data!"),this.video_.currentTime-=.001,this.onUpdateEnd_(e)}},{key:"setTimestampOffset_",value:function(e,t){t<0&&(t+=.001),this.sourceBuffers_[e].timestampOffset=t,this.onUpdateEnd_(e)}},{key:"setAppendWindow_",value:function(e,t,n){this.sourceBuffers_[e].appendWindowStart=0,this.sourceBuffers_[e].appendWindowEnd=n,this.sourceBuffers_[e].appendWindowStart=t,this.onUpdateEnd_(e)}},{key:"onError_",value:function(e){var t=this.queues_[e][0];window.asserts.assert(t,"Spurious error event!"),window.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on error!");var n=this.video_.error?this.video_.error.code:0;t.p.reject(new M(Sn.severity.CRITICAL,Sn.category.MEDIA,Sn.code.MEDIA_SOURCE_OPERATION_FAILED,n))}},{key:"onUpdateEnd_",value:function(e){var t=this.queues_[e][0];window.asserts.assert(t,"Spurious updateend event!"),t&&(window.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on updateend!"),t.p.resolve(),this.popFromQueue_(e))}},{key:"enqueueOperation_",value:function(e,t){this.destroyer_.ensureNotDestroyed();var n={start:t,p:new A};if(this.queues_[e].push(n),1==this.queues_[e].length)try{n.start()}catch(t){"QuotaExceededError"==t.name?n.p.reject(new M(Sn.severity.CRITICAL,Sn.category.MEDIA,Sn.code.QUOTA_EXCEEDED_ERROR,e)):n.p.reject(new M(Sn.severity.CRITICAL,Sn.category.MEDIA,Sn.code.MEDIA_SOURCE_OPERATION_THREW,t)),this.popFromQueue_(e)}return n.p}},{key:"enqueueBlockingOperation_",value:function(){var e=En(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i in this.destroyer_.ensureNotDestroyed(),n=[],r=function(e){var t=new A,r={start:function(){return t.resolve()},p:t};l.queues_[e].push(r),n.push(t),1==l.queues_[e].length&&r.start()},this.sourceBuffers_)r(i);return e.prev=4,e.next=7,Promise.all(n);case 7:if(kn.DEBUG)for(i in this.sourceBuffers_)window.asserts.assert(0==this.sourceBuffers_[i].updating,"SourceBuffers should not be updating after a blocking op!");try{t()}catch(e){a=Promise.reject(new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.MEDIA_SOURCE_OPERATION_THREW,e))}for(s in this.sourceBuffers_)this.popFromQueue_(s);return e.abrupt("return",a);case 13:if(e.prev=13,e.t0=e.catch(4),window.asserts.assert(this.destroyer_.destroyed(),"Should be destroyed by now"),kn.DEBUG)for(o in this.sourceBuffers_)this.queues_[o].length&&(window.asserts.assert(1==this.queues_[o].length,"Should be at most one item in queue!"),window.asserts.assert(n.includes(this.queues_[o][0].p),"The item in queue should be one of our waiters!"),this.queues_[o].shift());throw e.t0;case 18:case"end":return e.stop()}},e,this,[[4,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"popFromQueue_",value:function(e){this.queues_[e].shift();var t=this.queues_[e][0];if(t)try{t.start()}catch(n){t.p.reject(new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.MEDIA_SOURCE_OPERATION_THREW,n)),this.popFromQueue_(e)}}},{key:"getTextDisplayer",value:function(){return window.asserts.assert(this.textDisplayer_,"TextDisplayer should only be null when this is destroyed"),this.textDisplayer_}},{key:"setTextDisplayer",value:function(e){var t=this.textDisplayer_;this.textDisplayer_=e,t&&(e.setTextVisibility(t.isTextVisible()),t.destroy()),this.textEngine_&&this.textEngine_.setDisplayer(e)}}],r=[{key:"isStreamSupported",value:function(e){var t=Ot.getFullType(e.mimeType,e.codecs),n=Ot.getExtendedType(e);return vn.isTypeSupported(t)||MediaSource.isTypeSupported(n)||_n.isSupported(t,e.type)}},{key:"probeSupport",value:function(){for(var e={},t=0,n=['video/mp4; codecs="avc1.42E01E"','video/mp4; codecs="avc3.42E01E"','video/mp4; codecs="hev1.1.6.L93.90"','video/mp4; codecs="hvc1.1.6.L93.90"','video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084"','video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084"','video/mp4; codecs="vp9"','video/mp4; codecs="vp09.00.10.08"','audio/mp4; codecs="mp4a.40.2"','audio/mp4; codecs="ac-3"','audio/mp4; codecs="ec-3"','audio/mp4; codecs="opus"','audio/mp4; codecs="flac"','video/webm; codecs="vp8"','video/webm; codecs="vp9"','video/webm; codecs="vp09.00.10.08"','audio/webm; codecs="vorbis"','audio/webm; codecs="opus"','video/mp2t; codecs="avc1.42E01E"','video/mp2t; codecs="avc3.42E01E"','video/mp2t; codecs="hvc1.1.6.L93.90"','video/mp2t; codecs="mp4a.40.2"','video/mp2t; codecs="ac-3"','video/mp2t; codecs="ec-3"',"text/vtt",'application/mp4; codecs="wvtt"',"application/ttml+xml",'application/mp4; codecs="stpp"'];t<n.length;t++){var r=n[t];Ft.supportsMediaSource()?vn.isTypeSupported(r)?e[r]=!0:e[r]=MediaSource.isTypeSupported(r)||_n.isSupported(r):e[r]=Ft.supportsMediaType(r);var i=r.split(";")[0];e[i]=e[i]||e[r]}return e}}],n&&bn(t.prototype,n),r&&bn(t,r),e}();Cn.createObjectURL=window.URL.createObjectURL,Cn.Operation;var In=Cn;function An(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Rn=window.shaka,xn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"meetsRestrictions",value:function(e,t,n){var r=function(e,t,n){return e>=t&&e<=n},i=e.video;if(i&&i.width&&i.height){if(!r(i.width,t.minWidth,Math.min(t.maxWidth,n.width)))return!1;if(!r(i.height,t.minHeight,Math.min(t.maxHeight,n.height)))return!1;if(!r(i.width*i.height,t.minPixels,t.maxPixels))return!1}return!!r(e.bandwidth,t.minBandwidth,t.maxBandwidth)}},{key:"applyRestrictions",value:function(t,n,r){var i=!1,a=!0,s=!1,o=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=c.allowedByApplication;c.allowedByApplication=e.meetsRestrictions(c,n,r),d!=c.allowedByApplication&&(i=!0)}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}return i}},{key:"filterNewPeriod",value:function(t,n,r,i){n&&window.asserts.assert(e.isAudio(n),"Audio streams must have the audio type."),r&&window.asserts.assert(e.isVideo(r),"Video streams must have the video type."),i.variants=i.variants.filter(function(i){if(t&&t.initialized()&&!t.supportsVariant(i))return Rn.log.debug("Dropping variant - not compatible with key system",i),!1;var a=i.audio,s=i.video;return a&&!In.isStreamSupported(a)?(Rn.log.debug("Dropping variant - audio not compatible with platform",e.getStreamSummaryString_(a)),!1):s&&!In.isStreamSupported(s)?(Rn.log.debug("Dropping variant - video not compatible with platform",e.getStreamSummaryString_(s)),!1):a&&n&&!e.areStreamsCompatible_(a,n)?(Rn.log.debug("Droping variant - not compatible with active audio","active audio",e.getStreamSummaryString_(n),"variant.audio",e.getStreamSummaryString_(a)),!1):!(s&&r&&!e.areStreamsCompatible_(s,r))||(Rn.log.debug("Droping variant - not compatible with active video","active video",e.getStreamSummaryString_(r),"variant.video",e.getStreamSummaryString_(s)),!1)}),i.textStreams=i.textStreams.filter(function(e){var t=Ot.getFullType(e.mimeType,e.codecs),n=vn.isTypeSupported(t);return n||Rn.log.debug("Dropping text stream. Is not supported by the platform.",e),n})}},{key:"areStreamsCompatible_",value:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}},{key:"variantToTrack",value:function(e){var t=e.audio,n=e.video,r=t?t.codecs:null,i=n?n.codecs:null,a=[];i&&a.push(i),r&&a.push(r);var s=[];n&&s.push(n.mimeType),t&&s.push(t.mimeType);var o=s[0]||null,l=[];t&&l.push(t.kind),n&&l.push(n.kind);var u=l[0]||null,c=new Set;if(t){var d=!0,h=!1,f=void 0;try{for(var p,m=t.roles[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;c.add(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}if(n){var g=!0,y=!1,_=void 0;try{for(var w,E=n.roles[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var b=w.value;c.add(b)}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}}var S={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:u,width:null,height:null,frameRate:null,mimeType:o,codecs:a.join(", "),audioCodec:r,videoCodec:i,primary:e.primary,roles:Array.from(c),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};return n&&(S.videoId=n.id,S.originalVideoId=n.originalId,S.width=n.width||null,S.height=n.height||null,S.frameRate=n.frameRate||null,S.videoBandwidth=n.bandwidth||null),t&&(S.audioId=t.id,S.originalAudioId=t.originalId,S.channelsCount=t.channelsCount,S.audioBandwidth=t.bandwidth||null,S.label=t.label,S.audioRoles=t.roles),S}},{key:"textStreamToTrack",value:function(e){var t=Re.ContentType;return{id:e.id,active:!1,type:t.TEXT,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}}},{key:"html5TrackId",value:function(t){return t.__shaka_id||(t.__shaka_id=e.nextTrackId_++),t.__shaka_id}},{key:"html5TextTrackToTrack",value:function(t){var n=Ot.CLOSED_CAPTION_MIMETYPE,r=e.html5TrackToGenericShakaTrack_(t);return r.active="disabled"!=t.mode,r.type="text",r.originalTextId=t.id,"captions"==t.kind&&(r.mimeType=n),r}},{key:"html5AudioTrackToTrack",value:function(t){var n=e.html5TrackToGenericShakaTrack_(t);return n.active=t.enabled,n.type="variant",n.originalAudioId=t.id,"main"==t.kind?(n.primary=!0,n.roles=["main"],n.audioRoles=["main"]):n.audioRoles=[],n}},{key:"html5TrackToGenericShakaTrack_",value:function(t){return{id:e.html5TrackId(t),active:!1,type:"",bandwidth:0,language:Ne.normalize(t.language),label:t.label,kind:t.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}},{key:"isPlayable",value:function(e){return e.allowedByApplication&&e.allowedByKeySystem}},{key:"getPlayableVariants",value:function(t){return t.filter(function(t){return e.isPlayable(t)})}},{key:"filterVariantsByAudioChannelCount",value:function(e,t){var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),r=new Map,i=!0,a=!1,s=void 0;try{for(var o,l=n[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=u.audio.channelsCount;window.asserts.assert(null!=c,"Must have count after filtering!"),r.has(c)||r.set(c,[]),r.get(c).push(u)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var d=Array.from(r.keys());if(0==d.length)return e;var h=d.filter(function(e){return e<=t});return h.length?r.get(Math.max.apply(Math,An(h))):r.get(Math.min.apply(Math,An(d)))}},{key:"filterStreamsByLanguageAndRole",value:function(t,n,r){var i=t,a=t.filter(function(e){return e.primary});a.length&&(i=a);var s=i.length?i[0].language:"";if(i=i.filter(function(e){return e.language==s}),n){var o=Ne.findClosestLocale(Ne.normalize(n),t.map(function(e){return e.language}));o&&(i=t.filter(function(e){return Ne.normalize(e.language)==o}))}if(r){var l=e.filterTextStreamsByRole_(i,r);if(l.length)return l;Rn.log.warning("No exact match for the text role could be found.")}else{var u=i.filter(function(e){return 0==e.roles.length});if(u.length)return u}var c=i.map(function(e){return e.roles}).reduce(Ae.collapseArrays,[]);return c.length?e.filterTextStreamsByRole_(i,c[0]):i}},{key:"filterTextStreamsByRole_",value:function(e,t){return e.filter(function(e){return e.roles.includes(t)})}},{key:"getVariantByStreams",value:function(t,n,r){t&&window.asserts.assert(e.isAudio(t),"Audio streams must have the audio type."),n&&window.asserts.assert(e.isVideo(n),"Video streams must have the video type.");for(var i=0;i<r.length;i++)if(r[i].audio==t&&r[i].video==n)return r[i];return null}},{key:"isAudio",value:function(e){var t=Re.ContentType;return e.type==t.AUDIO}},{key:"isVideo",value:function(e){var t=Re.ContentType;return e.type==t.VIDEO}},{key:"getVariantStreams",value:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}},{key:"getStreamSummaryString_",value:function(t){return e.isAudio(t)?"type=audio codecs="+t.codecs+" bandwidth="+t.bandwidth+" channelsCount="+t.channelsCount:e.isVideo(t)?"type=video codecs="+t.codecs+" bandwidth="+t.bandwidth+" frameRate="+t.frameRate+" width="+t.width+" height="+t.height:"unexpected stream type"}}],(n=null)&&Ln(t.prototype,n),r&&Ln(t,r),e}());xn.nextTrackId_=0;var Nn=xn;function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Pn=window.shaka,On=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.switch_=null,this.enabled_=!1,this.bandwidthEstimator_=new It,this.variants_=[],this.startupComplete_=!1,this.lastTimeChosenMs_=null,this.config_=null}var t,n,r;return t=e,r=[{key:"filterAndSortVariants_",value:function(e,t){return e&&(t=t.filter(function(t){return window.asserts.assert(e,"Restrictions should exist!"),Nn.meetsRestrictions(t,e,{width:1/0,height:1/0})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}}],(n=[{key:"stop",value:function(){this.switch_=null,this.enabled_=!1,this.variants_=[],this.lastTimeChosenMs_=null}},{key:"init",value:function(e){this.switch_=e}},{key:"chooseVariant",value:function(){var t=e.filterAndSortVariants_(this.config_.restrictions,this.variants_),n=this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate);this.variants_.length&&!t.length&&(Pn.log.warning("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),t=[(t=e.filterAndSortVariants_(null,this.variants_))[0]]);for(var r=t[0]||null,i=0;i<t.length;++i){var a=t[i],s=t[i+1]||{bandwidth:1/0},o=a.bandwidth/this.config_.bandwidthDowngradeTarget,l=s.bandwidth/this.config_.bandwidthUpgradeTarget;Pn.log.v2("Bandwidth ranges:",(a.bandwidth/1e6).toFixed(3),(o/1e6).toFixed(3),(l/1e6).toFixed(3)),n>=o&&n<=l&&(r=a)}return this.lastTimeChosenMs_=Date.now(),r}},{key:"enable",value:function(){this.enabled_=!0}},{key:"disable",value:function(){this.enabled_=!1}},{key:"segmentDownloaded",value:function(e,t){Pn.log.v2("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.lastTimeChosenMs_,"enabled="+this.enabled_),window.asserts.assert(e>=0,"expected a non-negative duration"),this.bandwidthEstimator_.sample(e,t),null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()}},{key:"getBandwidthEstimate",value:function(){return this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate)}},{key:"setVariants",value:function(e){this.variants_=e}},{key:"configure",value:function(e){this.config_=e}},{key:"suggestStreams_",value:function(){if(Pn.log.v2("Suggesting Streams..."),window.asserts.assert(null!=this.lastTimeChosenMs_,"lastTimeChosenMs_ should not be null"),this.startupComplete_){if(Date.now()-this.lastTimeChosenMs_<1e3*this.config_.switchInterval)return void Pn.log.v2("Still within switch interval...")}else{if(!this.bandwidthEstimator_.hasGoodEstimate())return void Pn.log.v2("Still waiting for a good estimate...");this.startupComplete_=!0}var e=this.chooseVariant(),t=this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate),n=Math.round(t/1e3);Pn.log.debug("Calling switch_(), bandwidth="+n+" kbps"),this.switch_(e)}}])&&Mn(t.prototype,n),r&&Mn(t,r),e}());function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Un=window.shaka,Fn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createDefault",value:function(){var t=1e6,n=1/0;navigator.connection&&(t=1e6*navigator.connection.downlink,navigator.connection.saveData&&(n=360));var r={retryParameters:oe.defaultRetryParameters(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1},i={retryParameters:oe.defaultRetryParameters(),availabilityWindowOverride:NaN,dash:{customScheme:function(e){return e&&null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0}},a={retryParameters:oe.defaultRetryParameters(),failureCallback:function(e){Un.log.error("Unhandled streaming error",e)},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1};Ft.isWebOS()&&(a.stallEnabled=!1);var s={trackSelectionCallback:function(e){return e},progressCallback:function(e,t){Un.log.v2("Offline operation on",e.originalManifestUri,"progress at",t)},usePersistentLicense:!0},o={drm:r,manifest:i,streaming:a,offline:s,abrFactory:On,abr:{enabled:!0,defaultBandwidthEstimate:t,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:n,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return s.trackSelectionCallback=function(t){return e.defaultTrackSelect(t,o.preferredAudioLanguage)},o}},{key:"mergeConfigObjects",value:function(t,n,r){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return St.mergeConfigObjects(t,n,r||e.createDefault(),i,"")}},{key:"defaultTrackSelect",value:function(e,t){var n=Re.ContentType,r=e.filter(function(e){return"variant"==e.type}),i=[],a=Ne.findClosestLocale(t,r.map(function(e){return e.language}));(a&&(i=r.filter(function(e){return Ne.normalize(e.language)==a})),0==i.length&&(i=r.filter(function(e){return e.primary})),0==i.length)&&(new Set(r.map(function(e){return e.language})).size>1&&Un.log.warning("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=r);var s=i.filter(function(e){return e.height&&e.height<=480});s.length&&(s.sort(function(e,t){return t.height-e.height}),i=s.filter(function(e){return e.height==s[0].height}));var o=[];if(i.length){var l=Math.floor(i.length/2);i.sort(function(e,t){return e.bandwidth-t.bandwidth}),o.push(i[l])}var u=!0,c=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;p.type==n.TEXT&&o.push(p)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return o}}],(n=null)&&Dn(t.prototype,n),r&&Dn(t,r),e}());function Bn(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Vn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Bn(a,r,i,s,o,"next",e)}function o(e){Bn(a,r,i,s,o,"throw",e)}s(void 0)})}}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Gn=new M,jn=window.shaka,Kn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=null,r=[{key:"registerParserByExtension",value:function(t,n){e.parsersByExtension[t]=n}},{key:"registerParserByMime",value:function(t,n){e.parsersByMime[t]=n}},{key:"probeSupport",value:function(){var t={};if(Ft.supportsMediaSource()){for(var n in e.parsersByMime)t[n]=!0;for(var r in e.parsersByExtension)t[r]=!0}for(var i={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"},a=0,s=["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"];a<s.length;a++){var o=s[a];Ft.supportsMediaSource()?t[o]=!!e.parsersByMime[o]:t[o]=Ft.supportsMediaType(o)}for(var l in i)if(Ft.supportsMediaSource())t[l]=!!e.parsersByExtension[l];else{var u=i[l];t[l]=Ft.supportsMediaType(u)}return t}},{key:"create",value:function(){var t=Vn(regeneratorRuntime.mark(function t(n,r,i,a){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getFactory_(n,r,i,a);case 3:return s=t.sent,t.abrupt("return",new s);case 7:throw t.prev=7,t.t0=t.catch(0),window.asserts.assert(t.t0 instanceof M,"Incorrect error type"),t.t0.severity=Gn.severity.CRITICAL,t.t0;case 12:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getFactory_",value:function(){var t=Vn(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}if(!(s=e.parsersByMime[a.toLowerCase()])){t.next=4;break}return t.abrupt("return",s);case 4:jn.log.warning("Could not determine manifest type using MIME type ",a);case 5:if(!(o=e.getExtension(n))){t.next=13;break}if(!(l=e.parsersByExtension[o])){t.next=10;break}return t.abrupt("return",l);case 10:jn.log.warning("Could not determine manifest type for extension ",o),t.next=14;break;case 13:jn.log.warning("Could not find extension for ",n);case 14:if(a){t.next=23;break}return t.next=17,e.getMimeType(n,r,i);case 17:if(!(a=t.sent)){t.next=23;break}if(!(u=e.parsersByMime[a])){t.next=22;break}return t.abrupt("return",u);case 22:jn.log.warning("Could not determine manifest type using MIME type",a);case 23:throw new Gn(Gn.severity.CRITICAL,Gn.category.MANIFEST,Gn.code.UNABLE_TO_GUESS_MANIFEST_TYPE,n);case 24:case"end":return t.stop()}},t)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getMimeType",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=oe.RequestType.MANIFEST,(a=oe.makeRequest([t],r)).method="HEAD",e.next=5,n.request(i,a).promise;case 5:return s=e.sent,o=s.headers["content-type"],e.abrupt("return",o?o.toLowerCase():"");case 8:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getExtension",value:function(e){var t=new $(e).getPath().split("/").pop().split(".");return 1==t.length?"":t.pop().toLowerCase()}},{key:"isSupported",value:function(t,n){return!!Ft.supportsMediaSource()&&(n in e.parsersByMime||e.getExtension(t)in e.parsersByExtension)}}],n&&Hn(t.prototype,n),r&&Hn(t,r),e}());Kn.parsersByMime={},Kn.parsersByExtension={};var Wn=Kn;function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var zn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.estimatedTotal_=0,this.estimatedDownloaded_=0,this.actualDownloaded_=0,this.pending_=new Map,this.nextId_=0}var t,n,r;return t=e,(n=[{key:"open",value:function(e){this.estimatedTotal_+=e;var t=this.nextId_;return this.nextId_++,this.pending_.set(t,e),t}},{key:"close",value:function(e,t){if(this.pending_.has(e)){var n=this.pending_.get(e);this.pending_.delete(e),this.estimatedDownloaded_+=n,this.actualDownloaded_+=t}}},{key:"getEstimatedProgress",value:function(){return 0==this.estimatedTotal_?0:this.estimatedDownloaded_/this.estimatedTotal_}},{key:"getTotalDownloaded",value:function(){return this.actualDownloaded_}}])&&qn(t.prototype,n),r&&qn(t,r),e}();function Yn(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Xn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Yn(a,r,i,s,o,"next",e)}function o(e){Yn(a,r,i,s,o,"throw",e)}s(void 0)})}}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qn=window.shaka,Zn=(window.goog,function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.networkingEngine_=t,this.groups_=new Map,this.destroyer_=new Rt(function(){var e=Array.from(r.groups_.values());return Promise.all(e.map(function(e){return e.catch(function(){})}))}),this.onProgress_=n,this.estimator_=new zn}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"queue",value:function(e,t,n,r){var i=this;this.destroyer_.ensureNotDestroyed();var a=this.estimator_.open(n),s=this.groups_.get(e)||Promise.resolve();this.groups_.set(e,s.then(Xn(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.fetchSegment_(t);case 2:if(n=e.sent,!i.destroyer_.destroyed()){e.next=5;break}throw new Qn.util.Error(Qn.util.Error.Severity.CRITICAL,Qn.util.Error.Category.STORAGE,Qn.util.Error.Code.OPERATION_ABORTED);case 5:return i.estimator_.close(a,n.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),e.abrupt("return",r(n));case 8:case"end":return e.stop()}},e)}))))}},{key:"waitToFinish",value:function(){var e=Xn(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.groups_.values());case 2:return e.abrupt("return",this.estimator_.getTotalDownloaded());case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchSegment_",value:function(){var e=Xn(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=oe.RequestType.SEGMENT,r=this.networkingEngine_.request(n,t),e.next=4,r.promise;case 4:return i=e.sent,window.asserts.assert(i.data,"Response data should be non-null!"),e.abrupt("return",i.data);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}])&&$n(t.prototype,n),r&&$n(t,r),e}());function Jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var er=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type_=t,this.mechanism_=n,this.cell_=r,this.key_=i,this.asString_=["offline:",t,"/",n,"/",r,"/",i].join("")}var t,n,r;return t=e,r=[{key:"parse",value:function(t){var n=/^offline:([a-z]+)\/([^\/]+)\/([^\/]+)\/([0-9]+)$/.exec(t);if(null==n)return null;var r=n[1];if("manifest"!=r&&"segment"!=r)return null;var i=n[2];if(!i)return null;var a=n[3];if(!a)return null;var s=Number(n[4]);return null==r?null:new e(r,i,a,s)}},{key:"manifest",value:function(t,n,r){return new e("manifest",t,n,r)}},{key:"segment",value:function(t,n,r){return new e("segment",t,n,r)}}],(n=[{key:"isManifest",value:function(){return"manifest"==this.type_}},{key:"isSegment",value:function(){return"segment"==this.type_}},{key:"mechanism",value:function(){return this.mechanism_}},{key:"cell",value:function(){return this.cell_}},{key:"key",value:function(){return this.key_}},{key:"toString",value:function(){return this.asString_}}])&&Jn(t.prototype,n),r&&Jn(t,r),e}();function tr(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function nr(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){tr(a,r,i,s,o,"next",e)}function o(e){tr(a,r,i,s,o,"throw",e)}s(void 0)})}}function rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ir=window.shaka,ar=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"delete",value:function(){var e=nr(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,l,u,c,d,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=i,a=[],s=!0,o=!1,l=void 0,e.prev=5,u=i.createBuckets_(r)[Symbol.iterator]();case 7:if(s=(c=u.next()).done){e.next=17;break}return d=c.value,h=this.doDelete_(t,n,d),e.next=12,h;case 12:f=e.sent,a=a.concat(f);case 14:s=!0,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),o=!0,l=e.t0;case 23:e.prev=23,e.prev=24,s||null==u.return||u.return();case 26:if(e.prev=26,!o){e.next=29;break}throw l;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.abrupt("return",a);case 32:case"end":return e.stop()}},e,this,[[5,19,23,31],[24,,26,30]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"doDelete_",value:function(){var e=nr(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Qt({netEngine:n,onError:function(){},onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),e.prev=1,i.configure(t),e.next=5,i.initForRemoval(r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities);case 5:e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),ir.log.warning("Error initializing EME",e.t0),e.next=12,i.destroy();case 12:return e.abrupt("return",[]);case 13:return e.prev=13,e.next=16,i.setServerCertificate();case 16:e.next=24;break;case 18:return e.prev=18,e.t1=e.catch(13),ir.log.warning("Error setting server certificate",e.t1),e.next=23,i.destroy();case 23:return e.abrupt("return",[]);case 24:return a=[],e.next=27,Promise.all(r.sessionIds.map(function(){var e=nr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.removeSession(t);case 3:a.push(t),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),ir.log.warning("Error deleting offline session",e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()));case 27:return e.next=29,i.destroy();case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}},e,null,[[1,7],[13,18]])}));return function(t,n,r){return e.apply(this,arguments)}}()}],r=[{key:"createBuckets_",value:function(e){var t=t,n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){for(var l=s.value,u=!1,c=0,d=n;c<d.length;c++){var h=d[c];if(t.isCompatible_(h.info,l)){h.sessionIds.push(l.sessionId),u=!0;break}}u||n.push({info:l,sessionIds:[l.sessionId]})}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"isCompatible_",value:function(e,t){var n=function(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType};return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&f.hasSameElements(e.audioCapabilities,t.audioCapabilities,n)&&f.hasSameElements(e.videoCapabilities,t.videoCapabilities,n)}}],n&&rr(t.prototype,n),r&&rr(t,r),e}());ar.Bucket_={};var sr=ar;function or(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ur=window.shaka,cr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mechanisms_=new Map}var t,n,r;return t=e,n=[{key:"destroy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.mechanisms_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(s.destroy())}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return this.mechanisms_.clear(),Promise.all(e)}},{key:"init",value:function(){var t=this;e.getRegistry_().forEach(function(e,n){var r=e();r?t.mechanisms_.set(n,r):ur.log.info("Skipping "+n+" as it is not supported on this platform")});var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=this.mechanisms_.values()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;n.push(l.init())}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return Promise.all(n)}},{key:"getActive",value:function(){var e=null;if(this.mechanisms_.forEach(function(t,n){t.getCells().forEach(function(t,r){t.hasFixedKeySpace()||e||(e={path:{mechanism:n,cell:r},cell:t})})}),e)return e;throw new ur.util.Error(ur.util.Error.Severity.CRITICAL,ur.util.Error.Category.STORAGE,ur.util.Error.Code.MISSING_STORAGE_CELL,"Could not find a cell that supports add-operations")}},{key:"forEachCell",value:function(e){this.mechanisms_.forEach(function(t,n){t.getCells().forEach(function(t,r){e({mechanism:n,cell:r},t)})})}},{key:"getCell",value:function(e,t){var n=this.mechanisms_.get(e);if(!n)throw new ur.util.Error(ur.util.Error.Severity.CRITICAL,ur.util.Error.Category.STORAGE,ur.util.Error.Code.MISSING_STORAGE_CELL,"Could not find mechanism with name "+e);var r=n.getCells().get(t);if(!r)throw new ur.util.Error(ur.util.Error.Severity.CRITICAL,ur.util.Error.Category.STORAGE,ur.util.Error.Code.MISSING_STORAGE_CELL,"Could not find cell with name "+t);return r}},{key:"forEachEmeSessionCell",value:function(e){this.mechanisms_.forEach(function(t,n){e(t.getEmeSessionCell())})}},{key:"getEmeSessionCell",value:function(){var e=Array.from(this.mechanisms_.keys());if(!e.length)throw new ur.util.Error(ur.util.Error.Severity.CRITICAL,ur.util.Error.Category.STORAGE,ur.util.Error.Code.STORAGE_NOT_SUPPORTED,"No supported storage mechanisms found");return this.mechanisms_.get(e[0]).getEmeSessionCell()}},{key:"resolvePath",value:function(e){var t=this.mechanisms_.get(e.mechanism);return t?t.getCells().get(e.cell):null}},{key:"erase",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(this.mechanisms_.values()),(r=n.length>0)||e.getRegistry_().forEach(function(e,t){var r=e();r&&n.push(r)}),t.next=5,Promise.all(n.map(function(e){return e.erase()}));case 5:if(r){t.next=8;break}return t.next=8,Promise.all(n.map(function(e){return e.destroy()}));case 8:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){or(a,r,i,s,o,"next",e)}function o(e){or(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()}],r=[{key:"register",value:function(t,n){e.registry_.set(t,n)}},{key:"unregister",value:function(t){e.registry_.delete(t)}},{key:"support",value:function(){var t=e.getRegistry_(),n=!0,r=!1,i=void 0;try{for(var a,s=t.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=(0,a.value)();if(o)return o.destroy(),!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}},{key:"overrideSupport",value:function(t){e.override_=t}},{key:"clearOverride",value:function(){e.override_=null}},{key:"getRegistry_",value:function(){var t=e.override_,n=e.registry_;return window.COMPILED?n:t||n}}],n&&lr(t.prototype,n),r&&lr(t,r),e}();cr.override_=null,cr.registry_=new Map;var dr=cr;function hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fr=window.shaka,pr=window.goog,mr=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.presentationStartTime_=t,this.presentationDelay_=n,this.duration_=1/0,this.segmentAvailabilityDuration_=1/0,this.maxSegmentDuration_=1,this.minSegmentStartTime_=null,this.maxSegmentEndTime_=null,this.clockOffset_=0,this.static_=!0,this.userSeekStart_=0,this.autoCorrectDrift_=r}var t,n,r;return t=e,(n=[{key:"getDuration",value:function(){return this.duration_}},{key:"getMaxSegmentDuration",value:function(){return this.maxSegmentDuration_}},{key:"setDuration",value:function(e){window.asserts.assert(e>0,"duration must be > 0"),this.duration_=e}},{key:"getPresentationStartTime",value:function(){return this.presentationStartTime_}},{key:"setClockOffset",value:function(e){this.clockOffset_=e}},{key:"setStatic",value:function(e){this.static_=e}},{key:"setSegmentAvailabilityDuration",value:function(e){window.asserts.assert(e>=0,"segmentAvailabilityDuration must be >= 0"),this.segmentAvailabilityDuration_=e}},{key:"setDelay",value:function(e){window.asserts.assert(e>=0,"delay must be >= 0"),this.presentationDelay_=e}},{key:"getDelay",value:function(){return this.presentationDelay_}},{key:"notifySegments",value:function(e,t){if(0!=e.length){var n=e[0].startTime+t,r=e[e.length-1].endTime+t;if(this.notifyMinSegmentStartTime(n),this.maxSegmentDuration_=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.maxSegmentDuration_),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_){var i=(Date.now()+this.clockOffset_)/1e3;this.presentationStartTime_=i-this.maxSegmentEndTime_-this.maxSegmentDuration_}fr.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}}},{key:"notifyMinSegmentStartTime",value:function(e){null==this.minSegmentStartTime_?this.minSegmentStartTime_=e:this.minSegmentStartTime_=Math.min(this.minSegmentStartTime_,e)}},{key:"notifyMaxSegmentDuration",value:function(e){this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,e),fr.log.v1("notifyNewSegmentDuration:","maxSegmentDuration="+this.maxSegmentDuration_)}},{key:"offset",value:function(e){null!=this.minSegmentStartTime_&&(this.minSegmentStartTime_+=e),null!=this.maxSegmentEndTime_&&(this.maxSegmentEndTime_+=e)}},{key:"isLive",value:function(){return this.duration_==1/0&&!this.static_}},{key:"isInProgress",value:function(){return this.duration_!=1/0&&!this.static_}},{key:"getSegmentAvailabilityStart",value:function(){if(window.asserts.assert(this.segmentAvailabilityDuration_>=0,"The availability duration should be positive"),this.segmentAvailabilityDuration_==1/0)return this.userSeekStart_;var e=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return Math.max(this.userSeekStart_,e)}},{key:"setUserSeekStart",value:function(e){this.userSeekStart_=e}},{key:"getSegmentAvailabilityEnd",value:function(){return this.isLive()||this.isInProgress()?Math.min(this.getLiveEdge_(),this.duration_):this.duration_}},{key:"getSafeSeekRangeStart",value:function(e){var t=Math.max(this.minSegmentStartTime_,this.userSeekStart_);if(this.segmentAvailabilityDuration_==1/0)return t;var n=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_,r=Math.min(n+e,this.getSeekRangeEnd());return Math.max(t,r)}},{key:"getSeekRangeStart",value:function(){return this.getSafeSeekRangeStart(0)}},{key:"getSeekRangeEnd",value:function(){var e=this.isLive()||this.isInProgress()?this.presentationDelay_:0;return Math.max(0,this.getSegmentAvailabilityEnd()-e)}},{key:"usingPresentationStartTime",value:function(){return null!=this.presentationStartTime_&&null==this.maxSegmentEndTime_}},{key:"getLiveEdge_",value:function(){window.asserts.assert(null!=this.presentationStartTime_,"Cannot compute timeline live edge without start time");var e=(Date.now()+this.clockOffset_)/1e3;return Math.max(0,e-this.maxSegmentDuration_-this.presentationStartTime_)}},{key:"assertIsValid",value:function(){pr.DEBUG&&(this.isLive()?window.asserts.assert(null!=this.presentationStartTime_,"Detected as live stream, but does not match our model of live!"):this.isInProgress()?window.asserts.assert(null!=this.presentationStartTime_&&this.segmentAvailabilityDuration_==1/0,"Detected as IPR stream, but does not match our model of IPR!"):window.asserts.assert(this.segmentAvailabilityDuration_==1/0&&this.duration_!=1/0&&this.static_,"Detected as VOD stream, but does not match our model of VOD!"))}}])&&hr(t.prototype,n),r&&hr(t,r),e}();function vr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yr(e,t,n){return t&&gr(e.prototype,t),n&&gr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var _r=function(){function e(t,n,r){vr(this,e),this.getUris=t,this.startByte=n,this.endByte=r}return yr(e,[{key:"createUris",value:function(){return this.getUris()}},{key:"getStartByte",value:function(){return this.startByte}},{key:"getEndByte",value:function(){return this.endByte}},{key:"getSize",value:function(){return this.endByte?this.endByte-this.startByte:null}}]),e}(),wr=function(){function e(t,n,r,i,a,s){vr(this,e),window.asserts.assert(n<r,"startTime must be less than endTime"),window.asserts.assert(a<s||null==s,"startByte must be < endByte"),this.position=t,this.startTime=n,this.endTime=r,this.getUris=i,this.startByte=a,this.endByte=s}return yr(e,[{key:"getPosition",value:function(){return this.position}},{key:"getStartTime",value:function(){return this.startTime}},{key:"getEndTime",value:function(){return this.endTime}},{key:"createUris",value:function(){return this.getUris()}},{key:"getStartByte",value:function(){return this.startByte}},{key:"getEndByte",value:function(){return this.endByte}},{key:"getSize",value:function(){return this.endByte?this.endByte-this.startByte:null}}]),e}();function Er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var br=window.shaka,Sr=window.goog,Tr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Sr.DEBUG&&e.assertCorrectReferences_(t),this.references_=t}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.references_=null,Promise.resolve()}},{key:"find",value:function(e){for(var t=this.references_.length-1;t>=0;--t){var n=this.references_[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.references_.length&&e<this.references_[0].startTime?this.references_[0].position:null}},{key:"get",value:function(e){if(0==this.references_.length)return null;var t=e-this.references_[0].position;return t<0||t>=this.references_.length?null:this.references_[t]}},{key:"offset",value:function(e){for(var t=0;t<this.references_.length;++t)this.references_[t].startTime+=e,this.references_[t].endTime+=e}},{key:"merge",value:function(t){Sr.DEBUG&&e.assertCorrectReferences_(t);for(var n=[],r=0,i=0;r<this.references_.length&&i<t.length;){var a=this.references_[r],s=t[i];if(a.startTime<s.startTime)n.push(a),r++;else if(a.startTime>s.startTime)0==r?n.push(s):br.log.warning("Refusing to rewrite original references on update!"),i++;else{if(Math.abs(a.endTime-s.endTime)>.1){window.asserts.assert(s.endTime>a.endTime&&r==this.references_.length-1&&i==t.length-1,"This should be an update of the last segment in a period");var o=new wr(a.position,s.startTime,s.endTime,s.getUris,s.startByte,s.endByte);n.push(o)}else n.push(a);r++,i++}}for(;r<this.references_.length;)n.push(this.references_[r++]);if(n.length)for(var l=n[n.length-1].position+1;i<t.length;){var u=t[i++],c=new wr(l++,u.startTime,u.endTime,u.getUris,u.startByte,u.endByte);n.push(c)}else n=t;Sr.DEBUG&&e.assertCorrectReferences_(n),this.references_=n}},{key:"replace",value:function(t){Sr.DEBUG&&e.assertCorrectReferences_(t),this.references_=t}},{key:"evict",value:function(e){for(var t=0;t<this.references_.length;++t)if(this.references_[t].endTime>e)return void this.references_.splice(0,t);this.references_=[]}},{key:"fit",value:function(e){for(window.asserts.assert(null!=e,"Period duration must be known for static content!"),window.asserts.assert(e!=1/0,"Period duration must be finite for static content!");this.references_.length;){if(!(this.references_[this.references_.length-1].startTime>=e))break;this.references_.pop()}for(;this.references_.length;){if(!(this.references_[0].endTime<=0))break;this.references_.shift()}if(0!=this.references_.length){var t=this.references_[this.references_.length-1];this.references_[this.references_.length-1]=new wr(t.position,t.startTime,e,t.getUris,t.startByte,t.endByte)}}}])&&Er(t.prototype,n),r&&Er(t,r),e}();function kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Sr.DEBUG&&(Tr.assertCorrectReferences_=function(e){window.asserts.assert(e.every(function(t,n){if(0==n)return!0;var r=e[n-1];return t.position==r.position+1&&(r.startTime<t.startTime||!(r.startTime>t.startTime)&&r.endTime<=t.endTime)}),"SegmentReferences are incorrect")});
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Cr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mechanism_=t,this.cell_=n}var t,n,r;return t=e,(n=[{key:"fromManifestDB",value:function(e){var t=this,n=new mr(null,0);n.setDuration(e.duration);var r=e.periods.map(function(e){return t.fromPeriodDB(e,n)}),i=e.drmInfo?[e.drmInfo]:[];if(e.drmInfo){var a=!0,s=!1,o=void 0;try{for(var l,u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=!0,h=!1,f=void 0;try{for(var p,m=c.variants[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){p.value.drmInfos=i}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}}return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:r}}},{key:"fromPeriodDB",value:function(e,t){var n=this,r=e.streams.filter(function(e){return n.isAudio_(e)}),i=e.streams.filter(function(e){return n.isVideo_(e)}),a=this.createVariants(r,i),s=e.streams.filter(function(e){return n.isText_(e)}).map(function(e){return n.fromStreamDB_(e)}),o=!0,l=!1,u=void 0;try{for(var c,d=e.streams[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value.segments.map(function(e,t){return n.fromSegmentDB_(t,e)});t.notifySegments(h,e.startTime)}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}return{startTime:e.startTime,variants:Array.from(a.values()),textStreams:s}}},{key:"createVariants",value:function(e,t){var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=!0,c=!1,d=void 0;try{for(var h,f=l.variantIds[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;n.add(p)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var m=!0,v=!1,g=void 0;try{for(var y,_=t[Symbol.iterator]();!(m=(y=_.next()).done);m=!0){var w=y.value,E=!0,b=!1,S=void 0;try{for(var T,k=w.variantIds[Symbol.iterator]();!(E=(T=k.next()).done);E=!0){var C=T.value;n.add(C)}}catch(e){b=!0,S=e}finally{try{E||null==k.return||k.return()}finally{if(b)throw S}}}}catch(e){v=!0,g=e}finally{try{m||null==_.return||_.return()}finally{if(v)throw g}}var I=new Map,A=!0,L=!1,R=void 0;try{for(var x,N=n[Symbol.iterator]();!(A=(x=N.next()).done);A=!0){var M=x.value;I.set(M,this.createEmptyVariant_(M))}}catch(e){L=!0,R=e}finally{try{A||null==N.return||N.return()}finally{if(L)throw R}}var P=!0,O=!1,D=void 0;try{for(var U,F=e[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value,V=this.fromStreamDB_(B),H=!0,G=!1,j=void 0;try{for(var K,W=B.variantIds[Symbol.iterator]();!(H=(K=W.next()).done);H=!0){var q=K.value,z=I.get(q);window.asserts.assert(!z.audio,"A variant should only have one audio stream"),z.language=V.language,z.primary=z.primary||V.primary,z.audio=V}}catch(e){G=!0,j=e}finally{try{H||null==W.return||W.return()}finally{if(G)throw j}}}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}var Y=!0,X=!1,$=void 0;try{for(var Q,Z=t[Symbol.iterator]();!(Y=(Q=Z.next()).done);Y=!0){var J=Q.value,ee=this.fromStreamDB_(J),te=!0,ne=!1,re=void 0;try{for(var ie,ae=J.variantIds[Symbol.iterator]();!(te=(ie=ae.next()).done);te=!0){var se=ie.value,oe=I.get(se);window.asserts.assert(!oe.video,"A variant should only have one video stream"),oe.primary=oe.primary||ee.primary,oe.video=ee}}catch(e){ne=!0,re=e}finally{try{te||null==ae.return||ae.return()}finally{if(ne)throw re}}}}catch(e){X=!0,$=e}finally{try{Y||null==Z.return||Z.return()}finally{if(X)throw $}}return I}},{key:"fromStreamDB_",value:function(e){var t=this,n=e.segments.map(function(e,n){return t.fromSegmentDB_(n,e)}),r=new Tr(n),i={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return r.find(e)},getSegmentReference:function(e){return r.get(e)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null};return null!=e.initSegmentKey&&(i.initSegmentReference=this.fromInitSegmentDB_(e.initSegmentKey)),i}},{key:"fromSegmentDB_",value:function(e,t){var n=er.segment(this.mechanism_,this.cell_,t.dataKey);return new wr(e,t.startTime,t.endTime,function(){return[n.toString()]},0,null)}},{key:"fromInitSegmentDB_",value:function(e){var t=er.segment(this.mechanism_,this.cell_,e);return new _r(function(){return[t.toString()]},0,null)}},{key:"isAudio_",value:function(e){var t=Re.ContentType;return e.contentType==t.AUDIO}},{key:"isVideo_",value:function(e){var t=Re.ContentType;return e.contentType==t.VIDEO}},{key:"isText_",value:function(e){var t=Re.ContentType;return e.contentType==t.TEXT}},{key:"createEmptyVariant_",value:function(e){return{id:e,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0}}}])&&kr(t.prototype,n),r&&kr(t,r),e}();function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ar=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fromManifest",value:function(t,n,r,i){window.asserts.assert(n.periods.length,"Cannot create stored content from manifest with no periods.");var a=null==n.expiration?1/0:n.expiration,s=n.presentationTimeline.getDuration(),o=n.periods[0];return{offlineUri:null,originalManifestUri:t,duration:s,size:r,expiration:a,tracks:e.getTracks_(o),appMetadata:i}}},{key:"fromManifestDB",value:function(t,n){window.asserts.assert(n.periods.length,"Cannot create stored content from manifestDB with no periods.");var r=new Cr(t.mechanism(),t.cell()),i=n.periods[0],a=new mr(null,0),s=r.fromPeriodDB(i,a),o=n.appMetadata||{},l=e.getTracks_(s);return{offlineUri:t.toString(),originalManifestUri:n.originalManifestUri,duration:n.duration,size:n.size,expiration:n.expiration,tracks:l,appMetadata:o}}},{key:"getTracks_",value:function(e){var t=Nn,n=[],r=t.getPlayableVariants(e.variants),i=!0,a=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;n.push(t.variantToTrack(u))}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var c=e.textStreams,d=!0,h=!1,f=void 0;try{for(var p,m=c[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;n.push(t.textStreamToTrack(v))}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}return n}}],(n=null)&&Ir(t.prototype,n),r&&Ir(t,r),e}();function Lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Rr=window.shaka,xr=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.estimateByStreamId_={}}var t,n,r;return t=e,(n=[{key:"addVariant",value:function(t){var n=t.audio,r=t.video;if(n&&!r){var i=n.bandwidth||t.bandwidth;this.setBitrate_(n.id,i)}if(!n&&r){var a=r.bandwidth||t.bandwidth;this.setBitrate_(r.id,a)}if(n&&r){var s=n.bandwidth||e.DEFAULT_AUDIO_BITRATE_,o=r.bandwidth||t.bandwidth-s;o<=0&&(Rr.log.warning("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),o=t.bandwidth),this.setBitrate_(n.id,s),this.setBitrate_(r.id,o)}}},{key:"setBitrate_",value:function(e,t){this.estimateByStreamId_[e]=t}},{key:"addText",value:function(t){this.estimateByStreamId_[t.id]=e.DEFAULT_TEXT_BITRATE_}},{key:"getSegmentEstimate",value:function(e,t){var n=t.endTime-t.startTime;return this.getEstimate_(e)*n}},{key:"getInitSegmentEstimate",value:function(e){return.5*this.getEstimate_(e)}},{key:"getEstimate_",value:function(e){var t=this.estimateByStreamId_[e];return null==t&&(t=0,Rr.log.error("Asking for bitrate of stream not given to the estimator")),0==t&&Rr.log.warning("Using bitrate of 0, this stream won't affect progress"),t}}])&&Lr(t.prototype,n),r&&Lr(t,r),e}());xr.DEFAULT_AUDIO_BITRATE_=393216,xr.DEFAULT_TEXT_BITRATE_=52;var Nr=xr;function Mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Or(e,t,n){return t&&Pr(e.prototype,t),n&&Pr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var Dr=function(){function e(){Mr(this,e)}return Or(e,null,[{key:"filterByRestrictions",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=e.periods[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;l.variants=l.variants.filter(function(e){return Nn.meetsRestrictions(e,t,n)})}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"filterByMediaSourceSupport",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.periods[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;s.variants=s.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&In.isStreamSupported(e.audio)),e.video&&(t=t&&In.isStreamSupported(e.video)),t})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"filterByDrmSupport",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.variants=o.variants.filter(function(e){return t.supportsVariant(e)})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"filterByCommonCodecs",value:function(t){window.asserts.assert(t.periods.length>0,"There should be at least be one period");var n=new e.VariantCodecSummarySet,r=!0,i=!0,a=!1,s=void 0;try{for(var o,l=t.periods[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=e.VariantCodecSummarySet.fromVariants(u.variants);r?(n.includeAll(c),r=!1):n.onlyKeep(c)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=t.periods[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.variants=v.variants.filter(function(t){var r=new e.VariantCodecSummary(t);return n.contains(r)})}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"rollingFilter",value:function(t,n){var r=null,i=!0,a=!1,s=void 0;try{for(var o,l=t.periods[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;r&&(u.variants=u.variants.filter(function(t){var n=new e.VariantCodecSummary(t);return r.contains(n)})),n(u),r=e.VariantCodecSummarySet.fromVariants(u.variants)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}}}]),e}();Dr.VariantCodecSummary=function(){function e(t){Mr(this,e);var n=t.audio,r=t.video;this.audioMime_=n?n.mimeType:null,this.audioCodec_=n?n.codecs.split(".")[0]:null,this.videoMime_=r?r.mimeType:null,this.videoCodec_=r?r.codecs.split(".")[0]:null}return Or(e,[{key:"equals",value:function(e){return this.audioMime_==e.audioMime_&&this.audioCodec_==e.audioCodec_&&this.videoMime_==e.videoMime_&&this.videoCodec_==e.videoCodec_}}]),e}(),Dr.VariantCodecSummarySet=function(){function e(){Mr(this,e),this.all_=[]}return Or(e,[{key:"add",value:function(e){this.contains(e)||this.all_.push(e)}},{key:"includeAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.all_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.add(s)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onlyKeep",value:function(e){this.all_=this.all_.filter(function(t){return e.contains(t)})}},{key:"contains",value:function(e){return this.all_.some(function(t){return e.equals(t)})}}],[{key:"fromVariants",value:function(e){var t=new Dr.VariantCodecSummarySet,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.add(new Dr.VariantCodecSummary(o))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}}]),e}();var Ur=Dr;function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Br=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createSegmentRequest",value:function(e,t,n,r){var i=oe.makeRequest(e,r);return 0==t&&null==n||(i.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),i}}],(n=null)&&Fr(t.prototype,n),r&&Fr(t,r),e}();function Vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Hr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getAllVariantsFrom",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=!0,u=!1,c=void 0;try{for(var d,h=o.variants[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;t.push(f)}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"findPeriodForTime",value:function(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;t>=l.startTime&&(n=l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}}],(n=null)&&Vr(t.prototype,n),r&&Vr(t,r),e}();function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Kr=function(){function e(){Gr(this,e),this.history_=new Map}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this.history_.clear()}},{key:"useVariant",value:function(e,t){this.getFrameFor_(e).variant=t}},{key:"useText",value:function(e,t){this.getFrameFor_(e).text=t}},{key:"getVariant",value:function(e){return this.getFrameFor_(e).variant}},{key:"getText",value:function(e){return this.getFrameFor_(e).text}},{key:"getFrameFor_",value:function(t){if(!this.history_.has(t)){var n=new e.Frame;this.history_.set(t,n)}return this.history_.get(t)}}])&&jr(t.prototype,n),r&&jr(t,r),e}();Kr.Frame=function(){return function e(){Gr(this,e),this.variant=null,this.text=null}}();var Wr=Kr;function qr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var zr=window.shaka,Yr=(window.goog,function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root_=t,this.variants_=new Set([t]),n=n||[];var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;this.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}var t,n,r;return t=e,r=[{key:"areAdaptable",value:function(t,n){return!!t.audio==!!n.audio&&(!!t.video==!!n.video&&(t.language==n.language&&(window.asserts.assert(!!t.audio==!!n.audio,"Both should either have audio or not have audio."),!(t.audio&&n.audio&&!e.areAudiosCompatible_(t.audio,n.audio))&&(window.asserts.assert(!!t.video==!!n.video,"Both should either have video or not have video."),!(t.video&&n.video&&!e.areVideosCompatible_(t.video,n.video))))))}},{key:"areAudiosCompatible_",value:function(t,n){return t.channelsCount==n.channelsCount&&(!!e.canTransitionBetween_(t,n)&&!!e.areRolesEqual_(t.roles,n.roles))}},{key:"areVideosCompatible_",value:function(t,n){return!!e.canTransitionBetween_(t,n)&&!!e.areRolesEqual_(t.roles,n.roles)}},{key:"canTransitionBetween_",value:function(e,t){if(e.mimeType!=t.mimeType)return!1;var n=Ot.splitCodecs(e.codecs).map(function(e){return Ot.getCodecBase(e)}),r=Ot.splitCodecs(t.codecs).map(function(e){return Ot.getCodecBase(e)});if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=0;i<n.length;i++)if(n[i]!=r[i])return!1;return!0}},{key:"areRolesEqual_",value:function(e,t){var n=new Set(e),r=new Set(t);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;var i=!0,a=!1,s=void 0;try{for(var o,l=n[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;if(!r.has(u))return!1}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}return!0}}],(n=[{key:"add",value:function(e){return this.canInclude(e)?(this.variants_.add(e),!0):(zr.log.warning("Rejecting variant - not compatible with root."),!1)}},{key:"canInclude",value:function(t){return e.areAdaptable(this.root_,t)}},{key:"values",value:function(){return this.variants_.values()}}])&&qr(t.prototype,n),r&&qr(t,r),e}());function Xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qr(e,t,n){return t&&$r(e.prototype,t),n&&$r(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zr=window.shaka,Jr=function(){function e(t){Xr(this,e),this.example_=t;var n=t.audio&&t.audio.channelsCount?t.audio.channelsCount:0;this.fallback_=new ei(t.language,"",n)}return Qr(e,[{key:"create",value:function(e){var t=this,n=e.filter(function(e){return Yr.areAdaptable(t.example_,e)});return n.length?new Yr(n[0],n):this.fallback_.create(e)}}]),e}(),ei=function(){function e(t,n,r){Xr(this,e),this.language_=t,this.role_=n,this.channelCount_=r}return Qr(e,[{key:"create",value:function(t){var n=e,r=[],i=n.filterByLanguage_(t,this.language_),a=t.filter(function(e){return e.primary});if(r=i.length?i:a.length?a:t,this.role_){var s=n.filterVariantsByRole_(r,this.role_);s.length?r=s:Zr.log.warning("No exact match for variant role could be found.")}if(this.channelCount_){var o=Nn.filterVariantsByAudioChannelCount(r,this.channelCount_);o.length?r=o:Zr.log.warning("No exact match for the channel count could be found.")}var l=new Yr(r[0]),u=!0,c=!1,d=void 0;try{for(var h,f=r[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;l.canInclude(p)&&l.add(p)}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return l}}],[{key:"filterByLanguage_",value:function(e,t){var n=Ne.normalize(t),r=Ne.findClosestLocale(n,e.map(function(e){return Ne.getLocaleForVariant(e)}));return r?e.filter(function(e){return r==Ne.getLocaleForVariant(e)}):[]}},{key:"filterVariantsByRole_",value:function(e,t){return e.filter(function(e){var n=e.audio,r=e.video;return n&&n.roles.indexOf(t)>=0||r&&r.roles.indexOf(t)>=0})}}]),e}();function ti(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var ni=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=e.State;this.previousState_=r.SATISFIED,this.thresholds_=(new Map).set(r.SATISFIED,n).set(r.STARVING,t)}var t,n,r;return t=e,(n=[{key:"update",value:function(t,n){var r=e.State,i=this.thresholds_.get(this.previousState_),a=this.previousState_,s=n||t>=i?r.SATISFIED:r.STARVING;return this.previousState_=s,a!=s}},{key:"setState",value:function(e){this.previousState_=e}},{key:"getState",value:function(){return this.previousState_}}])&&ti(t.prototype,n),r&&ti(t,r),e}();ni.State={STARVING:0,SATISFIED:1};var ri=ni;function ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ai=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest_=t,this.currentPeriod_=null,this.onChangedPeriods_=function(e){}}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.manifest_=null,this.currentPeriod_=null,this.onChangedPeriods_=function(e){}}},{key:"poll",value:function(e,t){var n=this.currentPeriod_,r=this.findCurrentPeriod_(e);n!=r&&this.onChangedPeriods_(r),this.currentPeriod_=r}},{key:"setListeners",value:function(e){this.onChangedPeriods_=e}},{key:"findCurrentPeriod_",value:function(e){var t=this.manifest_.periods;return Hr.findPeriodForTime(t,e)||t[0]}}])&&ii(t.prototype,n),r&&ii(t,r),e}();function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var oi=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.harness_=t,this.isBuffering_=!1,this.rate_=this.harness_.getRate(),this.pollRate_=.25,this.timer_=new H(function(){n.harness_.movePlayhead(n.rate_*n.pollRate_)})}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.harness_=null}},{key:"setBuffering",value:function(e){this.isBuffering_=e,this.apply_()}},{key:"set",value:function(e){window.asserts.assert(0!=e,"Should never set rate of 0 explicitly!"),this.rate_=e,this.apply_()}},{key:"getActiveRate",value:function(){return this.calculateCurrentRate_()}},{key:"apply_",value:function(){this.timer_.stop();var e=this.calculateCurrentRate_();if(e>=0)try{return void this.applyRate_(e)}catch(e){}this.timer_.tickEvery(this.pollRate_),this.applyRate_(0)}},{key:"calculateCurrentRate_",value:function(){return this.isBuffering_?0:this.rate_}},{key:"applyRate_",value:function(e){var t=this.harness_.getRate();return t!=e&&this.harness_.setRate(e),t!=e}}])&&si(t.prototype,n),r&&si(t,r),e}();oi.Harness;var li=oi;function ui(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function di(e,t,n){return t&&ci(e.prototype,t),n&&ci(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hi=window.shaka,fi=(window.goog,function(){function e(t,n,r){ui(this,e),this.video_=t,this.onSeek_=n,this.startTime_=r,this.eventManager_=new Ke,this.mover_=new pi(t,10),t.readyState>0?this.setStartTime_(r):this.delaySetStartTime_(r)}return di(e,[{key:"release",value:function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.mover_&&(this.mover_.release(),this.mover_=null),this.onSeek_=function(){},this.video_=null}},{key:"getTime",value:function(){return this.video_.readyState>0?this.video_.currentTime:this.startTime_}},{key:"setTime",value:function(e){this.video_.readyState>0?this.mover_.moveTo(e):this.delaySetStartTime_(e)}},{key:"delaySetStartTime_",value:function(e){var t=this;this.startTime_=e,this.eventManager_.unlisten(this.video_,"loadedmetadata"),this.eventManager_.listenOnce(this.video_,"loadedmetadata",function(){t.setStartTime_(e)})}},{key:"setStartTime_",value:function(e){var t=this;Math.abs(this.video_.currentTime-e)<.001?this.startListeningToSeeks_():(this.eventManager_.listenOnce(this.video_,"seeking",function(){t.startListeningToSeeks_()}),this.mover_.moveTo(0==this.video_.currentTime?e:this.video_.currentTime))}},{key:"startListeningToSeeks_",value:function(){var e=this;window.asserts.assert(this.video_.readyState>0,"The media element should be ready before we listen for seeking."),this.eventManager_.listen(this.video_,"seeking",function(){return e.onSeek_()})}}]),e}()),pi=function(){function e(t,n){var r=this;ui(this,e),this.mediaElement_=t,this.maxAttempts_=n,this.remainingAttempts_=0,this.originTime_=0,this.targetTime_=0,this.timer_=new H(function(){return r.onTick_()})}return di(e,[{key:"release",value:function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.mediaElement_=null}},{key:"moveTo",value:function(e){this.originTime_=this.mediaElement_.currentTime,this.targetTime_=e,this.remainingAttempts_=this.maxAttempts_,this.mediaElement_.currentTime=e,this.timer_.tickEvery(.1)}},{key:"onTick_",value:function(){if(this.remainingAttempts_<=0)return hi.log.warning(["Failed to move playhead from",this.originTime_,"to",this.targetTime_].join(" ")),void this.timer_.stop();this.mediaElement_.currentTime==this.originTime_?(this.mediaElement_.currentTime=this.targetTime_,this.remainingAttempts_--):this.timer_.stop()}}]),e}();function mi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gi(e,t,n){return t&&vi(e.prototype,t),n&&vi(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var yi=function(){function e(t,n){mi(this,e),this.implementation_=t,this.wasMakingProgress_=t.shouldBeMakingProgress(),this.value_=t.getPresentationSeconds(),this.lastUpdateSeconds_=t.getWallSeconds(),this.stallThresholdSeconds_=n,this.onStall_=function(){}}return gi(e,[{key:"release",value:function(){this.implementation_=null,this.onStall_=function(){}}},{key:"onStall",value:function(e){this.onStall_=e}},{key:"poll",value:function(){var e=this.implementation_,t=e.shouldBeMakingProgress(),n=e.getPresentationSeconds(),r=e.getWallSeconds();(this.value_!=n||this.wasMakingProgress_!=t)&&(this.lastUpdateSeconds_=r,this.value_=n,this.wasMakingProgress_=t);var i=r-this.lastUpdateSeconds_;i>=this.stallThresholdSeconds_&&t&&this.onStall_(this.value_,i)}}]),e}(),_i=function(){function e(t){mi(this,e),this.mediaElement_=t}return gi(e,[{key:"shouldBeMakingProgress",value:function(){return!this.mediaElement_.paused&&(0!=this.mediaElement_.playbackRate&&(null!=this.mediaElement_.buffered&&e.hasContentFor_(this.mediaElement_.buffered,this.mediaElement_.currentTime)))}},{key:"getPresentationSeconds",value:function(){return this.mediaElement_.currentTime}},{key:"getWallSeconds",value:function(){return Date.now()/1e3}}],[{key:"hasContentFor_",value:function(e,t){for(var n=0;n<e.length;n++){var r=e.start(n),i=e.end(n);if(!(t<r)&&!(t>i-.5))return!0}return!1}}]),e}();function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ei=window.shaka,bi=function(){function e(t,n,r,i,a){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=t,this.timeline_=n,this.config_=r,this.onEvent_=a,this.eventManager_=new Ke,this.seekingEventReceived_=!1,this.prevReadyState_=t.readyState,this.didFireLargeGap_=!1,this.stallDetector_=i,this.hadSegmentAppended_=!1,this.eventManager_.listen(t,"waiting",function(){return s.onPollGapJump_()}),this.gapJumpTimer_=new H(function(){s.onPollGapJump_()}).tickEvery(.25)}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.gapJumpTimer_&&(this.gapJumpTimer_.stop(),this.gapJumpTimer_=null),this.stallDetector_&&(this.stallDetector_.release(),this.stallDetector_=null),this.onEvent_=null,this.timeline_=null,this.video_=null}},{key:"onSegmentAppended",value:function(){this.hadSegmentAppended_=!0,this.onPollGapJump_()}},{key:"onSeeking",value:function(){this.seekingEventReceived_=!0,this.hadSegmentAppended_=!1,this.didFireLargeGap_=!1}},{key:"onPollGapJump_",value:function(){if(0!=this.video_.readyState){if(this.video_.seeking){if(!this.seekingEventReceived_)return}else this.seekingEventReceived_=!1;if(!this.video_.paused){this.video_.readyState!=this.prevReadyState_&&(this.didFireLargeGap_=!1,this.prevReadyState_=this.video_.readyState);var t=this.config_.smallGapLimit,n=this.video_.currentTime,r=this.video_.buffered,i=on.getGapIndex(r,n);if(null!=i){if(0!=i||this.hadSegmentAppended_){var a=r.start(i);if(!(a>=this.timeline_.getSeekRangeEnd())){var s=a-n,o=s<=t,l=!1;if(!(s<e.BROWSER_GAP_TOLERANCE)){if(!o&&!this.didFireLargeGap_){this.didFireLargeGap_=!0;var u=new w("largegap",{currentTime:n,gapSize:s});u.cancelable=!0,this.onEvent_(u),this.config_.jumpLargeGaps&&!u.defaultPrevented?l=!0:Ei.log.info("Ignoring large gap at",n,"size",s)}(o||l)&&(0==i?Ei.log.info("Jumping forward",s,"seconds because of gap before start time of",a):Ei.log.info("Jumping forward",s,"seconds because of gap starting at",r.end(i-1),"and ending at",a),this.video_.currentTime=a)}}}}else this.stallDetector_&&this.stallDetector_.poll()}}}}])&&wi(t.prototype,n),r&&wi(t,r),e}();bi.BROWSER_GAP_TOLERANCE=.001;var Si=bi;function Ti(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ci(e,t,n){return t&&ki(e.prototype,t),n&&ki(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ii=window.shaka,Ai=(window.goog,function(){function e(t,n,r,i,a,s){var o=this;Ti(this,e),this.minSeekRange_=3,this.mediaElement_=t,this.timeline_=n.presentationTimeline,this.minBufferTime_=n.minBufferTime||0,this.config_=r,this.onSeek_=a,this.lastCorrectiveSeek_=null,this.gapController_=new Si(t,n.presentationTimeline,r,this.createStallDetector_(t,r),s),this.videoWrapper_=new fi(t,function(){return o.onSeeking_()},this.getStartTime_(i)),this.checkWindowTimer_=new H(function(){o.onPollWindow_()}).tickEvery(.25)}return Ci(e,[{key:"release",value:function(){this.videoWrapper_&&(this.videoWrapper_.release(),this.videoWrapper_=null),this.gapController_&&(this.gapController_.release(),this.gapController_=null),this.checkWindowTimer_&&(this.checkWindowTimer_.stop(),this.checkWindowTimer_=null),this.config_=null,this.timeline_=null,this.videoWrapper_=null,this.mediaElement_=null,this.onSeek_=function(){}}},{key:"setStartTime",value:function(e){this.videoWrapper_.setTime(e)}},{key:"getTime",value:function(){var e=this.videoWrapper_.getTime();return this.mediaElement_.readyState>0&&!this.mediaElement_.paused?this.clampTime_(e):e}},{key:"getStartTime_",value:function(e){return null==e?e=this.timeline_.getDuration()<1/0?this.timeline_.getSeekRangeStart():this.timeline_.getSeekRangeEnd():e<0&&(e=this.timeline_.getSeekRangeEnd()+e),this.clampSeekToDuration_(this.clampTime_(e))}},{key:"notifyOfBufferingChange",value:function(){this.gapController_.onSegmentAppended()}},{key:"onPollWindow_",value:function(){if(0!=this.mediaElement_.readyState&&!this.mediaElement_.paused){var e=this.mediaElement_.currentTime,t=this.timeline_.getSeekRangeStart(),n=this.timeline_.getSeekRangeEnd();if(n-t<this.minSeekRange_&&(t=n-this.minSeekRange_),e<t){var r=this.reposition_(e);Ii.log.info("Jumping forward "+(r-e)+" seconds to catch up with the seek range."),this.mediaElement_.currentTime=r}}}},{key:"onSeeking_",value:function(){this.gapController_.onSeeking();var e=this.videoWrapper_.getTime(),t=this.reposition_(e),n=Si.BROWSER_GAP_TOLERANCE;if(Math.abs(t-e)>n){var r=(new Date).getTime()/1e3;if(!this.lastCorrectiveSeek_||this.lastCorrectiveSeek_<r-1)return this.lastCorrectiveSeek_=r,void this.videoWrapper_.setTime(t)}Ii.log.v1("Seek to "+e),this.onSeek_()}},{key:"clampSeekToDuration_",value:function(e){var t=this.timeline_.getDuration();return e>=t?(window.asserts.assert(this.config_.durationBackoff>=0,"Duration backoff must be non-negative!"),t-this.config_.durationBackoff):e}},{key:"reposition_",value:function(e){var t=this;window.asserts.assert(this.config_,"Cannot reposition playhead when it has beeen destroyed");var n=function(e){return on.isBuffered(t.mediaElement_.buffered,e)},r=Math.max(this.minBufferTime_,this.config_.rebufferingGoal),i=this.config_.safeSeekOffset,a=this.timeline_.getSeekRangeStart(),s=this.timeline_.getSeekRangeEnd(),o=this.timeline_.getDuration();s-a<this.minSeekRange_&&(a=s-this.minSeekRange_);var l=this.timeline_.getSafeSeekRangeStart(r),u=this.timeline_.getSafeSeekRangeStart(i),c=this.timeline_.getSafeSeekRangeStart(r+i);return e>=o?(Ii.log.v1("Playhead past duration."),this.clampSeekToDuration_(e)):e>s?(Ii.log.v1("Playhead past end."),s):e<a?n(u)?(Ii.log.v1("Playhead before start & start is buffered"),u):(Ii.log.v1("Playhead before start & start is unbuffered"),c):e>=l||n(e)?(Ii.log.v1("Playhead in safe region or in buffered region."),e):(Ii.log.v1("Playhead outside safe region & in unbuffered region."),c)}},{key:"clampTime_",value:function(e){var t=this.timeline_.getSeekRangeStart();if(e<t)return t;var n=this.timeline_.getSeekRangeEnd();return e>n?n:e}},{key:"createStallDetector_",value:function(e,t){if(!t.stallEnabled)return null;var n=t.stallThreshold,r=t.stallSkip,i=new yi(new _i(e),n);return i.onStall(function(t,n){Ii.log.debug(["Stall detected at",t,"for",n,"seconds. Seeking forward",r,"seconds."].join(" ")),e.currentTime+=r}),i}}]),e}());function Li(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xi(e,t,n){return t&&Ri(e.prototype,t),n&&Ri(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var Ni=function(){function e(t){var n=this;Li(this,e),this.mediaElement_=t,this.observers_=new Set,this.pollingLoop_=new H(function(){n.pollAllObservers_(!1)}).tickEvery(.25)}return xi(e,[{key:"release",value:function(){this.pollingLoop_.stop();var e=!0,t=!1,n=void 0;try{for(var r,i=this.observers_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.release()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.observers_.clear()}},{key:"manage",value:function(e){this.observers_.add(e)}},{key:"notifyOfSeek",value:function(){this.pollAllObservers_(!0)}},{key:"pollAllObservers_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.observers_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.poll(this.mediaElement_.currentTime,e)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}]),e}();function Mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Pi=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeline_=t,this.oldPosition_=new Map,this.onEnter_=function(e,t){},this.onExit_=function(e,t){},this.onSkip_=function(e,t){};var r=e.RelativePosition_,i=r.BEFORE_THE_REGION,a=r.IN_THE_REGION,s=r.AFTER_THE_REGION;this.rules_=[{weWere:null,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:i,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:s,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:a,weAre:i,invoke:function(e,t){return n.onExit_(e,t)}},{weWere:a,weAre:s,invoke:function(e,t){return n.onExit_(e,t)}},{weWere:i,weAre:s,invoke:function(e,t){return n.onSkip_(e,t)}},{weWere:s,weAre:i,invoke:function(e,t){return n.onSkip_(e,t)}}]}var t,n,r;return t=e,r=[{key:"determinePositionRelativeTo_",value:function(t,n){var r=e.RelativePosition_;return n<t.startTime?r.BEFORE_THE_REGION:n>t.endTime?r.AFTER_THE_REGION:r.IN_THE_REGION}}],(n=[{key:"release",value:function(){this.timeline_=null,this.oldPosition_.clear(),this.onEnter_=function(e,t){},this.onExit_=function(e,t){},this.onSkip_=function(e,t){}}},{key:"poll",value:function(t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=this.timeline_.regions()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=this.oldPosition_.get(l),c=e.determinePositionRelativeTo_(l,t);this.oldPosition_.set(l,c);var d=!0,h=!1,f=void 0;try{for(var p,m=this.rules_[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.weWere==u&&v.weAre==c&&v.invoke(l,n)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"setListeners",value:function(e,t,n){this.onEnter_=e,this.onExit_=t,this.onSkip_=n}}])&&Mi(t.prototype,n),r&&Mi(t,r),e}();function Oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Pi.RelativePosition_={BEFORE_THE_REGION:1,IN_THE_REGION:2,AFTER_THE_REGION:3},Pi.EventListener={},Pi.Rule_={};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Di=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onAddRegion_=function(e){},this.regions_=new Set}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.onAddRegion_=function(e){},this.regions_.clear()}},{key:"setListeners",value:function(e){this.onAddRegion_=e}},{key:"addRegion",value:function(e){null==this.findSimilarRegion_(e)&&(this.regions_.add(e),this.onAddRegion_(e))}},{key:"findSimilarRegion_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.regions_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;if(s.schemeIdUri==e.schemeIdUri&&s.startTime==e.startTime&&s.endTime==e.endTime)return s}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"regions",value:function(){return this.regions_}}])&&Oi(t.prototype,n),r&&Oi(t,r),e}();function Ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fi=window.shaka,Bi=(window.goog,function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataView_=t,this.littleEndian_=n===e.Endianness.LITTLE_ENDIAN,this.position_=0}var t,n,r;return t=e,(n=[{key:"hasMoreData",value:function(){return this.position_<this.dataView_.byteLength}},{key:"getPosition",value:function(){return this.position_}},{key:"getLength",value:function(){return this.dataView_.byteLength}},{key:"readUint8",value:function(){try{var e=this.dataView_.getUint8(this.position_);return this.position_+=1,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint16",value:function(){try{var e=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint32",value:function(){try{var e=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}}},{key:"readInt32",value:function(){try{var e=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint64",value:function(){var e,t;try{this.littleEndian_?(e=this.dataView_.getUint32(this.position_,!0),t=this.dataView_.getUint32(this.position_+4,!0)):(t=this.dataView_.getUint32(this.position_,!1),e=this.dataView_.getUint32(this.position_+4,!1))}catch(e){throw this.outOfBounds_()}if(t>2097151)throw new Fi.util.Error(Fi.util.Error.Severity.CRITICAL,Fi.util.Error.Category.MEDIA,Fi.util.Error.Code.JS_INTEGER_OVERFLOW);return this.position_+=8,t*Math.pow(2,32)+e}},{key:"readBytes",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.readBytes"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();var t=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+this.position_,e);return this.position_+=e,new Uint8Array(t)}},{key:"skip",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.skip"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_+=e}},{key:"rewind",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.rewind"),this.position_<e)throw this.outOfBounds_();this.position_-=e}},{key:"seek",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.seek"),e<0||e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_=e}},{key:"readTerminatedString",value:function(){for(var e=this.position_;this.hasMoreData();){if(0==this.dataView_.getUint8(this.position_))break;this.position_+=1}var t=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+e,this.position_-e);return this.position_+=1,Gt.fromUTF8(t)}},{key:"outOfBounds_",value:function(){return new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.BUFFER_READ_OUT_OF_BOUNDS)}}])&&Ui(t.prototype,n),r&&Ui(t,r),e}());Bi.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1};var Vi=Bi;function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Gi=window.shaka,ji=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.headers_=[],this.boxDefinitions_=[],this.done_=!1}var t,n,r;return t=e,r=[{key:"children",value:function(e){for(;e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start,e.reader,e.partialOkay)}},{key:"sampleDescription",value:function(e){for(var t=e.reader.readUint32();t>0&&!e.parser.done_;t-=1)e.parser.parseNext(e.start,e.reader,e.partialOkay)}},{key:"allData",value:function(e){return function(t){var n=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(n))}}},{key:"typeFromString_",value:function(e){window.asserts.assert(4==e.length,"Mp4 box names must be 4 characters long");for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}},{key:"typeToString",value:function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}}],(n=[{key:"box",value:function(t,n){var r=e.typeFromString_(t);return this.headers_[r]=e.BoxType_.BASIC_BOX,this.boxDefinitions_[r]=n,this}},{key:"fullBox",value:function(t,n){var r=e.typeFromString_(t);return this.headers_[r]=e.BoxType_.FULL_BOX,this.boxDefinitions_[r]=n,this}},{key:"stop",value:function(){this.done_=!0}},{key:"parse",value:function(e,t){var n=new Uint8Array(e),r=new Vi(new DataView(n.buffer,n.byteOffset,n.byteLength),Vi.Endianness.BIG_ENDIAN);for(this.done_=!1;r.hasMoreData()&&!this.done_;)this.parseNext(0,r,t)}},{key:"parseNext",value:function(t,n,r){var i=n.getPosition(),a=n.readUint32(),s=n.readUint32(),o=e.typeToString(s);switch(Gi.log.v2("Parsing MP4 box",o),a){case 0:a=n.getLength()-i;break;case 1:a=n.readUint64()}var l=this.boxDefinitions_[s];if(l){var u=null,c=null;if(this.headers_[s]===e.BoxType_.FULL_BOX){var d=n.readUint32();u=d>>>24,c=16777215&d}var h=i+a;r&&h>n.getLength()&&(h=n.getLength());var f=h-n.getPosition(),p=f>0?n.readBytes(f):new Uint8Array(0);l({parser:this,partialOkay:r||!1,version:u,flags:c,reader:new Vi(new DataView(p.buffer,p.byteOffset,p.byteLength),Vi.Endianness.BIG_ENDIAN),size:a,start:i+t})}else{var m=Math.min(i+a-n.getPosition(),n.getLength()-n.getPosition());n.skip(m)}}}])&&Hi(t.prototype,n),r&&Hi(t,r),e}());ji.CallbackType={},ji.BoxType_={BASIC_BOX:0,FULL_BOX:1};var Ki=ji;function Wi(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function qi(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Wi(a,r,i,s,o,"next",e)}function o(e){Wi(a,r,i,s,o,"throw",e)}s(void 0)})}}function zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yi=new M,Xi=window.shaka,$i=(window.goog,function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log(t,n),this.playerInterface_=n,this.manifest_=t,this.config_=null,this.bufferingGoalScale_=1,this.setupPeriodPromise_=Promise.resolve(),this.canSwitchPeriod_=[],this.canSwitchStream_=new Map,this.mediaStates_=new Map,this.startupComplete_=!1,this.failureCallbackBackoff_=null,this.fatalError_=!1,this.unloadingTextStream_=!1,this.textStreamSequenceId_=0,this.destroyer_=new Rt(function(){return r.doDestroy_()})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.mediaStates_.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.cancelUpdate_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}return this.mediaStates_.clear(),this.canSwitchStream_.clear(),this.playerInterface_=null,this.manifest_=null,this.setupPeriodPromise_=null,this.canSwitchPeriod_=null,this.config_=null,Promise.resolve()}},{key:"configure",value:function(e){this.config_=e;var t={maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0};this.failureCallbackBackoff_=new K(t,!0)}},{key:"start",value:function(){var e=qi(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(this.config_,"StreamingEngine configure() must be called before init()!"),t=this.playerInterface_.getPresentationTime(),n=this.findPeriodForTime_(t),(r=this.playerInterface_.onChooseStreams(this.manifest_.periods[n])).variant||r.text){e.next=7;break}throw Xi.log.error("init: no Streams chosen"),new M(Yi.severity.CRITICAL,Yi.category.STREAMING,Yi.code.INVALID_STREAMS_CHOSEN);case 7:return e.next=9,this.initStreams_(r.variant?r.variant.audio:null,r.variant?r.variant.video:null,r.text,t);case 9:this.destroyer_.ensureNotDestroyed(),Xi.log.debug("init: completed initial Stream setup"),this.playerInterface_&&this.playerInterface_.onInitialStreamsSetup&&(Xi.log.v1("init: calling onInitialStreamsSetup()..."),this.playerInterface_.onInitialStreamsSetup());case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBufferingPeriod",value:function(){var e=Re.ContentType,t=this.mediaStates_.get(e.VIDEO);if(t)return this.manifest_.periods[t.needPeriodIndex];var n=this.mediaStates_.get(e.AUDIO);return n?this.manifest_.periods[n.needPeriodIndex]:null}},{key:"getBufferingAudio",value:function(){var e=Re.ContentType;return this.getStream_(e.AUDIO)}},{key:"getBufferingVideo",value:function(){var e=Re.ContentType;return this.getStream_(e.VIDEO)}},{key:"getBufferingText",value:function(){var e=Re.ContentType;return this.getStream_(e.TEXT)}},{key:"getStream_",value:function(e){var t=this.mediaStates_.get(e);return t?t.restoreStreamAfterTrickPlay||t.stream:null}},{key:"loadNewTextStream",value:function(){var e=qi(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Re.ContentType,e.next=3,this.playerInterface_.mediaSourceEngine.clear(n.TEXT);case 3:return this.textStreamSequenceId_++,this.unloadingTextStream_=!1,r=this.textStreamSequenceId_,i=this.playerInterface_.mediaSourceEngine,a=new Map,s=new Set,a.set(n.TEXT,t),s.add(t),e.next=13,i.init(a,!1);case 13:return this.destroyer_.ensureNotDestroyed(),e.next=16,this.setupStreams_(s);case 16:this.destroyer_.ensureNotDestroyed(),this.textStreamSequenceId_!=r||this.mediaStates_.has(n.TEXT)||this.unloadingTextStream_||(o=this.playerInterface_.getPresentationTime(),l=this.findPeriodForTime_(o),u=this.createMediaState_(t,l,0),this.mediaStates_.set(n.TEXT,u),this.scheduleUpdate_(u,0));case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadTextStream",value:function(){var e=Re.ContentType;this.unloadingTextStream_=!0;var t=this.mediaStates_.get(e.TEXT);t&&(this.cancelUpdate_(t),this.mediaStates_.delete(e.TEXT))}},{key:"setTrickPlay",value:function(e){var t=Re.ContentType,n=this.mediaStates_.get(t.VIDEO);if(n){var r=n.stream;if(r)if(Xi.log.debug("setTrickPlay",e),e){var i=r.trickModeVideo;if(!i)return;if(n.restoreStreamAfterTrickPlay)return;Xi.log.debug("Engaging trick mode stream",i),this.switchInternal_(i,!1,0,!1),n.restoreStreamAfterTrickPlay=r}else{var a=n.restoreStreamAfterTrickPlay;if(!a)return;Xi.log.debug("Restoring non-trick-mode stream",a),n.restoreStreamAfterTrickPlay=null,this.switchInternal_(a,!0,0,!1)}}}},{key:"switchVariant",value:function(e,t,n){e.video&&this.switchInternal_(e.video,t,n,!1),e.audio&&this.switchInternal_(e.audio,t,n,!1)}},{key:"switchTextStream",value:function(e){var t=Re.ContentType;window.asserts.assert(e&&e.type==t.TEXT,"Wrong stream type passed to switchTextStream!"),this.switchInternal_(e,!0,0,!1)}},{key:"reloadTextStream",value:function(){var e=Re.ContentType,t=this.mediaStates_.get(e.TEXT);t&&this.switchInternal_(t.stream,!0,0,!0)}},{key:"switchInternal_",value:function(t,n,r,i){var a=this,s=Re.ContentType,o=t.type,l=this.mediaStates_.get(o);if(l||t.type!=s.TEXT||!this.config_.ignoreTextStreamFailures){if(window.asserts.assert(l,"switch: expected mediaState to exist"),l){var u=this.findPeriodContainingStream_(t),c=Array.from(this.mediaStates_.values()).every(function(e){return e.needPeriodIndex==l.needPeriodIndex});if(n&&u!=l.needPeriodIndex&&c){Xi.log.debug("switch: switching to stream in another Period; clearing buffer and changing Periods");var d=!0,h=!1,f=void 0;try{for(var p,m=this.mediaStates_.values()[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;this.forceClearBuffer_(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}else{l.restoreStreamAfterTrickPlay&&(Xi.log.debug("switch during trick play mode",t),t.trickModeVideo?(l.restoreStreamAfterTrickPlay=t,t=t.trickModeVideo,Xi.log.debug("switch found trick play stream",t)):(l.restoreStreamAfterTrickPlay=null,Xi.log.debug("switch found no special trick play stream")));var g=this.canSwitchPeriod_[u];if(window.asserts.assert(g&&g.resolved,"switch: expected Period "+u+" to be ready"),g&&g.resolved&&(g=this.canSwitchStream_.get(t.id),window.asserts.assert(g&&g.resolved,"switch: expected Stream "+t.id+" to be ready"),g&&g.resolved))if(l.stream!=t||i){if(t.type==s.TEXT){var y=Ot.getFullType(t.mimeType,t.codecs);this.playerInterface_.mediaSourceEngine.reinitText(y)}l.stream=t,l.needInitSegment=!0;var _=e.logPrefix_(l);Xi.log.debug("switch: switching to Stream "+_),this.shouldAbortCurrentRequest_(l,u)&&(Xi.log.info("Aborting current segment request to switch."),l.operation.abort()),n&&(l.clearingBuffer?l.waitingToFlushBuffer=!0:l.performingUpdate?(l.waitingToClearBuffer=!0,l.clearBufferSafeMargin=r,l.waitingToFlushBuffer=!0):(this.cancelUpdate_(l),this.clearBuffer_(l,!0,r).catch(function(e){a.playerInterface_&&a.playerInterface_.onError(e)})))}else{var w=e.logPrefix_(l);Xi.log.debug("switch: Stream "+w+" already active")}}}}else this.loadNewTextStream(t)}},{key:"shouldAbortCurrentRequest_",value:function(e,t){if(!e.operation)return!1;var n=this.playerInterface_.getPresentationTime(),r=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),i=this.getSegmentReferenceNeeded_(e,n,r,t),a=i?i.getSize():null;if(null==a)return!1;var s=e.stream.initSegmentReference;return s&&(a+=s.getSize()||0),8*a/this.playerInterface_.getBandwidthEstimate()<r-n-Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal)||e.operation.getBytesRemaining()>a}},{key:"seeked",value:function(){var e=this,t=this.playerInterface_.getPresentationTime(),n=this.config_.smallGapLimit,r=function(r){return e.playerInterface_.mediaSourceEngine.isBuffered(r,t,n)},i=!1,a=this.findPeriodForTime_(t);if(Ce.every(this.mediaStates_.values(),function(e){return e.needPeriodIndex==a})){var s=!0,o=!1,l=void 0;try{for(var u,c=this.mediaStates_.keys()[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;r(d)||(this.forceClearBuffer_(this.mediaStates_.get(d)),i=!0)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}}else{if(!Ce.every(this.mediaStates_.keys(),r)){Xi.log.debug("(all): seeked: unbuffered seek: clearing all buffers");var h=!0,f=!1,p=void 0;try{for(var m,v=this.mediaStates_.values()[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;this.forceClearBuffer_(g)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}i=!0}}i||Xi.log.debug("(all): seeked: buffered seek: presentationTime="+t)}},{key:"forceClearBuffer_",value:function(t){var n=this,r=e.logPrefix_(t);if(t.clearingBuffer)Xi.log.debug(r,"clear: already clearing the buffer");else if(t.waitingToClearBuffer)Xi.log.debug(r,"clear: already waiting");else{if(t.performingUpdate)return Xi.log.debug(r,"clear: currently updating"),t.waitingToClearBuffer=!0,void(t.clearBufferSafeMargin=0);var i=t.type;if(null==this.playerInterface_.mediaSourceEngine.bufferStart(i))return Xi.log.debug(r,"clear: nothing buffered"),void(null==t.updateTimer&&this.scheduleUpdate_(t,0));Xi.log.debug(r,"clear: handling right now"),this.cancelUpdate_(t),this.clearBuffer_(t,!1,0).catch(function(e){n.playerInterface_&&n.playerInterface_.onError(e)})}}},{key:"initStreams_",value:function(){var e=qi(regeneratorRuntime.mark(function e(t,n,r,i){var a,s,o,l,u,c,d,h,f,p,m,v,g,y,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"StreamingEngine configure() must be called before init()!"),a=this.playerInterface_.getPresentationTime(),s=this.findPeriodForTime_(a),o=Re.ContentType,l=new Map,u=new Set,t&&(l.set(o.AUDIO,t),u.add(t)),n&&(l.set(o.VIDEO,n),u.add(n)),r&&(l.set(o.TEXT,r),u.add(r)),c=this.playerInterface_.mediaSourceEngine,d=this.config_.forceTransmuxTS,e.next=13,c.init(l,d);case 13:return this.destroyer_.ensureNotDestroyed(),this.setDuration_(),e.next=17,this.setupStreams_(u);case 17:for(this.destroyer_.ensureNotDestroyed(),h=!0,f=!1,p=void 0,e.prev=21,m=l.keys()[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)g=v.value,y=l.get(g),this.mediaStates_.has(g)||(_=this.createMediaState_(y,s,i),this.mediaStates_.set(g,_),this.scheduleUpdate_(_,0));e.next=29;break;case 25:e.prev=25,e.t0=e.catch(21),f=!0,p=e.t0;case 29:e.prev=29,e.prev=30,h||null==m.return||m.return();case 32:if(e.prev=32,!f){e.next=35;break}throw p;case 35:return e.finish(32);case 36:return e.finish(29);case 37:case"end":return e.stop()}},e,this,[[21,25,29,37],[30,,32,36]])}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"createMediaState_",value:function(e,t,n){return{stream:e,type:e.type,lastStream:null,lastSegmentReference:null,restoreStreamAfterTrickPlay:null,needInitSegment:!0,needPeriodIndex:t,endOfStream:!1,performingUpdate:!1,updateTimer:null,waitingToClearBuffer:!1,clearBufferSafeMargin:0,waitingToFlushBuffer:!1,clearingBuffer:!1,recovering:!1,hasError:!1,resumeAt:n||0,operation:null}}},{key:"setupPeriod_",value:function(e){var t=this,n=this.canSwitchPeriod_[e];if(n)return Xi.log.debug("(all) Period "+e+" is being or has been set up"),window.asserts.assert(n.promise,"promise must not be null"),n.promise;Xi.log.debug("(all) setting up Period "+e),n={promise:new A,resolved:!1},this.canSwitchPeriod_[e]=n;var r=new Set,i=!0,a=!1,s=void 0;try{for(var o,l=this.manifest_.periods[e].variants[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;u.video&&r.add(u.video),u.video&&u.video.trickModeVideo&&r.add(u.video.trickModeVideo),u.audio&&r.add(u.audio)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var c=!0,d=!1,h=void 0;try{for(var f,p=this.manifest_.periods[e].textStreams[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;r.add(m)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var v=function(){var n=qi(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.setupPeriodPromise_;case 3:return t.destroyer_.ensureNotDestroyed(),n.next=6,t.setupStreams_(r);case 6:t.destroyer_.ensureNotDestroyed(),t.canSwitchPeriod_[e].promise.resolve(),t.canSwitchPeriod_[e].resolved=!0,Xi.log.v1("(all) setup Period "+e),n.next=21;break;case 12:n.prev=12,n.t0=n.catch(0),t.destroyer_.ensureNotDestroyed(n.t0),t.canSwitchPeriod_[e].promise.catch(function(){}),t.canSwitchPeriod_[e].promise.reject(),delete t.canSwitchPeriod_[e],Xi.log.warning("(all) failed to setup Period "+e),window.asserts.assert(n.t0 instanceof M,"Bad error type"),t.playerInterface_.onError(n.t0);case 21:case"end":return n.stop()}},n,null,[[0,12]])}));return function(){return n.apply(this,arguments)}}();return this.setupPeriodPromise_=v(),n.promise}},{key:"setupStreams_",value:function(){var e=qi(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,w,E,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],r=!0,i=!1,a=void 0,e.prev=4,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)l=o.value,(u=this.canSwitchStream_.get(l.id))?(Xi.log.debug("(all) Stream "+l.id+" is being or has been set up"),n.push(u.promise)):(Xi.log.v1("(all) setting up Stream "+l.id),this.canSwitchStream_.set(l.id,{promise:new A,resolved:!1}),n.push(l.createSegmentIndex()));e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),i=!0,a=e.t0;case 12:e.prev=12,e.prev=13,r||null==s.return||s.return();case 15:if(e.prev=15,!i){e.next=18;break}throw a;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.prev=20,e.next=23,Promise.all(n);case 23:this.destroyer_.ensureNotDestroyed(),e.next=49;break;case 26:for(e.prev=26,e.t1=e.catch(20),this.destroyer_.ensureNotDestroyed(e.t1),c=!0,d=!1,h=void 0,e.prev=32,f=t[Symbol.iterator]();!(c=(p=f.next()).done);c=!0)m=p.value,this.canSwitchStream_.get(m.id).promise.catch(function(){}),this.canSwitchStream_.get(m.id).promise.reject(),this.canSwitchStream_.delete(m.id);e.next=40;break;case 36:e.prev=36,e.t2=e.catch(32),d=!0,h=e.t2;case 40:e.prev=40,e.prev=41,c||null==f.return||f.return();case 43:if(e.prev=43,!d){e.next=46;break}throw h;case 46:return e.finish(43);case 47:return e.finish(40);case 48:throw e.t1;case 49:for(v=!0,g=!1,y=void 0,e.prev=52,_=t[Symbol.iterator]();!(v=(w=_.next()).done);v=!0)E=w.value,(b=this.canSwitchStream_.get(E.id)).resolved||(b.promise.resolve(),b.resolved=!0,Xi.log.v1("(all) setup Stream "+E.id));e.next=60;break;case 56:e.prev=56,e.t3=e.catch(52),g=!0,y=e.t3;case 60:e.prev=60,e.prev=61,v||null==_.return||_.return();case 63:if(e.prev=63,!g){e.next=66;break}throw y;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19],[20,26],[32,36,40,48],[41,,43,47],[52,56,60,68],[61,,63,67]])}));return function(t){return e.apply(this,arguments)}}()},{key:"setDuration_",value:function(){var e=this.manifest_.presentationTimeline.getDuration();e<1/0?this.playerInterface_.mediaSourceEngine.setDuration(e):this.playerInterface_.mediaSourceEngine.setDuration(Math.pow(2,32))}},{key:"onUpdate_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n){var r,i,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.destroyer_.ensureNotDestroyed(),r=e.logPrefix_(n),window.asserts.assert(!n.performingUpdate&&null!=n.updateTimer,r+" unexpected call to onUpdate_()"),!n.performingUpdate&&null!=n.updateTimer){t.next=5;break}return t.abrupt("return");case 5:if(window.asserts.assert(!n.clearingBuffer,r+" onUpdate_() should not be called when clearing the buffer"),!n.clearingBuffer){t.next=8;break}return t.abrupt("return");case 8:if(n.updateTimer=null,!n.waitingToClearBuffer){t.next=14;break}return Xi.log.debug(r,"skipping update and clearing the buffer"),t.next=13,this.clearBuffer_(n,n.waitingToFlushBuffer,n.clearBufferSafeMargin);case 13:return t.abrupt("return");case 14:t.prev=14,null!=(i=this.update_(n))&&(this.scheduleUpdate_(n,i),n.hasError=!1),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(14),this.handleStreamingError_(t.t0),t.abrupt("return");case 23:if(a=Array.from(this.mediaStates_.values()),this.handlePeriodTransition_(n),!this.startupComplete_||!a.every(function(e){return e.endOfStream})){t.next=32;break}return Xi.log.v1(r,"calling endOfStream()..."),t.next=29,this.playerInterface_.mediaSourceEngine.endOfStream();case 29:this.destroyer_.ensureNotDestroyed(),(s=this.playerInterface_.mediaSourceEngine.getDuration())<this.manifest_.presentationTimeline.getDuration()&&this.manifest_.presentationTimeline.setDuration(s);case 32:case"end":return t.stop()}},t,this,[[14,19]])}));return function(e){return t.apply(this,arguments)}}()},{key:"update_",value:function(t){window.asserts.assert(this.manifest_,"manifest_ should not be null"),window.asserts.assert(this.config_,"config_ should not be null");var n=Re.ContentType,r=function(e){return e.type==n.TEXT&&e.stream.mimeType==Ot.CLOSED_CAPTION_MIMETYPE};if(r(t))return this.playerInterface_.mediaSourceEngine.setSelectedClosedCaptionId(t.stream.originalId||""),null;var i=e.logPrefix_(t),a=this.playerInterface_.getPresentationTime(),s=this.getTimeNeeded_(t,a);Xi.log.v2(i,"timeNeeded="+s);var o=this.findPeriodContainingStream_(t.stream),l=this.findPeriodForTime_(s),u=this.playerInterface_.mediaSourceEngine.bufferedAheadOf(t.type,a);Xi.log.v2(i,"update_:","presentationTime="+a,"bufferedAhead="+u);var c=Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal,this.config_.bufferingGoal)*this.bufferingGoalScale_;if(s>=this.manifest_.presentationTimeline.getDuration()){if(Xi.log.debug(i,"buffered to end of presentation"),t.endOfStream=!0,t.type==n.VIDEO){var d=this.mediaStates_.get(n.TEXT);d&&d.stream.mimeType==Ot.CLOSED_CAPTION_MIMETYPE&&(d.endOfStream=!0)}return null}if(t.endOfStream=!1,t.needPeriodIndex=l,l!=o)return Xi.log.debug(i,"need Period "+l,"presentationTime="+a,"timeNeeded="+s,"currentPeriodIndex="+o),null;if(u>=c)return Xi.log.v2(i,"buffering goal met"),.5;var h=this.playerInterface_.mediaSourceEngine.bufferEnd(t.type),f=this.getSegmentReferenceNeeded_(t,a,h,o);if(!f)return 1;for(var p=1/0,m=0,v=Array.from(this.mediaStates_.values());m<v.length;m++){var g=v[m];if(r(g))return null;var y=this.getTimeNeeded_(g,a);p=Math.min(p,y)}return s>=p+this.manifest_.presentationTimeline.getMaxSegmentDuration()*e.MAX_RUN_AHEAD_SEGMENTS_?1:(t.resumeAt=0,this.fetchAndAppend_(t,a,o,f).catch(function(e){console.error(e)}),null)}},{key:"getTimeNeeded_",value:function(e,t){if(!e.lastStream||!e.lastSegmentReference)return Math.max(t,e.resumeAt);var n=this.findPeriodContainingStream_(e.lastStream);return this.manifest_.periods[n].startTime+e.lastSegmentReference.endTime}},{key:"getSegmentReferenceNeeded_",value:function(t,n,r,i){var a,s=e.logPrefix_(t);if(t.lastSegmentReference&&t.stream==t.lastStream){var o=t.lastSegmentReference.position+1;return Xi.log.v2(s,"next position known:","position="+o),this.getSegmentReferenceIfAvailable_(t,i,o)}if(t.lastSegmentReference){window.asserts.assert(t.lastStream,"lastStream should not be null"),Xi.log.v1(s,"next position unknown: another Stream buffered");var l=this.findPeriodContainingStream_(t.lastStream),u=this.manifest_.periods[l];a=this.lookupSegmentPosition_(t,u.startTime+t.lastSegmentReference.endTime,i)}else window.asserts.assert(!t.lastStream,"lastStream should be null"),Xi.log.v1(s,"next position unknown: nothing buffered"),a=this.lookupSegmentPosition_(t,r||n,i);if(null==a)return null;var c=null;if(null==r){var d=Math.max(0,a-1);c=this.getSegmentReferenceIfAvailable_(t,i,d)}return c||this.getSegmentReferenceIfAvailable_(t,i,a)}},{key:"lookupSegmentPosition_",value:function(t,n,r){var i=e.logPrefix_(t),a=this.manifest_.periods[r];Xi.log.debug(i,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+a.startTime);var s=Math.max(0,n-a.startTime),o=t.stream.findSegmentPosition(s);return null==o&&Xi.log.warning(i,"cannot find segment:","currentPeriod.startTime="+a.startTime,"lookupTime="+s),o}},{key:"getSegmentReferenceIfAvailable_",value:function(t,n,r){var i=e.logPrefix_(t),a=this.manifest_.periods[n],s=t.stream.getSegmentReference(r);if(!s)return Xi.log.v1(i,"segment does not exist:","currentPeriod.startTime="+a.startTime,"position="+r),null;var o=this.manifest_.presentationTimeline,l=o.getSegmentAvailabilityStart(),u=o.getSegmentAvailabilityEnd();return a.startTime+s.endTime<l||a.startTime+s.startTime>u?(Xi.log.v2(i,"segment is not available:","currentPeriod.startTime="+a.startTime,"reference.startTime="+s.startTime,"reference.endTime="+s.endTime,"availabilityStart="+l,"availabilityEnd="+u),null):s}},{key:"fetchAndAppend_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,l,u,c,d,h,f,p,m,v;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=Re.ContentType,o=e.logPrefix_(n),l=this.manifest_.periods[i],Xi.log.v1(o,"fetchAndAppend_:","presentationTime="+r,"currentPeriod.startTime="+l.startTime,"reference.position="+a.position,"reference.startTime="+a.startTime,"reference.endTime="+a.endTime),u=n.stream,c=this.manifest_.presentationTimeline.getDuration(),d=this.manifest_.periods[i+1],h=Math.max(0,l.startTime-e.APPEND_WINDOW_START_FUDGE_),f=d?d.startTime+e.APPEND_WINDOW_END_FUDGE_:c,window.asserts.assert(a.startTime<=f,o+" segment should start before append window end"),p=this.initSourceBuffer_(n,i,h,f),n.performingUpdate=!0,n.needInitSegment=!1,Xi.log.v2(o,"fetching segment"),m=this.fetch_(n,a),t.prev=15,t.next=18,Promise.all([p,m]);case 18:if(v=t.sent,this.destroyer_.ensureNotDestroyed(),!this.fatalError_){t.next=22;break}return t.abrupt("return");case 22:return t.next=24,this.append_(n,r,l,u,a,v[1]);case 24:if(this.destroyer_.ensureNotDestroyed(),!this.fatalError_){t.next=27;break}return t.abrupt("return");case 27:n.performingUpdate=!1,n.recovering=!1,n.waitingToClearBuffer||this.playerInterface_.onSegmentAppended(),this.scheduleUpdate_(n,0),this.handleStartup_(n,u),Xi.log.v1(o,"finished fetch and append"),t.next=43;break;case 35:if(t.prev=35,t.t0=t.catch(15),this.destroyer_.ensureNotDestroyed(t.t0),!this.fatalError_){t.next=40;break}return t.abrupt("return");case 40:window.asserts.assert(t.t0 instanceof M,"Should only receive a Shaka error"),n.performingUpdate=!1,n.type==s.TEXT&&this.config_.ignoreTextStreamFailures?(t.t0.code==Yi.code.BAD_HTTP_STATUS?Xi.log.warning(o,"Text stream failed to download. Proceeding without it."):Xi.log.warning(o,"Text stream failed to parse. Proceeding without it."),this.mediaStates_.delete(s.TEXT)):t.t0.code==Yi.code.OPERATION_ABORTED?(n.performingUpdate=!1,n.updateTimer=null,this.scheduleUpdate_(n,0)):t.t0.code==Yi.code.QUOTA_EXCEEDED_ERROR?this.handleQuotaExceeded_(n,t.t0):(Xi.log.error(o,"failed fetch and append: code="+t.t0.code),n.hasError=!0,t.t0.severity=Yi.severity.CRITICAL,this.handleStreamingError_(t.t0));case 43:case"end":return t.stop()}},t,this,[[15,35]])}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"retry",value:function(){if(this.destroyer_.destroyed())return Xi.log.error("Unable to retry after StreamingEngine is destroyed!"),!1;if(this.fatalError_)return Xi.log.error("Unable to retry after StreamingEngine encountered a fatal error!"),!1;var t=!0,n=!1,r=void 0;try{for(var i,a=this.mediaStates_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=e.logPrefix_(s);s.hasError&&(Xi.log.info(o,"Retrying after failure..."),s.hasError=!1,this.scheduleUpdate_(s,.1))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}},{key:"handleQuotaExceeded_",value:function(t,n){var r=e.logPrefix_(t);if(Array.from(this.mediaStates_.values()).some(function(e){return e!=t&&e.recovering}))Xi.log.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var i=Math.round(100*this.bufferingGoalScale_);if(i>20)this.bufferingGoalScale_-=.2;else{if(!(i>4))return Xi.log.error(r,"MediaSource threw QuotaExceededError too many times"),t.hasError=!0,this.fatalError_=!0,void this.playerInterface_.onError(n);this.bufferingGoalScale_-=.04}var a=Math.round(100*this.bufferingGoalScale_);Xi.log.warning(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-a)+"%"),t.recovering=!0}this.scheduleUpdate_(t,4)}},{key:"initSourceBuffer_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,l,u,c,d,h=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.needInitSegment){t.next=2;break}return t.abrupt("return");case 2:if(s=e.logPrefix_(n),o=this.manifest_.periods[r],l=o.startTime-n.stream.presentationTimeOffset,Xi.log.v1(s,"setting timestamp offset to "+l),Xi.log.v1(s,"setting append window start to "+i),Xi.log.v1(s,"setting append window end to "+a),u=this.playerInterface_.mediaSourceEngine.setStreamProperties(n.type,l,i,a),n.stream.initSegmentReference){t.next=13;break}return t.next=12,u;case 12:return t.abrupt("return");case 13:return Xi.log.v1(s,"fetching init segment"),window.asserts.assert(n.stream.initSegmentReference,"Should have init segment"),c=this.fetch_(n,n.stream.initSegmentReference),d=function(){var e=qi(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c;case 3:return t=e.sent,h.destroyer_.ensureNotDestroyed(),Xi.log.v1(s,"appending init segment"),r=n.stream.closedCaptions&&n.stream.closedCaptions.size>0,e.next=9,h.playerInterface_.mediaSourceEngine.appendBuffer(n.type,t,null,null,r);case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),n.needInitSegment=!0,e.t0;case 15:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),t.next=19,Promise.all([u,d()]);case 19:case"end":return t.stop()}},t,this)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"append_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n,r,i,a,s,o){var l,u,c,d,h=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l=e.logPrefix_(n),u=a.closedCaptions&&a.closedCaptions.size>0,null!=a.emsgSchemeIdUris&&a.emsgSchemeIdUris.length>0&&(new Ki).fullBox("emsg",function(e){return h.parseEMSG_(i,s,a.emsgSchemeIdUris,e)}).parse(o),t.next=5,this.evict_(n,r);case 5:return this.destroyer_.ensureNotDestroyed(),Xi.log.v1(l,"appending media segment"),c=s.startTime+i.startTime,d=s.endTime+i.startTime,t.next=11,this.playerInterface_.mediaSourceEngine.appendBuffer(n.type,o,c,d,u);case 11:this.destroyer_.ensureNotDestroyed(),Xi.log.v2(l,"appended media segment"),n.lastStream=a,n.lastSegmentReference=s;case 15:case"end":return t.stop()}},t,this)}));return function(e,n,r,i,a,s){return t.apply(this,arguments)}}()},{key:"parseEMSG_",value:function(e,t,n,r){var i=r.reader.readTerminatedString(),a=r.reader.readTerminatedString(),s=r.reader.readUint32(),o=r.reader.readUint32(),l=r.reader.readUint32(),u=r.reader.readUint32(),c=r.reader.readBytes(r.reader.getLength()-r.reader.getPosition()),d=e.startTime+t.startTime+o/s;if(n.includes(i))if("urn:mpeg:dash:event:2012"==i)this.playerInterface_.onManifestUpdate();else{var h=new w("emsg",{detail:{startTime:d,endTime:d+l/s,schemeIdUri:i,value:a,timescale:s,presentationTimeDelta:o,eventDuration:l,id:u,messageData:c}});this.playerInterface_.onEvent(h)}}},{key:"evict_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.logPrefix_(n),Xi.log.v2(i,"checking buffer length"),a=Math.max(this.config_.bufferBehind,this.manifest_.presentationTimeline.getMaxSegmentDuration()),null!=(s=this.playerInterface_.mediaSourceEngine.bufferStart(n.type))){t.next=7;break}return Xi.log.v2(i,"buffer behind okay because nothing buffered:","presentationTime="+r,"bufferBehind="+a),t.abrupt("return");case 7:if(!((l=(o=r-s)-a)<=0)){t.next=12;break}return Xi.log.v2(i,"buffer behind okay:","presentationTime="+r,"bufferedBehind="+o,"bufferBehind="+a,"underflow="+-l),t.abrupt("return");case 12:return Xi.log.v1(i,"buffer behind too large:","presentationTime="+r,"bufferedBehind="+o,"bufferBehind="+a,"overflow="+l),t.next=15,this.playerInterface_.mediaSourceEngine.remove(n.type,s,s+l);case 15:this.destroyer_.ensureNotDestroyed(),Xi.log.v1(i,"evicted "+l+" seconds");case 17:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"handleStartup_",value:function(t,n){var r=this,i=Re.ContentType;if(!this.startupComplete_){var a=e.logPrefix_(t),s=Array.from(this.mediaStates_.values());if(1==s.length&&s[0].type==i.TEXT||(this.startupComplete_=s.every(function(e){return e.type==i.TEXT||!e.waitingToClearBuffer&&!e.clearingBuffer&&e.lastSegmentReference})),this.startupComplete_){Xi.log.debug(a,"startup complete");var o=this.findPeriodContainingStream_(n);if(window.asserts.assert(s.every(function(e){return e.needPeriodIndex==o||e.needPeriodIndex==o+1}),a+" expected all MediaStates to need same Period"),!this.canSwitchPeriod_[o])(function(){var e=qi(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.setupPeriod_(o);case 3:r.destroyer_.ensureNotDestroyed(),Xi.log.v1(a,"calling onCanSwitch()..."),r.playerInterface_.onCanSwitch(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}})()();for(var l=0;l<this.manifest_.periods.length;++l)this.setupPeriod_(l).catch(Ae.noop);this.playerInterface_.onStartupComplete&&(Xi.log.v1(a,"calling onStartupComplete()..."),this.playerInterface_.onStartupComplete())}}}},{key:"handlePeriodTransition_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,w,E,b,S,T=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.logPrefix_(n),i=Re.ContentType,a=this.findPeriodContainingStream_(n.stream),n.needPeriodIndex!=a){t.next=5;break}return t.abrupt("return");case 5:if(s=n.needPeriodIndex,o=Array.from(this.mediaStates_.values()),window.asserts.assert(o.every(function(t){return t.needPeriodIndex==s||t.hasError||!e.isIdle_(t)}),"All MediaStates should need the same Period or be performingupdates."),o.every(function(e){return e.needPeriodIndex==s})){t.next=12;break}return Xi.log.debug(r,"not all MediaStates need Period "+s),t.abrupt("return");case 12:if(o.every(e.isIdle_)){t.next=16;break}return Xi.log.debug(r,"all MediaStates need Period "+s+", but not all MediaStates are idle"),t.abrupt("return");case 16:return Xi.log.debug(r,"all need Period "+s),t.prev=17,t.next=20,this.setupPeriod_(s);case 20:if(this.destroyer_.ensureNotDestroyed(),o.every(function(t){var n=e.isIdle_(t),r=T.findPeriodContainingStream_(t.stream);return n&&t.needPeriodIndex==s&&r!=s})){t.next=25;break}return Xi.log.debug(r,"ignoring transition to Period",s,"since another is happening"),t.abrupt("return");case 25:l=this.manifest_.periods[s],Xi.log.v1(r,"calling onChooseStreams()..."),u=this.playerInterface_.onChooseStreams(l),c=new Map,u.variant&&u.variant.video&&c.set(i.VIDEO,u.variant.video),u.variant&&u.variant.audio&&c.set(i.AUDIO,u.variant.audio),u.text&&c.set(i.TEXT,u.text),d=!0,h=!1,f=void 0,t.prev=35,p=this.mediaStates_.keys()[Symbol.iterator]();case 37:if(d=(m=p.next()).done){t.next=47;break}if(v=m.value,!c.has(v)&&v!=i.TEXT){t.next=41;break}return t.abrupt("continue",44);case 41:return Xi.log.error(r,"invalid Streams chosen: missing "+v+" Stream"),this.playerInterface_.onError(new M(Yi.severity.CRITICAL,Yi.category.STREAMING,Yi.code.INVALID_STREAMS_CHOSEN)),t.abrupt("return");case 44:d=!0,t.next=37;break;case 47:t.next=53;break;case 49:t.prev=49,t.t0=t.catch(35),h=!0,f=t.t0;case 53:t.prev=53,t.prev=54,d||null==p.return||p.return();case 56:if(t.prev=56,!h){t.next=59;break}throw f;case 59:return t.finish(56);case 60:return t.finish(53);case 61:g=0,y=Array.from(c.keys());case 62:if(!(g<y.length)){t.next=76;break}if(_=y[g],!this.mediaStates_.has(_)){t.next=66;break}return t.abrupt("continue",73);case 66:if(_!=i.TEXT){t.next=70;break}return this.initStreams_(null,null,c.get(i.TEXT),l.startTime),c.delete(_),t.abrupt("continue",73);case 70:return Xi.log.error(r,"invalid Streams chosen: unusable "+_+" Stream"),this.playerInterface_.onError(new M(Yi.severity.CRITICAL,Yi.category.STREAMING,Yi.code.INVALID_STREAMS_CHOSEN)),t.abrupt("return");case 73:g++,t.next=62;break;case 76:for(w=0,E=Array.from(this.mediaStates_.keys());w<E.length;w++)b=E[w],(S=c.get(b))?(this.switchInternal_(S,!1,0,!1),this.scheduleUpdate_(this.mediaStates_.get(b),0)):(window.asserts.assert(b==i.TEXT,"Invalid streams chosen"),this.mediaStates_.delete(b));Xi.log.v1(r,"calling onCanSwitch()..."),this.playerInterface_.onCanSwitch(),t.next=83;break;case 81:t.prev=81,t.t1=t.catch(17);case 83:case"end":return t.stop()}},t,this,[[17,81],[35,49,53,61],[54,,56,60]])}));return function(e){return t.apply(this,arguments)}}()},{key:"findPeriodForTime_",value:function(e){var t=e+Re.GAP_OVERLAP_TOLERANCE_SECONDS,n=Hr.findPeriodForTime(this.manifest_.periods,t);return n?this.manifest_.periods.indexOf(n):0}},{key:"findPeriodContainingStream_",value:function(e){window.asserts.assert(this.manifest_,"Must have a manifest to find a stream.");for(var t=this.manifest_.periods,n=0;n<t.length;n++){var r=t[n],i=new Set,a=!0,s=!1,o=void 0;try{for(var l,u=r.variants[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;c.audio&&i.add(c.audio),c.video&&i.add(c.video),c.video&&c.video.trickModeVideo&&i.add(c.video.trickModeVideo)}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}var d=!0,h=!1,f=void 0;try{for(var p,m=r.textStreams[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;i.add(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}if(i.has(e))return n}return-1}},{key:"fetch_",value:function(){var e=qi(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe.RequestType.SEGMENT,i=Br.createSegmentRequest(n.getUris(),n.startByte,n.endByte,this.config_.retryParameters),Xi.log.v2("fetching: reference=",n),a=this.playerInterface_.netEngine.request(r,i),t.operation=a,e.next=7,a.promise;case 7:return s=e.sent,t.operation=null,e.abrupt("return",s.data);case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearBuffer_",value:function(){var t=qi(regeneratorRuntime.mark(function t(n,r,i){var a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.logPrefix_(n),window.asserts.assert(!n.performingUpdate&&null==n.updateTimer,a+" unexpected call to clearBuffer_()"),n.waitingToClearBuffer=!1,n.waitingToFlushBuffer=!1,n.clearBufferSafeMargin=0,n.clearingBuffer=!0,Xi.log.debug(a,"clearing buffer"),!i){t.next=14;break}return s=this.playerInterface_.getPresentationTime(),o=this.playerInterface_.mediaSourceEngine.getDuration(),t.next=12,this.playerInterface_.mediaSourceEngine.remove(n.type,s+i,o);case 12:t.next=20;break;case 14:return t.next=16,this.playerInterface_.mediaSourceEngine.clear(n.type);case 16:if(this.destroyer_.ensureNotDestroyed(),!r){t.next=20;break}return t.next=20,this.playerInterface_.mediaSourceEngine.flush(n.type);case 20:this.destroyer_.ensureNotDestroyed(),Xi.log.debug(a,"cleared buffer"),n.lastStream=null,n.lastSegmentReference=null,n.clearingBuffer=!1,n.endOfStream=!1,this.scheduleUpdate_(n,0);case 27:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"scheduleUpdate_",value:function(t,n){var r=this,i=e.logPrefix_(t);Xi.log.v2(i,"updating in "+n+" seconds"),window.asserts.assert(null==t.updateTimer,i+" did not expect update to be scheduled"),t.updateTimer=new B(qi(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.onUpdate_(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r.playerInterface_&&r.playerInterface_.onError(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}))).tickAfter(n)}},{key:"cancelUpdate_",value:function(e){null!=e.updateTimer&&(e.updateTimer.stop(),e.updateTimer=null)}},{key:"handleStreamingError_",value:function(){var e=qi(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.failureCallbackBackoff_.attempt();case 2:this.destroyer_.ensureNotDestroyed(),this.playerInterface_.onError(t),t.handled||this.config_.failureCallback(t);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],r=[{key:"isIdle_",value:function(e){return!e.performingUpdate&&null==e.updateTimer&&!e.waitingToClearBuffer&&!e.clearingBuffer}},{key:"logPrefix_",value:function(e){return"("+e.type+":"+e.stream.id+")"}}],n&&zi(t.prototype,n),r&&zi(t,r),e}());$i.ChosenStreams,$i.PlayerInterface,$i.MediaState_,$i.APPEND_WINDOW_START_FUDGE_=.1,$i.APPEND_WINDOW_END_FUDGE_=.01,$i.MAX_RUN_AHEAD_SEGMENTS_=1;var Qi=$i;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.shaka;function Zi(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Ji(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Zi(a,r,i,s,o,"next",e)}function o(e){Zi(a,r,i,s,o,"throw",e)}s(void 0)})}}function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ta=new M,na=(window.shaka,window.goog,function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.implementation_=r,this.currentlyAt_=t,this.currentlyWith_=n,this.waitForWork_=null,this.requests_=[],this.currentRoute_=null,this.currentStep_=null,this.mainLoopPromise_=Promise.resolve().then(function(){return i.mainLoop_()}),this.destroyer_=new Rt(function(){return i.doDestroy_()})}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=Ji(regeneratorRuntime.mark(function e(){var t,n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentStep_&&this.currentStep_.abort(),this.unblockMainLoop_(),e.next=4,this.mainLoopPromise_;case 4:for(this.currentRoute_&&this.currentRoute_.listeners.onCancel(),t=!0,n=!1,r=void 0,e.prev=8,i=this.requests_[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)a.value.listeners.onCancel();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),n=!0,r=e.t0;case 16:e.prev=16,e.prev=17,t||null==i.return||i.return();case 19:if(e.prev=19,!n){e.next=22;break}throw r;case 22:return e.finish(19);case 23:return e.finish(16);case 24:this.currentRoute_=null,this.requests_=[],this.implementation_=null;case 27:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])}));return function(){return e.apply(this,arguments)}}()},{key:"startNewRoute",value:function(e){var t={onStart:function(){},onEnd:function(){},onCancel:function(){},onError:function(e){},onSkip:function(){},onEnter:function(){}};return this.requests_.push({create:e,listeners:t}),this.currentStep_&&this.currentStep_.abort(),this.unblockMainLoop_(),t}},{key:"mainLoop_",value:function(){var e=Ji(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.destroyer_.destroyed()){e.next=5;break}return e.next=3,this.doOneThing_();case 3:e.next=0;break;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"doOneThing_",value:function(){return this.tryNewRoute_()?Promise.resolve():this.currentRoute_?this.takeNextStep_():(window.asserts.assert(null==this.waitForWork_,"We should not have a promise yet."),this.implementation_.onIdle(this.currentlyAt_),this.waitForWork_=new A,this.waitForWork_)}},{key:"tryNewRoute_",value:function(){if(window.asserts.assert(null==this.currentStep_,"We should never have a current step between taking steps."),0==this.requests_.length)return!1;if(this.currentRoute_&&!this.currentRoute_.interruptible)return!1;this.currentRoute_&&(this.currentRoute_.listeners.onCancel(),this.currentRoute_=null);var e=this.requests_.shift(),t=e.create(this.currentlyWith_);return t?(e.listeners.onStart(),this.currentRoute_={node:t.node,payload:t.payload,interruptible:t.interruptible,listeners:e.listeners}):e.listeners.onSkip(),!0}},{key:"takeNextStep_",value:function(){var e=Ji(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.currentRoute_,"We need a current route to take the next step."),this.currentlyAt_=this.implementation_.getNext(this.currentlyAt_,this.currentlyWith_,this.currentRoute_.node,this.currentRoute_.payload),this.currentRoute_.listeners.onEnter(this.currentlyAt_),e.prev=3,this.currentStep_=this.implementation_.enterNode(this.currentlyAt_,this.currentlyWith_,this.currentRoute_.payload),e.next=7,this.currentStep_.promise;case 7:this.currentStep_=null,this.currentlyAt_==this.currentRoute_.node&&(this.currentRoute_.listeners.onEnd(),this.currentRoute_=null),e.next=19;break;case 11:return e.prev=11,e.t0=e.catch(3),e.t0.code==ta.code.OPERATION_ABORTED?(window.asserts.assert(this.currentRoute_.interruptible,"Do not put abortable steps in non-interruptible routes!"),this.currentRoute_.listeners.onCancel()):this.currentRoute_.listeners.onError(e.t0),this.currentRoute_=null,this.currentStep_=null,e.next=18,this.implementation_.handleError(this.currentlyWith_,e.t0);case 18:this.currentlyAt_=e.sent;case 19:case"end":return e.stop()}},e,this,[[3,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"unblockMainLoop_",value:function(){this.waitForWork_&&(this.waitForWork_.resolve(),this.waitForWork_=null)}}])&&ea(t.prototype,n),r&&ea(t,r),e}());function ra(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}na.Implementation,na.Listeners,na.Route,na.ActiveRoute_,na.Request_;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ia=window.shaka,aa=(window.goog,function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textTrack_=null;for(var n=0;n<t.textTracks.length;++n){var r=t.textTracks[n];r.mode="disabled",r.label==ia.text.SimpleTextDisplayer.TextTrackLabel_&&(this.textTrack_=r)}this.textTrack_||(this.textTrack_=t.addTextTrack("subtitles",ia.text.SimpleTextDisplayer.TextTrackLabel_)),this.textTrack_.mode="hidden"}var t,n,r;return t=e,r=[{key:"convertToTextTrackCue_",value:function(e){if(e.startTime>=e.endTime)return ia.log.warning("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=ia.text.Cue,n=new VTTCue(e.startTime,e.endTime,e.payload);n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,n.size=e.size;try{n.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),e.writingMode==t.writingMode.VERTICAL_LEFT_TO_RIGHT?n.vertical="lr":e.writingMode==t.writingMode.VERTICAL_RIGHT_TO_LEFT&&(n.vertical="rl"),e.lineInterpretation==t.lineInterpretation.PERCENTAGE&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}},{key:"removeWhere_",value:function(e,t){var n=e.mode,r="showing"==n?"showing":"hidden";e.mode=r,window.asserts.assert(e.cues,'Cues should be accessible when mode is set to "'+r+'".');for(var i=e.cues,a=i.length-1;a>=0;a--){var s=i[a];s&&t(s)&&e.removeCue(s)}e.mode=n}}],(n=[{key:"remove",value:function(e,t){if(!this.textTrack_)return!1;return ia.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,function(n){return n.startTime<t&&n.endTime>e}),!0}},{key:"append",value:function(e){for(var t=ia.text.SimpleTextDisplayer.convertToTextTrackCue_,n=[],r=0;r<e.length;r++){var i=t(e[r]);i&&n.push(i)}var a=n.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:n.indexOf(t)-n.indexOf(e)}),s=!0,o=!1,l=void 0;try{for(var u,c=a[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;this.textTrack_.addCue(d)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}}},{key:"destroy",value:function(){if(this.textTrack_){ia.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,function(e){return!0})}return this.textTrack_=null,Promise.resolve()}},{key:"isTextVisible",value:function(){return"showing"==this.textTrack_.mode}},{key:"setTextVisibility",value:function(e){this.textTrack_.mode=e?"showing":"hidden"}}])&&ra(t.prototype,n),r&&ra(t,r),e}());aa.TextTrackLabel_="Shaka Player TextTrack";var sa=aa;function oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var la=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.open_=null,this.closed_=[]}var t,n,r;return t=e,(n=[{key:"update",value:function(e){null==this.open_?this.start_(e):this.update_(e)}},{key:"getTimeSpentIn",value:function(e){var t=0;this.open_&&this.open_.state==e&&(t+=this.open_.duration);var n=!0,r=!1,i=void 0;try{for(var a,s=this.closed_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t+=o.state==e?o.duration:0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"getCopy",value:function(){var e=function(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}},t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.closed_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.push(e(o))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return this.open_&&t.push(e(this.open_)),t}},{key:"start_",value:function(e){window.asserts.assert(null==this.open_,"There must be no open entry in order when we start"),this.open_={timestamp:this.getNowInSeconds_(),state:e,duration:0}}},{key:"update_",value:function(e){window.asserts.assert(this.open_,"There must be an open entry in order to update it");var t=this.getNowInSeconds_();this.open_.duration=t-this.open_.timestamp,this.open_.state!=e&&(this.closed_.push(this.open_),this.open_={timestamp:t,state:e,duration:0})}},{key:"getNowInSeconds_",value:function(){return Date.now()/1e3}}])&&oa(t.prototype,n),r&&oa(t,r),e}();function ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ca=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentVariant_=null,this.currentText_=null,this.history_=[]}var t,n,r;return t=e,(n=[{key:"updateCurrentVariant",value:function(e,t){this.currentVariant_!=e&&(this.currentVariant_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"variant",fromAdaptation:t,bandwidth:e.bandwidth}))}},{key:"updateCurrentText",value:function(e,t){this.currentText_!=e&&(this.currentText_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"text",fromAdaptation:t,bandwidth:null}))}},{key:"getCopy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.history_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(this.clone_(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"getNowInSeconds_",value:function(){return Date.now()/1e3}},{key:"clone_",value:function(e){return{timestamp:e.timestamp,id:e.id,type:e.type,fromAdaptation:e.fromAdaptation,bandwidth:e.bandwidth}}}])&&ua(t.prototype,n),r&&ua(t,r),e}();function da(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ha=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width_=NaN,this.height_=NaN,this.totalDroppedFrames_=NaN,this.totalDecodedFrames_=NaN,this.loadLatencySeconds_=NaN,this.variantBandwidth_=NaN,this.bandwidthEstimate_=NaN,this.stateHistory_=new la,this.switchHistory_=new ca}var t,n,r;return t=e,r=[{key:"getEmptyBlob",value:function(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]}}}],(n=[{key:"setDroppedFrames",value:function(e,t){this.totalDroppedFrames_=e,this.totalDecodedFrames_=t}},{key:"setResolution",value:function(e,t){this.width_=e,this.height_=t}},{key:"setLoadLatency",value:function(e){this.loadLatencySeconds_=e}},{key:"setVariantBandwidth",value:function(e){this.variantBandwidth_=e}},{key:"setBandwidthEstimate",value:function(e){this.bandwidthEstimate_=e}},{key:"getStateHistory",value:function(){return this.stateHistory_}},{key:"getSwitchHistory",value:function(){return this.switchHistory_}},{key:"getBlob",value:function(){return{width:this.width_,height:this.height_,streamBandwidth:this.variantBandwidth_,decodedFrames:this.totalDecodedFrames_,droppedFrames:this.totalDroppedFrames_,estimatedBandwidth:this.bandwidthEstimate_,loadLatency:this.loadLatencySeconds_,playTime:this.stateHistory_.getTimeSpentIn("playing"),pauseTime:this.stateHistory_.getTimeSpentIn("paused"),bufferingTime:this.stateHistory_.getTimeSpentIn("buffering"),stateHistory:this.stateHistory_.getCopy(),switchHistory:this.switchHistory_.getCopy()}}}])&&da(t.prototype,n),r&&da(t,r),e}();function fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var pa=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.libraryVersion_=t,this.onPending_=n,this.onExpired_=r}var t,n,r;return t=e,(n=[{key:"enforce",value:function(e,t,n){(e.compareTo(this.libraryVersion_)>0?this.onPending_:this.onExpired_)(this.libraryVersion_,e,t,n)}}])&&fa(t.prototype,n),r&&fa(t,r),e}();function ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var va=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.major_=t,this.minor_=n}var t,n,r;return t=e,r=[{key:"parse",value:function(t){var n=t.substring(1).split(".",2);return new e(Number(n[0]),Number(n[1]))}}],(n=[{key:"major",value:function(){return this.major_}},{key:"minor",value:function(){return this.minor_}},{key:"compareTo",value:function(e){var t=this.major_-e.major_,n=this.minor_-e.minor_;return t||n}},{key:"toString",value:function(){return"v"+this.major_+"."+this.minor_}}])&&ma(t.prototype,n),r&&ma(t,r),e}();function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ya=window.shaka,_a=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"init",value:function(t){window.asserts.assert(null==e.enforcer_,"Deprecate.init should only be called once."),e.enforcer_=new pa(va.parse(t),e.onPending_,e.onExpired_)}},{key:"deprecateFeature",value:function(t,n,r,i){var a=e.enforcer_;window.asserts.assert(a,"Missing deprecation enforcer. Was |init| called?");var s=new e.Version(t,n);a.enforce(s,r,i)}},{key:"onPending_",value:function(e,t,n,r){ya.log.alwaysWarn([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}},{key:"onExpired_",value:function(e,t,n,r){var i=[n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join("");ya.log.alwaysError(i),window.asserts.assert(!1,i)}}],(n=null)&&ga(t.prototype,n),r&&ga(t,r),e}());function wa(e){return(wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function ba(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ea(a,r,i,s,o,"next",e)}function o(e){Ea(a,r,i,s,o,"throw",e)}s(void 0)})}}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ta(e){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ca(e,t){return(Ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_a.enforcer_=null;var Ia=new M;window.shaka=window.shaka||{};var Aa=window.shaka;window.goog=window.goog||{};var La=window.goog,Ra=function(e){function t(e,n){var r,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,a=Ta(t).call(this),(r=!a||"object"!==wa(a)&&"function"!=typeof a?ka(i):a).loadMode_=t.LoadMode.NOT_LOADED,r.video_=null,r.isTextVisible_=!1,r.eventManager_=new Ke,r.networkingEngine_=null,r.drmEngine_=null,r.mediaSourceEngine_=null,r.playhead_=null,r.playheadObservers_=null,r.playRateController_=null,r.bufferPoller_=null,r.bufferObserver_=null,r.regionTimeline_=null,r.streamingEngine_=null,r.parser_=null,r.manifest_=null,r.assetUri_=null,r.abrManager_=null,r.abrManagerFactory_=null,r.nextExternalStreamId_=1e9,r.loadingTextStreams_=new Set,r.switchingPeriods_=!0,r.deferredVariant_=null,r.deferredVariantClearBuffer_=!1,r.deferredVariantClearBufferSafeMargin_=0,r.deferredTextStream_=null,r.activeStreams_=new Wr,r.config_=r.defaultConfig_(),r.lastTextFactory_,r.maxHwRes_={width:1/0,height:1/0},r.stats_=null,r.currentAdaptationSetCriteria_=new ei(r.config_.preferredAudioLanguage,r.config_.preferredVariantRole,r.config_.preferredAudioChannelCount),r.currentTextLanguage_=r.config_.preferredTextLanguage,r.currentTextRole_=r.config_.preferredTextRole,n&&n(ka(r)),r.networkingEngine_=r.createNetworkingEngine(),r.eventManager_.listen(window,"online",function(){r.retryStreaming()}),r.detachNode_={name:"detach"},r.attachNode_={name:"attach"},r.unloadNode_={name:"unload"},r.parserNode_={name:"manifest-parser"},r.manifestNode_={name:"manifest"},r.mediaSourceNode_={name:"media-source"},r.drmNode_={name:"drm-engine"},r.loadNode_={name:"load"},r.srcEqualsDrmNode_={name:"src-equals-drm-engine"},r.srcEqualsNode_={name:"src-equals"};var s=new Map;s.set(r.attachNode_,function(e,t){return U.notAbortable(r.onAttach_(e,t))}),s.set(r.detachNode_,function(e,t){return U.notAbortable(r.onDetach_(e,t))}),s.set(r.unloadNode_,function(e,t){return U.notAbortable(r.onUnload_(e,t))}),s.set(r.mediaSourceNode_,function(e,t){var n=r.onInitializeMediaSourceEngine_(e,t);return U.notAbortable(n)}),s.set(r.parserNode_,function(e,t){var n=r.onInitializeParser_(e,t);return U.notAbortable(n)}),s.set(r.manifestNode_,function(e,t){return r.onParseManifest_(e,t)}),s.set(r.drmNode_,function(e,t){var n=r.onInitializeDrm_(e,t);return U.notAbortable(n)}),s.set(r.loadNode_,function(e,t){return U.notAbortable(r.onLoad_(e,t))}),s.set(r.srcEqualsDrmNode_,function(e,t){var n=r.onInitializeSrcEqualsDrm_(e,t);return U.notAbortable(n)}),s.set(r.srcEqualsNode_,function(e,t){return r.onSrcEquals_(e,t)});var o={getNext:function(e,t,n,i){return r.getNextStep_(e,t,n,i)},enterNode:function(e,t,n){return r.dispatchEvent(new w("onstatechange",{state:e.name})),s.get(e)(t,n)},handleError:function(){var e=ba(regeneratorRuntime.mark(function e(n,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Aa.log.warning("The walker saw an error:"),i instanceof M?Aa.log.warning("Error Code:",i.code):(Aa.log.warning("Error Message:",i.message),Aa.log.warning("Error Stack:",i.stack)),e.next=4,r.onUnload_(n,t.createEmptyPayload_());case 4:return e.abrupt("return",n.mediaElement?r.attachNode_:r.detachNode_);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),onIdle:function(e){r.dispatchEvent(new w("onstateidle",{state:e.name}))}};return r.walker_=new na(r.detachNode_,t.createEmptyPayload_(),o),e&&r.attach(e,!0),r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ca(e,t)}(t,C),n=t,r=[{key:"destroy",value:function(){var e=ba(regeneratorRuntime.mark(function e(){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.DESTROYED){e.next=2;break}return e.abrupt("return");case 2:return this.loadMode_=t.LoadMode.DESTROYED,n=this.walker_.startNewRoute(function(e){return{node:r.detachNode_,payload:t.createEmptyPayload_(),interruptible:!1}}),e.next=6,new Promise(function(e){n.onStart=function(){Aa.log.info("Preparing to destroy walker...")},n.onEnd=function(){e()},n.onCancel=function(){window.asserts.assert(!1,"Our final detach call should never be cancelled."),e()},n.onError=function(){window.asserts.assert(!1,"Our final detach call should never see an error"),e()},n.onSkip=function(){window.asserts.assert(!1,"Our final detach call should never be skipped"),e()}});case 6:return e.next=8,this.walker_.destroy();case 8:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.abrManagerFactory_=null,this.abrManager_=null,this.config_=null,!this.networkingEngine_){e.next=16;break}return e.next=15,this.networkingEngine_.destroy();case 15:this.networkingEngine_=null;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"attach",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var r=t.createEmptyPayload_();r.mediaElement=e,Ft.supportsMediaSource()||(n=!1);var i=n?this.mediaSourceNode_:this.attachNode_,a=this.walker_.startNewRoute(function(e){return{node:i,payload:r,interruptible:!1}});return a.onStart=function(){return Aa.log.info("Starting attach...")},this.wrapWalkerListenersWithPromise_(a)}},{key:"detach",value:function(){var e=this;if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var n=this.walker_.startNewRoute(function(n){return{node:e.detachNode_,payload:t.createEmptyPayload_(),interruptible:!1}});return n.onStart=function(){return Aa.log.info("Starting detach...")},this.wrapWalkerListenersWithPromise_(n)}},{key:"unload",value:function(){var e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());Ft.supportsMediaSource()||(n=!1);var r=t.createEmptyPayload_(),i=this.walker_.startNewRoute(function(t){var i=null;return i=t.mediaElement&&n?e.mediaSourceNode_:t.mediaElement?e.attachNode_:e.detachNode_,window.asserts.assert(i,"We should have picked a destination."),r.mediaElement=t.mediaElement,{node:i,payload:r,interruptible:!1}});return i.onStart=function(){return Aa.log.info("Starting unload...")},this.wrapWalkerListenersWithPromise_(i)}},{key:"load",value:function(e,n,r){var i=this;if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());this.dispatchEvent(new w("loading"));var a=t.createEmptyPayload_();if(console.log({payload:a}),a.uri=e,a.startTimeOfLoad=Date.now()/1e3,r&&"string"!=typeof r){_a.deprecateFeature(2,6,"Loading with a manifest parser factory","Please register a manifest parser and for the mime-type.");var s=r;a.factory=function(){return new s}}r&&"string"==typeof r&&(a.mimeType=r),void 0!==n&&(a.startTime=n);var o=this.shouldUseSrcEquals_(a)?this.srcEqualsNode_:this.loadNode_,l=this.walker_.startNewRoute(function(e){return null==e.mediaElement?null:(a.mediaElement=e.mediaElement,{node:o,payload:a,interruptible:!0})});return l.onStart=function(){return Aa.log.info("Starting load of "+e+"...")},new Promise(function(e,t){l.onSkip=function(){return t(new M(Ia.severity.CRITICAL,Ia.category.PLAYER,Ia.code.NO_VIDEO_ELEMENT))},l.onEnd=function(){return e()},l.onCancel=function(){return t(i.createAbortLoadError_())},l.onError=function(e){return t(e)}})}},{key:"shouldUseSrcEquals_",value:function(e){if(e.factory)return!1;if(!Ft.supportsMediaSource())return!0;var t=e.mimeType,n=e.uri||"";t||(t={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[Wn.getExtension(n)]);if(t){var r=Ft.supportsMediaType(t);if(!r)return!1;var i=Wn.isSupported(n,t);return!i||(window.asserts.assert(r&&i,"Both native and MSE playback should be possible!"),Ft.isApple())}return!1}},{key:"onAttach_",value:function(e,t){var n=this;if(window.asserts.assert(null==e.mediaElement||e.mediaElement==t.mediaElement,"The routing logic failed. MediaElement requirement failed."),null==e.mediaElement){e.mediaElement=t.mediaElement;this.eventManager_.listen(e.mediaElement,"error",function(e){return n.onVideoError_(e)})}return this.video_=e.mediaElement,Promise.resolve()}},{key:"onDetach_",value:function(e,t){return e.mediaElement&&(this.eventManager_.unlisten(e.mediaElement,"error"),e.mediaElement=null),this.video_=null,Promise.resolve()}},{key:"onUnload_",value:function(){var e=ba(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.DESTROYED&&(this.loadMode_=t.LoadMode.NOT_LOADED),this.dispatchEvent(new w("unloading")),n.factory=null,n.mimeType=null,n.startTime=null,n.uri=null,n.mediaElement&&(this.eventManager_.unlisten(n.mediaElement,"loadeddata"),this.eventManager_.unlisten(n.mediaElement,"playing"),this.eventManager_.unlisten(n.mediaElement,"pause"),this.eventManager_.unlisten(n.mediaElement,"ended"),this.eventManager_.unlisten(n.mediaElement,"ratechange")),this.playheadObservers_&&(this.playheadObservers_.release(),this.playheadObservers_=null),this.bufferPoller_&&(this.bufferPoller_.stop(),this.bufferPoller_=null),!this.parser_){e.next=13;break}return e.next=12,this.parser_.stop();case 12:this.parser_=null;case 13:if(!this.abrManager_){e.next=16;break}return e.next=16,this.abrManager_.stop();case 16:if(!this.streamingEngine_){e.next=20;break}return e.next=19,this.streamingEngine_.destroy();case 19:this.streamingEngine_=null;case 20:if(this.playhead_&&(this.playhead_.release(),this.playhead_=null),!this.mediaSourceEngine_){e.next=25;break}return e.next=24,this.mediaSourceEngine_.destroy();case 24:this.mediaSourceEngine_=null;case 25:if(n.mediaElement&&n.mediaElement.src&&(n.mediaElement.removeAttribute("src"),n.mediaElement.load()),!this.drmEngine_){e.next=30;break}return e.next=29,this.drmEngine_.destroy();case 29:this.drmEngine_=null;case 30:this.activeStreams_.clear(),this.assetUri_=null,this.bufferObserver_=null,this.loadingTextStreams_.clear(),this.manifest_=null,this.stats_=null,this.lastTextFactory_=null,this.switchingPeriods_=!0,this.updateBufferState_();case 39:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeMediaSourceEngine_",value:function(){var e=ba(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(Ft.supportsMediaSource(),"We should not be initializing media source on a platform that does not support media source."),window.asserts.assert(t.mediaElement,"We should have a media element when initializing media source."),window.asserts.assert(t.mediaElement==n.mediaElement,"|has| and |wants| should have the same media element when initializing media source."),window.asserts.assert(null==this.mediaSourceEngine_,"We should not have a media source engine yet."),r=rn.isSupported()?new rn:new an,i=this.config_.textDisplayFactory,a=new i,this.lastTextFactory_=i,s=this.createMediaSourceEngine(t.mediaElement,r,a),e.next=11,s.open();case 11:this.mediaSourceEngine_=s;case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeParser_",value:function(){var e=ba(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(t.mediaElement,"We should have a media element when initializing the parser."),window.asserts.assert(t.mediaElement==n.mediaElement,"|has| and |wants| should have the same media element when initializing the parser."),window.asserts.assert(this.networkingEngine_,"Need networking engine when initializing the parser."),window.asserts.assert(this.config_,"Need player config when initializing the parser."),t.factory=n.factory,t.mimeType=n.mimeType,t.uri=n.uri,window.asserts.assert(t.uri,"We should have an asset uri when initializing the parsing."),r=t.uri,i=this.networkingEngine_,this.assetUri_=r,!t.factory){e.next=15;break}this.parser_=t.factory(),e.next=18;break;case 15:return e.next=17,Wn.create(r,i,this.config_.manifest.retryParameters,t.mimeType);case 17:this.parser_=e.sent;case 18:this.parser_.configure(this.config_.manifest);case 19:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onParseManifest_",value:function(e,n){var r=this;window.asserts.assert(e.factory==n.factory,"|has| and |wants| should have the same factory when parsing."),window.asserts.assert(e.mimeType==n.mimeType,"|has| and |wants| should have the same mime type when parsing."),window.asserts.assert(e.uri==n.uri,"|has| and |wants| should have the same uri when parsing."),window.asserts.assert(e.uri,"|has| should have a valid uri when parsing."),window.asserts.assert(e.uri==this.assetUri_,"|has.uri| should match the cached asset uri."),window.asserts.assert(this.networkingEngine_,"Need networking engine to parse manifest."),window.asserts.assert(this.config_,"Need player config to parse manifest."),window.asserts.assert(this.parser_,"|this.parser_| should have been set in an earlier step.");var i=e.uri,a=this.networkingEngine_;this.regionTimeline_=new Di,this.regionTimeline_.setListeners(function(e){r.onRegionEvent_("timelineregionadded",e)});var s={networkingEngine:a,filterNewPeriod:function(e){return r.filterNewPeriod_(e)},filterAllPeriods:function(e){return r.filterAllPeriods_(e)},onTimelineRegionAdded:function(e){return r.regionTimeline_.addRegion(e)},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.onError_(e)}};return new U(ba(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.parser_.start(i,s);case 2:if(r.manifest_=e.sent,r.dispatchEvent(new w("manifestparsed")),0!=r.manifest_.periods.length){e.next=6;break}throw new M(Ia.severity.CRITICAL,Ia.category.MANIFEST,Ia.code.NO_PERIODS);case 6:t.filterForAVVariants_(r.manifest_.periods);case 7:case"end":return e.stop()}},e)}))(),function(){return Aa.log.info("Aborting parser step..."),r.parser_.stop()})}},{key:"onInitializeDrm_",value:function(){var e=ba(regeneratorRuntime.mark(function e(t,n){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(t.factory==n.factory,"The load graph should have ensured the factories matched."),window.asserts.assert(t.mimeType==n.mimeType,"The load graph should have ensured the mime types matched."),window.asserts.assert(t.uri==n.uri,"The load graph should have ensured the uris matched"),window.asserts.assert(this.networkingEngine_,"|onInitializeDrm_| should never be called after |destroy|"),window.asserts.assert(this.config_,"|onInitializeDrm_| should never be called after |destroy|"),window.asserts.assert(this.manifest_,"|this.manifest_| should have been set in an earlier step."),this.drmEngine_=this.createDrmEngine({netEngine:this.networkingEngine_,onError:function(e){r.onError_(e)},onKeyStatus:function(e){r.onKeyStatus_(e)},onExpirationUpdated:function(e,t){r.onExpirationUpdated_(e,t)},onEvent:function(e){r.dispatchEvent(e)}}),this.drmEngine_.configure(this.config_.drm),e.next=10,this.drmEngine_.initForPlayback(Hr.getAllVariantsFrom(this.manifest_.periods),this.manifest_.offlineSessionIds);case 10:this.filterAllPeriods_(this.manifest_.periods);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onLoad_",value:function(){var e=ba(regeneratorRuntime.mark(function e(n,r){var i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,E=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(n.factory==r.factory,"|has| and |wants| should have the same factory when loading."),window.asserts.assert(n.mimeType==r.mimeType,"|has| and |wants| should have the same mime type when loading."),window.asserts.assert(n.uri==r.uri,"|has| and |wants| should have the same uri when loading."),window.asserts.assert(n.mediaElement,"We should have a media element when loading."),window.asserts.assert(r.startTimeOfLoad,"|wants| should tell us when the load was originally requested"),n.startTime=r.startTime,i=n.mediaElement,a=n.uri,this.assetUri_=a,this.stats_=new ha,s=function(){return E.updateStateHistory_()},o=function(){return E.onRateChange_()},this.eventManager_.listen(i,"playing",s),this.eventManager_.listen(i,"pause",s),this.eventManager_.listen(i,"ended",s),this.eventManager_.listen(i,"ratechange",o),l=this.config_.abrFactory,this.abrManager_&&this.abrManagerFactory_==l||(this.abrManagerFactory_=l,this.abrManager_=new l,this.abrManager_.configure(this.config_.abr)),this.createTextStreamsForClosedCaptions_(this.manifest_.periods),this.currentAdaptationSetCriteria_=new ei(this.config_.preferredAudioLanguage,this.config_.preferredVariantRole,this.config_.preferredAudioChannelCount),this.currentTextLanguage_=this.config_.preferredTextLanguage,t.applyPlayRange_(this.manifest_.presentationTimeline,this.config_.playRangeStart,this.config_.playRangeEnd),e.next=24,this.drmEngine_.attach(i);case 24:return this.abrManager_.init(function(e,t,n){return E.switch_(e,t,n)}),this.playhead_=this.createPlayhead(n.startTime),this.playheadObservers_=this.createPlayheadObserversForMSE_(),this.playRateController_=new li({getRate:function(){return n.mediaElement.playbackRate},setRate:function(e){n.mediaElement.playbackRate=e},movePlayhead:function(e){n.mediaElement.currentTime+=e}}),u=Math.max(this.manifest_.minBufferTime,this.config_.streaming.rebufferingGoal),this.startBufferManagement_(u),this.streamingEngine_=this.createStreamingEngine(),this.streamingEngine_.configure(this.config_.streaming),this.chooseCodecsAndFilterManifest_(),this.loadMode_=t.LoadMode.MEDIA_SOURCE,this.dispatchEvent(new w("streaming")),e.next=37,this.streamingEngine_.start();case 37:for(this.config_.streaming.startAtSegmentBoundary&&(c=this.playhead_.getTime(),d=this.adjustStartTime_(c),this.playhead_.setStartTime(d)),h=!0,f=!1,p=void 0,e.prev=41,m=this.manifest_.periods[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)g=v.value,this.filterNewPeriod_(g);e.next=49;break;case 45:e.prev=45,e.t0=e.catch(41),f=!0,p=e.t0;case 49:e.prev=49,e.prev=50,h||null==m.return||m.return();case 52:if(e.prev=52,!f){e.next=55;break}throw p;case 55:return e.finish(52);case 56:return e.finish(49);case 57:this.onTracksChanged_(),this.onAdaptation_(),y=this.getPresentationPeriod_(),_=y.variants.some(function(e){return e.primary}),this.config_.preferredAudioLanguage||_||Aa.log.warning("No preferred audio language set.  We will choose an arbitrary language initially"),this.chooseVariant_(y.variants),this.eventManager_.listenOnce(i,"loadeddata",function(){var e=Date.now()/1e3-r.startTimeOfLoad;E.stats_.setLoadLatency(e)});case 64:case"end":return e.stop()}},e,this,[[41,45,49,57],[50,,52,56]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeSrcEqualsDrm_",value:function(){var e=ba(regeneratorRuntime.mark(function e(t,n){var r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Re.ContentType,window.asserts.assert(this.networkingEngine_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),window.asserts.assert(this.config_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),this.drmEngine_=this.createDrmEngine({netEngine:this.networkingEngine_,onError:function(e){a.onError_(e)},onKeyStatus:function(e){a.onKeyStatus_(e)},onExpirationUpdated:function(e,t){a.onExpirationUpdated_(e,t)},onEvent:function(e){a.dispatchEvent(e)}}),this.drmEngine_.configure(this.config_.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return null},getSegmentReference:function(e){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:r.VIDEO,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},e.next=8,this.drmEngine_.initForPlayback([i],[]);case 8:return e.next=10,this.drmEngine_.attach(t.mediaElement);case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onSrcEquals_",value:function(e,n){var r=this;window.asserts.assert(e.mediaElement,"We should have a media element when loading."),window.asserts.assert(n.uri,"|has| should have a valid uri when loading."),window.asserts.assert(n.startTimeOfLoad,"|wants| should tell us when the load was originally requested"),window.asserts.assert(this.video_==e.mediaElement,"The video element should match our media element"),e.uri=n.uri,e.startTime=n.startTime,this.assetUri_=e.uri,this.stats_=new ha,this.playhead_=new SrcEqualsPlayhead(e.mediaElement),null!=e.startTime&&this.playhead_.setStartTime(e.startTime),this.playRateController_=new li({getRate:function(){return e.mediaElement.playbackRate},setRate:function(t){e.mediaElement.playbackRate=t},movePlayhead:function(t){e.mediaElement.currentTime+=t}});var i=this.config_.streaming.rebufferingGoal;this.startBufferManagement_(i);var a=function(){return r.updateStateHistory_()};if(this.eventManager_.listen(e.mediaElement,"playing",a),this.eventManager_.listen(e.mediaElement,"pause",a),this.eventManager_.listen(e.mediaElement,"ended",a),this.eventManager_.listenOnce(e.mediaElement,"loadeddata",function(){var e=Date.now()/1e3-n.startTimeOfLoad;r.stats_.setLoadLatency(e)}),this.video_.audioTracks&&(this.eventManager_.listen(this.video_.audioTracks,"addtrack",function(){return r.onTracksChanged_()}),this.eventManager_.listen(this.video_.audioTracks,"removetrack",function(){return r.onTracksChanged_()})),this.video_.textTracks){var s=this.video_.textTracks;this.eventManager_.listen(s,"addtrack",function(){return r.onTracksChanged_()}),this.eventManager_.listen(s,"removetrack",function(){return r.onTracksChanged_()})}e.mediaElement.src=e.uri,this.loadMode_=t.LoadMode.SRC_EQUALS,this.dispatchEvent(new w("streaming"));var o=new PublicPromise;return this.video_.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?o.resolve():this.video_.error?o.reject(this.videoErrorToShakaError_()):(this.eventManager_.listenOnce(this.video_,"loadeddata",function(){o.resolve()}),this.eventManager_.listenOnce(this.video_,"error",function(){o.reject(r.videoErrorToShakaError_())})),new U(o,function(){var e=new M(Ia.severity.CRITICAL,Ia.category.PLAYER,Ia.code.OPERATION_ABORTED);return o.reject(e),Promise.resolve()})}},{key:"chooseCodecsAndFilterManifest_",value:function(){var e=this.manifest_.periods.reduce(function(e,t){return e.concat(t.variants)},[]);function t(e){var t="";e.video&&(t=Ot.getCodecBase(e.video.codecs));var n="";return e.audio&&(n=Ot.getCodecBase(e.audio.codecs)),t+"-"+n}e=Nn.filterVariantsByAudioChannelCount(e,this.config_.preferredAudioChannelCount);var n=new S,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=t(l);n.push(u,l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var c=null,d=1/0;n.forEach(function(e,t){var n=0,r=0,i=!0,a=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){n+=o.value.bandwidth||0,++r}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var u=n/r;Aa.log.debug("codecs",e,"avg bandwidth",u),u<d&&(c=e,d=u)}),window.asserts.assert(null!=c,"Should have chosen codecs!"),window.asserts.assert(!isNaN(d),"Bandwidth should be a number!");var h=!0,f=!1,p=void 0;try{for(var m,v=this.manifest_.periods[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;g.variants=g.variants.filter(function(e){return t(e)==c||(Aa.log.debug("Dropping Variant (better codec available)",e),!1)})}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}},{key:"createDrmEngine",value:function(e){return new Qt(e)}},{key:"createNetworkingEngine",value:function(){var e=this;return new oe(function(t,n){e.abrManager_&&e.abrManager_.segmentDownloaded(t,n)})}},{key:"createPlayhead",value:function(e){var t=this;return window.asserts.assert(this.manifest_,"Must have manifest"),window.asserts.assert(this.video_,"Must have video"),new Ai(this.video_,this.manifest_,this.config_.streaming,e,function(){return t.onSeek_()},function(e){return t.dispatchEvent(e)})}},{key:"createPlayheadObserversForMSE_",value:function(){var e=this;window.asserts.assert(this.manifest_,"Must have manifest"),window.asserts.assert(this.regionTimeline_,"Must have region timeline"),window.asserts.assert(this.video_,"Must have video element");var t=new ai(this.manifest_);t.setListeners(function(t){return e.onChangePeriod_()});var n=new Pi(this.regionTimeline_);n.setListeners(function(t,n){e.onRegionEvent_("timelineregionenter",t)},function(t,n){e.onRegionEvent_("timelineregionexit",t)},function(t,n){n||(e.onRegionEvent_("timelineregionenter",t),e.onRegionEvent_("timelineregionexit",t))});var r=new Ni(this.video_);return r.manage(t),r.manage(n),r}},{key:"startBufferManagement_",value:function(e){var n=this;window.asserts.assert(!this.bufferObserver_,"No buffering observer should exist before initialization."),window.asserts.assert(!this.bufferPoller_,"No buffer timer should exist before initialization.");var r=e,i=Math.min(t.TYPICAL_BUFFERING_THRESHOLD_,e/2);this.bufferObserver_=new ri(r,i),this.bufferObserver_.setState(ri.State.STARVING),this.updateBufferState_(),this.bufferPoller_=new H(function(){n.pollBufferState_()}).tickEvery(.25)}},{key:"pollBufferState_",value:function(){var e;switch(window.asserts.assert(this.video_,"Need a media element to update the buffering observer"),window.asserts.assert(this.bufferObserver_,"Need a buffering observer to update"),this.loadMode_){case t.LoadMode.SRC_EQUALS:e=this.isBufferedToEndSrc_();break;case t.LoadMode.MEDIA_SOURCE:e=this.isBufferedToEndMS_();break;default:e=!1}var n=on.bufferedAheadOf(this.video_.buffered,this.video_.currentTime);this.bufferObserver_.update(n,e)&&this.updateBufferState_()}},{key:"createMediaSourceEngine",value:function(e,t,n){return new In(e,t,n)}},{key:"createStreamingEngine",value:function(){var e=this;window.asserts.assert(this.playhead_&&this.abrManager_&&this.mediaSourceEngine_&&this.manifest_,"Must not be destroyed");var t={getPresentationTime:function(){return e.playhead_.getTime()},getBandwidthEstimate:function(){return e.abrManager_.getBandwidthEstimate()},mediaSourceEngine:this.mediaSourceEngine_,netEngine:this.networkingEngine_,onChooseStreams:function(t){return e.onChooseStreams_(t)},onCanSwitch:function(){return e.canSwitch_()},onError:function(t){return e.onError_(t)},onEvent:function(t){return e.dispatchEvent(t)},onManifestUpdate:function(){return e.onManifestUpdate_()},onSegmentAppended:function(){return e.onSegmentAppended_()}};return new Qi(this.manifest_,t)}},{key:"configure",value:function(e,t){window.asserts.assert(this.config_,"Config must not be null!"),window.asserts.assert("object"==wa(e)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=St.convertToConfigObject(e,t)),window.asserts.assert("object"==wa(e),"Should be an object!");var n=Fn.mergeConfigObjects(this.config_,e,this.defaultConfig_());return this.applyConfig_(),n}},{key:"applyConfig_",value:function(){if(this.parser_&&this.parser_.configure(this.config_.manifest),this.drmEngine_&&this.drmEngine_.configure(this.config_.drm),this.streamingEngine_){this.streamingEngine_.configure(this.config_.streaming);try{var e=!0,t=!1,n=void 0;try{for(var r,i=this.manifest_.periods[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.filterNewPeriod_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}catch(e){this.onError_(e)}var s=this.streamingEngine_.getBufferingAudio(),o=this.streamingEngine_.getBufferingVideo(),l=this.getPresentationPeriod_(),u=Nn.getVariantByStreams(s,o,l.variants);this.abrManager_&&u&&u.allowedByApplication&&u.allowedByKeySystem?this.chooseVariant_(l.variants):(Aa.log.debug("Choosing new streams after changing configuration"),this.chooseStreamsAndSwitch_(l))}if(this.mediaSourceEngine_){var c=this.config_.textDisplayFactory;if(this.lastTextFactory_!=c){var d=new c;this.mediaSourceEngine_.setTextDisplayer(d),this.lastTextFactory_=c,this.streamingEngine_&&this.streamingEngine_.reloadTextStream()}}this.abrManager_&&(this.abrManager_.configure(this.config_.abr),this.config_.abr.enabled&&!this.switchingPeriods_?this.abrManager_.enable():this.abrManager_.disable(),this.onAbrStatusChanged_())}},{key:"getConfiguration",value:function(){window.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return Fn.mergeConfigObjects(e,this.config_,this.defaultConfig_()),e}},{key:"getSharedConfiguration",value:function(){return window.asserts.assert(this.config_,"Cannot call getSharedConfiguration after call destroy!"),this.config_}},{key:"resetConfiguration",value:function(){for(var e in window.asserts.assert(this.config_,"Cannot be destroyed"),this.config_)delete this.config_[e];Fn.mergeConfigObjects(this.config_,this.defaultConfig_(),this.defaultConfig_()),this.applyConfig_()}},{key:"getLoadMode",value:function(){return this.loadMode_}},{key:"getMediaElement",value:function(){return this.video_}},{key:"getNetworkingEngine",value:function(){return this.networkingEngine_}},{key:"getAssetUri",value:function(){return this.assetUri_}},{key:"getManifestUri",value:function(){return _a.deprecateFeature(2,6,"getManifestUri",'Please use "getAssetUri" instead.'),this.getAssetUri()}},{key:"isLive",value:function(){return this.manifest_?this.manifest_.presentationTimeline.isLive():!(!this.video_||!this.video_.src)&&this.video_.duration==1/0}},{key:"isInProgress",value:function(){return!!this.manifest_&&this.manifest_.presentationTimeline.isInProgress()}},{key:"isAudioOnly",value:function(){if(this.manifest_){if(!this.manifest_.periods.length)return!1;var e=this.manifest_.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.video_||!this.video_.src)&&(this.video_.videoTracks?0==this.video_.videoTracks.length:0==this.video_.videoHeight)}},{key:"seekRange",value:function(){if(this.manifest_){var e=this.manifest_.presentationTimeline;return{start:e.getSeekRangeStart(),end:e.getSeekRangeEnd()}}if(this.video_&&this.video_.src){var t=this.video_.seekable;if(t.length)return{start:t.start(0),end:t.end(t.length-1)}}return{start:0,end:0}}},{key:"keySystem",value:function(){return this.drmEngine_?this.drmEngine_.keySystem():""}},{key:"drmInfo",value:function(){return this.drmEngine_?this.drmEngine_.getDrmInfo():null}},{key:"getExpiration",value:function(){return this.drmEngine_?this.drmEngine_.getExpiration():1/0}},{key:"isBuffering",value:function(){var e=ri.State;return!!this.bufferObserver_&&this.bufferObserver_.getState()==e.STARVING}},{key:"getPlaybackRate",value:function(){return this.playRateController_?this.playRateController_.getActiveRate():0}},{key:"trickPlay",value:function(e){window.asserts.assert(0!=e,"Should never set a trick play rate of 0!"),0!=e?(this.video_.paused&&this.video_.play(),this.playRateController_.set(e),this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.setTrickPlay(Math.abs(e)>1)):Aa.log.alwaysWarn("A trick play rate of 0 is unsupported!")}},{key:"cancelTrickPlay",value:function(){this.loadMode_==t.LoadMode.SRC_EQUALS&&this.playRateController_.set(1),this.loadMode_==t.LoadMode.MEDIA_SOURCE&&(this.playRateController_.set(1),this.streamingEngine_.setTrickPlay(!1))}},{key:"getVariantTracks",value:function(){if(this.manifest_&&this.playhead_){var e=this.getPresentationVariant_(),t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.getSelectableVariants_()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=Nn.variantToTrack(o);l.active=o==e,t.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}return this.video_&&this.video_.audioTracks?Array.from(this.video_.audioTracks).map(function(e){return Nn.html5AudioTrackToTrack(e)}):[]}},{key:"getTextTracks",value:function(){if(this.manifest_&&this.playhead_){var e=this.getPresentationText_(),t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.getSelectableText_()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=Nn.textStreamToTrack(o);l.active=o==e,t.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}return this.video_&&this.video_.src&&this.video_.textTracks?Array.from(this.video_.textTracks).map(function(e){return Nn.html5TextTrackToTrack(e)}):[]}},{key:"selectTextTrack",value:function(e){if(this.manifest_&&this.streamingEngine_){var t=this.getPresentationPeriod_(),n=t.textStreams.find(function(t){return t.id==e.id});if(!n)return void Aa.log.error("No stream with id",e.id);this.addTextStreamToSwitchHistory_(t,n,!1),this.switchTextStream_(n),this.currentTextLanguage_=n.language}else if(this.video_&&this.video_.src&&this.video_.textTracks){for(var r=0,i=Array.from(this.video_.textTracks);r<i.length;r++){var a=i[r];Nn.html5TrackId(a)==e.id?a.mode=this.isTextVisible_?"showing":"hidden":a.mode="disabled"}this.onTextChanged_()}}},{key:"selectEmbeddedTextTrack",value:function(){_a.deprecateFeature(2,6,"selectEmbeddedTextTrack",["If closed captions are signaled in the manifest, a text stream will","be created to represent them. Please use SelectTextTrack."].join(" "));var e=this.getTextTracks().filter(function(e){return e.mimeType==Ot.CLOSED_CAPTION_MIMETYPE});e.length>0?this.selectTextTrack(e[0]):Aa.log.warning("Unable to find the text track embedded in the video.")}},{key:"usingEmbeddedTextTrack",value:function(){_a.deprecateFeature(2,6,"usingEmbeddedTextTrack",["If closed captions are signaled in the manifest, a text stream will","be created to represent them. There should be no reason to know if","the player is playing embedded text."].join(" "));var e=this.getTextTracks().filter(function(e){return e.active})[0];return!!e&&e.mimeType==Ot.CLOSED_CAPTION_MIMETYPE}},{key:"selectVariantTrack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.manifest_&&this.streamingEngine_){var r=this.getPresentationPeriod_();this.config_.abr.enabled&&Aa.log.alwaysWarn("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=r.variants.find(function(t){return t.id==e.id});if(!i)return void Aa.log.error("No variant with id",e.id);if(!Nn.isPlayable(i))return void Aa.log.error("Unable to switch to restricted track",e.id);this.addVariantToSwitchHistory_(r,i,!1),this.switchVariant_(i,t,n),this.currentAdaptationSetCriteria_=new Jr(i),this.chooseVariant_(r.variants)}else if(this.video_&&this.video_.audioTracks){for(var a=0,s=Array.from(this.video_.audioTracks);a<s.length;a++){var o=s[a];Nn.html5TrackId(o)==e.id&&(o.enabled=!0)}this.onVariantChanged_()}}},{key:"getAudioLanguagesAndRoles",value:function(){return t.getLanguageAndRolesFrom_(this.getVariantTracks())}},{key:"getTextLanguagesAndRoles",value:function(){return t.getLanguageAndRolesFrom_(this.getTextTracks())}},{key:"getAudioLanguages",value:function(){return Array.from(t.getLanguagesFrom_(this.getVariantTracks()))}},{key:"getTextLanguages",value:function(){return Array.from(t.getLanguagesFrom_(this.getTextTracks()))}},{key:"selectAudioLanguage",value:function(e,t){if(this.manifest_&&this.playhead_){var n=this.getPresentationPeriod_();this.currentAdaptationSetCriteria_=new ei(e,t||"",0),this.chooseStreamsAndSwitch_(n)}else if(this.video_&&this.video_.audioTracks){for(var r=0,i=Array.from(this.video_.audioTracks);r<i.length;r++){var a=i[r];a.language==e&&(a.enabled=!0)}this.onVariantChanged_()}}},{key:"selectTextLanguage",value:function(e,t){if(this.manifest_&&this.playhead_){var n=this.getPresentationPeriod_();this.currentTextLanguage_=e,this.currentTextRole_=t||"",this.chooseStreamsAndSwitch_(n)}else{var r=this.getTextTracks().filter(function(t){return t.language==e})[0];r&&this.selectTextTrack(r)}}},{key:"isTextTrackVisible",value:function(){var e=this.isTextVisible_;if(this.manifest_){var t=this.mediaSourceEngine_.getTextDisplayer().isTextVisible();return window.asserts.assert(t==e,"text visibility has fallen out of sync"),t}return this.video_&&this.video_.src&&this.video_.textTracks?Array.from(this.video_.textTracks).some(function(e){return"showing"==e.mode}):e}},{key:"setTextTrackVisibility",value:function(){var e=ba(regeneratorRuntime.mark(function e(n){var r,i,a,s,o,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isTextVisible_!=(r=n)){e.next=4;break}return e.abrupt("return");case 4:if(this.isTextVisible_=r,this.loadMode_!=t.LoadMode.MEDIA_SOURCE){e.next=19;break}if(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(n),this.config_.streaming.alwaysStreamText){e.next=17;break}if(!n){e.next=16;break}if(i=this.getPresentationPeriod_(),!((a=Nn.filterStreamsByLanguageAndRole(i.textStreams,this.currentTextLanguage_,this.currentTextRole_)).length>0)){e.next=14;break}return e.next=14,this.streamingEngine_.loadNewTextStream(a[0]);case 14:e.next=17;break;case 16:this.streamingEngine_.unloadTextStream();case 17:e.next=20;break;case 19:if(this.video_&&this.video_.src&&this.video_.textTracks)for(s=Array.from(this.video_.textTracks),o=0,l=s;o<l.length;o++)"disabled"!=(u=l[o]).mode&&(u.mode=n?"showing":"hidden");case 20:this.onTextTrackVisibility_();case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPlayheadTimeAsDate",value:function(){if(!this.isLive())return Aa.log.warning("getPlayheadTimeAsDate is for live streams!"),null;if(this.manifest_){var e=this.manifest_.presentationTimeline.getPresentationStartTime(),t=this.video_.currentTime;return new Date(1e3*(e+t))}if(this.video_&&this.video_.getStartDate){var n=this.video_.getStartDate();return isNaN(n.getTime())?(Aa.log.warning("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(n.getTime()+1e3*this.video_.currentTime)}return Aa.log.warning("No way to get playhead time as Date!"),null}},{key:"getPresentationStartTimeAsDate",value:function(){if(!this.isLive())return Aa.log.warning("getPresentationStartTimeAsDate is for live streams!"),null;if(this.manifest_){var e=this.manifest_.presentationTimeline.getPresentationStartTime();return new Date(1e3*e)}if(this.video_&&this.video_.getStartDate){var t=this.video_.getStartDate();return isNaN(t.getTime())?(Aa.log.warning("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):t}return Aa.log.warning("No way to get presentation start time as Date!"),null}},{key:"getBufferedInfo",value:function(){var e={total:[],audio:[],video:[],text:[]};if(this.loadMode_==t.LoadMode.SRC_EQUALS){var n=n;e.total=n.getBufferedInfo(this.video_.buffered)}return this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.mediaSourceEngine_.getBufferedInfo(e),e}},{key:"getStats",value:function(){if(!(this.loadMode_==t.LoadMode.MEDIA_SOURCE||this.loadMode_==t.LoadMode.SRC_EQUALS))return ha.getEmptyBlob();this.updateStateHistory_(),window.asserts.assert(this.video_,"If we have stats, we should have video_");var e=this.video_;if(e.getVideoPlaybackQuality){var n=e.getVideoPlaybackQuality();this.stats_.setDroppedFrames(Number(n.droppedVideoFrames),Number(n.totalVideoFrames))}if(this.loadMode_==t.LoadMode.MEDIA_SOURCE){var r=this.getPresentationVariant_();r&&this.stats_.setVariantBandwidth(r.bandwidth),r&&r.video&&this.stats_.setResolution(r.video.width||NaN,r.video.height||NaN);var i=this.abrManager_.getBandwidthEstimate();this.stats_.setBandwidthEstimate(i)}return this.stats_.getBlob()}},{key:"addTextTrack",value:function(){var e=ba(regeneratorRuntime.mark(function e(n,r,i,a,s,o){var l,u,c,d,h,f,p,m,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.SRC_EQUALS){e.next=3;break}throw Aa.log.error("Cannot add text when loaded with src="),new M("State error!");case 3:if(this.loadMode_==t.LoadMode.MEDIA_SOURCE){e.next=6;break}throw Aa.log.error("Must call load() and wait for it to resolve before adding text tracks."),new M("State error!");case 6:if(l=this.getPresentationPeriod_(),u=Re.ContentType,c=this.manifest_.periods.indexOf(l),h=(d=c+1)>=this.manifest_.periods.length?this.manifest_.presentationTimeline.getDuration():this.manifest_.periods[d].startTime,(f=h-l.startTime)!=1/0){e.next=14;break}throw new M(Ia.severity.RECOVERABLE,Ia.category.MANIFEST,Ia.code.CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM);case 14:return p=new wr(1,0,f,function(){return[n]},0,null),m={id:this.nextExternalStreamId_++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:a,codecs:s||"",kind:i,encrypted:!1,keyId:null,language:r,label:o||null,type:u.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},this.loadingTextStreams_.add(m),l.textStreams.push(m),e.next=20,this.streamingEngine_.loadNewTextStream(m);case 20:return window.asserts.assert(l,"The period should still be non-null here."),(v=this.streamingEngine_.getBufferingText())&&this.activeStreams_.useText(l,v),this.loadingTextStreams_.delete(m),Aa.log.debug("Choosing new streams after adding a text stream"),this.chooseStreamsAndSwitch_(l),this.onTracksChanged_(),e.abrupt("return",Nn.textStreamToTrack(m));case 28:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a,s){return e.apply(this,arguments)}}()},{key:"setMaxHardwareResolution",value:function(e,t){this.maxHwRes_.width=e,this.maxHwRes_.height=t}},{key:"retryStreaming",value:function(){return this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.retry()}},{key:"getManifest",value:function(){return this.manifest_}},{key:"getManifestParserFactory",value:function(){return this.parser_?this.parser_.constructor:null}},{key:"addVariantToSwitchHistory_",value:function(e,t,n){this.activeStreams_.useVariant(e,t),this.stats_.getSwitchHistory().updateCurrentVariant(t,n)}},{key:"addTextStreamToSwitchHistory_",value:function(e,t,n){this.activeStreams_.useText(e,t),this.stats_.getSwitchHistory().updateCurrentText(t,n)}},{key:"defaultConfig_",value:function(){var e=this,t=Fn.createDefault();t.streaming.failureCallback=function(t){e.defaultStreamingFailureCallback_(t)};var n=this;return t.textDisplayFactory=function(){return new sa(n.video_)},t}},{key:"defaultStreamingFailureCallback_",value:function(e){var t=[Ia.code.BAD_HTTP_STATUS,Ia.code.HTTP_ERROR,Ia.code.TIMEOUT];this.isLive()&&t.includes(e.code)&&(e.severity=Ia.severity.RECOVERABLE,Aa.log.warning("Live streaming error.  Retrying automatically..."),this.retryStreaming())}},{key:"createTextStreamsForClosedCaptions_",value:function(e){var t=Re.ContentType,n=Re.TextStreamKind,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=new Map,c=!0,d=!1,h=void 0;try{for(var f,p=l.variants[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;if(m.video&&m.video.closedCaptions){var v=m.video,g=!0,y=!1,_=void 0;try{for(var w,E=v.closedCaptions.keys()[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var b=w.value;if(!u.has(b)){var S={id:this.nextExternalStreamId_++,originalId:b,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return null},getSegmentReference:function(e){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:Ot.CLOSED_CAPTION_MIMETYPE,codecs:"",kind:n.CLOSED_CAPTION,encrypted:!1,keyId:null,language:v.closedCaptions.get(b),label:null,type:t.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:v.roles,channelsCount:null,closedCaptions:null};u.set(b,S)}}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var T=!0,k=!1,C=void 0;try{for(var I,A=u.values()[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){var L=I.value;l.textStreams.push(L)}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"filterAllPeriods_",value:function(e){window.asserts.assert(this.video_,"Must not be destroyed");var t=this.streamingEngine_?this.streamingEngine_.getBufferingAudio():null,n=this.streamingEngine_?this.streamingEngine_.getBufferingVideo():null,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;Nn.filterNewPeriod(this.drmEngine_,t,n,l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var u=f.count(e,function(e){return e.variants.some(Nn.isPlayable)});if(0==u)throw new M(Ia.severity.CRITICAL,Ia.category.MANIFEST,Ia.code.CONTENT_UNSUPPORTED_BY_BROWSER);if(u<e.length)throw new M(Ia.severity.CRITICAL,Ia.category.MANIFEST,Ia.code.UNPLAYABLE_PERIOD);var c=!0,d=!1,h=void 0;try{for(var p,m=e[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var v=p.value;Nn.applyRestrictions(v.variants,this.config_.restrictions,this.maxHwRes_)&&this.streamingEngine_&&this.getPresentationPeriod_()==v&&this.onTracksChanged_(),this.checkRestrictedVariants_(v.variants)}}catch(e){d=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw h}}}},{key:"filterNewPeriod_",value:function(e){window.asserts.assert(this.video_,"Must not be destroyed");var t=this.streamingEngine_?this.streamingEngine_.getBufferingAudio():null,n=this.streamingEngine_?this.streamingEngine_.getBufferingVideo():null;Nn.filterNewPeriod(this.drmEngine_,t,n,e);var r=e.variants;if(!r.some(Nn.isPlayable))throw new M(Ia.severity.CRITICAL,Ia.category.MANIFEST,Ia.code.UNPLAYABLE_PERIOD);this.checkRestrictedVariants_(e.variants),Nn.applyRestrictions(r,this.config_.restrictions,this.maxHwRes_)&&this.streamingEngine_&&this.getPresentationPeriod_()==e&&this.onTracksChanged_();var i=this.drmEngine_?this.drmEngine_.getDrmInfo():null;if(i){var a=!0,s=!1,o=void 0;try{for(var l,u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=!0,h=!1,f=void 0;try{for(var p,m=c.drmInfos[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v.keySystem==i.keySystem){var g=!0,y=!1,_=void 0;try{for(var w,E=(v.initData||[])[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var b=w.value;this.drmEngine_.newInitData(b.initDataType,b.initData)}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}}}},{key:"switchVariant_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.switchingPeriods_?(this.deferredVariant_=e,this.deferredVariantClearBuffer_=t,this.deferredVariantClearBufferSafeMargin_=n):(this.streamingEngine_.switchVariant(e,t,n),this.onVariantChanged_())}},{key:"switchTextStream_",value:function(e){this.switchingPeriods_?this.deferredTextStream_=e:(this.streamingEngine_.switchTextStream(e),this.onTextChanged_())}},{key:"assertCorrectActiveStreams_",value:function(){if(this.streamingEngine_&&this.manifest_&&La.DEBUG){var e=this.streamingEngine_.getBufferingPeriod(),t=this.getPresentationPeriod_();if(null!=e&&e==t){var n=this.streamingEngine_.getBufferingAudio(),r=this.streamingEngine_.getBufferingVideo(),i=this.streamingEngine_.getBufferingText(),a=this.deferredVariant_?this.deferredVariant_.audio:n,s=this.deferredVariant_?this.deferredVariant_.video:r,o=this.deferredTextStream_||i,l=this.activeStreams_.getVariant(t),u=this.activeStreams_.getText(t);window.asserts.assert(l.audio==a,"Inconsistent active audio stream"),window.asserts.assert(l.video==s,"Inconsistent active video stream"),window.asserts.assert(null==o||u==o,"Inconsistent active text stream")}}}},{key:"adjustStartTime_",value:function(e){var t=this.streamingEngine_.getBufferingAudio(),n=this.streamingEngine_.getBufferingVideo(),r=this.getPresentationPeriod_();function i(e,t){if(!e)return null;var n=e.findSegmentPosition(t-r.startTime);if(null==n)return null;var i=e.getSegmentReference(n);if(!i)return null;var a=i.startTime+r.startTime;return window.asserts.assert(a<=t,"Segment should start before time"),a}var a=i(t,e),s=i(n,e);return null!=s&&null!=a?Math.max(s,a):null!=s?s:null!=a?a:e}},{key:"updateBufferState_",value:function(){var e=this.isBuffering();this.stats_&&this.bufferObserver_&&this.playhead_&&(this.playRateController_.setBuffering(e),this.updateStateHistory_());var t=new w("buffering",{buffering:e});this.dispatchEvent(t)}},{key:"onChangePeriod_",value:function(){this.onTracksChanged_()}},{key:"onRateChange_",value:function(){var e=this.video_.playbackRate;0!=e&&this.playRateController_.set(e)}},{key:"updateStateHistory_",value:function(){if(this.stats_&&this.bufferObserver_){var e=ri.State,t=this.stats_.getStateHistory();this.bufferObserver_.getState()==e.STARVING?t.update("buffering"):this.video_.paused?t.update("paused"):this.video_.ended?t.update("ended"):t.update("playing")}}},{key:"onSeek_",value:function(){this.playheadObservers_&&this.playheadObservers_.notifyOfSeek(),this.streamingEngine_&&this.streamingEngine_.seeked()}},{key:"chooseVariant_",value:function(e){window.asserts.assert(this.config_,"Must not be destroyed");try{this.checkRestrictedVariants_(e)}catch(e){return this.onError_(e),null}window.asserts.assert(e.length,"Should have thrown for no Variants.");var t=e.filter(function(e){return Nn.isPlayable(e)}),n=this.currentAdaptationSetCriteria_.create(t);return this.abrManager_.setVariants(Array.from(n.values())),this.abrManager_.chooseVariant()}},{key:"chooseTextStream_",value:function(e){return Nn.filterStreamsByLanguageAndRole(e,this.currentTextLanguage_,this.currentTextRole_)[0]||null}},{key:"chooseStreamsAndSwitch_",value:function(e){window.asserts.assert(this.config_,"Must not be destroyed");var t=this.chooseVariant_(e.variants);t&&(this.addVariantToSwitchHistory_(e,t,!0),this.switchVariant_(t,!0));var n=this.chooseTextStream_(e.textStreams);n&&this.shouldStreamText_()&&(this.addTextStreamToSwitchHistory_(e,n,!0),this.switchTextStream_(n)),this.onAdaptation_()}},{key:"onChooseStreams_",value:function(e){Aa.log.debug("onChooseStreams_",e),window.asserts.assert(this.config_,"Must not be destroyed");try{Aa.log.v2("onChooseStreams_, choosing variant from ",e.variants),Aa.log.v2("onChooseStreams_, choosing text from ",e.textStreams);var t=this.chooseStreams_(e);return Aa.log.v2("onChooseStreams_, chose variant ",t.variant),Aa.log.v2("onChooseStreams_, chose text ",t.text),t}catch(e){return this.onError_(e),{variant:null,text:null}}}},{key:"chooseStreams_",value:function(e){this.switchingPeriods_=!0,this.abrManager_.disable(),this.onAbrStatusChanged_(),Aa.log.debug("Choosing new streams after period changed");var t=this.chooseVariant_(e.variants),n=this.chooseTextStream_(e.textStreams);this.deferredVariant_&&(e.variants.includes(this.deferredVariant_)&&(t=this.deferredVariant_),this.deferredVariant_=null),this.deferredTextStream_&&(e.textStreams.includes(this.deferredTextStream_)&&(n=this.deferredTextStream_),this.deferredTextStream_=null),t&&this.addVariantToSwitchHistory_(e,t,!0),n&&this.addTextStreamToSwitchHistory_(e,n,!0);var r=!this.streamingEngine_.getBufferingPeriod(),i=t?t.audio:null;return r&&n&&(i&&this.shouldShowText_(i,n)&&(this.isTextVisible_=!0),this.isTextVisible_&&(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(!0),window.asserts.assert(this.shouldStreamText_(),"Should be streaming text")),this.onTextTrackVisibility_()),this.shouldStreamText_()?{variant:t,text:n}:{variant:t,text:null}}},{key:"shouldShowText_",value:function(e,t){var n=Ne.normalize(this.config_.preferredTextLanguage),r=Ne.normalize(e.language),i=Ne.normalize(t.language);return Ne.areLanguageCompatible(i,n)&&!Ne.areLanguageCompatible(r,i)}},{key:"canSwitch_",value:function(){Aa.log.debug("canSwitch_"),window.asserts.assert(this.config_,"Must not be destroyed"),this.switchingPeriods_=!1,this.config_.abr.enabled&&(this.abrManager_.enable(),this.onAbrStatusChanged_()),this.deferredVariant_&&(this.streamingEngine_.switchVariant(this.deferredVariant_,this.deferredVariantClearBuffer_,this.deferredVariantClearBufferSafeMargin_),this.onVariantChanged_(),this.deferredVariant_=null),this.deferredTextStream_&&(this.streamingEngine_.switchTextStream(this.deferredTextStream_),this.onTextChanged_(),this.deferredTextStream_=null)}},{key:"onManifestUpdate_",value:function(){this.parser_&&this.parser_.update&&this.parser_.update()}},{key:"onSegmentAppended_",value:function(){this.playhead_&&this.playhead_.notifyOfBufferingChange()}},{key:"switch_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Aa.log.debug("switch_"),window.asserts.assert(this.config_.abr.enabled,"AbrManager should not call switch while disabled!"),window.asserts.assert(!this.switchingPeriods_,"AbrManager should not call switch while transitioning between Periods!"),window.asserts.assert(this.manifest_,"We need a manifest to switch variants.");var r=this.findPeriodWithVariant_(e);window.asserts.assert(r,"A period should contain the variant."),this.addVariantToSwitchHistory_(r,e,!0),this.streamingEngine_&&(this.streamingEngine_.switchVariant(e,t,n),this.onAdaptation_())}},{key:"onAdaptation_",value:function(){this.delayDispatchEvent_(new w("adaptation"))}},{key:"onTracksChanged_",value:function(){this.delayDispatchEvent_(new w("trackschanged"))}},{key:"onVariantChanged_",value:function(){this.delayDispatchEvent_(new w("variantchanged"))}},{key:"onTextChanged_",value:function(){this.delayDispatchEvent_(new w("textchanged"))}},{key:"onTextTrackVisibility_",value:function(){this.delayDispatchEvent_(new w("texttrackvisibility"))}},{key:"onAbrStatusChanged_",value:function(){this.delayDispatchEvent_(new w("abrstatuschanged",{newStatus:this.config_.abr.enabled}))}},{key:"onError_",value:function(e){if(window.asserts.assert(e instanceof M,"Wrong error type!"),this.loadMode_!=t.LoadMode.DESTROYED){var n=new w("error",{detail:e});this.dispatchEvent(n),n.defaultPrevented&&(e.handled=!0)}}},{key:"onRegionEvent_",value:function(e,t){var n={schemeIdUri:t.schemeIdUri,value:t.value,startTime:t.startTime,endTime:t.endTime,id:t.id,eventElement:t.eventElement};this.dispatchEvent(new w(e,{detail:n}))}},{key:"videoErrorToShakaError_",value:function(){if(window.asserts.assert(this.video_.error,"Video error expected, but missing!"),!this.video_.error)return null;var e=this.video_.error.code;if(1==e)return null;var t=this.video_.error.msExtendedCode;t&&(t<0&&(t+=Math.pow(2,32)),t=t.toString(16));var n=this.video_.error.message;return new M(Ia.severity.CRITICAL,Ia.category.MEDIA,Ia.code.VIDEO_ERROR,e,t,n)}},{key:"onVideoError_",value:function(e){var t=this.videoErrorToShakaError_();t&&this.onError_(t)}},{key:"onKeyStatus_",value:function(e){if(this.streamingEngine_){var n=t.restrictedStatuses_,r=this.getPresentationPeriod_(),i=!1,a=Object.keys(e);0==a.length&&Aa.log.warning("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var s=1==a.length&&"00"==a[0];if(s&&Aa.log.warning("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),a.length){var o=!0,l=!1,u=void 0;try{for(var c,d=r.variants[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=Nn.getVariantStreams(h),p=!0,m=!1,v=void 0;try{for(var g,y=f[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value,w=h.allowedByKeySystem;if(_.keyId){var E=e[s?"00":_.keyId];h.allowedByKeySystem=!!E&&!n.includes(E)}w!=h.allowedByKeySystem&&(i=!0)}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}var b=this.streamingEngine_.getBufferingAudio(),S=this.streamingEngine_.getBufferingVideo(),T=Nn.getVariantByStreams(b,S,r.variants);T&&!T.allowedByKeySystem&&(Aa.log.debug("Choosing new streams after key status changed"),this.chooseStreamsAndSwitch_(r)),i&&(this.onTracksChanged_(),this.chooseVariant_(r.variants))}}},{key:"onExpirationUpdated_",value:function(e,t){this.parser_&&this.parser_.onExpirationUpdated&&this.parser_.onExpirationUpdated(e,t);var n=new w("expirationupdated");this.dispatchEvent(n)}},{key:"shouldStreamText_",value:function(){return this.config_.streaming.alwaysStreamText||this.isTextTrackVisible()}},{key:"checkRestrictedVariants_",value:function(e){var n=t.restrictedStatuses_,r=this.drmEngine_?this.drmEngine_.getKeyStatuses():{},i=Object.keys(r),a=i.length&&"00"==i[0],s=!1,o=!1,l=[],u=[],c=!0,d=!1,h=void 0;try{for(var f,p=e[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=[];m.audio&&v.push(m.audio),m.video&&v.push(m.video);for(var g=0,y=v;g<y.length;g++){var _=y[g];if(_.keyId){var w=r[a?"00":_.keyId];w?n.includes(w)&&(u.includes(w)||u.push(w)):l.includes(_.keyId)||l.push(_.keyId)}}m.allowedByApplication?m.allowedByKeySystem&&(s=!0):o=!0}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}if(!s){var E={hasAppRestrictions:o,missingKeys:l,restrictedKeyStatuses:u};throw new M(Ia.severity.CRITICAL,Ia.category.MANIFEST,Ia.code.RESTRICTIONS_CANNOT_BE_MET,E)}}},{key:"delayDispatchEvent_",value:function(){var e=ba(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:this.loadMode_!=t.LoadMode.DESTROYED&&this.dispatchEvent(n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectableVariants_",value:function(){var e=this.getPresentationPeriod_();return null==e?[]:(this.assertCorrectActiveStreams_(),e.variants.filter(function(e){return Nn.isPlayable(e)}))}},{key:"getSelectableText_",value:function(){var e=this,t=this.getPresentationPeriod_();return null==t?[]:(this.assertCorrectActiveStreams_(),t.textStreams.filter(function(t){return!e.loadingTextStreams_.has(t)}))}},{key:"getPresentationPeriod_",value:function(){window.asserts.assert(this.manifest_&&this.playhead_,"Only ask for the presentation period when loaded with media source.");var e=this.playhead_.getTime(),t=null,n=!0,r=!1,i=void 0;try{for(var a,s=this.manifest_.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.startTime<=e&&(t=o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return window.asserts.assert(t,"Should have found a period."),t}},{key:"getPresentationVariant_",value:function(){var e=this.getPresentationPeriod_();return this.activeStreams_.getVariant(e)}},{key:"getPresentationText_",value:function(){var e=this.getPresentationPeriod_();if(null==e)return null;if(!this.activeStreams_.getText(e)){var t=Nn.filterStreamsByLanguageAndRole(e.textStreams,this.currentTextLanguage_,this.currentTextRole_);t.length&&this.activeStreams_.useText(e,t[0])}return this.activeStreams_.getText(e)}},{key:"isBufferedToEndMS_",value:function(){if(window.asserts.assert(this.video_,"We need a video element to get buffering information"),window.asserts.assert(this.mediaSourceEngine_,"We need a media source engine to get buffering information"),window.asserts.assert(this.manifest_,"We need a manifest to get buffering information"),this.video_.ended)return!0;if(this.mediaSourceEngine_.ended())return!0;if(this.manifest_.presentationTimeline.isLive()){var e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd();if(on.bufferEnd(this.video_.buffered)>=e)return!0}return!1}},{key:"isBufferedToEndSrc_",value:function(){if(window.asserts.assert(this.video_,"We need a video element to get buffering information"),this.video_.ended)return!0;return on.bufferEnd(this.video_.buffered)>=this.video_.duration-.1}},{key:"findPeriodWithVariant_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.manifest_.periods[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;if(s.variants.includes(e))return s}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"createAbortLoadError_",value:function(){return new M(Ia.severity.CRITICAL,Ia.category.PLAYER,Ia.code.LOAD_INTERRUPTED)}},{key:"getNextStep_",value:function(e,t,n,r){var i=null;return e==this.detachNode_&&(i=n==this.detachNode_?this.detachNode_:this.attachNode_),e==this.attachNode_&&(i=this.getNextAfterAttach_(n,t,r)),e==this.mediaSourceNode_&&(i=this.getNextAfterMediaSource_(n,t,r)),e==this.parserNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.manifestNode_,this.unloadNode_,n,t,r)),e==this.manifestNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.drmNode_,this.unloadNode_,n,t,r)),e==this.drmNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.loadNode_,this.unloadNode_,n,t,r)),e==this.srcEqualsDrmNode_&&(i=n==this.srcEqualsNode_&&t.mediaElement==r.mediaElement?this.srcEqualsNode_:this.unloadNode_),e!=this.loadNode_&&e!=this.srcEqualsNode_||(i=this.unloadNode_),e==this.unloadNode_&&(i=this.getNextAfterUnload_(n,t,r)),window.asserts.assert(i,"Missing next step!"),i}},{key:"getNextAfterAttach_",value:function(e,t,n){return e==this.detachNode_?this.detachNode_:t.mediaElement!=n.mediaElement?this.detachNode_:e==this.attachNode_?this.attachNode_:e==this.mediaSourceNode_||e==this.loadNode_?this.mediaSourceNode_:e==this.srcEqualsNode_?this.srcEqualsDrmNode_:null}},{key:"getNextAfterMediaSource_",value:function(e,t,n){return e==this.loadNode_&&t.mediaElement==n.mediaElement?this.parserNode_:this.unloadNode_}},{key:"getNextAfterUnload_",value:function(e,t,n){return n.mediaElement&&t.mediaElement==n.mediaElement?this.attachNode_:this.detachNode_}},{key:"getNextMatchingAllDependencies_",value:function(e,t,n,r,i,a){return r==e&&i.mediaElement==a.mediaElement&&i.uri==a.uri&&i.mimeType==a.mimeType&&i.factory==a.factory?t:n}},{key:"wrapWalkerListenersWithPromise_",value:function(e){var t=this;return new Promise(function(n,r){e.onCancel=function(){return r(t.createAbortLoadError_())},e.onEnd=function(){return n()},e.onError=function(e){return r(e)},e.onSkip=function(){return r(t.createAbortLoadError_())}})}}],i=[{key:"registerSupportPlugin",value:function(e,n){t.supportPlugins_[e]=n}},{key:"isBrowserSupported",value:function(){return!!(window.Promise&&window.Uint8Array&&Array.prototype.forEach)&&(!!Qt.isBrowserSupported()&&(!!Ft.supportsMediaSource()||Ft.supportsMediaType("application/x-mpegurl")))}},{key:"probeSupport",value:function(){var e=ba(regeneratorRuntime.mark(function e(){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(t.isBrowserSupported(),"Must have basic support"),e.next=3,Qt.probeSupport();case 3:for(o in n=e.sent,r=Wn.probeSupport(),i=In.probeSupport(),a={manifest:r,media:i,drm:n},s=t.supportPlugins_)a[o]=s[o]();return e.abrupt("return",a);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"filterForAVVariants_",value:function(e){var t=function(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")};if(e.some(function(e){return e.variants.some(t)})){Aa.log.debug("Found variant with audio and video content, so filtering out audio-only content in all periods.");var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.variants=o.variants.filter(t)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}},{key:"applyPlayRange_",value:function(e,t,n){t>0&&(e.isLive()?Aa.log.warning("|playRangeStart| has been configured for live content. Ignoring the setting."):e.setUserSeekStart(t)),n<e.getDuration()&&(e.isLive()?Aa.log.warning("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.setDuration(n))}},{key:"getLanguagesFrom_",value:function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.language?t.add(Ne.normalize(o.language)):t.add("und")}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"getLanguageAndRolesFrom_",value:function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l="und",u=[];o.language&&(l=Ne.normalize(o.language)),(u="variant"==o.type?o.audioRoles:o.roles)&&u.length||(u=[""]),t.has(l)||t.set(l,new Set);var c=!0,d=!1,h=void 0;try{for(var f,p=u[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;t.get(l).add(m)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var v=[];return t.forEach(function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;v.push({language:t,role:o})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}),v}},{key:"createEmptyPayload_",value:function(){return{factory:null,mediaElement:null,mimeType:null,startTime:null,startTimeOfLoad:null,uri:null}}}],r&&Sa(n.prototype,r),i&&Sa(n,i),t}();function xa(e){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Na(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Ma(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Na(a,r,i,s,o,"next",e)}function o(e){Na(a,r,i,s,o,"throw",e)}s(void 0)})}}function Pa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ra.LoadMode={DESTROYED:0,NOT_LOADED:1,MEDIA_SOURCE:2,SRC_EQUALS:3},Ra.TYPICAL_BUFFERING_THRESHOLD_=.5,Ra.version="v2.5.2-master-uncompiled",_a.init(Ra.version),Ra.restrictedStatuses_=["output-restricted","internal-error"],Ra.supportPlugins_={};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Oa=window.shaka,Da=(window.goog,function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.constructor!=Ra)throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);this.config_=null,this.networkingEngine_=null,t?(this.config_=t.getSharedConfiguration(),this.networkingEngine_=t.getNetworkingEngine(),window.asserts.assert(this.networkingEngine_,"Storage should not be initialized with a player that had |destroy| called on it.")):(this.config_=Fn.createDefault(),this.networkingEngine_=new oe),this.storeInProgress_=!1,this.segmentsFromStore_=[],this.openOperations_=[];var r=!t;this.destroyer_=new Rt(Ma(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){},e.next=3,Promise.all(n.openOperations_.map(function(e){return e.then(t,t)}));case 3:if(!r){e.next=6;break}return e.next=6,n.networkingEngine_.destroy();case 6:n.config_=null,n.networkingEngine_=null;case 8:case"end":return e.stop()}},e)})))}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"configure",value:function(t,n){return window.asserts.assert("object"==xa(t)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof t&&(t=St.convertToConfigObject(t,n)),window.asserts.assert("object"==xa(t),"Should be an object!"),e.verifyConfig_(t),window.asserts.assert(this.config_,"Cannot reconfigure stroage after calling destroy."),Fn.mergeConfigObjects(this.config_,t)}},{key:"getConfiguration",value:function(){window.asserts.assert(this.config_,"Config must not be null!");var e=Fn.createDefault();return Fn.mergeConfigObjects(e,this.config_,Fn.createDefault()),e}},{key:"getNetworkingEngine",value:function(){return this.networkingEngine_}},{key:"store",value:function(e,t,n){var r=this,i=function(){var t=Ma(regeneratorRuntime.mark(function t(){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||"string"==typeof n){t.next=4;break}return Oa.Deprecate.deprecateFeature(2,6,"Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=n,t.abrupt("return",new i);case 4:return window.asserts.assert(r.networkingEngine_,"Should not call |store| after |destroy|"),t.next=7,Wn.create(e,r.networkingEngine_,r.config_.manifest.retryParameters,n);case 7:return a=t.sent,t.abrupt("return",a);case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return this.startOperation_(this.store_(e,t||{},i))}},{key:"getStoreInProgress",value:function(){return this.storeInProgress_}},{key:"store_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,l,u,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requireSupport_(),!this.storeInProgress_){e.next=3;break}throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.STORE_ALREADY_IN_PROGRESS);case 3:return this.storeInProgress_=!0,e.next=6,this.parseManifest(t,r);case 6:if(i=e.sent,this.ensureNotDestroyed_(),!i.presentationTimeline.isLive()&&!i.presentationTimeline.isInProgress()){e.next=11;break}throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.CANNOT_STORE_LIVE_OFFLINE,t);case 11:return a=null,s=new dr,o=null,l=null,e.prev=15,e.next=18,this.createDrmEngine(i,function(e){l=l||e});case 18:if(a=e.sent,this.ensureNotDestroyed_(),!l){e.next=22;break}throw l;case 22:return this.filterManifest_(i,a),e.next=25,s.init();case 25:return this.ensureNotDestroyed_(),e.next=28,s.getActive();case 28:return o=e.sent,this.ensureNotDestroyed_(),window.asserts.assert(a,"drmEngine should be non-null here."),e.next=33,this.downloadManifest_(o.cell,a,i,t,n);case 33:if(u=e.sent,this.ensureNotDestroyed_(),!l){e.next=37;break}throw l;case 37:return e.next=39,o.cell.addManifests([u]);case 39:return c=e.sent,this.ensureNotDestroyed_(),d=er.manifest(o.path.mechanism,o.path.cell,c[0]),e.abrupt("return",Ar.fromManifestDB(d,u));case 45:if(e.prev=45,e.t0=e.catch(15),!o){e.next=50;break}return e.next=50,o.cell.removeSegments(this.segmentsFromStore_,function(){});case 50:throw l||e.t0;case 51:return e.prev=51,this.storeInProgress_=!1,this.segmentsFromStore_=[],e.next=56,s.destroy();case 56:if(!a){e.next=59;break}return e.next=59,a.destroy();case 59:return e.finish(51);case 60:case"end":return e.stop()}},e,this,[[15,45,51,60]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"filterManifest_",value:function(t,n){var r=this,i={width:1/0,height:1/0};Ur.filterByRestrictions(t,this.config_.restrictions,i),Ur.filterByMediaSourceSupport(t),Ur.filterByDrmSupport(t,n),Ur.filterByCommonCodecs(t),Ur.rollingFilter(t,function(e){var t=Nn,n=[],i=!0,a=!1,s=void 0;try{for(var o,l=e.variants[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;window.asserts.assert(t.isPlayable(u),'We should have already filtered by "is playable"'),n.push(t.variantToTrack(u))}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var c=!0,d=!1,h=void 0;try{for(var f,p=e.textStreams[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;n.push(t.textStreamToTrack(m))}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var v=r.config_.offline.trackSelectionCallback(n),g=new Set,y=new Set,_=!0,w=!1,E=void 0;try{for(var b,S=v[Symbol.iterator]();!(_=(b=S.next()).done);_=!0){var T=b.value;"variant"==T.type&&g.add(T.id),"text"==T.type&&y.add(T.id)}}catch(e){w=!0,E=e}finally{try{_||null==S.return||S.return()}finally{if(w)throw E}}e.variants=e.variants.filter(function(e){return g.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return y.has(e.id)})}),e.validateManifest_(t)}},{key:"downloadManifest_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,l,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot call |downloadManifest_| after calling |destroy|."),s=Ar.fromManifest(i,r,0,a),o=new Zn(this.networkingEngine_,function(e,t){s.size=t,u.config_.offline.progressCallback(s,e)}),e.prev=3,l=this.createOfflineManifest_(o,t,n,r,i,a),e.next=7,o.waitToFinish();case 7:return l.size=e.sent,e.abrupt("return",l);case 9:return e.prev=9,e.next=12,o.destroy();case 12:return e.finish(9);case 13:case"end":return e.stop()}},e,this,[[3,,9,13]])}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"remove",value:function(e){return this.startOperation_(this.remove_(e))}},{key:"remove_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requireSupport_(),null!=(n=er.parse(t))&&n.isManifest()){e.next=4;break}throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.MALFORMED_OFFLINE_URI,t);case 4:return r=n,i=new dr,e.prev=6,e.next=9,i.init();case 9:return e.next=11,i.getCell(r.mechanism(),r.cell());case 11:return a=e.sent,e.next=14,a.getManifests([r.key()]);case 14:return s=e.sent,o=s[0],e.next=18,Promise.all([this.removeFromDRM_(r,o,i),this.removeFromStorage_(a,r,o)]);case 18:return e.prev=18,e.next=21,i.destroy();case 21:return e.finish(18);case 22:case"end":return e.stop()}},e,this,[[6,,18,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"removeFromDRM_",value:function(){var t=Ma(regeneratorRuntime.mark(function t(n,r,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot be destroyed"),t.next=3,e.deleteLicenseFor_(this.networkingEngine_,this.config_.drm,i,r);case 3:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"removeFromStorage_",value:function(t,n,r){var i=this,a=e.getAllSegmentIds_(r),s=a.length+1,o=0,l=Ar.fromManifestDB(n,r),u=function(e){o+=1,i.config_.offline.progressCallback(l,o/s)};return Promise.all([t.removeSegments(a,u),t.removeManifests([n.key()],u)])}},{key:"removeEmeSessions",value:function(){return this.startOperation_(this.removeEmeSessions_())}},{key:"removeEmeSessions_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o,l,u,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.requireSupport_(),window.asserts.assert(this.networkingEngine_,"Cannot be destroyed"),t=this.networkingEngine_,n=this.config_.drm,r=new dr,i=new sr,a=!1,e.prev=7,e.next=10,r.init();case 10:s=[],r.forEachEmeSessionCell(function(e){return s.push(e)}),o=0,l=s;case 13:if(!(o<l.length)){e.next=27;break}return u=l[o],e.next=17,u.getAll();case 17:return c=e.sent,e.next=20,i.delete(n,t,c);case 20:return d=e.sent,e.next=23,u.remove(d);case 23:d.length!=c.length&&(a=!0);case 24:o++,e.next=13;break;case 27:return e.prev=27,e.next=30,r.destroy();case 30:return e.finish(27);case 31:return e.abrupt("return",!a);case 32:case"end":return e.stop()}},e,this,[[7,,27,31]])}));return function(){return e.apply(this,arguments)}}()},{key:"list",value:function(){return this.startOperation_(this.list_())}},{key:"list_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.requireSupport_(),t=[],n=new dr,e.prev=3,e.next=6,n.init();case 6:return r=Promise.resolve(),n.forEachCell(function(e,n){r=r.then(Ma(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getAllManifests();case 2:r.sent.forEach(function(n,r){var i=er.manifest(e.mechanism,e.cell,r),a=Ar.fromManifestDB(i,n);t.push(a)});case 4:case"end":return r.stop()}},r)})))}),e.next=10,r;case 10:return e.prev=10,e.next=13,n.destroy();case 13:return e.finish(10);case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}},e,this,[[3,,10,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"parseManifest",value:function(){var t=Ma(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=null,a=this.networkingEngine_,window.asserts.assert(a,"Should be initialized!"),s={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},t.next=6,r();case 6:return(o=t.sent).configure(this.config_.manifest),this.ensureNotDestroyed_(),t.prev=9,t.next=12,o.start(n,s);case 12:return l=t.sent,this.ensureNotDestroyed_(),u=e.getStreamSet_(l),t.next=17,Promise.all(Array.from(u).map(function(e){return e.createSegmentIndex()}));case 17:if(this.ensureNotDestroyed_(),!i){t.next=20;break}throw i;case 20:return t.abrupt("return",l);case 21:return t.prev=21,t.next=24,o.stop();case 24:return t.finish(21);case 25:case"end":return t.stop()}},t,this,[[9,,21,25]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"createDrmEngine",value:function(){var e=Ma(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot call |createDrmEngine| after |destroy|"),r=new Qt({netEngine:this.networkingEngine_,onError:n,onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),i=Hr.getAllVariantsFrom(t.periods),a=this.config_,r.configure(a.drm),e.next=7,r.initForStorage(i,a.offline.usePersistentLicense);case 7:return e.next=9,r.setServerCertificate();case 9:return e.next=11,r.createOrLoad();case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOfflineManifest_",value:function(e,t,n,r,i,a){var s=this,o=new Nr,l=r.periods.map(function(i){return s.createPeriod_(e,t,o,n,r,i)}),u=n.getDrmInfo(),c=n.getSessionIds();if(u&&this.config_.offline.usePersistentLicense){if(!c.length)throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.NO_INIT_DATA_FOR_OFFLINE,i);u.initData=[]}return{originalManifestUri:i,duration:r.presentationTimeline.getDuration(),size:0,expiration:n.getExpiration(),periods:l,sessionIds:this.config_.offline.usePersistentLicense?c:[],drmInfo:u,appMetadata:a}}},{key:"createPeriod_",value:function(t,n,r,i,a,s){var o=!0,l=!1,u=void 0;try{for(var c,d=a.periods[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=!0,p=!1,m=void 0;try{for(var v,g=h.variants[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value;r.addVariant(y)}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}var _=!0,w=!1,E=void 0;try{for(var b,S=h.textStreams[Symbol.iterator]();!(_=(b=S.next()).done);_=!0){var T=b.value;r.addText(T)}}catch(e){w=!0,E=e}finally{try{_||null==S.return||S.return()}finally{if(w)throw E}}}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}var k=e.getStreamSet_(a),C=new Map,I=!0,A=!1,L=void 0;try{for(var R,x=k[Symbol.iterator]();!(I=(R=x.next()).done);I=!0){var N=R.value,M=this.createStream_(t,n,r,a,s,N);C.set(N.id,M)}}catch(e){A=!0,L=e}finally{try{I||null==x.return||x.return()}finally{if(A)throw L}}var P=!0,O=!1,D=void 0;try{for(var U,F=s.variants[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value;B.audio&&C.get(B.audio.id).variantIds.push(B.id),B.video&&C.get(B.video.id).variantIds.push(B.id)}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}return{startTime:s.startTime,streams:Array.from(C.values())}}},{key:"createStream_",value:function(t,n,r,i,a,s){var o=this,l={id:s.id,originalId:s.originalId,primary:s.primary,presentationTimeOffset:s.presentationTimeOffset||0,contentType:s.type,mimeType:s.mimeType,codecs:s.codecs,frameRate:s.frameRate,kind:s.kind,language:s.language,label:s.label,width:s.width||null,height:s.height||null,initSegmentKey:null,encrypted:s.encrypted,keyId:s.keyId,segments:[],variantIds:[]},u=i.presentationTimeline.getSegmentAvailabilityStart(),c=s.id;e.forEachSegment_(s,u,function(e){var i=Br.createSegmentRequest(e.getUris(),e.startByte,e.endByte,o.config_.streaming.retryParameters);t.queue(c,i,r.getSegmentEstimate(s.id,e),function(){var t=Ma(regeneratorRuntime.mark(function t(r){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.addSegments([{data:r}]);case 2:i=t.sent,o.segmentsFromStore_.push(i[0]),l.segments.push({startTime:e.startTime,endTime:e.endTime,dataKey:i[0]});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())});var d=s.initSegmentReference;if(d){var h=Br.createSegmentRequest(d.getUris(),d.startByte,d.endByte,this.config_.streaming.retryParameters);t.queue(c,h,r.getInitSegmentEstimate(s.id),function(){var e=Ma(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.addSegments([{data:t}]);case 2:r=e.sent,o.segmentsFromStore_.push(r[0]),l.initSegmentKey=r[0];case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}return l}},{key:"ensureNotDestroyed_",value:function(){if(this.destroyer_.destroyed())throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.OPERATION_ABORTED)}},{key:"requireSupport_",value:function(){if(!e.support())throw new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.STORAGE_NOT_SUPPORTED)}},{key:"startOperation_",value:function(){var e=Ma(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.openOperations_.push(t),e.prev=1,e.next=4,t;case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,f.remove(this.openOperations_,t),e.finish(5);case 8:case"end":return e.stop()}},e,this,[[1,,5,8]])}));return function(t){return e.apply(this,arguments)}}()}],r=[{key:"support",value:function(){return!!Ft.supportsMediaSource()&&dr.support()}},{key:"getCapabilities_",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e.periods[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=!0,c=!1,d=void 0;try{for(var h,f=l.streams[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;t&&"video"==p.contentType?n.push({contentType:Ot.getFullType(p.mimeType,p.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=p.contentType||n.push({contentType:Ot.getFullType(p.mimeType,p.codecs),robustness:e.drmInfo.audioRobustness})}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"forEachSegment_",value:function(e,t,n){for(var r=e.findSegmentPosition(t),i=null==r?null:e.getSegmentReference(r);i;)n(i),i=e.getSegmentReference(++r)}},{key:"getAllSegmentIds_",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=!0,u=!1,c=void 0;try{for(var d,h=o.streams[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;null!=f.initSegmentKey&&t.push(f.initSegmentKey);var p=!0,m=!1,v=void 0;try{for(var g,y=f.segments[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value;t.push(_.dataKey)}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"deleteAll",value:function(){var e=Ma(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new dr,e.prev=1,e.next=4,t.erase();case 4:return e.prev=4,e.next=7,t.destroy();case 7:return e.finish(4);case 8:case"end":return e.stop()}},e,null,[[1,,4,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"deleteLicenseFor_",value:function(){var t=Ma(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.drmInfo){t.next=2;break}return t.abrupt("return");case 2:return s=i.getEmeSessionCell(),o=a.sessionIds.map(function(t){return{sessionId:t,keySystem:a.drmInfo.keySystem,licenseUri:a.drmInfo.licenseServerUri,serverCertificate:a.drmInfo.serverCertificate,audioCapabilities:e.getCapabilities_(a,!1),videoCapabilities:e.getCapabilities_(a,!0)}}),l=new sr,t.next=7,l.delete(r,n,o);case 7:return u=t.sent,t.next=10,s.remove(u);case 10:return t.next=12,s.add(o.filter(function(e){return-1==u.indexOf(e.sessionId)}));case 12:case"end":return t.stop()}},t)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getStreamSet_",value:function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=!0,u=!1,c=void 0;try{for(var d,h=o.textStreams[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;t.add(f)}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}var p=!0,m=!1,v=void 0;try{for(var g,y=o.variants[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value;_.audio&&t.add(_.audio),_.video&&t.add(_.video)}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"verifyConfig_",value:function(e){var t=!1;null!=e.trackSelectionCallback&&(t=!0,e.offline=e.offline||{},e.offline.trackSelectionCallback=e.trackSelectionCallback,delete e.trackSelectionCallback),null!=e.progressCallback&&(t=!0,e.offline=e.offline||{},e.offline.progressCallback=e.progressCallback,delete e.progressCallback),null!=e.usePersistentLicense&&(t=!0,e.offline=e.offline||{},e.offline.usePersistentLicense=e.usePersistentLicense,delete e.usePersistentLicense),t&&Oa.Deprecate.deprecateFeature(2,6,"Storage.configure with OfflineConfig","Please configure storage with a player configuration.")}},{key:"validateManifest_",value:function(t){if(0==t.periods.length)throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.NO_PERIODS);var n=!0,r=!1,i=void 0;try{for(var a,s=t.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.validatePeriod_(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"validatePeriod_",value:function(e){var t=new Set(e.variants.map(function(e){return e.video})),n=new Set(e.variants.map(function(e){return e.audio})),r=e.textStreams;t.size>1&&Oa.log.warning("Multiple video tracks selected to be stored");var i=!0,a=!1,s=void 0;try{for(var o,l=n[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=!0,d=!1,h=void 0;try{for(var f,p=n[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;u!=m&&u.language==m.language&&Oa.log.warning("Similar audio tracks were selected to be stored",u.id,m.id)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var v=!0,g=!1,y=void 0;try{for(var _,w=r[Symbol.iterator]();!(v=(_=w.next()).done);v=!0){var E=_.value,b=!0,S=!1,T=void 0;try{for(var k,C=r[Symbol.iterator]();!(b=(k=C.next()).done);b=!0){var I=k.value;E!=I&&E.language==I.language&&Oa.log.warning("Similar text tracks were selected to be stored",E.id,I.id)}}catch(e){S=!0,T=e}finally{try{b||null==C.return||C.return()}finally{if(S)throw T}}}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}}}],n&&Pa(t.prototype,n),r&&Pa(t,r),e}());Ra.registerSupportPlugin("offline",Da.support);var Ua=Da;function Fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ba=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isTextVisible_=!1,this.cues_=[],this.video_=t,this.videoContainer_=n,this.textContainer_=Ue.createHTMLElement("div"),this.textContainer_.classList.add("shaka-text-container"),this.videoContainer_.appendChild(this.textContainer_);this.captionsTimer_=new H(function(){r.updateCaptions_()}).tickEvery(.25),this.currentCuesMap_=new Map}var t,n,r;return t=e,(n=[{key:"append",value:function(e){this.cues_=this.cues_.concat(e)}},{key:"destroy",value:function(){this.videoContainer_.removeChild(this.textContainer_),this.textContainer_=null,this.isTextVisible_=!1,this.cues_=[],this.captionsTimer_&&this.captionsTimer_.stop(),this.currentCuesMap_.clear()}},{key:"remove",value:function(e,t){if(!this.textContainer_)return!1;var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=this.cues_[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;l.startTime>e&&l.endTime<t&&n.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var u=!0,c=!1,d=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value,m=this.currentCuesMap_.get(p);m&&(this.textContainer_.removeChild(m),this.currentCuesMap_.delete(p))}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return this.cues_=this.cues_.filter(function(e){return!n.has(e)}),!0}},{key:"isTextVisible",value:function(){return this.isTextVisible_}},{key:"setTextVisibility",value:function(e){this.isTextVisible_=e}},{key:"updateCaptions_",value:function(){var e=this,t=this.video_.currentTime,n=function(n){return e.isTextVisible_&&n.startTime<=t&&n.endTime>=t},r=!0,i=!1,a=void 0;try{for(var s,o=this.currentCuesMap_.keys()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;if(!n(l)){var u=this.currentCuesMap_.get(l);this.textContainer_.removeChild(u),this.currentCuesMap_.delete(l)}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var c=this.cues_.filter(function(t){return n(t)&&!e.currentCuesMap_.has(t)}).sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),d=!0,h=!1,f=void 0;try{for(var p,m=c[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value,g=Ue.createHTMLElement("span");this.setCaptionStyles_(g,v),this.currentCuesMap_.set(v,g),this.textContainer_.appendChild(g)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"setCaptionStyles_",value:function(e,t){var n=shaka.text.Cue,r=e.style,i=this.textContainer_.style;if(r.whiteSpace="pre",e.textContent=t.payload,r.backgroundColor=t.backgroundColor,r.color=t.color,r.direction=t.direction,t.backgroundImage&&(r.backgroundImage="url('"+t.backgroundImage+"')",r.backgroundRepeat="no-repeat",r.backgroundSize="contain",r.backgroundPosition="center"),t.backgroundImage&&t.region){var a=shaka.text.CueRegion.units.PERCENTAGE,s=t.region.heightUnits==a?"%":"px",o=t.region.widthUnits==a?"%":"px";r.height=t.region.height+s,r.width=t.region.width+o}t.displayAlign==n.displayAlign.BEFORE?i.alignItems="flex-start":t.displayAlign==n.displayAlign.CENTER?i.alignItems="flex-top":i.alignItems="flex-end",r.fontFamily=t.fontFamily,r.fontWeight=t.fontWeight.toString(),r.fontSize=t.fontSize,r.fontStyle=t.fontStyle,t.line&&t.lineInterpretation==n.lineInterpretation.PERCENTAGE&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?t.lineAlign==n.lineAlign.START?i.top=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.bottom=t.line+"%"):t.writingMode==n.writingMode.VERTICAL_LEFT_TO_RIGHT?t.lineAlign==n.lineAlign.START?i.left=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.right=t.line+"%"):t.lineAlign==n.lineAlign.START?i.right=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.left=t.line+"%")),r.lineHeight=t.lineHeight,t.position&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.paddingLeft=t.position:i.paddingTop=t.position),t.positionAlign==n.positionAlign.LEFT?i.cssFloat="left":t.positionAlign==n.positionAlign.RIGHT?i.cssFloat="right":i.margin="auto",r.textAlign=t.textAlign,r.textDecoration=t.textDecoration.join(" "),r.writingMode=t.writingMode,t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.width=t.size+"%":i.height=t.size+"%"}}])&&Fa(t.prototype,n),r&&Fa(t,r),e}(),Va=n(6);function Ha(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ja(e,t,n){return t&&Ga(e.prototype,t),n&&Ga(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ka=function(){function e(){Ha(this,e)}return ja(e,null,[{key:"upgradeDom",value:function(){}}]),e}();function Wa(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function qa(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Wa(a,r,i,s,o,"next",e)}function o(e){Wa(a,r,i,s,o,"throw",e)}s(void 0)})}}function za(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Element.prototype.MaterialLayout;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ya=new M,Xa=window.shaka,$a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=null,this.container_=null,this.player_=null,this.selectedAsset=null,this.desiredConfig_,this.defaultConfig_,this.fullyLoaded_=!1,this.controls_=null,this.initialStoredList_,this.nativeControlsEnabled_=!1,this.support_,this.uiLocale_=""}var t,n,r;return t=e,(n=[{key:"initCommon_",value:function(){var e=this;window.addEventListener("error",function(t){t.message.includes("cvox.Api")||e.onError_(t.error)}),document.getElementById("error-display-close-button").addEventListener("click",function(t){return e.closeError_()}),this.setUpVersionString_()}},{key:"initFailed",value:function(){this.initCommon_();var e=Error.Severity.CRITICAL;this.handleError_(e,"Your browser is not supported!","https://github.com/google/shaka-player#platform-and-browser-support-matrix"),Ka.upgradeDom();var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=document.getElementsByClassName("should-disable-on-fail")[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.push(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}t.push(document.getElementsByClassName("mdl-layout__drawer-button"));for(var l=0,u=t;l<u.length;l++){var c=u[l];c.tabIndex=-1,c.classList.add("disabled-by-fail")}}},{key:"init",value:function(){var t=qa(regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.initCommon_(),t.next=3,Ra.probeSupport();case 3:return this.support_=t.sent,this.video_=document.getElementById("video"),this.video_.poster=e.mainPoster_,this.container_=document.getElementsByClassName("video-container")[0],this.setupPlayer_(),this.readHash_(),window.addEventListener("hashchange",function(){return r.hashChanged_()}),t.next=12,this.setupStorage_();case 12:this.dispatchEventWithName_("shaka-main-loaded"),Ka.upgradeDom(),n=this.getLastAssetFromHash_(),this.fullyLoaded_=!0,this.remakeHash(),n&&!this.selectedAsset&&this.loadAsset(n);case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setupPlayer_",value:function(){var e=this,t=this.video_.ui;this.player_=t.getControls().getPlayer(),pt.registerElement("close",new _t.Factory);var n=t.getConfiguration();n.controlPanelElements.push("close"),t.configure(n),this.player_.configure("manifest.dash.clockSyncUri","https://shaka-player-demo.appspot.com/time.txt"),this.defaultConfig_=this.player_.getConfiguration(),this.desiredConfig_=this.player_.getConfiguration();var r=navigator.languages||["en-us"];this.configure("preferredAudioLanguage",r[0]),this.configure("preferredTextLanguage",r[0]),this.uiLocale_=r[0];var i=function(t){return e.onErrorEvent_(t)};this.player_.addEventListener("error",i),this.controls_=t.getControls(),this.controls_.addEventListener("error",i),this.controls_.addEventListener("caststatuschanged",function(t){e.onCastStatusChange_(t.newStatus)});var a=this.controls_.getLocalization(),s=Pe.UNKNOWN_LOCALES;a.addEventListener(s,function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=t.locales[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.loadUILocale_(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}),this.loadUILocale_(this.uiLocale_);var o=document.getElementById("drawer-close-button");o.addEventListener("click",function(){document.getElementById("main-layout").MaterialLayout.toggleDrawer(),e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.hideNode_(o)});var l=document.querySelector(".mdl-layout__drawer-button");window.asserts.assert(l,"There should be a drawer button."),l.addEventListener("click",function(){e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.showNode_(o)});var u=document.querySelector(".mdl-layout__obfuscator");window.asserts.assert(u,"There should be an obfuscator."),u.addEventListener("click",function(){e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.hideNode_(o)}),this.hideNode_(o)}},{key:"getIsDrawerOpen",value:function(){var e=document.querySelector(".mdl-layout__drawer");return window.asserts.assert(e,"There should be a drawer."),e.classList.contains("is-visible")}},{key:"getIdentifierFromAsset_",value:function(e){return e.name+(e.source==fe.Source.CUSTOM?" [CUSTOM]":"")}},{key:"makeStorageInstance_",value:function(){var e=this;if(!Ua.support())return null;var t=new Ua;return t.configure("offline.progressCallback",function(t,n){var r=function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=fe.testAssets[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(e.getIdentifierFromAsset_(o)==t)return o}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(shakaDemoCustom){var l=!0,u=!1,c=void 0;try{for(var d,h=shakaDemoCustom.assets()[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;if(e.getIdentifierFromAsset_(f)==t)return f}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}return null}(t.appMetadata.identifier);r&&(r.storedProgress=n,e.dispatchEventWithName_("shaka-main-offline-progress"))}),t}},{key:"setupOfflineSupport",value:function(e){var t=this;if(this.initialStoredList_){var n=!0,r=!1,i=void 0;try{for(var a,s=this.initialStoredList_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=o.appMetadata.identifier;this.getIdentifierFromAsset_(e)==l&&(e.storedContent=o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.storeCallback=qa(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.makeStorageInstance_()){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,t.drmConfiguration_(e,r);case 6:return i={identifier:t.getIdentifierFromAsset_(e),downloaded:new Date},e.storedProgress=0,t.dispatchEventWithName_("shaka-main-offline-progress"),n.next=11,r.store(e.manifestUri,i);case 11:a=n.sent,e.storedContent=a,n.next=19;break;case 15:n.prev=15,n.t0=n.catch(3),t.onError_(n.t0),e.storedContent=null;case 19:r.destroy(),e.storedProgress=1,t.dispatchEventWithName_("shaka-main-offline-progress");case 22:case"end":return n.stop()}},n,null,[[3,15]])})),e.unstoreCallback=qa(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e==t.selectedAsset&&t.unload(),!e.storedContent||!e.storedContent.offlineUri){n.next=19;break}if(r=t.makeStorageInstance_()){n.next=5;break}return n.abrupt("return");case 5:return n.prev=5,e.storedProgress=0,t.dispatchEventWithName_("shaka-main-offline-progress"),n.next=10,r.remove(e.storedContent.offlineUri);case 10:e.storedContent=null,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),t.onError_(n.t0);case 16:r.destroy(),e.storedProgress=1,t.dispatchEventWithName_("shaka-main-offline-progress");case 19:case"end":return n.stop()}},n,null,[[5,13]])}))}}},{key:"setupStorage_",value:function(){var e=qa(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.makeStorageInstance_()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.list();case 6:this.initialStoredList_=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0),this.initialStoredList_=null;case 13:return e.prev=13,t.destroy(),e.finish(13);case 16:n=!0,r=!1,i=void 0,e.prev=19,a=fe.testAssets[Symbol.iterator]();case 21:if(n=(s=a.next()).done){e.next=29;break}if(o=s.value,!this.getAssetUnsupportedReason(o,!0)){e.next=25;break}return e.abrupt("continue",26);case 25:this.setupOfflineSupport(o);case 26:n=!0,e.next=21;break;case 29:e.next=35;break;case 31:e.prev=31,e.t1=e.catch(19),r=!0,i=e.t1;case 35:e.prev=35,e.prev=36,n||null==a.return||a.return();case 38:if(e.prev=38,!r){e.next=41;break}throw i;case 41:return e.finish(38);case 42:return e.finish(35);case 43:case"end":return e.stop()}},e,this,[[3,9,13,16],[19,31,35,43],[36,,38,42]])}));return function(){return e.apply(this,arguments)}}()},{key:"hashChanged_",value:function(){this.readHash_(),this.dispatchEventWithName_("shaka-main-config-change")}},{key:"getAssetUnsupportedReason",value:function(e,t){var n=this;if(e.source==fe.Source.CUSTOM)return null;if(e.disabled)return"This asset is disabled.";if(t&&!e.features.includes(fe.Feature.OFFLINE))return"This asset cannot be downloaded.";if(t&&!Ua.support())return"Your browser does not support offline storage.";if(!e.drm.includes(fe.KeySystem.CLEAR)){if(!e.drm.some(function(e){return n.support_.drm[e]}))return"Your browser does not support the required key systems.";if(t)if(!e.drm.some(function(e){return n.support_.drm[e]&&n.support_.drm[e].persistentState}))return"Your browser does not support offline licenses for the required key systems."}if(e.features.includes(fe.Feature.DASH)&&!this.support_.manifest.mpd)return"Your browser does not support MPEG-DASH manifests.";if(e.features.includes(fe.Feature.HLS)&&!this.support_.manifest.m3u8)return"Your browser does not support HLS manifests.";var r=[];return e.features.includes(fe.Feature.WEBM)&&r.push("video/webm"),e.features.includes(fe.Feature.MP4)&&r.push("video/mp4"),e.features.includes(fe.Feature.MP2TS)&&r.push("video/mp2t"),r.some(function(e){return n.support_.media[e]})?null:"Your browser does not support the required video format."}},{key:"setNativeControlsEnabled",value:function(e){this.nativeControlsEnabled_=e,this.remakeHash()}},{key:"getNativeControlsEnabled",value:function(){return this.nativeControlsEnabled_}},{key:"loadUILocale_",value:function(){var e=qa(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=Va,r=new Map,n)r.set(i,n[i]);this.controls_.getLocalization().insert(t,r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setUILocale",value:function(e){this.uiLocale_=e;var t=[e].concat(navigator.languages);this.controls_.getLocalization().changeLocale(t)}},{key:"getUILocale",value:function(){return this.uiLocale_}},{key:"getLastAssetFromHash_",value:function(){var t=this.getParams_(),n=t.asset;if(n){var r=!0,i=!1,a=void 0;try{for(var s,o=fe.testAssets[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;if(l.manifestUri==n)return l}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var u=!0,c=!1,d=void 0;try{for(var h,f=shakaDemoCustom.assets()[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;if(p.manifestUri==n)return p}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}var m=new ce("loaded asset","",n,fe.Source.UNKNOWN);if("license"in t){var v=e.commonDrmSystems;"drmSystem"in t&&(v=[t.drmSystem]);var g=!0,y=!1,_=void 0;try{for(var w,E=v[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var b=w.value;m.addLicenseServer(b,t.license)}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}}return"certificate"in t&&m.addCertificateUri(t.certificate),m}return null}},{key:"readHash_",value:function(){var e=this,t=this.getParams_();if(this.player_){var n=this.player_.getConfiguration();pe.a.runThroughHashParams(function(n,r){if(n in t){var i=e.getCurrentConfigValue(r),a=t[n];"boolean"==typeof i?a="true"==a:"number"==typeof i&&(a=parseFloat(a)),e.configure(r,a)}},n)}if("lang"in t){var r=t.lang;this.configure("preferredAudioLanguage",r),this.configure("preferredTextLanguage",r),this.setUILocale(r)}"uilang"in t&&this.setUILocale(t.uilang),"noadaptation"in t&&this.configure("abr.enabled",!1),"jumpLargeGaps"in t&&this.configure("streaming.jumpLargeGaps",!0);if("build"in t?t.build:"compiled"in t&&"compiled",this.nativeControlsEnabled_="nativecontrols"in t,!pe.a.browserSupportsUncompiledMode()){var i=document.getElementById("uncompiled-link");i.setAttribute("disabled",""),i.removeAttribute("href"),i.title="requires a newer browser"}Xa.log&&("vv"in t?Xa.log.setLevel(Xa.log.Level.V2):"v"in t?Xa.log.setLevel(Xa.log.Level.V1):"debug"in t?Xa.log.setLevel(Xa.log.Level.DEBUG):"info"in t&&Xa.log.setLevel(Xa.log.Level.INFO))}},{key:"getParams_",value:function(){var e=location.search.substr(1);e=e?e.split(";"):[];var t=location.hash.substr(1);t=t?t.split(";"):[];for(var n=e.concat(t),r={},i=0;i<n.length;++i){var a=n[i].split("=");r[a[0]]=a.slice(1).join("=")}return r}},{key:"getValueFromGivenConfig_",value:function(e,t){for(var n=t,r=e;r;){var i=r.split(/\.(.+)/);if(3!=i.length)return n[i[0]];r=i[1],n=n[i[0]]}}},{key:"getCurrentConfigValue",value:function(e){var t=this.desiredConfig_;return this.getValueFromGivenConfig_(e,t)}},{key:"resetConfiguration",value:function(e){this.configure(e,void 0)}},{key:"configure",value:function(e,t){2==arguments.length&&"string"==typeof e&&(e=St.convertToConfigObject(e,t));var n=e;Fn.mergeConfigObjects(this.desiredConfig_,n,this.defaultConfig_),this.player_.configure(e,t)}},{key:"getConfiguration",value:function(){return this.desiredConfig_}},{key:"requestCertificate_",value:function(){var e=qa(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=NetworkingEngine.RequestType.APP,i={uris:[t]},e.next=4,n.request(r,i).promise;case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"unload",value:function(){this.selectedAsset=null;var t=document.getElementById("video-bar");this.hideNode_(t),this.video_.poster=e.mainPoster_,this.player_.unload(),this.dispatchEventWithName_("shaka-main-selected-asset-changed"),this.remakeHash()}},{key:"drmConfiguration_",value:function(){var e=qa(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n?n.getNetworkingEngine():this.player_.getNetworkingEngine(),window.asserts.assert(r,"There should be a net engine."),t.applyFilters(r),i=t.getConfiguration(),n?n.configure(i):(this.player_.configure(this.desiredConfig_),this.player_.configure(i)),a=n?n.getConfiguration():this.player_.getConfiguration(),!t.certificateUri){e.next=32;break}return e.next=9,this.requestCertificate_(t.certificateUri,r);case 9:for(s=e.sent,o=new Uint8Array(s),l=!0,u=!1,c=void 0,e.prev=14,d=t.licenseServers.keys()[Symbol.iterator]();!(l=(h=d.next()).done);l=!0)f=h.value,a.drm.advanced[f]=a.drm.advanced[f]||{},a.drm.advanced[f].serverCertificate=o;e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),u=!0,c=e.t0;case 22:e.prev=22,e.prev=23,l||null==d.return||d.return();case 25:if(e.prev=25,!u){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=51;break;case 32:for(p=!0,m=!1,v=void 0,e.prev=35,g=t.licenseServers.keys()[Symbol.iterator]();!(p=(y=g.next()).done);p=!0)_=y.value,a.drm.advanced[_]&&delete a.drm.advanced[_].serverCertificate;e.next=43;break;case 39:e.prev=39,e.t1=e.catch(35),m=!0,v=e.t1;case 43:e.prev=43,e.prev=44,p||null==g.return||g.return();case 46:if(e.prev=46,!m){e.next=49;break}throw v;case 49:return e.finish(46);case 50:return e.finish(43);case 51:n?n.configure(a):this.player_.configure("drm.advanced",a.drm.advanced),this.remakeHash();case 53:case"end":return e.stop()}},e,this,[[14,18,22,30],[23,,25,29],[35,39,43,51],[44,,46,50]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"showPlayer_",value:function(){var t=document.getElementById("video-bar");this.showNode_(t),this.closeError_(),this.video_.poster=e.mainPoster_,t.scrollIntoView({behavior:"smooth",block:"start"})}},{key:"loadAsset",value:function(){var t=qa(regeneratorRuntime.mark(function t(n){var r,i,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.selectedAsset=n,this.showPlayer_(),this.dispatchEventWithName_("shaka-main-selected-asset-changed"),t.next=6,this.drmConfiguration_(n);case 6:return this.controls_.getCastProxy().setAppData({asset:n}),this.nativeControlsEnabled_?(this.controls_.setEnabledShakaControls(!1),this.controls_.setEnabledNativeControls(!0)):(this.controls_.setEnabledShakaControls(!0),this.controls_.setEnabledNativeControls(!1)),r=this,i=function(){return r.nativeControlsEnabled_?new sa(r.video_):new Ba(r.video_,r.container_)},this.player_.configure("textDisplayFactory",i),a=(n.storedContent?n.storedContent.offlineUri:null)||n.manifestUri,console.log(this.player_,a),t.next=15,this.player_.load(a);case 15:this.player_.isAudioOnly()&&(this.video_.poster=e.audioOnlyPoster_),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),(s=t.t0).code==Ya.code.LOAD_INTERRUPTED?console.debug("load() interrupted"):this.onError_(s);case 22:this.remakeHash();case 23:case"end":return t.stop()}},t,this,[[0,18]])}));return function(e){return t.apply(this,arguments)}}()},{key:"remakeHash",value:function(){var t=this;if(this.fullyLoaded_){var n=[];if(this.player_){var r=this.player_.getConfiguration();pe.a.runThroughHashParams(function(e,r){var i=t.getCurrentConfigValue(r),a=t.defaultConfig_,s=t.getValueFromGivenConfig_(r,a),o=isNaN(i)&&isNaN(s);i==s||o||n.push(e+"="+i)},r)}if(this.getCurrentConfigValue("abr.enabled")||n.push("noadaptation"),this.getCurrentConfigValue("streaming.jumpLargeGaps")&&n.push("jumpLargeGaps"),n.push("uilang="+this.getUILocale()),this.selectedAsset){var i=fe.testAssets.includes(this.selectedAsset);if(n.push("asset="+this.selectedAsset.manifestUri),!i&&this.selectedAsset.licenseServers.size){var a=this.selectedAsset.licenseServers.values().next().value;n.push("license="+a);var s=!0,o=!1,l=void 0;try{for(var u,c=this.selectedAsset.licenseServers.keys()[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;if(!e.commonDrmSystems.includes(d)){n.push("drmSystem="+d);break}}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}}!i&&this.selectedAsset.certificateUri&&n.push("certificate="+this.selectedAsset.certificateUri)}var h=document.getElementById("nav-button-container"),f=!0,p=!1,m=void 0;try{for(var v,g=h.childNodes[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value;if(y.nodeType==Node.ELEMENT_NODE&&y.classList.contains("mdl-button--accent")){n.push("panel="+y.textContent);break}}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}if(this.nativeControlsEnabled_&&n.push("nativecontrols"),Xa.log&&Xa.log.currentLevel!=Xa.log.MAX_LOG_LEVEL)switch(Xa.log.currentLevel){case Xa.log.Level.INFO:n.push("info");break;case Xa.log.Level.DEBUG:n.push("debug");break;case Xa.log.Level.V2:n.push("vv");break;case Xa.log.Level.V1:n.push("v")}this.setNewHashSilent_(n.join(";"))}}},{key:"setNewHashSilent_",value:function(e){var t=document.location.pathname+"#"+e;history.replaceState(null,"",t)}},{key:"getHamburgerMenu",value:function(){return document.getElementById("hamburger-menu-contents")}},{key:"hideNode_",value:function(e){e.classList.add("hidden")}},{key:"showNode_",value:function(e){e.classList.remove("hidden")}},{key:"addNavButton",value:function(e){var t=this,n=document.getElementById("nav-button-container"),r=document.getElementById("contents"),i=document.getElementById("nav-button-"+e),a=this.getParams_(),s=a.panel==encodeURI(i.textContent);s||a.panel||(s=null!=i.getAttribute("defaultselected"));var o=document.createElement("div");this.hideNode_(o),r.appendChild(o);var l=function(){var e=!0,a=!1,s=void 0;try{for(var l,u=n.childNodes[Symbol.iterator]();!(e=(l=u.next()).done);e=!0){var c=l.value;c.nodeType==Node.ELEMENT_NODE&&c.classList.remove("mdl-button--accent")}}catch(e){a=!0,s=e}finally{try{e||null==u.return||u.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=r.childNodes[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.nodeType==Node.ELEMENT_NODE&&t.hideNode_(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}i.classList.add("mdl-button--accent"),t.showNode_(o),t.remakeHash(),t.dispatchEventWithName_("shaka-main-page-changed"),o.scrollIntoView({behavior:"smooth",block:"start"})};return i.addEventListener("click",l),s&&Promise.resolve().then(l),o}},{key:"dispatchEventWithName_",value:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,null),document.dispatchEvent(t)}},{key:"setUpVersionString_",value:function(){for(var e=Ra.version.split("-"),t=[],n=function(){var n=i[r];e.includes(n)&&(t.push(n),e=e.filter(function(e){return e!=n}))},r=0,i=["debug","uncompiled"];r<i.length;r++)n()}},{key:"closeError_",value:function(){document.getElementById("error-display").classList.add("hidden");var e=document.getElementById("error-display-link");e.href="",e.textContent="",e.severity=null}},{key:"onErrorEvent_",value:function(e){this.onError_(e.detail)}},{key:"onError_",value:function(e){var t=e.severity;null!=t&&null!=e.severity||(t=Ya.severity.CRITICAL);var n=e.message||"Error code "+e.code,r="";e.code&&(r="../docs/api/Error.html#value:"+e.code),console.error(e),this.handleError_(t,n,r)}},{key:"handleError_",value:function(e,t,n){var r=document.getElementById("error-display-link");(null==r.severity||e>r.severity)&&(r.href=n,void 0===r.textContent?r.innerText=t:r.textContent=t,r.severity=e,r.href?r.classList.remove("input-disabled"):r.classList.add("input-disabled"),document.getElementById("error-display").classList.remove("hidden"))}},{key:"onCastStatusChange_",value:function(e){e&&!this.selectedAsset&&(this.selectedAsset=ce.makeBlankAsset(),this.showPlayer_())}}])&&za(t.prototype,n),r&&za(t,r),e}();$a.commonDrmSystems=["com.widevine.alpha","com.microsoft.playready","com.apple.fps.1_0","com.adobe.primetime","org.w3.clearkey"];var Qa=new $a,Za=Qa;function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}$a.mainPoster_="https://shaka-player-demo.appspot.com/assets/poster.jpg",$a.audioOnlyPoster_="https://shaka-player-demo.appspot.com/assets/audioOnly.gif",$a.initWrapper=function(){var e=qa(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),Qa.onError_(e.t0),console.error(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("shaka-ui-loaded",function(){$a.initWrapper(function(){return Qa.init()})}),document.addEventListener("shaka-ui-load-failed",function(e){$a.initWrapper(function(){return Qa.initFailed()})});
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var es=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerDialog",value:function(e){}}],(n=null)&&Ja(t.prototype,n),r&&Ja(t,r),e}();function ts(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function ns(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ts(a,r,i,s,o,"next",e)}function o(e){ts(a,r,i,s,o,"throw",e)}s(void 0)})}}function rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}window.shaka=window.shaka||{};window.shaka;var is=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.card_=document.createElement("div"),this.asset_=n,this.actions_=document.createElement("div"),this.featureIconsContainer_=document.createElement("div"),this.progressBar_=document.createElement("progress"),this.remakeButtonsFn_=i,this.card_.classList.add("mdl-card-wide"),this.card_.classList.add("mdl-card"),this.card_.classList.add("mdl-shadow--2dp"),this.card_.classList.add("asset-card");var a=document.createElement("div");a.classList.add("mdl-card__title"),this.card_.appendChild(a);var s=document.createElement("h2");if(s.classList.add("mdl-card__title-text"),s.textContent=n.shortName||n.name,a.appendChild(s),n.iconUri){var o=document.createElement("picture"),l=document.createElement("source");l.srcset=n.iconUri.replace(/.png$/,".webp"),l.type="image/webp";var u=document.createElement("source");u.srcset=n.iconUri,u.type="image/png";var c=document.createElement("img");c.src=n.iconUri,c.alt="",o.appendChild(l),o.appendChild(u),o.appendChild(c),this.card_.appendChild(o)}if(n.description&&r){var d=document.createElement("div");d.classList.add("mdl-card__supporting-text"),d.textContent=n.description,this.card_.appendChild(d)}this.card_.appendChild(this.featureIconsContainer_),this.addFeatureIcons_(n),this.actions_.classList.add("mdl-card__actions"),this.actions_.classList.add("mdl-card--border"),this.card_.appendChild(this.actions_);var h=document.createElement("div");this.progressBar_.classList.add("hidden"),this.progressBar_.setAttribute("max",1),this.progressBar_.setAttribute("value",n.storedProgress),h.appendChild(this.progressBar_),this.card_.appendChild(h),t.appendChild(this.card_),this.remakeButtons()}var t,n,r;return t=e,(n=[{key:"addFeatureIcon_",value:function(e,t){var n=document.createElement("div");n.classList.add("feature-icon"),n.setAttribute("icon",e),this.featureIconsContainer_.appendChild(n),ye.make(n,t)}},{key:"addFeatureIcons_",value:function(e){var t=fe.Feature,n=fe.KeySystem,r=(new Map).set(t.SUBTITLES,"subtitles").set(t.CAPTIONS,"closed_caption").set(t.LIVE,"live").set(t.TRICK_MODE,"trick_mode").set(t.HIGH_DEFINITION,"high_definition").set(t.ULTRA_HIGH_DEFINITION,"ultra_high_definition").set(t.SURROUND,"surround_sound").set(t.MULTIPLE_LANGUAGES,"multiple_languages").set(t.AUDIO_ONLY,"audio_only"),i=!0,a=!1,s=void 0;try{for(var o,l=e.features[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=r.get(u);c&&this.addFeatureIcon_(c,u)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=e.drm[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){switch(p.value){case n.WIDEVINE:this.addFeatureIcon_("widevine","Widevine DRM");break;case n.CLEAR_KEY:this.addFeatureIcon_("clear_key","Clear Key DRM");break;case n.PLAYREADY:this.addFeatureIcon_("playready","PlayReady DRM")}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"markAsUnsupported",value:function(e){this.card_.classList.add("asset-card-unsupported"),this.makeUnsupportedButton_("Not Available",e)}},{key:"makeUnsupportedButton_",value:function(e,t){var n=this.addButton(e,function(){});if(n.setAttribute("disabled",""),t){var r=document.createElement("div");n.parentElement&&n.parentElement.removeChild(n),r.classList.add("tooltip-attach-point"),r.appendChild(n),this.actions_.appendChild(r),ye.make(r,t)}return n}},{key:"selectByAsset",value:function(e){this.card_.classList.remove("selected"),this.asset_==e&&this.card_.classList.add("selected")}},{key:"remakeButtons",value:function(){Ue.removeAllChildren(this.actions_),this.remakeButtonsFn_(this)}},{key:"addStoreButton",value:function(){var e=this,t=function(e,t,n){t.classList.add("asset-card-corner-button");var r=document.createElement("i");r.textContent=n,r.classList.add("material-icons"),e.appendChild(r)},n=Za.getAssetUnsupportedReason(this.asset_,!0);if(!n&&this.asset_.storeCallback)if(this.asset_.isStored()){var r=this.addButton("",function(){e.makeDeleteDialog_(r)});t(r,r,"offline_pin")}else{var i=this.addButton("",ns(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.disabled=!0,t.next=3,e.asset_.storeCallback();case 3:e.remakeButtons();case 4:case"end":return t.stop()}},t)})));t(i,i,"get_app")}else{var a=this.makeUnsupportedButton_("",n);t(a,a.parentElement||a,"get_app")}}},{key:"makeDeleteDialog_",value:function(e){var t=this,n=this.card_.parentElement;if(n){var r=document.createElement("dialog");r.classList.add("mdl-dialog"),n.appendChild(r),r.showModal||es.registerDialog(r);var i=document.createElement("h2");i.classList.add("mdl-typography--title"),i.textContent="Delete the offline copy?",r.appendChild(i);var a=document.createElement("div");r.appendChild(a);var s=function(e,t){var n=document.createElement("button");n.textContent=e,n.classList.add("mdl-button"),n.classList.add("mdl-button--colored"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.addEventListener("click",function(){t()}),a.appendChild(n),n.blur()};s("Yes",ns(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.close(),e.disabled=!0,n.next=4,t.asset_.unstoreCallback();case 4:t.remakeButtons();case 5:case"end":return n.stop()}},n)}))),s("No",function(){r.close()}),r.showModal()}}},{key:"updateProgress",value:function(){if(this.asset_.storedProgress<1){this.progressBar_.classList.remove("hidden");var e=!0,t=!1,n=void 0;try{for(var r,i=this.actions_.childNodes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.disabled=!0}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}else{this.progressBar_.classList.add("hidden");var a=!0,s=!1,o=void 0;try{for(var l,u=this.actions_.childNodes[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){l.value.disabled=!1}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}}this.progressBar_.setAttribute("value",this.asset_.storedProgress)}},{key:"addButton",value:function(e,t){var n=document.createElement("button");return n.classList.add("mdl-button"),n.classList.add("mdl-button--colored"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.textContent=e,n.addEventListener("click",function(){n.hasAttribute("disabled")||t()}),this.actions_.appendChild(n),n}}])&&rs(t.prototype,n),r&&rs(t,r),e}();function as(e){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){return!t||"object"!==as(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function os(e){return(os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ls(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}function us(e,t){return(us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hs=function(){function e(t,n,r,i,a){var s=this;if(cs(this,e),this.container_=document.createElement(r),t.latestElementContainer.appendChild(this.container_),this.input_=document.createElement(n),this.input_.onchange=function(){a(s.input_)},this.input_.id=e.generateNewId_("input"),this.container_.appendChild(this.input_),t.latestTooltip){var o=document.createElement("span");o.textContent=t.latestTooltip,o.classList.add("hidden"),o.id=e.generateNewId_("extra-info"),this.container_.appendChild(o),this.input_.setAttribute("aria-describedby",o.id)}this.extra_=null,i&&(this.extra_=document.createElement(i),this.container_.appendChild(this.extra_))}var t,n,r;return t=e,r=[{key:"generateNewId_",value:function(t){var n=e.lastId_;return e.lastId_+=1,t+"-labeled-"+n}}],(n=[{key:"input",value:function(){return this.input_}},{key:"container",value:function(){return this.container_}},{key:"extra",value:function(){return this.extra_}}])&&ds(t.prototype,n),r&&ds(t,r),e}();hs.lastId_=0;var fs=function(e){function t(e,n,r,i){var a;cs(this,t),(a=ss(this,os(t).call(this,e,"select","div","label",r))).container_.classList.add("mdl-textfield"),a.container_.classList.add("mdl-js-textfield"),a.container_.classList.add("mdl-textfield--floating-label"),a.input_.classList.add("mdl-textfield__input"),a.extra_.classList.add("mdl-textfield__label"),a.extra_.setAttribute("for",a.input_.id);for(var s=0,o=Object.keys(i);s<o.length;s++){var l=o[s],u=document.createElement("option");u.textContent=i[l],u.value=l,a.input_.appendChild(u)}return a}return ls(t,hs),t}(),ps=function(e){function t(e,n,r){var i;return cs(this,t),(i=ss(this,os(t).call(this,e,"input","label","span",r))).input_.type="checkbox",i.container_.classList.add("mdl-switch"),i.container_.classList.add("mdl-js-switch"),i.container_.classList.add("mdl-js-ripple-effect"),i.container_.setAttribute("for",i.input_.id),i.input_.classList.add("mdl-switch__input"),i.extra_.classList.add("mdl-switch__label"),i}return ls(t,hs),t}(),ms=function(e){function t(e,n,r){var i;return cs(this,t),(i=ss(this,os(t).call(this,e,"input","div","label",r))).container_.classList.add("mdl-textfield"),i.container_.classList.add("mdl-js-textfield"),i.container_.classList.add("mdl-textfield--floating-label"),i.input_.classList.add("mdl-textfield__input"),i.extra_.classList.add("mdl-textfield__label"),i.extra_.setAttribute("for",i.input_.id),i}return ls(t,hs),t}(),vs=function(e){function t(e,n,r,i){var a;cs(this,t),a=ss(this,os(t).call(this,e,n,r));try{var o=new s.a(a.input_);o.list=i.slice(),o.minChars=0,a.input_.addEventListener("focus",function(){o.evaluate()})}catch(e){console.log({Awesomplete:s.a})}return a}return ls(t,ms),t}(),gs=function(e){function t(e,n,r,i,a,s){var o;cs(this,t),o=ss(this,os(t).call(this,e,n,r));var l=document.createElement("span");return l.classList.add("mdl-textfield__error"),o.container_.appendChild(l),l.textContent="Must be a positive",o.input_.pattern="(Infinity|",a?o.input_.pattern+="[0-9]*":(o.input_.pattern+="[0-9]*[1-9][0-9]*",l.textContent+=", nonzero"),i?(o.input_.pattern+="(.[0-9]+)?",l.textContent+=" number."):l.textContent+=" integer.",o.input_.pattern+=")",s&&(o.input_.pattern+="?"),o}return ls(t,ms),t}();function ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _s=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.style_=r,this.header_,this.table_=document.createElement("div"),this.latestRow_,this.latestElementContainer,this.latestTooltip,this.numRows_=0,n&&this.createHeader_(t,n),this.table_.classList.add(r),r==e.Style.ACCORDION&&this.table_.classList.add("hidden"),t.appendChild(this.table_),i&&this.addDocLink_(this.table_,i)}var t,n,r;return t=e,(n=[{key:"getIsOpen",value:function(){return this.style_==e.Style.ACCORDION&&this.table_.classList.contains("show")}},{key:"open",value:function(){var t=this;!this.style_!=e.Style.ACCORDION&&(this.table_.classList.remove("hidden"),setTimeout(function(){t.table_.classList.add("show")},20),this.header_.classList.add("mdl-button--colored"))}},{key:"close",value:function(){var t=this;this.style_==e.Style.ACCORDION&&(this.table_.classList.remove("show"),this.table_.addEventListener("transitionend",function(e){t.table_.classList.add("hidden")},{once:!0}),this.header_.classList.remove("mdl-button--colored"))}},{key:"createHeader_",value:function(t,n){var r=this;this.style_==e.Style.ACCORDION?(this.header_=document.createElement("button"),this.header_.classList.add("mdl-button--raised"),this.header_.classList.add("mdl-button"),this.header_.classList.add("mdl-js-button"),this.header_.classList.add("mdl-js-ripple-effect"),this.header_.addEventListener("click",function(){r.getIsOpen()?r.close():r.open()})):this.header_=document.createElement("h3"),this.header_.textContent=n,t.appendChild(this.header_)}},{key:"addDocLink_",value:function(e,t){var n=document.createElement("a");n.href=t,n.target="_blank",n.classList.add("mdl-button"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.classList.add("mdl-button--colored");var r=document.createElement("i");r.classList.add("material-icons"),r.textContent="help",n.appendChild(r),e.appendChild(n)}},{key:"addRow",value:function(e,t,n){this.latestRow_=document.createElement("div"),n&&this.latestRow_.classList.add(n),this.table_.appendChild(this.latestRow_);var r="input-container-row-"+this.numRows_;if(this.numRows_+=1,e){var i=document.createElement("label");i.setAttribute("for",r),i.classList.add("input-container-label");var a=document.createElement("b");a.textContent=e,i.appendChild(a),this.latestRow_.appendChild(i)}this.latestElementContainer=document.createElement("div"),this.latestRow_.appendChild(this.latestElementContainer),this.latestElementContainer.classList.add("input-container-row"),this.latestElementContainer.id=r,this.latestTooltip=t,t&&(ye.make(this.latestRow_,t),this.latestRow_.setAttribute("tabindex",-1),this.latestRow_.classList.add("borderless"))}}])&&ys(t.prototype,n),r&&ys(t,r),e}();function ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Es(e,t,n){return t&&ws(e.prototype,t),n&&ws(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_s.Style={VERTICAL:"input-container-style-vertical",ACCORDION:"input-container-style-accordion",FLEX:"input-container-style-flex"};window.shaka;var bs=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetCards_=[],this.messageDiv_=document.createElement("div"),this.assetCardDiv_=document.createElement("div"),t.appendChild(this.messageDiv_),this.makeMessage_(),t.appendChild(this.assetCardDiv_),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.assetCardDiv_.childNodes.length||t.classList.contains("hidden")||n.remakeAssetCards_()})}return Es(e,null,[{key:"init",value:function(){var t=Za.addNavButton("front");new e(t)}}]),Es(e,[{key:"makeMessage_",value:function(){var e=this,t="shakaPlayerHideFrontMessage";if(!window.localStorage.getItem(t)){var n=function(t,n){var r=document.createElement("h2");r.classList.add("mdl-typography--"+t),r.textContent=n,e.messageDiv_.appendChild(r)};n("body-2","This is a demo of Google's Shaka Player, a JavaScript library for adaptive video streaming."),n("body-1","Choose a video to playback; more assets are available via the search tab.");var r=document.createElement("button");r.classList.add("mdl-button"),r.classList.add("mdl-button--colored"),r.classList.add("mdl-js-button"),r.classList.add("mdl-js-ripple-effect"),r.textContent="Dismiss",r.addEventListener("click",function(){Ue.removeAllChildren(e.messageDiv_),window.localStorage.setItem(t,"true")}),this.messageDiv_.appendChild(r)}}},{key:"remakeAssetCards_",value:function(){var e=this;Ue.removeAllChildren(this.assetCardDiv_);var t=fe.testAssets.filter(function(e){return e.isFeatured&&!e.disabled});console.log(t),this.assetCards_=t.map(function(t){return e.createAssetCardFor_(t,e.assetCardDiv_)}),this.updateSelected_()}},{key:"createAssetCardFor_",value:function(e,t){var n=this;return new is(t,e,!0,function(t){var r=Za.getAssetUnsupportedReason(e,!1);r?t.markAsUnsupported(r):(t.addButton("Play",function(){Za.loadAsset(e),n.updateSelected_()}),t.addStoreButton())})}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Za.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}]),e}();function Ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ts(e,t,n){return t&&Ss(e.prototype,t),n&&Ss(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */document.addEventListener("shaka-main-loaded",bs.init);window.shaka;var ks=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.desiredFeatures_=[],this.desiredSource_,this.desiredDRM_,this.makeSearchDiv_(t),this.assetCards_=[],this.resultsDiv_=document.createElement("div"),t.appendChild(this.resultsDiv_),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.resultsDiv_.childNodes.length||t.classList.contains("hidden")||n.remakeResultsDiv_()})}return Ts(e,null,[{key:"init",value:function(){var t=Za.addNavButton("search");new e(t)}}]),Ts(e,[{key:"createAssetCardFor_",value:function(e){var t=this,n=this.resultsDiv_;return new is(n,e,!1,function(n){var r=Za.getAssetUnsupportedReason(e,!1);r?n.markAsUnsupported(r):(n.addButton("Play",function(){Za.loadAsset(e),t.updateSelected_()}),n.addStoreButton())})}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Za.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"remakeResultsDiv_",value:function(){var e=this;Ue.removeAllChildren(this.resultsDiv_);var t=this.searchResults_();this.assetCards_=t.map(function(t){return e.createAssetCardFor_(t)}),this.updateSelected_()}},{key:"addDesiredTerm_",value:function(t,n,r){switch(n){case e.TermType.DRM:this.desiredDRM_=t;break;case e.TermType.SOURCE:this.desiredSource_=t;break;case e.TermType.FEATURE:var i=!0,a=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c=this.desiredFeatures_.indexOf(u);-1!=c&&this.desiredFeatures_.splice(c,1)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}this.desiredFeatures_.push(t)}}},{key:"removeDesiredTerm_",value:function(t,n){var r;switch(n){case e.TermType.DRM:this.desiredDRM_=null;break;case e.TermType.SOURCE:this.desiredSource_=null;break;case e.TermType.FEATURE:-1!=(r=this.desiredFeatures_.indexOf(t))&&this.desiredFeatures_.splice(r,1)}}},{key:"makeBooleanInput_",value:function(e,t,n){var r=this;e.addRow(t,null,"significant-right-padding");new ps(e,t,function(e){e.checked?r.addDesiredTerm_(t,n,[t]):r.removeDesiredTerm_(t,n),r.remakeResultsDiv_(),componentHandler.upgradeDom()})}},{key:"makeSelectInput_",value:function(e,t,n,r){var i=this;e.addRow(null,null);var a={},s=!0,o=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;if("DRM"==r){for(var h in fe.KeySystem)if(fe.KeySystem[h]==d){a[d]=h.split("_").map(function(e){return e[0]+e.substr(1).toLowerCase()}).join(" ");break}}else a[d]=d}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}a.Unspecified="Unspecified";var f="Unspecified",p=new fs(e,t,function(e){"Unspecified"!=e.value?i.addDesiredTerm_(e.value,r,n):i.removeDesiredTerm_(f,r),f=e.value,i.remakeResultsDiv_(),componentHandler.upgradeDom()},a);p.extra().textContent=t,p.input().value="Unspecified"}},{key:"makeSearchDiv_",value:function(t){var n=fe.Feature,r=e.TermType.FEATURE,i=e.TermType.DRM,a=e.TermType.SOURCE,s=new _s(t,null,_s.Style.FLEX,null);this.makeSelectInput_(s,"Manifest",[n.DASH,n.HLS],r),this.makeSelectInput_(s,"Container",[n.MP4,n.MP2TS,n.WEBM],r),this.makeSelectInput_(s,"DRM",Object.values(fe.KeySystem),i),this.makeSelectInput_(s,"Source",Object.values(fe.Source).filter(function(e){return"Custom"!=e}),a);var o=_s.Style.FLEX,l=new _s(t,null,o,null);this.makeBooleanInput_(l,n.LIVE,r),this.makeBooleanInput_(l,n.HIGH_DEFINITION,r),this.makeBooleanInput_(l,n.XLINK,r),this.makeBooleanInput_(l,n.SUBTITLES,r),this.makeBooleanInput_(l,n.TRICK_MODE,r),this.makeBooleanInput_(l,n.SURROUND,r),this.makeBooleanInput_(l,n.OFFLINE,r),this.makeBooleanInput_(l,n.STORED,r)}},{key:"searchResults_",value:function(){var e=this;return fe.testAssets.filter(function(t){if(t.disabled)return!1;if(e.desiredDRM_&&!t.drm.includes(e.desiredDRM_))return!1;if(e.desiredSource_&&t.source!=e.desiredSource_)return!1;var n=!0,r=!1,i=void 0;try{for(var a,s=e.desiredFeatures_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(o==fe.Feature.STORED){if(!t.isStored())return!1}else if(!t.features.includes(o))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0})}}]),e}();function Cs(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Is(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Cs(a,r,i,s,o,"next",e)}function o(e){Cs(a,r,i,s,o,"throw",e)}s(void 0)})}}function As(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e,t,n){return t&&As(e.prototype,t),n&&As(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ks.SearchTerm={},ks.TermType={FEATURE:"Feature",DRM:"DRM",SOURCE:"Source"},document.addEventListener("shaka-main-loaded",ks.init);window.shaka;var Rs=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dialog_=document.createElement("dialog"),this.dialog_.classList.add("mdl-dialog"),t.appendChild(this.dialog_),this.dialog_.showModal||es.registerDialog(this.dialog_),this.assets_=this.loadAssetInfos_(),this.assetCards_=[],this.savedList_=document.createElement("div"),t.appendChild(this.savedList_);var r=document.createElement("div");r.classList.add("add-button-container"),t.appendChild(r);var i=this.makeButton_("add",!0,function(){n.showAssetDialog_(ce.makeBlankAsset())});r.appendChild(i),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.savedList_.childNodes.length||t.classList.contains("hidden")||n.remakeSavedList_()})}return Ls(e,null,[{key:"init",value:function(){var t=Za.addNavButton("custom");new e(t)}}]),Ls(e,[{key:"assets",value:function(){return Array.from(this.assets_)}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"showAssetDialog_",value:function(e){var t=this;Ue.removeAllChildren(this.dialog_);var n=document.createElement("div");this.dialog_.appendChild(n);var r=document.createElement("div");this.dialog_.appendChild(r);var i,a,s=[],o=function(){var t=i.value,n=a.value;if(t){e.licenseServers.clear();var r=!0,s=!1,o=void 0;try{for(var l,u=ShakaDemoMain.commonDrmSystems[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var c=l.value;e.licenseServers.set(c,t)}}catch(e){s=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(s)throw o}}n&&e.licenseServers.set(n,t)}else e.licenseServers.clear()},l=_s.Style.VERTICAL,u=new _s(n,null,l,null),c=function(e,t,n){u.addRow(null,null);var r=new ms(u,e,n);r.extra().textContent=e,t(r.input(),r.container())};c("Manifest URL",function(t,n){t.value=e.manifestUri,s.push(t);var r=document.createElement("span");r.classList.add("mdl-textfield__error"),r.textContent="Must have a manifest URL.",n.appendChild(r),t.required=!0,t.pattern="^(?!([\r\n\t\f\v ]+)$).*$"},function(t){e.manifestUri=t.value});c("Custom License Server URL",function(t,n){i=t;var r=e.licenseServers.keys().next();r&&r.value&&(t.value=e.licenseServers.get(r.value))},function(e){o()});c("Custom License Certificate URL",function(t,n){e.certificateUri&&(t.value=e.certificateUri)},function(t){e.certificateUri=t.value});c("Custom DRM System",function(t,n){a=t;var r=e.licenseServers.keys(),i=!0,s=!1,o=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if(!ShakaDemoMain.commonDrmSystems.includes(c)){t.value=c;break}}}catch(e){s=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}},function(e){o()});c("Name",function(n,r){n.value=e.name,s.push(n);var i=document.createElement("span");i.classList.add("mdl-textfield__error"),i.textContent="Must be a unique name.",r.appendChild(i),n.required=!0,n.pattern="^(?!( *";var a=!0,o=!1,l=void 0;try{for(var u,c=t.assets_[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d!=e&&(n.pattern+="|"+function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(d.name))}}catch(e){o=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw l}}n.pattern+=")$).*$"},function(t){e.name=t.value});c("Icon URL",function(t,n){if(e.iconUri){t.value=e.iconUri;var i=document.createElement("img");i.src=t.value,i.alt="",r.appendChild(i)}},function(t){if(Ue.removeAllChildren(r),e.iconUri=t.value,t.value){var n=document.createElement("img");n.src=t.value,n.alt="",r.appendChild(n)}});var d=document.createElement("tr");n.appendChild(d),d.appendChild(this.makeButton_("Save",!1,function(){for(var n=0,r=s;n<r.length;n++){if(!r[n].validity.valid)return}Za.setupOfflineSupport(e),t.assets_.add(e),t.saveAssetInfos_(t.assets_),t.remakeSavedList_(),t.dialog_.close()})),d.appendChild(this.makeButton_("Cancel",!1,function(){t.dialog_.close()})),componentHandler.upgradeDom(),this.dialog_.showModal()}},{key:"loadAssetInfos_",value:function(){var t=window.localStorage.getItem(e.saveId_);if(t){var n=JSON.parse(t);return new Set(n.map(function(e){var t=ce.fromJSON(e);return Za.setupOfflineSupport(t),t}))}return new Set}},{key:"saveAssetInfos_",value:function(t){var n=e.saveId_,r=Array.from(t);window.localStorage.setItem(n,JSON.stringify(r))}},{key:"makeButton_",value:function(e,t,n){var r=document.createElement("button");if(t){r.classList.add("mdl-button--fab"),r.classList.add("mdl-button--colored");var i=document.createElement("i");i.classList.add("material-icons"),i.textContent=e,r.appendChild(i)}else r.textContent=e,r.classList.add("mdl-button--raised");return r.addEventListener("click",n),r.classList.add("mdl-button"),r.classList.add("mdl-js-button"),r.classList.add("mdl-js-ripple-effect"),r}},{key:"createAssetCardFor_",value:function(e){var t=this,n=this.savedList_;return new AssetCard(n,e,!1,function(n){n.addButton("Play",function(){Za.loadAsset(e),t.updateSelected_()}),n.addButton("Edit",Is(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.unstoreCallback){n.next=3;break}return n.next=3,e.unstoreCallback();case 3:t.showAssetDialog_(e);case 4:case"end":return n.stop()}},n)}))),n.addButton("Delete",Is(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.assets_.delete(e),!e.unstoreCallback){n.next=4;break}return n.next=4,e.unstoreCallback();case 4:t.saveAssetInfos_(t.assets_),t.remakeSavedList_();case 6:case"end":return n.stop()}},n)}))),n.addStoreButton()})}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Za.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"remakeSavedList_",value:function(){var e=this;if(Ue.removeAllChildren(this.savedList_),0==this.assets_.size){var t=function(t,n){var r=document.createElement("h2");r.classList.add("mdl-typography--"+t),r.textContent=n,e.savedList_.appendChild(r)};t("title","Try Shaka Player with your own content!"),t("body-2","Press the button below to add a custom asset."),t("body-1","Custom assets will remain even after reloading the page.")}else this.assetCards_=Array.from(this.assets_).map(function(t){return e.createAssetCardFor_(t)}),this.updateSelected_()}}]),e}();function xs(e){return(xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ns(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ms(e,t,n){return t&&Ns(e.prototype,t),n&&Ns(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rs.saveId_="shakaPlayerDemoSavedAssets",document.addEventListener("shaka-main-loaded",Rs.init);var Ps=window.shaka,Os=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container_=t,this.sections_=[],this.latestInput_=null,this.addedFields_=new Set,this.reload_(),document.addEventListener("shaka-main-config-change",function(){n.reloadAndSaveState_()}),document.addEventListener("shaka-main-drawer-state-change",function(){n.setContentAvailability_(Za.getIsDrawerOpen())}),this.setContentAvailability_(Za.getIsDrawerOpen())}return Ms(e,null,[{key:"init",value:function(){var t=Za.getHamburgerMenu();new e(t)}}]),Ms(e,[{key:"setContentAvailability_",value:function(e){e?this.container_.classList.remove("hidden"):this.container_.classList.add("hidden")}},{key:"reload_",value:function(){Ue.removeAllChildren(this.container_),this.sections_=[],this.addMetaSection_(),this.addLanguageSection_(),this.addAbrSection_(),this.addOfflineSection_(),this.addDrmSection_(),this.addStreamingSection_(),this.addManifestSection_(),this.addRetrictionsSection_("",""),this.checkSectionCompleteness_(),this.checkSectionValidity_()}},{key:"reloadAndSaveState_",value:function(){var e=this.sections_.map(function(e){return e.getIsOpen()});this.reload_();for(var t=0;t<e.length;t++){var n=e[t],r=this.sections_[t];n&&r.open()}Ka.upgradeDom()}},{key:"addDrmSection_",value:function(){var e=this,t=this.resolveExternLink_(".DrmConfiguration");this.addSection_("DRM",t).addBoolInput_("Delay License Request Until Played","drm.delayLicenseRequestUntilPlayed");var n=Za.getConfiguration().drm.advanced||{},r=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],i=function(t,i){e.addDatalistInput_(t,r,function(e){for(var t in n)n[t][i]=e.value;Za.configure("drm.advanced",n),Za.remakeHash()});var a=Object.keys(n)[0];if(a){var s=n[a][i];e.latestInput_.input().value=s}};i("Video Robustness","videoRobustness"),i("Audio Robustness","audioRobustness"),this.addRetrySection_("drm","DRM")}},{key:"addManifestSection_",value:function(){var e=this.resolveExternLink_(".ManifestConfiguration");this.addSection_("Manifest",e).addBoolInput_("Ignore DASH DRM Info","manifest.dash.ignoreDrmInfo").addBoolInput_("Auto-Correct DASH Drift","manifest.dash.autoCorrectDrift").addBoolInput_("Xlink Should Fail Gracefully","manifest.dash.xlinkFailGracefully").addNumberInput_("Availability Window Override","manifest.availabilityWindowOverride",!0,!1,!0).addTextInput_("Clock Sync URI","manifest.dash.clockSyncUri").addBoolInput_("Ignore DRM Info","manifest.dash.ignoreDrmInfo").addNumberInput_("Default Presentation Delay","manifest.dash.defaultPresentationDelay").addBoolInput_("Ignore Min Buffer Time","manifest.dash.ignoreMinBufferTime"),this.addRetrySection_("manifest","Manifest")}},{key:"addAbrSection_",value:function(){var e=this.resolveExternLink_(".AbrConfiguration");this.addSection_("Adaptation",e).addBoolInput_("Enabled","abr.enabled").addNumberInput_("Default Bandwidth Estimate","abr.defaultBandwidthEstimate").addNumberInput_("Bandwidth Downgrade Target","abr.bandwidthDowngradeTarget",!0).addNumberInput_("Bandwidth Upgrade Target","abr.bandwidthUpgradeTarget",!0).addNumberInput_("Switch Interval","abr.switchInterval",!0),this.addRetrictionsSection_("abr","Adaptation")}},{key:"addRetrictionsSection_",value:function(e,t){var n=(e?e+".":"")+"restrictions.",r=(t?t+" ":"")+"Restrictions",i=this.resolveExternLink_(".Restrictions");this.addSection_(r,i).addNumberInput_("Min Width",n+"minWidth").addNumberInput_("Max Width",n+"maxWidth").addNumberInput_("Min Height",n+"minHeight").addNumberInput_("Max Height",n+"maxHeight").addNumberInput_("Min Pixels",n+"minPixels").addNumberInput_("Max Pixels",n+"maxPixels").addNumberInput_("Min Bandwidth",n+"minBandwidth").addNumberInput_("Max Bandwidth",n+"maxBandwidth")}},{key:"addRetrySection_",value:function(e,t){var n=e+".retryParameters.",r=this.resolveExternLink_(".RetryParameters");this.addSection_(t+" Retry Parameters",r).addNumberInput_("Max Attempts",n+"maxAttempts").addNumberInput_("Base Delay",n+"baseDelay",!0).addNumberInput_("Backoff Factor",n+"backoffFactor",!0).addNumberInput_("Fuzz Factor",n+"fuzzFactor",!0).addNumberInput_("Timeout",n+"timeout",!0)}},{key:"addOfflineSection_",value:function(){var e=this.resolveExternLink_(".OfflineConfiguration");this.addSection_("Offline",e).addBoolInput_("Use Persistent Licenses","offline.usePersistentLicense")}},{key:"addStreamingSection_",value:function(){var e=this.resolveExternLink_(".StreamingConfiguration");if(this.addSection_("Streaming",e).addNumberInput_("Maximum Small Gap Size","streaming.smallGapLimit",!0).addNumberInput_("Buffering Goal","streaming.bufferingGoal",!0).addNumberInput_("Duration Backoff","streaming.durationBackoff",!0).addNumberInput_("Rebuffering Goal","streaming.rebufferingGoal",!0).addNumberInput_("Buffer Behind","streaming.bufferBehind",!0).addNumberInput_("Safe Seek Offset","streaming.safeSeekOffset",!0).addNumberInput_("Stall Threshold","streaming.stallThreshold",!0).addNumberInput_("Safe Skip Distance","streaming.stallSkip",!0),Za.getNativeControlsEnabled()){this.addCustomBoolInput_("Always Stream Text",function(e){},"Text must always be streamed while native controls are enabled, for captions to work."),this.latestInput_.input().disabled=!0,this.latestInput_.input().checked=!0}else this.addBoolInput_("Always Stream Text","streaming.alwaysStreamText");this.addBoolInput_("Jump Large Gaps","streaming.jumpLargeGaps").addBoolInput_("Force Transmux TS","streaming.forceTransmuxTS").addBoolInput_("Start At Segment Boundary","streaming.startAtSegmentBoundary").addBoolInput_("Ignore Text Stream Failures","streaming.ignoreTextStreamFailures").addBoolInput_("Stall Detector Enabled","streaming.stallEnabled"),this.addRetrySection_("streaming","Streaming")}},{key:"addLanguageSection_",value:function(){var e=this.resolveExternLink_(".PlayerConfiguration");this.addSection_("Language",e).addTextInput_("Preferred Audio Language","preferredAudioLanguage").addTextInput_("Preferred Text Language","preferredTextLanguage");this.addCustomTextInput_("Preferred UI Locale",function(e){Za.setUILocale(e.value)}),this.latestInput_.input().value=Za.getUILocale(),this.addNumberInput_("Preferred Audio Channel Count","preferredAudioChannelCount")}},{key:"addMetaSection_",value:function(){var e=this;if(this.addSection_("",null),this.addCustomBoolInput_("Shaka Controls",function(t){Za.setNativeControlsEnabled(!t.checked),t.checked&&(Za.configure("streaming.alwaysStreamText",!0),Za.remakeHash()),e.reloadAndSaveState_()}),Za.getNativeControlsEnabled()||(this.latestInput_.input().checked=!0),Ps.log){var t=Ps.log.Level,n=Ps.log.setLevel;this.addSelectInput_("Log Level",{info:"Info",debug:"Debug",v:"Verbose",vv:"Very Verbose"},function(e){switch(e.value){case"info":n(t.INFO);break;case"debug":n(t.DEBUG);break;case"vv":n(t.V2);break;case"v":n(t.V1)}Za.remakeHash()});var r=this.latestInput_.input();switch(Ps.log.currentLevel){case t.DEBUG:r.value="debug";break;case t.V2:r.value="vv";break;case t.V1:r.value="v";break;default:r.value="info"}}}},{key:"resolveExternLink_",value:function(e){return"../docs/api/shaka.extern.html#"+e}},{key:"addSection_",value:function(e,t){var n=e?_s.Style.ACCORDION:_s.Style.VERTICAL;return this.sections_.push(new _s(this.container_,e,n,t)),this}},{key:"addBoolInput_",value:function(e,t,n){return this.addCustomBoolInput_(e,function(e){Za.configure(t,e.checked),Za.remakeHash()},n),Za.getCurrentConfigValue(t)&&(this.latestInput_.input().checked=!0),this.addedFields_.add(t),this}},{key:"addCustomBoolInput_",value:function(e,t,n){return this.createRow_(e,n),this.latestInput_=new ps(this.getLatestSection_(),e,t),this}},{key:"addTextInput_",value:function(e,t,n){return this.addCustomTextInput_(e,function(e){Za.configure(t,e.value),Za.remakeHash()},n),this.latestInput_.input().value=Za.getCurrentConfigValue(t),this.addedFields_.add(t),this}},{key:"addCustomTextInput_",value:function(e,t,n){return this.createRow_(e,n),this.latestInput_=new ms(this.getLatestSection_(),e,t),this}},{key:"addNumberInput_",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;return this.createRow_(e,a),this.latestInput_=new gs(this.getLatestSection_(),e,function(e){if(Za.resetConfiguration(t),Za.remakeHash(),"Infinity"==e.value)return Za.configure(t,1/0),void Za.remakeHash();if(""!=e.value||!i){var a=Number(e.value);if((0!=a||r)&&!isNaN(a)){if(Math.floor(a)!=a&&!n)return;Za.configure(t,a),Za.remakeHash()}}},n,r,i),this.latestInput_.input().value=Za.getCurrentConfigValue(t),isNaN(Number(this.latestInput_.input().value))&&i&&(this.latestInput_.input().value=""),this.addedFields_.add(t),this}},{key:"addDatalistInput_",value:function(e,t,n,r){return this.createRow_(e,r),this.latestInput_=new vs(this.getLatestSection_(),e,n,t),this}},{key:"addSelectInput_",value:function(e,t,n,r){return this.createRow_(e,r),this.latestInput_=new fs(this.getLatestSection_(),e,n,t),this}},{key:"createRow_",value:function(e,t){this.getLatestSection_().addRow(e,t||null)}},{key:"checkSectionCompleteness_",value:function(){var e=this,t=new Set(["number","string","boolean"]);!function n(r,i){for(var a in r){var s=i?i+"."+a:a,o=r[a];t.has(xs(o))?e.addedFields_.has(s)||console.warn("WARNING: Does not have config field for "+s):n(o,s)}}(Za.getConfiguration(),"")}},{key:"checkSectionValidity_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.addedFields_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;null==Za.getCurrentConfigValue(a)&&console.warn("WARNING: Invalid config field "+a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"getLatestSection_",value:function(){return window.asserts.assert(this.sections_.length>0,"Must have at least one section."),this.sections_[this.sections_.length-1]}}]),e}();function Ds(e){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Us(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Fs(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Us(a,r,i,s,o,"next",e)}function o(e){Us(a,r,i,s,o,"throw",e)}s(void 0)})}}function Bs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vs(e,t){return!t||"object"!==Ds(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hs(e){return(Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gs(e,t){return(Gs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */document.addEventListener("shaka-main-loaded",Os.init);var js=window.shaka,Ks=function(e){function t(e,n,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Vs(this,Hs(t).call(this))).video_=e,a.player_=n,a.eventManager_=new EventManager,a.targets_={video:e,player:n},a.appDataCallback_=r||function(){},a.contentIdCallback_=i||function(e){return e},a.isConnected_=!1,a.isIdle_=!0,a.updateNumber_=0,a.startUpdatingUpdateNumber_=!1,a.initialStatusUpdatePending_=!0,a.shakaBus_=null,a.genericBus_=null,a.pollTimer_=new Timer(function(){a.pollAttributes_()}),a.init_(),a}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gs(e,t)}(t,C),n=t,(r=[{key:"isConnected",value:function(){return this.isConnected_}},{key:"isIdle",value:function(){return this.isIdle_}},{key:"destroy",value:function(){var e=Fs(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),t=[],this.player_&&(t.push(this.player_.destroy()),this.player_=null),this.pollTimer_&&(this.pollTimer_.stop(),this.pollTimer_=null),this.video_=null,this.targets_=null,this.appDataCallback_=null,this.isConnected_=!1,this.isIdle_=!0,this.shakaBus_=null,this.genericBus_=null,e.next=13,Promise.all(t);case 13:cast.receiver.CastReceiverManager.getInstance().stop();case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"init_",value:function(){var e=this,t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return e.onSendersChanged_()},t.onSenderDisconnected=function(){return e.onSendersChanged_()},t.onSystemVolumeChanged=function(){return e.fakeVolumeChangeEvent_()},this.genericBus_=t.getCastMessageBus(CastUtils.GENERIC_MESSAGE_NAMESPACE),this.genericBus_.onMessage=function(t){return e.onGenericMessage_(t)},this.shakaBus_=t.getCastMessageBus(CastUtils.SHAKA_MESSAGE_NAMESPACE),this.shakaBus_.onMessage=function(t){return e.onShakaMessage_(t)},goog.DEBUG?Platform.isChromecast()&&t.start():t.start();var n=!0,r=!1,i=void 0;try{for(var a,s=CastUtils.VideoEvents[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;this.eventManager_.listen(this.video_,o,function(t){return e.proxyEvent_("video",t)})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var l=!0,u=!1,c=void 0;try{for(var d,h=CastUtils.PlayerEvents[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;this.eventManager_.listen(this.player_,f,function(t){return e.proxyEvent_("player",t)})}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?this.player_.setMaxHardwareResolution(3840,2160):this.player_.setMaxHardwareResolution(1920,1080),this.eventManager_.listen(this.video_,"loadeddata",function(){e.startUpdatingUpdateNumber_=!0}),this.eventManager_.listen(this.player_,"loading",function(){e.isIdle_=!1,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"playing",function(){e.isIdle_=!1,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"pause",function(){e.onCastStatusChanged_()}),this.eventManager_.listen(this.player_,"unloading",function(){e.isIdle_=!0,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"ended",function(){new js.util.Timer(function(){e.video_&&e.video_.ended&&(e.isIdle_=!0,e.onCastStatusChanged_())}).tickAfter(js.cast.CastReceiver.IDLE_INTERVAL)})}},{key:"onSendersChanged_",value:function(){this.updateNumber_=0,this.initialStatusUpdatePending_=!0;var e=cast.receiver.CastReceiverManager.getInstance();this.isConnected_=0!=e.getSenders().length,this.onCastStatusChanged_()}},{key:"onCastStatusChanged_",value:function(){var e=Fs(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(this.player_){e.next=4;break}return e.abrupt("return");case 4:t=new js.util.FakeEvent("caststatuschanged"),this.dispatchEvent(t),this.maybeSendMediaInfoMessage_()||this.sendMediaStatus_(0);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initState_",value:function(){var e=Fs(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t.player)i=t.player[r],this.player_[r](i);if(this.appDataCallback_(n),a=this.video_.autoplay,!t.manifest){e.next=18;break}return this.video_.autoplay=!1,e.prev=5,e.next=8,this.player_.load(t.manifest,t.startTime);case 8:e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(5),window.asserts.assert(e.t0 instanceof js.util.Error,"Wrong error type!"),s=new js.util.FakeEvent("error",{detail:e.t0}),this.player_.dispatchEvent(s),e.abrupt("return");case 16:e.next=20;break;case 18:return e.next=20,Promise.resolve();case 20:if(this.player_){e.next=22;break}return e.abrupt("return");case 22:for(o in t.video)l=t.video[o],this.video_[o]=l;for(u in t.playerAfterLoad)c=t.playerAfterLoad[u],this.player_[u](c);this.video_.autoplay=a,t.manifest&&(this.video_.play(),this.sendMediaStatus_(0));case 26:case"end":return e.stop()}},e,this,[[5,10]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"proxyEvent_",value:function(e,t){this.player_&&(this.pollAttributes_(),this.sendMessage_({type:"event",targetName:e,event:t},this.shakaBus_))}},{key:"pollAttributes_",value:function(){this.pollTimer_.tickAfter(t.POLL_INTERVAL);var e={video:{},player:{}},n=!0,r=!1,i=void 0;try{for(var a,s=CastUtils.VideoAttributes[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.video[o]=this.video_[o]}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(this.player_.isLive()){var l=CastUtils.PlayerGetterMethodsThatRequireLive;for(var u in l){var c=l[u];this.updateNumber_%c==0&&(e.player[u]=this.player_[u]())}}for(var d in CastUtils.PlayerGetterMethods){var h=CastUtils.PlayerGetterMethods[d];this.updateNumber_%h==0&&(e.player[d]=this.player_[d]())}var f=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();f&&(e.video.volume=f.level,e.video.muted=f.muted),this.startUpdatingUpdateNumber_&&(this.updateNumber_+=1),this.sendMessage_({type:"update",update:e},this.shakaBus_),this.maybeSendMediaInfoMessage_()}},{key:"maybeSendMediaInfoMessage_",value:function(){return!(!this.initialStatusUpdatePending_||!this.video_.duration&&!this.player_.isLive())&&(this.sendMediaInfoMessage_(),this.initialStatusUpdatePending_=!1,!0)}},{key:"sendMediaInfoMessage_",value:function(){var e={contentId:this.player_.getAssetUri(),streamType:this.player_.isLive()?"LIVE":"BUFFERED",duration:this.video_.duration,contentType:""};this.sendMediaStatus_(0,e)}},{key:"fakeVolumeChangeEvent_",value:function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();window.asserts.assert(e,"System volume should not be null!"),e&&this.sendMessage_({type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.shakaBus_),this.sendMessage_({type:"event",targetName:"video",event:{type:"volumechange"}},this.shakaBus_)}},{key:"onShakaMessage_",value:function(e){var t=this,n=CastUtils.deserialize(e.data);switch(js.log.debug("CastReceiver: message",n),n.type){case"init":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.initState_(n.initState,n.appData),this.pollAttributes_();break;case"appData":this.appDataCallback_(n.appData);break;case"set":var r=n.targetName,i=n.property,a=n.value;if("video"==r){var s=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){s.setSystemVolumeLevel(a);break}if("muted"==i){s.setSystemVolumeMuted(a);break}}this.targets_[r][i]=a;break;case"call":var o=n.targetName,l=n.methodName,u=n.args,c=this.targets_[o];c[l].apply(c,u);break;case"asyncCall":var d=n.targetName,h=n.methodName;"player"==d&&"load"==h&&(this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1);var f=n.args,p=n.id,m=e.senderId,v=this.targets_[d],g=v[h].apply(v,f);"player"==d&&"load"==h&&(g=g.then(function(){t.initialStatusUpdatePending_=!0})),g.then(function(){return t.sendAsyncComplete_(m,p,null)},function(e){return t.sendAsyncComplete_(m,p,e)})}}},{key:"onGenericMessage_",value:function(e){var t=this,n=CastUtils.deserialize(e.data);switch(js.log.debug("CastReceiver: message",n),n.type){case"PLAY":this.video_.play(),this.sendMediaStatus_(0);break;case"PAUSE":this.video_.pause(),this.sendMediaStatus_(0);break;case"SEEK":var r=n.currentTime,i=n.resumeState;null!=r&&(this.video_.currentTime=Number(r)),i&&"PLAYBACK_START"==i?(this.video_.play(),this.sendMediaStatus_(0)):i&&"PLAYBACK_PAUSE"==i&&(this.video_.pause(),this.sendMediaStatus_(0));break;case"STOP":this.player_.unload().then(function(){t.player_&&t.sendMediaStatus_(0)});break;case"GET_STATUS":this.sendMediaStatus_(Number(n.requestId));break;case"VOLUME":var a=n.volume,s=a.level,o=a.muted,l=this.video_.volume,u=this.video_.muted;null!=s&&(this.video_.volume=Number(s)),null!=o&&(this.video_.muted=o),l==this.video_.volume&&u==this.video_.muted||this.sendMediaStatus_(0);break;case"LOAD":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!1;var c=n.media,d=c.contentId,h=n.currentTime,f=this.contentIdCallback_(d),p=n.autoplay||!0,m=c.customData;this.appDataCallback_(m),p&&(this.video_.autoplay=!0),this.player_.load(f,h).then(function(){t.player_&&t.sendMediaInfoMessage_()}).catch(function(e){var r="LOAD_FAILED";e.category==js.util.Error.Category.PLAYER&&e.code==js.util.Error.Code.LOAD_INTERRUPTED&&(r="LOAD_CANCELLED"),t.sendMessage_({requestId:Number(n.requestId),type:r},t.genericBus_)});break;default:js.log.warning("Unrecognized message type from the generic Chromecast controller!",n.type),this.sendMessage_({requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.genericBus_)}}},{key:"sendAsyncComplete_",value:function(e,t,n){this.player_&&this.sendMessage_({type:"asyncComplete",id:t,error:n},this.shakaBus_,e)}},{key:"sendMessage_",value:function(e,t,n){if(this.isConnected_){var r=CastUtils.serialize(e);n?t.getCastChannel(n).send(r):t.broadcast(r)}}},{key:"getPlayState_",value:function(){var e=t.PLAY_STATE;return this.isIdle_?e.IDLE:this.player_.isBuffering()?e.BUFFERING:this.video_.paused?e.PAUSED:e.PLAYING}},{key:"sendMediaStatus_",value:function(e,t){var n={mediaSessionId:0,playbackRate:this.video_.playbackRate,playerState:this.getPlayState_(),currentTime:this.video_.currentTime,supportedMediaCommands:15,volume:{level:this.video_.volume,muted:this.video_.muted}};t&&(n.media=t);var r={requestId:e,type:"MEDIA_STATUS",status:[n]};this.sendMessage_(r,this.genericBus_)}}])&&Bs(n.prototype,r),i&&Bs(n,i),t}();Ks.POLL_INTERVAL=.5,Ks.IDLE_INTERVAL=5,Ks.PLAY_STATE={IDLE:"IDLE",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED"};function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qs=window.shaka,zs=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"findChild",value:function(t,n){var r=e.findChildren(t,n);return 1!=r.length?null:r[0]}},{key:"findChildNS",value:function(t,n,r){var i=e.findChildrenNS(t,n,r);return 1!=i.length?null:i[0]}},{key:"findChildren",value:function(e,t){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.tagName==t})}},{key:"findChildrenNS",value:function(e,t,n){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t})}},{key:"getAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}},{key:"getContents",value:function(e){return Array.from(e.childNodes).every(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null}},{key:"parseAttr",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null,a=e.getAttribute(t);return null!=a&&(i=n(a)),null==i?r:i}},{key:"parseDate",value:function(e){if(!e)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");var t=Date.parse(e);return isNaN(t)?null:Math.floor(t/1e3)}},{key:"parseDuration",value:function(e){if(!e)return null;var t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return qs.log.warning("Invalid duration string:",e),null;var n=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(n)?n:null}},{key:"parseRange",value:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var n=Number(t[1]);if(!isFinite(n))return null;var r=Number(t[2]);return isFinite(r)?{start:n,end:r}:null}},{key:"parseInt",value:function(e){var t=Number(e);return t%1==0?t:null}},{key:"parsePositiveInt",value:function(e){var t=Number(e);return t%1==0&&t>0?t:null}},{key:"parseNonNegativeInt",value:function(e){var t=Number(e);return t%1==0&&t>=0?t:null}},{key:"parseFloat",value:function(e){var t=Number(e);return isNaN(t)?null:t}},{key:"evalDivision",value:function(e){var t,n;return n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(n)?null:n}},{key:"parseXmlString",value:function(e,t){var n=new DOMParser,r=null,i=null;try{i=n.parseFromString(e,"text/xml")}catch(e){}return i&&i.documentElement.tagName==t&&(r=i.documentElement),r&&r.getElementsByTagName("parsererror").length>0?null:r}},{key:"parseXml",value:function(t,n){try{var r=Gt.fromUTF8(t);return e.parseXmlString(r,n)}catch(e){return null}}}],(n=null)&&Ws(t.prototype,n),r&&Ws(t,r),e}());function Ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xs=new M,$s=window.shaka,Qs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parseFromAdaptationSet",value:function(t,n,r){var i=e.parseElements_(t),a=null,s=[],o=[],l=new Set(i.map(function(e){return e.keyId}));if(l.delete(null),l.size>1)throw new M(Xs.severity.CRITICAL,Xs.category.MANIFEST,Xs.code.DASH_CONFLICTING_KEY_IDS);if(r||(o=i.filter(function(t){return t.schemeUri!=e.MP4Protection_||(window.asserts.assert(!t.init||t.init.length,"Init data must be null or non-empty."),a=t.init||a,!1)})).length&&0==(s=e.convertElements_(a,n,o)).length&&(s=[Re.createDrmInfo("",a)]),i.length&&(r||!o.length)){s=[];var u=e.defaultKeySystems_,c=!0,d=!1,h=void 0;try{for(var f,p=u.values()[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;if("org.w3.clearkey"!=m){var v=Re.createDrmInfo(m,a);s.push(v)}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}var g=Array.from(l)[0]||null;if(g){var y=!0,_=!1,w=void 0;try{for(var E,b=s[Symbol.iterator]();!(y=(E=b.next()).done);y=!0){var S=E.value,T=!0,k=!1,C=void 0;try{for(var I,A=S.initData[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){I.value.keyId=g}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}}}catch(e){_=!0,w=e}finally{try{y||null==b.return||b.return()}finally{if(_)throw w}}}return{defaultKeyId:g,defaultInit:a,drmInfos:s,firstRepresentation:!0}}},{key:"parseFromRepresentation",value:function(t,n,r,i){var a=e.parseFromAdaptationSet(t,n,i);if(r.firstRepresentation){var s=1==r.drmInfos.length&&!r.drmInfos[0].keySystem,o=0==r.drmInfos.length,l=0==a.drmInfos.length;(o||s&&!l)&&(r.drmInfos=a.drmInfos),r.firstRepresentation=!1}else if(a.drmInfos.length>0&&(r.drmInfos=r.drmInfos.filter(function(e){return a.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==r.drmInfos.length))throw new M(Xs.severity.CRITICAL,Xs.category.MANIFEST,Xs.code.DASH_NO_COMMON_KEY_SYSTEM);return a.defaultKeyId||r.defaultKeyId}},{key:"getWidevineLicenseUrl",value:function(e){var t=zs.findChildNS(e.node,"urn:microsoft","laurl");return t&&t.getAttribute("licenseUrl")||""}},{key:"parseMsProRecords_",value:function(e,t){for(var n=[],r=new DataView(e);t<e.byteLength-1;){var i=r.getUint16(t,!0);t+=2;var a=r.getUint16(t,!0);t+=2,window.asserts.assert(0==(1&a),"expected byteLength to be an even number");var s=new Uint8Array(e,t,a);n.push({type:i,value:s}),t+=a}return n}},{key:"parseMsPro_",value:function(t){var n=0,r=new DataView(t).getUint32(n,!0);return n+=4,r!==t.byteLength?($s.log.warning("PlayReady Object with invalid length encountered."),[]):(n+=2,e.parseMsProRecords_(t,n))}},{key:"getLaurl_",value:function(e){var t=e.querySelector("DATA > LA_URL");return t?t.textContent:""}},{key:"getPlayReadyLicenseUrl",value:function(t){var n=zs.findChildNS(t.node,"urn:microsoft:playready","pro");if(!n)return"";var r=e.PLAYREADY_RECORD_TYPES,i=Kt.fromBase64(n.textContent),a=e.parseMsPro_(i.buffer).filter(function(e){return e.type===r.RIGHTS_MANAGEMENT})[0];if(!a)return"";var s=StringUtils.fromUTF16(a.value,!0),o=zs.parseXmlString(s,"WRMHEADER");return o?e.getLaurl_(o):""}},{key:"convertElements_",value:function(t,n,r){var i=e.defaultKeySystems_,a=e.licenseUrlParsers_,s=[],o=!0,l=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=i.get(h.schemeUri);if(f){window.asserts.assert(!h.init||h.init.length,"Init data must be null or non-empty.");var p=h.init||t,m=Re.createDrmInfo(f,p),v=a.get(f);v&&(m.licenseServerUri=v(h)),s.push(m)}else{window.asserts.assert(n,"ContentProtection callback is required");var g=n(h.node)||[],y=!0,_=!1,w=void 0;try{for(var E,b=g[Symbol.iterator]();!(y=(E=b.next()).done);y=!0){var S=E.value;s.push(S)}}catch(e){_=!0,w=e}finally{try{y||null==b.return||b.return()}finally{if(_)throw w}}}}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}return s}},{key:"parseElements_",value:function(t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=e.parseElement_(l);u&&n.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"parseElement_",value:function(t){var n=e.CencNamespaceUri_,r=t.getAttribute("schemeIdUri"),i=zs.getAttributeNS(t,n,"default_KID"),a=zs.findChildrenNS(t,n,"pssh").map(zs.getContents);if(!r)return $s.log.error("Missing required schemeIdUri attribute on","ContentProtection element",t),null;if(r=r.toLowerCase(),i&&(i=i.replace(/-/g,"").toLowerCase()).includes(" "))throw new M(Xs.severity.CRITICAL,Xs.category.MANIFEST,Xs.code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);var s=[];try{s=a.map(function(e){return{initDataType:"cenc",initData:Kt.fromBase64(e),keyId:null}})}catch(e){throw new M(Xs.severity.CRITICAL,Xs.category.MANIFEST,Xs.code.DASH_PSSH_BAD_ENCODING)}return{node:t,schemeUri:r,keyId:i,init:s.length>0?s:null}}}],(n=null)&&Ys(t.prototype,n),r&&Ys(t,r),e}();function Zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Qs.PlayReadyRecord,Qs.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},Qs.Context,Qs.Element,Qs.defaultKeySystems_=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime"),Qs.licenseUrlParsers_=(new Map).set("com.widevine.alpha",Qs.getWidevineLicenseUrl).set("com.microsoft.playready",Qs.getPlayReadyLicenseUrl),Qs.MP4Protection_="urn:mpeg:dash:mp4protection:2011",Qs.CencNamespaceUri_="urn:mpeg:cenc:2013";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Js=window.shaka,eo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fillUriTemplate",value:function(e,t,n,r,i){var a={RepresentationID:t,Number:n,Bandwidth:r,Time:i};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,r,i){if("$$"==t)return"$";var s,o=a[n];if(window.asserts.assert(void 0!==o,"Unrecognized identifier"),null==o)return Js.log.warning("URL template does not have an available substitution for ",'identifier "'+n+'":',e),t;switch("RepresentationID"==n&&r&&(Js.log.warning("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),r=void 0),"Time"==n&&(window.asserts.assert(Math.abs(o-Math.round(o))<.2,"Calculated $Time$ values must be close to integers"),o=Math.round(o)),i){case void 0:case"d":case"i":case"u":s=o.toString();break;case"o":s=o.toString(8);break;case"x":s=o.toString(16);break;case"X":s=o.toString(16).toUpperCase();break;default:window.asserts.assert(!1,"Unhandled format specifier"),s=o.toString()}var l=window.parseInt(r,10)||1,u=Math.max(0,l-s.length);return new Array(u+1).join("0")+s})}},{key:"createTimeline",value:function(e,t,n,r){window.asserts.assert(t>0&&t<1/0,"timescale must be a positive, finite integer"),window.asserts.assert(r>0,"period duration must be a positive integer");for(var i=zs.findChildren(e,"S"),a=[],s=0,o=0;o<i.length;++o){var l=i[o],u=zs.parseAttr(l,"t",zs.parseNonNegativeInt),c=zs.parseAttr(l,"d",zs.parseNonNegativeInt),d=zs.parseAttr(l,"r",zs.parseInt);if(null!=u&&(u-=n),!c)return Js.log.warning('"S" element must have a duration:','ignoring the remaining "S" elements.',l),a;var h=null!=u?u:s,f=d||0;if(f<0)if(o+1<i.length){var p=i[o+1],m=zs.parseAttr(p,"t",zs.parseNonNegativeInt);if(null==m)return Js.log.warning('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',l),a;if(h>=m)return Js.log.warning('An "S" element cannot have a negative repeatif its start ','time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',l),a;f=Math.ceil((m-h)/c)-1}else{if(r==1/0)return Js.log.warning('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',l),a;if(h/t>=r)return Js.log.warning('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',l),a;f=Math.ceil((r*t-h)/c)-1}if(a.length>0&&h!=s){var v=h-s;Math.abs(v/t)>=Re.GAP_OVERLAP_TOLERANCE_SECONDS&&Js.log.warning("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",l),a[a.length-1].end=h/t}for(var g=0;g<=f;++g){var y=h+c,_={start:h/t,end:y/t,unscaledStart:h};a.push(_),h=y,s=y}}return a}},{key:"parseSegmentInfo",value:function(t,n){window.asserts.assert(n(t.representation),"There must be at least one element of the given type.");var r=e.inheritAttribute(t,n,"timescale"),i=1;r&&(i=zs.parsePositiveInt(r)||1);var a=e.inheritAttribute(t,n,"duration"),s=zs.parsePositiveInt(a||"");s&&(s/=i);var o=e.inheritAttribute(t,n,"startNumber"),l=Number(e.inheritAttribute(t,n,"presentationTimeOffset"))||0,u=zs.parseNonNegativeInt(o||"");null!=o&&null!=u||(u=1);var c=e.inheritChild(t,n,"SegmentTimeline"),d=null;return c&&(d=e.createTimeline(c,i,l,t.periodInfo.duration||1/0)),{timescale:i,segmentDuration:s,startNumber:u,scaledPresentationTimeOffset:l/i||0,unscaledPresentationTimeOffset:l,timeline:d}}},{key:"inheritAttribute",value:function(e,t,n){return window.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(Ae.isNotNull).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}},{key:"inheritChild",value:function(e,t,n){return window.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(Ae.isNotNull).map(function(e){return zs.findChild(e,n)}).reduce(function(e,t){return e||t})}},{key:"handleXlinkInElement_",value:function(t,n,r,i,a,s){for(var o=e.XlinkNamespaceUri_,l=zs.getAttributeNS(t,o,"href"),u=zs.getAttributeNS(t,o,"actuate")||"onRequest",c=0;c<t.attributes.length;c++){var d=t.attributes[c];d.namespaceURI==o&&(t.removeAttributeNS(d.namespaceURI,d.localName),c-=1)}if(s>=5)return U.failed(new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_XLINK_DEPTH_LIMIT));if("onLoad"!=u)return U.failed(new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_UNSUPPORTED_XLINK_ACTUATE));var h=Re.resolveUris([i],[l]),f=Js.net.NetworkingEngine.RequestType.MANIFEST,p=Js.net.NetworkingEngine.makeRequest(h,n),m=a.request(f,p);return window.asserts.assert(m instanceof U,"Unexpected implementation of IAbortableOperation!"),m.chain(function(i){var o=zs.parseXml(i.data,t.tagName);if(!o)return U.failed(new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_INVALID_XML,l));for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);for(;o.childNodes.length;){var u=o.childNodes[0];o.removeChild(u),t.appendChild(u)}for(var c=0;c<o.attributes.length;c++){var d=o.attributes[c].nodeName,f=o.getAttribute(d);t.setAttribute(d,f)}return e.processXlinks(t,n,r,h[0],a,s+1)})}},{key:"processXlinks",value:function(t,n,r,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=e.XlinkNamespaceUri_;if(zs.getAttributeNS(t,o,"href")){var l=e.handleXlinkInElement_(t,n,r,i,a,s);return r&&(l=l.chain(void 0,function(o){return e.processXlinks(t,n,r,i,a,s)})),l}for(var u=[],c=0;c<t.childNodes.length;c++){var d=t.childNodes[c];if(d instanceof Element){"urn:mpeg:dash:resolve-to-zero:2013"==zs.getAttributeNS(d,o,"href")?(t.removeChild(d),c-=1):"SegmentTimeline"!=d.tagName&&u.push(e.processXlinks(d,n,r,i,a,s))}}return U.all(u).chain(function(){return t})}}],(n=null)&&Zs(t.prototype,n),r&&Zs(t,r),e}();function to(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}eo.TimeRange,eo.SegmentInfo,eo.XlinkNamespaceUri_="http://www.w3.org/1999/xlink";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var no=window.shaka,ro=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){var a,s=(new Ki).fullBox("sidx",function(t){a=e.parseSIDX_(n,i,r,t)});if(t&&s.parse(t),a)return a;throw no.log.error('Invalid box type, expected "sidx".'),new M(M.severity.CRITICAL,M.category.MEDIA,M.code.MP4_SIDX_WRONG_BOX_TYPE)}},{key:"parseSIDX_",value:function(e,t,n,r){window.asserts.assert(null!=r.version,"SIDX is a full box and should have a valid version.");var i=[];r.reader.skip(4);var a,s,o=r.reader.readUint32();if(0==o)throw no.log.error("Invalid timescale."),new M(M.severity.CRITICAL,M.category.MEDIA,M.code.MP4_SIDX_INVALID_TIMESCALE);0==r.version?(a=r.reader.readUint32(),s=r.reader.readUint32()):(a=r.reader.readUint64(),s=r.reader.readUint64()),r.reader.skip(2);for(var l=r.reader.readUint16(),u=a,c=e+r.size+s,d=0;d<l;d++){var h=r.reader.readUint32(),f=(2147483648&h)>>>31,p=2147483647&h,m=r.reader.readUint32();if(r.reader.skip(4),1==f)throw no.log.error("Heirarchical SIDXs are not supported."),new M(M.severity.CRITICAL,M.category.MEDIA,M.code.MP4_SIDX_TYPE_NOT_SUPPORTED);i.push(new wr(i.length,u/o-t,(u+m)/o-t,function(){return n},c,c+p-1)),u+=m,c+=p}return r.parser.stop(),i}}],(n=null)&&to(t.prototype,n),r&&to(t,r),e}());function io(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function so(e,t,n){return t&&ao(e.prototype,t),n&&ao(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oo=new M,lo=(window.shaka,window.goog,function(){function e(t){io(this,e),this.dataView_=t,this.reader_=new Vi(t,Vi.Endianness.BIG_ENDIAN)}return so(e,[{key:"hasMoreData",value:function(){return this.reader_.hasMoreData()}},{key:"parseElement",value:function(){var t,n=this.parseId_(),r=this.parseVint_();t=e.isDynamicSizeValue_(r)?this.dataView_.byteLength-this.reader_.getPosition():e.getVintValue_(r);var i=this.reader_.getPosition()+t<=this.dataView_.byteLength?t:this.dataView_.byteLength-this.reader_.getPosition(),a=new DataView(this.dataView_.buffer,this.dataView_.byteOffset+this.reader_.getPosition(),i);return this.reader_.skip(i),new uo(n,a)}},{key:"parseId_",value:function(){var e=this.parseVint_();if(e.length>7)throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.EBML_OVERFLOW);var t=0,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){t=256*t+a.value}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"parseVint_",value:function(){var e=this.reader_.readUint8();if(0==e)throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.EBML_OVERFLOW);var t=8-Math.floor(Math.log2(e));window.asserts.assert(t<=8&&t>=1,"Incorrect log2 value");var n=new Uint8Array(t);n[0]=e;for(var r=1;r<t;r++)n[r]=this.reader_.readUint8();return n}}],[{key:"getVintValue_",value:function(e){if(8==e.length&&224&e[1])throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.JS_INTEGER_OVERFLOW);for(var t=1<<8-e.length,n=e[0]&t-1,r=1;r<e.length;r++)n=256*n+e[r];return n}},{key:"isDynamicSizeValue_",value:function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.DYNAMIC_SIZES[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(Kt.equal(t,o))return!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}}]),e}());lo.DYNAMIC_SIZES=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];var uo=function(){function e(t,n){io(this,e),this.id=t,this.dataView_=n}return so(e,[{key:"getOffset",value:function(){return this.dataView_.byteOffset}},{key:"createParser",value:function(){return new lo(this.dataView_)}},{key:"getUint",value:function(){if(this.dataView_.byteLength>8)throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.EBML_OVERFLOW);if(8==this.dataView_.byteLength&&224&this.dataView_.getUint8(0))throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.JS_INTEGER_OVERFLOW);for(var e=0,t=0;t<this.dataView_.byteLength;t++){e=256*e+this.dataView_.getUint8(t)}return e}},{key:"getFloat",value:function(){if(4==this.dataView_.byteLength)return this.dataView_.getFloat32(0);if(8==this.dataView_.byteLength)return this.dataView_.getFloat64(0);throw new M(oo.severity.CRITICAL,oo.category.MEDIA,oo.code.EBML_BAD_FLOATING_POINT_SIZE)}}]),e}();function co(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ho=window.shaka,fo=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){var a=e.parseWebmContainer_(n),s=new lo(new DataView(t)).parseElement();if(s.id!=e.CUES_ID)throw ho.log.error("Not a Cues element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_CUES_ELEMENT_MISSING);return e.parseCues_(s,a.segmentOffset,a.timecodeScale,a.duration,r,i)}},{key:"parseWebmContainer_",value:function(t){var n=new lo(new DataView(t));if(n.parseElement().id!=e.EBML_ID)throw ho.log.error("Not an EBML element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);var r=n.parseElement();if(r.id!=e.SEGMENT_ID)throw ho.log.error("Not a Segment element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_SEGMENT_ELEMENT_MISSING);var i=r.getOffset(),a=e.parseSegment_(r);return{segmentOffset:i,timecodeScale:a.timecodeScale,duration:a.duration}}},{key:"parseSegment_",value:function(t){for(var n=t.createParser(),r=null;n.hasMoreData();){var i=n.parseElement();if(i.id==e.INFO_ID){r=i;break}}if(!r)throw ho.log.error("Not an Info element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_INFO_ELEMENT_MISSING);return e.parseInfo_(r)}},{key:"parseInfo_",value:function(t){for(var n=t.createParser(),r=1e6,i=null;n.hasMoreData();){var a=n.parseElement();a.id==e.TIMECODE_SCALE_ID?r=a.getUint():a.id==e.DURATION_ID&&(i=a.getFloat())}if(null==i)throw new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_DURATION_ELEMENT_MISSING);var s=r/1e9;return{timecodeScale:s,duration:i*s}}},{key:"parseCues_",value:function(t,n,r,i,a,s){for(var o=[],l=function(){return a},u=t.createParser(),c=null,d=null;u.hasMoreData();){var h=u.parseElement();if(h.id==e.CUE_POINT_ID){var f=e.parseCuePoint_(h);if(f){var p=r*f.unscaledTime,m=n+f.relativeOffset;null!=c&&(window.asserts.assert(null!=d,"last offset cannot be null"),o.push(new wr(o.length,c-s,p-s,l,d,m-1))),c=p,d=m}}}return null!=c&&(window.asserts.assert(null!=d,"last offset cannot be null"),o.push(new wr(o.length,c-s,i-s,l,d,null))),o}},{key:"parseCuePoint_",value:function(t){var n=t.createParser(),r=n.parseElement();if(r.id!=e.CUE_TIME_ID)throw ho.log.warning("Not a CueTime element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_CUE_TIME_ELEMENT_MISSING);var i=r.getUint(),a=n.parseElement();if(a.id!=e.CUE_TRACK_POSITIONS_ID)throw ho.log.warning("Not a CueTrackPositions element."),new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);for(var s=a.createParser(),o=0;s.hasMoreData();){var l=s.parseElement();if(l.id==e.CUE_CLUSTER_POSITION){o=l.getUint();break}}return{unscaledTime:i,relativeOffset:o}}}],(n=null)&&co(t.prototype,n),r&&co(t,r),e}());function po(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}fo.EBML_ID=440786851,fo.SEGMENT_ID=408125543,fo.INFO_ID=357149030,fo.TIMECODE_SCALE_ID=2807729,fo.DURATION_ID=17545,fo.CUES_ID=475249515,fo.CUE_POINT_ID=187,fo.CUE_TIME_ID=179,fo.CUE_TRACK_POSITIONS_ID=183,fo.CUE_CLUSTER_POSITION=241;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var vo=new M,go=window.shaka,yo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createInitSegment",value:function(e,t){var n=eo.inheritChild(e,t,"Initialization");if(!n)return null;var r=e.representation.baseUris,i=n.getAttribute("sourceURL");i&&(r=Re.resolveUris(e.representation.baseUris,[i]));var a=0,s=null,o=zs.parseAttr(n,"range",zs.parseRange);o&&(a=o.start,s=o.end);return new _r(function(){return r},a,s)}},{key:"createStream",value:function(t,n){window.asserts.assert(t.representation.segmentBase,"Should only be called with SegmentBase");var r=Number(eo.inheritAttribute(t,e.fromInheritance_,"presentationTimeOffset"))||0,i=eo.inheritAttribute(t,e.fromInheritance_,"timescale"),a=1;i&&(a=zs.parsePositiveInt(i)||1);var s=r/a||0,o=e.createInitSegment(t,e.fromInheritance_),l=e.createSegmentIndex_(t,n,o,s);return{createSegmentIndex:l.createSegmentIndex,findSegmentPosition:l.findSegmentPosition,getSegmentReference:l.getSegmentReference,initSegmentReference:o,scaledPresentationTimeOffset:s}}},{key:"createSegmentIndexFromUris",value:function(e,t,n,r,i,a,s,o){var l=e.presentationTimeline,u=!e.dynamic||!e.periodInfo.isLastPeriod,c=e.periodInfo.start,d=e.periodInfo.duration,h=t,f=null;return{createSegmentIndex:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,p,m,v,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[h(r,i,a),"webm"==s?h(n.getUris(),n.startByte,n.endByte):null],h=null,e.next=4,Promise.all(t);case 4:return p=e.sent,m=p[0],v=p[1]||null,g=null,"mp4"==s?g=ro.parse(m,i,r,o):(window.asserts.assert(v,"WebM requires init data"),g=fo.parse(m,v,r,o)),l.notifySegments(g,c),window.asserts.assert(!f,"Should not call createSegmentIndex twice"),f=new Tr(g),u&&f.fit(d),e.abrupt("return",p);case 14:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){po(a,r,i,s,o,"next",e)}function o(e){po(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}(),findSegmentPosition:function(e){return window.asserts.assert(f,"Must call createSegmentIndex first"),f.find(e)},getSegmentReference:function(e){return window.asserts.assert(f,"Must call createSegmentIndex first"),f.get(e)}}}},{key:"fromInheritance_",value:function(e){return e.segmentBase}},{key:"createSegmentIndex_",value:function(t,n,r,i){var a=Re.ContentType,s=t.representation.contentType,o=t.representation.mimeType.split("/")[1];if(s!=a.TEXT&&"mp4"!=o&&"webm"!=o)throw go.log.error("SegmentBase specifies an unsupported container type.",t.representation),new M(vo.severity.CRITICAL,vo.category.MANIFEST,vo.code.DASH_UNSUPPORTED_CONTAINER);if("webm"==o&&!r)throw go.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",t.representation),new M(vo.severity.CRITICAL,vo.category.MANIFEST,vo.code.DASH_WEBM_MISSING_INIT);var l=eo.inheritChild(t,e.fromInheritance_,"RepresentationIndex"),u=eo.inheritAttribute(t,e.fromInheritance_,"indexRange"),c=t.representation.baseUris,d=zs.parseRange(u||"");if(l){var h=l.getAttribute("sourceURL");h&&(c=Re.resolveUris(t.representation.baseUris,[h])),d=zs.parseAttr(l,"range",zs.parseRange,d)}if(!d)throw go.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",t.representation),new M(vo.severity.CRITICAL,vo.category.MANIFEST,vo.code.DASH_NO_SEGMENT_INFO);return e.createSegmentIndexFromUris(t,n,r,c,d.start,d.end,o,i)}}],(n=null)&&mo(t.prototype,n),r&&mo(t,r),e}();function _o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wo=window.shaka,Eo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createStream",value:function(e,t){window.asserts.assert(e.representation.segmentList,"Should only be called with SegmentList");var n=n,r=SegmentBase.createInitSegment(e,n.fromInheritance_),i=n.parseSegmentListInfo_(e);n.checkSegmentListInfo_(e,i);var a=null,s=null;e.period.id&&e.representation.id&&(s=e.period.id+","+e.representation.id,a=t[s]);var o=n.createSegmentReferences_(e.periodInfo.duration,i.startNumber,e.representation.baseUris,i);if(a){a.merge(o);var l=e.presentationTimeline.getSegmentAvailabilityStart();a.evict(l-e.periodInfo.start)}else e.presentationTimeline.notifySegments(o,e.periodInfo.start),a=new SegmentIndex(o),s&&e.dynamic&&(t[s]=a);return e.dynamic&&e.periodInfo.isLastPeriod||a.fit(e.periodInfo.duration),{createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return a.find(e)},getSegmentReference:function(e){return a.get(e)},initSegmentReference:r,scaledPresentationTimeOffset:i.scaledPresentationTimeOffset}}},{key:"fromInheritance_",value:function(e){return e.segmentList}},{key:"parseSegmentListInfo_",value:function(t){var n=e.parseMediaSegments_(t),r=MpdUtils.parseSegmentInfo(t,e.fromInheritance_),i=r.startNumber;0==i&&(wo.log.warning("SegmentList@startNumber must be > 0"),i=1);var a=0;return r.segmentDuration?a=r.segmentDuration*(i-1):r.timeline&&r.timeline.length>0&&(a=r.timeline[0].start),{segmentDuration:r.segmentDuration,startTime:a,startNumber:i,scaledPresentationTimeOffset:r.scaledPresentationTimeOffset,timeline:r.timeline,mediaSegments:n}}},{key:"checkSegmentListInfo_",value:function(e,t){if(!t.segmentDuration&&!t.timeline&&t.mediaSegments.length>1)throw wo.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.representation),new wo.util.Error(wo.util.Error.Severity.CRITICAL,wo.util.Error.Category.MANIFEST,wo.util.Error.Code.DASH_NO_SEGMENT_INFO);if(!t.segmentDuration&&!e.periodInfo.duration&&!t.timeline&&1==t.mediaSegments.length)throw wo.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.representation),new wo.util.Error(wo.util.Error.Severity.CRITICAL,wo.util.Error.Category.MANIFEST,wo.util.Error.Code.DASH_NO_SEGMENT_INFO);if(t.timeline&&0==t.timeline.length)throw wo.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.representation),new wo.util.Error(wo.util.Error.Severity.CRITICAL,wo.util.Error.Category.MANIFEST,wo.util.Error.Code.DASH_NO_SEGMENT_INFO)}},{key:"createSegmentReferences_",value:function(e,t,n,r){var i=wo.util.ManifestParserUtils,a=r.mediaSegments.length;r.timeline&&r.timeline.length!=r.mediaSegments.length&&(a=Math.min(r.timeline.length,r.mediaSegments.length),wo.log.warning("The number of items in the segment timeline and the number of ","segment URLs do not match, truncating",r.mediaSegments.length,"to",a));for(var s=[],o=r.startTime,l=function(a){var l=r.mediaSegments[a],u=i.resolveUris(n,[l.mediaUri]),c=o,d=void 0;null!=r.segmentDuration?d=c+r.segmentDuration:r.timeline?d=r.timeline[a].end:(window.asserts.assert(1==r.mediaSegments.length&&e,"There should be exactly one segment with a Period duration."),d=c+e);s.push(new SegmentReference(a+t,c,d,function(){return u},l.start,l.end)),o=d},u=0;u<a;u++)l(u);return s}},{key:"parseMediaSegments_",value:function(e){return[e.representation.segmentList,e.adaptationSet.segmentList,e.period.segmentList].filter(Functional.isNotNull).map(function(e){return XmlUtils.findChildren(e,"SegmentURL")}).reduce(function(e,t){return e.length>0?e:t}).map(function(t){t.getAttribute("indexRange")&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0,wo.log.warning("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var n=t.getAttribute("media"),r=XmlUtils.parseAttr(t,"mediaRange",XmlUtils.parseRange,{start:0,end:null});return{mediaUri:n,start:r.start,end:r.end}})}}],(n=null)&&_o(t.prototype,n),r&&_o(t,r),e}();function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Eo.MediaSegment,Eo.SegmentListInfo;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var So=window.shaka,To=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createStream",value:function(t,n,r,i){window.asserts.assert(t.representation.segmentTemplate,"Should only be called with SegmentTemplate");var a=e.createInitSegment_(t),s=e.parseSegmentTemplateInfo_(t);e.checkSegmentTemplateInfo_(t,s);var o=null;if(s.indexTemplate)o=e.createFromIndexTemplate_(t,n,a,s);else if(s.segmentDuration)i||(t.presentationTimeline.notifyMaxSegmentDuration(s.segmentDuration),t.presentationTimeline.notifyMinSegmentStartTime(t.periodInfo.start)),o=e.createFromDuration_(t,s);else{var l=null,u=null;t.period.id&&t.representation.id&&(u=t.period.id+","+t.representation.id,l=r[u]);var c=e.createFromTimeline_(t,s),d=!t.dynamic||!t.periodInfo.isLastPeriod;if(l){if(d)new Tr(c).fit(t.periodInfo.duration);l.merge(c);var h=t.presentationTimeline.getSegmentAvailabilityStart();l.evict(h-t.periodInfo.start)}else t.presentationTimeline.notifySegments(c,t.periodInfo.start),l=new Tr(c),u&&t.dynamic&&(r[u]=l);d&&l.fit(t.periodInfo.duration),o={createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return l.find(e)},getSegmentReference:function(e){return l.get(e)}}}return{createSegmentIndex:o.createSegmentIndex,findSegmentPosition:o.findSegmentPosition,getSegmentReference:o.getSegmentReference,initSegmentReference:a,scaledPresentationTimeOffset:s.scaledPresentationTimeOffset}}},{key:"fromInheritance_",value:function(e){return e.segmentTemplate}},{key:"parseSegmentTemplateInfo_",value:function(t){var n=eo.parseSegmentInfo(t,e.fromInheritance_),r=eo.inheritAttribute(t,e.fromInheritance_,"media"),i=eo.inheritAttribute(t,e.fromInheritance_,"index");return{segmentDuration:n.segmentDuration,timescale:n.timescale,startNumber:n.startNumber,scaledPresentationTimeOffset:n.scaledPresentationTimeOffset,unscaledPresentationTimeOffset:n.unscaledPresentationTimeOffset,timeline:n.timeline,mediaTemplate:r,indexTemplate:i}}},{key:"checkSegmentTemplateInfo_",value:function(e,t){var n=0;if(n+=t.indexTemplate?1:0,n+=t.timeline?1:0,0==(n+=t.segmentDuration?1:0))throw So.log.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_NO_SEGMENT_INFO);if(1!=n&&(So.log.warning("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.representation),t.indexTemplate?(So.log.info("Using the index URL template by default."),t.timeline=null,t.segmentDuration=null):(window.asserts.assert(t.timeline,"There should be a timeline"),So.log.info("Using the SegmentTimeline by default."),t.segmentDuration=null)),!t.indexTemplate&&!t.mediaTemplate)throw So.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_NO_SEGMENT_INFO)}},{key:"createFromIndexTemplate_",value:function(e,t,n,r){var i=e.representation.mimeType.split("/")[1];if("mp4"!=i&&"webm"!=i)throw So.log.error("SegmentTemplate specifies an unsupported container type.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_UNSUPPORTED_CONTAINER);if("webm"==i&&!n)throw So.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_WEBM_MISSING_INIT);window.asserts.assert(r.indexTemplate,"must be using index template");var a=eo.fillUriTemplate(r.indexTemplate,e.representation.id,null,e.bandwidth||null,null),s=Re.resolveUris(e.representation.baseUris,[a]);return yo.createSegmentIndexFromUris(e,t,n,s,0,null,i,r.scaledPresentationTimeOffset)}},{key:"createFromDuration_",value:function(e,t){window.asserts.assert(t.mediaTemplate,"There should be a media template with duration");var n=e.periodInfo.duration,r=t.segmentDuration,i=t.startNumber,a=t.timescale,s=t.mediaTemplate,o=e.bandwidth||null,l=e.representation.id,u=e.representation.baseUris;return{createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return e<0?null:n&&e>=n?null:Math.floor(e/r)},getSegmentReference:function(e){var t=e*r,c=t+r;if(n&&(c=Math.min(c,n)),c<0)return null;if(n&&t>=n)return null;return new wr(e,t,c,function(){var n=eo.fillUriTemplate(s,l,e+i,o,t*a);return Re.resolveUris(u,[n])},0,null)}}}},{key:"createFromTimeline_",value:function(e,t){for(var n=[],r=function(r){var i=t.timeline[r].start,a=t.timeline[r].unscaledStart,s=t.timeline[r].end,o=r+t.startNumber,l=a+t.unscaledPresentationTimeOffset;n.push(new wr(o,i,s,function(){window.asserts.assert(t.mediaTemplate,"There should be a media template with a timeline");var n=eo.fillUriTemplate(t.mediaTemplate,e.representation.id,o,e.bandwidth||null,l);return Re.resolveUris(e.representation.baseUris,[n]).map(function(e){return e.toString()})},0,null))},i=0;i<t.timeline.length;i++)r(i);return n}},{key:"createInitSegment_",value:function(t){var n=eo.inheritAttribute(t,e.fromInheritance_,"initialization");if(!n)return null;var r=t.representation.id,i=t.bandwidth||null,a=t.representation.baseUris;return new _r(function(){window.asserts.assert(n,"Should have returned earler");var e=eo.fillUriTemplate(n,r,null,i,null);return Re.resolveUris(a,[e])},0,null)}}],(n=null)&&bo(t.prototype,n),r&&bo(t,r),e}();function ko(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Co(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Io(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Co(a,r,i,s,o,"next",e)}function o(e){Co(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}To.SegmentTemplateInfo;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lo=new M,Ro=window.shaka,xo=window.goog,No=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config_=null,this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,this.periodIds_=[],this.globalId_=1,this.segmentIndexMap_={},this.updatePeriod_=0,this.averageUpdateDuration_=new kt(5),this.updateTimer_=new H(function(){t.onUpdate_()}),this.operationManager_=new m}var t,n,r;return t=e,n=[{key:"configure",value:function(e){window.asserts.assert(null!=e.dash,"DashManifestConfiguration should not be null!"),this.config_=e}},{key:"start",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"Must call configure() before start()!"),this.manifestUris_=[t],this.playerInterface_=n,e.next=5,this.requestManifest_();case 5:if(r=e.sent,this.playerInterface_&&this.setUpdateTimer_(r),this.playerInterface_){e.next=9;break}throw new M(Lo.severity.CRITICAL,Lo.category.PLAYER,Lo.code.OPERATION_ABORTED);case 9:return window.asserts.assert(this.manifest_,"Manifest should be non-null!"),e.abrupt("return",this.manifest_);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){return this.playerInterface_=null,this.config_=null,this.manifestUris_=[],this.manifest_=null,this.periodIds_=[],this.segmentIndexMap_={},null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.operationManager_.destroy()}},{key:"update",value:function(){var e=Io(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.requestManifest_();case 3:e.next=11;break;case 5:if(e.prev=5,e.t0=e.catch(0),this.playerInterface_&&e.t0){e.next=9;break}return e.abrupt("return");case 9:window.asserts.assert(e.t0 instanceof M,"Bad error type"),this.playerInterface_.onError(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"onExpirationUpdated",value:function(e,t){}},{key:"requestManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=oe.RequestType.MANIFEST,n=oe.makeRequest(this.manifestUris_,this.config_.retryParameters),r=this.playerInterface_.networkingEngine,i=Date.now(),a=r.request(t,n),this.operationManager_.manage(a),e.next=8,a.promise;case 8:if(s=e.sent,this.playerInterface_){e.next=11;break}return e.abrupt("return",0);case 11:return s.uri&&!this.manifestUris_.includes(s.uri)&&this.manifestUris_.unshift(s.uri),e.next=14,this.parseManifest_(s.data,s.uri);case 14:return o=Date.now(),l=(o-i)/1e3,this.averageUpdateDuration_.sample(1,l),e.abrupt("return",l);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=zs.parseXml(t,"MPD")){e.next=3;break}throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_INVALID_XML,n);case 3:return i=this.config_.dash.xlinkFailGracefully,a=eo.processXlinks(r,this.config_.retryParameters,i,n,this.playerInterface_.networkingEngine),this.operationManager_.manage(a),e.next=8,a.promise;case 8:return s=e.sent,e.abrupt("return",this.processManifest_(s,n));case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"processManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,w,E;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[n],(i=zs.findChildren(t,"Location").map(zs.getContents).filter(Ae.isNotNull)).length>0&&(a=Re.resolveUris(r,i),this.manifestUris_=a,r=a),s=zs.findChildren(t,"BaseURL").map(zs.getContents),o=Re.resolveUris(r,s),this.config_.dash.ignoreMinBufferTime||(l=zs.parseAttr(t,"minBufferTime",zs.parseDuration)),this.updatePeriod_=zs.parseAttr(t,"minimumUpdatePeriod",zs.parseDuration,-1),u=zs.parseAttr(t,"availabilityStartTime",zs.parseDate),c=zs.parseAttr(t,"timeShiftBufferDepth",zs.parseDuration),d=zs.parseAttr(t,"suggestedPresentationDelay",zs.parseDuration),h=zs.parseAttr(t,"maxSegmentDuration",zs.parseDuration),f=t.getAttribute("type")||"static",this.manifest_?p=this.manifest_.presentationTimeline:(m=Math.max(this.config_.dash.defaultPresentationDelay,1.5*l),p=new mr(u,null!=d?d:m,this.config_.dash.autoCorrectDrift)),v={dynamic:"static"!=f,presentationTimeline:p,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1},g=this.parsePeriods_(v,o,t),y=g.duration,_=g.periods,p.setStatic("static"==f),"static"!=f&&g.durationDerivedFromPeriods||p.setDuration(y||1/0),p.isLive()&&!isNaN(this.config_.availabilityWindowOverride)&&(c=this.config_.availabilityWindowOverride),null==c&&(c=1/0),p.setSegmentAvailabilityDuration(c),p.notifyMaxSegmentDuration(h||1),xo.DEBUG&&p.assertIsValid(),this.manifest_){e.next=36;break}if(this.manifest_={presentationTimeline:p,periods:_,offlineSessionIds:[],minBufferTime:l||0},!p.usingPresentationStartTime()){e.next=36;break}return w=zs.findChildren(t,"UTCTiming"),e.next=32,this.parseUtcTiming_(o,w);case 32:if(E=e.sent,this.playerInterface_){e.next=35;break}return e.abrupt("return");case 35:p.setClockOffset(E);case 36:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"parsePeriods_",value:function(e,t,n){for(var r=zs.parseAttr(n,"mediaPresentationDuration",zs.parseDuration),i=[],a=0,s=zs.findChildren(n,"Period"),o=0;o<s.length;o++){var l=s[o],u=zs.parseAttr(l,"start",zs.parseDuration,a),c=zs.parseAttr(l,"duration",zs.parseDuration),d=null;if(o!=s.length-1){var h=s[o+1],f=zs.parseAttr(h,"start",zs.parseDuration);null!=f&&(d=f-u)}else null!=r&&(d=r-u);var p=Re.GAP_OVERLAP_TOLERANCE_SECONDS;d&&c&&Math.abs(d-c)>p&&Ro.log.warning("There is a gap/overlap between Periods",l),null==d&&(d=c);var m={start:u,duration:d,node:l,isLastPeriod:null==d||o==s.length-1},v=this.parsePeriod_(e,t,m);i.push(v);var g=e.period.id;if(window.asserts.assert(g,"Period IDs should not be null!"),this.periodIds_.includes(g)||(this.periodIds_.push(g),this.manifest_&&(this.playerInterface_.filterNewPeriod(v),this.manifest_.periods.push(v))),null==d){o!=s.length-1&&Ro.log.warning("Skipping Period",o+1,"and any subsequent Periods:","Period",o+1,"does not have a valid start time.",i[o+1]),a=null;break}a=u+d}return null==this.manifest_&&this.playerInterface_.filterAllPeriods(i),null!=r?(a!=r&&Ro.log.warning("@mediaPresentationDuration does not match the total duration of ","all Periods."),{periods:i,duration:r,durationDerivedFromPeriods:!1}):{periods:i,duration:a,durationDerivedFromPeriods:!0}}},{key:"parsePeriod_",value:function(e,t,n){var r=this,i=Re.ContentType;e.period=this.createFrame_(n.node,null,t),e.periodInfo=n,e.period.id||(Ro.log.info("No Period ID given for Period with start time "+n.start+",  Assigning a default"),e.period.id="__shaka_period_"+n.start);var a=zs.findChildren(n.node,"EventStream"),s=!0,o=!1,l=void 0;try{for(var u,c=a[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;this.parseEventStream_(n.start,n.duration,d)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}var h=zs.findChildren(n.node,"AdaptationSet").map(function(t){return r.parseAdaptationSet_(e,t)}).filter(Ae.isNotNull);if(e.dynamic){var f=[],p=!0,m=!1,v=void 0;try{for(var g,y=h[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value,w=!0,E=!1,b=void 0;try{for(var S,T=_.representationIds[Symbol.iterator]();!(w=(S=T.next()).done);w=!0){var k=S.value;f.push(k)}}catch(e){E=!0,b=e}finally{try{w||null==T.return||T.return()}finally{if(E)throw b}}}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}var C=new Set(f);if(f.length!=C.size)throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_DUPLICATE_REPRESENTATION_ID)}var I=h.filter(function(e){return!e.trickModeFor}),A=h.filter(function(e){return e.trickModeFor}),L=!0,R=!1,x=void 0;try{for(var N,P=A[Symbol.iterator]();!(L=(N=P.next()).done);L=!0){var O=N.value,D=O.streams[0],U=O.trickModeFor,F=!0,B=!1,V=void 0;try{for(var H,G=I[Symbol.iterator]();!(F=(H=G.next()).done);F=!0){var j=H.value;if(j.id==U){var K=!0,W=!1,q=void 0;try{for(var z,Y=j.streams[Symbol.iterator]();!(K=(z=Y.next()).done);K=!0){z.value.trickModeVideo=D}}catch(e){W=!0,q=e}finally{try{K||null==Y.return||Y.return()}finally{if(W)throw q}}}}}catch(e){B=!0,V=e}finally{try{F||null==G.return||G.return()}finally{if(B)throw V}}}}catch(e){R=!0,x=e}finally{try{L||null==P.return||P.return()}finally{if(R)throw x}}var X=this.getSetsOfType_(I,i.VIDEO),$=this.getSetsOfType_(I,i.AUDIO);if(!X.length&&!$.length)throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_EMPTY_PERIOD);$.length||($=[null]),X.length||(X=[null]);var Q=[],Z=!0,J=!1,ee=void 0;try{for(var te,ne=$[Symbol.iterator]();!(Z=(te=ne.next()).done);Z=!0){var re=te.value,ie=!0,ae=!1,se=void 0;try{for(var oe,le=X[Symbol.iterator]();!(ie=(oe=le.next()).done);ie=!0){var ue=oe.value;this.createVariants_(re,ue,Q)}}catch(e){ae=!0,se=e}finally{try{ie||null==le.return||le.return()}finally{if(ae)throw se}}}}catch(e){J=!0,ee=e}finally{try{Z||null==ne.return||ne.return()}finally{if(J)throw ee}}var ce=this.getSetsOfType_(I,i.TEXT),de=[],he=!0,fe=!1,pe=void 0;try{for(var me,ve=ce[Symbol.iterator]();!(he=(me=ve.next()).done);he=!0){var ge=me.value;de.push.apply(de,ko(ge.streams))}}catch(e){fe=!0,pe=e}finally{try{he||null==ve.return||ve.return()}finally{if(fe)throw pe}}return{startTime:n.start,textStreams:de,variants:Q}}},{key:"getSetsOfType_",value:function(e,t){return e.filter(function(e){return e.contentType==t})}},{key:"createVariants_",value:function(e,t,n){var r,i,a=Re.ContentType;if(window.asserts.assert(!e||e.contentType==a.AUDIO,"Audio parameter mismatch!"),window.asserts.assert(!t||t.contentType==a.VIDEO,"Video parameter mismatch!"),e||t)if(e&&t){if(Qt.areDrmCompatible(e.drmInfos,t.drmInfos)){var s=Qt.getCommonDrmInfos(e.drmInfos,t.drmInfos),o=!0,l=!1,u=void 0;try{for(var c,d=e.streams[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=!0,p=!1,m=void 0;try{for(var v,g=t.streams[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value;r=(y.bandwidth||0)+(h.bandwidth||0),i={id:this.globalId_++,language:e.language,primary:e.main||t.main,audio:h,video:y,bandwidth:r,drmInfos:s,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}}else{var _=e||t,w=!0,E=!1,b=void 0;try{for(var S,T=_.streams[Symbol.iterator]();!(w=(S=T.next()).done);w=!0){var k=S.value;r=k.bandwidth||0,i={id:this.globalId_++,language:_.language||"und",primary:_.main,audio:e?k:null,video:t?k:null,bandwidth:r,drmInfos:_.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}catch(e){E=!0,b=e}finally{try{w||null==T.return||T.return()}finally{if(E)throw b}}}}},{key:"parseAdaptationSet_",value:function(t,n){var r=this,i=Re.ContentType;t.adaptationSet=this.createFrame_(n,t.period,null);var a=!1,s=zs.findChildren(n,"Role"),o=s.map(function(e){return e.getAttribute("value")}).filter(Ae.isNotNull),l=void 0,u=t.adaptationSet.contentType==i.TEXT;u&&(l=Re.TextStreamKind.SUBTITLE);var c=!0,d=!1,h=void 0;try{for(var f,p=s[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=m.getAttribute("schemeIdUri");if(null==v||"urn:mpeg:dash:role:2011"==v){var g=m.getAttribute("value");switch(g){case"main":a=!0;break;case"caption":case"subtitle":l=g}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var y=zs.findChildren(n,"EssentialProperty"),_=null,w=!1,E=!0,b=!1,S=void 0;try{for(var T,k=y[Symbol.iterator]();!(E=(T=k.next()).done);E=!0){var C=T.value;"http://dashif.org/guidelines/trickmode"==C.getAttribute("schemeIdUri")?_=C.getAttribute("value"):w=!0}}catch(e){b=!0,S=e}finally{try{E||null==k.return||k.return()}finally{if(b)throw S}}var I=zs.findChildren(n,"Accessibility"),A=new Map,L=!0,R=!1,x=void 0;try{for(var N,P=I[Symbol.iterator]();!(L=(N=P.next()).done);L=!0){var O=N.value,D=O.getAttribute("schemeIdUri");if("urn:scte:dash:cc:cea-608:2015"==D||"urn:scte:dash:cc:cea-708:2015"==D){var U=1,F=O.getAttribute("value");if(null!=F){var B=!0,V=!1,H=void 0;try{for(var G,j=F.split(";")[Symbol.iterator]();!(B=(G=j.next()).done);B=!0){var K=G.value,W=void 0,q=void 0;if(K.includes("=")){var z=K.split("=");W=z[0].startsWith("CC")?z[0]:"CC"+z[0],q=z[1].split(",")[0].split(":").pop()}else W="CC"+U,U+=2,q=K;A.set(W,Ne.normalize(q))}}catch(e){V=!0,H=e}finally{try{B||null==j.return||j.return()}finally{if(V)throw H}}}else A.set("CC1","und")}}}catch(e){R=!0,x=e}finally{try{L||null==P.return||P.return()}finally{if(R)throw x}}if(w)return null;var Y=zs.findChildren(n,"ContentProtection"),X=Qs.parseFromAdaptationSet(Y,this.config_.dash.customScheme,this.config_.dash.ignoreDrmInfo),$=Ne.normalize(n.getAttribute("lang")||"und"),Q=n.getAttribute("label"),Z=zs.findChildren(n,"Representation"),J=Z.map(function(e){return r.parseRepresentation_(t,X,l,$,Q,a,o,A,e)}).filter(function(e){return!!e});if(0==J.length){if(u)return null;throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.DASH_EMPTY_ADAPTATION_SET)}if(!t.adaptationSet.contentType||t.adaptationSet.contentType==i.APPLICATION){var ee=J[0].mimeType,te=J[0].codecs;t.adaptationSet.contentType=e.guessContentType_(ee,te);var ne=!0,re=!1,ie=void 0;try{for(var ae,se=J[Symbol.iterator]();!(ne=(ae=se.next()).done);ne=!0){ae.value.type=t.adaptationSet.contentType}}catch(e){re=!0,ie=e}finally{try{ne||null==se.return||se.return()}finally{if(re)throw ie}}}var oe=!0,le=!1,ue=void 0;try{for(var ce,de=J[Symbol.iterator]();!(oe=(ce=de.next()).done);oe=!0){var he=ce.value,fe=!0,pe=!1,me=void 0;try{for(var ve,ge=X.drmInfos[Symbol.iterator]();!(fe=(ve=ge.next()).done);fe=!0){var ye=ve.value;he.keyId&&ye.keyIds.push(he.keyId)}}catch(e){pe=!0,me=e}finally{try{fe||null==ge.return||ge.return()}finally{if(pe)throw me}}}}catch(e){le=!0,ue=e}finally{try{oe||null==de.return||de.return()}finally{if(le)throw ue}}var _e=Z.map(function(e){return e.getAttribute("id")}).filter(Ae.isNotNull);return{id:t.adaptationSet.id||"__fake__"+this.globalId_++,contentType:t.adaptationSet.contentType,language:$,main:a,streams:J,drmInfos:X.drmInfos,trickModeFor:_,representationIds:_e}}},{key:"parseRepresentation_",value:function(e,t,n,r,i,a,s,o,l){var u,c=this,d=Re.ContentType;if(e.representation=this.createFrame_(l,e.adaptationSet,null),!this.verifyRepresentation_(e.representation))return Ro.log.warning("Skipping Representation",e.representation),null;e.bandwidth=zs.parseAttr(l,"bandwidth",zs.parsePositiveInt)||0;var h=e.representation.contentType,f=h==d.TEXT||h==d.APPLICATION;try{var p=function(e,t,n){return c.requestInitSegment_(e,t,n)};if(e.representation.segmentBase)u=yo.createStream(e,p);else if(e.representation.segmentList)u=Eo.createStream(e,this.segmentIndexMap_);else if(e.representation.segmentTemplate){var m=!!this.manifest_;u=To.createStream(e,p,this.segmentIndexMap_,m)}else{window.asserts.assert(f,"Must have Segment* with non-text streams.");var v=e.representation.baseUris,g=e.periodInfo.duration||0;u={createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return e>=0&&e<g?1:null},getSegmentReference:function(e){return 1!=e?null:new wr(1,0,g,function(){return v},0,null)},initSegmentReference:null,scaledPresentationTimeOffset:0}}}catch(e){if(f&&e.code==M.Code.DASH_NO_SEGMENT_INFO)return null;throw e}var y=zs.findChildren(l,"ContentProtection"),_=Qs.parseFromRepresentation(y,this.config_.dash.customScheme,t,this.config_.dash.ignoreDrmInfo);return{id:this.globalId_++,originalId:e.representation.id,createSegmentIndex:u.createSegmentIndex,findSegmentPosition:u.findSegmentPosition,getSegmentReference:u.getSegmentReference,initSegmentReference:u.initSegmentReference,presentationTimeOffset:u.scaledPresentationTimeOffset,mimeType:e.representation.mimeType,codecs:e.representation.codecs,frameRate:e.representation.frameRate,bandwidth:e.bandwidth,width:e.representation.width,height:e.representation.height,kind:n,encrypted:t.drmInfos.length>0,keyId:_,language:r,label:i,type:e.adaptationSet.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.representation.emsgSchemeIdUris,roles:s,channelsCount:e.representation.numChannels,closedCaptions:o}}},{key:"onUpdate_",value:function(){var e=Io(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.updatePeriod_>=0,"There should be an update period"),Ro.log.info("Updating manifest..."),t=0,e.prev=3,e.next=6,this.requestManifest_();case 6:t=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),window.asserts.assert(e.t0 instanceof M,"Should only receive a Shaka error"),this.playerInterface_&&(e.t0.severity=M.Severity.RECOVERABLE,this.playerInterface_.onError(e.t0));case 13:if(this.playerInterface_){e.next=15;break}return e.abrupt("return");case 15:this.setUpdateTimer_(t);case 16:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"setUpdateTimer_",value:function(t){if(!(this.updatePeriod_<0)){var n=Math.max(e.MIN_UPDATE_PERIOD_,this.updatePeriod_-t,this.averageUpdateDuration_.getEstimate());this.updateTimer_.tickAfter(n)}}},{key:"createFrame_",value:function(t,n,r){window.asserts.assert(n||r,"Must provide either parent or baseUris"),n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,numChannels:null},r=r||n.baseUris;var i=zs.parseNonNegativeInt,a=zs.evalDivision,s=zs.findChildren(t,"BaseURL").map(zs.getContents),o=t.getAttribute("contentType")||n.contentType,l=t.getAttribute("mimeType")||n.mimeType,u=t.getAttribute("codecs")||n.codecs,c=zs.parseAttr(t,"frameRate",a)||n.frameRate,d=this.emsgSchemeIdUris_(zs.findChildren(t,"InbandEventStream"),n.emsgSchemeIdUris),h=zs.findChildren(t,"AudioChannelConfiguration"),f=this.parseAudioChannels_(h)||n.numChannels;return o||(o=e.guessContentType_(l,u)),{baseUris:Re.resolveUris(r,s),segmentBase:zs.findChild(t,"SegmentBase")||n.segmentBase,segmentList:zs.findChild(t,"SegmentList")||n.segmentList,segmentTemplate:zs.findChild(t,"SegmentTemplate")||n.segmentTemplate,width:zs.parseAttr(t,"width",i)||n.width,height:zs.parseAttr(t,"height",i)||n.height,contentType:o,mimeType:l,codecs:u,frameRate:c,emsgSchemeIdUris:d,id:t.getAttribute("id"),numChannels:f}}},{key:"emsgSchemeIdUris_",value:function(e,t){var n=t.slice(),r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value.getAttribute("schemeIdUri");n.includes(l)||n.push(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"parseAudioChannels_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s.getAttribute("schemeIdUri");if(o){var l=s.getAttribute("value");if(l)switch(o){case"urn:mpeg:dash:outputChannelPositionList:2012":return l.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var u=parseInt(l,10);if(!u){Ro.log.warning("Channel parsing failure! Ignoring scheme and value",o,l);continue}return u;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":var c=parseInt(l,16);if(!c){Ro.log.warning("Channel parsing failure! Ignoring scheme and value",o,l);continue}for(var d=0;c;)1&c&&++d,c>>=1;return d;default:Ro.log.warning("Unrecognized audio channel scheme:",o,l);continue}}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"verifyRepresentation_",value:function(e){var t=Re.ContentType,n=0;return n+=e.segmentBase?1:0,n+=e.segmentList?1:0,0==(n+=e.segmentTemplate?1:0)?e.contentType==t.TEXT||e.contentType==t.APPLICATION||(Ro.log.warning("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1):(1!=n&&(Ro.log.warning("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.segmentBase?(Ro.log.info("Using SegmentBase by default."),e.segmentList=null,e.segmentTemplate=null):(window.asserts.assert(e.segmentList,"There should be a SegmentList"),Ro.log.info("Using SegmentList by default."),e.segmentTemplate=null)),!0)}},{key:"requestForTiming_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Re.resolveUris(t,[n]),(a=oe.makeRequest(i,this.config_.retryParameters)).method=r,s=oe.RequestType.TIMING,o=this.playerInterface_.networkingEngine.request(s,a),this.operationManager_.manage(o),e.next=8,o.promise;case 8:if(l=e.sent,"HEAD"!=r){e.next=16;break}if(l.headers&&l.headers.date){e.next=13;break}return Ro.log.warning("UTC timing response is missing","expected date header"),e.abrupt("return",0);case 13:u=l.headers.date,e.next=17;break;case 16:u=Gt.fromUTF8(l.data);case 17:if(c=Date.parse(u),!isNaN(c)){e.next=21;break}return Ro.log.warning("Unable to parse date from UTC timing response"),e.abrupt("return",0);case 21:return e.abrupt("return",c-Date.now());case 22:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"parseUtcTiming_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}),i=this.config_.dash.clockSyncUri,!r.length&&i&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),a=!0,s=!1,o=void 0,e.prev=6,l=r[Symbol.iterator]();case 8:if(a=(u=l.next()).done){e.next=36;break}c=u.value,e.prev=10,d=c.scheme,h=c.value,e.t0=d,e.next="urn:mpeg:dash:utc:http-head:2014"===e.t0?16:"urn:mpeg:dash:utc:http-head:2012"===e.t0?16:"urn:mpeg:dash:utc:http-xsdate:2014"===e.t0?19:"urn:mpeg:dash:utc:http-iso:2014"===e.t0?19:"urn:mpeg:dash:utc:http-xsdate:2012"===e.t0?19:"urn:mpeg:dash:utc:http-iso:2012"===e.t0?19:"urn:mpeg:dash:utc:direct:2014"===e.t0?22:"urn:mpeg:dash:utc:direct:2012"===e.t0?22:"urn:mpeg:dash:utc:http-ntp:2014"===e.t0?24:"urn:mpeg:dash:utc:ntp:2014"===e.t0?24:"urn:mpeg:dash:utc:sntp:2014"===e.t0?24:26;break;case 16:return e.next=18,this.requestForTiming_(t,h,"HEAD");case 18:return e.abrupt("return",e.sent);case 19:return e.next=21,this.requestForTiming_(t,h,"GET");case 21:return e.abrupt("return",e.sent);case 22:return f=Date.parse(h),e.abrupt("return",isNaN(f)?0:f-Date.now());case 24:return Ro.log.alwaysWarn("NTP UTCTiming scheme is not supported"),e.abrupt("break",28);case 26:return Ro.log.alwaysWarn("Unrecognized scheme in UTCTiming element",d),e.abrupt("break",28);case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(10),Ro.log.warning("Error fetching time from UTCTiming elem",e.t1.message);case 33:a=!0,e.next=8;break;case 36:e.next=42;break;case 38:e.prev=38,e.t2=e.catch(6),s=!0,o=e.t2;case 42:e.prev=42,e.prev=43,a||null==l.return||l.return();case 45:if(e.prev=45,!s){e.next=48;break}throw o;case 48:return e.finish(45);case 49:return e.finish(42);case 50:return Ro.log.alwaysWarn("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),e.abrupt("return",0);case 52:case"end":return e.stop()}},e,this,[[6,38,42,50],[10,30],[43,,45,49]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"parseEventStream_",value:function(e,t,n){var r=zs.parseNonNegativeInt,i=n.getAttribute("schemeIdUri")||"",a=n.getAttribute("value")||"",s=zs.parseAttr(n,"timescale",r)||1,o=!0,l=!1,u=void 0;try{for(var c,d=zs.findChildren(n,"Event")[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=zs.parseAttr(h,"presentationTime",r)||0,p=zs.parseAttr(h,"duration",r)||0,m=f/s+e,v=m+p/s;null!=t&&(m=Math.min(m,e+t),v=Math.min(v,e+t));var g={schemeIdUri:i,value:a,startTime:m,endTime:v,id:h.getAttribute("id")||"",eventElement:h};this.playerInterface_.onTimelineRegionAdded(g)}}catch(e){l=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}},{key:"requestInitSegment_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=oe.RequestType.SEGMENT,a=Br.createSegmentRequest(t,n,r,this.config_.retryParameters),s=this.playerInterface_.networkingEngine,o=s.request(i,a),this.operationManager_.manage(o),e.next=7,o.promise;case 7:return l=e.sent,e.abrupt("return",l.data);case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}],r=[{key:"guessContentType_",value:function(e,t){var n=Ot.getFullType(e,t);return vn.isTypeSupported(n)?Re.ContentType.TEXT:e.split("/")[0]}}],n&&Ao(t.prototype,n),r&&Ao(t,r),e}();function Mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Po(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */No.MIN_UPDATE_PERIOD_=3,No.RequestInitSegmentCallback={},No.InheritanceFrame={},No.Context={},No.PeriodInfo={},No.AdaptationInfo={},No.SegmentIndexFunctions={},No.StreamInfo={},Wn.registerParserByExtension("mpd",No),Wn.registerParserByMime("application/dash+xml",No);window.shaka,window.goog;var Oo=function e(t,n,r,i){Po(this,e),this.absoluteUri=t,this.type=n,this.tags=r,this.segments=i||null},Do=0,Uo=1,Fo=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Po(this,e),this.id=t,this.name=n,this.attributes=r,this.value=i}var t,n,r;return t=e,(n=[{key:"toString",value:function(){var e="#"+this.name,t=this.attributes?this.attributes.map(function(e){var t=isNaN(Number(e.value))?'"'+e.value+'"':e.value;return e.name+"="+t}):[];return this.value&&t.unshift(this.value),t.length>0&&(e+=":"+t.join(",")),e}},{key:"addAttribute",value:function(e){this.attributes.push(e)}},{key:"getAttribute",value:function(e){var t=this.attributes.filter(function(t){return t.name==e});return window.asserts.assert(t.length<2,"A tag should not have multiple attributes with the same name!"),t.length?t[0]:null}},{key:"getAttributeValue",value:function(e,t){var n=this.getAttribute(e);return n?n.value:t||null}}])&&Mo(t.prototype,n),r&&Mo(t,r),e}(),Bo=function e(t,n){Po(this,e),this.name=t,this.value=n},Vo=function e(t,n){Po(this,e),this.tags=n,this.absoluteUri=t};function Ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Go=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"filterTagsByName",value:function(e,t){return e.filter(function(e){return e.name==t})}},{key:"getFirstTagWithName",value:function(t,n){var r=e.filterTagsByName(t,n);return r.length?r[0]:null}},{key:"findMediaTags",value:function(e,t,n){return e.filter(function(e){var r=e.getAttribute("TYPE"),i=e.getAttribute("GROUP-ID");return r.value==t&&i.value==n})}},{key:"constructAbsoluteUri",value:function(e,t){return Re.resolveUris([e],[t])[0]}},{key:"isComment",value:function(e){return/^#(?!EXT)/m.test(e)}}],(n=null)&&Ho(t.prototype,n),r&&Ho(t,r),e}();function jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ko=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data_=t,this.position_=0}var t,n,r;return t=e,(n=[{key:"atEnd",value:function(){return this.position_==this.data_.length}},{key:"readLine",value:function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)}},{key:"readWord",value:function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)}},{key:"skipWhitespace",value:function(){this.readRegex(/[ \t]+/gm)}},{key:"readRegex",value:function(e){var t=this.indexOf_(e);return this.atEnd()||null==t||t.position!=this.position_?null:(this.position_+=t.length,t.results)}},{key:"readRegexReturnCapture_",value:function(e,t){if(this.atEnd())return null;var n=this.readRegex(e);return n?n[t]:null}},{key:"indexOf_",value:function(e){window.asserts.assert(e.global,"global flag should be set"),e.lastIndex=this.position_;var t=e.exec(this.data_);return null==t?null:{position:t.index,length:t[0].length,results:t}}}])&&jo(t.prototype,n),r&&jo(t,r),e}();function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var qo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalId_=0}var t,n,r;return t=e,r=[{key:"parseTag",value:function(e,t){var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.INVALID_HLS_TAG,t);var r,i=n[1],a=n[2],s=[];if(a){var o,l=new Ko(a),u=l.readRegex(/^([^,=]+)(?:,|$)/g);u&&(r=u[1]);for(var c=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=l.readRegex(c);){var d=o[1],h=o[2]||o[3],f=new Bo(d,h);s.push(f)}}return new Fo(e,i,s,r)}}],(n=[{key:"parsePlaylist",value:function(t,n){var r=e.MEDIA_PLAYLIST_TAGS,i=e.SEGMENT_TAGS,a=Gt.fromUTF8(t),s=(a=a.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(s[0]))throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.HLS_PLAYLIST_HEADER_MISSING);for(var o=Do,l=1;l<s.length;l++)if(!Go.isComment(s[l])){var u=this.parseTag_(s[l]);if(this.globalId_-=1,r.includes(u.name)){o=Uo;break}"EXT-X-STREAM-INF"==u.name&&(l+=1)}for(var c=[],d=1;d<s.length;)if(Go.isComment(s[d]))d+=1;else{var h=this.parseTag_(s[d]);if(i.includes(h.name)){if(o!=Uo)throw new M(M.Severity.CRITICAL,M.Category.MANIFEST,M.Code.HLS_INVALID_PLAYLIST_HIERARCHY);var f=s.splice(d,s.length-d),p=this.parseSegments_(n,f,c);return new Oo(n,o,c,p)}if(c.push(h),d+=1,"EXT-X-STREAM-INF"==h.name){var m=new Bo("URI",s[d]);h.addAttribute(m),d+=1}}return new Oo(n,o,c)}},{key:"parseSegments_",value:function(t,n,r){var i=[],a=[],s=!0,o=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;if(/^(#EXT)/.test(d)){var h=this.parseTag_(d);e.MEDIA_PLAYLIST_TAGS.includes(h.name)?r.push(h):a.push(h)}else if(Go.isComment(d));else{var f=d.trim(),p=Go.constructAbsoluteUri(t,f),m=new Vo(p,a);i.push(m),a=[]}}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}return i}},{key:"parseTag_",value:function(t){return e.parseTag(this.globalId_++,t)}}])&&Wo(t.prototype,n),r&&Wo(t,r),e}();function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}qo.MEDIA_PLAYLIST_TAGS=["EXT-X-TARGETDURATION","EXT-X-MEDIA-SEQUENCE","EXT-X-DISCONTINUITY-SEQUENCE","EXT-X-PLAYLIST-TYPE","EXT-X-MAP","EXT-X-I-FRAMES-ONLY","EXT-X-ENDLIST"],qo.SEGMENT_TAGS=["EXTINF","EXT-X-BYTERANGE","EXT-X-DISCONTINUITY","EXT-X-PROGRAM-DATE-TIME","EXT-X-KEY","EXT-X-DATERANGE"];
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yo=window.shaka,Xo=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){try{var a=e.parseRaw(t),s={uri:t,originalUri:t,data:a.data,headers:{"content-type":a.contentType}};return Yo.util.AbortableOperation.completed(s)}catch(e){return Yo.util.AbortableOperation.failed(e)}}},{key:"parseRaw",value:function(e){var t=e.split(":");if(t.length<2||"data"!=t[0])throw Yo.log.error("Bad data URI, failed to parse scheme"),new Yo.util.Error(Yo.util.Error.Severity.CRITICAL,Yo.util.Error.Category.NETWORK,Yo.util.Error.Code.MALFORMED_DATA_URI,e);var n=t.slice(1).join(":").split(",");if(n.length<2)throw Yo.log.error("Bad data URI, failed to extract encoding and MIME type"),new Yo.util.Error(Yo.util.Error.Severity.CRITICAL,Yo.util.Error.Category.NETWORK,Yo.util.Error.Code.MALFORMED_DATA_URI,e);var r,i=n[0],a=window.decodeURIComponent(n.slice(1).join(",")),s=i.split(";"),o=null;if(s.length>1&&(o=s[1]),"base64"==o)r=Yo.util.Uint8ArrayUtils.fromBase64(a).buffer;else{if(o)throw Yo.log.error("Bad data URI, unknown encoding"),new Yo.util.Error(Yo.util.Error.Severity.CRITICAL,Yo.util.Error.Category.NETWORK,Yo.util.Error.Code.UNKNOWN_DATA_URI_ENCODING,e);r=Yo.util.StringUtils.toUTF8(a)}return{data:r,contentType:s[0]}}}],(n=null)&&zo(t.prototype,n),r&&zo(t,r),e}());function $o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Qo(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Zo(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Qo(a,r,i,s,o,"next",e)}function o(e){Qo(a,r,i,s,o,"throw",e)}s(void 0)})}}function Jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}oe.registerScheme("data",Xo.parse);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var el=new M,tl=window.shaka,nl=(window.goog,function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playerInterface_=null,this.config_=null,this.globalId_=1,this.mediaTagsToStreamInfosMap_=new Map,this.variantUriSet_=new Set,this.uriToStreamInfosMap_=new Map,this.presentationTimeline_=null,this.masterPlaylistUri_="",this.manifestTextParser_=new qo,this.updatePlaylistDelay_=0,this.updatePlaylistTimer_=new H(function(){t.onUpdate_()}),this.presentationType_=e.PresentationType_.VOD,this.manifest_=null,this.maxTargetDuration_=0,this.minTargetDuration_=1/0,this.operationManager_=new m,this.segmentsToNotifyByStream_=[],this.groupIdToClosedCaptionsMap_=new Map,this.aesEncrypted_=!1}var t,n,r;return t=e,n=[{key:"configure",value:function(e){this.config_=e}},{key:"start",value:function(){var e=Zo(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"Must call configure() before start()!"),this.playerInterface_=n,e.next=4,this.requestManifest_(t);case 4:return r=e.sent,this.masterPlaylistUri_=r.uri,window.asserts.assert(r.data,"Response data should be non-null!"),e.next=9,this.parseManifest_(r.data);case 9:return(i=this.updatePlaylistDelay_)>0&&this.updatePlaylistTimer_.tickAfter(i),window.asserts.assert(this.manifest_,"Manifest should be non-null"),e.abrupt("return",this.manifest_);case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.updatePlaylistTimer_&&(this.updatePlaylistTimer_.stop(),this.updatePlaylistTimer_=null);var e=[];return this.operationManager_&&(e.push(this.operationManager_.destroy()),this.operationManager_=null),this.playerInterface_=null,this.config_=null,this.mediaTagsToStreamInfosMap_.clear(),this.variantUriSet_.clear(),this.uriToStreamInfosMap_.clear(),this.manifest_=null,Promise.all(e)}},{key:"update",value:function(){if(!this.isLive_())return Promise.resolve();var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(this.updateStream_(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return Promise.all(e)}},{key:"updateStream_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.PresentationType_,i=n.absoluteMediaPlaylistUri,t.next=4,this.requestManifest_(i);case 4:if(a=t.sent,(s=this.manifestTextParser_.parsePlaylist(a.data,a.uri)).type==Uo){t.next=8;break}throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_INVALID_PLAYLIST_HIERARCHY);case 8:return o=Go.getFirstTagWithName(s.tags,"EXT-X-MEDIA-SEQUENCE"),l=o?Number(o.value):0,u=n.stream,t.next=13,this.createSegments_(n.verbatimMediaPlaylistUri,s,l,u.mimeType,u.codecs);case 13:c=t.sent,n.segmentIndex.replace(c),d=c[c.length-1],window.asserts.assert(d,"Should have segments!"),Go.getFirstTagWithName(s.tags,"EXT-X-ENDLIST")&&(this.setPresentationType_(r.VOD),this.presentationTimeline_.setDuration(d.endTime));case 19:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onExpirationUpdated",value:function(e,t){}},{key:"parseManifest_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d,h,f,p,m,v,g,y,_,w,E,b,S,T,k,C,I,A,L,R;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert(this.masterPlaylistUri_,"Master playlist URI must be set before calling parseManifest_!"),(r=this.manifestTextParser_.parsePlaylist(n,this.masterPlaylistUri_)).type==Do){t.next=4;break}throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_MASTER_PLAYLIST_NOT_PROVIDED);case 4:return t.next=6,this.createPeriod_(r);case 6:if(i=t.sent,this.playerInterface_){t.next=9;break}throw new M(el.severity.CRITICAL,el.category.PLAYER,el.code.OPERATION_ABORTED);case 9:if(!this.aesEncrypted_||0!=i.variants.length){t.next=12;break}throw tl.log.info("No stream is created, because we don't support AES-128","encryption yet"),new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_AES_128_ENCRYPTION_NOT_SUPPORTED);case 12:for(this.playerInterface_.filterAllPeriods([i]),a=1/0,s=0,o=0,l=1/0,u=!0,c=!1,d=void 0,t.prev=20,h=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(u=(f=h.next()).done);u=!0)p=f.value,a=Math.min(a,p.minTimestamp),s=Math.max(s,p.minTimestamp),o=Math.max(o,p.maxTimestamp),"text"!=p.stream.type&&(l=Math.min(l,p.duration));t.next=28;break;case 24:t.prev=24,t.t0=t.catch(20),c=!0,d=t.t0;case 28:t.prev=28,t.prev=29,u||null==h.return||h.return();case 31:if(t.prev=31,!c){t.next=34;break}throw d;case 34:return t.finish(31);case 35:return t.finish(28);case 36:if(window.asserts.assert(null==this.presentationTimeline_,"Presentation timeline created early!"),this.createPresentationTimeline_(o),window.asserts.assert(this.presentationTimeline_,"Presentation timeline not created!"),!this.isLive_()){t.next=69;break}for(this.updatePlaylistDelay_=this.minTargetDuration_,m=e.PresentationType_,this.presentationType_==m.LIVE&&(v=this.presentationTimeline_.getDelay(),isNaN(this.config_.availabilityWindowOverride)||(v=this.config_.availabilityWindowOverride),this.presentationTimeline_.setSegmentAvailabilityDuration(v)),g=e.TS_ROLLOVER_/e.TS_TIMESCALE_,y=0;s>=g;)y+=g,s-=g;if(!y){t.next=67;break}for(tl.log.debug("Offsetting live streams by",y,"to compensate for rollover"),_=!0,w=!1,E=void 0,t.prev=51,b=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(_=(S=b.next()).done);_=!0)(T=S.value).minTimestamp<g?(tl.log.v1("Offset applied to",T.stream.type),T.stream.presentationTimeOffset=-y,T.segmentIndex.offset(y)):tl.log.v1("Offset NOT applied to",T.stream.type);t.next=59;break;case 55:t.prev=55,t.t1=t.catch(51),w=!0,E=t.t1;case 59:t.prev=59,t.prev=60,_||null==b.return||b.return();case 62:if(t.prev=62,!w){t.next=65;break}throw E;case 65:return t.finish(62);case 66:return t.finish(59);case 67:t.next=90;break;case 69:for(this.presentationTimeline_.setDuration(l),this.presentationTimeline_.offset(-a),k=!0,C=!1,I=void 0,t.prev=74,A=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(k=(L=A.next()).done);k=!0)(R=L.value).stream.presentationTimeOffset=a,R.segmentIndex.offset(-a),R.segmentIndex.fit(l);t.next=82;break;case 78:t.prev=78,t.t2=t.catch(74),C=!0,I=t.t2;case 82:t.prev=82,t.prev=83,k||null==A.return||A.return();case 85:if(t.prev=85,!C){t.next=88;break}throw I;case 88:return t.finish(85);case 89:return t.finish(82);case 90:this.manifest_={presentationTimeline:this.presentationTimeline_,periods:[i],offlineSessionIds:[],minBufferTime:0};case 91:case"end":return t.stop()}},t,this,[[20,24,28,36],[29,,31,35],[51,55,59,67],[60,,62,66],[74,78,82,90],[83,,85,89]])}));return function(e){return t.apply(this,arguments)}}()},{key:"createPeriod_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,l,u,c,d,h,f=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.tags,i=Go.filterTagsByName(n.tags,"EXT-X-MEDIA"),a=i.filter(function(t){return"SUBTITLES"==e.getRequiredAttributeValue_(t,"TYPE")}),s=a.map(function(e){return f.createTextStream_(e,n)}),o=i.filter(function(t){return"CLOSED-CAPTIONS"==e.getRequiredAttributeValue_(t,"TYPE")}),this.parseClosedCaptions_(o),t.next=8,Promise.all(s);case 8:return l=t.sent,u=Go.filterTagsByName(r,"EXT-X-STREAM-INF"),c=u.map(function(e){return f.createVariantsForTag_(e,n)}),t.next=13,Promise.all(c);case 13:return d=t.sent,h=(h=d.reduce(Ae.collapseArrays,[])).filter(function(e){return null!=e}),t.abrupt("return",{startTime:0,variants:h,textStreams:l});case 17:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createVariantsForTag_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,l,u,c,d,h,p,m,v,g,y,_,w,E,b,S,T,k,C,I,A,L,R=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert("EXT-X-STREAM-INF"==n.name,"Should only be called on variant tags!"),i=Re.ContentType,"avc1.42E01E,mp4a.40.2",a=n.getAttributeValue("CODECS","avc1.42E01E,mp4a.40.2"),s=e.filterDuplicateCodecs_(a.split(/\s*,\s*/)),o=n.getAttribute("RESOLUTION"),l=null,u=null,c=n.getAttributeValue("FRAME-RATE"),d=Number(e.getRequiredAttributeValue_(n,"BANDWIDTH")),o&&(h=o.value.split("x"),l=h[0],u=h[1]),p=(p=(p=Go.filterTagsByName(r.tags,"EXT-X-MEDIA")).filter(function(t){return"CLOSED-CAPTIONS"!=e.getRequiredAttributeValue_(t,"TYPE")})).filter(function(e){var t=e.getAttributeValue("URI")||"";return"SUBTITLES"==(e.getAttributeValue("TYPE")||"")||""!=t}),m=n.getAttributeValue("AUDIO"),v=n.getAttributeValue("VIDEO"),window.asserts.assert(null==m||null==v,"Unexpected: both video and audio described by media tags!"),m?p=Go.findMediaTags(p,"AUDIO",m):v&&(p=Go.findMediaTags(p,"VIDEO",v)),(g=this.guessCodecsSafe_(i.TEXT,s))&&((y=n.getAttributeValue("SUBTITLES"))&&(_=Go.findMediaTags(p,"SUBTITLES",y),window.asserts.assert(1==_.length,"Exactly one text tag expected!"),_.length&&(this.mediaTagsToStreamInfosMap_.get(_[0].id).stream.codecs=g)),f.remove(s,g)),w=p.map(function(e){return R.createStreamInfoFromMediaTag_(e,s)}),E=[],b=[],t.next=25,Promise.all(w);case 25:if(T=(T=t.sent).filter(function(e){return null!=e}),m?E=T:v&&(b=T),tl.log.debug("Guessing stream type for",n.toString()),C=!1,E.length||b.length?E.length?(A=e.getRequiredAttributeValue_(n,"URI"),L=E[0].verbatimMediaPlaylistUri,A==L?(tl.log.debug("Guessing audio-only."),k=i.AUDIO,C=!0):(tl.log.debug("Guessing video."),k=i.VIDEO)):(window.asserts.assert(b.length,"No video streams!  This should have been handled already!"),tl.log.debug("Guessing audio."),k=i.AUDIO):1==s.length?(I=this.guessCodecsSafe_(i.VIDEO,s),o||c||I?(tl.log.debug("Guessing video-only."),k=i.VIDEO):(tl.log.debug("Guessing audio-only."),k=i.AUDIO)):(tl.log.debug("Guessing multiplexed audio+video."),k=i.VIDEO,s=[s.join(",")]),window.asserts.assert(k,"Type should have been set by now!"),C){t.next=36;break}return t.next=35,this.createStreamInfoFromVariantTag_(n,s,k);case 35:S=t.sent;case 36:if(!S){t.next=40;break}S.stream.type==i.AUDIO?E=[S]:b=[S],t.next=43;break;case 40:if(null!==S){t.next=43;break}return tl.log.debug("streamInfo is null"),t.abrupt("return",[]);case 43:return window.asserts.assert(b.length||E.length,"We should have created a stream!"),b&&this.filterLegacyCodecs_(b),E&&this.filterLegacyCodecs_(E),t.abrupt("return",this.createVariants_(E,b,d,l,u,c));case 47:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"filterLegacyCodecs_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s.stream.codecs.split(",");o=o.filter(function(e){return"mp4a.40.34"!=e}),s.stream.codecs=o.join(",")}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"createVariants_",value:function(e,t,n,r,i,a){var s=!0,o=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;this.addVideoAttributes_(d.stream,r,i,a)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}e.length||(e=[null]),t.length||(t=[null]);var h=[],f=!0,p=!1,m=void 0;try{for(var v,g=e[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value,_=!0,w=!1,E=void 0;try{for(var b,S=t[Symbol.iterator]();!(_=(b=S.next()).done);_=!0){var T=b.value,k=y?y.stream:null,C=T?T.stream:null,I=y?y.drmInfos:null,A=T?T.drmInfos:null,L=(T?T.verbatimMediaPlaylistUri:"")+" - "+(y?y.verbatimMediaPlaylistUri:""),R=void 0;if(k&&C){if(!Qt.areDrmCompatible(I,A)){tl.log.warning("Incompatible DRM info in HLS variant.  Skipping.");continue}R=Qt.getCommonDrmInfos(I,A)}else k?R=I:C&&(R=A);if(this.variantUriSet_.has(L))tl.log.debug("Skipping variant which only differs in text streams.");else{var x=this.createVariant_(k,C,n,R);h.push(x),this.variantUriSet_.add(L)}}}catch(e){w=!0,E=e}finally{try{_||null==S.return||S.return()}finally{if(w)throw E}}}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}return h}},{key:"createVariant_",value:function(e,t,n,r){var i=Re.ContentType;return window.asserts.assert(!e||e.type==i.AUDIO,"Audio parameter mismatch!"),window.asserts.assert(!t||t.type==i.VIDEO,"Video parameter mismatch!"),{id:this.globalId_++,language:e?e.language:"und",primary:!!e&&e.primary||!!t&&t.primary,audio:e,video:t,bandwidth:n,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}},{key:"createTextStream_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert("EXT-X-MEDIA"==n.name,"Should only be called on media tags!"),i=e.getRequiredAttributeValue_(n,"TYPE"),window.asserts.assert("SUBTITLES"==i,'Should only be called on tags with TYPE="SUBTITLES"!'),t.next=5,this.createStreamInfoFromMediaTag_(n,[]);case 5:return a=t.sent,window.asserts.assert(a,"Should always have a streamInfo for text"),t.abrupt("return",a.stream);case 8:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"parseClosedCaptions_",value:function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;window.asserts.assert("EXT-X-MEDIA"==o.name,"Should only be called on media tags!");var l=e.getRequiredAttributeValue_(o,"TYPE");window.asserts.assert("CLOSED-CAPTIONS"==l,'Should only be called on tags with TYPE="CLOSED-CAPTIONS"!');var u=o.getAttributeValue("LANGUAGE")||"und",c=Ne.normalize(u),d=e.getRequiredAttributeValue_(o,"GROUP-ID"),h=e.getRequiredAttributeValue_(o,"INSTREAM-ID");this.groupIdToClosedCaptionsMap_.get(d)||this.groupIdToClosedCaptionsMap_.set(d,new Map),this.groupIdToClosedCaptionsMap_.get(d).set(h,c)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"createStreamInfoFromMediaTag_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,l,u,c,d,h,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert("EXT-X-MEDIA"==n.name,"Should only be called on media tags!"),i=e.getRequiredAttributeValue_(n,"URI"),!this.uriToStreamInfosMap_.has(i)){t.next=4;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(i));case 4:return a=e.getRequiredAttributeValue_(n,"TYPE").toLowerCase(),s=Re.ContentType,"subtitles"==a&&(a=s.TEXT),o=Ne.normalize(n.getAttributeValue("LANGUAGE","und")),l=n.getAttributeValue("NAME"),u=n.getAttribute("DEFAULT"),c=n.getAttribute("AUTOSELECT"),d=n.getAttributeValue("CHANNELS"),h="audio"==a?this.getChannelCount_(d):null,f=!!u||!!c,t.next=16,this.createStreamInfo_(i,r,a,o,f,l,h,null);case 16:if(null!=(p=t.sent)){t.next=19;break}return t.abrupt("return",null);case 19:if(!this.uriToStreamInfosMap_.has(i)){t.next=21;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(i));case 21:return this.mediaTagsToStreamInfosMap_.set(n.id,p),this.uriToStreamInfosMap_.set(i,p),t.abrupt("return",p);case 24:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getChannelCount_",value:function(e){if(!e)return null;var t=e.split("/")[0];return parseInt(t,10)}},{key:"createStreamInfoFromVariantTag_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r,i){var a,s,o,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert("EXT-X-STREAM-INF"==n.name,"Should only be called on media tags!"),a=Re.ContentType,s=e.getRequiredAttributeValue_(n,"URI"),!this.uriToStreamInfosMap_.has(s)){t.next=5;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(s));case 5:return o=n.getAttributeValue("CLOSED-CAPTIONS"),l=null,i==a.VIDEO&&o&&"NONE"!=o&&(l=this.groupIdToClosedCaptionsMap_.get(o)),t.next=10,this.createStreamInfo_(s,r,i,"und",!1,null,null,l);case 10:if(null!=(u=t.sent)){t.next=13;break}return t.abrupt("return",null);case 13:if(!this.uriToStreamInfosMap_.has(s)){t.next=15;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(s));case 15:return this.uriToStreamInfosMap_.set(s,u),t.abrupt("return",u);case 17:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"createStreamInfo_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r,i,a,s,o,l,u){var c,d,h,f,p,m,v,g,y,_,w,E,b,S,T,k,C,I,A,L,R,x,N,P,O,D,U,F,B,V,H,G,j,K;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=Go.constructAbsoluteUri(this.masterPlaylistUri_,n),d="",t.next=4,this.requestManifest_(c);case 4:if(h=t.sent,c=h.uri,(f=this.manifestTextParser_.parsePlaylist(h.data,c)).type==Uo){t.next=9;break}throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_INVALID_PLAYLIST_HIERARCHY);case 9:if(p=[],!f.segments){t.next=30;break}for(m=!0,v=!1,g=void 0,t.prev=14,y=f.segments[Symbol.iterator]();!(m=(_=y.next()).done);m=!0)w=_.value,E=Go.filterTagsByName(w.tags,"EXT-X-KEY"),p.push.apply(p,$o(E));t.next=22;break;case 18:t.prev=18,t.t0=t.catch(14),v=!0,g=t.t0;case 22:t.prev=22,t.prev=23,m||null==y.return||y.return();case 25:if(t.prev=25,!v){t.next=28;break}throw g;case 28:return t.finish(25);case 29:return t.finish(22);case 30:b=!1,S=[],T=null,k=0,C=p;case 34:if(!(k<C.length)){t.next=50;break}if(I=C[k],"NONE"==(A=e.getRequiredAttributeValue_(I,"METHOD"))){t.next=47;break}if(b=!0,"AES-128"!=A){t.next=43;break}return tl.log.warning("Unsupported HLS Encryption",A),this.aesEncrypted_=!0,t.abrupt("return",null);case 43:L=e.getRequiredAttributeValue_(I,"KEYFORMAT"),R=e.KEYFORMATS_TO_DRM_PARSERS_[L],(x=R?R(I):null)?(x.keyIds.length&&(T=x.keyIds[0]),S.push(x)):tl.log.warning("Unsupported HLS KEYFORMAT",L);case 47:k++,t.next=34;break;case 50:if(!b||S.length){t.next=52;break}throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_KEYFORMATS_NOT_SUPPORTED);case 52:return window.asserts.assert(null!=f.segments,"Media playlist should have segments!"),this.determinePresentationType_(f),d=this.guessCodecs_(i,r),t.next=57,this.guessMimeType_(i,d,f);case 57:return N=t.sent,P=N,O=Go.getFirstTagWithName(f.tags,"EXT-X-MEDIA-SEQUENCE"),D=O?Number(O.value):0,t.next=63,this.createSegments_(n,f,D,P,d);case 63:return U=t.sent,F=U[0].startTime,B=U[U.length-1].endTime,V=B-F,H=new Tr(U),G=this.createInitSegmentReference_(f),j=void 0,i==Re.ContentType.TEXT&&(j=Re.TextStreamKind.SUBTITLE),K={id:this.globalId_++,originalId:o,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return H.find(e)},getSegmentReference:function(e){return H.get(e)},initSegmentReference:G,presentationTimeOffset:0,mimeType:P,codecs:d,kind:j,encrypted:b,keyId:T,language:a,label:o,type:i,primary:s,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:l,closedCaptions:u},t.abrupt("return",{stream:K,segmentIndex:H,drmInfos:S,verbatimMediaPlaylistUri:n,absoluteMediaPlaylistUri:c,minTimestamp:F,maxTimestamp:B,duration:V});case 73:case"end":return t.stop()}},t,this,[[14,18,22,30],[23,,25,29]])}));return function(e,n,r,i,a,s,o,l){return t.apply(this,arguments)}}()},{key:"determinePresentationType_",value:function(t){var n=e.PresentationType_,r=Go.getFirstTagWithName(t.tags,"EXT-X-PLAYLIST-TYPE"),i=Go.getFirstTagWithName(t.tags,"EXT-X-ENDLIST"),a=r&&"VOD"==r.value||i,s=r&&"EVENT"==r.value&&!a,o=!a&&!s;if(a)this.setPresentationType_(n.VOD);else{o?this.setPresentationType_(n.LIVE):this.setPresentationType_(n.EVENT);var l=this.getRequiredTag_(t.tags,"EXT-X-TARGETDURATION"),u=Number(l.value);this.maxTargetDuration_=Math.max(u,this.maxTargetDuration_),this.minTargetDuration_=Math.min(u,this.minTargetDuration_)}}},{key:"createPresentationTimeline_",value:function(e){this.isLive_()?(this.presentationTimeline_=new mr(0,3*this.maxTargetDuration_),this.presentationTimeline_.setStatic(!1)):(this.presentationTimeline_=new mr(null,0),this.presentationTimeline_.setStatic(!0)),this.notifySegments_(),window.asserts.assert(!this.presentationTimeline_.usingPresentationStartTime(),"We should not be using the presentation start time in HLS!")}},{key:"createInitSegmentReference_",value:function(t){var n=Go.filterTagsByName(t.tags,"EXT-X-MAP");if(!n.length)return null;if(n.length>1)throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND);var r=n[0],i=e.getRequiredAttributeValue_(r,"URI"),a=Go.constructAbsoluteUri(t.absoluteUri,i),s=0,o=null,l=r.getAttributeValue("BYTERANGE");if(l){var u=l.split("@"),c=Number(u[0]);o=(s=Number(u[1]))+c-1}return new _r(function(){return[a]},s,o)}},{key:"createSegmentReference_",value:function(e,t,n,r,i){var a=n.tags,s=n.absoluteUri,o=this.getRequiredTag_(a,"EXTINF").value.split(","),l=i+Number(o[0]),u=0,c=null,d=Go.getFirstTagWithName(a,"EXT-X-BYTERANGE");if(d){var h=d.value.split("@"),f=Number(h[0]);h[1]?u=Number(h[1]):(window.asserts.assert(t,"Cannot refer back to previous HLS segment!"),u=t.endByte+1),c=u+f-1}return new wr(r,i,l,function(){return[s]},u,c)}},{key:"notifySegments_",value:function(){if(this.presentationTimeline_){var e=!0,t=!1,n=void 0;try{for(var r,i=this.segmentsToNotifyByStream_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.presentationTimeline_.notifySegments(a,0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.segmentsToNotifyByStream_=[]}}},{key:"createSegments_",value:function(){var e=Zo(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,l,u,c,d,h,f,p,m,v,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.segments,o=[],window.asserts.assert(s.length,"Playlist should have segments!"),l=s[0].absoluteUri,u=this.createSegmentReference_(n,null,s[0],r,0),c=this.createInitSegmentReference_(n),e.next=8,this.getStartTime_(t,c,u,i,a);case 8:for(d=e.sent,tl.log.debug("First segment",l.split("/").pop(),"starts at",d),h=0;h<s.length;++h)f=s[h],p=o[o.length-1],m=0==h?d:p.endTime,v=r+h,g=this.createSegmentReference_(n,p,f,v,m),o.push(g);return this.segmentsToNotifyByStream_.push(o),this.notifySegments_(),e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"fetchPartialSegment_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n){var r,i,a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=oe.RequestType,i=Br.createSegmentRequest(n.getUris(),n.startByte,n.startByte+e.PARTIAL_SEGMENT_SIZE_-1,this.config_.retryParameters),a=Br.createSegmentRequest(n.getUris(),n.startByte,n.endByte,this.config_.retryParameters),t.prev=3,t.next=6,this.makeNetworkRequest_(i,r.SEGMENT);case 6:return s=t.sent,t.abrupt("return",s);case 10:if(t.prev=10,t.t0=t.catch(3),t.t0.code!=el.code.OPERATION_ABORTED){t.next=14;break}throw t.t0;case 14:return tl.log.alwaysWarn("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),t.next=17,this.makeNetworkRequest_(a,r.SEGMENT);case 17:return o=t.sent,t.abrupt("return",o);case 19:case"end":return t.stop()}},t,this,[[3,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"getStartTime_",value:function(){var e=Zo(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,l,u,c,d,h,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.manifest_){e.next=8;break}if(s=this.uriToStreamInfosMap_.get(t),o=s.segmentIndex,!(l=o.get(r.position))){e.next=7;break}return tl.log.v1("Found segment start time in previous manifest"),e.abrupt("return",l.startTime);case 7:tl.log.debug("Unable to find segment start time in previous manifest!");case 8:if(tl.log.v1("Fetching segment to find start time"),"audio/mpeg"!=i){e.next=11;break}return e.abrupt("return",0);case 11:if("video/mp4"!=i&&"audio/mp4"!=i){e.next=20;break}return u=[this.fetchPartialSegment_(r)],n&&u.push(this.fetchPartialSegment_(n)),e.next=16,Promise.all(u);case 16:return c=e.sent,d=c[0],h=c[1]||c[0],e.abrupt("return",this.getStartTimeFromMp4Segment_(d.data,h.data));case 20:if("video/mp2t"!=i){e.next=26;break}return e.next=23,this.fetchPartialSegment_(r);case 23:return f=e.sent,window.asserts.assert(f.data,"Should have a response body!"),e.abrupt("return",this.getStartTimeFromTsSegment_(f.data));case 26:if("application/mp4"!=i&&!i.startsWith("text/")){e.next=32;break}return e.next=29,this.fetchPartialSegment_(r);case 29:return p=e.sent,window.asserts.assert(p.data,"Should have a response body!"),e.abrupt("return",this.getStartTimeFromTextSegment_(i,a,p.data));case 32:throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);case 33:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"getStartTimeFromMp4Segment_",value:function(e,t){var n=0;if((new Ki).box("moov",Ki.children).box("trak",Ki.children).box("mdia",Ki.children).fullBox("mdhd",function(e){window.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),e.reader.skip(0==e.version?8:16),n=e.reader.readUint32(),e.parser.stop()}).parse(t,!0),!n)throw tl.log.error("Unable to find timescale in init segment!"),new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);var r=0,i=!1;if((new Ki).box("moof",Ki.children).box("traf",Ki.children).fullBox("tfdt",function(e){window.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1");var t=0==e.version?e.reader.readUint32():e.reader.readUint64();r=t/n,i=!0,e.parser.stop()}).parse(e,!0),!i)throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);return r}},{key:"getStartTimeFromTsSegment_",value:function(t){for(var n=new Vi(new DataView(t),Vi.Endianness.BIG_ENDIAN),r=function(){throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME)},i=0,a=0;;){i=n.getPosition(),71!=(a=n.readUint8())&&r(),16384&n.readUint16()||r();var s=(48&n.readUint8())>>4;if(0!=s&&2!=s||r(),3==s){var o=n.readUint8();n.skip(o)}if(1==n.readUint32()>>8){n.skip(3);var l=n.readUint8()>>6;0!=l&&1!=l||r();var u=n.readUint8();return 0==u&&r(),2==l?window.asserts.assert(5==u,"Bad PES header?"):3==l&&window.asserts.assert(10==u,"Bad PES header?"),(((14&n.readUint8())>>1)*(1<<30)+((65534&n.readUint16())<<14|(65534&n.readUint16())>>1))/e.TS_TIMESCALE_}n.seek(i+188),71!=(a=n.readUint8())&&(n.seek(i+192),a=n.readUint8()),71!=a&&(n.seek(i+204),a=n.readUint8()),71!=a&&r(),n.rewind(1)}}},{key:"getStartTimeFromTextSegment_",value:function(e,t,n){var r=Ot.getFullType(e,t);if(!vn.isTypeSupported(r))return 0;var i=new vn(null);return i.initParser(r),i.getStartTime(n)}},{key:"guessCodecsSafe_",value:function(t,n){var r=Re.ContentType,i=e.CODEC_REGEXPS_BY_CONTENT_TYPE_[t],a=!0,s=!1,o=void 0;try{for(var l,u=i[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=!0,h=!1,f=void 0;try{for(var p,m=n[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(c.test(v.trim()))return v.trim()}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}return t==r.TEXT?"":null}},{key:"guessCodecs_",value:function(e,t){if(1==t.length)return t[0];var n=this.guessCodecsSafe_(e,t);if(null!=n)return n;throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_GUESS_CODECS,t)}},{key:"guessMimeType_",value:function(){var t=Zo(regeneratorRuntime.mark(function t(n,r,i){var a,s,o,l,u,c,d,h,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Re.ContentType,s=oe.RequestType,window.asserts.assert(i.segments.length,"Playlist should have segments!"),o=i.segments[0].absoluteUri,l=new $(o),u=l.getPath().split(".").pop(),c=e.EXTENSION_MAP_BY_CONTENT_TYPE_[n],!(d=c[u])){t.next=10;break}return t.abrupt("return",d);case 10:if(n!=a.TEXT){t.next=16;break}if(r&&"vtt"!=r){t.next=15;break}return t.abrupt("return","text/vtt");case 15:return t.abrupt("return","application/mp4");case 16:return(h=oe.makeRequest([o],this.config_.retryParameters)).method="HEAD",t.next=20,this.makeNetworkRequest_(h,s.SEGMENT);case 20:if(f=t.sent,p=f.headers["content-type"]){t.next=24;break}throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_COULD_NOT_GUESS_MIME_TYPE,u);case 24:return t.abrupt("return",p.split(";")[0]);case 25:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getRequiredTag_",value:function(e,t){var n=Go.getFirstTagWithName(e,t);if(!n)throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_REQUIRED_TAG_MISSING,t);return n}},{key:"addVideoAttributes_",value:function(e,t,n,r){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(r)||void 0)}},{key:"requestManifest_",value:function(e){var t=oe.RequestType,n=oe.makeRequest([e],this.config_.retryParameters);return this.makeNetworkRequest_(n,t.MANIFEST)}},{key:"onUpdate_",value:function(){var e=Zo(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(tl.log.info("Updating manifest..."),window.asserts.assert(this.updatePlaylistDelay_>0,"We should only call |onUpdate_| when we are suppose to be updating."),this.playerInterface_){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,this.update();case 7:t=this.updatePlaylistDelay_,this.updatePlaylistTimer_.tickAfter(t),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(4),window.asserts.assert(e.t0 instanceof M,"Should only receive a Shaka error"),e.t0.severity=el.severity.RECOVERABLE,this.playerInterface_.onError(e.t0),this.updatePlaylistTimer_.tickAfter(.1);case 17:case"end":return e.stop()}},e,this,[[4,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"isLive_",value:function(){var t=e.PresentationType_;return this.presentationType_!=t.VOD}},{key:"setPresentationType_",value:function(e){this.presentationType_=e,this.presentationTimeline_&&this.presentationTimeline_.setStatic(!this.isLive_()),this.isLive_()||this.updatePlaylistTimer_.stop()}},{key:"makeNetworkRequest_",value:function(e,t){if(!this.operationManager_)throw new M(el.severity.CRITICAL,el.category.PLAYER,el.code.OPERATION_ABORTED);var n=this.playerInterface_.networkingEngine.request(t,e);return this.operationManager_.manage(n),n.promise}}],r=[{key:"filterDuplicateCodecs_",value:function(e){var t=new Set,n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=Ot.getCodecBase(l);t.has(u)?tl.log.debug("Ignoring duplicate codec"):(n.push(l),t.add(u))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"getRequiredAttributeValue_",value:function(e,t){var n=e.getAttribute(t);if(!n)throw new M(el.severity.CRITICAL,el.category.MANIFEST,el.code.HLS_REQUIRED_ATTRIBUTE_MISSING,t);return n.value}},{key:"widevineDrmParser_",value:function(t){var n=e.getRequiredAttributeValue_(t,"METHOD");tl.Deprecate.deprecateFeature(2,6,"HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var r=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!r.includes(n))return tl.log.error("Widevine in HLS is only supported with [",r.join(", "),"], not",n),null;var i=e.getRequiredAttributeValue_(t,"URI"),a=Xo.parseRaw(i),s=new Uint8Array(a.data),o=Re.createDrmInfo("com.widevine.alpha",[{initDataType:"cenc",initData:s}]),l=t.getAttributeValue("KEYID");return l&&(window.asserts.assert(l.startsWith("0x"),"Incorrect KEYID format!"),o.keyIds=[l.substr(2).toLowerCase()]),o}}],n&&Jo(t.prototype,n),r&&Jo(t,r),e}());nl.StreamInfo={},nl.VIDEO_CODEC_REGEXPS_=[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],nl.AUDIO_CODEC_REGEXPS_=[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],nl.TEXT_CODEC_REGEXPS_=[/^vtt$/,/^wvtt/,/^stpp/],nl.CODEC_REGEXPS_BY_CONTENT_TYPE_={audio:nl.AUDIO_CODEC_REGEXPS_,video:nl.VIDEO_CODEC_REGEXPS_,text:nl.TEXT_CODEC_REGEXPS_},nl.AUDIO_EXTENSIONS_TO_MIME_TYPES_={mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},nl.VIDEO_EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},nl.TEXT_EXTENSIONS_TO_MIME_TYPES_={mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"},nl.EXTENSION_MAP_BY_CONTENT_TYPE_={audio:nl.AUDIO_EXTENSIONS_TO_MIME_TYPES_,video:nl.VIDEO_EXTENSIONS_TO_MIME_TYPES_,text:nl.TEXT_EXTENSIONS_TO_MIME_TYPES_},nl.DrmParser_,nl.KEYFORMATS_TO_DRM_PARSERS_={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":nl.widevineDrmParser_},nl.PresentationType_={VOD:"VOD",EVENT:"EVENT",LIVE:"LIVE"},nl.TS_TIMESCALE_=9e4,nl.TS_ROLLOVER_=8589934592,nl.PARTIAL_SEGMENT_SIZE_=2048;Wn.registerParserByExtension("m3u8",nl),Wn.registerParserByMime("application/x-mpegurl",nl),Wn.registerParserByMime("application/vnd.apple.mpegurl",nl);n(20);function rl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var il=new M,al=window.shaka,sl=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"makeResponse",value:function(e,t,n,r,i,a){if(n>=200&&n<=299&&202!=n)return{uri:i||r,originalUri:r,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};var s=null;try{s=Gt.fromBytesAutoDetect(t)}catch(e){}al.log.debug("HTTP error text:",s);var o=401===n||403===n?il.severity.CRITICAL:il.severity.RECOVERABLE;throw new M(o,il.category.NETWORK,il.code.BAD_HTTP_STATUS,r,n,s,e,a)}}],(n=null)&&rl(t.prototype,n),r&&rl(t,r),e}());function ol(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function ll(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ol(a,r,i,s,o,"next",e)}function o(e){ol(a,r,i,s,o,"throw",e)}s(void 0)})}}function ul(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var cl=new M,dl=window.shaka,hl=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=null,r=[{key:"parse",value:function(t,n,r,i){var a=new e.Headers_;Nt.asMap(n.headers).forEach(function(e,t){a.append(t,e)});var s=new e.AbortController_,o={body:n.body||void 0,headers:a,method:n.method,signal:s.signal,credentials:n.allowCrossSiteCredentials?"include":void 0},l={canceled:!1,timedOut:!1},u=e.request_(t,r,o,l,i),c=new U(u,function(){return l.canceled=!0,s.abort(),Promise.resolve()}),d=n.retryParameters.timeout;if(d){var h=new H(function(){l.timedOut=!0,s.abort()});h.tickAfter(d/1e3),c.finally(function(){h.stop()})}return c}},{key:"request_",value:function(){var t=ll(regeneratorRuntime.mark(function t(n,r,i,a,s){var o,l,u,c,d,h,f,p,m,v,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.fetch_,l=e.ReadableStream_,d=0,h=0,f=Date.now(),t.prev=5,t.next=8,o(n,i);case 8:return u=t.sent,p=u.clone().body.getReader(),m=u.headers.get("Content-Length"),v=m?parseInt(m,10):0,new l({start:function(e){var t=function(){var n=ll(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.read();case 3:r=n.sent,n.next=10;break;case 6:return n.prev=6,n.t0=n.catch(0),dl.log.v1("error reading from stream",n.t0.message),n.abrupt("return");case 10:r.done||(d+=r.value.byteLength),((i=Date.now())-f>100||r.done)&&(s(i-f,d-h,v-d),h=d,f=i),r.done?(window.asserts.assert(!r.value,'readObj should be unset when "done" is true.'),e.close()):(e.enqueue(r.value),t());case 14:case"end":return n.stop()}},n,null,[[0,6]])}));return function(){return n.apply(this,arguments)}}();t()}}),t.next=16,u.arrayBuffer();case 16:c=t.sent,t.next=30;break;case 19:if(t.prev=19,t.t0=t.catch(5),!a.canceled){t.next=25;break}throw new M(cl.severity.RECOVERABLE,cl.category.NETWORK,cl.code.OPERATION_ABORTED,n,r);case 25:if(!a.timedOut){t.next=29;break}throw new M(cl.severity.RECOVERABLE,cl.category.NETWORK,cl.code.TIMEOUT,n,r);case 29:throw new M(cl.severity.RECOVERABLE,cl.category.NETWORK,cl.code.HTTP_ERROR,n,t.t0,r);case 30:return g={},u.headers.forEach(function(e,t){g[t.trim()]=e}),t.abrupt("return",sl.makeResponse(g,c,u.status,n,u.url,r));case 34:case"end":return t.stop()}},t,null,[[5,19]])}));return function(e,n,r,i,a){return t.apply(this,arguments)}}()},{key:"isSupported",value:function(){if(!window.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!window.fetch||!window.AbortController)}}],n&&ul(t.prototype,n),r&&ul(t,r),e}());hl.AbortStatus={},hl.fetch_=window.fetch,hl.AbortController_=window.AbortController,hl.ReadableStream_=window.ReadableStream,hl.Headers_=window.Headers,hl.isSupported()&&(oe.registerScheme("http",hl.parse,oe.PluginPriority.PREFERRED),oe.registerScheme("https",hl.parse,oe.PluginPriority.PREFERRED));function fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pl=new M,ml=(window.shaka,window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){var a=new e.Xhr_,s=Date.now(),o=0,l=new Promise(function(e,l){for(var u in a.open(n.method,t,!0),a.responseType="arraybuffer",a.timeout=n.retryParameters.timeout,a.withCredentials=n.allowCrossSiteCredentials,a.onabort=function(){l(new M(pl.severity.RECOVERABLE,pl.category.NETWORK,pl.code.OPERATION_ABORTED,t,r))},a.onload=function(n){var i=n.target;window.asserts.assert(i,"XHR onload has no target!");var a=i.getAllResponseHeaders().trim().split("\r\n"),s={},o=!0,u=!1,c=void 0;try{for(var d,h=a[Symbol.iterator]();!(o=(d=h.next()).done);o=!0){var f=d.value.split(": ");s[f[0].toLowerCase()]=f.slice(1).join(": ")}}catch(e){u=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw c}}try{var p=sl.makeResponse(s,i.response,i.status,t,i.responseURL,r);e(p)}catch(e){window.asserts.assert(e instanceof M,"Wrong error type!"),l(e)}},a.onerror=function(e){l(new M(pl.severity.RECOVERABLE,pl.category.NETWORK,pl.code.HTTP_ERROR,t,e,r))},a.ontimeout=function(e){l(new M(pl.severity.RECOVERABLE,pl.category.NETWORK,pl.code.TIMEOUT,t,r))},a.onprogress=function(e){var t=Date.now();(t-s>100||e.lengthComputable&&e.loaded==e.total)&&(i(t-s,e.loaded-o,e.total-e.loaded),o=e.loaded,s=t)},n.headers){var c=u.toLowerCase();a.setRequestHeader(c,n.headers[u])}a.send(n.body)});return new U(l,function(){return a.abort(),Promise.resolve()})}}],(n=null)&&fl(t.prototype,n),r&&fl(t,r),e}());ml.Xhr_=window.XMLHttpRequest,oe.registerScheme("http",ml.parse,oe.PluginPriority.FALLBACK),oe.registerScheme("https",ml.parse,oe.PluginPriority.FALLBACK);function vl(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function gl(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){vl(a,r,i,s,o,"next",e)}function o(e){vl(a,r,i,s,o,"throw",e)}s(void 0)})}}function yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _l=window.shaka,wl=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uri_=null}var t,n,r;return t=e,(n=[{key:"configure",value:function(e){}},{key:"start",value:function(){var e=gl(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=er.parse(t),this.uri_=r,null!=r&&r.isManifest()){e.next=4;break}throw new _l.util.Error(_l.util.Error.Severity.CRITICAL,_l.util.Error.Category.NETWORK,_l.util.Error.Code.MALFORMED_OFFLINE_URI,t);case 4:return i=new dr,e.prev=5,e.next=8,i.init();case 8:return e.next=10,i.getCell(r.mechanism(),r.cell());case 10:return a=e.sent,e.next=13,a.getManifests([r.key()]);case 13:return s=e.sent,o=s[0],l=new Cr(r.mechanism(),r.cell()),e.abrupt("return",l.fromManifestDB(o));case 17:return e.prev=17,e.next=20,i.destroy();case 20:return e.finish(17);case 21:case"end":return e.stop()}},e,this,[[5,,17,21]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){return Promise.resolve()}},{key:"update",value:function(){}},{key:"onExpirationUpdated",value:function(){var e=gl(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.uri_,"Should not get update event before start has been called"),r=this.uri_,i=new dr,e.prev=3,e.next=6,i.init();case 6:return e.next=8,i.getCell(r.mechanism(),r.cell());case 8:return a=e.sent,e.next=11,a.getManifests([r.key()]);case 11:if(s=e.sent,o=s[0],l=o.sessionIds.includes(t),u=null==o.expiration||o.expiration>n,!l||!u){e.next=19;break}return _l.log.debug("Updating expiration for stored content"),e.next=19,a.updateManifestExpiration(r.key(),n);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),_l.log.error("There was an error updating",r,e.t0);case 24:return e.prev=24,e.next=27,i.destroy();case 27:return e.finish(24);case 28:case"end":return e.stop()}},e,this,[[3,21,24,28]])}));return function(t,n){return e.apply(this,arguments)}}()}])&&yl(t.prototype,n),r&&yl(t,r),e}());Wn.registerParserByMime("application/x-offline-manifest",wl);function El(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var bl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"plugin",value:function(t,n,r,i){var a=er.parse(t);return a&&a.isManifest()?e.getManifest_(t):a&&a.isSegment()?e.getSegment_(a.key(),a):U.failed(new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.MALFORMED_OFFLINE_URI,t))}},{key:"getManifest_",value:function(e){var t={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return U.completed(t)}},{key:"getSegment_",value:function(e,t){window.asserts.assert(t.isSegment(),"Only segment uri's should be given to getSegment");var n=new dr;return U.completed(void 0).chain(function(){return n.init()}).chain(function(){return n.getCell(t.mechanism(),t.cell())}).chain(function(e){return e.getSegments([t.key()])}).chain(function(e){var n=e[0];return{uri:t,data:n.data,headers:{}}}).finally(function(){return n.destroy()})}}],(n=null)&&El(t.prototype,n),r&&El(t,r),e}();function Sl(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}oe.registerScheme("offline",bl.plugin);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var kl=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.transaction_=t,this.store_=t.objectStore(n),this.promise_=new A,t.onabort=function(e){e.preventDefault(),r.promise_.reject()},t.onerror=function(e){e.preventDefault(),r.promise_.reject()},t.oncomplete=function(e){r.promise_.resolve()}}var t,n,r;return t=e,(n=[{key:"abort",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.transaction_.abort()}catch(e){}return e.prev=1,e.next=4,this.promise_;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,this,[[1,6]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Sl(a,r,i,s,o,"next",e)}function o(e){Sl(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"forEachEntry",value:function(e){var t=this;return new Promise(function(n,r){var i=t.store_.openCursor();i.onerror=r,i.onsuccess=function(t){var r=t.target.result;r?(e(r.key,r.value,r),r.continue()):n()}})}},{key:"store",value:function(){return this.store_}},{key:"promise",value:function(){return this.promise_}}])&&Tl(t.prototype,n),r&&Tl(t,r),e}();function Cl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Il=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=t,this.pending_=[]}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return Promise.all(this.pending_.map(function(e){return e.abort()}))}},{key:"startReadOnlyOperation",value:function(e){return this.startOperation_(e,"readonly")}},{key:"startReadWriteOperation",value:function(e){return this.startOperation_(e,"readwrite")}},{key:"startOperation_",value:function(e,t){var n=this,r=this.connection_.transaction([e],t),i=new kl(r,e);return this.pending_.push(i),i.promise().then(function(){return n.stopTracking_(i)},function(){return n.stopTracking_(i)}),i}},{key:"stopTracking_",value:function(e){f.remove(this.pending_,e)}}])&&Cl(t.prototype,n),r&&Cl(t,r),e}();function Al(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Ll(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Al(a,r,i,s,o,"next",e)}function o(e){Al(a,r,i,s,o,"throw",e)}s(void 0)})}}function Rl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var xl=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new Il(t),this.store_=n}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"getAll",value:function(){var e=Ll(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.connection_.startReadOnlyOperation(this.store_),n=[],e.next=4,t.forEachEntry(function(e,t){n.push(t)});case 4:return e.next=6,t.promise();case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(e){var t=this.connection_.startReadWriteOperation(this.store_),n=t.store(),r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;n.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return t.promise()}},{key:"remove",value:function(){var e=Ll(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.connection_.startReadWriteOperation(this.store_),e.next=3,n.forEachEntry(function(e,n,r){t.indexOf(n.sessionId)>=0&&r.delete()});case 3:return e.next=5,n.promise();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}])&&Rl(t.prototype,n),r&&Rl(t,r),e}();function Nl(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Ml(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Nl(a,r,i,s,o,"next",e)}function o(e){Nl(a,r,i,s,o,"throw",e)}s(void 0)})}}function Pl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ol=window.shaka,Dl=(window.goog,function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new Il(t),this.segmentStore_=n,this.manifestStore_=r}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"hasFixedKeySpace",value:function(){return!0}},{key:"addSegments",value:function(e){return this.rejectAdd_(this.segmentStore_)}},{key:"removeSegments",value:function(e,t){return this.remove_(this.segmentStore_,e,t)}},{key:"getSegments",value:function(){var t=Ml(regeneratorRuntime.mark(function t(n){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.convertSegmentData_,t.next=3,this.get_(this.segmentStore_,n);case 3:return i=t.sent,t.abrupt("return",i.map(r));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"addManifests",value:function(e){return this.rejectAdd_(this.manifestStore_)}},{key:"updateManifestExpiration",value:function(){var e=Ml(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.connection_.startReadWriteOperation(this.manifestStore_),i=r.store(),a=new A,i.get(t).onsuccess=function(e){var r=e.target.result;r?(window.asserts.assert(r.key==t,"With in-line keys, the keys should match"),r.expiration=n,i.put(r),a.resolve()):a.reject(new Ol.util.Error(Ol.util.Error.Severity.CRITICAL,Ol.util.Error.Category.STORAGE,Ol.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+t))},e.next=6,Promise.all([r.promise(),a]);case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeManifests",value:function(e,t){return this.remove_(this.manifestStore_,e,t)}},{key:"getManifests",value:function(){var t=Ml(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get_(this.manifestStore_,n);case 2:return r=t.sent,t.abrupt("return",r.map(e.convertManifest_));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getAllManifests",value:function(){var t=Ml(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.connection_.startReadOnlyOperation(this.manifestStore_),r=new Map,t.next=4,n.forEachEntry(function(t,n){r.set(t,e.convertManifest_(n))});case 4:return t.next=6,n.promise();case 6:return t.abrupt("return",r);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"rejectAdd_",value:function(e){return Promise.reject(new Ol.util.Error(Ol.util.Error.Severity.CRITICAL,Ol.util.Error.Category.STORAGE,Ol.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+e))}},{key:"remove_",value:function(e,t,n){var r=this.connection_.startReadWriteOperation(e),i=r.store(),a=!0,s=!1,o=void 0;try{for(var l,u=function(){var e=l.value;i.delete(e).onsuccess=function(){return n(e)}},c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)u()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}return r.promise()}},{key:"get_",value:function(){var e=Ml(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.connection_.startReadOnlyOperation(t),i=r.store(),a={},s=[],o=!0,l=!1,u=void 0,e.prev=7,c=function(){var e=h.value;i.get(e).onsuccess=function(t){var n=t.target.result;null==n&&s.push(e),a[e]=n}},d=n[Symbol.iterator]();!(o=(h=d.next()).done);o=!0)c();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(7),l=!0,u=e.t0;case 16:e.prev=16,e.prev=17,o||null==d.return||d.return();case 19:if(e.prev=19,!l){e.next=22;break}throw u;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:if(!s.length){e.next=28;break}throw new Ol.util.Error(Ol.util.Error.Severity.CRITICAL,Ol.util.Error.Category.STORAGE,Ol.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+s);case 28:return e.abrupt("return",n.map(function(e){return a[e]}));case 29:case"end":return e.stop()}},e,this,[[7,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()}],r=[{key:"convertManifest_",value:function(t){return window.asserts.assert(null!=t.originalManifestUri,"Old manifest format should have an originalManifestUri field"),window.asserts.assert(null!=t.duration,"Old manifest format should have a duration field"),window.asserts.assert(null!=t.size,"Old manifest format should have a size field"),window.asserts.assert(null!=t.periods,"Old manifest format should have a periods field"),window.asserts.assert(null!=t.sessionIds,"Old manifest format should have a session ids field"),window.asserts.assert(null!=t.appMetadata,"Old manifest format should have an app metadata field"),{originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:null==t.expiration?1/0:t.expiration,periods:t.periods.map(e.convertPeriod_),sessionIds:t.sessionIds,drmInfo:t.drmInfo,appMetadata:t.appMetadata}}},{key:"convertPeriod_",value:function(t){window.asserts.assert(null!=t.startTime,"Old period format should have a start time field"),window.asserts.assert(null!=t.streams,"Old period format should have a streams field"),e.fillMissingVariants_(t);var n=!0,r=!1,i=void 0;try{for(var a,s=t.streams[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;window.asserts.assert(o.variantIds,"After filling in missing variants, each stream should have variant ids")}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return{startTime:t.startTime,streams:t.streams.map(e.convertStream_)}}},{key:"convertStream_",value:function(t){window.asserts.assert(null!=t.id,"Old stream format should have an id field"),window.asserts.assert(null!=t.primary,"Old stream format should have a primary field"),window.asserts.assert(null!=t.presentationTimeOffset,"Old stream format should have a presentation time offset field"),window.asserts.assert(null!=t.contentType,"Old stream format should have a content type field"),window.asserts.assert(null!=t.mimeType,"Old stream format should have a mime type field"),window.asserts.assert(null!=t.codecs,"Old stream format should have a codecs field"),window.asserts.assert(null!=t.language,"Old stream format should have a language field"),window.asserts.assert(null!=t.encrypted,"Old stream format should have an encrypted field"),window.asserts.assert(null!=t.segments,"Old stream format should have a segments field");var n=t.initSegmentUri?e.getKeyFromSegmentUri_(t.initSegmentUri):null;return{id:t.id,originalId:null,primary:t.primary,presentationTimeOffset:t.presentationTimeOffset,contentType:t.contentType,mimeType:t.mimeType,codecs:t.codecs,frameRate:t.frameRate,kind:t.kind,language:t.language,label:t.label,width:t.width,height:t.height,initSegmentKey:n,encrypted:t.encrypted,keyId:t.keyId,segments:t.segments.map(e.convertSegment_),variantIds:t.variantIds}}},{key:"convertSegment_",value:function(t){window.asserts.assert(null!=t.startTime,"The old segment format should have a start time field"),window.asserts.assert(null!=t.endTime,"The old segment format should have an end time field"),window.asserts.assert(null!=t.uri,"The old segment format should have a uri field");var n=e.getKeyFromSegmentUri_(t.uri);return{startTime:t.startTime,endTime:t.endTime,dataKey:n}}},{key:"convertSegmentData_",value:function(e){return window.asserts.assert(null!=e.key,"The old segment data format should have a key field"),window.asserts.assert(null!=e.data,"The old segment data format should have a data field"),{data:e.data}}},{key:"getKeyFromSegmentUri_",value:function(e){var t=null;if(t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))return Number(t[1]);if(t=/^offline:segment\/([0-9]+)$/.exec(e))return Number(t[1]);throw new Ol.util.Error(Ol.util.Error.Severity.CRITICAL,Ol.util.Error.Category.STORAGE,Ol.util.Error.Code.MALFORMED_OFFLINE_URI,"Could not parse uri "+e)}},{key:"fillMissingVariants_",value:function(e){var t=Re.ContentType.AUDIO,n=Re.ContentType.VIDEO,r=e.streams.filter(function(e){return e.contentType==t}),i=e.streams.filter(function(e){return e.contentType==n});if(!r.every(function(e){return e.variantIds})||!i.every(function(e){return e.variantIds})){window.asserts.assert(r.every(function(e){return!e.variantIds}),"Some audio streams have variant ids and some do not."),window.asserts.assert(i.every(function(e){return!e.variantIds}),"Some video streams have variant ids and some do not.");var a=!0,s=!1,o=void 0;try{for(var l,u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){l.value.variantIds=[]}}catch(e){s=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}var c=!0,d=!1,h=void 0;try{for(var f,p=i[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){f.value.variantIds=[]}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var m=0;if(i.length&&!r.length){Ol.log.debug("Found video-only content. Creating variants for video.");var v=m++,g=!0,y=!1,_=void 0;try{for(var w,E=i[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){w.value.variantIds.push(v)}}catch(e){y=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if(y)throw _}}}if(!i.length&&r.length){Ol.log.debug("Found audio-only content. Creating variants for audio.");var b=m++,S=!0,T=!1,k=void 0;try{for(var C,I=r[Symbol.iterator]();!(S=(C=I.next()).done);S=!0){C.value.variantIds.push(b)}}catch(e){T=!0,k=e}finally{try{S||null==I.return||I.return()}finally{if(T)throw k}}}if(i.length&&r.length){Ol.log.debug("Found audio-video content. Creating variants.");var A=!0,L=!1,R=void 0;try{for(var x,N=r[Symbol.iterator]();!(A=(x=N.next()).done);A=!0){var M=x.value,P=!0,O=!1,D=void 0;try{for(var U,F=i[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value,V=m++;M.variantIds.push(V),B.variantIds.push(V)}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}}}catch(e){L=!0,R=e}finally{try{A||null==N.return||N.return()}finally{if(L)throw R}}}}}}],n&&Pl(t.prototype,n),r&&Pl(t,r),e}());function Ul(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Fl(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ul(a,r,i,s,o,"next",e)}function o(e){Ul(a,r,i,s,o,"throw",e)}s(void 0)})}}function Bl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Vl=window.shaka,Hl=(window.goog,function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new Il(t),this.segmentStore_=n,this.manifestStore_=r,this.isFixedKey_=i}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"hasFixedKeySpace",value:function(){return this.isFixedKey_}},{key:"addSegments",value:function(e){return this.add_(this.segmentStore_,e)}},{key:"removeSegments",value:function(e,t){return this.remove_(this.segmentStore_,e,t)}},{key:"getSegments",value:function(e){return this.get_(this.segmentStore_,e)}},{key:"addManifests",value:function(e){return this.add_(this.manifestStore_,e)}},{key:"updateManifestExpiration",value:function(e,t){var n=this.connection_.startReadWriteOperation(this.manifestStore_),r=n.store();return r.get(e).onsuccess=function(n){var i=n.target.result;i&&(i.expiration=t,r.put(i,e))},n.promise()}},{key:"removeManifests",value:function(e,t){return this.remove_(this.manifestStore_,e,t)}},{key:"getManifests",value:function(e){return this.get_(this.manifestStore_,e)}},{key:"getAllManifests",value:function(){var e=Fl(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.connection_.startReadOnlyOperation(this.manifestStore_),n=new Map,e.next=4,t.forEachEntry(function(e,t){n.set(e,t)});case 4:return e.next=6,t.promise();case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"add_",value:function(){var e=Fl(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFixedKey_){e.next=2;break}throw new Vl.util.Error(Vl.util.Error.Severity.CRITICAL,Vl.util.Error.Category.STORAGE,Vl.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+t);case 2:for(r=this.connection_.startReadWriteOperation(t),i=r.store(),a=[],s=!0,o=!1,l=void 0,e.prev=8,u=n[Symbol.iterator]();!(s=(c=u.next()).done);s=!0)d=c.value,i.add(d).onsuccess=function(e){var t=e.target.result;a.push(t)};e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,l=e.t0;case 16:e.prev=16,e.prev=17,s||null==u.return||u.return();case 19:if(e.prev=19,!o){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:return e.abrupt("return",a);case 27:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"remove_",value:function(e,t,n){var r=this.connection_.startReadWriteOperation(e),i=r.store(),a=!0,s=!1,o=void 0;try{for(var l,u=function(){var e=l.value;i.delete(e).onsuccess=function(){return n(e)}},c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)u()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}return r.promise()}},{key:"get_",value:function(){var e=Fl(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,l,u,c,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.connection_.startReadOnlyOperation(t),i=r.store(),a={},s=[],o=!0,l=!1,u=void 0,e.prev=7,c=function(){var e=h.value,t=i.get(e);t.onsuccess=function(){null==t.result&&s.push(e),a[e]=t.result}},d=n[Symbol.iterator]();!(o=(h=d.next()).done);o=!0)c();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(7),l=!0,u=e.t0;case 16:e.prev=16,e.prev=17,o||null==d.return||d.return();case 19:if(e.prev=19,!l){e.next=22;break}throw u;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:if(!s.length){e.next=28;break}throw new Vl.util.Error(Vl.util.Error.Severity.CRITICAL,Vl.util.Error.Category.STORAGE,Vl.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+s);case 28:return e.abrupt("return",n.map(function(e){return a[e]}));case 29:case"end":return e.stop()}},e,this,[[7,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()}])&&Bl(t.prototype,n),r&&Bl(t,r),e}());function Gl(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function jl(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Gl(a,r,i,s,o,"next",e)}function o(e){Gl(a,r,i,s,o,"throw",e)}s(void 0)})}}function Kl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wl=window.shaka,ql=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.db_=null,this.v1_=null,this.v2_=null,this.v3_=null,this.sessions_=null}var t,n,r;return t=e,n=[{key:"init",value:function(){var t=this,n=e.DB_NAME,r=e.VERSION,i=new A,a=window.indexedDB.open(n,r);return a.onsuccess=function(n){var r=n.target.result;t.db_=r,t.v1_=e.createV1_(r),t.v2_=e.createV2_(r),t.v3_=e.createV3_(r),t.sessions_=e.createEmeSession_(r),i.resolve()},a.onupgradeneeded=function(e){t.createStores_(e.target.result)},a.onerror=function(e){i.reject(new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.INDEXED_DB_ERROR,a.error)),e.preventDefault()},i}},{key:"destroy",value:function(){var e=jl(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.v1_){e.next=3;break}return e.next=3,this.v1_.destroy();case 3:if(!this.v2_){e.next=6;break}return e.next=6,this.v2_.destroy();case 6:if(!this.v3_){e.next=9;break}return e.next=9,this.v3_.destroy();case 9:if(!this.sessions_){e.next=12;break}return e.next=12,this.sessions_.destroy();case 12:this.db_&&this.db_.close();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getCells",value:function(){var e=new Map;return this.v1_&&e.set("v1",this.v1_),this.v2_&&e.set("v2",this.v2_),this.v3_&&e.set("v3",this.v3_),e}},{key:"getEmeSessionCell",value:function(){return window.asserts.assert(this.sessions_,"Cannot be destroyed."),this.sessions_}},{key:"erase",value:function(){var t=jl(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.v1_){t.next=3;break}return t.next=3,this.v1_.destroy();case 3:if(!this.v2_){t.next=6;break}return t.next=6,this.v2_.destroy();case 6:if(!this.v3_){t.next=9;break}return t.next=9,this.v3_.destroy();case 9:return this.db_&&this.db_.close(),t.next=12,e.deleteAll_();case 12:return this.db_=null,this.v1_=null,this.v2_=null,this.v3_=null,t.next=18,this.init();case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createStores_",value:function(t){for(var n=0,r=[e.V3_SEGMENT_STORE,e.V3_MANIFEST_STORE,e.SESSION_ID_STORE];n<r.length;n++){var i=r[n];t.objectStoreNames.contains(i)||t.createObjectStore(i,{autoIncrement:!0})}}}],r=[{key:"createV1_",value:function(t){var n=e.V1_SEGMENT_STORE,r=e.V1_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Wl.log.debug("Mounting v1 idb storage cell"),new Dl(t,n,r)):null}},{key:"createV2_",value:function(t){var n=e.V2_SEGMENT_STORE,r=e.V2_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Wl.log.debug("Mounting v2 idb storage cell"),new Hl(t,n,r,!0)):null}},{key:"createV3_",value:function(t){var n=e.V3_SEGMENT_STORE,r=e.V3_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Wl.log.debug("Mounting v3 idb storage cell"),new Hl(t,n,r,!1)):null}},{key:"createEmeSession_",value:function(t){var n=e.SESSION_ID_STORE;return t.objectStoreNames.contains(n)?(Wl.log.debug("Mounting session ID idb storage cell"),new xl(t,n)):null}},{key:"deleteAll_",value:function(){var t=e.DB_NAME,n=new A,r=window.indexedDB.deleteDatabase(t);return r.onblocked=function(e){Wl.log.warning("Deleting",t,"is being blocked")},r.onsuccess=function(e){n.resolve()},r.onerror=function(e){n.reject(new M(M.Severity.CRITICAL,M.Category.STORAGE,M.Code.INDEXED_DB_ERROR,r.error)),e.preventDefault()},n}}],n&&Kl(t.prototype,n),r&&Kl(t,r),e}());ql.DB_NAME="shaka_offline_db",ql.VERSION=4,ql.V1_SEGMENT_STORE="segment",ql.V2_SEGMENT_STORE="segment-v2",ql.V3_SEGMENT_STORE="segment-v3",ql.V1_MANIFEST_STORE="manifest",ql.V2_MANIFEST_STORE="manifest-v2",ql.V3_MANIFEST_STORE="manifest-v3",ql.SESSION_ID_STORE="session-ids",dr.register("idb",function(){return window.indexedDB?new ql:null});function zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Yl=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=[],(n="polyfills_")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,r=[{key:"installAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.polyfills_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.callback()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"register",value:function(e,t){for(var n={priority:t=t||0,callback:e},r=0;r<this.polyfills_.length;r++)if(this.polyfills_[r].priority<t)return void this.polyfills_.splice(r,0,n);this.polyfills_.push(n)}}],(n=null)&&zl(t.prototype,n),r&&zl(t,r),e}();Yl.polyfills_=[];var Xl=Yl;function $l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Ql=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled}}));var n=e.proxyEvent_;document.addEventListener("webkitfullscreenchange",n),document.addEventListener("webkitfullscreenerror",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("mozfullscreenerror",n),document.addEventListener("MSFullscreenChange",n),document.addEventListener("MSFullscreenError",n)}}},{key:"proxyEvent_",value:function(e){var t,n=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?t=new Event(n,e):(t=document.createEvent("Event")).initEvent(n,e.bubbles,e.cancelable),e.target.dispatchEvent(t)}}],(n=null)&&$l(t.prototype,n),r&&$l(t,r),e}();function Zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Xl.register(Ql.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Jl=window.shaka,eu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){Jl.log.debug("IndexedDB.install"),Ft.isChromecast()&&(Jl.log.debug("Removing IndexedDB from ChromeCast"),delete window.indexedDB,window.asserts.assert(!window.indexedDB,"Failed to override window.indexedDB"))}}],(n=null)&&Zl(t.prototype,n),r&&Zl(t,r),e}();function tu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Xl.register(eu.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nu=window.shaka,ru=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){nu.log.debug("InputEvent.install"),Ft.isIE()&&(HTMLInputElement.prototype.originalAddEventListener||(nu.log.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=nu.polyfill.InputEvent.addEventListener_))}},{key:"addEventListener_",value:function(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}}],(n=null)&&tu(t.prototype,n),r&&tu(t,r),e}();function iu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Xl.register(ru.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var au=window.shaka,su=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){au.log.debug("mathRound.install");var t=e.MAX_ACCURATE_INPUT_+1;if(Math.round(t)!=t){au.log.debug("polyfill Math.round");var n=Math.round;Math.round=function(t){var r=t;return t<=e.MAX_ACCURATE_INPUT_&&(r=n(t)),r}}}}],(n=null)&&iu(t.prototype,n),r&&iu(t,r),e}();function ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}su.MAX_ACCURATE_INPUT_=4503599627370496,Xl.register(su.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var lu=window.shaka,uu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(lu.log.debug("MediaSource.install"),window.MediaSource)if(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType)lu.log.info("Patching Chromecast MSE bugs."),e.patchCastIsTypeSupported_();else if(Ft.isApple()){var t=navigator.appVersion;Xl.MediaSource.rejectTsContent_(),t.includes("Version/8")?(lu.log.info("Blacklisting Safari 8 MSE."),Xl.MediaSource.blacklist_()):t.includes("Version/9")?(lu.log.info("Patching Safari 9 MSE bugs."),Xl.MediaSource.stubAbort_()):t.includes("Version/10")?(lu.log.info("Patching Safari 10 MSE bugs."),Xl.MediaSource.stubAbort_(),Xl.MediaSource.patchEndOfStreamEvents_()):(t.includes("Version/11")||t.includes("Version/12"))&&(lu.log.info("Patching Safari 11/12 MSE bugs."),Xl.MediaSource.stubAbort_(),Xl.MediaSource.patchRemovalRange_())}else Ft.isTizen()?Xl.MediaSource.rejectCodec_("opus"):lu.log.info("Using native MSE as-is.");else lu.log.info("No MSE implementation available.")}},{key:"blacklist_",value:function(){window.MediaSource=null}},{key:"stubAbort_",value:function(){var t=e.prototype.addSourceBuffer;e.prototype.addSourceBuffer=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t.apply(this,n);return i.abort=function(){},i}}},{key:"patchRemovalRange_",value:function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}},{key:"patchEndOfStreamEvents_",value:function(){var t=e.prototype.endOfStream;e.prototype.endOfStream=function(){var e=0,n=!0,r=!1,i=void 0;try{for(var a,s=(this.sourceBuffers||[])[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,l=o.buffered.end(o.buffered.length-1);e=Math.max(e,l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(!isNaN(this.duration)&&e<this.duration){this.ignoreUpdateEnd_=!0;var u=!0,c=!1,d=void 0;try{for(var h,f=(this.sourceBuffers||[])[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){h.value.eventSuppressed_=!1}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}for(var p=arguments.length,m=new Array(p),v=0;v<p;v++)m[v]=arguments[v];return t.apply(this,m)};var n=!1,r=e.prototype.addSourceBuffer;e.prototype.addSourceBuffer=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var s=r.apply(this,i);return s.mediaSource_=this,s.addEventListener("updateend",e.ignoreUpdateEnd_,!1),n||(this.addEventListener("sourceclose",e.cleanUpListeners_,!1),n=!0),s}}},{key:"ignoreUpdateEnd_",value:function(e){var t=e.target,n=t.mediaSource_;if(n.ignoreUpdateEnd_){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.eventSuppressed_=!0;var r=!0,i=!1,a=void 0;try{for(var s,o=n.sourceBuffers[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){if(0==s.value.eventSuppressed_)return}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}n.ignoreUpdateEnd_=!1}}},{key:"cleanUpListeners_",value:function(t){var n=t.target,r=!0,i=!1,a=void 0;try{for(var s,o=(n.sourceBuffers||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.removeEventListener("updateend",e.ignoreUpdateEnd_,!1)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}n.removeEventListener("sourceclose",e.cleanUpListeners_,!1)}},{key:"rejectTsContent_",value:function(){var t=e.isTypeSupported;e.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1]&&t(e)}}},{key:"rejectCodec_",value:function(t){var n=e.isTypeSupported;e.isTypeSupported=function(e){return Ot.getCodecBase(e)!=t&&n(e)}}},{key:"patchCastIsTypeSupported_",value:function(){var t=e.isTypeSupported,n=/^dv(?:h[e1]|a[v1])\./;e.isTypeSupported=function(e){for(var r=e.split(/ *; */),i=r[0],a={},s=1;s<r.length;++s){var o=r[s].split("="),l=o[0],u=o[1].replace(/"(.*)"/,"$1");a[l]=u}var c=a.codecs;if(!c)return t(e);var d=!1,h=!1,f=c.split(",").filter(function(e){return n.test(e)&&(h=!0),/^(hev|hvc)1\.2/.test(e)&&(d=!0),!0});h&&(d=!1),a.codecs=f.join(","),d&&(a.eotf="smpte2084");var p=i;for(var m in a){p+="; "+m+'="'+a[m]+'"'}return cast.__platform__.canDisplayType(p)}}}],(n=null)&&ou(t.prototype,n),r&&ou(t,r),e}();function cu(e){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function du(e,t){return!t||"object"!==cu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hu(e){return(hu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fu(e,t){return(fu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vu(e,t,n){return t&&mu(e.prototype,t),n&&mu(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xl.register(uu.install);var gu=window.shaka,yu=window.goog,_u=function(){function e(){pu(this,e)}return vu(e,null,[{key:"install",value:function(){if(window.HTMLVideoElement&&window.WebKitMediaKeys){gu.log.info("Using Apple-prefixed EME");var e=gu.polyfill.PatchedMediaKeysApple;e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess}}},{key:"requestMediaKeySystemAccess",value:function(e,t){gu.log.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var n=gu.polyfill.PatchedMediaKeysApple;try{var r=new n.MediaKeySystemAccess(e,t);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"setMediaKeys",value:function(e){gu.log.debug("PatchedMediaKeysApple.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=gu.polyfill.PatchedMediaKeysApple,n=e,r=this.mediaKeys;return r&&r!=n&&(window.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,this.mediaKeys=e,n?(window.asserts.assert(n instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),n.setMedia(this)):Promise.resolve()}},{key:"rebuildInitData_",value:function(e,t){var n=new Uint8Array(e);if(new DataView(n.buffer).getUint32(0,!0)+4!=n.byteLength)throw new Error("Malformed init data!");var r=Gt.fromUTF16(n.slice(4),!0),i=new yu.Uri(r).getDomain(),a=new Uint8Array(Gt.toUTF16(i,!0)),s=new Uint8Array(n.byteLength+4+a.byteLength+4+t.byteLength),o=0,l=function(e){s.set(e,o),o+=e.byteLength},u=function(e){var t=new DataView(s.buffer),n=e.byteLength;t.setUint32(o,n,!0),o+=4,l(e)};return l(n),u(a),u(new Uint8Array(t)),s}},{key:"onWebkitNeedKey_",value:function(e){gu.log.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e);var t=gu.polyfill.PatchedMediaKeysApple,n=this.mediaKeys;window.asserts.assert(n instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),window.asserts.assert(null!=e.initData,"missing init data!");var r=n.certificate;window.asserts.assert(null!=r,"missing certificate!");var i=new Event("encrypted");i.initDataType="cenc",i.initData=t.rebuildInitData_(e.initData,r),this.dispatchEvent(i)}}]),e}();function wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}_u.MediaKeySystemAccess=function(){function e(t,n){if(pu(this,e),gu.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=t,this.configuration_,t.startsWith("com.apple.fps")){var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=this.checkConfig_(l);if(u)return void(this.configuration_=u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}var c=new Error("Unsupported keySystem");throw c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}return vu(e,[{key:"checkConfig_",value:function(e){if("required"==e.persistentState)return null;var t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},n=!1,r=!1;if(e.audioCapabilities){var i=!0,a=!1,s=void 0;try{for(var o,l=e.audioCapabilities[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;if(u.contentType){n=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(t.audioCapabilities.push(u),r=!0)}}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}}if(e.videoCapabilities){var d=!0,h=!1,f=void 0;try{for(var p,m=e.videoCapabilities[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v.contentType){n=!0;var g=v.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,g)&&(t.videoCapabilities.push(v),r=!0)}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}return n||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r?t:null}},{key:"createMediaKeys",value:function(){gu.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new gu.polyfill.PatchedMediaKeysApple.MediaKeys(this.keySystem);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return gu.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.configuration_}}]),e}(),_u.MediaKeys=function(){function e(t){pu(this,e),gu.log.debug("PatchedMediaKeysApple.MediaKeys"),this.nativeMediaKeys_=new WebKitMediaKeys(t),this.eventManager_=new Ke,this.certificate=null}return vu(e,[{key:"createSession",value:function(e){if(gu.log.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new gu.polyfill.PatchedMediaKeysApple.MediaKeySession(this.nativeMediaKeys_,e)}},{key:"setServerCertificate",value:function(e){return gu.log.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),this.certificate=e?new Uint8Array(e):null,Promise.resolve(!0)}},{key:"setMedia",value:function(e){var t=this,n=gu.polyfill.PatchedMediaKeysApple;if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"webkitneedkey",n.onWebkitNeedKey_);try{return e.readyState>=1?e.webkitSetMediaKeys(this.nativeMediaKeys_):this.eventManager_.listenOnce(e,"loadedmetadata",function(){e.webkitSetMediaKeys(t.nativeMediaKeys_)}),Promise.resolve()}catch(e){return Promise.reject(e)}}}]),e}(),_u.MediaKeySession=function(e){function t(e,n){var r;return pu(this,t),gu.log.debug("PatchedMediaKeysApple.MediaKeySession"),(r=du(this,hu(t).call(this))).nativeMediaKeySession_=null,r.nativeMediaKeys_=e,r.generateRequestPromise_=null,r.updatePromise_=null,r.eventManager_=new Ke,r.sessionId="",r.expiration=NaN,r.closed=new A,r.keyStatuses=new gu.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fu(e,t)}(t,C),vu(t,[{key:"generateRequest",value:function(e,t){var n=this;gu.log.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.generateRequestPromise_=new A;try{var r=this.nativeMediaKeys_.createSession("video/mp4",new Uint8Array(t));this.nativeMediaKeySession_=r,this.eventManager_.listen(this.nativeMediaKeySession_,"webkitkeymessage",function(e){return n.onWebkitKeyMessage_(e)}),this.eventManager_.listen(r,"webkitkeyadded",function(e){return n.onWebkitKeyAdded_(e)}),this.eventManager_.listen(r,"webkitkeyerror",function(e){return n.onWebkitKeyError_(e)}),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_}},{key:"load",value:function(){return gu.log.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(new Error("MediaKeySession.load not yet supported"))}},{key:"update",value:function(e){gu.log.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.updatePromise_=new A;try{this.nativeMediaKeySession_.update(new Uint8Array(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_}},{key:"close",value:function(){gu.log.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed}},{key:"remove",value:function(){return gu.log.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(new Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))}},{key:"onWebkitKeyMessage_",value:function(e){gu.log.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),window.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ should be set before now!"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus(),n=new w("message",{messageType:t?"license-request":"license-renewal",message:e.message.buffer});this.dispatchEvent(n)}},{key:"onWebkitKeyAdded_",value:function(e){gu.log.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),window.asserts.assert(!this.generateRequestPromise_,"Key added during generate!"),window.asserts.assert(this.updatePromise_,"updatePromise_ should be set before now!"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)}},{key:"onWebkitKeyError_",value:function(e){gu.log.debug("PatchedMediaKeysApple.onWebkitKeyError_",e);var t=new Error("EME PatchedMediaKeysApple key error");if(t.errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(t),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(t),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new w("keystatuseschange");this.dispatchEvent(t)}}]),t}(),_u.MediaKeyStatusMap=function(){function e(){pu(this,e),this.size=0,this.status_=void 0}return vu(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=gu.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=_u.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!Kt.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}}]),e}(),_u.MediaKeyStatusMap.KEY_ID_,Xl.register(_u.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Eu=window.shaka,bu=(window.goog,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.systemIds=[],this.cencKeyIds=[],this.dataBoundaries=[],(new Ki).fullBox("pssh",function(e){return n.parseBox_(e)}).parse(t.buffer),0==this.dataBoundaries.length&&Eu.log.warning("No pssh box found!")}var t,n,r;return t=e,(n=[{key:"parseBox_",value:function(e){var t;if(window.asserts.assert(null!=e.version,"PSSH boxes are full boxes and must have a valid version"),window.asserts.assert(null!=e.flags,"PSSH boxes are full boxes and must have a valid flag"),e.version>1)Eu.log.warning("Unrecognized PSSH version found!");else{var n=Kt.toHex(e.reader.readBytes(16)),r=[];if(e.version>0)for(var i=e.reader.readUint32(),a=0;a<i;++a){var s=Kt.toHex(e.reader.readBytes(16));r.push(s)}var o=e.reader.readUint32();e.reader.skip(o),(t=this.cencKeyIds).push.apply(t,r),this.systemIds.push(n),this.dataBoundaries.push({start:e.start,end:e.start+e.size-1}),e.reader.getPosition()!=e.reader.getLength()&&Eu.log.warning("Mismatch between box size and data size!")}}}])&&wu(t.prototype,n),r&&wu(t,r),e}());function Su(e){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tu(e,t){return!t||"object"!==Su(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ku(e){return(ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cu(e,t){return(Cu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Iu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lu(e,t,n){return t&&Au(e.prototype,t),n&&Au(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ru=window.shaka,xu=(window.goog,function(){function e(){Iu(this,e)}return Lu(e,null,[{key:"install",value:function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Ru.log.info("Using ms-prefixed EME v20140218"),e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,HTMLMediaElement.prototype.setMediaKeys=e.MediaKeySystemAccess.setMediaKeys)}},{key:"requestMediaKeySystemAccess",value:function(t,n){Ru.log.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');try{var r=new e.MediaKeySystemAccess(t,n);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"onMsNeedKey_",value:function(t){if(Ru.log.debug("PatchedMediaKeysMs.onMsNeedKey_",t),t.initData){var n=document.createEvent("CustomEvent");n.initCustomEvent("encrypted",!1,!1,null),n.initDataType="cenc",n.initData=e.normaliseInitData_(t.initData),this.dispatchEvent(n)}}},{key:"normaliseInitData_",value:function(e){if(!e)return e;var t=new bu(e);if(t.dataBoundaries.length<=1)return e;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t.dataBoundaries[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value,u=e.subarray(l.start,l.end+1);n.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}for(var c=[],d=function(){var e=f[h];c.some(function(t){return Kt.equal(t,e)})||c.push(e)},h=0,f=n;h<f.length;h++)d();for(var p=0,m=0,v=c;m<v.length;m++){p+=v[m].length}for(var g=new Uint8Array(p),y=0,_=0,w=c;_<w.length;_++){var E=w[_];g.set(E,y),y+=E.length}return g}}]),e}());function Nu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pu(e,t,n){return t&&Mu(e.prototype,t),n&&Mu(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xu.MediaKeySystemAccess=function(){function e(t,n){Iu(this,e),Ru.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=t,this.configuration_;var r=!1,i=!0,a=!1,s=void 0;try{for(var o,l=n[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value,c={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:u.initDataTypes,sessionTypes:["temporary"],label:u.label},d=!1;if(u.audioCapabilities){var h=!0,f=!1,p=void 0;try{for(var m,v=u.audioCapabilities[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;if(g.contentType){d=!0;var y=g.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,y)&&(c.audioCapabilities.push(g),r=!0)}}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}if(u.videoCapabilities){var _=!0,w=!1,E=void 0;try{for(var b,S=u.videoCapabilities[Symbol.iterator]();!(_=(b=S.next()).done);_=!0){var T=b.value;if(T.contentType){d=!0;var k=T.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,k)&&(c.videoCapabilities.push(T),r=!0)}}}catch(e){w=!0,E=e}finally{try{_||null==S.return||S.return()}finally{if(w)throw E}}}if(d||(r=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==u.persistentState&&(r=!1),r)return void(this.configuration_=c)}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}var C=new Error("Unsupported keySystem");throw C.name="NotSupportedError",C.code=DOMException.NOT_SUPPORTED_ERR,C}return Lu(e,[{key:"createMediaKeys",value:function(){Ru.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new xu.MediaKeys(this.keySystem);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return Ru.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.configuration_}}],[{key:"setMediaKeys",value:function(e){Ru.log.debug("PatchedMediaKeysMs.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=e,n=this.mediaKeys;return n&&n!=t&&(window.asserts.assert(n instanceof xu.MediaKeys,"non-polyfill instance of oldMediaKeys"),n.setMedia(null)),delete this.mediaKeys,this.mediaKeys=e,t?(window.asserts.assert(t instanceof xu.MediaKeys,"non-polyfill instance of newMediaKeys"),t.setMedia(this)):Promise.resolve()}}]),e}(),xu.MediaKeys=function(){function e(t){Iu(this,e),Ru.log.debug("PatchedMediaKeysMs.MediaKeys"),this.nativeMediaKeys_=new MSMediaKeys(t),this.eventManager_=new Ke}return Lu(e,[{key:"createSession",value:function(e){if(Ru.log.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new xu.MediaKeySession(this.nativeMediaKeys_,e)}},{key:"setServerCertificate",value:function(e){return Ru.log.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)}},{key:"setMedia",value:function(e){if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"msneedkey",xu.onMsNeedKey_);var t=this;try{return e.readyState>=1?e.msSetMediaKeys(this.nativeMediaKeys_):e.addEventListener("loadedmetadata",function n(){e.msSetMediaKeys(t.nativeMediaKeys_),e.removeEventListener("loadedmetadata",n)}),Promise.resolve()}catch(e){return Promise.reject(e)}}}]),e}(),xu.MediaKeySession=function(e){function t(e,n){var r;return Iu(this,t),Ru.log.debug("PatchedMediaKeysMs.MediaKeySession"),(r=Tu(this,ku(t).call(this))).nativeMediaKeySession_=null,r.nativeMediaKeys_=e,r.generateRequestPromise_=null,r.updatePromise_=null,r.eventManager_=new Ke,r.sessionId="",r.expiration=NaN,r.closed=new Ru.util.PublicPromise,r.keyStatuses=new xu.MediaKeyStatusMap,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cu(e,t)}(t,C),Lu(t,[{key:"generateRequest",value:function(e,t){var n=this;Ru.log.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.generateRequestPromise_=new Ru.util.PublicPromise;try{this.nativeMediaKeySession_=this.nativeMediaKeys_.createSession("video/mp4",new Uint8Array(t),null),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeymessage",function(e){return n.onMsKeyMessage_(e)}),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeyadded",function(e){return n.onMsKeyAdded_(e)}),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeyerror",function(e){return n.onMsKeyError_(e)}),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_}},{key:"load",value:function(){return Ru.log.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(new Error("MediaKeySession.load not yet supported"))}},{key:"update",value:function(e){Ru.log.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.updatePromise_=new A;try{this.nativeMediaKeySession_.update(new Uint8Array(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_}},{key:"close",value:function(){Ru.log.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed}},{key:"remove",value:function(){return Ru.log.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(new Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))}},{key:"onMsKeyMessage_",value:function(e){Ru.log.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),window.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ not set in onMsKeyMessage_"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus(),n=new w("message",{messageType:t?"license-request":"license-renewal",message:e.message.buffer});this.dispatchEvent(n)}},{key:"onMsKeyAdded_",value:function(e){if(Ru.log.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.generateRequestPromise_)return Ru.log.debug("Simulating completion for a PR persistent license."),window.asserts.assert(!this.updatePromise_,"updatePromise_ and generateRequestPromise_ set in onMsKeyAdded_"),this.updateKeyStatus_("usable"),this.generateRequestPromise_.resolve(),void(this.generateRequestPromise_=null);window.asserts.assert(this.updatePromise_,"updatePromise_ not set in onMsKeyAdded_"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)}},{key:"onMsKeyError_",value:function(e){Ru.log.debug("PatchedMediaKeysMs.onMsKeyError_",e);var t=new Error("EME PatchedMediaKeysMs key error");if(t.errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(t),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(t),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new w("keystatuseschange");this.dispatchEvent(t)}}]),t}(),xu.MediaKeyStatusMap=function(){function e(){Iu(this,e),this.size=0,this.status_=void 0}return Lu(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=Ru.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=xu.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!Kt.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}}]),e}(),xu.MediaKeyStatusMap.KEY_ID_,Xl.register(xu.install);var Ou=window.shaka,Du=(window.goog,function(){function e(){Nu(this,e)}return Pu(e,null,[{key:"install",value:function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){Ou.log.info("EME not available.");var e=Ou.polyfill.PatchedMediaKeysNop;navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess}}},{key:"requestMediaKeySystemAccess",value:function(e,t){return Ou.log.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess'),Promise.reject(new Error("The key system specified is not supported."))}},{key:"setMediaKeys",value:function(e){return Ou.log.debug("PatchedMediaKeysNop.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys'),null==e?Promise.resolve():Promise.reject(new Error("MediaKeys not supported."))}}]),e}());Du.MediaKeys=function(){function e(){throw Nu(this,e),new TypeError("Illegal constructor.")}return Pu(e,[{key:"createSession",value:function(){}},{key:"setServerCertificate",value:function(){}}]),e}(),Du.MediaKeySystemAccess=function(){function e(){throw Nu(this,e),this.keySystem="",new TypeError("Illegal constructor.")}return Pu(e,[{key:"getConfiguration",value:function(){}},{key:"createMediaKeys",value:function(){}}]),e}(),Xl.register(Du.install,-10);function Uu(e){return(Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fu(e,t){return!t||"object"!==Uu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bu(e){return(Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vu(e,t){return(Vu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ju(e,t,n){return t&&Gu(e.prototype,t),n&&Gu(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ku=window.shaka,Wu=(window.goog,function(){function e(){Hu(this,e)}return ju(e,null,[{key:"install",value:function(){var t=e.prefixApi_;if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Ku.log.info("Using webkit-prefixed EME v0.1b"),e.prefix_="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;Ku.log.info("Using nonprefixed EME v0.1b")}window.asserts.assert(HTMLMediaElement.prototype[t("generateKeyRequest")],"PatchedMediaKeysWebkit APIs not available!"),e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess}}},{key:"prefixApi_",value:function(t){var n=e.prefix_;return n?n+t.charAt(0).toUpperCase()+t.slice(1):t}},{key:"requestMediaKeySystemAccess",value:function(t,n){Ku.log.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');try{var r=new e.MediaKeySystemAccess(t,n);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"setMediaKeys",value:function(t){Ku.log.debug("PatchedMediaKeysWebkit.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var n=t,r=this.mediaKeys;return r&&r!=n&&(window.asserts.assert(r instanceof e.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,this.mediaKeys=t,n&&(window.asserts.assert(n instanceof e.MediaKeys,"non-polyfill instance of newMediaKeys"),n.setMedia(this)),Promise.resolve()}},{key:"getVideoElement_",value:function(){var e=document.getElementsByTagName("video");return e.length?e[0]:document.createElement("video")}}]),e}());Wu.MediaKeySystemAccess=function(){function e(t,n){Hu(this,e),Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.keySystem=t,this.internalKeySystem_=t,this.configuration_;var r=!1;"org.w3.clearkey"==t&&(this.internalKeySystem_="webkit-org.w3.clearkey",r=!1);var i=!1,a=Wu.getVideoElement_(),s=!0,o=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value,h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:d.initDataTypes,sessionTypes:["temporary"],label:d.label},f=!1;if(d.audioCapabilities){var p=!0,m=!1,v=void 0;try{for(var g,y=d.audioCapabilities[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value;if(_.contentType){f=!0;var w=_.contentType.split(";")[0];a.canPlayType(w,this.internalKeySystem_)&&(h.audioCapabilities.push(_),i=!0)}}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}if(d.videoCapabilities){var E=!0,b=!1,S=void 0;try{for(var T,k=d.videoCapabilities[Symbol.iterator]();!(E=(T=k.next()).done);E=!0){var C=T.value;C.contentType&&(f=!0,a.canPlayType(C.contentType,this.internalKeySystem_)&&(h.videoCapabilities.push(C),i=!0))}}catch(e){b=!0,S=e}finally{try{E||null==k.return||k.return()}finally{if(b)throw S}}}if(f||(i=a.canPlayType("video/mp4",this.internalKeySystem_)||a.canPlayType("video/webm",this.internalKeySystem_)),"required"==d.persistentState&&(r?(h.persistentState="required",h.sessionTypes=["persistent-license"]):i=!1),i)return void(this.configuration_=h)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}var I="Unsupported keySystem";"org.w3.clearkey"!=t&&"com.widevine.alpha"!=t||(I="None of the requested configurations were supported.");var A=new Error(I);throw A.name="NotSupportedError",A.code=DOMException.NOT_SUPPORTED_ERR,A}return ju(e,[{key:"createMediaKeys",value:function(){Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new Wu.MediaKeys(this.internalKeySystem_);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.configuration_}}]),e}(),Wu.MediaKeys=function(){function e(t){Hu(this,e),Ku.log.debug("PatchedMediaKeysWebkit.MediaKeys"),this.keySystem_=t,this.media_=null,this.eventManager_=new Ke,this.newSessions_=[],this.sessionMap_=new Map}return ju(e,[{key:"setMedia",value:function(e){var t=this;this.media_=e,this.eventManager_.removeAll();var n=Wu.prefix_;e&&(this.eventManager_.listen(e,n+"needkey",function(e){return t.onWebkitNeedKey_(e)}),this.eventManager_.listen(e,n+"keymessage",function(e){return t.onWebkitKeyMessage_(e)}),this.eventManager_.listen(e,n+"keyadded",function(e){return t.onWebkitKeyAdded_(e)}),this.eventManager_.listen(e,n+"keyerror",function(e){return t.onWebkitKeyError_(e)}))}},{key:"createSession",value:function(e){if(Ku.log.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.media_||document.createElement("video");t.src||(t.src="about:blank");var n=new Wu.MediaKeySession(t,this.keySystem_,e);return this.newSessions_.push(n),n}},{key:"setServerCertificate",value:function(e){return Ku.log.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)}},{key:"onWebkitNeedKey_",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e),window.asserts.assert(this.media_,"media_ not set in onWebkitNeedKey_");var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.media_.dispatchEvent(t)}},{key:"onWebkitKeyMessage_",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=this.findSession_(e.sessionId);if(t){var n=null==t.keyStatuses.getStatus(),r=new Ku.util.FakeEvent("message",{messageType:n?"licenserequest":"licenserenewal",message:e.message});t.generated(),t.dispatchEvent(r)}else Ku.log.error("Session not found",e.sessionId)}},{key:"onWebkitKeyAdded_",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e);var t=this.findSession_(e.sessionId);window.asserts.assert(t,"unable to find session in onWebkitKeyAdded_"),t&&t.ready()}},{key:"onWebkitKeyError_",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=this.findSession_(e.sessionId);window.asserts.assert(t,"unable to find session in onWebkitKeyError_"),t&&t.handleError(e)}},{key:"findSession_",value:function(e){var t=this.sessionMap_.get(e);return t?(Ku.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):(t=this.newSessions_.shift())?(t.sessionId=e,this.sessionMap_.set(e,t),Ku.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):null}}]),e}(),Wu.MediaKeySession=function(e){function t(e,n,r){var i;return Hu(this,t),Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession"),(i=Fu(this,Bu(t).call(this))).media_=e,i.initialized_=!1,i.generatePromise_=null,i.updatePromise_=null,i.keySystem_=n,i.type_=r,i.sessionId="",i.expiration=NaN,i.closed=new A,i.keyStatuses=new Wu.MediaKeyStatusMap,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vu(e,t)}(t,C),ju(t,[{key:"generated",value:function(){Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),this.generatePromise_&&(this.generatePromise_.resolve(),this.generatePromise_=null)}},{key:"ready",value:function(){Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),this.updateKeyStatus_("usable"),this.updatePromise_&&this.updatePromise_.resolve(),this.updatePromise_=null}},{key:"handleError",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=new Error("EME v0.1b key error");if(t.errorCode=e.errorCode,t.errorCode.systemCode=e.systemCode,!e.sessionId&&this.generatePromise_)t.method="generateRequest",45==e.systemCode&&(t.message="Unsupported session type."),this.generatePromise_.reject(t),this.generatePromise_=null;else if(e.sessionId&&this.updatePromise_)t.method="update",this.updatePromise_.reject(t),this.updatePromise_=null;else{var n=e.errorCode.code,r=e.systemCode;n==MediaKeyError.MEDIA_KEYERR_OUTPUT?this.updateKeyStatus_("output-restricted"):1==r?this.updateKeyStatus_("expired"):this.updateKeyStatus_("internal-error")}}},{key:"generate_",value:function(e,t){var n,r=this;if(this.initialized_){var i=new Error("The session is already initialized.");return Promise.reject(i)}this.initialized_=!0;try{if("persistent-license"==this.type_){var a=Ku.util.StringUtils;if(t)n=new Uint8Array(a.toUTF8("LOAD_SESSION|"+t));else{var s=a.toUTF8("PERSISTENT|"),o=new Uint8Array(s.byteLength+e.byteLength);o.set(new Uint8Array(s),0),o.set(new Uint8Array(e),s.byteLength),n=o}}else window.asserts.assert("temporary"==this.type_,"expected temporary session"),window.asserts.assert(!t,"unexpected offline session ID"),n=new Uint8Array(e);window.asserts.assert(n,"init data not set!")}catch(e){return Promise.reject(e)}window.asserts.assert(null==this.generatePromise_,"generatePromise_ should be null"),this.generatePromise_=new A;var l=(0,Ku.polyfill.PatchedMediaKeysWebkit.prefixApi_)("generateKeyRequest");try{this.media_[l](this.keySystem_,n)}catch(e){if("InvalidStateError"!=e.name)return this.generatePromise_=null,Promise.reject(e);new H(function(){try{r.media_[l](r.keySystem_,n)}catch(e){r.generatePromise_.reject(e),r.generatePromise_=null}}).tickAfter(.01)}return this.generatePromise_}},{key:"update_",value:function(e,t){var n=this;if(this.updatePromise_)this.updatePromise_.then(function(){return n.update_(e,t)}).catch(function(){return n.update_(e,t)});else{var r,i;if(this.updatePromise_=e,"webkit-org.w3.clearkey"==this.keySystem_){var a=Gt.fromUTF8(t),s=JSON.parse(a);"oct"!=s.keys[0].kty&&(this.updatePromise_.reject(new Error("Response is not a valid JSON Web Key Set.")),this.updatePromise_=null),r=Kt.fromBase64(s.keys[0].k),i=Kt.fromBase64(s.keys[0].kid)}else r=new Uint8Array(t),i=null;var o=(0,Wu.prefixApi_)("addKey");try{this.media_[o](this.keySystem_,r,i,this.sessionId)}catch(e){this.updatePromise_.reject(e),this.updatePromise_=null}}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new w("keystatuseschange");this.dispatchEvent(t)}},{key:"generateRequest",value:function(e,t){return Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),this.generate_(t,null)}},{key:"load",value:function(e){return Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.type_?this.generate_(null,e):Promise.reject(new Error("Not a persistent session."))}},{key:"update",value:function(e){Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e),window.asserts.assert(this.sessionId,"update without session ID");var t=new A;return this.update_(t,e),t}},{key:"close",value:function(){if(Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.type_){if(!this.sessionId)return this.closed.reject(new Error("The session is not callable.")),this.closed;var e=(0,Wu.prefixApi_)("cancelKeyRequest");try{this.media_[e](this.keySystem_,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed}},{key:"remove",value:function(){return Ku.log.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.type_?Promise.reject(new Error("Not a persistent session.")):this.close()}}]),t}(),Wu.MediaKeyStatusMap=function(){function e(){Hu(this,e),this.size=0,this.status_=void 0}return ju(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=Wu.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=Wu.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!Ku.util.Uint8ArrayUtils.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}}]),e}(),Wu.prefix_="",Wu.MediaKeyStatusMap.KEY_ID_,Xl.register(Wu.install);function qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var zu=window.shaka,Yu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||t.webkitSupportsPresentationMode&&(zu.log.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=e.requestPictureInPicture_,document.exitPictureInPicture=e.exitPictureInPicture_,document.addEventListener("webkitpresentationmodechanged",e.proxyEvent_,!0))}}},{key:"proxyEvent_",value:function(t){var n=t.target;if(n.webkitPresentationMode==e.PIP_MODE_){document.pictureInPictureElement=n;var r=new Event("enterpictureinpicture");n.dispatchEvent(r)}else{document.pictureInPictureElement==n&&(document.pictureInPictureElement=null);var i=new Event("leavepictureinpicture");n.dispatchEvent(i)}}},{key:"requestPictureInPicture_",value:function(){if(this.webkitSupportsPresentationMode(e.PIP_MODE_))return this.webkitSetPresentationMode(e.PIP_MODE_),document.pictureInPictureElement=this,Promise.resolve();var t=new Error("PiP not allowed by video element");return Promise.reject(t)}},{key:"exitPictureInPicture_",value:function(){var t=document.pictureInPictureElement;if(t)return t.webkitSetPresentationMode(e.INLINE_MODE_),document.pictureInPictureElement=null,Promise.resolve();var n=new Error("No picture in picture element found");return Promise.reject(n)}}],(n=null)&&qu(t.prototype,n),r&&qu(t,r),e}();Yu.PIP_MODE_="picture-in-picture",Yu.INLINE_MODE_="inline",Xl.register(Yu.install);function Xu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $u=window.shaka,Qu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.VTTCue)$u.log.info("Using native VTTCue.");else if(window.TextTrackCue){var t=TextTrackCue.length;3==t?($u.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=e.from3ArgsTextTrackCue_):6==t?($u.log.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=e.from6ArgsTextTrackCue_):e.canUse3ArgsTextTrackCue_()&&($u.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=e.from3ArgsTextTrackCue_)}else $u.log.error("VTTCue not available.")}},{key:"from3ArgsTextTrackCue_",value:function(e,t,n){return new window.TextTrackCue(e,t,n)}},{key:"from6ArgsTextTrackCue_",value:function(e,t,n){var r=e+"-"+t+"-"+n;return new window.TextTrackCue(r,e,t,n)}},{key:"canUse3ArgsTextTrackCue_",value:function(){try{return!!e.from3ArgsTextTrackCue_(1,2,"")}catch(e){return!1}}}],(n=null)&&Xu(t.prototype,n),r&&Xu(t,r),e}();Xl.register(Qu.install);function Zu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ju=window.shaka,ec=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(Ju.log.debug("VideoPlayPromise.install"),window.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}}],(n=null)&&Zu(t.prototype,n),r&&Zu(t,r),e}());Xl.register(ec.install);function tc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var nc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.getVideoPlaybackQuality||"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=e.webkit_)}}},{key:"webkit_",value:function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}}],(n=null)&&tc(t.prototype,n),r&&tc(t,r),e}();Xl.register(nc.install);function rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ic(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ac=window.shaka,sc=(window.goog,function(){function e(){rc(this,e)}var t,n,r;return t=e,r=[{key:"getLeafNodes_",value:function(e){var t=[];if(!e)return t;for(var n=e.childNodes,r=0;r<n.length;r++){var i="span"==n[r].nodeName&&"p"==e.nodeName;if(n[r].nodeType==Node.ELEMENT_NODE&&"br"!=n[r].nodeName&&!i){window.asserts.assert(n[r]instanceof Element,"Node should be Element!");var a=ac.text.TtmlTextParser.getLeafNodes_(n[r]);window.asserts.assert(a.length>0,"Only a null Element should return no leaves!"),t=t.concat(a)}}return t.length||t.push(e),t}},{key:"addNewLines_",value:function(e,t){for(var n=e.childNodes,r=0;r<n.length;r++)if("br"==n[r].nodeName&&r>0)n[r-1].textContent+="\n";else if(n[r].childNodes.length>0)ac.text.TtmlTextParser.addNewLines_(n[r],t);else if(t){var i=n[r].textContent.trim();i=i.replace(/\s+/g," "),n[r].textContent=i}}},{key:"parseCue_",value:function(e,t,n,r,i,a,s,o){if(!e.hasAttribute("begin")&&!e.hasAttribute("end")&&/^\s*$/.test(e.textContent))return null;ac.text.TtmlTextParser.addNewLines_(e,o);var l=ac.text.TtmlTextParser.parseTime_(e.getAttribute("begin"),n),u=ac.text.TtmlTextParser.parseTime_(e.getAttribute("end"),n),c=ac.text.TtmlTextParser.parseTime_(e.getAttribute("dur"),n),d=e.textContent;if(null==u&&null!=c&&(u=l+c),null==l||null==u)throw new ac.util.Error(ac.util.Error.Severity.CRITICAL,ac.util.Error.Category.TEXT,ac.util.Error.Code.INVALID_TEXT_CUE);l+=t,u+=t;var h=new ac.text.Cue(l,u,d),f=ac.text.TtmlTextParser.getElementFromCollection_(e,"region",a,"");if(f&&f.getAttribute("xml:id")){var p=f.getAttribute("xml:id"),m=s.filter(function(e){return e.id==p});h.region=m[0]}var v=ac.text.TtmlTextParser.getElementFromCollection_(e,"smpte:backgroundImage",r,"#");return ac.text.TtmlTextParser.addStyle_(h,e,f,v,i),h}},{key:"parseCueRegion_",value:function(e,t,n){var r=ac.text.TtmlTextParser,i=new ac.text.CueRegion,a=e.getAttribute("xml:id");if(!a)return ac.log.warning("TtmlTextParser parser encountered a region with no id. Region will be ignored."),null;i.id=a;var s=null;n&&(s=r.percentValues_.exec(n)||r.pixelValues_.exec(n));var o=s?Number(s[1]):null,l=s?Number(s[2]):null,u=null,c=null,d=r.getStyleAttributeFromRegion_(e,t,"extent");d&&null!=(u=(c=r.percentValues_.exec(d))||r.pixelValues_.exec(d))&&(i.width=null!=o?100*Number(u[1])/o:Number(u[1]),i.height=null!=l?100*Number(u[2])/l:Number(u[2]),i.widthUnits=c||null!=o?ac.text.CueRegion.units.PERCENTAGE:ac.text.CueRegion.units.PX,i.heightUnits=c||null!=l?ac.text.CueRegion.units.PERCENTAGE:ac.text.CueRegion.units.PX);var h=r.getStyleAttributeFromRegion_(e,t,"origin");return h&&null!=(u=(c=r.percentValues_.exec(h))||r.pixelValues_.exec(h))&&(i.viewportAnchorX=null!=l?100*Number(u[1])/l:Number(u[1]),i.viewportAnchorY=null!=o?100*Number(u[2])/o:Number(u[2]),i.viewportAnchorUnits=c||null!=o?ac.text.CueRegion.units.PERCENTAGE:ac.text.CueRegion.units.PX),i}},{key:"addStyle_",value:function(e,t,n,r,i){var a=ac.text.TtmlTextParser,s=ac.text.Cue;"rtl"==a.getStyleAttribute_(t,n,i,"direction")&&(e.direction=s.direction.HORIZONTAL_RIGHT_TO_LEFT);var o=a.getStyleAttribute_(t,n,i,"writingMode");"tb"==o||"tblr"==o?e.writingMode=s.writingMode.VERTICAL_LEFT_TO_RIGHT:"tbrl"==o?e.writingMode=s.writingMode.VERTICAL_RIGHT_TO_LEFT:"rltb"==o||"rl"==o?e.direction=s.direction.HORIZONTAL_RIGHT_TO_LEFT:o&&(e.direction=s.direction.HORIZONTAL_LEFT_TO_RIGHT);var l=a.getStyleAttribute_(t,n,i,"textAlign");l&&(e.positionAlign=a.textAlignToPositionAlign_[l],e.lineAlign=a.textAlignToLineAlign_[l],window.asserts.assert(l.toUpperCase()in s.textAlign,l.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=s.textAlign[l.toUpperCase()]);var u=a.getStyleAttribute_(t,n,i,"displayAlign");u&&(window.asserts.assert(u.toUpperCase()in s.displayAlign,u.toUpperCase()+" Should be in Cue.displayAlign values!"),e.displayAlign=s.displayAlign[u.toUpperCase()]);var c=a.getStyleAttribute_(t,n,i,"color");c&&(e.color=c);var d=a.getStyleAttribute_(t,n,i,"backgroundColor");d&&(e.backgroundColor=d);var h=a.getStyleAttribute_(t,n,i,"fontFamily");h&&(e.fontFamily=h);var f=a.getStyleAttribute_(t,n,i,"fontWeight");f&&"bold"==f&&(e.fontWeight=s.fontWeight.BOLD);var p=a.getStyleAttribute_(t,n,i,"wrapOption");p&&"noWrap"==p&&(e.wrapLine=!1);var m=a.getStyleAttribute_(t,n,i,"lineHeight");m&&m.match(a.unitValues_)&&(e.lineHeight=m);var v=a.getStyleAttribute_(t,n,i,"fontSize");v&&v.match(a.unitValues_)&&(e.fontSize=v);var g=a.getStyleAttribute_(t,n,i,"fontStyle");if(g&&(window.asserts.assert(g.toUpperCase()in s.fontStyle,g.toUpperCase()+" Should be in Cue.fontStyle values!"),e.fontStyle=s.fontStyle[g.toUpperCase()]),r){var y=r.getAttribute("imagetype"),_=r.getAttribute("encoding"),w=r.textContent;"PNG"==y&&"Base64"==_&&w&&(e.backgroundImage="data:image/png;base64,"+w)}var E=a.getStyleAttributeFromRegion_(n,i,"textDecoration");E&&a.addTextDecoration_(e,E);var b=a.getStyleAttributeFromElement_(t,i,"textDecoration");b&&a.addTextDecoration_(e,b)}},{key:"addTextDecoration_",value:function(e,t){for(var n=ac.text.Cue,r=t.split(" "),i=0;i<r.length;i++)switch(r[i]){case"underline":e.textDecoration.includes(n.textDecoration.UNDERLINE)||e.textDecoration.push(n.textDecoration.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(n.textDecoration.UNDERLINE)&&f.remove(e.textDecoration,n.textDecoration.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(n.textDecoration.LINE_THROUGH)||e.textDecoration.push(n.textDecoration.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(n.textDecoration.LINE_THROUGH)&&f.remove(e.textDecoration,n.textDecoration.LINE_THROUGH);break;case"overline":e.textDecoration.includes(n.textDecoration.OVERLINE)||e.textDecoration.push(n.textDecoration.OVERLINE);break;case"noOverline":e.textDecoration.includes(n.textDecoration.OVERLINE)&&f.remove(e.textDecoration,n.textDecoration.OVERLINE)}}},{key:"getStyleAttribute_",value:function(e,t,n,r){var i=ac.text.TtmlTextParser,a=i.getStyleAttributeFromElement_(e,n,r);return a||i.getStyleAttributeFromRegion_(t,n,r)}},{key:"getStyleAttributeFromRegion_",value:function(e,t,n){for(var r=ac.text.TtmlTextParser.styleNs_,i=ac.text.TtmlTextParser.getLeafNodes_(e),a=0;a<i.length;a++){var s=zs.getAttributeNS(i[a],r,n);if(s)return s}var o=ac.text.TtmlTextParser.getElementFromCollection_(e,"style",t,"");return o?zs.getAttributeNS(o,r,n):null}},{key:"getStyleAttributeFromElement_",value:function(e,t,n){var r=ac.text.TtmlTextParser.styleNs_,i=(0,ac.text.TtmlTextParser.getElementFromCollection_)(e,"style",t,"");return i?zs.getAttributeNS(i,r,n):null}},{key:"getElementFromCollection_",value:function(e,t,n,r){if(!e||n.length<1)return null;var i=null,a=ac.text.TtmlTextParser.getInheritedAttribute_(e,t);if(a)for(var s=0;s<n.length;s++)if(r+n[s].getAttribute("xml:id")==a){i=n[s];break}return i}},{key:"getInheritedAttribute_",value:function(e,t){for(var n=null;e&&!(n=e.getAttribute(t));){var r=e.parentNode;if(!(r instanceof Element))break;e=r}return n}},{key:"parseTime_",value:function(e,t){var n=null,r=ac.text.TtmlTextParser;return r.timeColonFormatFrames_.test(e)?n=r.parseColonTimeWithFrames_(t,e):r.timeColonFormat_.test(e)?n=r.parseTimeFromRegex_(r.timeColonFormat_,e):r.timeColonFormatMilliseconds_.test(e)?n=r.parseTimeFromRegex_(r.timeColonFormatMilliseconds_,e):r.timeFramesFormat_.test(e)?n=r.parseFramesTime_(t,e):r.timeTickFormat_.test(e)?n=r.parseTickTime_(t,e):r.timeHMSFormat_.test(e)&&(n=r.parseTimeFromRegex_(r.timeHMSFormat_,e)),n}},{key:"parseFramesTime_",value:function(e,t){var n=ac.text.TtmlTextParser.timeFramesFormat_.exec(t);return Number(n[1])/e.frameRate}},{key:"parseTickTime_",value:function(e,t){var n=ac.text.TtmlTextParser.timeTickFormat_.exec(t);return Number(n[1])/e.tickRate}},{key:"parseColonTimeWithFrames_",value:function(e,t){var n=ac.text.TtmlTextParser.timeColonFormatFrames_.exec(t),r=Number(n[1]),i=Number(n[2]),a=Number(n[3]),s=Number(n[4]);return(a+=(s+=(Number(n[5])||0)/e.subFrameRate)/e.frameRate)+60*i+3600*r}},{key:"parseTimeFromRegex_",value:function(e,t){var n=e.exec(t);if(null==n||""==n[0])return null;var r=Number(n[1])||0,i=Number(n[2])||0,a=Number(n[3])||0;return(Number(n[4])||0)/1e3+a+60*i+3600*r}}],(n=[{key:"parseInit",value:function(e){window.asserts.assert(!1,"TTML does not have init segments")}},{key:"parseMedia",value:function(t,n){var r=e.parameterNs_,i=Gt.fromUTF8(t),a=[],s=new DOMParser,o=null;try{o=s.parseFromString(i,"text/xml")}catch(e){throw new ac.util.Error(ac.util.Error.Severity.CRITICAL,ac.util.Error.Category.TEXT,ac.util.Error.Code.INVALID_XML)}if(o){var l=null,u=null,c=null,d=null,h=null,f=null,p=o.getElementsByTagName("tt")[0];if(!p)throw new ac.util.Error(ac.util.Error.Severity.CRITICAL,ac.util.Error.Category.TEXT,ac.util.Error.Code.INVALID_XML);if(l=zs.getAttributeNS(p,r,"frameRate"),u=zs.getAttributeNS(p,r,"subFrameRate"),c=zs.getAttributeNS(p,r,"frameRateMultiplier"),d=zs.getAttributeNS(p,r,"tickRate"),h=p.getAttribute("xml:space")||"default",f=p.getAttribute("tts:extent"),"default"!=h&&"preserve"!=h)throw new ac.util.Error(ac.util.Error.Severity.CRITICAL,ac.util.Error.Category.TEXT,ac.util.Error.Code.INVALID_XML);for(var m="default"==h,v=new e.RateInfo_(l,u,c,d),g=e.getLeafNodes_(p.getElementsByTagName("metadata")[0]),y=e.getLeafNodes_(p.getElementsByTagName("styling")[0]),_=e.getLeafNodes_(p.getElementsByTagName("layout")[0]),w=[],E=0;E<_.length;E++){var b=e.parseCueRegion_(_[E],y,f);b&&w.push(b)}for(var S=e.getLeafNodes_(p.getElementsByTagName("body")[0]),T=0;T<S.length;T++){var k=e.parseCue_(S[T],n.periodStart,v,g,y,_,w,m);k&&a.push(k)}}return a}}])&&ic(t.prototype,n),r&&ic(t,r),e}());sc.RateInfo_=function(){return function e(t,n,r,i){if(rc(this,e),this.frameRate=Number(t)||30,this.subFrameRate=Number(n)||1,this.tickRate=Number(i),0==this.tickRate&&(this.tickRate=t?this.frameRate*this.subFrameRate:1),r){var a=/^(\d+) (\d+)$/g.exec(r);if(a){var s=Number(a[1])/Number(a[2]);this.frameRate*=s}}}}(),sc.percentValues_=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,sc.unitValues_=/^(\d+px|\d+em)$/,sc.pixelValues_=/^(\d+)px (\d+)px$/,sc.timeColonFormatFrames_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,sc.timeColonFormat_=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,sc.timeColonFormatMilliseconds_=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,sc.timeFramesFormat_=/^(\d*(?:\.\d*)?)f$/,sc.timeTickFormat_=/^(\d*(?:\.\d*)?)t$/,sc.timeHMSFormat_=new RegExp(["^(?:(\\d*(?:\\.\\d*)?)h)?","(?:(\\d*(?:\\.\\d*)?)m)?","(?:(\\d*(?:\\.\\d*)?)s)?","(?:(\\d*(?:\\.\\d*)?)ms)?$"].join("")),sc.textAlignToLineAlign_={left:cn.lineAlign.START,center:cn.lineAlign.CENTER,right:cn.lineAlign.END,start:cn.lineAlign.START,end:cn.lineAlign.END},sc.textAlignToPositionAlign_={left:cn.positionAlign.LEFT,center:cn.positionAlign.CENTER,right:cn.positionAlign.RIGHT},sc.parameterNs_="http://www.w3.org/ns/ttml#parameter",sc.styleNs_="http://www.w3.org/ns/ttml#styling",vn.registerParser("application/ttml+xml",sc);var oc=sc;function lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var uc=window.shaka,cc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parser_=new oc}var t,n,r;return t=e,(n=[{key:"parseInit",value:function(e){var t=!1;if((new Ki).box("moov",Ki.children).box("trak",Ki.children).box("mdia",Ki.children).box("minf",Ki.children).box("stbl",Ki.children).fullBox("stsd",Ki.sampleDescription).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_MP4_TTML)}},{key:"parseMedia",value:function(e,t){var n=this,r=uc.util.Mp4Parser,i=!1,a=[];if((new r).box("mdat",r.allData(function(e){i=!0,a=a.concat(n.parser_.parseMedia(e,t))})).parse(e),!i)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_MP4_TTML);return a}}])&&lc(t.prototype,n),r&&lc(t,r),e}();vn.registerParser('application/mp4; codecs="stpp"',cc),vn.registerParser('application/mp4; codecs="stpp.TTML.im1t"',cc);function dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hc=window.shaka,fc=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parseRegion_",value:function(t){var n=new Ko(t),r=new dn;n.readWord(),n.skipWhitespace();for(var i=n.readWord();i;)e.parseRegionSetting_(r,i)||hc.log.warning("VTT parser encountered an invalid VTTRegion setting: ",i," The setting will be ignored."),n.skipWhitespace(),i=n.readWord();return r}},{key:"parseCue_",value:function(t,n,r){if(1==t.length&&!t[0])return null;if(/^NOTE($|[ \t])/.test(t[0]))return null;if("STYLE"==t[0])return null;var i=null;t[0].includes("--\x3e")||(i=t[0],t.splice(0,1));var a=new Ko(t[0]),s=e.parseTime_(a),o=a.readRegex(/[ \t]+-->[ \t]+/g),l=e.parseTime_(a);if(null==s||null==o||null==l)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_TEXT_CUE);s+=n,l+=n;var u=t.slice(1).join("\n").trim(),c=new cn(s,l,u);a.skipWhitespace();for(var d=a.readWord();d;)e.parseCueSetting(c,d,r)||hc.log.warning("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),a.skipWhitespace(),d=a.readWord();return null!=i&&(c.id=i),c}},{key:"parseCueSetting",value:function(t,n,r){var i=null;if(i=/^align:(start|middle|center|end|left|right)$/.exec(n))e.setTextAlign_(t,i[1]);else if(i=/^vertical:(lr|rl)$/.exec(n))e.setVerticalWritingMode_(t,i[1]);else if(i=/^size:([\d.]+)%$/.exec(n))t.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(n))t.position=Number(i[1]),i[2]&&e.setPositionAlign_(t,i[2]);else{if(!(i=/^region:(.*)$/.exec(n)))return e.parsedLineValueAndInterpretation_(t,n);var a=e.getRegionById_(r,i[1]);a&&(t.region=a)}return!0}},{key:"getRegionById_",value:function(e,t){var n=e.filter(function(e){return e.id==t});return n.length?(window.asserts.assert(1==n.length,"VTTRegion ids should be unique!"),n[0]):(hc.log.warning("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}},{key:"parseRegionSetting_",value:function(e,t){var n=null;if(n=/^id=(.*)$/.exec(t))e.id=n[1];else if(n=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(n[1]);else if(n=/^lines=(\d+)$/.exec(t))e.height=Number(n[1]),e.heightUnits=hc.text.CueRegion.units.LINES;else if(n=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(n[1]),e.regionAnchorY=Number(n[2]);else if(n=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(n[1]),e.viewportAnchorY=Number(n[2]);else{if(!(n=/^scroll=up$/.exec(t)))return!1;e.scroll=hc.text.CueRegion.scrollMode.UP}return!0}},{key:"setTextAlign_",value:function(e,t){"middle"==t?e.textAlign=cn.textAlign.CENTER:(window.asserts.assert(t.toUpperCase()in cn.textAlign,t.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=cn.textAlign[t.toUpperCase()])}},{key:"setPositionAlign_",value:function(e,t){var n=hc.text.Cue;e.positionAlign="line-left"==t||"start"==t?n.positionAlign.LEFT:"line-right"==t||"end"==t?n.positionAlign.RIGHT:n.positionAlign.CENTER}},{key:"setVerticalWritingMode_",value:function(e,t){e.writingMode="lr"==t?cn.writingMode.VERTICAL_LEFT_TO_RIGHT:cn.writingMode.VERTICAL_RIGHT_TO_LEFT}},{key:"parsedLineValueAndInterpretation_",value:function(e,t){var n=null;if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=cn.lineInterpretation.PERCENTAGE,e.line=Number(n[1]),n[2]&&(window.asserts.assert(n[2].toUpperCase()in cn.lineAlign,n[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=cn.lineAlign[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=cn.lineInterpretation.LINE_NUMBER,e.line=Number(n[1]),n[2]&&(window.asserts.assert(n[2].toUpperCase()in cn.lineAlign,n[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=cn.lineAlign[n[2].toUpperCase()])}return!0}},{key:"parseTime_",value:function(e){var t=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==t)return null;var n=Number(t[1])||0,r=Number(t[2]),i=Number(t[3]),a=Number(t[4]);return r>59||i>59?null:a/1e3+i+60*r+3600*n}}],(n=[{key:"parseInit",value:function(e){window.asserts.assert(!1,"VTT does not have init segments")}},{key:"parseMedia",value:function(t,n){var r=Gt.fromUTF8(t),i=(r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(i[0]))throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_TEXT_HEADER);var a=n.segmentStart;if(null==a&&(a=0,i[0].includes("X-TIMESTAMP-MAP"))){var s=i[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=i[0].match(/MPEGTS:(\d+)/m);if(s&&o){var l=new Ko(s[1]),u=e.parseTime_(l);if(null==u)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_TEXT_HEADER);var c=Number(o[1]),d=e.MPEG_TIMESCALE_;a=n.periodStart+(c/d-u)}}for(var h=[],f=i[0].split("\n"),p=1;p<f.length;p++)if(/^Region:/.test(f[p])){var m=e.parseRegion_(f[p]);h.push(m)}for(var v=[],g=1;g<i.length;g++){f=i[g].split("\n");var y=e.parseCue_(f,a,h);y&&v.push(y)}return v}}])&&dc(t.prototype,n),r&&dc(t,r),e}());fc.MPEG_TIMESCALE_=9e4,vn.registerParser("text/vtt",fc),vn.registerParser('text/vtt; codecs="vtt"',fc);var pc=fc;function mc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var vc=window.shaka,gc=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timescale_=null}var t,n,r;return t=e,r=[{key:"parseTFHD_",value:function(e,t){return t.skip(4),1&e&&t.skip(8),2&e&&t.skip(4),8&e?t.readUint32():null}},{key:"parseTRUN_",value:function(e,t,n){var r=n.readUint32();1&t&&n.skip(4),4&t&&n.skip(4);for(var i=[],a=0;a<r;a++){var s={duration:null,sampleSize:null,timeOffset:null};256&t&&(s.duration=n.readUint32()),512&t&&(s.sampleSize=n.readUint32()),1024&t&&n.skip(4),2048&t&&(s.timeOffset=0==e?n.readUint32():n.readInt32()),i.push(s)}return i}},{key:"parseVTTC_",value:function(e,t,n){var r,i,a;return(new vc.util.Mp4Parser).box("payl",vc.util.Mp4Parser.allData(function(e){r=Gt.fromUTF8(e)})).box("iden",vc.util.Mp4Parser.allData(function(e){i=Gt.fromUTF8(e)})).box("sttg",vc.util.Mp4Parser.allData(function(e){a=Gt.fromUTF8(e)})).parse(e),r?vc.text.Mp4VttParser.assembleCue_(r,i,a,t,n):null}},{key:"assembleCue_",value:function(e,t,n,r,i){var a=new cn(r,i,e);if(t&&(a.id=t),n)for(var s=new Ko(n),o=s.readWord();o;)pc.parseCueSetting(a,o,[])||vc.log.warning("VTT parser encountered an invalid VTT setting: ",o," The setting will be ignored."),s.skipWhitespace(),o=s.readWord();return a}}],(n=[{key:"parseInit",value:function(e){var t=this,n=!1;if((new Ki).box("moov",Ki.children).box("trak",Ki.children).box("mdia",Ki.children).fullBox("mdhd",function(e){window.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),0==e.version?(e.reader.skip(4),e.reader.skip(4),t.timescale_=e.reader.readUint32(),e.reader.skip(4)):(e.reader.skip(8),e.reader.skip(8),t.timescale_=e.reader.readUint32(),e.reader.skip(8)),e.reader.skip(4)}).box("minf",Ki.children).box("stbl",Ki.children).fullBox("stsd",Ki.sampleDescription).box("wvtt",function(e){n=!0}).parse(e),!this.timescale_)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_MP4_VTT);if(!n)throw new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_MP4_VTT)}},{key:"parseMedia",value:function(t,n){if(!this.timescale_)throw vc.log.error("No init segment for MP4+VTT!"),new M(M.Severity.CRITICAL,M.Category.TEXT,M.Code.INVALID_MP4_VTT);var r,i=0,a=[],s=[],o=!1,l=!1,u=!1,c=null;if((new Ki).box("moof",Ki.children).box("traf",Ki.children).fullBox("tfdt",function(e){o=!0,window.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),i=0==e.version?e.reader.readUint32():e.reader.readUint64()}).fullBox("tfhd",function(t){window.asserts.assert(null!=t.flags,"A TFHD box should have a valid flags value"),c=e.parseTFHD_(t.flags,t.reader)}).fullBox("trun",function(t){l=!0,window.asserts.assert(null!=t.version,"A TRUN box should have a valid version value"),window.asserts.assert(null!=t.flags,"A TRUN box should have a valid flags value"),a=e.parseTRUN_(t.version,t.flags,t.reader)}).box("mdat",Ki.allData(function(e){window.asserts.assert(!u,"VTT cues in mp4 with multiple MDAT are not currently supported"),u=!0,r=e})).parse(t),!u&&!o&&!l)throw new vc.util.Error(vc.util.Error.Severity.CRITICAL,vc.util.Error.Category.TEXT,vc.util.Error.Code.INVALID_MP4_VTT);var d=i,h=new DataView(r.buffer,r.byteOffset,r.byteLength),f=new Vi(h,Vi.Endianness.BIG_ENDIAN),p=!0,m=!1,v=void 0;try{for(var g,y=a[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var _=g.value,w=_.duration||c,E=_.timeOffset?i+_.timeOffset:d;d=E+(w||0);var b=0;do{var S=f.readUint32();b+=S;var T=f.readUint32(),k=vc.util.Mp4Parser.typeToString(T),C=null;"vttc"==k?S>8&&(C=f.readBytes(S-8)):"vtte"==k?f.skip(S-8):(vc.log.error("Unknown box "+k+"! Skipping!"),f.skip(S-8)),w?C&&(window.asserts.assert(null!=this.timescale_,"Timescale should not be null!"),s.push(vc.text.Mp4VttParser.parseVTTC_(C,n.periodStart+E/this.timescale_,n.periodStart+d/this.timescale_))):vc.log.error("WVTT sample duration unknown, and no default found!"),window.asserts.assert(!_.sampleSize||b<=_.sampleSize,"The samples do not fit evenly into the sample sizes given in the TRUN box!")}while(_.sampleSize&&b<_.sampleSize)}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}return window.asserts.assert(!f.hasMoreData(),"MDAT which contain VTT cues and non-VTT data are not currently supported!"),s.filter(Ae.isNotNull)}}])&&mc(t.prototype,n),r&&mc(t,r),e}());gc.TimeSegment,vn.registerParser('application/mp4; codecs="wvtt"',gc);function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var _c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.controls=n,this.eventManager=new Ke,this.localization=this.controls.getLocalization(),this.player=this.controls.getPlayer(),this.video=this.controls.getVideo()}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.eventManager.release(),this.parent=null,this.controls=null,this.eventManager=null,this.localization=null,this.player=null,this.video=null,Promise.resolve()}}])&&yc(t.prototype,n),r&&yc(t,r),e}();function wc(e){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ec(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function bc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tc(e,t,n){return t&&Sc(e.prototype,t),n&&Sc(e,n),e}function kc(e,t){return!t||"object"!==wc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cc(e,t,n){return(Cc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ic(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ic(e){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ac(e,t){return(Ac=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka=window.shaka||{};var Lc=window.shaka;window.goog=window.goog||{};window.goog;var Rc=function(e){function t(e,n){var r;bc(this,t),(r=kc(this,Ic(t).call(this,e,n))).config_=r.controls.getConfig(),r.controlsContainer_=r.controls.getControlsContainer(),r.children_=[],r.addOverflowMenuButton_(),r.addOverflowMenu_(),r.createChildren_();for(var i=r.controls.getVideoContainer().getElementsByClassName("shaka-back-to-overflow-button"),a=0;a<i.length;a++){var s=i[a];r.eventManager.listen(s,"click",function(){r.controls.hideSettingsMenus(),Be.setDisplay(r.overflowMenu_,!0),r.overflowMenu_.childNodes.length&&r.overflowMenu_.childNodes[0].focus(),r.controls.overrideCssShowControls()})}return r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.controls,"submenuopen",function(){Be.setDisplay(r.overflowMenu_,!1)}),r.eventManager.listen(r.overflowMenu_,"touchstart",function(e){r.controls.setLastTouchEventTime(Date.now()),e.stopPropagation()}),r.eventManager.listen(r.overflowMenuButton_,"click",function(){r.onOverflowMenuButtonClick_()}),r.eventManager.listen(r.controlsContainer_,"touchstart",function(e){r.overflowMenu_.classList.contains("shaka-displayed")&&(Be.setDisplay(r.overflowMenu_,!1),e.preventDefault())}),r.updateAriaLabel_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ac(e,t)}(t,_c),Tc(t,[{key:"destroy",value:function(){var e,n=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.controlsContainer_=null,e.next=3,Promise.all(this.children_.map(function(e){return e.destroy()}));case 3:return this.children_=[],e.next=6,Cc(Ic(t.prototype),"destroy",this).call(this);case 6:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ec(a,r,i,s,o,"next",e)}function o(e){Ec(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()},{key:"addOverflowMenu_",value:function(){this.overflowMenu_=Ue.createHTMLElement("div"),this.overflowMenu_.classList.add("shaka-overflow-menu"),this.overflowMenu_.classList.add("shaka-no-propagation"),this.overflowMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.overflowMenu_.classList.add("shaka-settings-menu"),this.controlsContainer_.appendChild(this.overflowMenu_)}},{key:"addOverflowMenuButton_",value:function(){this.overflowMenuButton_=Ue.createHTMLElement("button"),this.overflowMenuButton_.classList.add("shaka-overflow-menu-button"),this.overflowMenuButton_.classList.add("shaka-no-propagation"),this.overflowMenuButton_.classList.add("material-icons"),this.overflowMenuButton_.textContent=be.MaterialDesignIcons.OPEN_OVERFLOW,this.parent.appendChild(this.overflowMenuButton_)}},{key:"createChildren_",value:function(){for(var e=0;e<this.config_.overflowMenuButtons.length;e++){var n=this.config_.overflowMenuButtons[e];if(t.elementNamesToFactories_.get(n)){var r=t.elementNamesToFactories_.get(n);window.asserts.assert(this.controls,"Controls should not be null!"),this.children_.push(r.create(this.overflowMenu_,this.controls))}else Lc.log.alwaysWarn("Unrecognized overflow menu element requested:",n)}}},{key:"onOverflowMenuButtonClick_",value:function(){if(this.controls.anySettingsMenusAreOpen())this.controls.hideSettingsMenus();else{Be.setDisplay(this.overflowMenu_,!0),this.controls.overrideCssShowControls();var e=function(e){return 0==e.classList.contains("shaka-hidden")};if(Ce.some(this.overflowMenu_.childNodes,e))Ce.filter(this.overflowMenu_.childNodes,e)[0].focus()}}},{key:"updateAriaLabel_",value:function(){var e=Te.Ids;this.overflowMenuButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.MORE_SETTINGS))}}],[{key:"registerElement",value:function(e,n){t.elementNamesToFactories_.set(e,n)}}]),t}();Rc.Factory=function(){function e(){bc(this,e)}return Tc(e,[{key:"create",value:function(e,t){return new Rc(e,t)}}]),e}(),pt.registerElement("overflow_menu",new Rc.Factory),Rc.elementNamesToFactories_=new Map;for(var xc=Rc,Nc={LanguageMapping:{ach:{nativeName:"Lwo",englishName:"Acholi"},ady:{nativeName:"",englishName:"Adyghe"},af:{nativeName:"Afrikaans",englishName:"Afrikaans"},"af-NA":{nativeName:"Afrikaans (Namibia)",englishName:"Afrikaans (Namibia)"},"af-ZA":{nativeName:"Afrikaans (South Africa)",englishName:"Afrikaans (South Africa)"},ak:{nativeName:"Ti",englishName:"Akan"},ar:{nativeName:"",englishName:"Arabic"},"ar-AR":{nativeName:"",englishName:"Arabic"},"ar-MA":{nativeName:"",englishName:"Arabic (Morocco)"},"ar-SA":{nativeName:" ()",englishName:"Arabic (Saudi Arabia)"},"ay-BO":{nativeName:"Aymar aru",englishName:"Aymara"},az:{nativeName:"Azrbaycan dili",englishName:"Azerbaijani"},"az-AZ":{nativeName:"Azrbaycan dili",englishName:"Azerbaijani"},"be-BY":{nativeName:"",englishName:"Belarusian"},bg:{nativeName:"",englishName:"Bulgarian"},"bg-BG":{nativeName:"",englishName:"Bulgarian"},bn:{nativeName:"",englishName:"Bengali"},"bn-IN":{nativeName:" ()",englishName:"Bengali (India)"},"bn-BD":{nativeName:"()",englishName:"Bengali (Bangladesh)"},"bs-BA":{nativeName:"Bosanski",englishName:"Bosnian"},ca:{nativeName:"Catal",englishName:"Catalan"},"ca-ES":{nativeName:"Catal",englishName:"Catalan"},cak:{nativeName:"Maya Kaqchikel",englishName:"Kaqchikel"},"ck-US":{nativeName:" (tsalagi)",englishName:"Cherokee"},cs:{nativeName:"etina",englishName:"Czech"},"cs-CZ":{nativeName:"etina",englishName:"Czech"},cy:{nativeName:"Cymraeg",englishName:"Welsh"},"cy-GB":{nativeName:"Cymraeg",englishName:"Welsh"},da:{nativeName:"Dansk",englishName:"Danish"},"da-DK":{nativeName:"Dansk",englishName:"Danish"},de:{nativeName:"Deutsch",englishName:"German"},"de-AT":{nativeName:"Deutsch (sterreich)",englishName:"German (Austria)"},"de-DE":{nativeName:"Deutsch (Deutschland)",englishName:"German (Germany)"},"de-CH":{nativeName:"Deutsch (Schweiz)",englishName:"German (Switzerland)"},dsb:{nativeName:"Dolnoserbina",englishName:"Lower Sorbian"},el:{nativeName:"",englishName:"Greek"},"el-GR":{nativeName:"",englishName:"Greek (Greece)"},en:{nativeName:"English",englishName:"English"},"en-GB":{nativeName:"English (UK)",englishName:"English (UK)"},"en-AU":{nativeName:"English (Australia)",englishName:"English (Australia)"},"en-CA":{nativeName:"English (Canada)",englishName:"English (Canada)"},"en-IE":{nativeName:"English (Ireland)",englishName:"English (Ireland)"},"en-IN":{nativeName:"English (India)",englishName:"English (India)"},"en-PI":{nativeName:"English (Pirate)",englishName:"English (Pirate)"},"en-UD":{nativeName:"English (Upside Down)",englishName:"English (Upside Down)"},"en-US":{nativeName:"English (US)",englishName:"English (US)"},"en-ZA":{nativeName:"English (South Africa)",englishName:"English (South Africa)"},"en@pirate":{nativeName:"English (Pirate)",englishName:"English (Pirate)"},eo:{nativeName:"Esperanto",englishName:"Esperanto"},"eo-EO":{nativeName:"Esperanto",englishName:"Esperanto"},es:{nativeName:"Espaol",englishName:"Spanish"},"es-AR":{nativeName:"Espaol (Argentine)",englishName:"Spanish (Argentina)"},"es-419":{nativeName:"Espaol (Latinoamrica)",englishName:"Spanish (Latin America)"},"es-CL":{nativeName:"Espaol (Chile)",englishName:"Spanish (Chile)"},"es-CO":{nativeName:"Espaol (Colombia)",englishName:"Spanish (Colombia)"},"es-EC":{nativeName:"Espaol (Ecuador)",englishName:"Spanish (Ecuador)"},"es-ES":{nativeName:"Espaol (Espaa)",englishName:"Spanish (Spain)"},"es-LA":{nativeName:"Espaol (Latinoamrica)",englishName:"Spanish (Latin America)"},"es-NI":{nativeName:"Espaol (Nicaragua)",englishName:"Spanish (Nicaragua)"},"es-MX":{nativeName:"Espaol (Mxico)",englishName:"Spanish (Mexico)"},"es-US":{nativeName:"Espaol (Estados Unidos)",englishName:"Spanish (United States)"},"es-VE":{nativeName:"Espaol (Venezuela)",englishName:"Spanish (Venezuela)"},et:{nativeName:"eesti keel",englishName:"Estonian"},"et-EE":{nativeName:"Eesti (Estonia)",englishName:"Estonian (Estonia)"},eu:{nativeName:"Euskara",englishName:"Basque"},"eu-ES":{nativeName:"Euskara",englishName:"Basque"},fa:{nativeName:"",englishName:"Persian"},"fa-IR":{nativeName:"",englishName:"Persian"},"fb-LT":{nativeName:"Leet Speak",englishName:"Leet"},ff:{nativeName:"Fulah",englishName:"Fulah"},fi:{nativeName:"Suomi",englishName:"Finnish"},"fi-FI":{nativeName:"Suomi",englishName:"Finnish"},"fo-FO":{nativeName:"Froyskt",englishName:"Faroese"},fr:{nativeName:"Franais",englishName:"French"},"fr-CA":{nativeName:"Franais (Canada)",englishName:"French (Canada)"},"fr-FR":{nativeName:"Franais (France)",englishName:"French (France)"},"fr-BE":{nativeName:"Franais (Belgique)",englishName:"French (Belgium)"},"fr-CH":{nativeName:"Franais (Suisse)",englishName:"French (Switzerland)"},"fy-NL":{nativeName:"Frysk",englishName:"Frisian (West)"},ga:{nativeName:"Gaeilge",englishName:"Irish"},"ga-IE":{nativeName:"Gaeilge (Gaelic)",englishName:"Irish (Gaelic)"},gl:{nativeName:"Galego",englishName:"Galician"},"gl-ES":{nativeName:"Galego",englishName:"Galician"},"gn-PY":{nativeName:"Avae'",englishName:"Guarani"},"gu-IN":{nativeName:"",englishName:"Gujarati"},"gx-GR":{nativeName:" ",englishName:"Classical Greek"},he:{nativeName:"",englishName:"Hebrew"},"he-IL":{nativeName:"",englishName:"Hebrew"},hi:{nativeName:"",englishName:"Hindi"},"hi-IN":{nativeName:"",englishName:"Hindi"},hr:{nativeName:"Hrvatski",englishName:"Croatian"},"hr-HR":{nativeName:"Hrvatski",englishName:"Croatian"},hsb:{nativeName:"Hornjoserbina",englishName:"Upper Sorbian"},ht:{nativeName:"Kreyl",englishName:"Haitian Creole"},hu:{nativeName:"Magyar",englishName:"Hungarian"},"hu-HU":{nativeName:"Magyar",englishName:"Hungarian"},"hy-AM":{nativeName:"",englishName:"Armenian"},id:{nativeName:"Bahasa Indonesia",englishName:"Indonesian"},"id-ID":{nativeName:"Bahasa Indonesia",englishName:"Indonesian"},is:{nativeName:"slenska",englishName:"Icelandic"},"is-IS":{nativeName:"slenska (Iceland)",englishName:"Icelandic (Iceland)"},it:{nativeName:"Italiano",englishName:"Italian"},"it-IT":{nativeName:"Italiano",englishName:"Italian"},ja:{nativeName:"",englishName:"Japanese"},"ja-JP":{nativeName:"",englishName:"Japanese"},"jv-ID":{nativeName:"Basa Jawa",englishName:"Javanese"},"ka-GE":{nativeName:"",englishName:"Georgian"},"kk-KZ":{nativeName:"",englishName:"Kazakh"},km:{nativeName:"",englishName:"Khmer"},"km-KH":{nativeName:"",englishName:"Khmer"},kab:{nativeName:"Taqbaylit",englishName:"Kabyle"},kn:{nativeName:"",englishName:"Kannada"},"kn-IN":{nativeName:" (India)",englishName:"Kannada (India)"},ko:{nativeName:"",englishName:"Korean"},"ko-KR":{nativeName:" ()",englishName:"Korean (Korea)"},ku:{nativeName:"Kurd",englishName:"Kurdish"},"ku-TR":{nativeName:"Kurd",englishName:"Kurdish"},la:{nativeName:"Latin",englishName:"Latin"},"la-VA":{nativeName:"Latin",englishName:"Latin"},lb:{nativeName:"Ltzebuergesch",englishName:"Luxembourgish"},"li-NL":{nativeName:"Lmbrgs",englishName:"Limburgish"},lt:{nativeName:"Lietuvi",englishName:"Lithuanian"},"lt-LT":{nativeName:"Lietuvi",englishName:"Lithuanian"},lv:{nativeName:"Latvieu",englishName:"Latvian"},"lv-LV":{nativeName:"Latvieu",englishName:"Latvian"},mai:{nativeName:", ",englishName:"Maithili"},"mg-MG":{nativeName:"Malagasy",englishName:"Malagasy"},mk:{nativeName:"",englishName:"Macedonian"},"mk-MK":{nativeName:" ()",englishName:"Macedonian (Macedonian)"},ml:{nativeName:"",englishName:"Malayalam"},"ml-IN":{nativeName:"",englishName:"Malayalam"},"mn-MN":{nativeName:"",englishName:"Mongolian"},mr:{nativeName:"",englishName:"Marathi"},"mr-IN":{nativeName:"",englishName:"Marathi"},ms:{nativeName:"Bahasa Melayu",englishName:"Malay"},"ms-MY":{nativeName:"Bahasa Melayu",englishName:"Malay"},mt:{nativeName:"Malti",englishName:"Maltese"},"mt-MT":{nativeName:"Malti",englishName:"Maltese"},my:{nativeName:"",englishName:"Burmese"},nb:{nativeName:"Norsk (bokml)",englishName:"Norwegian (bokmal)"},"nb-NO":{nativeName:"Norsk (bokml)",englishName:"Norwegian (bokmal)"},ne:{nativeName:"",englishName:"Nepali"},"ne-NP":{nativeName:"",englishName:"Nepali"},nl:{nativeName:"Nederlands",englishName:"Dutch"},"nl-BE":{nativeName:"Nederlands (Belgi)",englishName:"Dutch (Belgium)"},"nl-NL":{nativeName:"Nederlands (Nederland)",englishName:"Dutch (Netherlands)"},"nn-NO":{nativeName:"Norsk (nynorsk)",englishName:"Norwegian (nynorsk)"},no:{nativeName:"Norsk",englishName:"Norwegian"},oc:{nativeName:"Occitan",englishName:"Occitan"},"or-IN":{nativeName:"",englishName:"Oriya"},pa:{nativeName:"",englishName:"Punjabi"},"pa-IN":{nativeName:" ( )",englishName:"Punjabi (India)"},pl:{nativeName:"Polski",englishName:"Polish"},"pl-PL":{nativeName:"Polski",englishName:"Polish"},"ps-AF":{nativeName:"",englishName:"Pashto"},pt:{nativeName:"Portugus",englishName:"Portuguese"},"pt-BR":{nativeName:"Portugus (Brasil)",englishName:"Portuguese (Brazil)"},"pt-PT":{nativeName:"Portugus (Portugal)",englishName:"Portuguese (Portugal)"},"qu-PE":{nativeName:"Qhichwa",englishName:"Quechua"},"rm-CH":{nativeName:"Rumantsch",englishName:"Romansh"},ro:{nativeName:"Romn",englishName:"Romanian"},"ro-RO":{nativeName:"Romn",englishName:"Romanian"},ru:{nativeName:"",englishName:"Russian"},"ru-RU":{nativeName:"",englishName:"Russian"},"sa-IN":{nativeName:"",englishName:"Sanskrit"},"se-NO":{nativeName:"Davvismegiella",englishName:"Northern Smi"},"si-LK":{nativeName:"",englishName:"Sinhala (Sri Lanka)"},sk:{nativeName:"Slovenina",englishName:"Slovak"},"sk-SK":{nativeName:"Slovenina (Slovakia)",englishName:"Slovak (Slovakia)"},sl:{nativeName:"Slovenina",englishName:"Slovenian"},"sl-SI":{nativeName:"Slovenina",englishName:"Slovenian"},"so-SO":{nativeName:"Soomaaliga",englishName:"Somali"},sq:{nativeName:"Shqip",englishName:"Albanian"},"sq-AL":{nativeName:"Shqip",englishName:"Albanian"},sr:{nativeName:"",englishName:"Serbian"},"sr-RS":{nativeName:" (Serbia)",englishName:"Serbian (Serbia)"},su:{nativeName:"Basa Sunda",englishName:"Sundanese"},sv:{nativeName:"Svenska",englishName:"Swedish"},"sv-SE":{nativeName:"Svenska",englishName:"Swedish"},sw:{nativeName:"Kiswahili",englishName:"Swahili"},"sw-KE":{nativeName:"Kiswahili",englishName:"Swahili (Kenya)"},ta:{nativeName:"",englishName:"Tamil"},"ta-IN":{nativeName:"",englishName:"Tamil"},te:{nativeName:"",englishName:"Telugu"},"te-IN":{nativeName:"",englishName:"Telugu"},tg:{nativeName:" ",englishName:"Tajik"},"tg-TJ":{nativeName:"",englishName:"Tajik"},th:{nativeName:"",englishName:"Thai"},"th-TH":{nativeName:" ()",englishName:"Thai (Thailand)"},tl:{nativeName:"Filipino",englishName:"Filipino"},"tl-PH":{nativeName:"Filipino",englishName:"Filipino"},tlh:{nativeName:"tlhIngan-Hol",englishName:"Klingon"},tr:{nativeName:"Trke",englishName:"Turkish"},"tr-TR":{nativeName:"Trke",englishName:"Turkish"},"tt-RU":{nativeName:"",englishName:"Tatar"},uk:{nativeName:"",englishName:"Ukrainian"},"uk-UA":{nativeName:"",englishName:"Ukrainian"},ur:{nativeName:"",englishName:"Urdu"},"ur-PK":{nativeName:"",englishName:"Urdu"},uz:{nativeName:"O'zbek",englishName:"Uzbek"},"uz-UZ":{nativeName:"O'zbek",englishName:"Uzbek"},vi:{nativeName:"Ting Vit",englishName:"Vietnamese"},"vi-VN":{nativeName:"Ting Vit",englishName:"Vietnamese"},"xh-ZA":{nativeName:"isiXhosa",englishName:"Xhosa"},yi:{nativeName:"",englishName:"Yiddish"},"yi-DE":{nativeName:" (German)",englishName:"Yiddish (German)"},zh:{nativeName:"",englishName:"Chinese"},"zh-HANS":{nativeName:"",englishName:"Chinese Simplified"},"zh-HANT":{nativeName:"",englishName:"Chinese Traditional"},"zh-CN":{nativeName:"",englishName:"Chinese Simplified (China)"},"zh-HK":{nativeName:"",englishName:"Chinese Traditional (Hong Kong)"},"zh-SG":{nativeName:"",englishName:"Chinese Simplified (Singapore)"},"zh-TW":{nativeName:"",englishName:"Chinese Traditional (Taiwan)"},"zu-ZA":{nativeName:"isiZulu",englishName:"Zulu"}}},Mc=Nc,Pc=0,Oc=Object.keys(Nc.LanguageMapping)
/**
 * @license
 * Copyright 2013 Ali Al Dallal
 *
 * Licensed under the MIT license.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */;Pc<Oc.length;Pc++){var Dc=Oc[Pc];Nc.LanguageMapping[Dc.toLowerCase()]=Nc.LanguageMapping[Dc]}function Uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"updateLanguages",value:function(t,n,r,i,a,s,o){var l=t.filter(function(e){return 1==e.active})[0],u=Be.getFirstDescendantWithClassName(n,"shaka-back-to-overflow-button");Ue.removeAllChildren(n),n.appendChild(u);var c=!0,d=!1,h=void 0;try{for(var f,p=function(){var t=f.value,r=Ue.createHTMLElement("button");r.addEventListener("click",function(){i(t)});var u=Ue.createHTMLElement("span");u.textContent=e.getLanguageName(t,o),r.appendChild(u),a&&t==l.language&&(r.appendChild(Be.checkmarkIcon()),u.classList.add("shaka-chosen-item"),r.setAttribute("aria-selected","true"),s.textContent=u.textContent),n.appendChild(r)},m=r[Symbol.iterator]();!(c=(f=m.next()).done);c=!0)p()}catch(e){d=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw h}}}},{key:"getLanguageName",value:function(e,t){if(!e&&!t)return"";var n=function(e){return t.resolve(e)};switch(e){case"mul":return n(Te.Ids.MULTIPLE_LANGUAGES);case"und":return n(Te.Ids.UNDETERMINED_LANGUAGE);case"zxx":return n(Te.Ids.NOT_APPLICABLE)}var r=Ne.getBase(e);return e in Mc.LanguageMapping?Mc.LanguageMapping[e].nativeName:r in Mc.LanguageMapping?Mc.LanguageMapping[r].nativeName+" ("+e+")":n(Te.Ids.UNRECOGNIZED_LANGUAGE)+" ("+e+")"}}],(n=null)&&Uc(t.prototype,n),r&&Uc(t,r),e}();function Bc(e){return(Bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gc(e,t,n){return t&&Hc(e.prototype,t),n&&Hc(e,n),e}function jc(e,t){return!t||"object"!==Bc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kc(e){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wc(e,t){return(Wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var qc=function(e){function t(e,n){var r;return Vc(this,t),(r=jc(this,Kc(t).call(this,e,n))).addLanguagesButton_(),r.addAudioLangMenu_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r.eventManager.listen(r.player,"variantchanged",function(){r.updateAudioLanguages_()}),r.eventManager.listen(r.languagesButton_,"click",function(){r.onLanguagesClick_()}),r.updateLocalizedStrings_(),r.updateAudioLanguages_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wc(e,t)}(t,_c),Gc(t,[{key:"addAudioLangMenu_",value:function(){this.audioLangMenu_=Ue.createHTMLElement("div"),this.audioLangMenu_.classList.add("shaka-audio-languages"),this.audioLangMenu_.classList.add("shaka-no-propagation"),this.audioLangMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.audioLangMenu_.classList.add("shaka-settings-menu"),this.backFromLanguageButton_=Ue.createHTMLElement("button"),this.backFromLanguageButton_.classList.add("shaka-back-to-overflow-button"),this.audioLangMenu_.appendChild(this.backFromLanguageButton_);var e=Ue.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=be.MaterialDesignIcons.BACK,this.backFromLanguageButton_.appendChild(e),this.backFromLanguageSpan_=Ue.createHTMLElement("span"),this.backFromLanguageButton_.appendChild(this.backFromLanguageSpan_),this.controls.getControlsContainer().appendChild(this.audioLangMenu_)}},{key:"addLanguagesButton_",value:function(){this.languagesButton_=Ue.createHTMLElement("button"),this.languagesButton_.classList.add("shaka-language-button");var e=Ue.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=be.MaterialDesignIcons.LANGUAGE,this.languagesButton_.appendChild(e);var t=Ue.createHTMLElement("label");t.classList.add("shaka-overflow-button-label"),this.languageNameSpan_=Ue.createHTMLElement("span"),this.languageNameSpan_.classList.add("languageSpan"),t.appendChild(this.languageNameSpan_),this.currentAudioLanguage_=Ue.createHTMLElement("span"),this.currentAudioLanguage_.classList.add("shaka-current-selection-span");var n=this.player.getConfiguration().preferredAudioLanguage;this.currentAudioLanguage_.textContent=Fc.getLanguageName(n,this.localization),t.appendChild(this.currentAudioLanguage_),this.languagesButton_.appendChild(t),this.parent.appendChild(this.languagesButton_)}},{key:"onLanguagesClick_",value:function(){this.controls.dispatchEvent(new w("submenuopen")),Be.setDisplay(this.audioLangMenu_,!0),Be.focusOnTheChosenItem(this.audioLangMenu_)}},{key:"updateAudioLanguages_",value:function(){var e=this,t=this.player.getVariantTracks(),n=this.player.getAudioLanguages();Fc.updateLanguages(t,this.audioLangMenu_,n,function(t){return e.onAudioLanguageSelected_(t)},!0,this.currentAudioLanguage_,this.localization),Be.focusOnTheChosenItem(this.audioLangMenu_),this.controls.dispatchEvent(new w("languageselectionupdated"))}},{key:"onTracksChanged_",value:function(){var e=this.player.getVariantTracks().length>0;Be.setDisplay(this.languagesButton_,e),this.updateAudioLanguages_()}},{key:"onAudioLanguageSelected_",value:function(e){this.player.selectAudioLanguage(e)}},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.backFromLanguageButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.BACK)),this.languagesButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.LANGUAGE)),this.languageNameSpan_.textContent=this.localization.resolve(e.LANGUAGE),this.backFromLanguageSpan_.textContent=this.localization.resolve(e.LANGUAGE)}}]),t}();function zc(e){return(zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yc(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Xc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qc(e,t,n){return t&&$c(e.prototype,t),n&&$c(e,n),e}function Zc(e,t){return!t||"object"!==zc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jc(e){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ed(e,t){return(ed=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qc.Factory=function(){function e(){Vc(this,e)}return Gc(e,[{key:"create",value:function(e,t){return new qc(e,t)}}]),e}(),xc.registerElement("language",new qc.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var td=function(e){function t(e,n){var r;Xc(this,t),(r=Zc(this,Jc(t).call(this,e,n))).castProxy_=r.controls.getCastProxy(),r.castButton_=Ue.createHTMLElement("button"),r.castButton_.classList.add("shaka-cast-button"),r.castButton_.setAttribute("aria-pressed","false"),r.castIcon_=Ue.createHTMLElement("i"),r.castIcon_.classList.add("material-icons"),r.castIcon_.textContent=be.MaterialDesignIcons.CAST,r.castButton_.appendChild(r.castIcon_);var i=Ue.createHTMLElement("label");return i.classList.add("shaka-overflow-button-label"),r.castNameSpan_=Ue.createHTMLElement("span"),i.appendChild(r.castNameSpan_),r.castCurrentSelectionSpan_=Ue.createHTMLElement("span"),r.castCurrentSelectionSpan_.classList.add("shaka-current-selection-span"),i.appendChild(r.castCurrentSelectionSpan_),r.castButton_.appendChild(i),r.parent.appendChild(r.castButton_),r.updateLocalizedStrings_(),r.onCastStatusChange_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.castButton_,"click",function(){r.onCastClick_()}),r.eventManager.listen(r.controls,"caststatuschanged",function(){r.onCastStatusChange_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ed(e,t)}(t,_c),Qc(t,[{key:"onCastClick_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.castProxy_.isCasting()){e.next=4;break}this.castProxy_.suggestDisconnect(),e.next=15;break;case 4:return e.prev=4,this.castButton_.disabled=!0,e.next=8,this.castProxy_.cast();case 8:this.castButton_.disabled=!1,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),this.castButton_.disabled=!1,e.t0.code!=Error.Code.CAST_CANCELED_BY_USER&&this.controls.dispatchEvent(new FakeEvent("error",{detail:e.t0}));case 15:case"end":return e.stop()}},e,this,[[4,11]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Yc(a,r,i,s,o,"next",e)}function o(e){Yc(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"onCastStatusChange_",value:function(){var e=this.castProxy_.canCast()&&this.controls.isCastAllowed(),t=this.castProxy_.isCasting(),n=be.MaterialDesignIcons;Be.setDisplay(this.castButton_,e),this.castIcon_.textContent=t?n.EXIT_CAST:n.CAST,e&&(t?this.castButton_.setAttribute("aria-pressed","true"):this.castButton_.setAttribute("aria-pressed","false")),this.setCurrentCastSelection_()}},{key:"setCurrentCastSelection_",value:function(){this.castProxy_.isCasting()?this.castCurrentSelectionSpan_.textContent=this.castProxy_.receiverName():this.castCurrentSelectionSpan_.textContent=this.localization.resolve(Te.Ids.OFF)}},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.castButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.CAST)),this.castNameSpan_.textContent=this.localization.resolve(e.CAST),this.setCurrentCastSelection_()}}]),t}();td.Factory=function(){function e(){Xc(this,e)}return Qc(e,[{key:"create",value:function(e,t){return new td(e,t)}}]),e}(),xc.registerElement("cast",new td.Factory);function nd(e){return(nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function id(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ad(e,t,n){return t&&id(e.prototype,t),n&&id(e,n),e}function sd(e,t){return!t||"object"!==nd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function od(e){return(od=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ld(e,t){return(ld=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka=window.shaka||{};var ud=window.shaka;window.goog=window.goog||{};window.goog;var cd=function(e){function t(e,n){var r;return rd(this,t),(r=sd(this,od(t).call(this,e,n))).button_=Ue.createHTMLElement("button"),r.button_.classList.add("material-icons"),r.button_.classList.add("shaka-fast-forward-button"),r.button_.textContent=ud.ui.Enums.MaterialDesignIcons.FAST_FORWARD,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.fastForward_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ld(e,t)}(t,_c),ad(t,[{key:"updateAriaLabel_",value:function(){this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(Locales.Ids.FAST_FORWARD))}},{key:"fastForward_",value:function(){if(this.video.duration){var e=this.player.getPlaybackRate(),t=e<0||e>4?1:2*e;this.player.trickPlay(t)}}}]),t}();function dd(e){return(dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hd(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function fd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function md(e,t,n){return t&&pd(e.prototype,t),n&&pd(e,n),e}function vd(e,t){return!t||"object"!==dd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gd(e){return(gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yd(e,t){return(yd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cd.Factory=function(){function e(){rd(this,e)}return ad(e,[{key:"create",value:function(e,t){return new cd(e,t)}}]),e}(),pt.registerElement("fast_forward",new cd.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var _d=function(e){function t(e,n){var r;return fd(this,t),(r=vd(this,gd(t).call(this,e,n))).button_=Ue.createHTMLElement("button"),r.button_.classList.add("shaka-fullscreen-button"),r.button_.classList.add("material-icons"),document.fullscreenEnabled||r.button_.classList.add("shaka-hidden"),r.button_.textContent=be.MaterialDesignIcons.FULLSCREEN,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.videoContainer_=r.controls.getVideoContainer(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.toggleFullScreen_()}),screen.orientation&&r.eventManager.listen(screen.orientation,"change",function(){r.onScreenRotation_()}),r.eventManager.listen(document,"fullscreenchange",function(){r.updateIcon_(),r.updateAriaLabel_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yd(e,t)}(t,_c),md(t,[{key:"updateAriaLabel_",value:function(){var e=Te.Ids,t=document.fullscreenElement?e.EXIT_FULL_SCREEN:e.FULL_SCREEN;this.button_.setAttribute(we.ARIA_LABEL,this.localization.resolve(t))}},{key:"updateIcon_",value:function(){this.button_.textContent=document.fullscreenElement?be.MaterialDesignIcons.EXIT_FULLSCREEN:be.MaterialDesignIcons.FULLSCREEN}},{key:"toggleFullScreen_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.fullscreenElement){e.next=4;break}document.exitFullscreen(),e.next=15;break;case 4:if(e.prev=4,!document.pictureInPictureElement){e.next=8;break}return e.next=8,document.exitPictureInPicture();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),this.controls.dispatchEvent(new FakeEvent("error",{detail:e.t0}));case 13:return e.next=15,this.videoContainer_.requestFullscreen();case 15:case"end":return e.stop()}},e,this,[[4,10]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){hd(a,r,i,s,o,"next",e)}function o(e){hd(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"onScreenRotation_",value:function(){this.video&&0!=this.video.readyState&&!this.controls.getCastProxy().isCasting()&&(screen.orientation.type.includes("landscape")&&!document.fullscreenElement?this.videoContainer_.requestFullscreen():screen.orientation.type.includes("portrait")&&document.fullscreenElement&&document.exitFullscreen())}}]),t}();function wd(e){return(wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ed(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sd(e,t,n){return t&&bd(e.prototype,t),n&&bd(e,n),e}function Td(e){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cd(e,t){return(Cd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}_d.Factory=function(){function e(){fd(this,e)}return md(e,[{key:"create",value:function(e,t){return new _d(e,t)}}]),e}(),pt.registerElement("fullscreen",new _d.Factory),
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Id=function(e){function t(e,n){var r,i,a,s,o,l;return Ed(this,t),i=this,a=Td(t).call(this,e,n),r=!a||"object"!==wd(a)&&"function"!=typeof a?kd(i):a,s=kd(r),l=function(){var e=Te.Ids,t=r.video.muted?e.UNMUTE:e.MUTE;r.button_.setAttribute(we.ARIA_LABEL,r.localization.resolve(t))},(o="updateAriaLabel_")in s?Object.defineProperty(s,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[o]=l,r.button_=Ue.createHTMLElement("button"),r.button_.classList.add("shaka-mute-button"),r.button_.classList.add("material-icons"),r.button_.textContent=be.MaterialDesignIcons.MUTE,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.video.muted=!r.video.muted}),r.eventManager.listen(r.video,"volumechange",function(){r.updateAriaLabel_(),r.updateIcon_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cd(e,t)}(t,_c),Sd(t,[{key:"updateIcon_",value:function(){this.button_.textContent=this.video.muted?be.MaterialDesignIcons.UNMUTE:be.MaterialDesignIcons.MUTE}}]),t}();function Ad(e){return(Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ld(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Rd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Id.Factory=function(){function e(){Ed(this,e)}return Sd(e,[{key:"create",value:function(e,t){return new Id(e,t)}}]),e}(),pt.registerElement("mute",new Id.Factory),
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};var xd=window.shaka;window.goog=window.goog||{};window.goog;var Nd=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.player_=t,this.config_=this.defaultConfig_(),n.dataset.shakaPlayerContainer="",n.ui=this,this.isMobile()&&n.classList.add("shaka-mobile"),this.controls_=new pt(t,n,r,this.config_),this.configure({})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controls_.destroy();case 2:return this.controls_=null,e.next=5,this.player_.destroy();case 5:this.player_=null;case 6:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ld(a,r,i,s,o,"next",e)}function o(e){Ld(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"isMobile",value:function(){return Ft.isMobile()}},{key:"getConfiguration",value:function(){var e=this.defaultConfig_();return St.mergeConfigObjects(e,this.config_,this.defaultConfig_(),{},""),e}},{key:"configure",value:function(e,t){window.asserts.assert("object"==Ad(e)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=St.convertToConfigObject(e,t)),window.asserts.assert("object"==Ad(e),"Should be an object!"),St.mergeConfigObjects(this.config_,e,this.defaultConfig_(),{},""),this.config_.castReceiverAppId&&!this.config_.overflowMenuButtons.includes("cast")&&this.config_.overflowMenuButtons.push("cast"),window.asserts.assert(null!=this.player_,"Should have a player!"),this.controls_.configure(this.config_),this.controls_.dispatchEvent(new w("uiupdated"))}},{key:"getPlayer",value:function(){return xd.Deprecate.deprecateFeature(2,6,"ui.Overlay.getPlayer()","Please use getControls().getPlayer() instead."),this.controls_.getPlayer()}},{key:"getControls",value:function(){return this.controls_}},{key:"setEnabled",value:function(e){this.controls_.setEnabledShakaControls(e)}},{key:"defaultConfig_",value:function(){return{controlPanelElements:["time_and_duration","spacer","mute","volume","fullscreen","overflow_menu"],overflowMenuButtons:["captions","quality","language","picture_in_picture","cast"],addSeekBar:!0,castReceiverAppId:""}}}],r=[{key:"scanPageForShakaElements_",value:function(){if(Xl.installAll(),!Ra.isBrowserSupported())return xd.log.error("Shaka Player does not support this browser. Please see https://tinyurl.com/y7s4j9tr for the list of supported browsers."),void e.dispatchLoadedEvent_("shaka-ui-load-failed");var t=document.querySelectorAll("[data-shaka-player-container]"),n=document.querySelectorAll("[data-shaka-player]");if(n.length||t.length)if(n.length&&!t.length){var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var l=s.value;window.asserts.assert("video"==l.tagName.toLowerCase(),"Should be a video element!");var u=document.createElement("div");l.parentElement.replaceChild(u,l),u.appendChild(l);var c="";l.dataset&&l.dataset.shakaPlayerCastReceiverId&&(c=l.dataset.shakaPlayerCastReceiverId);var d=e.createUI_(Ue.asHTMLElement(u),Ue.asHTMLMediaElement(l));d.configure({castReceiverAppId:c}),Ue.asHTMLMediaElement(l).controls&&d.getControls().setEnabledNativeControls(!0)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}else{var h=!0,f=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;window.asserts.assert("div"==g.tagName.toLowerCase(),"Container should be a div!");var y="";g.dataset&&g.dataset.shakaPlayerCastReceiverId&&(y=g.dataset.shakaPlayerCastReceiverId);var _=null,w=!0,E=!1,b=void 0;try{for(var S,T=n[Symbol.iterator]();!(w=(S=T.next()).done);w=!0){var k=S.value;if(window.asserts.assert("video"==k.tagName.toLowerCase(),"Should be a video element!"),k.parentElement==g){_=k;break}}}catch(e){E=!0,b=e}finally{try{w||null==T.return||T.return()}finally{if(E)throw b}}_||((_=document.createElement("video")).setAttribute("playsinline",""),g.appendChild(_)),_.dataset&&_.dataset.shakaPlayerCastReceiverId&&(y=_.dataset.shakaPlayerCastReceiverId),e.createUI_(Ue.asHTMLElement(g),Ue.asHTMLMediaElement(_)).configure({castReceiverAppId:y})}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}else;e.dispatchLoadedEvent_("shaka-ui-loaded")}},{key:"dispatchLoadedEvent_",value:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,null),document.dispatchEvent(t)}},{key:"createUI_",value:function(t,n){var r=new Ra(n),i=new e(r,t,n);if(!n.controls){r.configure("textDisplayFactory",function(){return new Ba(n,t)})}return t.ui=i,n.ui=i,i}}],n&&Rd(t.prototype,n),r&&Rd(t,r),e}();function Md(e){return(Md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pd(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Od(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Pd(a,r,i,s,o,"next",e)}function o(e){Pd(a,r,i,s,o,"throw",e)}s(void 0)})}}function Dd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ud(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fd(e,t,n){return t&&Ud(e.prototype,t),n&&Ud(e,n),e}function Bd(e,t){return!t||"object"!==Md(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vd(e){return(Vd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hd(e,t){return(Hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"complete"==document.readyState?Promise.resolve().then(Nd.scanPageForShakaElements_):window.addEventListener("load",Nd.scanPageForShakaElements_),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Gd=function(e){function t(e,n){var r;Dd(this,t),(r=Bd(this,Vd(t).call(this,e,n))).localVideo_=r.controls.getLocalVideo();var i=Te.Ids;r.pipButton_=Ue.createHTMLElement("button"),r.pipButton_.classList.add("shaka-pip-button"),r.pipIcon_=Ue.createHTMLElement("i"),r.pipIcon_.classList.add("material-icons"),r.pipIcon_.textContent=be.MaterialDesignIcons.PIP,r.pipButton_.appendChild(r.pipIcon_);var a=Ue.createHTMLElement("label");return a.classList.add("shaka-overflow-button-label"),r.pipNameSpan_=Ue.createHTMLElement("span"),r.pipNameSpan_.textContent=r.localization.resolve(i.PICTURE_IN_PICTURE),a.appendChild(r.pipNameSpan_),r.currentPipState_=Ue.createHTMLElement("span"),r.currentPipState_.classList.add("shaka-current-selection-span"),a.appendChild(r.currentPipState_),r.pipButton_.appendChild(a),r.updateLocalizedStrings_(),r.parent.appendChild(r.pipButton_),r.isPipAllowed_()||Be.setDisplay(r.pipButton_,!1),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.pipButton_,"click",function(){r.onPipClick_()}),r.eventManager.listen(r.localVideo_,"enterpictureinpicture",function(){r.onEnterPictureInPicture_()}),r.eventManager.listen(r.localVideo_,"leavepictureinpicture",function(){r.onLeavePictureInPicture_()}),r.eventManager.listen(r.controls,"caststatuschange",function(e){r.onCastStatusChange_(e)}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hd(e,t)}(t,_c),Fd(t,[{key:"isPipAllowed_",value:function(){return document.pictureInPictureEnabled&&!this.video.disablePictureInPicture}},{key:"onPipClick_",value:function(){var e=Od(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,document.pictureInPictureElement){e.next=7;break}return document.fullscreenElement&&document.exitFullscreen(),e.next=5,this.video.requestPictureInPicture();case 5:e.next=9;break;case 7:return e.next=9,document.exitPictureInPicture();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.controls.dispatchEvent(new w("error",{detail:e.t0}));case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"onEnterPictureInPicture_",value:function(){var e=Te.Ids;this.pipIcon_.textContent=be.MaterialDesignIcons.EXIT_PIP,this.pipButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.EXIT_PICTURE_IN_PICTURE)),this.currentPipState_.textContent=this.localization.resolve(e.ON)}},{key:"onLeavePictureInPicture_",value:function(){var e=Te.Ids;this.pipIcon_.textContent=be.MaterialDesignIcons.PIP,this.pipButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.ENTER_PICTURE_IN_PICTURE)),this.currentPipState_.textContent=this.localization.resolve(e.OFF)}},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.pipNameSpan_.textContent=this.localization.resolve(e.PICTURE_IN_PICTURE);var t=document.pictureInPictureElement?e.EXIT_PICTURE_IN_PICTURE:e.ENTER_PICTURE_IN_PICTURE;this.pipButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(t));var n=document.pictureInPictureElement?e.ON:e.OFF;this.currentPipState_.textContent=this.localization.resolve(n)}},{key:"onCastStatusChange_",value:function(e){e.newStatus?this.isPipAllowed_()&&Be.setDisplay(this.pipButton_,!1):this.isPipAllowed_()&&Be.setDisplay(this.pipButton_,!0)}},{key:"onTracksChanged_",value:function(){var e=Od(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPipAllowed_()){e.next=4;break}Be.setDisplay(this.pipButton_,!1),e.next=12;break;case 4:if(!this.player||!this.player.isAudioOnly()){e.next=11;break}if(Be.setDisplay(this.pipButton_,!1),!document.pictureInPictureElement){e.next=9;break}return e.next=9,document.exitPictureInPicture();case 9:e.next=12;break;case 11:Be.setDisplay(this.pipButton_,!0);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();function jd(e){return(jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qd(e,t,n){return t&&Wd(e.prototype,t),n&&Wd(e,n),e}function zd(e,t){return!t||"object"!==jd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yd(e){return(Yd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xd(e,t){return(Xd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gd.Factory=function(){function e(){Dd(this,e)}return Fd(e,[{key:"create",value:function(e,t){return new Gd(e,t)}}]),e}(),xc.registerElement("picture_in_picture",new Gd.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var $d=function(e){function t(e,n){var r;Kd(this,t),(r=zd(this,Yd(t).call(this,e,n))).button_=Ue.createHTMLElement("button"),r.button_.classList.add("shaka-play-pause-button"),r.button_.classList.add("material-icons"),r.parent.appendChild(r.button_),r.updateIcon_(),r.updateAriaLabel_();var i=Pe.LOCALE_UPDATED;r.eventManager.listen(r.localization,i,function(){r.updateAriaLabel_()});var a=Pe.LOCALE_CHANGED;return r.eventManager.listen(r.localization,a,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.video,"play",function(){r.updateAriaLabel_(),r.updateIcon_()}),r.eventManager.listen(r.video,"pause",function(){r.updateAriaLabel_(),r.updateIcon_()}),r.eventManager.listen(r.button_,"click",function(){r.isPaused_()?r.video.play():r.video.pause()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xd(e,t)}(t,_c),qd(t,[{key:"isPaused_",value:function(){return this.video.paused&&!this.controls.isSeeking()}},{key:"updateAriaLabel_",value:function(){var e=Locales.Ids,t=this.isPaused_()?e.PLAY:e.PAUSE;this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(t))}},{key:"updateIcon_",value:function(){var e=be.MaterialDesignIcons;this.button_.textContent=this.isPaused_()?e.PLAY:e.PAUSE}}]),t}();function Qd(e){return(Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eh(e,t,n){return t&&Jd(e.prototype,t),n&&Jd(e,n),e}function th(e,t){return!t||"object"!==Qd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nh(e){return(nh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rh(e,t){return(rh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$d.Factory=function(){function e(){Kd(this,e)}return qd(e,[{key:"create",value:function(e,t){return new $d(e,t)}}]),e}(),pt.registerElement("play_pause",new $d.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var ih=function(e){function t(e,n){var r;return Zd(this,t),(r=th(this,nh(t).call(this,e,n))).currentTime_=Ue.createHTMLElement("button"),r.currentTime_.classList.add("shaka-current-time"),r.currentTime_.textContent="0:00",r.parent.appendChild(r.currentTime_),r.eventManager.listen(r.currentTime_,"click",function(){r.player.isLive()&&(r.video.currentTime=r.player.seekRange().end)}),r.eventManager.listen(r.controls,"timeandseekrangeupdated",function(){r.updateTime_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rh(e,t)}(t,_c),eh(t,[{key:"updateTime_",value:function(){var e=this.controls.isSeeking(),t=this.controls.getDisplayTime(),n=this.video.duration,r=this.player.seekRange(),i=r.end-r.start;if(this.player.isLive()){var a=Math.floor(r.end-t),s=i>=3600;(t=Math.max(0,a))>=1||e?(this.currentTime_.textContent="- "+this.buildTimeString_(t,s),this.currentTime_.disabled=!1):(this.currentTime_.textContent=this.localization.resolve(Te.Ids.LIVE),this.currentTime_.disabled=!0)}else{var o=n>=3600;this.currentTime_.textContent=this.buildTimeString_(t,o),n&&(this.currentTime_.textContent+=" / "+this.buildTimeString_(n,o)),this.currentTime_.disabled=!0}}},{key:"buildTimeString_",value:function(e,t){var n=Math.floor(e/3600),r=Math.floor(e/60%60),i=Math.floor(e%60);i<10&&(i="0"+i);var a=r+":"+i;return t&&(r<10&&(a="0"+a),a=n+":"+a),a}},{key:"onTracksChanged_",value:function(){if(this.player.isLive()){var e=Te.Ids.SKIP_TO_LIVE;this.currentTime_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e))}}}]),t}();function ah(e){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lh(e,t,n){return t&&oh(e.prototype,t),n&&oh(e,n),e}function uh(e,t){return!t||"object"!==ah(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ch(e){return(ch=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dh(e,t){return(dh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ih.Factory=function(){function e(){Zd(this,e)}return eh(e,[{key:"create",value:function(e,t){return new ih(e,t)}}]),e}(),pt.registerElement("time_and_duration",new ih.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var hh=function(e){function t(e,n){var r;return sh(this,t),(r=uh(this,ch(t).call(this,e,n))).addResolutionButton_(),r.addResolutionMenu_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.resolutionButton_,"click",function(){r.onResolutionClick_()}),r.eventManager.listen(r.player,"variantchanged",function(){r.updateResolutionSelection_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.updateResolutionSelection_()}),r.eventManager.listen(r.player,"abrstatuschanged",function(){r.updateResolutionSelection_()}),r.updateResolutionSelection_(),r.updateLocalizedStrings_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dh(e,t)}(t,_c),lh(t,[{key:"addResolutionButton_",value:function(){this.resolutionButton_=Ue.createHTMLElement("button"),this.resolutionButton_.classList.add("shaka-resolution-button");var e=Ue.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=be.MaterialDesignIcons.RESOLUTION,this.resolutionButton_.appendChild(e);var t=Ue.createHTMLElement("label");t.classList.add("shaka-overflow-button-label"),this.resolutionNameSpan_=Ue.createHTMLElement("span"),t.appendChild(this.resolutionNameSpan_),this.currentResolution_=Ue.createHTMLElement("span"),this.currentResolution_.classList.add("shaka-current-selection-span"),t.appendChild(this.currentResolution_),this.resolutionButton_.appendChild(t),this.parent.appendChild(this.resolutionButton_)}},{key:"addResolutionMenu_",value:function(){this.resolutionMenu_=Ue.createHTMLElement("div"),this.resolutionMenu_.classList.add("shaka-resolutions"),this.resolutionMenu_.classList.add("shaka-no-propagation"),this.resolutionMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.resolutionMenu_.classList.add("shaka-settings-menu"),this.backFromResolutionButton_=Ue.createHTMLElement("button"),this.backFromResolutionButton_.classList.add("shaka-back-to-overflow-button"),this.resolutionMenu_.appendChild(this.backFromResolutionButton_);var e=Ue.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=be.MaterialDesignIcons.BACK,this.backFromResolutionButton_.appendChild(e),this.backFromResolutionSpan_=Ue.createHTMLElement("span"),this.backFromResolutionButton_.appendChild(this.backFromResolutionSpan_),this.controls.getControlsContainer().appendChild(this.resolutionMenu_)}},{key:"updateResolutionSelection_",value:function(){var e=this,t=this.player.getVariantTracks();if(t.length&&!t[0].height)return Be.setDisplay(this.resolutionMenu_,!1),void Be.setDisplay(this.resolutionButton_,!1);Be.setDisplay(this.resolutionButton_,!0),t.sort(function(e,t){return e.height-t.height}),t.reverse();var n=t.find(function(e){return e.active});if(n){var r=n.language;t=t.filter(function(e){return e.language==r})}var i=Be.getFirstDescendantWithClassName(this.resolutionMenu_,"shaka-back-to-overflow-button");Ue.removeAllChildren(this.resolutionMenu_),this.resolutionMenu_.appendChild(i);var a=this.player.getConfiguration().abr.enabled,s=!0,o=!1,l=void 0;try{for(var u,c=function(){var t=u.value,r=Ue.createHTMLElement("button");r.classList.add("explicit-resolution"),e.eventManager.listen(r,"click",function(){return e.onTrackSelected_(t)});var i=Ue.createHTMLElement("span");i.textContent=t.height+"p",r.appendChild(i),a||t!=n||(r.setAttribute("aria-selected","true"),r.appendChild(Be.checkmarkIcon()),i.classList.add("shaka-chosen-item"),e.currentResolution_.textContent=i.textContent),e.resolutionMenu_.appendChild(r)},d=t[Symbol.iterator]();!(s=(u=d.next()).done);s=!0)c()}catch(e){o=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(o)throw l}}var h=Ue.createHTMLElement("button");h.classList.add("shaka-enable-abr-button"),this.eventManager.listen(h,"click",function(){e.player.configure({abr:{enabled:!0}}),e.updateResolutionSelection_()}),this.abrOnSpan_=Ue.createHTMLElement("span"),this.abrOnSpan_.classList.add("shaka-auto-span"),this.abrOnSpan_.textContent=this.localization.resolve(Te.Ids.AUTO_QUALITY),h.appendChild(this.abrOnSpan_),a&&(h.setAttribute("aria-selected","true"),h.appendChild(Be.checkmarkIcon()),this.abrOnSpan_.classList.add("shaka-chosen-item"),this.currentResolution_.textContent=this.localization.resolve(Te.Ids.AUTO_QUALITY)),this.resolutionMenu_.appendChild(h),Be.focusOnTheChosenItem(this.resolutionMenu_),this.controls.dispatchEvent(new w("resolutionselectionupdated"))}},{key:"onResolutionClick_",value:function(){this.controls.dispatchEvent(new w("submenuopen")),Be.setDisplay(this.resolutionMenu_,!0),Be.focusOnTheChosenItem(this.resolutionMenu_)}},{key:"onTrackSelected_",value:function(e){this.player.configure({abr:{enabled:!1}}),this.player.selectVariantTrack(e,!0)}},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.resolutionButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.RESOLUTION)),this.backFromResolutionButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.RESOLUTION)),this.backFromResolutionSpan_.textContent=this.localization.resolve(e.RESOLUTION),this.resolutionNameSpan_.textContent=this.localization.resolve(e.RESOLUTION),this.abrOnSpan_.textContent=this.localization.resolve(e.AUTO_QUALITY),this.player.getConfiguration().abr.enabled&&(this.currentResolution_.textContent=this.localization.resolve(Te.Ids.AUTO_QUALITY))}}]),t}();function fh(e){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ph(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vh(e,t,n){return t&&mh(e.prototype,t),n&&mh(e,n),e}function gh(e,t){return!t||"object"!==fh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yh(e){return(yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _h(e,t){return(_h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hh.Factory=function(){function e(){sh(this,e)}return lh(e,[{key:"create",value:function(e,t){return new hh(e,t)}}]),e}(),xc.registerElement("quality",new hh.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var wh=function(e){function t(e,n){var r;return ph(this,t),(r=gh(this,yh(t).call(this,e,n))).button_=Ue.createHTMLElement("button"),r.button_.classList.add("material-icons"),r.button_.classList.add("shaka-rewind-button"),r.button_.textContent=be.MaterialDesignIcons.REWIND,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.rewind_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_h(e,t)}(t,_c),vh(t,[{key:"updateAriaLabel_",value:function(){this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(Locales.Ids.REWIND))}},{key:"rewind_",value:function(){if(this.video.duration){var e=this.player.getPlaybackRate(),t=e>0||e<-4?-1:2*e;this.player.trickPlay(t)}}}]),t}();function Eh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bh(e){return(bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Th(e,t){return!t||"object"!==bh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kh(e){return(kh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ch(e,t){return(Ch=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wh.Factory=function(){function e(){ph(this,e)}return vh(e,[{key:"create",value:function(e,t){return new wh(e,t)}}]),e}(),pt.registerElement("rewind",new wh.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Ih=function(e){function t(e,n){var r;Sh(this,t),r=Th(this,kh(t).call(this,e,n));var i=Ue.createHTMLElement("div");return i.classList.add("shaka-spacer"),i.setAttribute("aria-hidden",!0),r.parent.appendChild(i),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ch(e,t)}(t,_c),t}();function Ah(e){return(Ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lh(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function Rh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nh(e,t,n){return t&&xh(e.prototype,t),n&&xh(e,n),e}function Mh(e,t){return!t||"object"!==Ah(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ph(e){return(Ph=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oh(e,t){return(Oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ih.Factory=function(){function e(){Sh(this,e)}var t,n,r;return t=e,(n=[{key:"create",value:function(e,t){return new Ih(e,t)}}])&&Eh(t.prototype,n),r&&Eh(t,r),e}(),pt.registerElement("spacer",new Ih.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Dh=function(e){function t(e,n){var r;return Rh(this,t),(r=Mh(this,Ph(t).call(this,e,n))).addCaptionButton_(),r.addTextLangMenu_(),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateLocalizedStrings_(),r.updateTextLanguages_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateLocalizedStrings_(),r.updateTextLanguages_()}),r.eventManager.listen(r.player,"texttrackvisibility",function(){r.onCaptionStateChange_()}),r.eventManager.listen(r.captionButton_,"click",function(){r.onCaptionClick_()}),r.eventManager.listen(r.player,"textchanged",function(){r.updateTextLanguages_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r.onCaptionStateChange_(),r.updateLocalizedStrings_(),r.updateTextLanguages_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oh(e,t)}(t,_c),Nh(t,[{key:"addCaptionButton_",value:function(){this.captionButton_=Ue.createHTMLElement("button"),this.captionButton_.classList.add("shaka-caption-button"),this.captionIcon_=Ue.createHTMLElement("i"),this.captionIcon_.classList.add("material-icons"),this.captionIcon_.textContent=be.MaterialDesignIcons.CLOSED_CAPTIONS,this.player&&this.player.isTextTrackVisible()?this.captionButton_.setAttribute("aria-pressed","true"):this.captionButton_.setAttribute("aria-pressed","false"),this.captionButton_.appendChild(this.captionIcon_);var e=Ue.createHTMLElement("label");e.classList.add("shaka-overflow-button-label"),this.captionsNameSpan_=Ue.createHTMLElement("span"),e.appendChild(this.captionsNameSpan_),this.currentCaptions_=Ue.createHTMLElement("span"),this.currentCaptions_.classList.add("shaka-current-selection-span"),e.appendChild(this.currentCaptions_),this.captionButton_.appendChild(e),this.parent.appendChild(this.captionButton_)}},{key:"addTextLangMenu_",value:function(){this.textLangMenu_=Ue.createHTMLElement("div"),this.textLangMenu_.classList.add("shaka-text-languages"),this.textLangMenu_.classList.add("shaka-no-propagation"),this.textLangMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.textLangMenu_.classList.add("shaka-settings-menu"),this.backFromCaptionsButton_=Ue.createHTMLElement("button"),this.backFromCaptionsButton_.classList.add("shaka-back-to-overflow-button"),this.textLangMenu_.appendChild(this.backFromCaptionsButton_);var e=Ue.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=be.MaterialDesignIcons.BACK,this.backFromCaptionsButton_.appendChild(e),this.backFromCaptionsSpan_=Ue.createHTMLElement("span"),this.backFromCaptionsButton_.appendChild(this.backFromCaptionsSpan_);var t=Ue.createHTMLElement("button");t.setAttribute("aria-selected","true"),this.textLangMenu_.appendChild(t),t.appendChild(Be.checkmarkIcon()),this.captionsOffSpan_=Ue.createHTMLElement("span"),this.captionsOffSpan_.classList.add("shaka-auto-span"),t.appendChild(this.captionsOffSpan_),this.controls.getControlsContainer().appendChild(this.textLangMenu_)}},{key:"onCaptionClick_",value:function(){this.controls.dispatchEvent(new w("submenuopen")),Be.setDisplay(this.textLangMenu_,!0),Be.focusOnTheChosenItem(this.textLangMenu_)}},{key:"onCaptionStateChange_",value:function(){this.player.isTextTrackVisible()?(this.captionIcon_.classList.add("shaka-captions-on"),this.captionIcon_.classList.remove("shaka-captions-off"),this.captionButton_.setAttribute("aria-pressed","true")):(this.captionIcon_.classList.add("shaka-captions-off"),this.captionIcon_.classList.remove("shaka-captions-on"),this.captionButton_.setAttribute("aria-pressed","false")),this.controls.dispatchEvent(new w("captionselectionupdated"))}},{key:"updateTextLanguages_",value:function(){var e=this,t=this.player.getTextTracks(),n=this.player.getTextLanguagesAndRoles().map(function(e){return e.language});Fc.updateLanguages(t,this.textLangMenu_,n,function(t){return e.onTextLanguageSelected_(t)},this.player.isTextTrackVisible(),this.currentCaptions_,this.localization);var r=Ue.createHTMLElement("button");r.classList.add("shaka-turn-captions-off-button"),this.eventManager.listen(r,"click",function(){e.player.setTextTrackVisibility(!1).catch(function(){}),e.updateTextLanguages_()}),r.appendChild(this.captionsOffSpan_),this.textLangMenu_.appendChild(r),this.player.isTextTrackVisible()||(r.setAttribute("aria-selected","true"),r.appendChild(Be.checkmarkIcon()),this.captionsOffSpan_.classList.add("shaka-chosen-item"),this.currentCaptions_.textContent=this.localization.resolve(Te.Ids.OFF)),Be.focusOnTheChosenItem(this.textLangMenu_),this.controls.dispatchEvent(new w("captionselectionupdated"))}},{key:"onTextLanguageSelected_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.player.setTextTrackVisibility(!0);case 2:this.player&&this.player.selectTextLanguage(t);case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Lh(a,r,i,s,o,"next",e)}function o(e){Lh(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"updateLocalizedStrings_",value:function(){var e=Te.Ids;this.captionButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.CAPTIONS)),this.backFromCaptionsButton_.setAttribute(we.ARIA_LABEL,this.localization.resolve(e.BACK)),this.captionsNameSpan_.textContent=this.localization.resolve(e.CAPTIONS),this.backFromCaptionsSpan_.textContent=this.localization.resolve(e.CAPTIONS),this.captionsOffSpan_.textContent=this.localization.resolve(e.OFF)}},{key:"onTracksChanged_",value:function(){var e=this.player.getTextTracks().length>0;Be.setDisplay(this.captionButton_,e),this.updateTextLanguages_()}}]),t}();function Uh(e){return(Uh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vh(e,t,n){return t&&Bh(e.prototype,t),n&&Bh(e,n),e}function Hh(e,t){return!t||"object"!==Uh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gh(e){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jh(e,t){return(jh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dh.Factory=function(){function e(){Rh(this,e)}return Nh(e,[{key:"create",value:function(e,t){return new Dh(e,t)}}]),e}(),xc.registerElement("captions",new Dh.Factory),window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Kh=function(e){function t(e,n){var r;return Fh(this,t),(r=Hh(this,Gh(t).call(this,e,n))).container_=Ue.createHTMLElement("div"),r.container_.classList.add("shaka-volume-bar-container"),r.bar_=document.createElement("input"),r.bar_.classList.add("shaka-volume-bar"),r.bar_.setAttribute("type","range"),r.bar_.setAttribute("step","any"),r.bar_.setAttribute("min","0"),r.bar_.setAttribute("max","1"),r.bar_.setAttribute("value","0"),r.container_.appendChild(r.bar_),r.parent.appendChild(r.container_),r.updateAriaLabel_(),r.eventManager.listen(r.video,"volumechange",function(){r.onVolumeStateChange_()}),r.eventManager.listen(r.bar_,"input",function(){r.onVolumeInput_()}),r.eventManager.listen(r.localization,Pe.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,Pe.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.onVolumeStateChange_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jh(e,t)}(t,_c),Vh(t,[{key:"onVolumeStateChange_",value:function(){this.video.muted?this.bar_.value=0:this.bar_.value=this.video.volume;var e=["to right"];e.push(we.VOLUME_BAR_VOLUME_LEVEL_COLOR+100*this.bar_.value+"%"),e.push(we.VOLUME_BAR_BASE_COLOR+100*this.bar_.value+"%"),e.push(we.VOLUME_BAR_BASE_COLOR+"100%"),this.container_.style.background="linear-gradient("+e.join(",")+")"}},{key:"onVolumeInput_",value:function(){this.video.volume=parseFloat(this.bar_.value),0==this.video.volume?this.video.muted=!0:this.video.muted=!1}},{key:"updateAriaLabel_",value:function(){this.bar_.setAttribute(we.ARIA_LABEL,this.localization.resolve(Te.Ids.VOLUME))}}]),t}();function Wh(e){return i.a.createElement("div",{id:"main-layout",className:"mdl-layout mdl-js-layout mdl-layout--fixed-header"},i.a.createElement("header",{className:"app-header mdl-layout__header"},i.a.createElement("header",{className:"mdl-layout__header-row",id:"nav-button-container"},i.a.createElement("button",{id:"nav-button-front",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail",defaultselected:!0},"HOME"),i.a.createElement("button",{id:"nav-button-search",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail"},"SEARCH"),i.a.createElement("button",{id:"nav-button-custom",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail"},"CUSTOM CONTENT"),i.a.createElement("div",{className:"mdl-layout-spacer"}),i.a.createElement("div",{id:"version-block"},i.a.createElement("span",{id:"version-string"})))),i.a.createElement("div",{className:"mdl-layout__drawer hamburger-menu"},i.a.createElement("div",{id:"hamburger-menu-title",className:"mdl-layout-title"},"Demo",i.a.createElement("div",{className:"mdl-layout-spacer"}),i.a.createElement("button",{id:"drawer-close-button",className:"mdl-button mdl-js-button mdl-button--icon should-disable-on-fail"},i.a.createElement("i",{className:"material-icons"},"close"))),i.a.createElement("nav",{className:"mdl-navigation",id:"hamburger-menu-contents"})),i.a.createElement("div",{id:"error-display",className:"hidden"},i.a.createElement("div",{id:"error-display-close-button"},"x"),i.a.createElement("a",{id:"error-display-link",href:"#"})),i.a.createElement("main",{className:"mdl-layout__content",id:"main-div"},i.a.createElement("div",{id:"video-bar",className:"hidden"},i.a.createElement("div",{"data-shaka-player-container":!0,"data-shaka-player-cast-receiver-id":"7B25EC44",className:"video-container"},i.a.createElement("video",{"data-shaka-player":!0,autoPlay:!0,playsInline:!0,id:"video"}))),i.a.createElement("div",{id:"contents"})))}Kh.Factory=function(){function e(){Fh(this,e)}return Vh(e,[{key:"create",value:function(e,t){return new Kh(e,t)}}]),e}(),pt.registerElement("volume",new Kh.Factory),n.d(t,"default",function(){return Wh})}])});