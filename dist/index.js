!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("mux.js"),require("tippy.js"),require("popper.js")):"function"==typeof define&&define.amd?define(["react","mux.js","tippy.js","popper.js"],t):"object"==typeof exports?exports.shakaplayer=t(require("react"),require("mux.js"),require("tippy.js"),require("popper.js")):e.shakaplayer=t(e.react,e["mux.js"],e["tippy.js"],e["popper.js"])}(this,function(__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__6__,__WEBPACK_EXTERNAL_MODULE__14__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){(function(e){!function(){var n="undefined"!=typeof window?window:e,r={};for(var i in function(e,t){var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},i=void 0!==e&&e===this?this:void 0!==t&&null!=t?t:this;function a(){a=function(){},i.Symbol||(i.Symbol=o)}var s,o=(s=0,function(e){return"jscomp_symbol_"+(e||"")+s++});function u(){a();var e=i.Symbol.iterator;e||(e=i.Symbol.iterator=i.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&r(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return l(this)}}),u=function(){}}function l(e){var t=0;return c(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function c(e){return u(),(e={next:e})[i.Symbol.iterator]=function(){return this},e}function d(e){u();var t=e[Symbol.iterator];return t?t.call(e):l(e)}function h(e,t){if(t){for(var n=i,a=e.split("."),s=0;s<a.length-1;s++){var o=a[s];o in n||(n[o]={}),n=n[o]}(o=t(s=n[a=a[a.length-1]]))!=s&&null!=o&&r(n,a,{configurable:!0,writable:!0,value:o})}}function f(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(r,i){!function e(a){a.done?r(a.value):Promise.resolve(a.value).then(t,n).then(e,i)}(e.next())})}(e())}h("Promise",function(e){function t(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.a=null}function r(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},n.prototype.f=function(){var e=this;this.c(function(){e.h()})};var a=i.setTimeout;n.prototype.c=function(e){a(e,0)},n.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.g(e)}}}this.a=null},n.prototype.g=function(e){this.c(function(){throw e})},t.prototype.c=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.o),reject:e(this.f)}},t.prototype.o=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.v(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.m(e):this.h(e)}},t.prototype.m=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.C(t,e):this.h(e)},t.prototype.f=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new n;return t.prototype.v=function(e){var t=this.c();e.Yb(t.resolve,t.reject)},t.prototype.C=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){a(e)}}:t}var i,a,s=new t(function(e,t){i=e,a=t});return this.Yb(r(e,i),r(n,a)),s},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Yb=function(e,t){function n(){switch(r.b){case 1:e(r.g);break;case 2:t(r.g);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=r,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var i=d(e),a=i.next();!a.done;a=i.next())r(a.value).Yb(t,n)})},t.all=function(e){var n=d(e),i=n.next();return i.done?r([]):new t(function(e,t){function a(t){return function(n){s[t]=n,0==--o&&e(s)}}var s=[],o=0;do{s.push(void 0),o++,r(i.value).Yb(a(s.length-1),t),i=n.next()}while(!i.done)})},t}),h("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}});var p,m="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)p=Object.setPrototypeOf;else{var v;e:{var y={};try{y.__proto__={ne:!0},v=y.ne;break e}catch(s){}v=!1}p=v?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=p;function _(){this.g=!1,this.c=null,this.s=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function b(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function w(e,t){e.a={xd:t,Gd:!0},e.j=e.f||e.b}function E(e,t,n){return e.j=n,{value:t}}function S(e){e.j=0}function T(e,t,n){e.f=t,null!=n&&(e.b=n)}function k(e,t){e.f=0,e.b=t||0}function C(e,t){e.j=t,e.f=0}function I(e){e.f=0;var t=e.a.xd;return e.a=null,t}function A(e){e.i=[e.a],e.f=0,e.b=0}function x(e,t){var n=e.i.splice(0)[0];(n=e.a=e.a||n)?n.Gd?e.j=e.f||e.b:null!=n.A&&e.b<n.A?(e.j=n.A,e.a=null):e.j=e.b:e.j=t}function L(e){this.a=new _,this.b=e}function N(e,t,n,r){try{var i=t.call(e.a.c,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.a.g=!1,i;var a=i.value}catch(t){return e.a.c=null,w(e.a,t),R(e)}return e.a.c=null,r.call(e.a,a),R(e)}function R(e){for(;e.a.j;)try{var t=e.b(e.a);if(t)return e.a.g=!1,{value:t.value,done:!1}}catch(t){e.a.s=void 0,w(e.a,t)}if(e.a.g=!1,e.a.a){if(t=e.a.a,e.a.a=null,t.Gd)throw t.xd;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function M(e){this.next=function(t){return b(e.a),e.a.c?t=N(e,e.a.c.next,t,e.a.h):(e.a.h(t),t=R(e)),t},this.throw=function(t){return b(e.a),e.a.c?t=N(e,e.a.c.throw,t,e.a.h):(w(e.a,t),t=R(e)),t},this.return=function(t){return function(e,t){b(e.a);var n=e.a.c;return n?N(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),R(e))}(e,t)},u(),this[Symbol.iterator]=function(){return this}}function P(e,t){return M.prototype=e.prototype,new M(new L(t))}function O(e){if(!(e instanceof Array)){e=d(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return{Cd:i,ie:a}}return{Cd:-1,ie:void 0}}function F(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}_.prototype.h=function(e){this.s=e},_.prototype.return=function(e){this.a={return:e},this.j=this.b},_.prototype.A=function(e){this.j=e},h("WeakMap",function(e){function t(e){if(this.a=(o+=Math.random()+1).toString(),e){a(),u(),e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){D(e,s)||r(e,s,{value:{}})}function i(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var o=0;return t.prototype.set=function(e,t){if(n(e),!D(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.a]=t,this},t.prototype.get=function(e){return D(e,s)?e[s][this.a]:void 0},t.prototype.has=function(e){return D(e,s)&&D(e[s],this.a)},t.prototype.delete=function(e){return!(!D(e,s)||!D(e[s],this.a))&&delete e[s][this.a]},t}),h("Map",function(e){function t(){var e={};return e.Ca=e.next=e.head=e}function n(e,t){var n=e.a;return c(function(){if(n){for(;n.head!=e.a;)n=n.Ca;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?s.has(t)?n=s.get(t):(n=""+ ++o,s.set(t,n)):n="p_"+t;var r=e.b[n];if(r&&D(e.b,n))for(var i=0;i<r.length;i++){var a=r[i];if(t!=t&&a.key!=a.key||t===a.key)return{id:n,list:r,index:i,X:a}}return{id:n,list:r,index:-1,X:void 0}}function i(e){if(this.b={},this.a=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(e){return!1}}())return e;a(),u();var s=new WeakMap;i.prototype.set=function(e,t){var n=r(this,e);return n.list||(n.list=this.b[n.id]=[]),n.X?n.X.value=t:(n.X={next:this.a,Ca:this.a.Ca,head:this.a,key:e,value:t},n.list.push(n.X),this.a.Ca.next=n.X,this.a.Ca=n.X,this.size++),this},i.prototype.delete=function(e){return!(!(e=r(this,e)).X||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.X.Ca.next=e.X.next,e.X.next.Ca=e.X.Ca,e.X.head=null,this.size--,!0)},i.prototype.clear=function(){this.b={},this.a=this.a.Ca=t(),this.size=0},i.prototype.has=function(e){return!!r(this,e).X},i.prototype.get=function(e){return(e=r(this,e).X)&&e.value},i.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},i.prototype.keys=function(){return n(this,function(e){return e.key})},i.prototype.values=function(){return n(this,function(e){return e.value})},i.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i}),h("Set",function(e){function t(e){if(this.a=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&(!(i=r.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&r.next().done)}catch(e){return!1}}()?e:(a(),u(),t.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},t.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.a.forEach(function(r){return e.call(t,r,r,n)})},t)}),h("Array.prototype.findIndex",function(e){return e||function(e,t){return U(this,e,t).Cd}}),h("Array.prototype.keys",function(e){return e||function(){return function(e,t){u(),e instanceof String&&(e+="");var n=0,r={next:function(){if(n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,function(e){return e})}}),h("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),h("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length,i=t||0;for(0>i&&(i=Math.max(i+r,0));i<r;i++){var a=n[i];if(a===e||Object.is(a,e))return!0}return!1}}),h("String.prototype.includes",function(e){return e||function(e,t){return-1!==F(this,e,"includes").indexOf(e,t||0)}}),h("Array.from",function(e){return e||function(e,t,n){u(),t=null!=t?t:function(e){return e};var r=[],i=e[Symbol.iterator];if("function"==typeof i)for(e=i.call(e);!(i=e.next()).done;)r.push(t.call(n,i.value));else{i=e.length;for(var a=0;a<i;a++)r.push(t.call(n,e[a]))}return r}}),h("String.prototype.startsWith",function(e){return e||function(e,t){for(var n=F(this,e,"startsWith"),r=n.length,i=e.length,a=Math.max(0,Math.min(0|t,n.length)),s=0;s<i&&a<r;)if(n[a++]!=e[s++])return!1;return s>=i}}),h("Array.prototype.find",function(e){return e||function(e,t){return U(this,e,t).ie}});var B=this;function V(e,t){var n,r=e.split("."),i=B;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(;r.length&&(n=r.shift());)r.length||void 0===t?i=i[n]?i[n]:i[n]={}:i[n]=t}function j(e,t){function n(){}n.prototype=t.prototype,e.ag=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.og=function(e,n,r){return t.prototype[n].apply(e,Array.prototype.slice.call(arguments,2))}}function H(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function K(e,t,n){var r=Math.pow(e.c,t);n=n*(1-r)+r*e.a,isNaN(n)||(e.a=n,e.b+=t)}function G(e){return e.a/(1-Math.pow(e.c,e.b))}function W(){this.b=new H(2),this.c=new H(5),this.a=0}function q(){}function z(){}function Y(){}B.a=!0,W.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(G(this.b),G(this.c))},e.console&&e.console.log.bind&&(z=console.warn.bind(console),q=console.error.bind(console));var X=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function $(e){var t;e instanceof $?(Q(this,e.va),this.$a=e.$a,this.ra=e.ra,Z(this,e.xb),this.ia=e.ia,J(this,e.a.clone()),this.Qa=e.Qa):e&&(t=String(e).match(X))?(Q(this,t[1]||"",!0),this.$a=ee(t[2]||""),this.ra=ee(t[3]||"",!0),Z(this,t[4]),this.ia=ee(t[5]||"",!0),J(this,t[6]||"",!0),this.Qa=ee(t[7]||"")):this.a=new ue(null)}function Q(e,t,n){e.va=n?ee(t,!0):t,e.va&&(e.va=e.va.replace(/:$/,""))}function Z(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.xb=t}else e.xb=null}function J(e,t,n){t instanceof ue?e.a=t:(n||(t=te(t,se)),e.a=new ue(t))}function ee(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function te(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ne),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ne(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(n=$.prototype).va="",n.$a="",n.ra="",n.xb=null,n.ia="",n.Qa="",n.toString=function(){var e=[],t=this.va;if(t&&e.push(te(t,re,!0),":"),t=this.ra){e.push("//");var n=this.$a;n&&e.push(te(n,re,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.xb)&&e.push(":",String(t))}return(t=this.ia)&&(this.ra&&"/"!=t.charAt(0)&&e.push("/"),e.push(te(t,"/"==t.charAt(0)?ae:ie,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.Qa)&&e.push("#",te(t,oe)),e.join("")},n.resolve=function(e){var t=this.clone();"data"===t.va&&(t=new $);var n=!!e.va;n?Q(t,e.va):n=!!e.$a,n?t.$a=e.$a:n=!!e.ra,n?t.ra=e.ra:n=null!=e.xb;var r=e.ia;if(n)Z(t,e.xb);else if(n=!!e.ia){if("/"!=r.charAt(0))if(this.ra&&!this.ia)r="/"+r;else{var i=t.ia.lastIndexOf("/");-1!=i&&(r=t.ia.substr(0,i+1)+r)}if(".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],s=0;s<r.length;){var o=r[s++];"."==o?i&&s==r.length&&a.push(""):".."==o?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&s==r.length&&a.push("")):(a.push(o),i=!0)}r=a.join("/")}}return n?t.ia=r:n=""!==e.a.toString(),n?J(t,e.a.clone()):n=!!e.Qa,n&&(t.Qa=e.Qa),t},n.clone=function(){return new $(this)};var re=/[#\/\?@]/g,ie=/[#\?:]/g,ae=/[#\?]/g,se=/[#\?@]/g,oe=/#/g;function ue(e){this.a=e||null}function le(e){this.b=e,this.a=null}function ce(e){this.b=e,this.a=null}function de(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.i=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?n.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function he(e){return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:if(e.a>=e.i){if(!e.c)return t.return(Promise.reject());e.a=1,e.b=e.f}return n=e.a,e.a++,0==n?t.return():(r=e.b*(1+(2*Math.random()-1)*e.h),E(t,new Promise(function(e){new ce(e).O(r/1e3)}),2));case 2:e.b*=e.g,S(t)}})})}function fe(e,t,n,r){for(var i=[],a=3;a<arguments.length;++a)i[a-3]=arguments[a];this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1}function pe(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n}function me(e,t){this.promise=e,this.Jd=t,this.a=!1}function ve(e){return new me(Promise.reject(e),function(){return Promise.resolve()})}function ye(){var e=Promise.reject(new fe(2,7,7001));return e.catch(function(){}),new me(e,function(){return Promise.resolve()})}function ge(e){return new me(Promise.resolve(e),function(){return Promise.resolve()})}function _e(e){return new me(e,function(){return e.catch(function(){})})}function be(e){return new me(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function we(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then(function(){}).catch(function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}function Ee(t,n){for(var r in n=void 0===n?{}:n)this[r]=n[r];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Se(){this.a={}}function Te(){this.Bc=new Se,this.Vb=this}function ke(e){var t=new Set;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var r=n.constructor==Array;if(n.constructor!=Object&&!r)return null;t.add(n);var i,a=r?[]:{};for(i in n)a[i]=e(n[i]);return r&&(a.length=n.length),a}}(e)}function Ce(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ie(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function Ae(e,t,n){if(n||(n=Ce),e.length!=t.length)return!1;t=t.slice();for(var r={},i=(e=d(e)).next();!i.done;r={item:r.item},i=e.next()){if(r.item=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.item,t)}}(r))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function xe(){this.a=[]}function Le(e,t){e.a.push(t.finally(function(){Ie(e.a,t)}))}function Ne(e){Te.call(this),this.f=!1,this.g=new xe,this.a=new Set,this.b=new Set,this.c=e||null}(n=ue.prototype).ga=null,n.$b=null,n.add=function(e,t){if(!this.ga&&(this.ga={},this.$b=0,this.a))for(var n=this.a.split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("="),a=null;if(0<=i){var s=n[r].substring(0,i);a=n[r].substring(i+1)}else s=n[r];s=decodeURIComponent(s.replace(/\+/g," ")),a=a||"",this.add(s,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(n=this.ga.hasOwnProperty(e)&&this.ga[e])||(this.ga[e]=n=[]),n.push(t),this.$b++,this},n.toString=function(){if(this.a)return this.a;if(!this.ga)return"";var e,t=[];for(e in this.ga)for(var n=encodeURIComponent(e),r=this.ga[e],i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),t.push(a)}return this.a=t.join("&")},n.clone=function(){var e=new ue;if(e.a=this.a,this.ga){var t,n={};for(t in this.ga)n[t]=this.ga[t].concat();e.ga=n,e.$b=this.$b}return e},le.prototype.O=function(t){var n=this;this.stop();var r=!0,i=null;return this.a=function(){e.clearTimeout(i),r=!1},i=e.setTimeout(function(){r&&n.b()},1e3*t),this},le.prototype.stop=function(){this.a&&(this.a(),this.a=null)},V("shaka.util.Timer",ce),ce.prototype.sc=function(){return this.stop(),this.b(),this},ce.prototype.tickNow=ce.prototype.sc,ce.prototype.O=function(e){var t=this;return this.stop(),this.a=new le(function(){t.b()}).O(e),this},ce.prototype.tickAfter=ce.prototype.O,ce.prototype.La=function(e){var t=this;return this.stop(),this.a=new le(function(){t.a.O(e),t.b()}).O(e),this},ce.prototype.tickEvery=ce.prototype.La,ce.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},ce.prototype.stop=ce.prototype.stop,V("shaka.util.Error",fe),fe.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},fe.Severity={RECOVERABLE:1,CRITICAL:2},fe.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},fe.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},pe.prototype.resolve=function(){},pe.prototype.reject=function(){},V("shaka.util.AbortableOperation",me),me.failed=ve,me.aborted=ye,me.completed=ge,me.notAbortable=_e,me.prototype.abort=function(){return this.a=!0,this.Jd()},me.prototype.abort=me.prototype.abort,me.all=be,me.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},me.prototype.finally=me.prototype.finally,me.prototype.U=function(e,t){function n(){return i.reject(new fe(2,7,7001)),r.abort()}var r=this,i=new pe;return this.promise.then(function(t){r.a?i.reject(new fe(2,7,7001)):e?n=we(e,t,i):i.resolve(t)},function(e){t?n=we(t,e,i):i.reject(e)}),new me(i,function(){return n()})},me.prototype.chain=me.prototype.U,Ee.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ee.prototype.stopImmediatePropagation=function(){this.a=!0},Ee.prototype.stopPropagation=function(){},(n=Se.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},n.get=function(e){return(e=this.a[e])?e.slice():null},n.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},n.remove=function(e,t){var n=this.a[e];if(n)for(var r=0;r<n.length;++r)n[r]==t&&(n.splice(r,1),--r)},n.forEach=function(e){for(var t in this.a)e(t,this.a[t])},Te.prototype.addEventListener=function(e,t){this.Bc.push(e,t)},Te.prototype.removeEventListener=function(e,t){this.Bc.remove(e,t)},Te.prototype.dispatchEvent=function(e){for(var t=this.Bc.get(e.type)||[],n=0;n<t.length;++n){e.target=this.Vb,e.currentTarget=this.Vb;var r=t[n];try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){}if(e.a)break}return e.defaultPrevented},xe.prototype.destroy=function(){var e=[];return this.a.forEach(function(t){t.promise.catch(function(){}),e.push(t.abort())}),this.a=[],Promise.all(e)},j(Ne,Te),V("shaka.net.NetworkingEngine",Ne);var Re={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};Ne.RequestType=Re,Ne.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Me={};function Pe(e,t,n){n=n||3;var r=Me[e];(!r||n>=r.priority)&&(Me[e]={priority:n,zf:t})}function Oe(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null}}function De(){this.a=0}function Ue(e,t,n){me.call(this,e,t),this.b=n}Ne.registerScheme=Pe,Ne.unregisterScheme=function(e){delete Me[e]},Ne.prototype.Bf=function(e){this.a.add(e)},Ne.prototype.registerRequestFilter=Ne.prototype.Bf,Ne.prototype.cg=function(e){this.a.delete(e)},Ne.prototype.unregisterRequestFilter=Ne.prototype.cg,Ne.prototype.we=function(){this.a.clear()},Ne.prototype.clearAllRequestFilters=Ne.prototype.we,Ne.prototype.Cf=function(e){this.b.add(e)},Ne.prototype.registerResponseFilter=Ne.prototype.Cf,Ne.prototype.dg=function(e){this.b.delete(e)},Ne.prototype.unregisterResponseFilter=Ne.prototype.dg,Ne.prototype.xe=function(){this.b.clear()},Ne.prototype.clearAllResponseFilters=Ne.prototype.xe,Ne.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Ne.prototype.destroy=Ne.prototype.destroy,Ne.prototype.request=function(e,t){var n=this,r=new De;if(this.f){var i=Promise.reject(new fe(2,7,7001));return i.catch(function(){}),new Ue(i,function(){return Promise.resolve()},r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?ke(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=ke(t.uris);var a=(i=function(e,t,n){for(var r=ge(void 0),i={},a=(e=d(e.a)).next();!a.done;i={ed:i.ed},a=e.next())i.ed=a.value,r=r.U(function(e){return function(){return e.ed(t,n)}}(i));return r.U(void 0,function(e){if(e&&7001==e.code)throw e;throw new fe(2,1,1006,e)})}(this,e,t)).U(function(){return function e(t,n,r,i,a,s,o){var u=new $(r.uris[a]),l=u.va,c=!1;l||(l=location.protocol,l=l.slice(0,-1),Q(u,l),r.uris[a]=u.toString());var d=(l=Me[l])?l.zf:null;if(!d)return ve(new fe(2,1,1e3,u));var h;return _e(he(i)).U(function(){return t.f?ye():(h=Date.now(),d(r.uris[a],r,n,function(e,r,i){t.c&&1==n&&(t.c(e,r),c=!0,o.a=i)}))}).U(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-h),{response:e,Ze:c}},function(u){if(u&&7001==u.code)throw u;if(t.f)return ye();if(u&&1==u.severity)return t.dispatchEvent(new Ee("retry",{error:u instanceof fe?u:null})),a=(a+1)%r.uris.length,e(t,n,r,i,a,u,o);throw u||s})}(n,e,t,new de(t.retryParameters,!1),0,null,r)}),s=a.U(function(t){return function(e,t,n){for(var r=ge(void 0),i=(e=d(e.b)).next();!i.done;i=e.next())r=r.U(i.value.bind(null,t,n.response));return r.U(function(){return n},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof fe&&(t=e.severity),new fe(t,1,1007,e)})}(n,e,t)}),o=Date.now(),u=0;i.promise.then(function(){u=Date.now()-o},function(){});var l=0;return a.promise.then(function(){l=Date.now()},function(){}),i=new Ue((i=s.U(function(t){var r=Date.now()-l,i=t.response;return i.timeMs+=u,i.timeMs+=r,t.Ze||!n.c||i.fromCache||1!=e||n.c(i.timeMs,i.data.byteLength),i},function(e){throw e&&(e.severity=2),e})).promise,i.Jd,r),Le(this.g,i),i},Ne.prototype.request=Ne.prototype.request,Ne.NumBytesRemainingClass=De;var Fe=Ue;if(Fe.prototype=m(me.prototype),Fe.prototype.constructor=Fe,g)g(Fe,me);else for(var Be in me)if("prototype"!=Be)if(Object.defineProperties){var Ve=Object.getOwnPropertyDescriptor(me,Be);Ve&&Object.defineProperty(Fe,Be,Ve)}else Fe[Be]=me[Be];function je(){}function He(){this.a=new Se}function Ke(e,t,n,r){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),function(e){var t=Ge;if(null==t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},e.addEventListener("test",r,n),e.removeEventListener("test",r,n)}catch(e){t=!1}Ge=t}return t||!1}(e)?t:t.capture||!1}(e,r),this.target.addEventListener(t,n,this.a)}Fe.ag=me.prototype,Ne.PendingRequest=Ue,Ue.all=be,Ue.notAbortable=_e,Ue.completed=ge,Ue.aborted=ye,Ue.failed=ve,V("shaka.util.IReleasable",je),je.prototype.release=function(){},V("shaka.util.EventManager",He),He.prototype.release=function(){this.Ya(),this.a=null},He.prototype.release=He.prototype.release,He.prototype.w=function(e,t,n,r){this.a&&(e=new Ke(e,t,n,r),this.a.push(t,e))},He.prototype.listen=He.prototype.w,He.prototype.ha=function(e,t,n,r){var i=this;this.w(e,t,function r(a){i.da(e,t,r),n(a)},r)},He.prototype.listenOnce=He.prototype.ha,He.prototype.da=function(e,t,n){if(this.a)for(var r=this.a.get(t)||[],i=(r=d(r)).next();!i.done;i=r.next())(i=i.value).target!=e||n!=i.listener&&n||(i.da(),this.a.remove(t,i))},He.prototype.unlisten=He.prototype.da,He.prototype.Ya=function(){if(this.a){for(var e=this.a.getAll(),t=(e=d(e)).next();!t.done;t=e.next())t.value.da();this.a.a={}}},He.prototype.removeAll=He.prototype.Ya,Ke.prototype.da=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},Ke.prototype.unlisten=Ke.prototype.da;var Ge=void 0;function We(e,t){for(var n=d(e),r=n.next();!r.done;r=n.next())if(!t(r.value))return!1;return!0}function qe(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n])}),t}function ze(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}function Ye(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function Xe(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}var $e=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Qe(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function Ze(e){return""!=(tt||(et||(et=new ce(function(){tt=null})),(tt=document.querySelector("video")||document.querySelector("audio"))||(tt=document.createElement("video")),et.O(1),tt)).canPlayType(e)}function Je(e){return(navigator.userAgent||"").includes(e)}var et=null,tt=null;function nt(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=ot(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new fe(2,2,2004)}}function rt(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new fe(2,2,2004);if(e instanceof ArrayBuffer)var r=e;else(n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),r=n.buffer;e=Math.floor(e.byteLength/2),n=new Uint16Array(e),r=new DataView(r);for(var i=0;i<e;i++)n[i]=r.getUint16(2*i,t);return ot(n)}function it(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return nt(t);if(254==t[0]&&255==t[1])return rt(t.subarray(2),!1);if(255==t[0]&&254==t[1])return rt(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(0==t[0]&&0==t[2])return rt(e,!1);if(0==t[1]&&0==t[3])return rt(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return nt(e);throw new fe(2,2,2003)}function at(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function st(e,t){for(var n=new Uint8Array(2*e.length),r=new DataView(n.buffer),i=0;i<e.length;++i)r.setUint16(2*i,e.charCodeAt(i),t);return n.buffer}function ot(e){if(!ut)for(var t=function(e){try{return O(new Uint8Array(e)),!0}catch(e){return!1}},n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(t(n.size)){ut=function(e){return function(t){for(var n="",r=0;r<t.length;r+=e.size)n+=String.fromCharCode.apply(String,O(t.subarray(r,r+e.size)));return n}}(n);break}return ut(e)}V("shaka.util.StringUtils.fromUTF8",nt),V("shaka.util.StringUtils.fromUTF16",rt),V("shaka.util.StringUtils.fromBytesAutoDetect",it),V("shaka.util.StringUtils.toUTF8",at),V("shaka.util.StringUtils.toUTF16",st);var ut=null;function lt(t,n){var r=ot(t);return n=null==n||n,r=e.btoa(r).replace(/\+/g,"-").replace(/\//g,"_"),n?r:r.replace(/=*$/,"")}function ct(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}function dt(t){for(var n=new Uint8Array(t.length/2),r=0;r<t.length;r+=2)n[r/2]=e.parseInt(t.substr(r,2),16);return n}function ht(e){for(var t="",n=0;n<e.length;++n){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t}function ft(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0}function pt(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var r=n=0;r<t.length;++r)n+=t[r].length;n=new Uint8Array(n);for(var i=r=0;i<t.length;++i)n.set(t[i],r),r+=t[i].length;return n}function mt(e){var t=this;this.C=e,this.v=new Set,this.m=this.h=null,this.P=!1,this.a=null,this.i=new He,this.b=new Map,this.o=[],this.l=new pe,this.f=null,this.g=function(n){t.l.reject(n),e.onError(n)},this.na=new Map,this.T=new Map,this.M=new ce(function(){return function(e){var t=e.na,n=e.T;n.clear(),t.forEach(function(e,t){return n.set(t,e)}),(t=Array.from(n.values())).length&&t.every(function(e){return"expired"==e})&&e.g(new fe(2,6,6014)),e.C.kc(ze(n))}(t)}),this.c=!1,this.$=new pe,this.D=!1,this.G=[],this.ma=!1,this.W=new ce(function(){var e;(e=t).b.forEach(function(t,n){var r=t.Xc,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.C.onExpirationUpdated(n.sessionId,i),t.Xc=i)})}).La(1),this.l.catch(function(){})}function vt(e,t,n){return e.o=n,e.D=0<n.length,yt(e,t)}function yt(t,n){var r=n.some(function(e){return 0<e.drmInfos.length});if(!r){var i=qe(t.f.servers);!function(e,t){var n=[];t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var r=d(e),i=r.next();!i.done;i=r.next())i.value.drmInfos=n}(n,i)}var a=function(t){if(0==(t=qe(t.f.clearKeys)).size)return null;var n=[],r=[];t.forEach(function(e,t){var i=dt(t),a=dt(e);i={kty:"oct",kid:lt(i,!1),k:lt(a,!1)},n.push(i),r.push(i.kid)}),t=JSON.stringify({keys:n});var i=JSON.stringify({kids:r});return i=[{initData:new Uint8Array(at(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:i,keyIds:[]}}(t);if(a){var s=d(n);for(i=s.next();!i.done;i=s.next())i.value.drmInfos=[a]}for(i=(a=d(n)).next();!i.done;i=a.next())for(s=(i=d(i.value.drmInfos)).next();!s.done;s=i.next())Nt(s.value,qe(t.f.servers),qe(t.f.advanced||{}));return(i=function(e,t){for(var n=new Set,r=d(t),i=r.next();!i.done;i=r.next()){var a=d(i.value.drmInfos);for(i=a.next();!i.done;i=a.next())n.add(i.value)}for(r=d(n),i=r.next();!i.done;i=r.next())Nt(i.value,qe(e.f.servers),qe(e.f.advanced||{}));a=e.D?"required":"optional";var s=e.D?["persistent-license"]:["temporary"];for(r=new Map,n=d(n),i=n.next();!i.done;i=n.next())i=i.value,r.set(i.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:s,label:i.keySystem,drmInfos:[]});for(n=d(t),i=n.next();!i.done;i=n.next()){i=i.value,a=i.audio,s=i.video;var o=a?Ye(a.mimeType,a.codecs):"",u=s?Ye(s.mimeType,s.codecs):"",l=d(i.drmInfos);for(i=l.next();!i.done;i=l.next()){i=i.value;var c=r.get(i.keySystem);c.drmInfos.push(i),i.distinctiveIdentifierRequired&&(c.distinctiveIdentifier="required"),i.persistentStateRequired&&(c.persistentState="required"),a&&c.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:o}),s&&c.videoCapabilities.push({robustness:i.videoRobustness||"",contentType:u})}}return r}(t,n)).size?(i=St(t,i),r?i:i.catch(function(){})):(t.P=!0,Promise.resolve())}function gt(e){return f(function t(){var n;return P(t,function(t){switch(t.j){case 1:if(!(e.h&&e.a&&e.a.serverCertificate&&e.a.serverCertificate.length)){t.A(0);break}return T(t,3),E(t,e.h.setServerCertificate(e.a.serverCertificate),5);case 5:C(t,0);break;case 3:return n=I(t),t.return(Promise.reject(new fe(2,6,6004,n.message)))}})})}function _t(e){var t=e.a?e.a.initData:[];return t.forEach(function(t){return kt(e,t.initDataType,t.initData)}),e.o.forEach(function(t){return Tt(e,t)}),t.length||e.o.length||e.l.resolve(),e.l}function bt(e,t,n){for(var r=e.b.values(),i=(r=d(r)).next();!i.done;i=r.next())if(ft(n,i.value.initData))return;kt(e,t,n)}function wt(e,t){return!!Je("Edge/")||e.v.has(t)}function Et(e){return e=function(e,t){for(var n=[],r=d(e),i=r.next();!i.done;i=r.next())n.push(t(i.value));return n}(e=e.b.keys(),function(e){return e.sessionId}),Array.from(e)}function St(e,t){if(1==t.size&&t.has(""))return Promise.reject(new fe(2,6,6e3));for(var n=d(t.values()),r=n.next();!r.done;r=n.next())0==(r=r.value).audioCapabilities.length&&delete r.audioCapabilities,0==r.videoCapabilities.length&&delete r.videoCapabilities;var i=n=new pe;return[!0,!1].forEach(function(e){var n=this;t.forEach(function(t,r){t.drmInfos.some(function(e){return!!e.licenseServerUri})==e&&(i=i.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(r,[t])}.bind(n)))})}.bind(e)),i=(i=i.catch(function(){return Promise.reject(new fe(2,6,6001))})).then(function(e){if(this.c)return Promise.reject();this.v.clear();var n=e.getConfiguration(),r=n.videoCapabilities||[],i=d(n.audioCapabilities||[]);for(n=i.next();!n.done;n=i.next())this.v.add(n.value.contentType);for(n=(r=d(r)).next();!n.done;n=r.next())this.v.add(n.value.contentType);r=e.keySystem,i=[];var a=[],s=[],o=[];return function(e,t,n,r,i){e.forEach(function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(n.some(function(t){return ft(t,e.serverCertificate)})||n.push(e.serverCertificate)),e.initData&&e.initData.forEach(function(e){r.some(function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&ft(t.initData,e.initData)})||r.push(e)}),e.keyIds)for(var a=0;a<e.keyIds.length;++a)i.includes(e.keyIds[a])||i.push(e.keyIds[a])})}((n=t.get(e.keySystem)).drmInfos,i,a,s,o),this.a={keySystem:r,licenseServerUri:i[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:n.audioCapabilities?n.audioCapabilities[0].robustness:"",videoRobustness:n.videoCapabilities?n.videoCapabilities[0].robustness:"",serverCertificate:a[0],initData:s,keyIds:o},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new fe(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();this.h=e,this.P=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.v.clear(),e instanceof fe?Promise.reject(e):Promise.reject(new fe(2,6,6002,e.message))}.bind(e)),n.reject(),i}function Tt(e,t){try{var n=e.h.createSession("persistent-license")}catch(t){var r=new fe(2,6,6005,t.message);return e.g(r),Promise.reject(r)}e.i.w(n,"message",e.Rd.bind(e)),e.i.w(n,"keystatuseschange",e.Pd.bind(e));var i={initData:null,loaded:!1,Xc:1/0,xa:null};return e.b.set(n,i),n.load(t).then(function(e){return this.c?Promise.reject():e?(i.loaded=!0,Lt(this)&&this.l.resolve(),n):(this.b.delete(n),void this.g(new fe(2,6,6013)))}.bind(e),function(e){this.c||(this.b.delete(n),this.g(new fe(2,6,6005,e.message)))}.bind(e))}function kt(e,t,n){try{var r=e.D?e.h.createSession("persistent-license"):e.h.createSession()}catch(t){return void e.g(new fe(2,6,6005,t.message))}e.i.w(r,"message",e.Rd.bind(e)),e.i.w(r,"keystatuseschange",e.Pd.bind(e)),e.b.set(r,{initData:n,loaded:!1,Xc:1/0,xa:null}),r.generateRequest(t,n.buffer).catch(function(t){if(!e.c){if(e.b.delete(r),t.errorCode&&t.errorCode.systemCode){var n=t.errorCode.systemCode;0>n&&(n+=Math.pow(2,32)),n="0x"+n.toString(16)}e.g(new fe(2,6,6006,t.message,t,n))}})}function Ct(e,t){var n=t.target,r=e.b.get(n),i=e.a.licenseServerUri,a=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&a&&a.individualizationServer&&(i=a.individualizationServer),(i=Oe([i],e.f.retryParameters)).body=t.message,i.method="POST",i.licenseRequestType=t.messageType,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=rt(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),r=0;r<n.length;++r)e.headers[n[r].querySelector("name").textContent]=n[r].querySelector("value").textContent;e.body=ct(t.querySelector("Challenge").textContent).buffer}else e.headers["Content-Type"]="text/xml; charset=utf-8"}(i),e.a.keySystem.startsWith("com.apple.fps")&&function(e){var t=new Uint8Array(e.body);t="spc="+lt(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=at(t)}(i),e.C.rb.request(2,i).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&function(e){try{var t=nt(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=ct(t).buffer}(e),n.update(e.data).then(function(){var e=this;this.C.onEvent(new Ee("drmsessionupdate")),r&&(r.xa&&r.xa.resolve(),new ce(function(){r.loaded=!0,Lt(e)&&e.l.resolve()}).O(Mt))}.bind(this)))}.bind(e),function(e){this.c||(e=new fe(2,6,6007,e),this.g(e),r&&r.xa&&r.xa.reject(e))}.bind(e)).catch(function(e){this.c||(e=new fe(2,6,6008,e.message),this.g(e),r&&r.xa&&r.xa.reject(e))}.bind(e))}function It(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],n=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(e){return function(e){return f(function r(){var i,a,s;return P(r,function(r){switch(r.j){case 1:return T(r,2),E(r,navigator.requestMediaKeySystemAccess(e,t),4);case 4:return i=r.s,s=!!(a=i.getConfiguration().sessionTypes)&&a.includes("persistent-license"),Je("Tizen 3")&&(s=!1),n.set(e,{persistentState:s}),E(r,i.createMediaKeys(),5);case 5:C(r,0);break;case 2:I(r),n.set(e,null),S(r)}})})}(e)}),Promise.all(e).then(function(){return ze(n)})}function At(e,t){var n=t.audio,r=t.video;if(n&&n.encrypted&&!wt(e,Ye(n.mimeType,n.codecs))||r&&r.encrypted&&!wt(e,Ye(r.mimeType,r.codecs)))return!1;var i=e.keySystem();return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==i})}function xt(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],r=0;r<e.length;r++)for(var i=0;i<t.length;i++)if(e[r].keySystem==t[i].keySystem){var a=e[r];i=t[i];var s=[];s=(s=s.concat(a.initData||[])).concat(i.initData||[]);var o=[];o=(o=o.concat(a.keyIds)).concat(i.keyIds),n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||i.persistentStateRequired,videoRobustness:a.videoRobustness||i.videoRobustness,audioRobustness:a.audioRobustness||i.audioRobustness,serverCertificate:a.serverCertificate||i.serverCertificate,initData:s,keyIds:o});break}return n}function Lt(e){return We(e=e.b.values(),function(e){return e.loaded})}function Nt(t,n,r){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(n.size&&(n=n.get(t.keySystem)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=[]),(r=r.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=r.persistentStateRequired),t.videoRobustness||(t.videoRobustness=r.videoRobustness),t.audioRobustness||(t.audioRobustness=r.audioRobustness),t.serverCertificate||(t.serverCertificate=r.serverCertificate)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}V("shaka.util.Uint8ArrayUtils.toBase64",lt),V("shaka.util.Uint8ArrayUtils.fromBase64",ct),V("shaka.util.Uint8ArrayUtils.fromHex",dt),V("shaka.util.Uint8ArrayUtils.toHex",ht),V("shaka.util.Uint8ArrayUtils.equal",ft),V("shaka.util.Uint8ArrayUtils.concat",pt),(n=mt.prototype).destroy=function(){var e=this;return f(function t(){return P(t,function(t){switch(t.j){case 1:return e.c?E(t,e.$,0):(e.c=!0,E(t,function(e){return f(function t(){var n;return P(t,function(t){switch(t.j){case 1:return e.i.release(),e.i=null,e.l.reject(),e.W.stop(),e.W=null,e.M.stop(),e.M=null,n=Array.from(e.b.keys()),e.b.clear(),E(t,Promise.all(n.map(function(e){return Promise.resolve().then(function(){return f(function t(){return P(t,function(t){switch(t.j){case 1:return T(t,2),E(t,function(e){return f(function t(){var n;return P(t,function(t){switch(t.j){case 1:return n=new Promise(function(e){new ce(e).O(Rt)}),E(t,Promise.race([e.close().then(function(){return!0}),n.then(function(){return!1})]),2);case 2:S(t)}})})}(e),4);case 4:C(t,0);break;case 2:I(t),S(t)}})})})})),2);case 2:if(!e.m){t.A(3);break}return T(t,4),E(t,e.m.setMediaKeys(null),6);case 6:C(t,5);break;case 4:I(t);case 5:e.m=null;case 3:e.a=null,e.v.clear(),e.h=null,e.o=[],e.f=null,e.g=null,e.C=null,S(t)}})})}(e),4));case 4:e.$.resolve(),t.A(0)}})})},n.configure=function(e){this.f=e},n.Cb=function(e){var t=this;if(!this.h)return this.i.ha(e,"encrypted",function(){t.g(new fe(2,6,6010))}),Promise.resolve();this.m=e,this.i.ha(this.m,"play",function(){for(var e=0;e<t.G.length;e++)Ct(t,t.G[e]);t.ma=!0,t.G=[]}),e=(e=this.m.setMediaKeys(this.h)).catch(function(e){return Promise.reject(new fe(2,6,6003,e.message))});var n=gt(this);return Promise.all([e,n]).then(function(){if(t.c)return Promise.reject();_t(t),t.a.initData.length||t.o.length||t.i.w(t.m,"encrypted",function(e){return bt(t,e.initDataType,new Uint8Array(e.initData))})}).catch(function(e){if(!t.c)return Promise.reject(e)})},n.keySystem=function(){return this.a?this.a.keySystem:""},n.dc=function(){for(var e=1/0,t=this.b.keys(),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},n.Rd=function(e){this.f.delayLicenseRequestUntilPlayed&&this.m.paused&&!this.ma?this.G.push(e):Ct(this,e)},n.Pd=function(e){e=e.target;var t=this.b.get(e),n=!1;e.keyStatuses.forEach(function(e,r){if("string"==typeof r){var i=r;r=e,e=i}if("com.microsoft.playready"==this.a.keySystem&&16==r.byteLength&&!Je("Tizen")){var a=(i=new DataView(r)).getUint32(0,!0),s=i.getUint16(4,!0),o=i.getUint16(6,!0);i.setUint32(0,a,!1),i.setUint16(4,s,!1),i.setUint16(6,o,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(n=!0),i=ht(new Uint8Array(r)),this.na.set(i,e)}.bind(this));var r=e.expiration-Date.now();(0>r||n&&1e3>r)&&t&&!t.xa&&(this.b.delete(e),e.close().catch(function(){})),Lt(this)&&(this.l.resolve(),this.M.O(Pt))};var Rt=1,Mt=5,Pt=.5;function Ot(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Dt(){}function Ut(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Ft(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function Bt(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,r=e.length-1;0<=r&&e.end(r)>t;--r)n+=e.end(r)-Math.max(e.start(r),t);return n}function Vt(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}Ot.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Ot.prototype.b=function(e,t){var n=new Uint8Array(e);(n=this.a.parse(n,this.g,this.f))&&n.captions&&t(n.captions),this.a.clearParsedCaptions()},Ot.prototype.c=function(){this.a.resetCaptionStream()},Dt.prototype.init=function(){},Dt.prototype.b=function(){},Dt.prototype.c=function(){};var jt={ye:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},yc:function(e,t){return e.concat(t)},ic:function(){},Ga:function(e){return null!=e}};function Ht(e,t){if(0==t.length)return e;var n=t.map(function(e){return new $(e)});return e.map(function(e){return new $(e)}).map(function(e){return n.map(e.resolve.bind(e))}).reduce(jt.yc,[]).map(function(e){return e.toString()})}function Kt(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var Gt={Na:"video",Ab:"audio",qa:"text",kg:"application"},Wt=1/15;function qt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function zt(t,n){return!(!e.muxjs||"mp2t"!=t.toLowerCase().split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(Yt(n,t)):MediaSource.isTypeSupported(Yt("audio",t))||MediaSource.isTypeSupported(Yt("video",t)))}function Yt(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var r=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(r){var i="avc1.",a=r[1],s=Number(r[2]);i=("66"==a?i+"4200":"77"==a?i+"4d00":i+"6400")+(s>>4).toString(16),i+=(15&s).toString(16),n=n.replace(r[0],i)}return n}function Xt(e,t,n){this.startTime=e,this.direction=tn,this.endTime=t,this.payload=n,this.region=new cn,this.position=null,this.positionAlign=$t,this.size=100,this.textAlign=Qt,this.writingMode=nn,this.lineInterpretation=rn,this.line=null,this.lineHeight="",this.lineAlign=an,this.displayAlign=Jt,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=on,this.fontStyle=un,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id=""}qt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},qt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},qt.prototype.h=function(){var e={data:pt.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},V("shaka.text.Cue",Xt);var $t="auto";Xt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:$t};var Qt="center",Zt={LEFT:"left",RIGHT:"right",CENTER:Qt,START:"start",END:"end"};Xt.textAlign=Zt;var Jt="after",en={BEFORE:"before",CENTER:"center",AFTER:Jt};Xt.displayAlign=en;var tn="ltr";Xt.direction={HORIZONTAL_LEFT_TO_RIGHT:tn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var nn="horizontal-tb";Xt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:nn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var rn=0;Xt.lineInterpretation={LINE_NUMBER:rn,PERCENTAGE:1};var an="start",sn={CENTER:"center",START:an,END:"end"};Xt.lineAlign=sn;var on=400;Xt.fontWeight={NORMAL:on,BOLD:700};var un="normal",ln={NORMAL:un,ITALIC:"italic",OBLIQUE:"oblique"};function cn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=dn,this.scroll=hn}Xt.fontStyle=ln,Xt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},V("shaka.text.CueRegion",cn);var dn=1;cn.units={PX:0,PERCENTAGE:dn,LINES:2};var hn="";function fn(e){this.g=null,this.c=e,this.f=this.m=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}cn.scrollMode={NONE:hn,UP:"up"};var pn={};function mn(t){return!!(pn[t]||e.muxjs&&"application/cea-608"==t)}function vn(e,t){"application/cea-608"!=t&&(e.g=new pn[t])}function yn(e,t,n,r,i){for(var a=n+" "+r,s=new Map,o=(t=d(t)).next();!o.done;o=t.next()){var u=o.value;o=u.stream,s.has(o)||s.set(o,new Map),s.get(o).has(a)||s.get(o).set(a,[]),u.startTime+=i,u.endTime+=i,u.startTime>=e.f&&u.startTime<e.h&&(u=new Xt(u.startTime,u.endTime,u.text),s.get(o).get(a).push(u),o==e.l&&e.c.append([u]))}for(a=(i=d(s.keys())).next();!a.done;a=i.next())for(a=a.value,e.i.has(a)||e.i.set(a,new Map),o=(t=d(s.get(a).keys())).next();!o.done;o=t.next())o=o.value,u=s.get(a).get(o),e.i.get(a).set(o,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(r,e.h))}function gn(e,t,n){this.f=e,this.g=n,this.b={},this.a=null,this.c={},this.i=new He,this.v=!1,this.l={},this.m=t,e=this.o=new pe,t=new MediaSource,this.i.ha(t,"sourceopen",e.resolve),this.f.src=_n(t),this.h=t}V("shaka.text.TextEngine.registerParser",function(e,t){pn[e]=t}),V("shaka.text.TextEngine.unregisterParser",function(e){delete pn[e]}),fn.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},fn.prototype.Lc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new fe(2,2,2009,e)}},fn.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))},fn.prototype.qe=function(e){this.c.append(e)},fn.prototype.appendCues=fn.prototype.qe,fn.prototype.rc=function(e,t){this.l=e;var n=this.i.get(e);if(n)for(var r=d(n.keys()),i=r.next();!i.done;i=r.next())(i=n.get(i.value))&&(i=i.filter(function(e){return e.endTime<=t}),this.c.append(i))},fn.prototype.setSelectedClosedCaptionId=fn.prototype.rc;var _n=e.URL.createObjectURL;function bn(e){var t=Ye(e.mimeType,e.codecs),n=function(e){var t=[e.mimeType];return $e.forEach(function(n,r){var i=e[r];i&&t.push(n+'="'+i+'"')}),t.join(";")}(e);return mn(t)||MediaSource.isTypeSupported(n)||zt(t,e.type)}function wn(e,t){e.a||(e.a=new fn(e.g)),vn(e.a,t)}function En(e,t){if("text"==t)var n=e.a.a;else n=!(n=Tn(e,t))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function Sn(e,t){return"text"==t?e.a.b:Ut(Tn(e,t))}function Tn(e,t){try{return e.b[t].buffered}catch(e){return null}}function kn(t,n,r,i,a,s){return"text"==n?function(e,t,n,r){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==n||null==r)this.g.parseInit(new Uint8Array(t));else{var e={periodStart:this.m,segmentStart:n,segmentEnd:r};e=this.g.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(n,this.f)),this.b=Math.min(r,this.h)}}.bind(e))}(t.a,r,i,a):t.l[n]?function(e,t){e.f=!0,e.b=new pe,e.g=[],e.c=[];var n=new Uint8Array(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new fe(2,3,3018)),e.b}(t.l[n],r).then(function(e){return this.a||wn(this,"text/vtt"),e.captions&&yn(this.a,e.captions,i,a,this.b.video.timestampOffset),In(this,n,this.ee.bind(this,n,e.data.buffer))}.bind(t)):(s&&e.muxjs&&(t.a||wn(t,"text/vtt"),null==i&&null==a?t.m.init(r):t.m.b(r,function(e){e.length&&yn(t.a,e,i,a,t.b.video.timestampOffset)})),In(t,n,t.ee.bind(t,n,r)))}function Cn(e,t){return"text"==t?e.a?(e.m.c(),e.a.remove(0,1/0)):Promise.resolve():In(e,t,e.fe.bind(e,t,0,e.h.duration))}function In(e,t,n){if(e.v)return Promise.reject();if(n={start:n,p:new pe},e.c[t].push(n),1==e.c[t].length)try{n.start()}catch(r){"QuotaExceededError"==r.name?n.p.reject(new fe(2,3,3017,t)):n.p.reject(new fe(2,3,3015,r)),xn(e,t)}return n.p}function An(e,t){if(e.v)return Promise.reject();var n,r=[];for(n in e.b){var i=new pe,a={start:function(e){e.resolve()}.bind(null,i),p:i};e.c[n].push(a),r.push(i),1==e.c[n].length&&a.start()}return Promise.all(r).then(function(){try{t()}catch(t){var e=Promise.reject(new fe(2,3,3015,t))}for(var n in this.b)xn(this,n);return e}.bind(e),function(e){throw e}.bind(e))}function xn(e,t){e.c[t].shift();var n=e.c[t][0];if(n)try{n.start()}catch(r){n.p.reject(new fe(2,3,3015,r)),xn(e,t)}}function Ln(e,t){return e=Rn(e),t=Rn(t),e.split("-")[0]==t.split("-")[0]}function Nn(e,t){e=Rn(e),t=Rn(t);var n=e.split("-"),r=t.split("-");return n[0]==r[0]&&1==n.length&&2==r.length}function Rn(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=On.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Mn(e){return e.language?Rn(e.language):e.audio&&e.audio.language?Rn(e.audio.language):e.video&&e.video.language?Rn(e.video.language):"und"}function Pn(e,t){for(var n=Rn(e),r=new Set,i=d(t),a=i.next();!a.done;a=i.next())r.add(Rn(a.value));for(a=(i=d(r)).next();!a.done;a=i.next())if((a=a.value)==n)return a;for(a=(i=d(r)).next();!a.done;a=i.next())if(Nn(a=a.value,n))return a;for(a=(i=d(r)).next();!a.done;a=i.next()){var s=a=a.value,o=n;if(s=Rn(s),o=Rn(o),s=s.split("-"),o=o.split("-"),2==s.length&&2==o.length&&s[0]==o[0])return a}for(a=(r=d(r)).next();!a.done;a=r.next())if(Nn(n,i=a.value))return i;return null}(n=gn.prototype).destroy=function(){var e=this;this.v=!0;var t,n=[];for(t in this.c){var r=this.c[t],i=r[0];for(this.c[t]=r.slice(0,1),i&&n.push(i.p.catch(jt.ic)),i=1;i<r.length;++i)r[i].p.reject()}for(var a in this.a&&n.push(this.a.destroy()),this.g&&n.push(this.g.destroy()),this.l)n.push(this.l[a].destroy());return Promise.all(n).then(function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.m=null,e.c={}})},n.init=function(e,t){var n=this;return f(function r(){var i;return P(r,function(r){switch(r.j){case 1:return i=Gt,E(r,n.o,2);case 2:e.forEach(function(e,r){var a=Ye(e.mimeType,e.codecs);r==i.qa?wn(n,a):(!t&&MediaSource.isTypeSupported(a)||!zt(a,r)||(n.l[r]=new qt,a=Yt(r,a)),a=n.h.addSourceBuffer(a),n.i.w(a,"error",n.Tf.bind(n,r)),n.i.w(a,"updateend",n.ub.bind(n,r)),n.b[r]=a,n.c[r]=[])}),S(r)}})})},n.Ic=function(e){if(e.total=Vt(this.f.buffered),e.audio=Vt(Tn(this,"audio")),e.video=Vt(Tn(this,"video")),e.text=[],this.a){var t=this.a.a,n=this.a.b;null!=t&&null!=n&&e.text.push({start:t,end:n})}},n.rc=function(e){var t=Sn(this,"video")||0;this.a.rc(e,t)},n.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):In(this,e,this.fe.bind(this,e,t,n))},n.flush=function(e){return"text"==e?Promise.resolve():In(this,e,this.Ce.bind(this,e))},n.endOfStream=function(e){return An(this,function(){e?this.h.endOfStream(e):this.h.endOfStream()}.bind(this))},n.wa=function(e){return An(this,function(){this.h.duration=e}.bind(this))},n.Y=function(){return this.h.duration},n.ee=function(e,t){this.b[e].appendBuffer(t)},n.fe=function(e,t,n){n<=t?this.ub(e):this.b[e].remove(t,n)},n.oe=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.ub(e)},n.Ce=function(e){this.f.currentTime-=.001,this.ub(e)},n.Sf=function(e,t){0>t&&(t+=.001),this.b[e].timestampOffset=t,this.ub(e)},n.Pf=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.ub(e)},n.Tf=function(e){this.c[e][0].p.reject(new fe(2,3,3014,this.f.error?this.f.error.code:0))},n.ub=function(e){var t=this.c[e][0];t&&(t.p.resolve(),xn(this,e))};var On=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Dn(e,t,n){function r(e,t,n){return e>=t&&e<=n}var i=e.video;return!(i&&i.width&&i.height&&!(r(i.width,t.minWidth,Math.min(t.maxWidth,n.width))&&r(i.height,t.minHeight,Math.min(t.maxHeight,n.height))&&r(i.width*i.height,t.minPixels,t.maxPixels))||!r(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Un(e,t,n){var r=!1;return e.forEach(function(e){var i=e.allowedByApplication;e.allowedByApplication=Dn(e,t,n),i!=e.allowedByApplication&&(r=!0)}),r}function Fn(e,t,n,r){r.variants=r.variants.filter(function(r){if(e&&e.P&&!At(e,r))return!1;var i=r.audio;return r=r.video,!(i&&!bn(i)||r&&!bn(r)||i&&t&&!Bn(i,t)||r&&n&&!Bn(r,n))}),r.textStreams=r.textStreams.filter(function(e){return mn(Ye(e.mimeType,e.codecs))})}function Bn(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}function Vn(e){var t=e.audio,n=e.video,r=t?t.codecs:null,i=n?n.codecs:null,a=[];i&&a.push(i),r&&a.push(r);var s=[];n&&s.push(n.mimeType),t&&s.push(t.mimeType),s=s[0]||null;var o=[];t&&o.push(t.kind),n&&o.push(n.kind),o=o[0]||null;var u=new Set;return t&&t.roles.forEach(function(e){return u.add(e)}),n&&n.roles.forEach(function(e){return u.add(e)}),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:o,width:null,height:null,frameRate:null,mimeType:s,codecs:a.join(", "),audioCodec:r,videoCodec:i,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e}function jn(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}}function Hn(e){return e.__shaka_id||(e.__shaka_id=Kn++),e.__shaka_id}var Kn=0;function Gn(e){return{id:Hn(e),active:!1,type:"",bandwidth:0,language:Rn(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}function Wn(e){return e.allowedByApplication&&e.allowedByKeySystem}function qn(e,t){for(var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),r=new Map,i=(n=d(n)).next();!i.done;i=n.next()){var a=(i=i.value).audio.channelsCount;r.has(a)||r.set(a,[]),r.get(a).push(i)}return 0==(n=Array.from(r.keys())).length?e:(i=n.filter(function(e){return e<=t})).length?r.get(Math.max.apply(null,i)):r.get(Math.min.apply(null,n))}function zn(e,t,n){var r=e,i=e.filter(function(e){return e.primary});i.length&&(r=i);var a=r.length?r[0].language:"";if(r=r.filter(function(e){return e.language==a}),t){var s=Pn(Rn(t),e.map(function(e){return e.language}));s&&(r=e.filter(function(e){return Rn(e.language)==s}))}if(n){if((e=Yn(r,n)).length)return e}else if((e=r.filter(function(e){return 0==e.roles.length})).length)return e;return(e=r.map(function(e){return e.roles}).reduce(jt.yc,[])).length?Yn(r,e[0]):r}function Yn(e,t){return e.filter(function(e){return e.roles.includes(t)})}function Xn(e,t,n){for(var r=0;r<n.length;r++)if(n[r].audio==e&&n[r].video==t)return n[r];return null}function $n(){this.h=null,this.f=!1,this.b=new W,this.c=[],this.i=!1,this.a=this.g=null}function Qn(e,t){return e&&(t=t.filter(function(t){return Dn(t,e,{width:1/0,height:1/0})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}function Zn(e,t){this.a=e,this.b=t}function Jn(e,t){var n=new Zn(2,6),r=nr,i=r.a,a=n.b-i.b;(0<(n.a-i.a||a)?r.c:r.b)(r.a,n,e,t)}function er(e,t,n,r){z([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}function tr(e,t,n,r){q([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join(""))}V("shaka.abr.SimpleAbrManager",$n),$n.prototype.stop=function(){this.h=null,this.f=!1,this.c=[],this.g=null},$n.prototype.stop=$n.prototype.stop,$n.prototype.init=function(e){this.h=e},$n.prototype.init=$n.prototype.init,$n.prototype.chooseVariant=function(){var e=Qn(this.a.restrictions,this.c),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.c.length&&!e.length&&(e=[(e=Qn(null,this.c))[0]]);for(var n=e[0]||null,r=0;r<e.length;++r){var i=e[r],a=(e[r+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;t>=i.bandwidth/this.a.bandwidthDowngradeTarget&&t<=a&&(n=i)}return this.g=Date.now(),n},$n.prototype.chooseVariant=$n.prototype.chooseVariant,$n.prototype.enable=function(){this.f=!0},$n.prototype.enable=$n.prototype.enable,$n.prototype.disable=function(){this.f=!1},$n.prototype.disable=$n.prototype.disable,$n.prototype.segmentDownloaded=function(e,t){var n=this.b;if(!(16e3>t)){var r=8e3*t/e,i=e/1e3;n.a+=t,K(n.b,i,r),K(n.c,i,r)}if(null!=this.g&&this.f)e:{if(this.i){if(Date.now()-this.g<1e3*this.a.switchInterval)break e}else{if(!(128e3<=this.b.a))break e;this.i=!0}n=this.chooseVariant(),this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),this.h(n)}},$n.prototype.segmentDownloaded=$n.prototype.segmentDownloaded,$n.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},$n.prototype.getBandwidthEstimate=$n.prototype.getBandwidthEstimate,$n.prototype.setVariants=function(e){this.c=e},$n.prototype.setVariants=$n.prototype.setVariants,$n.prototype.configure=function(e){this.a=e},$n.prototype.configure=$n.prototype.configure,Zn.prototype.toString=function(){return"v"+this.a+"."+this.b};var nr=null,rr="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),ir="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ar=["loop","playbackRate"],sr=["pause","play"],or="abrstatuschanged adaptation buffering emsg error loading streaming texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged textchanged".split(" "),ur={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},lr={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},cr=[["getConfiguration","configure"]],dr=[["isTextTrackVisible","setTextTrackVisibility"]],hr="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack setTextTrackVisibility trickPlay".split(" "),fr=["attach","detach","load","unload"];function pr(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Ee){var n,r={};for(n in t){var i=t[n];i&&"object"==typeof i?"detail"==n&&(r[n]=i):n in Event||(r[n]=i)}return r}if(t instanceof TimeRanges)for(r={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=0;n<t.length;++n)r.start.push(t.start(n)),r.end.push(t.end(n));else r=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return r}})}function mr(e){return JSON.parse(e,function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?new Uint8Array(t.entries):t})}function vr(e,t,n,r,i,a){this.T=e,this.f=new ce(t),this.P=n,this.l=!1,this.G=r,this.M=i,this.C=a,this.b=this.h=!1,this.D="",this.i=null,this.m=this.Nd.bind(this),this.o=this.kf.bind(this),this.a={video:{},player:{}},this.v=0,this.c={},this.g=null}var yr=!1,gr=null;function _r(e){var t=gr;t.removeUpdateListener(e.m),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.o)}function br(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new fe(1,7,7e3))}}function wr(e){e=pr(e),gr.sendMessage("urn:x-cast:com.google.shaka.v2",e,function(){},Y)}function Er(e,t,n){var r=this;Te.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,(this.m=n)&&(this.a=new vr(n,function(){return Tr(r)},function(){return kr(r)},function(e,t){return Ir(r,e,t)},function(){return Cr(r)},function(){return Sr(r)})),function(e){for(var t in e.a&&e.a.init(),e.i=new He,rr.forEach(function(e){this.i.w(this.c,e,this.ig.bind(this))}.bind(e)),or.forEach(function(e){this.i.w(this.b,e,this.yf.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.hg.bind(e,t),set:e.jg.bind(e,t)});for(var n in e.l={},e.b)Object.defineProperty(e.l,n,{configurable:!1,enumerable:!0,get:e.Ud.bind(e,n)});e.f=new Te,e.f.Vb=e.h,e.g=new Te,e.g.Vb=e.l}(this)}function Sr(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.b.bc(),startTime:null};return e.c.pause(),ar.forEach(function(e){t.video[e]=this.c[e]}.bind(e)),e.c.ended||(t.startTime=e.c.currentTime),cr.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.player[n]=e}.bind(e)),dr.forEach(function(e){var n=e[1];e=this.b[e[0]](),t.playerAfterLoad[n]=e}.bind(e)),t}function Tr(e){e.dispatchEvent(new Ee("caststatuschanged"))}function kr(e){e.f.dispatchEvent(new Ee(e.h.paused?"pause":"play"))}function Cr(e){cr.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e));var t=e.a.get("player","getAssetUri")(),n=e.a.get("video","ended"),r=Promise.resolve(),i=e.c.autoplay,a=null;n||(a=e.a.get("video","currentTime")),t&&(e.c.autoplay=!1,r=e.b.load(t,a));var s={};ar.forEach(function(e){s[e]=this.a.get("video",e)}.bind(e)),r.then(function(){e.c&&(ar.forEach(function(e){this.c[e]=s[e]}.bind(e)),dr.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e)),e.c.autoplay=i,t&&e.c.play())},function(t){e.b.dispatchEvent(new Ee("error",{detail:t}))})}function Ir(e,t,n){e.a.fa()&&("video"==t?e.f.dispatchEvent(n):"player"==t&&e.g.dispatchEvent(n))}function Ar(e,t,n,r){var i=this;Te.call(this),this.a=e,this.b=t,this.c=new He,this.D={video:e,player:t},this.o=n||function(){},this.G=r||function(e){return e},this.v=!1,this.h=!0,this.g=0,this.m=!1,this.l=!0,this.i=this.f=null,this.C=new ce(function(){Lr(i)}),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.Qd.bind(e),t.onSenderDisconnected=e.Qd.bind(e),t.onSystemVolumeChanged=e.Be.bind(e),e.i=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.i.onMessage=e.ef.bind(e),e.f=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.f.onMessage=e.rf.bind(e),t.start(),rr.forEach(function(e){this.c.w(this.a,e,this.Wd.bind(this,"video"))}.bind(e)),or.forEach(function(e){this.c.w(this.b,e,this.Wd.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.b.jd(3840,2160):e.b.jd(1920,1080),e.c.w(e.a,"loadeddata",function(){this.m=!0}.bind(e)),e.c.w(e.b,"loading",function(){this.h=!1,xr(this)}.bind(e)),e.c.w(e.a,"playing",function(){this.h=!1,xr(this)}.bind(e)),e.c.w(e.a,"pause",function(){xr(this)}.bind(e)),e.c.w(e.b,"unloading",function(){this.h=!0,xr(this)}.bind(e)),e.c.w(e.a,"ended",function(){var e=this;new ce(function(){e.a&&e.a.ended&&(e.h=!0,xr(e))}).O(5)}.bind(e))}(this)}function xr(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Ee("caststatuschanged")),Nr(this)||Pr(this,0))}.bind(e))}function Lr(e){e.C.O(.5);var t={video:{},player:{}};if(ir.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.V())for(var n in lr)0==e.g%lr[n]&&(t.player[n]=e.b[n]());for(var r in ur)0==e.g%ur[r]&&(t.player[r]=e.b[r]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.m&&(e.g+=1),Mr(e,{type:"update",update:t},e.f),Nr(e)}function Nr(e){return!(!e.l||!e.a.duration&&!e.b.V())&&(Rr(e),e.l=!1,!0)}function Rr(e){var t={contentId:e.b.bc(),streamType:e.b.V()?"LIVE":"BUFFERED",duration:e.a.duration,contentType:""};Pr(e,0,t)}function Mr(e,t,n,r){e.v&&(e=pr(t),r?n.getCastChannel(r).send(e):n.broadcast(e))}function Pr(e,t,n){var r=e.a.playbackRate,i=Or;r={mediaSessionId:0,playbackRate:r,playerState:i=e.h?i.IDLE:e.b.Nc()?i.je:e.a.paused?i.le:i.me,currentTime:e.a.currentTime,supportedMediaCommands:15,volume:{level:e.a.volume,muted:e.a.muted}},n&&(r.media=n),Mr(e,{requestId:t,type:"MEDIA_STATUS",status:[r]},e.i)}(n=vr.prototype).destroy=function(){return br(this),gr&&_r(this),this.f&&(this.f.stop(),this.f=null),this.M=this.G=null,this.b=this.h=!1,this.o=this.m=this.g=this.c=this.a=this.i=null,Promise.resolve()},n.fa=function(){return this.b},n.bd=function(){return this.D},n.init=function(){if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){delete e.__onGCastApiAvailable,this.h=!0,this.f.sc();var t=new chrome.cast.SessionRequest(this.T);t=new chrome.cast.ApiConfig(t,this.Od.bind(this),this.pf.bind(this),"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),yr&&this.f.O(.02),(t=gr)&&t.status!=chrome.cast.SessionStatus.STOPPED?this.Od(t):gr=null}else e.__onGCastApiAvailable=function(e){e&&this.init()}.bind(this)},n.hd=function(e){this.i=e,this.b&&wr({type:"appData",appData:this.i})},n.cast=function(e){return this.h?yr?this.b?Promise.reject(new fe(1,8,8002)):(this.g=new pe,chrome.cast.requestSession(this.Zc.bind(this,e),this.Md.bind(this)),this.g):Promise.reject(new fe(1,8,8001)):Promise.reject(new fe(1,8,8e3))},n.Eb=function(){this.b&&(br(this),gr&&(_r(this),gr.stop(function(){},function(){}),gr=null))},n.get=function(e,t){if("video"==e){if(sr.includes(t))return this.Yd.bind(this,e,t)}else if("player"==e){if(lr[t]&&!this.get("player","isLive")())return function(){};if(hr.includes(t))return this.Yd.bind(this,e,t);if(fr.includes(t))return this.Ef.bind(this,e,t);if(ur[t])return this.Vd.bind(this,e,t)}return this.Vd(e,t)},n.set=function(e,t,n){this.a[e][t]=n,wr({type:"set",targetName:e,property:t,value:n})},n.Zc=function(e,t){gr=t,t.addUpdateListener(this.m),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.o),this.Nd(),wr({type:"init",initState:e,appData:this.i}),this.g.resolve()},n.Md=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new fe(2,8,t,e))},n.Vd=function(e,t){return this.a[e][t]},n.Yd=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];wr({type:"call",targetName:e,methodName:t,args:r})},n.Ef=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];i=new pe;var a=this.v.toString();return this.v++,this.c[a]=i,wr({type:"asyncCall",targetName:e,methodName:t,args:r,id:a}),i},n.Od=function(e){var t=this.C();this.g=new pe,this.l=!0,this.Zc(t,e)},n.pf=function(e){yr="available"==e,this.f.sc()},n.Nd=function(){var e=!!gr&&"connected"==gr.status;if(this.b&&!e){for(var t in this.M(),this.a)this.a[t]={};br(this)}this.D=(this.b=e)?gr.receiver.friendlyName:"",this.f.sc()},n.kf=function(e,t){var n=mr(t);switch(n.type){case"event":var r=n.event;this.G(n.targetName,new Ee(r.type,r));break;case"update":for(var i in r=n.update)for(var a in n=this.a[i]||{},r[i])n[a]=r[i][a];this.l&&(this.P(),this.l=!1);break;case"asyncComplete":if(i=n.id,n=n.error,a=this.c[i],delete this.c[i],a)if(n){for(r in i=new fe(n.severity,n.category,n.code),n)i[r]=n[r];a.reject(i)}else a.resolve()}},j(Er,Te),V("shaka.cast.CastProxy",Er),Er.prototype.destroy=function(e){return e&&this.a&&this.a.Eb(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},Er.prototype.destroy=Er.prototype.destroy,Er.prototype.Ye=function(){return this.h},Er.prototype.getVideo=Er.prototype.Ye,Er.prototype.Re=function(){return this.l},Er.prototype.getPlayer=Er.prototype.Re,Er.prototype.se=function(){return!!this.a&&(this.a.h&&yr)},Er.prototype.canCast=Er.prototype.se,Er.prototype.fa=function(){return!!this.a&&this.a.fa()},Er.prototype.isCasting=Er.prototype.fa,Er.prototype.bd=function(){return this.a?this.a.bd():""},Er.prototype.receiverName=Er.prototype.bd,Er.prototype.cast=function(){if(!this.a)throw new fe(1,8,8007);var e=Sr(this);return this.a.cast(e).then(function(){if(this.b)return this.b.qd()}.bind(this))},Er.prototype.cast=Er.prototype.cast,Er.prototype.hd=function(e){this.a&&this.a.hd(e)},Er.prototype.setAppData=Er.prototype.hd,Er.prototype.$f=function(){if(this.a){var e=this.a;if(e.b){var t=e.C();chrome.cast.requestSession(e.Zc.bind(e,t),e.Md.bind(e))}}},Er.prototype.suggestDisconnect=Er.prototype.$f,Er.prototype.ve=function(e){var t=this;return f(function n(){return P(n,function(n){switch(n.j){case 1:if(e==t.m)return n.return();if(t.m=e,!t.a){n.A(2);break}return t.a.Eb(),E(n,t.a.destroy(),3);case 3:t.a=null;case 2:t.a=new vr(e,function(){return Tr(t)},function(){return kr(t)},function(e,n){return Ir(t,e,n)},function(){return Cr(t)},function(){return Sr(t)}),t.a.init(),S(n)}})})},Er.prototype.changeReceiverId=Er.prototype.ve,Er.prototype.Eb=function(){this.a&&this.a.Eb()},Er.prototype.forceDisconnect=Er.prototype.Eb,(n=Er.prototype).hg=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a&&this.a.fa()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a&&this.a.fa()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},n.jg=function(e,t){this.a&&this.a.fa()?this.a.set("video",e,t):this.c[e]=t},n.ig=function(e){this.a&&this.a.fa()||this.f.dispatchEvent(new Ee(e.type,e))},n.Ud=function(e){if("addEventListener"==e)return this.g.addEventListener.bind(this.g);if("removeEventListener"==e)return this.g.removeEventListener.bind(this.g);if("getMediaElement"==e)return function(){return this.h}.bind(this);if("getSharedConfiguration"==e)return this.a?this.a.get("player","getConfiguration"):this.b.getConfiguration();if("getNetworkingEngine"==e)return this.b.Fb.bind(this.b);if(this.a&&this.a.fa()){if("getManifest"==e||"drmInfo"==e)return function(){return z(e+"() does not work while casting!"),null};if("getManifestUri"==e)return Jn("getManifestUri",'Please use "getAssetUri" instead.'),this.Ud("getAssetUri");if("attach"==e||"detach"==e)return function(){return z(e+"() does not work while casting!"),Promise.resolve()}}return this.a&&this.a.fa()&&0==Object.keys(this.a.a.video).length&&ur[e]||!this.a||!this.a.fa()?this.b[e].bind(this.b):this.a.get("player",e)},n.yf=function(e){this.a&&this.a.fa()||this.g.dispatchEvent(e)},j(Ar,Te),V("shaka.cast.CastReceiver",Ar),Ar.prototype.isConnected=function(){return this.v},Ar.prototype.isConnected=Ar.prototype.isConnected,Ar.prototype.bf=function(){return this.h},Ar.prototype.isIdle=Ar.prototype.bf,Ar.prototype.destroy=function(){var e=this;return f(function t(){var n;return P(t,function(t){switch(t.j){case 1:return e.c&&(e.c.release(),e.c=null),n=[],e.b&&(n.push(e.b.destroy()),e.b=null),e.C&&(e.C.stop(),e.C=null),e.a=null,e.D=null,e.o=null,e.v=!1,e.h=!0,e.f=null,e.i=null,E(t,Promise.all(n),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),S(t)}})})},Ar.prototype.destroy=Ar.prototype.destroy,(n=Ar.prototype).Qd=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,xr(this)},n.Wd=function(e,t){this.b&&(Lr(this),Mr(this,{type:"event",targetName:e,event:t},this.f))},n.Be=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Mr(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Mr(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},n.rf=function(e){var t=mr(e.data);switch(t.type){case"init":this.g=0,this.m=!1,this.l=!0,function(e,t,n){for(var r in t.player)e.b[r](t.player[r]);e.o(n),n=Promise.resolve();var i=e.a.autoplay;t.manifest&&(e.a.autoplay=!1,n=e.b.load(t.manifest,t.startTime)),n.then(function(){if(e.b){for(var n in t.video)e.a[n]=t.video[n];for(var r in t.playerAfterLoad)e.b[r](t.playerAfterLoad[r]);e.a.autoplay=i,t.manifest&&(e.a.play(),Pr(e,0))}},function(t){e.b.dispatchEvent(new Ee("error",{detail:t}))})}(this,t.initState,t.appData),Lr(this);break;case"appData":this.o(t.appData);break;case"set":var n=t.targetName,r=t.property;if(t=t.value,"video"==n){var i=cast.receiver.CastReceiverManager.getInstance();if("volume"==r){i.setSystemVolumeLevel(t);break}if("muted"==r){i.setSystemVolumeMuted(t);break}}this.D[n][r]=t;break;case"call":(n=this.D[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,r=t.methodName,"player"==n&&"load"==r&&(this.g=0,this.m=!1),i=t.id,e=e.senderId;var a=this.D[n];t=a[r].apply(a,t.args),"player"==n&&"load"==r&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.be.bind(this,e,i,null),this.be.bind(this,e,i))}},n.ef=function(e){var t=mr(e.data);switch(t.type){case"PLAY":this.a.play(),Pr(this,0);break;case"PAUSE":this.a.pause(),Pr(this,0);break;case"SEEK":e=t.currentTime;var n=t.resumeState;null!=e&&(this.a.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.a.play(),Pr(this,0)):n&&"PLAYBACK_PAUSE"==n&&(this.a.pause(),Pr(this,0));break;case"STOP":this.b.qd().then(function(){this.b&&Pr(this,0)}.bind(this));break;case"GET_STATUS":Pr(this,Number(t.requestId));break;case"VOLUME":e=(n=t.volume).level,n=n.muted;var r=this.a.volume,i=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=n&&(this.a.muted=n),r==this.a.volume&&i==this.a.muted||Pr(this,0);break;case"LOAD":this.g=0,this.l=this.m=!1,e=t.media,n=t.currentTime,r=this.G(e.contentId),i=t.autoplay||!0,this.o(e.customData),i&&(this.a.autoplay=!0),this.b.load(r,n).then(function(){this.b&&Rr(this)}.bind(this)).catch(function(e){var n="LOAD_FAILED";7==e.category&&7e3==e.code&&(n="LOAD_CANCELLED"),Mr(this,{requestId:Number(t.requestId),type:n},this.i)}.bind(this));break;default:Mr(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},n.be=function(e,t,n){this.b&&Mr(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Or={IDLE:"IDLE",me:"PLAYING",je:"BUFFERING",le:"PAUSED"},Dr={ac:function(e,t){var n=Dr.R(e,t);return 1!=n.length?null:n[0]},yd:function(e,t,n){return 1!=(e=Dr.zd(e,t,n)).length?null:e[0]},R:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})},zd:function(e,t,n){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t})},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},cc:function(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null},J:function(e,t,n,r){r=void 0===r?null:r;var i=null;return null!=(e=e.getAttribute(t))&&(i=n(e)),null==i?r:i},vf:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ba:function(e){return e&&(e=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null},oc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},nc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},vb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Ae:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},Td:function(e,t){var n=new DOMParser;try{var r=n.parseFromString(e,"text/xml")}catch(e){}if(r&&r.documentElement.tagName==t)var i=r.documentElement;return i&&0<i.getElementsByTagName("parsererror").length?null:i},Sd:function(e,t){try{var n=nt(e);return Dr.Td(n,t)}catch(e){}}},Ur=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Fr(e,t,n){var r=function(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())(n=Vr(n.value))&&t.push(n);return t}(e),i=null;e=[];var a=[],s=new Set(r.map(function(e){return e.keyId}));if(s.delete(null),1<s.size)throw new fe(2,4,4010);if(n||(a=r.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.ae||(i=e.init||i,!1)})).length&&(0==(e=function(e,t,n){for(var r=[],i=(n=d(n)).next();!i.done;i=n.next()){i=i.value;var a=Ur.get(i.ae);if(a){var s=Kt(a,i.init||e);(a=Br.get(a))&&(s.licenseServerUri=a(i)),r.push(s)}else for(i=d(i=t(i.node)||[]),s=i.next();!s.done;s=i.next())r.push(s.value)}return r}(i,t,a)).length&&(e=[Kt("",i)])),r.length&&(n||!a.length))for(e=[],n=(t=d(Ur.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(Kt(n,i));if(s=Array.from(s)[0]||null)for(n=(t=d(e)).next();!n.done;n=t.next())for(r=(n=d(n.value.initData)).next();!r.done;r=n.next())r.value.keyId=s;return{vd:s,pg:i,drmInfos:e,Ad:!0}}var Br=(new Map).set("com.widevine.alpha",function(e){return(e=Dr.yd(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(e){return(e=Dr.yd(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(n!==e.byteLength)return[];t+=6,n=[];for(var r=new DataView(e);t<e.byteLength-1;){var i=r.getUint16(t,!0);t+=2;var a=r.getUint16(t,!0);t+=2;var s=new Uint8Array(e,t,a);n.push({type:i,value:s}),t+=a}return n}((e=ct(e.textContent)).buffer).filter(function(e){return 1===e.type})[0])?(e=rt(e.value,!0),(e=Dr.Td(e,"WRMHEADER"))?function(e){return(e=e.querySelector("DATA > LA_URL"))?e.textContent:""}(e):""):""});function Vr(e){var t=e.getAttribute("schemeIdUri"),n=Dr.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),r=Dr.zd(e,"urn:mpeg:cenc:2013","pssh").map(Dr.cc);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new fe(2,4,4009);var i=[];try{i=r.map(function(e){return{initDataType:"cenc",initData:ct(e),keyId:null}})}catch(e){throw new fe(2,4,4007)}return{node:e,ae:t,keyId:n,init:0<i.length?i:null}}function jr(t,n,r,i,a){var s={RepresentationID:n,Number:r,Bandwidth:i,Time:a};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,r,i){if("$$"==t)return"$";var a=s[n];if(null==a)return t;switch("RepresentationID"==n&&r&&(r=void 0),"Time"==n&&(a=Math.round(a)),i){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return r=e.parseInt(r,10)||1,Array(Math.max(0,r-t.length)+1).join("0")+t})}function Hr(e,t){var n=Kr(e,t,"timescale"),r=1;n&&(r=Dr.nc(n)||1),n=Kr(e,t,"duration"),(n=Dr.nc(n||""))&&(n/=r);var i=Kr(e,t,"startNumber"),a=Number(Kr(e,t,"presentationTimeOffset"))||0,s=Dr.vb(i||"");null!=i&&null!=s||(s=1);var o=Gr(e,t,"SegmentTimeline");if(i=null,o){i=r;var u=e.S.duration||1/0;o=Dr.R(o,"S");for(var l=[],c=0,d=0;d<o.length;++d){var h=o[d],f=Dr.J(h,"t",Dr.vb),p=Dr.J(h,"d",Dr.vb);if(h=Dr.J(h,"r",Dr.parseInt),null!=f&&(f-=a),!p)break;if(f=null!=f?f:c,0>(h=h||0))if(d+1<o.length){if(null==(h=Dr.J(o[d+1],"t",Dr.vb)))break;if(f>=h)break;h=Math.ceil((h-f)/p)-1}else{if(1/0==u)break;if(f/i>=u)break;h=Math.ceil((u*i-f)/p)-1}0<l.length&&f!=c&&(l[l.length-1].end=f/i);for(var m=0;m<=h;++m)c=f+p,l.push({start:f/i,end:c/i,eg:f}),f=c}i=l}return{timescale:r,Z:n,Za:s,la:a/r||0,rd:a,N:i}}function Kr(e,t,n){return[t(e.B),t(e.ca),t(e.ja)].filter(jt.Ga).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}function Gr(e,t,n){return[t(e.B),t(e.ca),t(e.ja)].filter(jt.Ga).map(function(e){return Dr.ac(e,n)}).reduce(function(e,t){return e||t})}function Wr(e,t,n,r,i,a){if(a=void 0===a?0:a,Dr.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var s=function(e,t,n,r,i,a){for(var s=Dr.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),o=Dr.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<e.attributes.length;u++){var l=e.attributes[u];"http://www.w3.org/1999/xlink"==l.namespaceURI&&(e.removeAttributeNS(l.namespaceURI,l.localName),--u)}if(5<=a)return ve(new fe(2,4,4028));if("onLoad"!=o)return ve(new fe(2,4,4027));var c=Ht([r],[s]);return i.request(0,Oe(c,t)).U(function(r){if(!(r=Dr.Sd(r.data,e.tagName)))return ve(new fe(2,4,4001,s));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;r.childNodes.length;){var o=r.childNodes[0];r.removeChild(o),e.appendChild(o)}for(o=0;o<r.attributes.length;o++){var u=r.attributes[o].nodeName,l=r.getAttribute(u);e.setAttribute(u,l)}return Wr(e,t,n,c[0],i,a+1)})}(e,t,n,r,i,a);return n&&(s=s.U(void 0,function(){return Wr(e,t,n,r,i,a)})),s}s=[];for(var o=0;o<e.childNodes.length;o++){var u=e.childNodes[o];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Dr.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--o):"SegmentTimeline"!=u.tagName&&s.push(Wr(u,t,n,r,i,a)))}return be(s).U(function(){return e})}function qr(e,t,n){this.c=e,this.b=t,this.a=n}function zr(e,t,n,r,i,a){this.position=e,this.startTime=t,this.endTime=n,this.c=r,this.b=i,this.a=a}function Yr(e,t){this.K=e,this.b=t==$r,this.a=0}V("shaka.media.InitSegmentReference",qr),qr.prototype.Ac=function(){return this.c()},qr.prototype.createUris=qr.prototype.Ac,qr.prototype.Kc=function(){return this.b},qr.prototype.getStartByte=qr.prototype.Kc,qr.prototype.Jc=function(){return this.a},qr.prototype.getEndByte=qr.prototype.Jc,V("shaka.media.SegmentReference",zr),zr.prototype.ba=function(){return this.position},zr.prototype.getPosition=zr.prototype.ba,zr.prototype.Lc=function(){return this.startTime},zr.prototype.getStartTime=zr.prototype.Lc,zr.prototype.Ge=function(){return this.endTime},zr.prototype.getEndTime=zr.prototype.Ge,zr.prototype.Ac=function(){return this.c()},zr.prototype.createUris=zr.prototype.Ac,zr.prototype.Kc=function(){return this.b},zr.prototype.getStartByte=zr.prototype.Kc,zr.prototype.Jc=function(){return this.a},zr.prototype.getEndByte=zr.prototype.Jc,V("shaka.util.DataViewReader",Yr);var Xr,$r=1;function Qr(){throw new fe(2,3,3e3)}function Zr(){this.c=[],this.b=[],this.a=!1}function Jr(e){for(;e.reader.sa()&&!e.parser.a;)e.parser.mc(e.start,e.reader,e.partialOkay)}function ei(e){for(var t=e.reader.F();0<t&&!e.parser.a;--t)e.parser.mc(e.start,e.reader,e.partialOkay)}function ti(e){return function(t){e(t.reader.Xa(t.reader.K.byteLength-t.reader.ba()))}}function ni(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function ri(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function ii(e,t,n,r){var i,a=(new Zr).ea("sidx",function(e){i=function(e,t,n,r){var i=[];r.reader.L(4);var a=r.reader.F();if(0==a)throw new fe(2,3,3005);if(0==r.version)var s=r.reader.F(),o=r.reader.F();else s=r.reader.yb(),o=r.reader.yb();r.reader.L(2);var u=r.reader.Mb();for(e=e+r.size+o,o=0;o<u;o++){var l=r.reader.F(),c=(2147483648&l)>>>31;l&=2147483647;var d=r.reader.F();if(r.reader.L(4),1==c)throw new fe(2,3,3006);i.push(new zr(i.length,s/a-t,(s+d)/a-t,function(){return n},e,e+l-1)),s+=d,e+=l}return r.parser.stop(),i}(t,r,n,e)});if(e&&a.parse(e),i)return i;throw new fe(2,3,3004)}function ai(e){this.a=e}function si(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&0>=e.a[0].endTime;)e.a.shift();if(0!=e.a.length){var n=e.a[e.a.length-1];e.a[e.a.length-1]=new zr(n.position,n.startTime,t,n.c,n.b,n.a)}}function oi(e){this.b=e,this.a=new Yr(e,0),Xr||(Xr=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function ui(e){var t=li(e);if(7<t.length)throw new fe(2,3,3002);for(var n=0,r=0;r<t.length;r++)n=256*n+t[r];t=n,n=li(e);e:{for(r=0;r<Xr.length;r++)if(ft(n,Xr[r])){r=!0;break e}r=!1}if(r)n=e.b.byteLength-e.a.ba();else{if(8==n.length&&224&n[1])throw new fe(2,3,3001);r=n[0]&(1<<8-n.length)-1;for(var i=1;i<n.length;i++)r=256*r+n[i];n=r}return n=e.a.ba()+n<=e.b.byteLength?n:e.b.byteLength-e.a.ba(),r=new DataView(e.b.buffer,e.b.byteOffset+e.a.ba(),n),e.a.L(n),new ci(t,r)}function li(e){var t,n=e.a.ka();for(t=1;8>=t&&!(n&1<<8-t);t++);if(8<t)throw new fe(2,3,3002);var r=new Uint8Array(t);for(r[0]=n,n=1;n<t;n++)r[n]=e.a.ka();return r}function ci(e,t){this.id=e,this.a=t}function di(e){if(8<e.a.byteLength)throw new fe(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new fe(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++){t=256*t+e.a.getUint8(n)}return t}function hi(){}function fi(e){var t=new oi(e.a);if(179!=(e=ui(t)).id)throw new fe(2,3,3013);if(e=di(e),183!=(t=ui(t)).id)throw new fe(2,3,3012);t=new oi(t.a);for(var n=0;t.sa();){var r=ui(t);if(241==r.id){n=di(r);break}}return{fg:e,Df:n}}function pi(e,t){var n=Gr(e,t,"Initialization");if(!n)return null;var r=e.B.oa,i=n.getAttribute("sourceURL");i&&(r=Ht(e.B.oa,[i])),i=0;var a=null;return(n=Dr.J(n,"range",Dr.oc))&&(i=n.start,a=n.end),new qr(function(){return r},i,a)}function mi(e,t,n,r,i,a,s,o){var u=e.presentationTimeline,l=!e.kb||!e.S.Pc,c=e.S.start,d=e.S.duration,h=t,f=null;return{createSegmentIndex:function(){var e=[h(r,i,a),"webm"==s?h(n.c(),n.b,n.a):null];return h=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==s?ii(t,i,r,o):(new hi).parse(t,e,r,o),u.sb(t,c),f=new ai(t),l&&si(f,d)})},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function vi(e){return e.Ob}function yi(e,t){var n=pi(e,gi),r=function(e){return[e.B.Ja,e.ca.Ja,e.ja.Ja].filter(jt.Ga).map(function(e){return Dr.R(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){t.getAttribute("indexRange")&&!e.Fd&&(e.Fd=!0);var n=t.getAttribute("media");return t=Dr.J(t,"mediaRange",Dr.oc,{start:0,end:null}),{cf:n,start:t.start,end:t.end}})}(e),i=Hr(e,gi),a=i.Za;0==a&&(a=1);var s=0;if(i.Z?s=i.Z*(a-1):i.N&&0<i.N.length&&(s=i.N[0].start),!(r={Z:i.Z,startTime:s,Za:a,la:i.la,N:i.N,qb:r}).Z&&!r.N&&1<r.qb.length)throw new fe(2,4,4002);if(!r.Z&&!e.S.duration&&!r.N&&1==r.qb.length)throw new fe(2,4,4002);if(r.N&&0==r.N.length)throw new fe(2,4,4002);return a=i=null,e.ja.id&&e.B.id&&(i=t[a=e.ja.id+","+e.B.id]),s=function(e,t,n,r){var i=r.qb.length;r.N&&r.N.length!=r.qb.length&&(i=Math.min(r.N.length,r.qb.length));for(var a=[],s=r.startTime,o=0;o<i;o++){var u=r.qb[o],l=Ht(n,[u.cf]),c=void 0;c=null!=r.Z?s+r.Z:r.N?r.N[o].end:s+e,a.push(new zr(o+t,s,c,function(e){return e}.bind(null,l),u.start,u.end)),s=c}return a}(e.S.duration,r.Za,e.B.oa,r),i?(i.Sc(s),a=e.presentationTimeline.Hb(),i.Dc(a-e.S.start)):(e.presentationTimeline.sb(s,e.S.start),i=new ai(s),a&&e.kb&&(t[a]=i)),e.kb&&e.S.Pc||si(i,e.S.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:i.find.bind(i),getSegmentReference:i.get.bind(i),initSegmentReference:n,la:r.la}}function gi(e){return e.Ja}function _i(e,t,n,r){var i=function(e){var t=Kr(e,bi,"initialization");if(!t)return null;var n=e.B.id,r=e.bandwidth||null,i=e.B.oa;return new qr(function(){var e=jr(t,n,null,r,null);return Ht(i,[e])},0,null)}(e),a=Hr(e,bi),s=Kr(e,bi,"media"),o=Kr(e,bi,"index");if(s=(a={Z:a.Z,timescale:a.timescale,Za:a.Za,la:a.la,rd:a.rd,N:a.N,Rc:s,Jb:o}).Jb?1:0,s+=a.N?1:0,0==(s+=a.Z?1:0))throw new fe(2,4,4002);if(1!=s&&(a.Jb&&(a.N=null),a.Z=null),!a.Jb&&!a.Rc)throw new fe(2,4,4002);if(a.Jb){if("mp4"!=(n=e.B.mimeType.split("/")[1])&&"webm"!=n)throw new fe(2,4,4006);if("webm"==n&&!i)throw new fe(2,4,4005);r=jr(a.Jb,e.B.id,null,e.bandwidth||null,null),e=mi(e,t,i,r=Ht(e.B.oa,[r]),0,null,n,a.la)}else a.Z?(r||(e.presentationTimeline.Uc(a.Z),e.presentationTimeline.Vc(e.S.start)),e=function(e,t){var n=e.S.duration,r=t.Z,i=t.Za,a=t.timescale,s=t.Rc,o=e.bandwidth||null,u=e.B.id,l=e.B.oa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||n&&e>=n?null:Math.floor(e/r)},getSegmentReference:function(e){var t=e*r,c=t+r;return n&&(c=Math.min(c,n)),0>c||n&&t>=n?null:new zr(e,t,c,function(){var n=jr(s,u,e+i,o,t*a);return Ht(l,[n])},0,null)}}}(e,a)):(s=t=null,e.ja.id&&e.B.id&&(t=n[s=e.ja.id+","+e.B.id]),o=function(e,t){for(var n=[],r=0;r<t.N.length;r++){var i=r+t.Za;n.push(new zr(i,t.N[r].start,t.N[r].end,function(e,t,n,r,i,a){return e=jr(e,t,i,n,a),Ht(r,[e]).map(function(e){return e.toString()})}.bind(null,t.Rc,e.B.id,e.bandwidth||null,e.B.oa,i,t.N[r].eg+t.rd),0,null))}return n}(e,a),r=!e.kb||!e.S.Pc,t?(r&&si(new ai(o),e.S.duration),t.Sc(o),n=e.presentationTimeline.Hb(),t.Dc(n-e.S.start)):(e.presentationTimeline.sb(o,e.S.start),t=new ai(o),s&&e.kb&&(n[s]=t)),r&&si(t,e.S.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:i,la:a.la}}function bi(e){return e.Qb}Yr.Endianness={lg:0,mg:$r},Yr.prototype.sa=function(){return this.a<this.K.byteLength},Yr.prototype.hasMoreData=Yr.prototype.sa,Yr.prototype.ba=function(){return this.a},Yr.prototype.getPosition=Yr.prototype.ba,Yr.prototype.Ie=function(){return this.K.byteLength},Yr.prototype.getLength=Yr.prototype.Ie,Yr.prototype.ka=function(){try{var e=this.K.getUint8(this.a);return this.a+=1,e}catch(e){Qr()}},Yr.prototype.readUint8=Yr.prototype.ka,Yr.prototype.Mb=function(){try{var e=this.K.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Qr()}},Yr.prototype.readUint16=Yr.prototype.Mb,Yr.prototype.F=function(){try{var e=this.K.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Qr()}},Yr.prototype.readUint32=Yr.prototype.F,Yr.prototype.Xd=function(){try{var e=this.K.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Qr()}},Yr.prototype.readInt32=Yr.prototype.Xd,Yr.prototype.yb=function(){try{if(this.b)var e=this.K.getUint32(this.a,!0),t=this.K.getUint32(this.a+4,!0);else t=this.K.getUint32(this.a,!1),e=this.K.getUint32(this.a+4,!1)}catch(e){Qr()}if(2097151<t)throw new fe(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Yr.prototype.readUint64=Yr.prototype.yb,Yr.prototype.Xa=function(e){this.a+e>this.K.byteLength&&Qr();var t=new Uint8Array(this.K.buffer,this.K.byteOffset+this.a,e);return this.a+=e,new Uint8Array(t)},Yr.prototype.readBytes=Yr.prototype.Xa,Yr.prototype.L=function(e){this.a+e>this.K.byteLength&&Qr(),this.a+=e},Yr.prototype.skip=Yr.prototype.L,Yr.prototype.$d=function(e){this.a<e&&Qr(),this.a-=e},Yr.prototype.rewind=Yr.prototype.$d,Yr.prototype.seek=function(e){(0>e||e>this.K.byteLength)&&Qr(),this.a=e},Yr.prototype.seek=Yr.prototype.seek,Yr.prototype.ad=function(){for(var e=this.a;this.sa()&&0!=this.K.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.K.buffer,this.K.byteOffset+e,this.a-e),this.a+=1,nt(e)},Yr.prototype.readTerminatedString=Yr.prototype.ad,V("shaka.util.Mp4Parser",Zr),Zr.prototype.H=function(e,t){var n=ni(e);return this.c[n]=0,this.b[n]=t,this},Zr.prototype.box=Zr.prototype.H,Zr.prototype.ea=function(e,t){var n=ni(e);return this.c[n]=1,this.b[n]=t,this},Zr.prototype.fullBox=Zr.prototype.ea,Zr.prototype.stop=function(){this.a=!0},Zr.prototype.stop=Zr.prototype.stop,Zr.prototype.parse=function(e,t){var n=new Uint8Array(e);for(n=new Yr(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.a=!1;n.sa()&&!this.a;)this.mc(0,n,t)},Zr.prototype.parse=Zr.prototype.parse,Zr.prototype.mc=function(e,t,n){var r=t.ba(),i=t.F(),a=t.F();switch(i){case 0:i=t.K.byteLength-r;break;case 1:i=t.yb()}var s=this.b[a];if(s){var o=null,u=null;1==this.c[a]&&(o=(u=t.F())>>>24,u&=16777215),a=r+i,n&&a>t.K.byteLength&&(a=t.K.byteLength),a-=t.ba(),t=0<a?t.Xa(a):new Uint8Array(0),s({parser:this,partialOkay:n||!1,version:o,flags:u,reader:t=new Yr(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:i,start:r+e})}else t.L(Math.min(r+i-t.ba(),t.K.byteLength-t.ba()))},Zr.prototype.parseNext=Zr.prototype.mc,Zr.children=Jr,Zr.sampleDescription=ei,Zr.allData=ti,Zr.typeToString=ri,V("shaka.media.SegmentIndex",ai),ai.prototype.destroy=function(){return this.a=null,Promise.resolve()},ai.prototype.destroy=ai.prototype.destroy,ai.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},ai.prototype.find=ai.prototype.find,ai.prototype.get=function(e){return 0==this.a.length?null:0>(e-=this.a[0].position)||e>=this.a.length?null:this.a[e]},ai.prototype.get=ai.prototype.get,ai.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},ai.prototype.offset=ai.prototype.offset,ai.prototype.Sc=function(e){for(var t=[],n=0,r=0;n<this.a.length&&r<e.length;){var i=this.a[n],a=e[r];i.startTime<a.startTime?(t.push(i),n++):(i.startTime>a.startTime?0==n&&t.push(a):(.1<Math.abs(i.endTime-a.endTime)?t.push(new zr(i.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(i),n++),r++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;r<e.length;)i=new zr(n++,(i=e[r++]).startTime,i.endTime,i.c,i.b,i.a),t.push(i);else t=e;this.a=t},ai.prototype.merge=ai.prototype.Sc,ai.prototype.Dc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},ai.prototype.evict=ai.prototype.Dc,oi.prototype.sa=function(){return this.a.sa()},hi.prototype.parse=function(e,t,n,r){var i;if(440786851!=ui(t=new oi(new DataView(t))).id)throw new fe(2,3,3008);var a=ui(t);if(408125543!=a.id)throw new fe(2,3,3009);for(t=a.a.byteOffset,a=new oi(a.a),i=null;a.sa();){var s=ui(a);if(357149030==s.id){i=s;break}}if(!i)throw new fe(2,3,3010);for(a=new oi(i.a),i=1e6,s=null;a.sa();){var o=ui(a);if(2807729==o.id)i=di(o);else if(17545==o.id)if(4==(s=o).a.byteLength)s=s.a.getFloat32(0);else{if(8!=s.a.byteLength)throw new fe(2,3,3003);s=s.a.getFloat64(0)}}if(null==s)throw new fe(2,3,3011);if(i=s*(a=i/1e9),475249515!=(e=ui(new oi(new DataView(e)))).id)throw new fe(2,3,3007);return function(e,t,n,r,i,a){function s(){return i}var o=[];e=new oi(e.a);for(var u=null,l=null;e.sa();){var c=ui(e);if(187==c.id){var d=fi(c);d&&(c=n*d.fg,d=t+d.Df,null!=u&&o.push(new zr(o.length,u-a,c-a,s,l,d-1)),u=c,l=d)}}return null!=u&&o.push(new zr(o.length,u-a,r-a,s,l,null)),o}(e,t,a,i,n,r)};var wi={wb:{},Lb:{},dd:function(e,t){wi.Lb[e]=t}};function Ei(e,t,n){this.f=e,this.pc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.m=!0,this.i=0,this.o=void 0===n||n}function Si(e,t,n,r){return e=Oe(e,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Ti(){var e=this;this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.h=1,this.m={},this.o=0,this.v=new H(5),this.i=new ce(function(){!function(e){f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return n=0,T(t,2),E(t,ki(e),4);case 4:n=t.s,C(t,3);break;case 2:r=I(t),e.a&&(r.severity=1,e.a.onError(r));case 3:if(!e.a)return t.return();xi(e,n),S(t)}})})}(e)}),this.g=new xe}function ki(e){var t=Date.now(),n=e.a.networkingEngine.request(0,Oe(e.f,e.b.retryParameters));return Le(e.g,n),n.promise.then(function(t){if(e.a)return t.uri&&!e.f.includes(t.uri)&&e.f.unshift(t.uri),function(e,t,n){if(!(t=Dr.Sd(t,"MPD")))throw new fe(2,4,4001,n);return t=Wr(t,e.b.retryParameters,e.b.dash.xlinkFailGracefully,n,e.a.networkingEngine),Le(e.g,t),t.promise.then(function(t){return function(e,t,n){return f(function r(){var i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,T,k,C,I,A;return P(r,function(r){switch(r.j){case 1:o=jt,l=[n],0<(c=(u=Dr).R(t,"Location").map(u.cc).filter(o.Ga)).length&&(d=Ht(l,c),l=e.f=d),h=u.R(t,"BaseURL").map(u.cc),f=Ht(l,h),p=e.b.dash.ignoreMinBufferTime,m=0,p||(m=u.J(t,"minBufferTime",u.Ba)),e.o=u.J(t,"minimumUpdatePeriod",u.Ba,-1),v=u.J(t,"availabilityStartTime",u.vf),y=u.J(t,"timeShiftBufferDepth",u.Ba),g=u.J(t,"suggestedPresentationDelay",u.Ba),_=u.J(t,"maxSegmentDuration",u.Ba),b=t.getAttribute("type")||"static",e.c?w=e.c.presentationTimeline:(T=Math.max(e.b.dash.defaultPresentationDelay,1.5*m),w=new Ei(v,null!=g?g:T,e.b.dash.autoCorrectDrift));for(var x={kb:"static"!=b,presentationTimeline:w,ja:null,S:null,ca:null,B:null,bandwidth:0,Fd:!1},L=f,N=Dr.J(t,"mediaPresentationDuration",Dr.Ba),R=[],M=0,P=Dr.R(t,"Period"),O=0;O<P.length;O++){var D=P[O];M=Dr.J(D,"start",Dr.Ba,M);var U=Dr.J(D,"duration",Dr.Ba),F=null;if(O!=P.length-1){var B=Dr.J(P[O+1],"start",Dr.Ba);null!=B&&(F=B-M)}else null!=N&&(F=N-M);if(null==F&&(F=U),D=Ci(e,x,L,{start:M,duration:F,node:D,Pc:null==F||O==P.length-1}),R.push(D),U=x.ja.id,e.l.includes(U)||(e.l.push(U),e.c&&(e.a.filterNewPeriod(D),e.c.periods.push(D))),null==F){M=null;break}M+=F}if(null==e.c&&e.a.filterAllPeriods(R),null!=N?(i=R,a=N,s=!1):(i=R,a=M,s=!0),k=a,C=i,w.Rb("static"==b),"static"!=b&&s||w.wa(k||1/0),w.V()&&!isNaN(e.b.availabilityWindowOverride)&&(y=e.b.availabilityWindowOverride),null==y&&(y=1/0),w.ld(y),w.Uc(_||1),e.c){r.A(0);break}if(e.c={presentationTimeline:w,periods:C,offlineSessionIds:[],minBufferTime:m||0},!w.he()){r.A(0);break}return I=u.R(t,"UTCTiming"),E(r,function(e,t,n){n=n.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var r=e.b.dash.clockSyncUri;return!n.length&&r&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),jt.ye(n,function(e){var n=e.scheme;switch(e=e.value,n){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Ni(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Ni(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return n=Date.parse(e),isNaN(n)?0:n-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return z("Unrecognized scheme in UTCTiming element",n),Promise.reject()}}.bind(e)).catch(function(){return z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(e,f,I),4);case 4:if(A=r.s,!e.a)return r.return();w.ce(A),S(r)}})})}(e,t,n)})}(e,t.data,t.uri)}).then(function(){var n=(Date.now()-t)/1e3;return K(e.v,1,n),n})}function Ci(e,t,n,r){if(t.ja=Li(r.node,null,n),t.S=r,t.ja.id||(t.ja.id="__shaka_period_"+r.start),Dr.R(r.node,"EventStream").forEach(e.wf.bind(e,r.start,r.duration)),n=Dr.R(r.node,"AdaptationSet").map(e.uf.bind(e,t)).filter(jt.Ga),t.kb){t=[];for(var i=d(n),a=i.next();!a.done;a=i.next())for(var s=(a=d(a.value.Gf)).next();!s.done;s=a.next())t.push(s.value);if(t.length!=new Set(t).size)throw new fe(2,4,4018)}var o=n.filter(function(e){return!e.pd});if(n.filter(function(e){return e.pd}).forEach(function(e){var t=e.streams[0],n=e.pd;o.forEach(function(e){e.id==n&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),t=Ii(o,"video"),i=Ii(o,"audio"),!t.length&&!i.length)throw new fe(2,4,4004);for(i.length||(i=[null]),t.length||(t=[null]),n=[],a=0;a<i.length;a++)for(s=0;s<t.length;s++)Ai(e,i[a],t[s],n);for(e=Ii(o,"text"),t=[],i=0;i<e.length;i++)t.push.apply(t,e[i].streams);return{startTime:r.start,textStreams:t,variants:n}}function Ii(e,t){return e.filter(function(e){return e.contentType==t})}function Ai(e,t,n,r){if(t||n)if(t&&n){var i=t.drmInfos,a=n.drmInfos;if(!i.length||!a.length||0<xt(i,a).length){a=xt(t.drmInfos,n.drmInfos);for(var s=0;s<t.streams.length;s++)for(var o=0;o<n.streams.length;o++)i=(n.streams[o].bandwidth||0)+(t.streams[s].bandwidth||0),i={id:e.h++,language:t.language,primary:t.Qc||n.Qc,audio:t.streams[s],video:n.streams[o],bandwidth:i,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}}else for(a=t||n,s=0;s<a.streams.length;s++)i=a.streams[s].bandwidth||0,i={id:e.h++,language:a.language||"und",primary:a.Qc,audio:t?a.streams[s]:null,video:n?a.streams[s]:null,bandwidth:i,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}function xi(e,t){0>e.o||e.i.O(Math.max(3,e.o-t,G(e.v)))}function Li(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Wc:null},n=n||t.oa;var r=Dr.vb,i=Dr.Ae,a=Dr.R(e,"BaseURL").map(Dr.cc),s=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs;i=Dr.J(e,"frameRate",i)||t.frameRate;for(var l=Dr.R(e,"InbandEventStream"),c=t.emsgSchemeIdUris.slice(),h=(l=d(l)).next();!h.done;h=l.next())h=h.value.getAttribute("schemeIdUri"),c.includes(h)||c.push(h);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],r=n.getAttribute("schemeIdUri");if(r&&(n=n.getAttribute("value")))switch(r){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(r=parseInt(n,10)))continue;return r;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(r=parseInt(n,16)){for(e=0;r;)1&r&&++e,r>>=1;return e}}}return null}(l=Dr.R(e,"AudioChannelConfiguration"))||t.Wc,s||(s=Ri(o,u)),{oa:Ht(n,a),Ob:Dr.ac(e,"SegmentBase")||t.Ob,Ja:Dr.ac(e,"SegmentList")||t.Ja,Qb:Dr.ac(e,"SegmentTemplate")||t.Qb,width:Dr.J(e,"width",r)||t.width,height:Dr.J(e,"height",r)||t.height,contentType:s,mimeType:o,codecs:u,frameRate:i,emsgSchemeIdUris:c,id:e.getAttribute("id"),Wc:l}}function Ni(e,t,n,r){return(t=Oe(t=Ht(t,[n]),e.b.retryParameters)).method=r,t=e.a.networkingEngine.request(4,t),Le(e.g,t),t.promise.then(function(e){if("HEAD"==r){if(!e.headers||!e.headers.date)return 0;e=e.headers.date}else e=nt(e.data);return e=Date.parse(e),isNaN(e)?0:e-Date.now()})}function Ri(e,t){return mn(Ye(e,t))?"text":e.split("/")[0]}function Mi(e,t,n,r){this.b=e,this.type=t,this.a=n,this.segments=r||null}function Pi(e,t,n,r){this.id=e,this.name=t,this.a=n,this.value=void 0===r?null:r}function Oi(e,t){this.name=e,this.value=t}function Di(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Ui(e,t){this.b=t,this.a=e}V("shaka.media.ManifestParser.registerParserByExtension",wi.dd),wi.Nb=function(e,t){wi.wb[e]=t},V("shaka.media.ManifestParser.registerParserByMime",wi.Nb),wi.Af=function(){var e={};if(Qe()){for(var t in wi.wb)e[t]=!0;for(var n in wi.Lb)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var r=(n=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!r.done;r=n.next())e[r=r.value]=Qe()?!!wi.wb[r]:Ze(r);for(var i in t)e[i]=Qe()?!!wi.Lb[i]:Ze(t[i]);return e},wi.create=function(e,t,n,r){return f(function i(){var a,s;return P(i,function(i){switch(i.j){case 1:return T(i,2),E(i,wi.He(e,t,n,r),4);case 4:return a=i.s,i.return(new a);case 2:throw(s=I(i)).severity=2,s}})})},wi.He=function(e,t,n,r){return f(function i(){var a,s,o,u,l;return P(i,function(i){switch(i.j){case 1:if(a=wi,r&&(s=a.wb[r.toLowerCase()]))return i.return(s);if((o=a.getExtension(e))&&(u=a.Lb[o]))return i.return(u);if(r){i.A(2);break}return E(i,a.Oe(e,t,n),3);case 3:if((r=i.s)&&(l=wi.wb[r]))return i.return(l);case 2:throw new fe(2,4,4e3,e)}})})},wi.Oe=function(e,t,n){return f(function r(){var i,a,s;return P(r,function(r){switch(r.j){case 1:return(i=Oe([e],n)).method="HEAD",E(r,t.request(0,i).promise,2);case 2:return a=r.s,s=a.headers["content-type"],r.return(s?s.toLowerCase():"")}})})},wi.getExtension=function(e){return 1==(e=new $(e).ia.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},wi.isSupported=function(e,t){return!!Qe()&&(t in wi.wb||wi.getExtension(e)in wi.Lb)},V("shaka.media.PresentationTimeline",Ei),Ei.prototype.Y=function(){return this.g},Ei.prototype.getDuration=Ei.prototype.Y,Ei.prototype.wa=function(e){this.g=e},Ei.prototype.setDuration=Ei.prototype.wa,Ei.prototype.Te=function(){return this.f},Ei.prototype.getPresentationStartTime=Ei.prototype.Te,Ei.prototype.ce=function(e){this.l=e},Ei.prototype.setClockOffset=Ei.prototype.ce,Ei.prototype.Rb=function(e){this.m=e},Ei.prototype.setStatic=Ei.prototype.Rb,Ei.prototype.ld=function(e){this.h=e},Ei.prototype.setSegmentAvailabilityDuration=Ei.prototype.ld,Ei.prototype.Qf=function(e){this.pc=e},Ei.prototype.setDelay=Ei.prototype.Qf,Ei.prototype.Fe=function(){return this.pc},Ei.prototype.getDelay=Ei.prototype.Fe,Ei.prototype.sb=function(e,t){if(0!=e.length){var n=e[e.length-1].endTime+t;this.Vc(e[0].startTime+t),this.a=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.a),this.b=Math.max(this.b,n),null!=this.f&&this.o&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a)}},Ei.prototype.notifySegments=Ei.prototype.sb,Ei.prototype.Vc=function(e){this.c=null==this.c?e:Math.min(this.c,e)},Ei.prototype.notifyMinSegmentStartTime=Ei.prototype.Vc,Ei.prototype.Uc=function(e){this.a=Math.max(this.a,e)},Ei.prototype.notifyMaxSegmentDuration=Ei.prototype.Uc,Ei.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},Ei.prototype.offset=Ei.prototype.offset,Ei.prototype.V=function(){return 1/0==this.g&&!this.m},Ei.prototype.isLive=Ei.prototype.V,Ei.prototype.Va=function(){return 1/0!=this.g&&!this.m},Ei.prototype.isInProgress=Ei.prototype.Va,Ei.prototype.Hb=function(){if(1/0==this.h)return this.i;var e=this.nb()-this.h;return Math.max(this.i,e)},Ei.prototype.getSegmentAvailabilityStart=Ei.prototype.Hb,Ei.prototype.de=function(e){this.i=e},Ei.prototype.setUserSeekStart=Ei.prototype.de,Ei.prototype.nb=function(){return this.V()||this.Va()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},Ei.prototype.getSegmentAvailabilityEnd=Ei.prototype.nb,Ei.prototype.Gb=function(e){var t=Math.max(this.c,this.i);if(1/0==this.h)return t;var n=this.nb()-this.h;return e=Math.min(n+e,this.za()),Math.max(t,e)},Ei.prototype.getSafeSeekRangeStart=Ei.prototype.Gb,Ei.prototype.mb=function(){return this.Gb(0)},Ei.prototype.getSeekRangeStart=Ei.prototype.mb,Ei.prototype.za=function(){var e=this.V()||this.Va()?this.pc:0;return Math.max(0,this.nb()-e)},Ei.prototype.getSeekRangeEnd=Ei.prototype.za,Ei.prototype.he=function(){return null!=this.f&&null==this.b},Ei.prototype.usingPresentationStartTime=Ei.prototype.he,V("shaka.dash.DashParser",Ti),(n=Ti.prototype).configure=function(e){this.b=e},n.start=function(e,t){var n=this;return f(function r(){var i;return P(r,function(r){switch(r.j){case 1:return n.f=[e],n.a=t,E(r,ki(n),2);case 2:if(i=r.s,n.a&&xi(n,i),!n.a)throw new fe(2,7,7001);return r.return(n.c)}})})},n.stop=function(){return this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.m={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},n.update=function(){ki(this).catch(function(e){this.a&&this.a.onError(e)}.bind(this))},n.onExpirationUpdated=function(){},n.uf=function(e,t){e.ca=Li(t,e.ja,null);var n=!1,r=Dr.R(t,"Role"),i=r.map(function(e){return e.getAttribute("value")}).filter(jt.Ga),a=void 0,s="text"==e.ca.contentType;s&&(a="subtitle");for(var o=0;o<r.length;o++){var u=r[o].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=r[o].getAttribute("value"),u){case"main":n=!0;break;case"caption":case"subtitle":a=u}}var l=null,c=!1;Dr.R(t,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?l=e.getAttribute("value"):c=!0}),o=Dr.R(t,"Accessibility");var h=new Map;for(r={},u=(o=d(o)).next();!u.done;r={Db:r.Db},u=o.next()){var f=(u=u.value).getAttribute("schemeIdUri");"urn:scte:dash:cc:cea-608:2015"!=f&&"urn:scte:dash:cc:cea-708:2015"!=f||(r.Db=1,null!=(u=u.getAttribute("value"))?u.split(";").forEach(function(e){return function(t){if(t.includes("=")){var n=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else n="CC"+e.Db,e.Db+=2;h.set(n,Rn(t))}}(r)):h.set("CC1","und"))}if(c)return null;var p=Fr(r=Dr.R(t,"ContentProtection"),this.b.dash.customScheme,this.b.dash.ignoreDrmInfo);if(r=Rn(t.getAttribute("lang")||"und"),u=t.getAttribute("label"),0==(i=(o=Dr.R(t,"Representation")).map(this.xf.bind(this,e,p,a,r,u,n,i,h)).filter(function(e){return!!e})).length){if(s)return null;throw new fe(2,4,4003)}return e.ca.contentType&&"application"!=e.ca.contentType||(e.ca.contentType=Ri(i[0].mimeType,i[0].codecs),i.forEach(function(t){t.type=e.ca.contentType})),i.forEach(function(e){p.drmInfos.forEach(function(t){e.keyId&&t.keyIds.push(e.keyId)})}),s=o.map(function(e){return e.getAttribute("id")}).filter(jt.Ga),{id:e.ca.id||"__fake__"+this.h++,contentType:e.ca.contentType,language:r,Qc:n,streams:i,drmInfos:p.drmInfos,pd:l,Gf:s}},n.xf=function(e,t,n,r,i,a,s,o,u){if(e.B=Li(u,e.ca,null),!function(e){var t=e.Ob?1:0;return t+=e.Ja?1:0,0==(t+=e.Qb?1:0)?"text"==e.contentType||"application"==e.contentType:(1!=t&&(e.Ob&&(e.Ja=null),e.Qb=null),!0)}(e.B))return null;e.bandwidth=Dr.J(u,"bandwidth",Dr.nc)||0;var l=e.B.contentType;l="text"==l||"application"==l;try{var c=this.Hf.bind(this);if(e.B.Ob)var d=function(e,t){var n=Number(Kr(e,vi,"presentationTimeOffset"))||0,r=Kr(e,vi,"timescale"),i=1;r&&(i=Dr.nc(r)||1),n=n/i||0,r=pi(e,vi);var a=e.B.contentType;if(i=e.B.mimeType.split("/")[1],"text"!=a&&"mp4"!=i&&"webm"!=i)throw new fe(2,4,4006);if("webm"==i&&!r)throw new fe(2,4,4005);a=Gr(e,vi,"RepresentationIndex");var s=Kr(e,vi,"indexRange"),o=e.B.oa;if(s=Dr.oc(s||""),a){var u=a.getAttribute("sourceURL");u&&(o=Ht(e.B.oa,[u])),s=Dr.J(a,"range",Dr.oc,s)}if(!s)throw new fe(2,4,4002);return{createSegmentIndex:(i=mi(e,t,r,o,s.start,s.end,i,n)).createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:r,la:n}}(e,c);else if(e.B.Ja)d=yi(e,this.m);else if(e.B.Qb)d=_i(e,c,this.m,!!this.c);else{var h=e.B.oa,f=e.S.duration||0;d={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<f?1:null},getSegmentReference:function(e){return 1!=e?null:new zr(1,0,f,function(){return h},0,null)},initSegmentReference:null,la:0}}}catch(e){if(l&&4002==e.code)return null;throw e}return u=function(e,t,n,r){var i=Fr(e,t,r);if(n.Ad)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==i.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=i.drmInfos),n.Ad=!1;else if(0<i.drmInfos.length&&(n.drmInfos=n.drmInfos.filter(function(e){return i.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==n.drmInfos.length))throw new fe(2,4,4008);return i.vd||n.vd}(u=Dr.R(u,"ContentProtection"),this.b.dash.customScheme,t,this.b.dash.ignoreDrmInfo),{id:this.h++,originalId:e.B.id,createSegmentIndex:d.createSegmentIndex,findSegmentPosition:d.findSegmentPosition,getSegmentReference:d.getSegmentReference,initSegmentReference:d.initSegmentReference,presentationTimeOffset:d.la,mimeType:e.B.mimeType,codecs:e.B.codecs,frameRate:e.B.frameRate,bandwidth:e.bandwidth,width:e.B.width,height:e.B.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:r,label:i,type:e.ca.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.B.emsgSchemeIdUris,roles:s,channelsCount:e.B.Wc,closedCaptions:o}},n.wf=function(e,t,n){var r=Dr.vb,i=n.getAttribute("schemeIdUri")||"",a=n.getAttribute("value")||"",s=Dr.J(n,"timescale",r)||1;Dr.R(n,"Event").forEach(function(n){var o=Dr.J(n,"presentationTime",r)||0,u=Dr.J(n,"duration",r)||0;u=(o=o/s+e)+u/s,null!=t&&(o=Math.min(o,e+t),u=Math.min(u,e+t)),n={schemeIdUri:i,value:a,startTime:o,endTime:u,id:n.getAttribute("id")||"",eventElement:n},this.a.onTimelineRegionAdded(n)}.bind(this))},n.Hf=function(e,t,n){return e=Si(e,t,n,this.b.retryParameters),e=this.a.networkingEngine.request(1,e),Le(this.g,e),e.promise.then(function(e){return e.data})},wi.dd("mpd",Ti),wi.Nb("application/dash+xml",Ti),Pi.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Pi.prototype.getAttribute=function(e){var t=this.a.filter(function(t){return t.name==e});return t.length?t[0]:null};var Fi={lb:function(e,t){return e.filter(function(e){return e.name==t})},Ra:function(e,t){var n=Fi.lb(e,t);return n.length?n[0]:null},Gc:function(e,t,n){return e.filter(function(e){var r=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),r.value==t&&e.value==n})},zc:function(e,t){return Ht([e],[t])[0]},Oc:function(e){return/^#(?!EXT)/m.test(e)}};function Bi(e){this.b=e,this.a=0}function Vi(e){ji(e,/[ \t]+/gm)}function ji(e,t){t.lastIndex=e.a;var n=t.exec(e.b);return n=null==n?null:{position:n.index,length:n[0].length,Jf:n},e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.Jf)}function Hi(e){return e.a==e.b.length?null:(e=ji(e,/[^ \t\n]*/gm))?e[0]:null}function Ki(){this.a=0}function Gi(e,t,n){var r=(t=(t=nt(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(r[0]))throw new fe(2,4,4015);t=0;for(var i=1;i<r.length;i++)if(!Fi.Oc(r[i])){var a=qi(e,r[i]);if(--e.a,zi.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(i+=1)}for(i=[],a=1;a<r.length;)if(Fi.Oc(r[a]))a+=1;else{var s=qi(e,r[a]);if(Yi.includes(s.name)){if(1!=t)throw new fe(2,4,4017);return new Mi(n,t,i,e=Wi(e,n,r=r.splice(a,r.length-a),i))}i.push(s),a+=1,"EXT-X-STREAM-INF"==s.name&&(s.a.push(new Oi("URI",r[a])),a+=1)}return new Mi(n,t,i)}function Wi(e,t,n,r){var i=[],a=[];return n.forEach(function(n){if(/^(#EXT)/.test(n))n=qi(e,n),zi.includes(n.name)?r.push(n):a.push(n);else{if(Fi.Oc(n))return[];n=Fi.zc(t,n.trim()),i.push(new Ui(n,a)),a=[]}}),i}function qi(e,t){var n=e.a++,r=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new fe(2,4,4016,t);var i,a=r[1],s=r[2];if(r=[],s){var o;(o=ji(s=new Bi(s),/^([^,=]+)(?:,|$)/g))&&(i=o[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=ji(s,u);)r.push(new Oi(o[1],o[2]||o[3]))}return new Pi(n,a,r,i)}var zi="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Yi="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Xi(e){try{var t=Xi.parse(e);return ge({uri:e,$c:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return ve(e)}}function $i(){var e=this;this.c=this.g=null,this.$=1,this.D=new Map,this.T=new Set,this.a=new Map,this.b=null,this.v="",this.o=new Ki,this.P=0,this.h=new ce(function(){!function(e){f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return e.g?(T(t,2),E(t,e.update(),4)):t.return();case 4:n=e.P,e.h.O(n),C(t,0);break;case 2:(r=I(t)).severity=1,e.g.onError(r),e.h.O(.1),S(t)}})})}(e)}),this.f=va,this.m=null,this.C=0,this.G=1/0,this.i=new xe,this.M=[],this.l=new Map,this.W=!1}function Qi(e,t){return f(function n(){var r,i,a,s,o,u,l,c,d,h;return P(n,function(n){switch(n.j){case 1:return r=Fi,i=ya,a=t.pe,E(n,ca(e,a),2);case 2:if(s=n.s,1!=(o=Gi(e.o,s.data,s.uri)).type)throw new fe(2,4,4017);return l=(u=r.Ra(o.a,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,c=t.stream,E(n,aa(e,t.tc,o,l,c.mimeType,c.codecs),3);case 3:d=n.s,t.Pb.a=d,h=d[d.length-1],r.Ra(o.a,"EXT-X-ENDLIST")&&(fa(e,i.Oa),e.b.wa(h.endTime)),S(n)}})})}function Zi(e){e.forEach(function(e){var t=e.stream.codecs.split(",");t=t.filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(",")})}function Ji(e,t,n,r,i){return{id:e.$++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:r,drmInfos:i,allowedByApplication:!0,allowedByKeySystem:!0}}function ea(e,t,n){return f(function r(){var i,a,s,o,u,l,c,d,h;return P(r,function(r){switch(r.j){case 1:if(i=ua(t,"URI"),e.a.has(i))return r.return(e.a.get(i));if(a=ua(t,"TYPE").toLowerCase(),s=Gt,"subtitles"==a&&(a=s.qa),o=Rn(Di(t,"LANGUAGE","und")),u=Di(t,"NAME"),l=t.getAttribute("DEFAULT"),c=t.getAttribute("AUTOSELECT"),d=Di(t,"CHANNELS"),"audio"==a)if(d){var f=d.split("/")[0];f=parseInt(f,10)}else f=null;else f=null;return E(r,ta(e,i,n,a,o,!!l||!!c,u,f,null),2);case 2:return null==(h=r.s)?r.return(null):e.a.has(i)?r.return(e.a.get(i)):(e.D.set(t.id,h),e.a.set(i,h),r.return(h))}})})}function ta(e,t,n,r,i,a,s,o,u){return f(function l(){var c,h,p,m,v,y,g,_,b,w,S,T,k,C,I,A,x,L,N,R,M,O,D,U,F;return P(l,function(l){switch(l.j){case 1:return h=(c=Fi).zc(e.v,t),m="",E(l,ca(e,h),2);case 2:if(y=l.s,h=y.uri,1!=(p=Gi(e.o,y.data,h)).type)throw new fe(2,4,4017);g=[],p.segments.forEach(function(e){e=c.lb(e.b,"EXT-X-KEY"),g.push.apply(g,e)}),_=!1,b=[],w=null;for(var B=d(g),V=B.next();!V.done;V=B.next())if(S=V.value,"NONE"!=(T=ua(S,"METHOD"))){if(_=!0,"AES-128"==T)return e.W=!0,l.return(null);k=ua(S,"KEYFORMAT"),(I=(C=ma[k])?C(S):null)&&(I.keyIds.length&&(w=I.keyIds[0]),b.push(I))}if(_&&!b.length)throw new fe(2,4,4026);return function(e,t){var n=ya,r=Fi.Ra(t.a,"EXT-X-PLAYLIST-TYPE"),i=Fi.Ra(t.a,"EXT-X-ENDLIST");i=r&&"VOD"==r.value||i,r=r&&"EVENT"==r.value&&!i,r=!i&&!r,i?fa(e,n.Oa):(fa(e,r?n.sd:n.ke),n=la(t.a,"EXT-X-TARGETDURATION"),n=Number(n.value),e.C=Math.max(n,e.C),e.G=Math.min(n,e.G))}(e,p),m=function(e,t){if(1==t.length)return t[0];var n=oa(e,t);if(null!=n)return n;throw new fe(2,4,4025,t)}(r,n),E(l,function(e,t,n,r){return f(function i(){var a,s,o,u,l,c,d,h,f,p;return P(i,function(i){switch(i.j){case 1:return a=Gt,s=Re,o=r.segments[0].a,u=new $(o),l=u.ia.split(".").pop(),c=ha[t],(d=c[l])?i.return(d):t==a.qa?n&&"vtt"!=n?i.return("application/mp4"):i.return("text/vtt"):((h=Oe([o],e.c.retryParameters)).method="HEAD",E(i,pa(e,h,s.td),2));case 2:if(f=i.s,!(p=f.headers["content-type"]))throw new fe(2,4,4021,l);return i.return(p.split(";")[0])}})})}(e,r,m,p),3);case 3:return v=l.s,x=(A=c.Ra(p.a,"EXT-X-MEDIA-SEQUENCE"))?Number(A.value):0,E(l,aa(e,t,p,x,v,m),4);case 4:return L=l.s,N=L[0].startTime,R=L[L.length-1].endTime,M=R-N,O=new ai(L),D=na(p),U=void 0,"text"==r&&(U="subtitle"),F={id:e.$++,originalId:s,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:O.find.bind(O),getSegmentReference:O.get.bind(O),initSegmentReference:D,presentationTimeOffset:0,mimeType:v,codecs:m,kind:U,encrypted:_,keyId:w,language:i,label:s,type:r,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:o,closedCaptions:u},l.return({stream:F,Pb:O,drmInfos:b,tc:t,pe:h,Tc:N,qg:R,duration:M})}})})}function na(e){var t=Fi.lb(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new fe(2,4,4020);var n=ua(t=t[0],"URI"),r=Fi.zc(e.b,n);return e=0,n=null,(t=Di(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new qr(function(){return[r]},e,n)}function ra(e,t,n,r){var i=t.b,a=t.a;t=la(i,"EXTINF").value.split(","),t=r+Number(t[0]);var s=0,o=null;return(i=Fi.Ra(i,"EXT-X-BYTERANGE"))&&(s=i.value.split("@"),i=Number(s[0]),o=(s=s[1]?Number(s[1]):e.a+1)+i-1),new zr(n,r,t,function(){return[a]},s,o)}function ia(e){e.b&&(e.M.forEach(function(t){e.b.sb(t,0)}),e.M=[])}function aa(e,t,n,r,i,a){return f(function s(){var o,u,l,c,d,h,p,m,v,y;return P(s,function(s){switch(s.j){case 1:return o=n.segments,u=[],l=o[0].a,c=ra(null,o[0],r,0),d=na(n),E(s,function(e,t,n,r,i,a){return f(function s(){var o,u,l,c,d,h,f,p,m;return P(s,function(s){switch(s.j){case 1:if(e.m&&(o=e.a.get(t),u=o.Pb,l=u.get(r.position)))return s.return(l.startTime);if("audio/mpeg"==i)return s.return(0);if("video/mp4"!=i&&"audio/mp4"!=i){s.A(2);break}return c=[sa(e,r)],n&&c.push(sa(e,n)),E(s,Promise.all(c),3);case 3:return d=s.s,h=d[0],f=d[1]||d[0],s.return(function(e,t){var n=0;if((new Zr).H("moov",Jr).H("trak",Jr).H("mdia",Jr).ea("mdhd",function(e){e.reader.L(0==e.version?8:16),n=e.reader.F(),e.parser.stop()}).parse(t,!0),!n)throw new fe(2,4,4030);var r=0,i=!1;if((new Zr).H("moof",Jr).H("traf",Jr).ea("tfdt",function(e){r=(0==e.version?e.reader.F():e.reader.yb())/n,i=!0,e.parser.stop()}).parse(e,!0),!i)throw new fe(2,4,4030);return r}(h.data,f.data));case 2:if("video/mp2t"!=i){s.A(4);break}return E(s,sa(e,r),5);case 5:return p=s.s,s.return(function(e){function t(){throw new fe(2,4,4030)}e=new Yr(new DataView(e),0);for(var n=0,r=0;;){if(n=e.ba(),71!=(r=e.ka())&&t(),16384&e.Mb()||t(),0!=(r=(48&e.ka())>>4)&&2!=r||t(),3==r&&(r=e.ka(),e.L(r)),1==e.F()>>8)return e.L(3),0!=(n=e.ka()>>6)&&1!=n||t(),0==e.ka()&&t(),n=e.ka(),r=e.Mb(),e=e.Mb(),(1073741824*((14&n)>>1)+((65534&r)<<14|(65534&e)>>1))/9e4;e.seek(n+188),71!=(r=e.ka())&&(e.seek(n+192),r=e.ka()),71!=r&&(e.seek(n+204),r=e.ka()),71!=r&&t(),e.$d(1)}}(p.data));case 4:if("application/mp4"!=i&&!i.startsWith("text/")){s.A(6);break}return E(s,sa(e,r),7);case 7:return m=s.s,s.return(function(e,t,n){return mn(e=Ye(e,t))?(vn(t=new fn(null),e),t.Lc(n)):0}(i,a,m.data));case 6:throw new fe(2,4,4030)}})})}(e,t,d,c,i,a),2);case 2:h=s.s,l.split("/").pop();for(var g=0;g<o.length;++g)p=o[g],m=u[u.length-1],v=0==g?h:m.endTime,y=ra(m,p,r+g,v),u.push(y);return e.M.push(u),ia(e),s.return(u)}})})}function sa(e,t){return f(function n(){var r,i,a,s,o,u;return P(n,function(n){switch(n.j){case 1:return r=Re,i=Si(t.c(),t.b,t.b+2048-1,e.c.retryParameters),a=Si(t.c(),t.b,t.a,e.c.retryParameters),T(n,2),E(n,pa(e,i,r.td),4);case 4:return s=n.s,n.return(s);case 2:if(7001==(o=I(n)).code)throw o;return z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),E(n,pa(e,a,r.td),5);case 5:return u=n.s,n.return(u)}})})}function oa(e,t){for(var n=da[e],r=0;r<n.length;r++)for(var i=0;i<t.length;i++)if(n[r].test(t[i].trim()))return t[i].trim();return"text"==e?"":null}function ua(e,t){var n=e.getAttribute(t);if(!n)throw new fe(2,4,4023,t);return n.value}function la(e,t){var n=Fi.Ra(e,t);if(!n)throw new fe(2,4,4024,t);return n}function ca(e,t){return pa(e,Oe([t],e.c.retryParameters),Re.ng)}V("shaka.net.DataUriPlugin",Xi),Xi.parse=function(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new fe(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw new fe(2,1,1004,t);var r=n[0];n=e.decodeURIComponent(n.slice(1).join(","));var i=null;if(1<(r=r.split(";")).length&&(i=r[1]),"base64"==i)t=ct(n).buffer;else{if(i)throw new fe(2,1,1005,t);t=at(n)}return{data:t,contentType:r[0]}},Pe("data",Xi),V("shaka.hls.HlsParser",$i),(n=$i.prototype).configure=function(e){this.c=e},n.start=function(e,t){var n=this;return f(function r(){var i,a;return P(r,function(r){switch(r.j){case 1:return n.g=t,E(r,ca(n,e),2);case 2:return i=r.s,n.v=i.uri,E(r,function(e,t){return f(function n(){var r,i,a,s,o,u,l,c,h,p,m;return P(n,function(n){switch(n.j){case 1:if(0!=(r=Gi(e.o,t,e.v)).type)throw new fe(2,4,4022);return E(n,function(e,t){return f(function n(){var r,i,a,s,o,u,l,c,h,p,m,v;return P(n,function(n){switch(n.j){case 1:return r=Fi,i=jt,a=t.a,s=r.lb(t.a,"EXT-X-MEDIA"),o=s.filter(function(e){return"SUBTITLES"==ua(e,"TYPE")}.bind(e)),u=o.map(function(e){return function(e,t){return f(function n(){var r;return P(n,function(n){switch(n.j){case 1:return ua(t,"TYPE"),E(n,ea(e,t,[]),2);case 2:return r=n.s,n.return(r.stream)}})})}(this,e)}.bind(e)),l=s.filter(function(e){return"CLOSED-CAPTIONS"==ua(e,"TYPE")}),function(e,t){for(var n=d(t),r=n.next();!r.done;r=n.next()){ua(r=r.value,"TYPE");var i=Di(r,"LANGUAGE")||"und";i=Rn(i);var a=ua(r,"GROUP-ID");r=ua(r,"INSTREAM-ID"),e.l.get(a)||e.l.set(a,new Map),e.l.get(a).set(r,i)}}(e,l),E(n,Promise.all(u),2);case 2:return c=n.s,h=r.lb(a,"EXT-X-STREAM-INF"),p=h.map(function(e){return function(e,t,n){return f(function r(){var i,a,s,o,u,l,c,h,p,m,v,y,g,_,b,w,S,T,k,C,I,A,x,L,N,R;return P(r,function(r){switch(r.j){case 1:return i=Gt,a=Fi,s=Di(t,"CODECS","avc1.42E01E,mp4a.40.2"),o=function(e){for(var t=new Set,n=[],r=(e=d(e)).next();!r.done;r=e.next()){var i=Xe(r=r.value)[0];t.has(i)||(n.push(r),t.add(i))}return n}(s.split(/\s*,\s*/)),u=t.getAttribute("RESOLUTION"),c=l=null,h=Di(t,"FRAME-RATE"),p=Number(ua(t,"BANDWIDTH")),u&&(m=u.value.split("x"),l=m[0],c=m[1]),v=(v=(v=a.lb(n.a,"EXT-X-MEDIA")).filter(function(e){return"CLOSED-CAPTIONS"!=ua(e,"TYPE")})).filter(function(e){var t=Di(e,"URI")||"";return"SUBTITLES"==(Di(e,"TYPE")||"")||""!=t}),y=Di(t,"AUDIO"),g=Di(t,"VIDEO"),y?v=a.Gc(v,"AUDIO",y):g&&(v=a.Gc(v,"VIDEO",g)),(_=oa(i.qa,o))&&((b=Di(t,"SUBTITLES"))&&((w=a.Gc(v,"SUBTITLES",b)).length&&(e.D.get(w[0].id).stream.codecs=_)),Ie(o,_)),S=v.map(function(e){return ea(this,e,o)}.bind(e)),T=[],k=[],E(r,Promise.all(S),2);case 2:if(I=(I=r.s).filter(function(e){return null!=e}),y?T=I:g&&(k=I),x=!1,T.length||k.length?T.length?(N=ua(t,"URI"),R=T[0].tc,N==R?(A=i.Ab,x=!0):A=i.Na):A=i.Ab:1==o.length?(L=oa(i.Na,o),A=u||h||L?i.Na:i.Ab):(A=i.Na,o=[o.join(",")]),x){r.A(3);break}return E(r,function(e,t,n,r){return f(function i(){var a,s,o,u,l;return P(i,function(i){switch(i.j){case 1:return a=Gt,s=ua(t,"URI"),e.a.has(s)?i.return(e.a.get(s)):(o=Di(t,"CLOSED-CAPTIONS"),u=null,r==a.Na&&o&&"NONE"!=o&&(u=e.l.get(o)),E(i,ta(e,s,n,r,"und",!1,null,null,u),2));case 2:return null==(l=i.s)?i.return(null):e.a.has(s)?i.return(e.a.get(s)):(e.a.set(s,l),i.return(l))}})})}(e,t,o,A),4);case 4:C=r.s;case 3:if(C)C.stream.type==i.Ab?T=[C]:k=[C];else if(null===C)return r.return([]);return k&&Zi(k),T&&Zi(T),r.return(function(e,t,n,r,i,a,s){n.forEach(function(e){(e=e.stream)&&(e.width=Number(i)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(s)||void 0)}.bind(e)),t.length||(t=[null]),n.length||(n=[null]);for(var o=[],u=(t=d(t)).next();!u.done;u=t.next()){u=u.value;for(var l=d(n),c=l.next();!c.done;c=l.next()){var h=c.value;c=u?u.stream:null;var f=h?h.stream:null,p=u?u.drmInfos:null,m=h?h.drmInfos:null;h=(h?h.tc:"")+" - "+(u?u.tc:"");var v=void 0;if(c&&f){if(p.length&&m.length&&!(0<xt(p,m).length))continue;v=xt(p,m)}else c?v=p:f&&(v=m);e.T.has(h)||(c=Ji(e,c,f,r,v),o.push(c),e.T.add(h))}}return o}(e,T,k,p,l,c,h))}})})}(this,e,t)}.bind(e)),E(n,Promise.all(p),3);case 3:return m=n.s,v=(v=m.reduce(i.yc,[])).filter(function(e){return null!=e}),n.return({startTime:0,variants:v,textStreams:c})}})})}(e,r),2);case 2:if(i=n.s,!e.g)throw new fe(2,7,7001);if(e.W&&0==i.variants.length)throw new fe(2,4,4034);e.g.filterAllPeriods([i]),a=1/0,s=0,o=1/0;for(var v=d(e.a.values()),y=v.next();!y.done;y=v.next())u=y.value,a=Math.min(a,u.Tc),s=Math.max(s,u.Tc),"text"!=u.stream.type&&(o=Math.min(o,u.duration));if(e.f!=ya.Oa?(e.b=new Ei(0,3*e.C),e.b.Rb(!1)):(e.b=new Ei(null,0),e.b.Rb(!0)),ia(e),e.f!=ya.Oa){for(e.P=e.G,l=ya,e.f==l.sd&&(c=e.b.pc,isNaN(e.c.availabilityWindowOverride)||(c=e.c.availabilityWindowOverride),e.b.ld(c)),h=0;95443.7176888889<=s;)h+=95443.7176888889,s-=95443.7176888889;if(h)for(v=d(e.a.values()),y=v.next();!y.done;y=v.next())95443.7176888889>(p=y.value).Tc&&(p.stream.presentationTimeOffset=-h,p.Pb.offset(h))}else for(e.b.wa(o),e.b.offset(-a),v=d(e.a.values()),y=v.next();!y.done;y=v.next())(m=y.value).stream.presentationTimeOffset=a,m.Pb.offset(-a),si(m.Pb,o);e.m={presentationTimeline:e.b,periods:[i],offlineSessionIds:[],minBufferTime:0},S(n)}})})}(n,i.data),3);case 3:return 0<(a=n.P)&&n.h.O(a),r.return(n.m)}})})},n.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.c=this.g=null,this.D.clear(),this.T.clear(),this.a.clear(),this.m=null,Promise.all(e)},n.update=function(){if(this.f!=ya.Oa){for(var e=[],t=d(this.a.values()),n=t.next();!n.done;n=t.next())e.push(Qi(this,n.value));return Promise.all(e)}},n.onExpirationUpdated=function(){};var da={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},ha={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function fa(e,t){e.f=t,e.b&&e.b.Rb(e.f==ya.Oa),e.f!=ya.Oa||e.h.stop()}function pa(e,t,n){if(!e.i)throw new fe(2,7,7001);return t=e.g.networkingEngine.request(n,t),Le(e.i,t),t.promise}var ma={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ua(e,"METHOD");return Jn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227"),["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].includes(t)?(t=ua(e,"URI"),t=Xi.parse(t),t=Kt("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Di(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t):null}},va="VOD",ya={Oa:va,ke:"EVENT",sd:"LIVE"};function ga(){this.a=new Map}function _a(e,t,n){ba(e,t).text=n}function ba(e,t){return e.a.has(t)||e.a.set(t,new wa),e.a.get(t)}function wa(){this.text=this.variant=null}function Ea(e,t){this.a=e,this.b=new Set([e]);for(var n=d(t=t||[]),r=n.next();!r.done;r=n.next())this.add(r.value)}function Sa(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var r=t.audio;n=!(n.channelsCount==r.channelsCount&&Ta(n,r)&&ka(n.roles,r.roles))}return!n&&(n=e.video&&t.video)&&(n=!(Ta(n=e.video,r=t.video)&&ka(n.roles,r.roles))),!n}function Ta(e,t){if(e.mimeType!=t.mimeType)return!1;var n=e.codecs.split(",").map(function(e){return Xe(e)[0]}),r=t.codecs.split(",").map(function(e){return Xe(e)[0]});if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=0;i<n.length;i++)if(n[i]!=r[i])return!1;return!0}function ka(e,t){var n=new Set(e),r=new Set(t);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;for(var i=(n=d(n)).next();!i.done;i=n.next())if(!r.has(i.value))return!1;return!0}function Ca(e){this.a=e,this.b=new Ia(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0)}function Ia(e,t,n){this.c=e,this.b=t,this.a=n}function Aa(e,t){this.a=La,this.b=(new Map).set(La,t).set(xa,e)}wi.dd("m3u8",$i),wi.Nb("application/x-mpegurl",$i),wi.Nb("application/vnd.apple.mpegurl",$i),Ea.prototype.add=function(e){return!!Sa(this.a,e)&&(this.b.add(e),!0)},Ea.prototype.values=function(){return this.b.values()},Ca.prototype.create=function(e){var t=this,n=e.filter(function(e){return Sa(t.a,e)});return n.length?new Ea(n[0],n):this.b.create(e)},Ia.prototype.create=function(e){var t=[];t=function(e,t){var n=Pn(Rn(t),e.map(function(e){return Mn(e)}));return n?e.filter(function(e){return n==Mn(e)}):[]}(e,this.c);var n=e.filter(function(e){return e.primary});for(t=t.length?t:n.length?n:e,this.b&&((e=function(e,t){return e.filter(function(e){var n=e.audio;return e=e.video,n&&0<=n.roles.indexOf(t)||e&&0<=e.roles.indexOf(t)})}(t,this.b)).length&&(t=e)),this.a&&((e=qn(t,this.a)).length&&(t=e)),e=new Ea(t[0]),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,Sa(e.a,n)&&e.add(n);return e};var xa=0,La=1;function Na(e,t){this.f=e,this.g=Ma(e),this.b=e.a.currentTime,this.c=Date.now()/1e3,this.h=t,this.a=function(){}}function Ra(e){this.a=e}function Ma(e){if(e.a.paused||0==e.a.playbackRate||null==e.a.buffered)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var n=0;n<t.length;n++){var r=t.start(n),i=t.end(n);if(!(e<r||e>i-.5)){t=!0;break e}}t=!1}return t}function Pa(e,t,n,r,i){var a=this;this.a=e,this.v=t,this.o=n,this.l=i,this.f=new He,this.i=!1,this.m=e.readyState,this.c=!1,this.b=r,this.h=!1,this.f.w(e,"waiting",function(){return Oa(a)}),this.g=new ce(function(){Oa(a)}).La(.25)}function Oa(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;if(!e.a.paused){e.a.readyState!=e.m&&(e.c=!1,e.m=e.a.readyState);var t=e.o.smallGapLimit,n=e.a.currentTime,r=e.a.buffered;e:{if(r&&r.length&&!(1==r.length&&1e-6>r.end(0)-r.start(0)))for(var i=Je("Edge/")||Je("Trident/")||Je("Tizen")||Je("CrKey")?.5:.1,a=0;a<r.length;a++)if(r.start(a)>n&&(0==a||r.end(a-1)-n<=i)){i=a;break e}i=null}if(null==i)e.b&&(r=Ma(n=(e=e.b).f),n=n.a.currentTime,i=Date.now()/1e3,e.b==n&&e.g==r||(e.c=i,e.b=n,e.g=r),(n=i-e.c)>=e.h&&r&&e.a(e.b,n));else if(0!=i||e.h){a=r.start(i);var s=e.v.za();if(!(a>=s)){t=(s=a-n)<=t;var o=!1;.001>s||(t||e.c||(e.c=!0,(n=new Ee("largegap",{currentTime:n,gapSize:s})).cancelable=!0,e.l(n),e.o.jumpLargeGaps&&!n.defaultPrevented&&(o=!0)),!t&&!o)||(0!=i&&r.end(i-1),e.a.currentTime=a)}}}}}function Da(e){var t=this;this.c=e,this.a=new Set,this.b=new ce(function(){Ua(t,!1)}).La(.25)}function Ua(e,t){for(var n=d(e.a),r=n.next();!r.done;r=n.next())r.value.g(e.c.currentTime,t)}function Fa(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())for(var r=(n=d(n.value.variants)).next();!r.done;r=n.next())t.push(r.value);return t}function Ba(e,t){for(var n=null,r=d(e),i=r.next();!i.done;i=r.next())t>=(i=i.value).startTime&&(n=i);return n}function Va(e){this.c=e,this.a=null,this.b=function(){}}function ja(e){var t=this;this.a=e,this.f=!1,this.c=this.a.ec(),this.b=new ce(function(){t.a.Id(.25*t.c)})}function Ha(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.ec()!=t&&e.a.kd(t))}catch(e){}e.b.La(.25),0!=e.a.ec()&&e.a.kd(0)}function Ka(e,t,n){this.a=e,this.f=t,this.g=n,this.b=new He,this.c=new Ya(e),0<e.readyState?qa(this,n):Wa(this,n)}function Ga(e){return 0<e.a.readyState?e.a.currentTime:e.g}function Wa(e,t){e.g=t,e.b.da(e.a,"loadedmetadata"),e.b.ha(e.a,"loadedmetadata",function(){qa(e,t)})}function qa(e,t){.001>Math.abs(e.a.currentTime-t)?za(e):(e.b.ha(e.a,"seeking",function(){za(e)}),Xa(e.c,0==e.a.currentTime?t:e.a.currentTime))}function za(e){e.b.w(e.a,"seeking",function(){return e.f()})}function Ya(e){var t=this;this.b=e,this.h=10,this.g=this.f=this.c=0,this.a=new ce(function(){0>=t.c?t.a.stop():t.b.currentTime!=t.f?t.a.stop():(t.b.currentTime=t.g,t.c--)})}function Xa(e,t){e.f=e.b.currentTime,e.g=t,e.c=e.h,e.b.currentTime=t,e.a.La(.1)}function $a(e){function t(){n.f=!0,null!=n.b&&(n.a.currentTime=n.b)}var n=this;this.a=e,this.f=!1,this.b=null,this.c=new He,0==this.a.readyState?this.c.ha(this.a,"loadedmetadata",t):t()}function Qa(e,t,n,r,i,a){var s=this;this.b=e,this.a=t.presentationTimeline,this.C=t.minBufferTime||0,this.g=n,this.v=i,this.l=null,this.f=new Pa(e,t.presentationTimeline,n,function(e,t){if(!t.stallEnabled)return null;var n=t.stallSkip,r=new Na(new Ra(e),t.stallThreshold);return function(e,t){e.a=t}(r,function(){e.currentTime+=n}),r}(e,n),a),this.c=new Ka(e,function(){var e=s.f;e.i=!0,e.h=!1,e.c=!1;var t=Ga(s.c);return e=Ja(s,t),.001<Math.abs(e-t)&&(t=(new Date).getTime()/1e3,!s.l||s.l<t-1)?(s.l=t,0<(t=s.c).a.readyState?Xa(t.c,e):Wa(t,e),e=void 0):(s.v(),e=void 0),e},function(e,t){return null==t?t=1/0>e.a.Y()?e.a.mb():e.a.za():0>t&&(t=e.a.za()+t),Za(e,es(e,t))}(this,r)),this.i=new ce(function(){if(0!=s.b.readyState&&!s.b.paused){var e=s.b.currentTime,t=s.a.mb(),n=s.a.za();3>n-t&&(t=n-3),e<t&&(e=Ja(s,e),s.b.currentTime=e)}}).La(.25)}function Za(e,t){var n=e.a.Y();return t>=n?n-e.g.durationBackoff:t}function Ja(e,t){var n=Ft.bind(null,e.b.buffered),r=Math.max(e.C,e.g.rebufferingGoal),i=e.g.safeSeekOffset,a=e.a.mb(),s=e.a.za(),o=e.a.Y();3>s-a&&(a=s-3);var u=e.a.Gb(r),l=e.a.Gb(i);return r=e.a.Gb(r+i),t>=o?Za(e,t):t>s?s:t<a?n(l)?l:r:t>=u||n(t)?t:r}function es(e,t){var n=e.a.mb();return t<n?n:t>(n=e.a.za())?n:t}function ts(){this.b=function(){},this.a=new Set}function ns(e){var t=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{bb:null,ab:is,Ua:function(e,n){return t.a(e,n)}},{bb:rs,ab:is,Ua:function(e,n){return t.a(e,n)}},{bb:as,ab:is,Ua:function(e,n){return t.a(e,n)}},{bb:is,ab:rs,Ua:function(e,n){return t.b(e,n)}},{bb:is,ab:as,Ua:function(e,n){return t.b(e,n)}},{bb:rs,ab:as,Ua:function(e,n){return t.c(e,n)}},{bb:as,ab:rs,Ua:function(e,n){return t.c(e,n)}}]}Na.prototype.release=function(){this.f=null,this.a=function(){}},Pa.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},Pa.prototype.Yc=function(){this.h=!0,Oa(this)},Da.prototype.release=function(){this.b.stop();for(var e=d(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},Va.prototype.release=function(){this.a=this.c=null,this.b=function(){}},Va.prototype.g=function(e){var t=this.a,n=this.c.periods;t!=(e=Ba(n,e)||n[0])&&this.b(e),this.a=e},ja.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},ja.prototype.set=function(e){this.c=e,Ha(this)},Ka.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.f=function(){},this.a=null},Ya.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},$a.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.a=null},$a.prototype.m=function(e){this.b=this.f?this.b:e},$a.prototype.h=function(){return(this.f?this.a.currentTime:this.b)||0},$a.prototype.o=function(){},Qa.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.g=null,this.v=function(){}},Qa.prototype.m=function(e){var t=this.c;0<t.a.readyState?Xa(t.c,e):Wa(t,e)},Qa.prototype.h=function(){var e=Ga(this.c);return 0<this.b.readyState&&!this.b.paused?es(this,e):e},Qa.prototype.o=function(){this.f.Yc()},ts.prototype.release=function(){this.b=function(){},this.a.clear()},ns.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},ns.prototype.g=function(e,t){for(var n=d(this.h.a),r=n.next();!r.done;r=n.next()){r=r.value;var i=this.f.get(r),a=e<r.startTime?rs:e>r.endTime?as:is;this.f.set(r,a);for(var s=d(this.i),o=s.next();!o.done;o=s.next())(o=o.value).bb==i&&o.ab==a&&o.Ua(r,t)}};var rs=1,is=2,as=3;function ss(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.o=!1,this.G=null,this.D=this.f=this.m=!1,this.C=0}function os(e){return ls(e,"audio")}function us(e){return ls(e,"video")}function ls(e,t){var n=e.b.get(t);return n?n.Ia||n.stream:null}function cs(e,t){return f(function n(){var r,i,a,s,o,u,l,c,d;return P(n,function(n){switch(n.j){case 1:return r=Gt,E(n,Cn(e.a.I,r.qa),2);case 2:return e.C++,e.D=!1,i=e.C,a=e.a.I,s=new Map,o=new Set,s.set(r.qa,t),o.add(t),E(n,a.init(s,!1),3);case 3:return e.f?n.return():E(n,gs(e,o),4);case 4:if(e.f)return n.return();u=e.a.I.g.isTextVisible()||e.g.alwaysStreamText,e.C!=i||e.b.has(r.qa)||e.D||!u||(l=e.a.Sa(),c=Ts(e,l),d=vs(t,c,0),e.b.set(r.qa,d),As(e,d,0)),S(n)}})})}function ds(e,t){var n=e.b.get("video");if(n){var r=n.stream;if(r)if(t){var i=r.trickModeVideo;i&&!n.Ia&&(fs(e,i,!1,0,!1),n.Ia=r)}else(r=n.Ia)&&(n.Ia=null,fs(e,r,!0,0,!1))}}function hs(e,t,n,r){t.video&&fs(e,t.video,n,r,!1),t.audio&&fs(e,t.audio,n,r,!1)}function fs(e,t,n,r,i){var a=e.b.get(t.type);if(!a&&"text"==t.type&&e.g.ignoreTextStreamFailures)cs(e,t);else if(a){var s=ks(e,t),o=Array.from(e.b.values()).every(function(e){return e.pa==a.pa});n&&s!=a.pa&&o?e.b.forEach(function(t){ps(e,t)}):(a.Ia&&(t.trickModeVideo?(a.Ia=t,t=t.trickModeVideo):a.Ia=null),(o=e.h[s])&&o.zb&&(o=e.i.get(t.id))&&o.zb&&(a.stream!=t||i)&&("text"==t.type&&wn(e.a.I,Ye(t.mimeType,t.codecs)),a.stream=t,a.hc=!0,function(e,t,n){if(!t.Kb)return!1;var r=e.a.Sa(),i=Sn(e.a.I,t.type);if(null==(n=(n=ws(e,t,r,i,n))&&n.a?n.a-n.b:null))return!1;var a=t.stream.initSegmentReference;return a&&(n+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*n/a<i-r-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.Kb.b.a>n}(e,a,s)&&a.Kb.abort(),n&&(a.Pa?a.uc=!0:a.Ha?(a.Ma=!0,a.Zb=r,a.uc=!0):(xs(a),Is(e,a,!0,r).catch(function(t){e.a&&e.a.onError(t)})))))}}function ps(e,t){t.Pa||t.Ma||(t.Ha?(t.Ma=!0,t.Zb=0):null==En(e.a.I,t.type)?null==t.Da&&As(e,t,0):(xs(t),Is(e,t,!1,0).catch(function(t){e.a&&e.a.onError(t)})))}function ms(e,t,n,r,i){return f(function a(){var s,o,u,l,c,d,h;return P(a,function(a){switch(a.j){case 1:return s=e.a.Sa(),o=Ts(e,s),u=Gt,l=new Map,c=new Set,t&&(l.set(u.Ab,t),c.add(t)),n&&(l.set(u.Na,n),c.add(n)),r&&(l.set(u.qa,r),c.add(r)),d=e.a.I,h=e.g.forceTransmuxTS,E(a,d.init(l,h),2);case 2:return e.f?a.return():(function(e){var t=e.c.presentationTimeline.Y();1/0>t?e.a.I.wa(t):e.a.I.wa(Math.pow(2,32))}(e),E(a,gs(e,c),3));case 3:if(e.f)return a.return();l.forEach(function(t,n){if(!e.b.has(n)){var r=vs(t,o,i);e.b.set(n,r),As(e,r,0)}}),S(a)}})})}function vs(e,t,n){return{stream:e,type:e.type,pb:null,Aa:null,Ia:null,hc:!0,pa:t,endOfStream:!1,Ha:!1,Da:null,Ma:!1,Zb:0,uc:!1,Pa:!1,cd:!1,Ib:!1,Zd:n||0,Kb:null}}function ys(e,t){var n=e.h[t];if(n)return n.promise;n={promise:new pe,zb:!1},e.h[t]=n;for(var r=new Set,i=d(e.c.periods[t].variants),a=i.next();!a.done;a=i.next())(a=a.value).video&&r.add(a.video),a.video&&a.video.trickModeVideo&&r.add(a.video.trickModeVideo),a.audio&&r.add(a.audio);for(a=(i=d(e.c.periods[t].textStreams)).next();!a.done;a=i.next())r.add(a.value);return e.v=e.v.then(function(){if(!this.f)return gs(this,r)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].zb=!0)}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch(function(){}),this.h[t].promise.reject(),delete this.h[t],this.a.onError(e))}.bind(e)),n.promise}function gs(e,t){return f(function n(){var r,i,a,s,o,u,l;return P(n,function(n){switch(n.j){case 1:r=[];for(var c=d(t),h=c.next();!h.done;h=c.next())i=h.value,(a=e.i.get(i.id))?r.push(a.promise):(e.i.set(i.id,{promise:new pe,zb:!1}),r.push(i.createSegmentIndex()));return T(n,2),E(n,Promise.all(r),4);case 4:if(e.f)return n.return();C(n,3);break;case 2:if(s=I(n),e.f)return n.return();for(h=(n=d(t)).next();!h.done;h=n.next())o=h.value,e.i.get(o.id).promise.catch(function(){}),e.i.get(o.id).promise.reject(),e.i.delete(o.id);throw s;case 3:for(h=(c=d(t)).next();!h.done;h=c.next())u=h.value,(l=e.i.get(u.id)).zb||(l.promise.resolve(),l.zb=!0);S(n)}})})}function _s(e,t){if(!e.f&&!t.Ha&&null!=t.Da&&!t.Pa)if(t.Da=null,t.Ma)Is(e,t,t.uc,t.Zb);else{try{var n=function(e,t){function n(e){return"text"==e.type&&"application/cea-608"==e.stream.mimeType}if(n(t))return e.a.I.rc(t.stream.originalId||""),null;var r=e.a.Sa(),i=bs(e,t,r),a=ks(e,t.stream),s=Ts(e,i),o=function(e,t,n){return"text"==t?null==(e=e.a).b||e.b<n?0:e.b-Math.max(n,e.a):Bt(e=Tn(e,t),n)}(e.a.I,t.type,r),u=Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal,e.g.bufferingGoal)*e.l;if(i>=e.c.presentationTimeline.Y())return t.endOfStream=!0,"video"==t.type&&(i=e.b.get("text"))&&"application/cea-608"==i.stream.mimeType&&(i.endOfStream=!0),null;if(t.endOfStream=!1,t.pa=s,s!=a)return null;if(o>=u)return.5;if(s=Sn(e.a.I,t.type),!(s=ws(e,t,r,s,a)))return 1;var l=1/0;return Array.from(e.b.values()).forEach(function(t){n(t)||(t=bs(e,t,r),l=Math.min(l,t))}),i>=l+e.c.presentationTimeline.a?1:(t.Zd=0,function(e,t,n,r,i){var a=e.c.periods[r],s=t.stream,o=e.c.presentationTimeline.Y(),u=e.c.periods[r+1];r=function(e,t,n,r,i){return t.hc?(n=function(e,t,n,r,i){return"text"==t?(e.a.m=n,(e=e.a).f=r,e.h=i,Promise.resolve()):Promise.all([In(e,t,e.oe.bind(e,t)),In(e,t,e.Sf.bind(e,t,n)),In(e,t,e.Pf.bind(e,t,r,i))])}(e.a.I,t.type,e.c.periods[n].startTime-t.stream.presentationTimeOffset,r,i),t.stream.initSegmentReference?(e=Cs(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return kn(this.a.I,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch(function(e){return t.hc=!0,Promise.reject(e)}),Promise.all([n,e])):n):Promise.resolve()}(e,t,r,Math.max(0,a.startTime-.1),u?u.startTime+.01:o),t.Ha=!0,t.hc=!1,o=Cs(e,t,i),Promise.all([r,o]).then(function(e){if(!this.f&&!this.m)return function(e,t,n,r,i,a,s){var o=i.closedCaptions&&0<i.closedCaptions.size;return null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length&&(new Zr).ea("emsg",e.M.bind(e,r,a,i.emsgSchemeIdUris)).parse(s),function(e,t,n){var r=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),i=En(e.a.I,t.type);return null==i?Promise.resolve():0>=(n=n-i-r)?Promise.resolve():e.a.I.remove(t.type,i,i+n).then(function(){}.bind(e))}(e,t,n).then(function(){if(!this.f)return kn(this.a.I,t.type,s,a.startTime+r.startTime,a.endTime+r.startTime,o)}.bind(e)).then(function(){if(!this.f)return t.pb=i,t.Aa=a,Promise.resolve()}.bind(e))}(this,t,n,a,s,i,e[1])}.bind(e)).then(function(){this.f||this.m||(t.Ha=!1,t.cd=!1,t.Ma||this.a.Yc(),As(this,t,0),function(e,t){if(!e.o){var n=Array.from(e.b.values());if(1==n.length&&"text"==n[0].type||(e.o=n.every(function(e){return"text"==e.type||!e.Ma&&!e.Pa&&e.Aa})),e.o){for(n=ks(e,t),e.h[n]||ys(e,n).then(function(){this.f||this.a.Kd()}.bind(e)).catch(jt.ic),n=0;n<e.c.periods.length;++n)ys(e,n).catch(jt.ic);e.a.sf&&e.a.sf()}}}(this,s))}.bind(e)).catch(function(e){this.f||this.m||(t.Ha=!1,"text"==t.type&&this.g.ignoreTextStreamFailures?this.b.delete("text"):7001==e.code?(t.Ha=!1,t.Da=null,As(this,t,0)):3017==e.code?function(e,t,n){if(!Array.from(e.b.values()).some(function(e){return e!=t&&e.cd})){var r=Math.round(100*e.l);if(20<r)e.l-=.2;else{if(!(4<r))return t.Ib=!0,e.m=!0,void e.a.onError(n);e.l-=.04}t.cd=!0}As(e,t,4)}(this,t,e):(t.Ib=!0,e.severity=2,Ls(this,e)))}.bind(e))}(e,t,r,a,s),null)}(e,t);null!=n&&(As(e,t,n),t.Ib=!1)}catch(t){return void Ls(e,t)}n=Array.from(e.b.values()),function(e,t){var n=ks(e,t.stream);if(t.pa!=n){var r=t.pa,i=Array.from(e.b.values());i.every(function(e){return e.pa==r})&&i.every(Ss)&&ys(e,r).then(function(){if(!this.f&&i.every(function(e){var t=Ss(e),n=ks(this,e.stream);return t&&e.pa==r&&n!=r}.bind(this))){var e=this.c.periods[r],t=this.a.Ld(e),n=new Map;t.variant&&t.variant.video&&n.set("video",t.variant.video),t.variant&&t.variant.audio&&n.set("audio",t.variant.audio),t.text&&n.set("text",t.text);var a=d(this.b.keys());for(t=a.next();!t.done;t=a.next())if(t=t.value,!n.has(t)&&"text"!=t)return void this.a.onError(new fe(2,5,5005));for(a=d(Array.from(n.keys())),t=a.next();!t.done;t=a.next())if(t=t.value,!this.b.has(t)){if("text"!=t)return void this.a.onError(new fe(2,5,5005));ms(this,null,null,n.get("text"),e.startTime),n.delete(t)}for(e=d(Array.from(this.b.keys())),t=e.next();!t.done;t=e.next())t=t.value,(a=n.get(t))?(fs(this,a,!1,0,!1),As(this,this.b.get(t),0)):this.b.delete(t);this.a.Kd()}}.bind(e)).catch(jt.ic)}}(e,t),e.o&&n.every(function(e){return e.endOfStream})&&e.a.I.endOfStream().then(function(){if(!this.f){var e=this.a.I.Y();0!=e&&e<this.c.presentationTimeline.Y()&&this.c.presentationTimeline.wa(e)}}.bind(e))}}function bs(e,t,n){return t.pb&&t.Aa?(n=ks(e,t.pb),e.c.periods[n].startTime+t.Aa.endTime):Math.max(n,t.Zd)}function ws(e,t,n,r,i){if(t.Aa&&t.stream==t.pb)return Es(e,t,i,t.Aa.position+1);if(t.Aa?(n=ks(e,t.pb),n=t.stream.findSegmentPosition(Math.max(0,e.c.periods[n].startTime+t.Aa.endTime-e.c.periods[i].startTime))):n=t.stream.findSegmentPosition(Math.max(0,(r||n)-e.c.periods[i].startTime)),null==n)return null;var a=null;return null==r&&(a=Es(e,t,i,Math.max(0,n-1))),a||Es(e,t,i,n)}function Es(e,t,n,r){return n=e.c.periods[n],(t=t.stream.getSegmentReference(r))?(e=(r=e.c.presentationTimeline).Hb(),r=r.nb(),n.startTime+t.endTime<e||n.startTime+t.startTime>r?null:t):null}function Ss(e){return!e.Ha&&null==e.Da&&!e.Ma&&!e.Pa}function Ts(e,t){var n=Ba(e.c.periods,t+Wt);return n?e.c.periods.indexOf(n):0}function ks(e,t){for(var n=e.c.periods,r=0;r<n.length;r++){for(var i=n[r],a=new Set,s=d(i.variants),o=s.next();!o.done;o=s.next())(o=o.value).audio&&a.add(o.audio),o.video&&a.add(o.video),o.video&&o.video.trickModeVideo&&a.add(o.video.trickModeVideo);for(s=(i=d(i.textStreams)).next();!s.done;s=i.next())a.add(s.value);if(a.has(t))return r}return-1}function Cs(e,t,n){return n=Si(n.c(),n.b,n.a,e.g.retryParameters),e=e.a.rb.request(1,n),t.Kb=e,e.promise.then(function(e){return t.Kb=null,e.data})}function Is(e,t,n,r){return f(function i(){var a,s,o;return P(i,function(i){switch(i.j){case 1:return t.Ma=!1,t.uc=!1,t.Zb=0,t.Pa=!0,r?(s=e.a.Sa(),o=e.a.I.Y(),a=e.a.I.remove(t.type,s+r,o)):a=Cn(e.a.I,t.type).then(function(){if(!this.f&&n)return this.a.I.flush(t.type)}.bind(e)),E(i,a,2);case 2:if(e.f)return i.return();t.pb=null,t.Aa=null,t.Pa=!1,t.endOfStream=!1,As(e,t,0),S(i)}})})}function As(e,t,n){t.Da=new le(function(){return f(function n(){var r;return P(n,function(n){switch(n.j){case 1:return T(n,2),E(n,_s(e,t),4);case 4:C(n,0);break;case 2:r=I(n),e.a&&e.a.onError(r),S(n)}})})}).O(n)}function xs(e){null!=e.Da&&(e.Da.stop(),e.Da=null)}function Ls(e,t){he(e.G).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Ns(e,t,n,r,i,a){if(200<=n&&299>=n&&202!=n)return{uri:i||r,$c:r,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=it(t)}catch(e){}throw new fe(401==n||403==n?2:1,1,1001,r,n,i,e,a)}function Rs(e,t,n,r){var i=new Rs.b;qe(t.headers).forEach(function(e,t){i.append(t,e)});var a=new Rs.a,s={ud:!1,ge:!1};if(e=new me(e=Rs.l(e,n,{body:t.body||void 0,headers:i,method:t.method,signal:a.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,r),function(){return s.ud=!0,a.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var o=new ce(function(){s.ge=!0,a.abort()});o.O(t/1e3),e.finally(function(){o.stop()})}return e}function Ms(e,t,n,r){var i=new Ms.f,a=Date.now(),s=0;return new me(new Promise(function(o,u){for(var l in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new fe(1,1,7001,e,n))},i.onload=function(t){for(var r=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),i={},a=(r=d(r)).next();!a.done;a=r.next())i[(a=a.value.split(": "))[0].toLowerCase()]=a.slice(1).join(": ");try{var s=Ns(i,t.response,t.status,e,t.responseURL,n);o(s)}catch(e){u(e)}},i.onerror=function(t){u(new fe(1,1,1002,e,t,n))},i.ontimeout=function(){u(new fe(1,1,1003,e,n))},i.onprogress=function(e){var t=Date.now();(100<t-a||e.lengthComputable&&e.loaded==e.total)&&(r(t-a,e.loaded-s,e.total-e.loaded),s=e.loaded,a=t)},t.headers)i.setRequestHeader(l.toLowerCase(),t.headers[l]);i.send(t.body)}),function(){return i.abort(),Promise.resolve()})}function Ps(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Os(e,t){this.g=e,this.b=new Map,this.c=!1,this.f=t,this.a=new Ps}function Ds(e,t,n,r,i){var a=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(e.a,r);r=e.b.get(t)||Promise.resolve(),e.b.set(t,r.then(function(){return f(function t(){var r;return P(t,function(t){switch(t.j){case 1:return E(t,function(e,t){return f(function n(){var r,i;return P(n,function(n){switch(n.j){case 1:return r=e.g.request(1,t),E(n,r.promise,2);case 2:return i=n.s,n.return(i.data)}})})}(e,n),2);case 2:if(r=t.s,e.c)throw new fe(2,9,7001);e.a.close(a,r.byteLength);var s=e.a;return e.f(0==s.b?0:s.f/s.b,e.a.a),t.return(i(r))}})})}))}function Us(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new pe,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function Fs(e,t){return new Promise(function(n,r){var i=e.b.openCursor();i.onerror=r,i.onsuccess=function(e){if(!(e=e.target.result))return n();t(e.key,e.value,e),e.continue()}})}function Bs(e){this.b=e,this.a=[]}function Vs(e,t){return Hs(e,t,"readonly")}function js(e,t){return Hs(e,t,"readwrite")}function Hs(e,t,n){var r=new Us(n=e.b.transaction([t],n),t);return e.a.push(r),r.promise().then(function(){Ie(e.a,r)},function(){Ie(e.a,r)}),r}function Ks(e){this.a=new Bs(e)}function Gs(){this.a=new Map}function Ws(e,t,n){if(!(e=e.a.get(t)))throw new fe(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new fe(2,9,9013,"Could not find cell with name "+n);return t}function qs(e,t){zs.set(e,t)}ss.prototype.destroy=function(){for(var e=d(this.b.values()),t=e.next();!t.done;t=e.next())xs(t.value);return this.b.clear(),this.i.clear(),this.g=this.h=this.v=this.c=this.a=null,this.f=!0,Promise.resolve()},ss.prototype.configure=function(e){this.g=e,this.G=new de({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},ss.prototype.start=function(){var e=this;return f(function t(){var n,r,i;return P(t,function(t){switch(t.j){case 1:return n=e.a.Sa(),r=Ts(e,n),(i=e.a.Ld(e.c.periods[r])).variant||i.text?E(t,ms(e,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,n),2):t.return(new fe(2,5,5005));case 2:if(e.f)return t.return();e.a&&e.a.gf&&e.a.gf(),S(t)}})})},ss.prototype.M=function(e,t,n,r){var i=r.reader.ad(),a=r.reader.ad(),s=r.reader.F(),o=r.reader.F(),u=r.reader.F(),l=r.reader.F();r=r.reader.Xa(r.reader.K.byteLength-r.reader.ba()),e=e.startTime+t.startTime+o/s,n.includes(i)&&("urn:mpeg:dash:event:2012"==i?this.a.hf():this.a.onEvent(new Ee("emsg",{detail:{startTime:e,endTime:e+u/s,schemeIdUri:i,value:a,timescale:s,presentationTimeDelta:o,eventDuration:u,id:l,messageData:r}})))},V("shaka.net.HttpFetchPlugin",Rs),Rs.l=function(e,t,n,r,i){return f(function a(){var s,o,u,l,c,d,h,p,m,v,y,g;return P(a,function(a){switch(a.j){case 1:return s=Rs.g,o=Rs.c,d=c=0,h=Date.now(),T(a,2),E(a,s(e,n),4);case 4:return u=a.s,p=u.clone().body.getReader(),v=(m=u.headers.get("Content-Length"))?parseInt(m,10):0,new o({start:function(e){!function t(){return f(function n(){var r,a;return P(n,function(n){switch(n.j){case 1:return T(n,2),E(n,p.read(),4);case 4:r=n.s,C(n,3);break;case 2:return I(n),n.return();case 3:r.done||(c+=r.value.byteLength),(100<(a=Date.now())-h||r.done)&&(i(a-h,c-d,v-c),d=c,h=a),r.done?e.close():(e.enqueue(r.value),t()),S(n)}})})}()}}),E(a,u.arrayBuffer(),5);case 5:l=a.s,C(a,3);break;case 2:if(y=I(a),r.ud)throw new fe(1,1,7001,e,t);if(r.ge)throw new fe(1,1,1003,e,t);throw new fe(1,1,1002,e,y,t);case 3:return g={},u.headers.forEach(function(e,t){g[t.trim()]=e}),a.return(Ns(g,l,u.status,e,u.url,t))}})})},Rs.isSupported=function(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)},Rs.isSupported=Rs.isSupported,Rs.g=e.fetch,Rs.a=e.AbortController,Rs.c=e.ReadableStream,Rs.b=e.Headers,Rs.isSupported()&&(Pe("http",Rs,2),Pe("https",Rs,2)),V("shaka.net.HttpXHRPlugin",Ms),Ms.f=e.XMLHttpRequest,Pe("http",Ms,1),Pe("https",Ms,1),Ps.prototype.close=function(e,t){if(this.c.has(e)){var n=this.c.get(e);this.c.delete(e),this.f+=n,this.a+=t}},Os.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},Us.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch(function(){})},Us.prototype.store=function(){return this.b},Us.prototype.promise=function(){return this.a},Bs.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},Ks.prototype.destroy=function(){return this.a.destroy()},Ks.prototype.getAll=function(){var e=this;return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return n=Vs(e.a,"session-ids"),r=[],E(t,Fs(n,function(e,t){r.push(t)}),2);case 2:return E(t,n.promise(),3);case 3:return t.return(r)}})})},Ks.prototype.add=function(e){for(var t=js(this.a,"session-ids"),n=t.store(),r=(e=d(e)).next();!r.done;r=e.next())n.add(r.value);return t.promise()},Ks.prototype.remove=function(e){var t=this;return f(function n(){var r;return P(n,function(n){switch(n.j){case 1:return E(n,Fs(r=js(t.a,"session-ids"),function(t,n,r){0<=e.indexOf(n.sessionId)&&r.delete()}),2);case 2:return E(n,r.promise(),0)}})})},Gs.prototype.destroy=function(){for(var e=[],t=d(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},Gs.prototype.init=function(){var e=this;zs.forEach(function(t,n){var r=t();r&&e.a.set(n,r)});for(var t=[],n=d(this.a.values()),r=n.next();!r.done;r=n.next())t.push(r.value.init());return Promise.all(t)},Gs.prototype.erase=function(){var e=this;return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return n=Array.from(e.a.values()),(r=0<n.length)||zs.forEach(function(e){(e=e())&&n.push(e)}),E(t,Promise.all(n.map(function(e){return e.erase()})),2);case 2:if(!r)return E(t,Promise.all(n.map(function(e){return e.destroy()})),0);t.A(0)}})})},V("shaka.offline.StorageMuxer.register",qs),V("shaka.offline.StorageMuxer.unregister",function(e){zs.delete(e)});var zs=new Map;function Ys(e){this.a=new Bs(e)}function Xs(e){return Promise.reject(new fe(2,9,9011,"Cannot add new value to "+e))}function $s(e,t,n,r){var i=(e=js(e.a,t)).store();return n.forEach(function(e){i.delete(e).onsuccess=function(){return r(e)}}),e.promise()}function Qs(e,t,n){var r=(e=Vs(e.a,t)).store(),i={},a=[];return n.forEach(function(e){r.get(e).onsuccess=function(t){null==(t=t.target.result)&&a.push(e),i[e]=t}}),e.promise().then(function(){return a.length?Promise.reject(new fe(2,9,9012,"Could not find values for "+a)):n.map(function(e){return i[e]})})}function Zs(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(Js),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}}function Js(e){return function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),n=e.streams.filter(function(e){return"video"==e.contentType});if(!t.every(function(e){return e.variantIds})||!n.every(function(e){return e.variantIds})){t.forEach(function(e){e.variantIds=[]}),n.forEach(function(e){e.variantIds=[]});var r=0;if(n.length&&!t.length){var i=r++;n.forEach(function(e){e.variantIds.push(i)})}if(!n.length&&t.length){var a=r++;t.forEach(function(e){e.variantIds.push(a)})}n.length&&t.length&&t.forEach(function(e){n.forEach(function(t){var n=r++;e.variantIds.push(n),t.variantIds.push(n)})})}}(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(eo)}}function eo(e){var t=e.$e?ro(e.$e):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(to),variantIds:e.variantIds}}function to(e){var t=ro(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function no(e){return{data:e.data}}function ro(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new fe(2,9,9004,"Could not parse uri "+e)}function io(e,t,n,r){this.a=new Bs(e),this.c=t,this.b=n,this.f=r}function ao(e,t,n){if(e.f)return Promise.reject(new fe(1,9,9011,"Cannot add new value to "+t));var r=(e=js(e.a,t)).store(),i=[];return n.forEach(function(e){r.add(e).onsuccess=function(e){i.push(e.target.result)}}),e.promise().then(function(){return i})}function so(e,t,n,r){var i=(e=js(e.a,t)).store();return n.forEach(function(e){i.delete(e).onsuccess=function(){return r(e)}}),e.promise()}function oo(e,t,n){var r=(e=Vs(e.a,t)).store(),i={},a=[];return n.forEach(function(e){var t=r.get(e);t.onsuccess=function(){null==t.result&&a.push(e),i[e]=t.result}}),e.promise().then(function(){return a.length?Promise.reject(new fe(1,9,9012,"Could not find values for "+a)):n.map(function(e){return i[e]})})}function uo(){this.g=this.c=this.b=this.a=this.f=null}function lo(e,t,n,r){this.a=e,this.g=t,this.f=n,this.c=r,this.b=["offline:",e,"/",t,"/",n,"/",r].join("")}function co(e){if(null==(e=/^offline:([a-z]+)\/([^\/]+)\/([^\/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var r=e[3];return r&&null!=t?new lo(t,n,r,Number(e[4])):null}function ho(e,t){this.b=e,this.a=t}function fo(e,t,n){var r=t.streams.filter(function(e){return"audio"==e.contentType}),i=t.streams.filter(function(e){return"video"==e.contentType});return r=function(e,t,n){for(var r=new Set,i=d(t),a=i.next();!a.done;a=i.next()){var s=d(a.value.variantIds);for(a=s.next();!a.done;a=s.next())r.add(a.value)}for(i=d(n),a=i.next();!a.done;a=i.next())for(s=d(a.value.variantIds),a=s.next();!a.done;a=s.next())r.add(a.value);for(i=new Map,r=d(r),a=r.next();!a.done;a=r.next())a=a.value,i.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=d(t),r=t.next();!r.done;r=t.next())for(r=r.value,a=po(e,r),s=d(r.variantIds),r=s.next();!r.done;r=s.next())(r=i.get(r.value)).language=a.language,r.primary=r.primary||a.primary,r.audio=a;for(n=d(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=po(e,r),a=d(r.variantIds),r=a.next();!r.done;r=a.next())(r=i.get(r.value)).primary=r.primary||t.primary,r.video=t;return i}(e,r,i),i=t.streams.filter(function(e){return"text"==e.contentType}).map(function(t){return po(e,t)}),t.streams.forEach(function(r){r=r.segments.map(function(t,n){return mo(e,n,t)}),n.sb(r,t.startTime)}),{startTime:t.startTime,variants:Array.from(r.values()),textStreams:i}}function po(e,t){var n=t.segments.map(function(t,n){return mo(e,n,t)}),r=new ai(n);return n={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return r.find(e)},getSegmentReference:function(e){return r.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},null!=t.initSegmentKey&&(n.initSegmentReference=function(e,t){var n=new lo("segment",e.b,e.a,t);return new qr(function(){return[n.toString()]},0,null)}(e,t.initSegmentKey)),n}function mo(e,t,n){var r=new lo("segment",e.b,e.a,n.dataKey);return new zr(t,n.startTime,n.endTime,function(){return[r.toString()]},0,null)}function vo(){this.a=null}function yo(e){var t=co(e);return t&&"manifest"==t.a?yo.h(e):t&&"segment"==t.a?yo.i(t.key(),t):ve(new fe(2,1,9004,e))}function go(e,t,n){return f(function r(){var i,a,s,o,u,l;return P(r,function(r){switch(r.j){case 1:i=[];for(var c=[],h=d(n),p=h.next();!p.done;p=h.next()){p=p.value;for(var m=!1,v=d(c),y=v.next();!y.done;y=v.next())if(_o((y=y.value).info,p)){y.sessionIds.push(p.sessionId),m=!0;break}m||c.push({info:p,sessionIds:[p.sessionId]})}a=d(c),s=a.next();case 2:if(s.done){r.A(4);break}return o=s.value,u=function(e,t,n){return f(function r(){var i,a;return P(r,function(r){switch(r.j){case 1:return i=new mt({rb:t,onError:function(){},kc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),T(r,2),i.configure(e),E(r,function(e,t,n,r,i,a){var s=new Map;return s.set(t,{audioCapabilities:i,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),St(e,s)}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:C(r,3);break;case 2:return I(r),E(r,i.destroy(),5);case 5:return r.return([]);case 3:return T(r,6),E(r,gt(i),8);case 8:C(r,7);break;case 6:return I(r),E(r,i.destroy(),9);case 9:return r.return([]);case 7:return a=[],E(r,Promise.all(n.sessionIds.map(function(e){return f(function t(){return P(t,function(t){switch(t.j){case 1:return T(t,2),E(t,function(e,t){return f(function n(){var r,i,a;return P(n,function(n){switch(n.j){case 1:return E(n,Tt(e,t),2);case 2:return(r=n.s)?(i=[],(a=e.b.get(r))&&(a.xa=new pe,i.push(a.xa)),i.push(r.remove()),E(n,Promise.all(i),0)):n.return()}})})}(i,e),4);case 4:a.push(e),C(t,0);break;case 2:I(t),S(t)}})})})),10);case 10:return E(r,i.destroy(),11);case 11:return r.return(a)}})})}(e,t,o),E(r,u,5);case 5:l=r.s,i=i.concat(l),s=a.next(),r.A(2);break;case 4:return r.return(i)}})})}function _o(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Ae(e.audioCapabilities,t.audioCapabilities,n)&&Ae(e.videoCapabilities,t.videoCapabilities,n)}function bo(e,t){var n={ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null},r=this;this.g=t,this.c=e,this.i=n,this.h=null,this.f=[],this.b=this.a=null,this.l=!0,this.m=Promise.resolve().then(function(){return e=r,f(function t(){return P(t,function(t){switch(t.j){case 1:if(e.l){if(0==e.f.length||e.a&&!e.a.Ta)var n=!1;else{e.a&&(e.a.ta.Wa(),e.a=null);var r=(n=e.f.shift()).create(e.i);r?(n.ta.tb(),e.a={node:r.node,payload:r.payload,Ta:r.Ta,ta:n.ta}):n.ta.lc(),n=!0}return n?n=Promise.resolve():e.a?n=function(e){return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return e.c=e.g.Pe(e.c,e.i,e.a.node,e.a.payload),T(t,2),e.b=e.g.ze(e.c,e.i,e.a.payload),E(t,e.b.promise,4);case 4:e.b=null,e.c==e.a.node&&(e.a.ta.jc(),e.a=null),C(t,0);break;case 2:return 7001==(n=I(t)).code?e.a.ta.Wa():e.a.ta.onError(n),e.a=null,e.b=null,r=e,E(t,e.g.handleError(e.i,n),5);case 5:r.c=t.s,S(t)}})})}(e):(e.g.ff(e.c),e.h=new pe,n=e.h),E(t,n,1)}t.A(0)}})});var e})}function wo(e,t){var n={tb:function(){},jc:function(){},Wa:function(){},onError:function(){},lc:function(){},sg:function(){}};return e.f.push({create:t,ta:n}),e.b&&e.b.abort(),Eo(e),n}function Eo(e){e.h&&(e.h.resolve(),e.h=null)}function So(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function To(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,t.size=e.size;try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function ko(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var r=e.cues,i=r.length-1;0<=i;i--){var a=r[i];a&&t(a)&&e.removeCue(a)}e.mode=n}function Co(e,t,n,r,i){var a,s=i in r,o=!0;for(a in t){var u=i+"."+a,l=s?r[i]:n[a];s||a in n?void 0===t[a]?void 0===l||s?delete e[a]:e[a]=ke(l):l.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=ke(l)),u=Co(e[a],t[a],l,r,u),o=o&&u):typeof t[a]!=typeof l||null==t[a]||t[a].constructor!=l.constructor?o=!1:e[a]=t[a]:o=!1}return o}function Io(e,t){for(var n={},r=n,i=0,a=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(r[a=e.substring(a,i).replace(/\\\./g,".")]={},r=r[a],a=i+1),i+=1;return r[e.substring(a).replace(/\\\./g,".")]=t,n}function Ao(){}function xo(){var e=5e5,t=1/0;navigator.connection&&(e=1e6*navigator.connection.downlink,navigator.connection.saveData&&(t=360));var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0}},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(){},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1};Je("Web0S")&&(i.stallEnabled=!1);var a={trackSelectionCallback:function(e){return e},progressCallback:function(){},usePersistentLicense:!0},s={drm:n,manifest:r,streaming:i,offline:a,abrFactory:$n,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(e){return function(e,t){var n=e.filter(function(e){return"variant"==e.type}),r=[],i=Pn(t,n.map(function(e){return e.language}));i&&(r=n.filter(function(e){return Rn(e.language)==i})),0==r.length&&(r=n.filter(function(e){return e.primary})),0==r.length&&(n.map(function(e){return e.language}),r=n);var a=r.filter(function(e){return e.height&&480>=e.height});if(a.length&&(a.sort(function(e,t){return t.height-e.height}),r=a.filter(function(e){return e.height==a[0].height})),n=[],r.length){var s=Math.floor(r.length/2);r.sort(function(e,t){return e.bandwidth-t.bandwidth}),n.push(r[s])}for(r=d(e),s=r.next();!s.done;s=r.next())"text"==(s=s.value).type&&n.push(s);return n}(e,s.preferredAudioLanguage)},s}function Lo(e,t,n){var r={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Co(e,t,n||xo(),r,"")}function No(){this.a=null,this.b=[]}function Ro(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0})}}function Mo(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var r=d(e.b),i=r.next();!i.done;i=r.next())n+=(i=i.value).state==t?i.duration:0;return n}function Po(){this.b=this.c=null,this.a=[]}function Oo(){this.f=this.l=this.b=this.h=this.i=this.g=this.m=NaN,this.a=new No,this.c=new Po}function Do(t,n){var r=this;Te.call(this),this.h=_u,this.a=null,this.eb=!1,this.i=new He,this.vc=this.l=this.Bb=this.c=this.m=this.f=this.Sb=this.P=this.Tb=this.W=this.gb=this.o=this.D=this.g=this.G=null,this.Hd=1e9,this.Wb=new Set,this.ib=!0,this.Ea=null,this.Dd=!1,this.Bd=0,this.na=null,this.$=new ga,this.b=Wo(this),this.Xb={width:1/0,height:1/0},this.v=null,this.Ub=new Ia(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.ma=this.b.preferredTextLanguage,this.cb=this.b.preferredTextRole,n&&n(this),this.G=function(e){return new Ne(function(t,n){e.l&&e.l.segmentDownloaded(t,n)})}(this),this.i.w(e,"online",function(){r.fd()}),this.C={name:"detach"},this.M={name:"attach"},this.Fa={name:"unload"},this.Ec={name:"manifest-parser"},this.Cc={name:"manifest"},this.fb={name:"media-source"},this.wc={name:"drm-engine"},this.T={name:"load"},this.Hc={name:"src-equals-drm-engine"},this.hb={name:"src-equals"};var i=new Map;i.set(this.M,function(e,t){return _e(function(e,t,n){return null==t.u&&(t.u=n.u,e.i.w(t.u,"error",function(){var t=su(e);t&&e.Ka(t)})),e.a=t.u,Promise.resolve()}(r,e,t))}),i.set(this.C,function(e){return e.u&&(r.i.da(e.u,"error"),e.u=null),r.a=null,_e(e=Promise.resolve())}),i.set(this.Fa,function(e){return _e(Vo(r,e))}),i.set(this.fb,function(t){return _e(t=function(t,n){return f(function r(){var i,a,s,o;return P(r,function(r){switch(r.j){case 1:return i=e.muxjs?new Ot:new Dt,a=t.b.textDisplayFactory,s=new a,t.xc=a,o=new gn(n.u,i,s),E(r,o.o,2);case 2:t.D=o,S(r)}})})}(r,t))}),i.set(this.Ec,function(e,t){return _e(function(e,t,n){return f(function r(){var i,a,s;return P(r,function(r){switch(r.j){case 1:if(t.ya=n.ya,t.mimeType=n.mimeType,t.uri=n.uri,i=t.uri,a=e.G,e.Bb=i,t.ya){e.m=t.ya(),r.A(2);break}return s=e,E(r,wi.create(i,a,e.b.manifest.retryParameters,t.mimeType),3);case 3:s.m=r.s;case 2:e.m.configure(e.b.manifest),S(r)}})})}(r,e,t))}),i.set(this.Cc,function(e){return function(e,t){var n=t.uri,r=e.G;e.Sb=new ts,function(e,t){e.b=t}(e.Sb,function(t){au(e,"timelineregionadded",t)});var i={networkingEngine:r,filterNewPeriod:function(t){return e.Fc(t)},filterAllPeriods:function(t){return qo(e,t)},onTimelineRegionAdded:function(t){var n=e.Sb;e:{for(var r=d(n.a),i=r.next();!i.done;i=r.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.startTime==t.startTime&&i.endTime==t.endTime){r=i;break e}r=null}null==r&&(n.a.add(t),n.b(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Ka(t)}};return new me(Promise.resolve().then(function(){return f(function t(){var r;return P(t,function(t){switch(t.j){case 1:return r=e,E(t,e.m.start(n,i),2);case 2:if(r.c=t.s,e.dispatchEvent(new Ee("manifestparsed")),0==e.c.periods.length)throw new fe(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some(function(e){return e.variants.some(t)})&&e.forEach(function(e){e.variants=e.variants.filter(t)})}(e.c.periods),S(t)}})})}),function(){return e.m.stop()})}(r,e)}),i.set(this.wc,function(){return _e(function(e){return f(function t(){return P(t,function(t){switch(t.j){case 1:return e.g=new mt({rb:e.G,onError:function(t){e.Ka(t)},kc:function(t){ou(e,t)},onExpirationUpdated:function(t,n){uu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.g.configure(e.b.drm),E(t,vt(e.g,Fa(e.c.periods),e.c.offlineSessionIds),2);case 2:qo(e,e.c.periods),S(t)}})})}(r))}),i.set(this.T,function(e,t){return _e(function(e,t,n){return f(function r(){var i,a,s,o,u,l,c,h,f;return P(r,function(r){switch(r.j){case 1:return t.startTime=n.startTime,i=t.u,a=t.uri,e.Bb=a,e.v=new Oo,s=function(){return $o(e)},o=function(){var t=e.a.playbackRate;0!=t&&e.W.set(t)},e.i.w(i,"playing",s),e.i.w(i,"pause",s),e.i.w(i,"ended",s),e.i.w(i,"ratechange",o),u=e.b.abrFactory,e.l&&e.vc==u||(e.vc=u,e.l=new u,e.l.configure(e.b.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var r=t[n],i=new Map,a=d(r.variants),s=a.next();!s.done;s=a.next())if((s=s.value).video&&s.video.closedCaptions)for(var o=d((s=s.video).closedCaptions.keys()),u=o.next();!u.done;u=o.next())if(u=u.value,!i.has(u)){var l={id:e.Hd++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:s.closedCaptions.get(u),label:null,type:"text",primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,channelsCount:null,closedCaptions:null};i.set(u,l)}for(i=d(i.values()),a=i.next();!a.done;a=i.next())r.textStreams.push(a.value)}}(e,e.c.periods),e.Ub=new Ia(e.b.preferredAudioLanguage,e.b.preferredVariantRole,e.b.preferredAudioChannelCount),e.ma=e.b.preferredTextLanguage,function(e,t,n){0<t&&(e.V()||e.de(t)),n<e.Y()&&(e.V()||e.wa(n))}(e.c.presentationTimeline,e.b.playRangeStart,e.b.playRangeEnd),E(r,e.g.Cb(i),2);case 2:return e.l.init(function(t,n,r){n=void 0!==n&&n,r=void 0===r?0:r;e:{for(var i=d(e.c.periods),a=i.next();!a.done;a=i.next())if((a=a.value).variants.includes(t)){i=a;break e}i=null}Ko(e,i,t,!0),e.f&&(hs(e.f,t,n,r),Jo(e))}),e.o=function(e,t){return new Qa(e.a,e.c,e.b.streaming,t,function(){e.gb&&Ua(e.gb,!0),e.f&&function(e){function t(t){var i=e.a.I;return t="text"==t?null!=(t=i.a).a&&null!=t.b&&n>=t.a&&n<t.b:Ft(t=Tn(i,t),n,r)}var n=e.a.Sa(),r=e.g.smallGapLimit,i=Ts(e,n);if(We(e.b.values(),function(e){return e.pa==i}))for(var a=d(e.b.keys()),s=a.next();!s.done;s=a.next())t(s=s.value)||ps(e,e.b.get(s));else We(e.b.keys(),t)||e.b.forEach(function(t){ps(e,t)})}(e.f)},function(t){return e.dispatchEvent(t)})}(e,t.startTime),e.gb=function(e){var t=new Va(e.c);!function(e,t){e.b=t}(t,function(){eu(e)});var n=new ns(e.Sb);!function(e,t,n,r){e.a=t,e.b=n,e.c=r}(n,function(t){au(e,"timelineregionenter",t)},function(t){au(e,"timelineregionexit",t)},function(t,n){n||(au(e,"timelineregionenter",t),au(e,"timelineregionexit",t))});var r=new Da(e.a);return r.a.add(t),r.a.add(n),r}(e),e.W=new ja({ec:function(){return t.u.playbackRate},kd:function(e){t.u.playbackRate=e},Id:function(e){t.u.currentTime+=e}}),l=Math.max(e.c.minBufferTime,e.b.streaming.rebufferingGoal),jo(e,l),e.f=function(e){return new ss(e.c,{Sa:function(){return e.o.h()},getBandwidthEstimate:function(){return e.l.getBandwidthEstimate()},I:e.D,rb:e.G,Ld:e.df.bind(e),Kd:e.te.bind(e),onError:e.Ka.bind(e),onEvent:function(t){return e.dispatchEvent(t)},hf:e.jf.bind(e),Yc:e.qf.bind(e)})}(e),e.f.configure(e.b.streaming),function(e){function t(e){var t="";e.video&&(t=Xe(e.video.codecs)[0]);var n="";return e.audio&&(n=Xe(e.audio.codecs)[0]),t+"-"+n}var n=e.c.periods.reduce(function(e,t){return e.concat(t.variants)},[]);n=qn(n,e.b.preferredAudioChannelCount);var r=new Se;n.forEach(function(e){var n=t(e);r.push(n,e)});var i=null,a=1/0;r.forEach(function(e,t){var n=0,r=0;t.forEach(function(e){n+=e.bandwidth||0,++r});var s=n/r;s<a&&(i=e,a=s)}),e.c.periods.forEach(function(e){e.variants=e.variants.filter(function(e){return t(e)==i})})}(e),e.h=bu,e.dispatchEvent(new Ee("streaming")),E(r,e.f.start(),3);case 3:e.b.streaming.startAtSegmentBoundary&&(c=e.o.h(),h=function(e,t){function n(e,t){if(!e)return null;var n=e.findSegmentPosition(t-a.startTime);return null==n?null:(n=e.getSegmentReference(n))?n.startTime+a.startTime:null}var r=os(e.f),i=us(e.f),a=fu(e);return r=n(r,t),null!=(i=n(i,t))&&null!=r?Math.max(i,r):null!=i?i:null!=r?r:t}(e,c),e.o.m(h)),e.c.periods.forEach(e.Fc.bind(e)),eu(e),Jo(e),(f=fu(e)).variants.some(function(e){return e.primary}),Qo(e,f.variants),e.i.ha(i,"loadeddata",function(){e.v.b=Date.now()/1e3-n.nd}),S(r)}})})}(r,e,t))}),i.set(this.Hc,function(e){return _e(e=function(e,t){return f(function n(){var r,i;return P(n,function(n){switch(n.j){case 1:return r=Gt,e.g=new mt({rb:e.G,onError:function(t){e.Ka(t)},kc:function(t){ou(e,t)},onExpirationUpdated:function(t,n){uu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.g.configure(e.b.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:r.Na,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},E(n,vt(e.g,[i],[]),2);case 2:return E(n,e.g.Cb(t.u),0)}})})}(r,e))}),i.set(this.hb,function(e,t){return function(e,t,n){function r(){return $o(e)}if(t.uri=n.uri,t.startTime=n.startTime,e.Bb=t.uri,e.v=new Oo,e.o=new $a(t.u),null!=t.startTime&&e.o.m(t.startTime),e.W=new ja({ec:function(){return t.u.playbackRate},kd:function(e){t.u.playbackRate=e},Id:function(e){t.u.currentTime+=e}}),jo(e,e.b.streaming.rebufferingGoal),e.i.w(t.u,"playing",r),e.i.w(t.u,"pause",r),e.i.w(t.u,"ended",r),e.i.ha(t.u,"loadeddata",function(){e.v.b=Date.now()/1e3-n.nd}),e.a.audioTracks&&(e.i.w(e.a.audioTracks,"addtrack",function(){return eu(e)}),e.i.w(e.a.audioTracks,"removetrack",function(){return eu(e)})),e.a.textTracks){var i=e.a.textTracks;e.i.w(i,"addtrack",function(){return eu(e)}),e.i.w(i,"removetrack",function(){return eu(e)})}t.u.src=t.uri,e.h=wu,e.dispatchEvent(new Ee("streaming"));var a=new pe;return e.a.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?a.resolve():e.a.error?a.reject(su(e)):(e.i.ha(e.a,"loadeddata",function(){a.resolve()}),e.i.ha(e.a,"error",function(){a.reject(su(e))})),new me(a,function(){return a.reject(new fe(2,7,7001)),Promise.resolve()})}(r,e,t)}),this.jb=new bo(this.C,{Pe:function(e,t,n,i){var a=null;return e==r.C&&(a=n==r.C?r.C:r.M),e==r.M&&(a=n==r.C||t.u!=i.u?r.C:n==r.M?r.M:n==r.fb||n==r.T?r.fb:n==r.hb?r.Hc:null),e==r.fb&&(a=n==r.T&&t.u==i.u?r.Ec:r.Fa),e==r.Ec&&(a=vu(r.T,r.Cc,r.Fa,n,t,i)),e==r.Cc&&(a=vu(r.T,r.wc,r.Fa,n,t,i)),e==r.wc&&(a=vu(r.T,r.T,r.Fa,n,t,i)),e==r.Hc&&(a=n==r.hb&&t.u==i.u?r.hb:r.Fa),e!=r.T&&e!=r.hb||(a=r.Fa),e==r.Fa&&(a=i.u&&t.u==i.u?r.M:r.C),a},ze:function(e,t,n){return r.dispatchEvent(new Ee("onstatechange",{state:e.name})),i.get(e)(t,n)},handleError:function(e){return f(function t(){return P(t,function(t){switch(t.j){case 1:return E(t,Vo(r,e),2);case 2:return t.return(e.u?r.M:r.C)}})})},ff:function(e){r.dispatchEvent(new Ee("onstateidle",{state:e.name}))}}),t&&this.Cb(t,!0)}(n=Ys.prototype).destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return!0},n.addSegments=function(){return Xs("segment")},n.removeSegments=function(e,t){return $s(this,"segment",e,t)},n.getSegments=function(e){return Qs(this,"segment",e).then(function(e){return e.map(no)})},n.addManifests=function(){return Xs("manifest")},n.updateManifestExpiration=function(e,t){var n=js(this.a,"manifest"),r=n.store(),i=new pe;return r.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,r.put(n),i.resolve()):i.reject(new fe(2,9,9012,"Could not find values for "+e))},n.promise().then(function(){return i})},n.removeManifests=function(e,t){return $s(this,"manifest",e,t)},n.getManifests=function(e){return Qs(this,"manifest",e).then(function(e){return e.map(Zs)})},n.getAllManifests=function(){var e=this;return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return n=Vs(e.a,"manifest"),r=new Map,E(t,Fs(n,function(e,t){r.set(e,Zs(t))}),2);case 2:return E(t,n.promise(),3);case 3:return t.return(r)}})})},(n=io.prototype).destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return this.f},n.addSegments=function(e){return ao(this,this.c,e)},n.removeSegments=function(e,t){return so(this,this.c,e,t)},n.getSegments=function(e){return oo(this,this.c,e)},n.addManifests=function(e){return ao(this,this.b,e)},n.updateManifestExpiration=function(e,t){var n=js(this.a,this.b),r=n.store();return r.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,r.put(n,e))},n.promise()},n.removeManifests=function(e,t){return so(this,this.b,e,t)},n.getManifests=function(e){return oo(this,this.b,e)},n.getAllManifests=function(){var e=this;return f(function t(){var n,r;return P(t,function(t){switch(t.j){case 1:return n=Vs(e.a,e.b),r=new Map,E(t,Fs(n,function(e,t){r.set(e,t)}),2);case 2:return E(t,n.promise(),3);case 3:return t.return(r)}})})},(n=uo.prototype).init=function(){var t=this,n=new pe,r=e.indexedDB.open("shaka_offline_db",4);return r.onsuccess=function(e){e=e.target.result,t.f=e;var r=e.objectStoreNames;r=r.contains("manifest")&&r.contains("segment")?new Ys(e):null,t.a=r,r=(r=e.objectStoreNames).contains("manifest-v2")&&r.contains("segment-v2")?new io(e,"segment-v2","manifest-v2",!0):null,t.b=r,r=(r=e.objectStoreNames).contains("manifest-v3")&&r.contains("segment-v3")?new io(e,"segment-v3","manifest-v3",!1):null,t.c=r,e=e.objectStoreNames.contains("session-ids")?new Ks(e):null,t.g=e,n.resolve()},r.onupgradeneeded=function(e){e=e.target.result;for(var t=d(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},r.onerror=function(e){n.reject(new fe(2,9,9001,r.error)),e.preventDefault()},n},n.destroy=function(){var e=this;return f(function t(){return P(t,function(t){switch(t.j){case 1:if(!e.a){t.A(2);break}return E(t,e.a.destroy(),2);case 2:if(!e.b){t.A(4);break}return E(t,e.b.destroy(),4);case 4:if(!e.c){t.A(6);break}return E(t,e.c.destroy(),6);case 6:if(!e.g){t.A(8);break}return E(t,e.g.destroy(),8);case 8:e.f&&e.f.close(),S(t)}})})},n.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},n.getEmeSessionCell=function(){return this.g},n.erase=function(){var t=this;return f(function n(){return P(n,function(n){switch(n.j){case 1:if(!t.a){n.A(2);break}return E(n,t.a.destroy(),2);case 2:if(!t.b){n.A(4);break}return E(n,t.b.destroy(),4);case 4:if(!t.c){n.A(6);break}return E(n,t.c.destroy(),6);case 6:return t.f&&t.f.close(),E(n,function(){var t=new pe,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new fe(2,9,9001,n.error)),e.preventDefault()},t}(),8);case 8:return t.f=null,t.a=null,t.b=null,t.c=null,E(n,t.init(),0)}})})},qs("idb",function(){return e.indexedDB?new uo:null}),lo.prototype.ua=function(){return this.g},lo.prototype.aa=function(){return this.f},lo.prototype.key=function(){return this.c},lo.prototype.toString=function(){return this.b},(n=vo.prototype).configure=function(){},n.start=function(e){var t=this;return f(function n(){var r,i,a,s,o;return P(n,function(n){switch(n.j){case 1:return r=co(e),t.a=r,null==r||"manifest"!=r.a?n.return(Promise.reject(new fe(2,1,9004,r))):(i=new Gs,k(n,2),E(n,i.init(),4));case 4:return E(n,Ws(i,r.ua(),r.aa()),5);case 5:return E(n,n.s.getManifests([r.key()]),6);case 6:return a=n.s,s=a[0],o=new ho(r.ua(),r.aa()),n.return(function(e,t){var n=new Ei(null,0);n.wa(t.duration);var r=t.periods.map(function(t){return fo(e,t,n)}),i=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&r.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=i})}),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:r}}(o,s));case 2:return A(n),E(n,i.destroy(),7);case 7:x(n,0)}})})},n.stop=function(){return Promise.resolve()},n.update=function(){},n.onExpirationUpdated=function(e,t){var n=this;return f(function r(){var i,a,s,o,u,l,c;return P(r,function(r){switch(r.j){case 1:return i=n.a,a=new Gs,T(r,2,3),E(r,a.init(),5);case 5:return E(r,Ws(a,i.ua(),i.aa()),6);case 6:return E(r,(s=r.s).getManifests([i.key()]),7);case 7:if(o=r.s,u=o[0],l=u.sessionIds.includes(e),c=null==u.expiration||u.expiration>t,!l||!c){r.A(3);break}return E(r,s.updateManifestExpiration(i.key(),t),3);case 3:return A(r),E(r,a.destroy(),10);case 10:x(r,0);break;case 2:I(r),r.A(3)}})})},wi.Nb("application/x-offline-manifest",vo),V("shaka.offline.OfflineScheme",yo),yo.h=function(e){return ge(e={uri:e,$c:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},yo.i=function(e,t){var n=new Gs;return ge(void 0).U(function(){return n.init()}).U(function(){return Ws(n,t.ua(),t.aa())}).U(function(e){return e.getSegments([t.key()])}).U(function(e){return{uri:t,$c:t,data:e[0].data,headers:{}}}).finally(function(){return n.destroy()})},Pe("offline",yo),bo.prototype.destroy=function(){var e=this;return f(function t(){return P(t,function(t){switch(t.j){case 1:return e.l=!1,e.b&&e.b.abort(),Eo(e),E(t,e.m,2);case 2:e.a&&e.a.ta.Wa();for(var n=d(e.f),r=n.next();!r.done;r=n.next())r.value.ta.Wa();e.a=null,e.f=[],e.g=null,S(t)}})})},V("shaka.text.SimpleTextDisplayer",So),So.prototype.remove=function(e,t){return!!this.a&&(ko(this.a,function(n){return n.startTime<t&&n.endTime>e}),!0)},So.prototype.remove=So.prototype.remove,So.prototype.append=function(e){for(var t=To,n=[],r=0;r<e.length;r++){var i=t(e[r]);i&&n.push(i)}n.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:n.indexOf(t)-n.indexOf(e)}).forEach(function(e){this.a.addCue(e)}.bind(this))},So.prototype.append=So.prototype.append,So.prototype.destroy=function(){return this.a&&ko(this.a,function(){return!0}),this.a=null,Promise.resolve()},So.prototype.destroy=So.prototype.destroy,So.prototype.isTextVisible=function(){return"showing"==this.a.mode},So.prototype.isTextVisible=So.prototype.isTextVisible,So.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},So.prototype.setTextVisibility=So.prototype.setTextVisibility,V("shaka.util.ConfigUtils.mergeConfigObjects",Co),V("shaka.util.ConfigUtils.convertToConfigObject",Io),V("shaka.util.PlayerConfiguration",Ao),Ao.mergeConfigObjects=Lo,j(Do,Te),V("shaka.Player",Do),Do.prototype.destroy=function(){var e=this;return f(function t(){var n;return P(t,function(t){switch(t.j){case 1:return e.h==gu?t.return():(e.h=gu,n=wo(e.jb,function(){return{node:e.C,payload:{ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null},Ta:!1}}),E(t,new Promise(function(e){n.tb=function(){},n.jc=function(){e()},n.Wa=function(){e()},n.onError=function(){e()},n.lc=function(){e()}}),2));case 2:return E(t,e.jb.destroy(),3);case 3:if(e.i&&(e.i.release(),e.i=null),e.vc=null,e.l=null,e.b=null,!e.G){t.A(0);break}return E(t,e.G.destroy(),5);case 5:e.G=null,S(t)}})})},Do.prototype.destroy=Do.prototype.destroy,Do.version="v2.5.4";var Uo=["2","5"];nr=new function(e){this.a=e,this.c=er,this.b=tr}(new Zn(Number(Uo[0]),Number(Uo[1])));var Fo=["output-restricted","internal-error"],Bo={};function Vo(e,t){return f(function n(){return P(n,function(n){switch(n.j){case 1:if(e.h!=gu&&(e.h=_u),e.dispatchEvent(new Ee("unloading")),t.ya=null,t.mimeType=null,t.startTime=null,t.uri=null,t.u&&(e.i.da(t.u,"loadeddata"),e.i.da(t.u,"playing"),e.i.da(t.u,"pause"),e.i.da(t.u,"ended"),e.i.da(t.u,"ratechange")),e.gb&&(e.gb.release(),e.gb=null),e.Tb&&(e.Tb.stop(),e.Tb=null),!e.m){n.A(2);break}return E(n,e.m.stop(),3);case 3:e.m=null;case 2:if(!e.l){n.A(4);break}return E(n,e.l.stop(),4);case 4:if(!e.f){n.A(6);break}return E(n,e.f.destroy(),7);case 7:e.f=null;case 6:if(e.o&&(e.o.release(),e.o=null),!e.D){n.A(8);break}return E(n,e.D.destroy(),9);case 9:e.D=null;case 8:if(t.u&&t.u.src&&(t.u.removeAttribute("src"),t.u.load()),!e.g){n.A(10);break}return E(n,e.g.destroy(),11);case 11:e.g=null;case 10:e.$.a.clear(),e.Bb=null,e.P=null,e.Wb.clear(),e.c=null,e.v=null,e.xc=null,e.ib=!0,Xo(e),S(n)}})})}function jo(e,t){e.P=new Aa(t,Math.min(.5,t/2)),e.P.a=xa,Xo(e),e.Tb=new ce(function(){switch(e.h){case wu:var t=!!e.a.ended||Ut(e.a.buffered)>=e.a.duration-.1;break;case bu:e:{var n;if((n=e.a.ended)||(n=!(n=e.D).h||"ended"==n.h.readyState),n)t=!0;else{if(e.c.presentationTimeline.V()&&(n=e.c.presentationTimeline.nb(),Ut(e.a.buffered)>=n)){t=!0;break e}t=!1}}break;default:t=!1}var r=Bt(e.a.buffered,e.a.currentTime),i=t,a=(n=e.P).b.get(n.a);t=n.a,r=i||r>=a?La:xa,n.a=r,t!=r&&Xo(e)}).La(.25)}function Ho(e){if(e.m&&e.m.configure(e.b.manifest),e.g&&e.g.configure(e.b.drm),e.f){e.f.configure(e.b.streaming);try{e.c.periods.forEach(e.Fc.bind(e))}catch(t){e.Ka(t)}var t=os(e.f),n=us(e.f),r=fu(e);t=Xn(t,n,r.variants),e.l&&t&&t.allowedByApplication&&t.allowedByKeySystem?Qo(e,r.variants):Zo(e,r)}if(e.D&&(r=e.b.textDisplayFactory,e.xc!=r)){t=new r;var i=(n=e.D).g;n.g=t,i&&(t.setTextVisibility(i.isTextVisible()),i.destroy()),n.a&&(n.a.c=t),e.xc=r,e.f&&((t=(r=e.f).b.get("text"))&&fs(r,t.stream,!0,0,!0))}e.l&&(e.l.configure(e.b.abr),e.b.abr.enabled&&!e.ib?e.l.enable():e.l.disable(),iu(e))}function Ko(e,t,n,r){ba(e.$,t).variant=n,(e=e.v.c).c!=n&&(e.c=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:r,bandwidth:n.bandwidth}))}function Go(e,t,n,r){_a(e.$,t,n),(e=e.v.c).b!=n&&(e.b=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:r,bandwidth:null}))}function Wo(e){var t=xo();return t.streaming.failureCallback=function(t){e.V()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,e.fd())},t.textDisplayFactory=function(){return new So(e.a)},t}function qo(e,t){var n=e.f?os(e.f):null,r=e.f?us(e.f):null;if(t.forEach(Fn.bind(null,e.g,n,r)),0==(n=function(e,t){var n=0;return e.forEach(function(e){n+=t(e)?1:0}),n}(t,function(e){return e.variants.some(Wn)})))throw new fe(2,4,4032);if(n<t.length)throw new fe(2,4,4011);t.forEach(function(e){Un(e.variants,this.b.restrictions,this.Xb)&&this.f&&fu(this)==e&&eu(this),lu(this,e.variants)}.bind(e))}function zo(e,t,n,r){n=void 0!==n&&n,r=void 0===r?0:r,e.ib?(e.Ea=t,e.Dd=n,e.Bd=r):(hs(e.f,t,n,r),tu(e))}function Yo(e,t){e.ib?e.na=t:(fs(e.f,t,!0,0,!1),nu(e))}function Xo(e){var t=e.Nc();if(e.v&&e.P&&e.o){var n=e.W;n.f=t,Ha(n),$o(e)}e.dispatchEvent(new Ee("buffering",{buffering:t}))}function $o(e){if(e.v&&e.P){var t=e.v.a;e.P.a==xa?Ro(t,"buffering"):e.a.paused?Ro(t,"paused"):e.a.ended?Ro(t,"ended"):Ro(t,"playing")}}function Qo(e,t){try{lu(e,t)}catch(t){return e.Ka(t),null}var n=t.filter(function(e){return Wn(e)});return n=e.Ub.create(n),e.l.setVariants(Array.from(n.values())),e.l.chooseVariant()}function Zo(e,t){var n=Qo(e,t.variants);n&&(Ko(e,t,n,!0),zo(e,n,!0)),(n=zn(t.textStreams,e.ma,e.cb)[0]||null)&&(e.b.streaming.alwaysStreamText||e.gc())&&(Go(e,t,n,!0),Yo(e,n)),Jo(e)}function Jo(e){cu(e,new Ee("adaptation"))}function eu(e){cu(e,new Ee("trackschanged"))}function tu(e){cu(e,new Ee("variantchanged"))}function nu(e){cu(e,new Ee("textchanged"))}function ru(e){cu(e,new Ee("texttrackvisibility"))}function iu(e){cu(e,new Ee("abrstatuschanged",{rg:e.b.abr.enabled}))}function au(e,t,n){e.dispatchEvent(new Ee(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function su(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new fe(2,3,3016,t,n,e.a.error.message)}function ou(e,t){if(e.f){var n=fu(e),r=!1,i=Object.keys(t),a=1==i.length&&"00"==i[0];i.length&&n.variants.forEach(function(e){(function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t})(e).forEach(function(n){var i=e.allowedByKeySystem;n.keyId&&(n=t[a?"00":n.keyId],e.allowedByKeySystem=!!n&&!Fo.includes(n)),i!=e.allowedByKeySystem&&(r=!0)})}),(i=Xn(i=os(e.f),us(e.f),n.variants))&&!i.allowedByKeySystem&&Zo(e,n),r&&(eu(e),Qo(e,n.variants))}}function uu(e,t,n){e.m&&e.m.onExpirationUpdated&&e.m.onExpirationUpdated(t,n),e.dispatchEvent(new Ee("expirationupdated"))}function lu(e,t){var n=e.g?ze(e.g.T):{},r=Object.keys(n);r=r.length&&"00"==r[0];for(var i=!1,a=!1,s=[],o=[],u=d(t),l=u.next();!l.done;l=u.next()){var c=[];(l=l.value).audio&&c.push(l.audio),l.video&&c.push(l.video);for(var h=(c=d(c)).next();!h.done;h=c.next())if((h=h.value).keyId){var f=n[r?"00":h.keyId];f?Fo.includes(f)&&(o.includes(f)||o.push(f)):s.includes(h.keyId)||s.push(h.keyId)}l.allowedByApplication?l.allowedByKeySystem&&(i=!0):a=!0}if(!i)throw new fe(2,4,4012,{hasAppRestrictions:a,missingKeys:s,restrictedKeyStatuses:o})}function cu(e,t){f(function n(){return P(n,function(n){switch(n.j){case 1:return E(n,Promise.resolve(),2);case 2:e.h!=gu&&e.dispatchEvent(t),S(n)}})})}function du(e){for(var t=new Set,n=(e=d(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Rn(n.language)):t.add("und");return t}function hu(e){for(var t=new Map,n=(e=d(e)).next();!n.done;n=e.next()){var r=n.value;n="und";var i=[];for(r.language&&(n=Rn(r.language)),(i="variant"==r.type?r.audioRoles:r.roles)&&i.length||(i=[""]),t.has(n)||t.set(n,new Set),i=(r=d(i)).next();!i.done;i=r.next())i=i.value,t.get(n).add(i)}var a=[];return t.forEach(function(e,t){for(var n=d(e),r=n.next();!r.done;r=n.next())a.push({language:t,role:r.value})}),a}function fu(e){for(var t=e.o.h(),n=null,r=(e=d(e.c.periods)).next();!r.done;r=e.next())(r=r.value).startTime<=t&&(n=r);return n}function pu(e){var t=fu(e);return ba(e.$,t).variant}function mu(){return new fe(2,7,7e3)}function vu(e,t,n,r,i,a){return r==e&&i.u==a.u&&i.uri==a.uri&&i.mimeType==a.mimeType&&i.ya==a.ya?t:n}function yu(e){return new Promise(function(t,n){e.Wa=function(){return n(mu())},e.jc=function(){return t()},e.onError=function(e){return n(e)},e.lc=function(){return n(mu())}})}Do.registerSupportPlugin=function(e,t){Bo[e]=t},Do.isBrowserSupported=function(){return!!(e.Promise&&e.Uint8Array&&Array.prototype.forEach&&e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)&&(!!Qe()||Ze("application/x-mpegurl"))},Do.probeSupport=function(){return It().then(function(e){for(var t=wi.Af(),n={},r=d('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),i=r.next();!i.done;i=r.next()){n[i=i.value]=Qe()?!!mn(i)||(MediaSource.isTypeSupported(i)||zt(i)):Ze(i);var a=i.split(";")[0];n[a]=n[a]||n[i]}for(var s in e={manifest:t,media:n,drm:e},Bo)e[s]=Bo[s]();return e})},Do.prototype.Cb=function(e,t){if(t=void 0===t||t,this.h==gu)return Promise.reject(mu());var n={ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null};n.u=e,Qe()||(t=!1);var r=t?this.fb:this.M,i=wo(this.jb,function(){return{node:r,payload:n,Ta:!1}});return i.tb=function(){},yu(i)},Do.prototype.attach=Do.prototype.Cb,Do.prototype.detach=function(){var e=this;if(this.h==gu)return Promise.reject(mu());var t=wo(this.jb,function(){return{node:e.C,payload:{ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null},Ta:!1}});return t.tb=function(){},yu(t)},Do.prototype.detach=Do.prototype.detach,Do.prototype.qd=function(e){var t=this;if(e=void 0===e||e,this.h==gu)return Promise.reject(mu());Qe()||(e=!1);var n={ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null},r=wo(this.jb,function(r){var i=r.u&&e?t.fb:r.u?t.M:t.C;return n.u=r.u,{node:i,payload:n,Ta:!1}});return r.tb=function(){},yu(r)},Do.prototype.unload=Do.prototype.qd,Do.prototype.load=function(e,t,n){if(this.h==gu)return Promise.reject(mu());this.dispatchEvent(new Ee("loading"));var r={ya:null,u:null,mimeType:null,startTime:null,nd:null,uri:null};r.uri=e,r.nd=Date.now()/1e3,n&&"string"!=typeof n&&(Jn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),r.ya=function(){return new n}),n&&"string"==typeof n&&(r.mimeType=n),void 0!==t&&(r.startTime=t);var i=function(e){if(e.ya)return!1;if(!Qe())return!0;var t=e.mimeType;return e=e.uri||"",t||(t={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[wi.getExtension(e)]),!!t&&!!Ze(t)&&(!wi.isSupported(e,t)||!!navigator.vendor&&navigator.vendor.includes("Apple"))}(r)?this.hb:this.T,a=wo(this.jb,function(e){return null==e.u?null:(r.u=e.u,{node:i,payload:r,Ta:!0})});return a.tb=function(){},new Promise(function(e,t){a.lc=function(){return t(new fe(2,7,7002))},a.jc=function(){return e()},a.Wa=function(){return t(mu())},a.onError=function(e){return t(e)}})},Do.prototype.load=Do.prototype.load,Do.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Io(e,t));var n=Lo(this.b,e,Wo(this));return Ho(this),n},Do.prototype.configure=Do.prototype.configure,Do.prototype.getConfiguration=function(){var e=Wo(this);return Lo(e,this.b,Wo(this)),e},Do.prototype.getConfiguration=Do.prototype.getConfiguration,Do.prototype.If=function(){for(var e in this.b)delete this.b[e];Lo(this.b,Wo(this),Wo(this)),Ho(this)},Do.prototype.resetConfiguration=Do.prototype.If,Do.prototype.Je=function(){return this.h},Do.prototype.getLoadMode=Do.prototype.Je,Do.prototype.Ne=function(){return this.a},Do.prototype.getMediaElement=Do.prototype.Ne,Do.prototype.Fb=function(){return this.G},Do.prototype.getNetworkingEngine=Do.prototype.Fb,Do.prototype.bc=function(){return this.Bb},Do.prototype.getAssetUri=Do.prototype.bc,Do.prototype.Me=function(){return Jn("getManifestUri",'Please use "getAssetUri" instead.'),this.bc()},Do.prototype.getManifestUri=Do.prototype.Me,Do.prototype.V=function(){return this.c?this.c.presentationTimeline.V():!(!this.a||!this.a.src)&&1/0==this.a.duration},Do.prototype.isLive=Do.prototype.V,Do.prototype.Va=function(){return!!this.c&&this.c.presentationTimeline.Va()},Do.prototype.isInProgress=Do.prototype.Va,Do.prototype.af=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Do.prototype.isAudioOnly=Do.prototype.af,Do.prototype.Kf=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.mb(),end:e.za()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Do.prototype.seekRange=Do.prototype.Kf,Do.prototype.keySystem=function(){return this.g?this.g.keySystem():""},Do.prototype.keySystem=Do.prototype.keySystem,Do.prototype.drmInfo=function(){return this.g?this.g.a:null},Do.prototype.drmInfo=Do.prototype.drmInfo,Do.prototype.dc=function(){return this.g?this.g.dc():1/0},Do.prototype.getExpiration=Do.prototype.dc,Do.prototype.Nc=function(){return!!this.P&&this.P.a==xa},Do.prototype.isBuffering=Do.prototype.Nc,Do.prototype.Qe=function(){if(this.W){var e=this.W;e=e.f?0:e.c}else e=0;return e},Do.prototype.getPlaybackRate=Do.prototype.Qe,Do.prototype.bg=function(e){0==e?z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.W.set(e),this.h==bu&&ds(this.f,1<Math.abs(e)))},Do.prototype.trickPlay=Do.prototype.bg,Do.prototype.ue=function(){this.h==wu&&this.W.set(1),this.h==bu&&(this.W.set(1),ds(this.f,!1))},Do.prototype.cancelTrickPlay=Do.prototype.ue,Do.prototype.Mc=function(){if(this.c&&this.o){for(var e=pu(this),t=[],n=d(function(e){return null==(e=fu(e))?[]:e.variants.filter(function(e){return Wn(e)})}(this)),r=n.next();!r.done;r=n.next()){var i=Vn(r=r.value);i.active=r==e,t.push(i)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(e){var t=Gn(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind?(t.primary=!0,t.roles=["main"],t.audioRoles=["main"]):t.audioRoles=[],t}):[]},Do.prototype.getVariantTracks=Do.prototype.Mc,Do.prototype.ob=function(){if(this.c&&this.o){for(var e=function(e){var t=fu(e);if(null==t)return null;if(!ba(e.$,t).text){var n=zn(t.textStreams,e.ma,e.cb);n.length&&_a(e.$,t,n[0])}return ba(e.$,t).text}(this),t=[],n=d(function(e){var t=fu(e);return null==t?[]:t.textStreams.filter(function(t){return!e.Wb.has(t)})}(this)),r=n.next();!r.done;r=n.next()){var i=jn(r=r.value);i.active=r==e,t.push(i)}return t}return this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).map(function(e){var t=Gn(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),t}):[]},Do.prototype.getTextTracks=Do.prototype.ob,Do.prototype.gd=function(e){if(this.c&&this.f){var t=fu(this),n=t.textStreams.find(function(t){return t.id==e.id});n&&(Go(this,t,n,!1),Yo(this,n),this.ma=n.language)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(t=d(t=Array.from(this.a.textTracks))).next();!n.done;n=t.next())Hn(n=n.value)==e.id?n.mode=this.eb?"showing":"hidden":n.mode="disabled";nu(this)}},Do.prototype.selectTextTrack=Do.prototype.gd,Do.prototype.Mf=function(){Jn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.ob().filter(function(e){return"application/cea-608"==e.mimeType});0<e.length&&this.gd(e[0])},Do.prototype.selectEmbeddedTextTrack=Do.prototype.Mf,Do.prototype.gg=function(){Jn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.ob().filter(function(e){return e.active})[0];return!!e&&"application/cea-608"==e.mimeType},Do.prototype.usingEmbeddedTextTrack=Do.prototype.gg,Do.prototype.Of=function(e,t,n){if(n=void 0===n?0:n,this.c&&this.f){var r=fu(this);this.b.abr.enabled&&z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=r.variants.find(function(t){return t.id==e.id});i&&Wn(i)&&(Ko(this,r,i,!1),zo(this,i,t,n),this.Ub=new Ca(i),Qo(this,r.variants))}else if(this.a&&this.a.audioTracks){for(n=(t=d(t=Array.from(this.a.audioTracks))).next();!n.done;n=t.next())Hn(n=n.value)==e.id&&(n.enabled=!0);tu(this)}},Do.prototype.selectVariantTrack=Do.prototype.Of,Do.prototype.Ee=function(){return hu(this.Mc())},Do.prototype.getAudioLanguagesAndRoles=Do.prototype.Ee,Do.prototype.Xe=function(){return hu(this.ob())},Do.prototype.getTextLanguagesAndRoles=Do.prototype.Xe,Do.prototype.De=function(){return Array.from(du(this.Mc()))},Do.prototype.getAudioLanguages=Do.prototype.De,Do.prototype.We=function(){return Array.from(du(this.ob()))},Do.prototype.getTextLanguages=Do.prototype.We,Do.prototype.Lf=function(e,t){if(this.c&&this.o){var n=fu(this);this.Ub=new Ia(e,t||"",0),Zo(this,n)}else if(this.a&&this.a.audioTracks){for(var r=(n=d(n=Array.from(this.a.audioTracks))).next();!r.done;r=n.next())(r=r.value).language==e&&(r.enabled=!0);tu(this)}},Do.prototype.selectAudioLanguage=Do.prototype.Lf,Do.prototype.Nf=function(e,t){if(this.c&&this.o){var n=fu(this);this.ma=e,this.cb=t||"";var r=zn(n.textStreams,this.ma,this.cb)[0]||null;r&&(Go(this,n,r,!1),(this.b.streaming.alwaysStreamText||this.gc())&&Yo(this,r))}else(n=this.ob().filter(function(t){return t.language==e})[0])&&this.gd(n)},Do.prototype.selectTextLanguage=Do.prototype.Nf,Do.prototype.gc=function(){var e=this.eb;return this.c?this.D.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).some(function(e){return"showing"==e.mode}):e},Do.prototype.isTextTrackVisible=Do.prototype.gc,Do.prototype.Rf=function(e){var t=this;return f(function n(){var r,i,a,s;return P(n,function(n){switch(n.j){case 1:if(t.eb==(r=e))return n.return();if(t.eb=r,t.h!=bu){if(t.a&&t.a.src&&t.a.textTracks)for(var o=d(Array.from(t.a.textTracks)),u=o.next();!u.done;u=o.next())"disabled"!=(i=u.value).mode&&(i.mode=e?"showing":"hidden");n.A(2);break}if(t.D.g.setTextVisibility(e),t.b.streaming.alwaysStreamText){n.A(2);break}if(!e){(o=t.f).D=!0,(u=o.b.get("text"))&&(xs(u),o.b.delete("text")),n.A(2);break}if(a=fu(t),!(0<(s=zn(a.textStreams,t.ma,t.cb)).length)){n.A(2);break}return E(n,cs(t.f,s[0]),2);case 2:ru(t),S(n)}})})},Do.prototype.setTextTrackVisibility=Do.prototype.Rf,Do.prototype.Se=function(){if(!this.V())return null;if(this.c)return new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:new Date(e.getTime()+1e3*this.a.currentTime)}return null},Do.prototype.getPlayheadTimeAsDate=Do.prototype.Se,Do.prototype.Ue=function(){if(!this.V())return null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:e}return null},Do.prototype.getPresentationStartTimeAsDate=Do.prototype.Ue,Do.prototype.Ic=function(){var e={total:[],audio:[],video:[],text:[]};return this.h==wu&&(e.total=Vt(this.a.buffered)),this.h==bu&&this.D.Ic(e),e},Do.prototype.getBufferedInfo=Do.prototype.Ic,Do.prototype.getStats=function(){if(this.h!=bu&&this.h!=wu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]};$o(this);var e=this.a;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.v,n=Number(e.totalVideoFrames);t.i=Number(e.droppedVideoFrames),t.h=n}this.h==bu&&((e=pu(this))&&(this.v.l=e.bandwidth),e&&e.video&&(t=this.v,n=e.video.height||NaN,t.m=e.video.width||NaN,t.g=n),e=this.l.getBandwidthEstimate(),this.v.f=e);var r=this.v;e=r.m,t=r.g,n=r.l;for(var i=r.h,a=r.i,s=r.f,o=r.b,u=Mo(r.a,"playing"),l=Mo(r.a,"paused"),c=Mo(r.a,"buffering"),h=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],r=d(e.b),i=r.next();!i.done;i=r.next())n.push(t(i.value));return e.a&&n.push(t(e.a)),n}(r.a),f=[],p=(r=d(r.c.a)).next();!p.done;p=r.next())p=p.value,f.push({timestamp:p.timestamp,id:p.id,type:p.type,fromAdaptation:p.fromAdaptation,bandwidth:p.bandwidth});return{width:e,height:t,streamBandwidth:n,decodedFrames:i,droppedFrames:a,estimatedBandwidth:s,loadLatency:o,playTime:u,pauseTime:l,bufferingTime:c,stateHistory:h,switchHistory:f}},Do.prototype.getStats=Do.prototype.getStats,Do.prototype.addTextTrack=function(e,t,n,r,i,a){var s=this;return f(function o(){var u,l,c,d,h,f,p,m,v;return P(o,function(o){switch(o.j){case 1:if(s.h==wu)throw Error("State error!");if(s.h!=bu)throw Error("State error!");if(u=fu(s),l=Gt,c=s.c.periods.indexOf(u),h=(d=c+1)>=s.c.periods.length?s.c.presentationTimeline.Y():s.c.periods[d].startTime,1/0==(f=h-u.startTime))throw new fe(1,4,4033);return p=new zr(1,0,f,function(){return[e]},0,null),m={id:s.Hd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:r,codecs:i||"",kind:n,encrypted:!1,keyId:null,language:t,label:a||null,type:l.qa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},s.Wb.add(m),u.textStreams.push(m),E(o,cs(s.f,m),2);case 2:return(v=ls(s.f,"text"))&&_a(s.$,u,v),s.Wb.delete(m),Zo(s,u),eu(s),o.return(jn(m))}})})},Do.prototype.addTextTrack=Do.prototype.addTextTrack,Do.prototype.jd=function(e,t){this.Xb.width=e,this.Xb.height=t},Do.prototype.setMaxHardwareResolution=Do.prototype.jd,Do.prototype.fd=function(){if(this.h==bu){var e=this.f;if(e.f)e=!1;else if(e.m)e=!1;else{for(var t=d(e.b.values()),n=t.next();!n.done;n=t.next())(n=n.value).Ib&&(n.Ib=!1,As(e,n,.1));e=!0}}else e=!1;return e},Do.prototype.retryStreaming=Do.prototype.fd,Do.prototype.Ke=function(){return this.c},Do.prototype.getManifest=Do.prototype.Ke,Do.prototype.Le=function(){return this.m?this.m.constructor:null},Do.prototype.getManifestParserFactory=Do.prototype.Le,(n=Do.prototype).Fc=function(e){var t=this.f?os(this.f):null,n=this.f?us(this.f):null;if(Fn(this.g,t,n,e),!(t=e.variants).some(Wn))throw new fe(2,4,4011);if(lu(this,e.variants),Un(t,this.b.restrictions,this.Xb)&&this.f&&fu(this)==e&&eu(this),e=this.g?this.g.a:null)for(n=(t=d(t)).next();!n.done;n=t.next())for(var r=(n=d(n.value.drmInfos)).next();!r.done;r=n.next())if((r=r.value).keySystem==e.keySystem)for(var i=(r=d(r.initData||[])).next();!i.done;i=r.next())i=i.value,bt(this.g,i.initDataType,i.initData)},n.df=function(e){try{this.ib=!0,this.l.disable(),iu(this);var t=Qo(this,e.variants),n=zn(e.textStreams,this.ma,this.cb)[0]||null;this.Ea&&(e.variants.includes(this.Ea)&&(t=this.Ea),this.Ea=null),this.na&&(e.textStreams.includes(this.na)&&(n=this.na),this.na=null),t&&Ko(this,e,t,!0),n&&Go(this,e,n,!0);var r=this.f,i=r.b.get("video");if(i)var a=r.c.periods[i.pa];else{var s=r.b.get("audio");a=s?r.c.periods[s.pa]:null}var o=t?t.audio:null;if(!a&&n){var u;if(u=o){e=n;var l=Rn(this.b.preferredTextLanguage),c=Rn(o.language),d=Rn(e.language);u=Ln(d,l)&&!Ln(c,d)}u&&(this.eb=!0),this.eb&&this.D.g.setTextVisibility(!0),ru(this)}return this.b.streaming.alwaysStreamText||this.gc()?{variant:t,text:n}:{variant:t,text:null}}catch(e){return this.Ka(e),{variant:null,text:null}}},n.te=function(){this.ib=!1,this.b.abr.enabled&&(this.l.enable(),iu(this)),this.Ea&&(hs(this.f,this.Ea,this.Dd,this.Bd),tu(this),this.Ea=null),this.na&&(fs(this.f,this.na,!0,0,!1),nu(this),this.na=null)},n.jf=function(){this.m&&this.m.update&&this.m.update()},n.qf=function(){this.o&&this.o.o()},n.Ka=function(e){if(this.h!=gu){var t=new Ee("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var gu=0,_u=1,bu=2,wu=3;function Eu(e,t){var n=fo(new ho(e.ua(),e.aa()),t.periods[0],new Ei(null,0)),r=t.appMetadata||{};return n=Su(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:r}}function Su(e){for(var t=[],n=function(e){return e.filter(function(e){return Wn(e)})}(e.variants),r=(n=d(n)).next();!r.done;r=n.next())t.push(Vn(r.value));for(n=(e=d(e.textStreams)).next();!n.done;n=e.next())t.push(jn(n.value));return t}function Tu(){this.a={}}function ku(e,t){var n=e.a[t];return null==n&&(n=0),n}function Cu(e){this.a=!1,this.b=new pe,this.c=e}function Iu(e){var t=new xu;e.periods.forEach(function(e,n){var r=Nu(e.variants);if(0==n)for(var i=(r=d(r.a)).next();!i.done;i=r.next())t.add(i.value);else!function(e,t){e.a=e.a.filter(function(e){return Lu(t,e)})}(t,r)});for(var n=(e=d(e.periods)).next();!n.done;n=e.next())(n=n.value).variants=n.variants.filter(function(e){return Lu(t,new Au(e))})}function Au(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function xu(){this.a=[]}function Lu(e,t){return e.a.some(function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c})}function Nu(e){for(var t=new xu,n=(e=d(e)).next();!n.done;n=e.next())t.add(new Au(n.value));return t}function Ru(e){var t=this;if(e&&e.constructor!=Do)throw new fe(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.Fb()):(this.a=xo(),this.b=new Ne),this.f=!1,this.c=[],this.g=[];var n=!e;this.h=new Cu(function(){return f(function e(){var r;return P(e,function(e){switch(e.j){case 1:return r=function(){},E(e,Promise.all(t.g.map(function(e){return e.then(r,r)})),2);case 2:if(!n){e.A(3);break}return E(e,t.b.destroy(),3);case 3:t.a=null,t.b=null,S(e)}})})})}function Mu(){if(Qe())e:{for(var e=d(zs.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Pu(e,t){for(var n=[],r=d(e.periods),i=r.next();!i.done;i=r.next())for(var a=(i=d(i.value.streams)).next();!a.done;a=i.next())a=a.value,t&&"video"==a.contentType?n.push({contentType:Ye(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||n.push({contentType:Ye(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return n}function Ou(e,t,n){return f(function r(){return P(r,function(r){switch(r.j){case 1:return E(r,function(e,t,n,r){return f(function i(){var a,s,o;return P(i,function(i){switch(i.j){case 1:return r.drmInfo?(a=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new fe(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(n),s=r.sessionIds.map(function(e){return{sessionId:e,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:Pu(r,!1),videoCapabilities:Pu(r,!0)}}),E(i,go(t,e,s),2)):i.return();case 2:return o=i.s,E(i,a.remove(o),3);case 3:return E(i,a.add(s.filter(function(e){return-1==o.indexOf(e.sessionId)})),0)}})})}(e.b,e.a.drm,n,t),0)}})})}function Du(e,t,n,r){function i(){o+=1,e.a.offline.progressCallback(u,o/s)}var a=function(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}(r),s=a.length+1,o=0,u=Eu(n,r);return Promise.all([t.removeSegments(a,i),t.removeManifests([n.key()],i)])}function Uu(e,t,n,r,i,a){var s={id:a.id,originalId:a.originalId,primary:a.primary,presentationTimeOffset:a.presentationTimeOffset||0,contentType:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,initSegmentKey:null,encrypted:a.encrypted,keyId:a.keyId,segments:[],variantIds:[]};i=i.presentationTimeline.Hb();var o=a.id;return function(e,t,n){for(var r=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);r;)n(r),r=e.getSegmentReference(++t)}(a,i,function(i){var u=Si(i.c(),i.b,i.a,e.a.streaming.retryParameters);Ds(t,o,u,function(e,t,n){return n=n.endTime-n.startTime,ku(e,t)*n}(r,a.id,i),function(t){return n.addSegments([{data:t}]).then(function(t){e.c.push(t[0]),s.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:t[0]})})})}),(i=a.initSegmentReference)&&(i=Si(i.c(),i.b,i.a,e.a.streaming.retryParameters),Ds(t,o,i,.5*ku(r,a.id),function(t){return n.addSegments([{data:t}]).then(function(t){e.c.push(t[0]),s.initSegmentKey=t[0]})})),s}function Fu(e){if(e.h.a)throw new fe(2,9,7001)}function Bu(){if(!Mu())throw new fe(2,9,9e3)}function Vu(e,t){return f(function n(){return P(n,function(n){switch(n.j){case 1:return e.g.push(t),k(n,2),E(n,t,4);case 4:return n.return(n.s);case 2:A(n),Ie(e.g,t),x(n,0)}})})}function ju(e){for(var t=new Set,n=(e=d(e.periods)).next();!n.done;n=e.next()){for(var r=d((n=n.value).textStreams),i=r.next();!i.done;i=r.next())t.add(i.value);for(r=(n=d(n.variants)).next();!r.done;r=n.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video)}return t}function Hu(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var n=d(t),r=n.next();!r.done;r=n.next())for(var i=(r=d(t)).next();!i.done;i=r.next());for(n=(t=d(e)).next();!n.done;n=t.next())for(r=(n=d(e)).next();!r.done;r=n.next());}Do.LoadMode={DESTROYED:gu,NOT_LOADED:_u,MEDIA_SOURCE:bu,SRC_EQUALS:wu},Cu.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then(function(){e.b.resolve()},function(){e.b.resolve()}))},xu.prototype.add=function(e){Lu(this,e)||this.a.push(e)},V("shaka.offline.Storage",Ru),Ru.support=Mu,Ru.prototype.destroy=function(){return this.h.destroy()},Ru.prototype.destroy=Ru.prototype.destroy,Ru.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Io(e,t));var n=e,r=!1;return null!=n.trackSelectionCallback&&(r=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(r=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(r=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),r&&Jn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Lo(this.a,e)},Ru.prototype.configure=Ru.prototype.configure,Ru.prototype.getConfiguration=function(){var e=xo();return Lo(e,this.a,xo()),e},Ru.prototype.getConfiguration=Ru.prototype.getConfiguration,Ru.prototype.Fb=function(){return this.b},Ru.prototype.getNetworkingEngine=Ru.prototype.Fb,Ru.prototype.store=function(e,t,n){var r=this;return Vu(this,function(e,t,n,r){return f(function i(){var a,s,o,u,l,c,h,p,m;return P(i,function(i){switch(i.j){case 1:return Bu(),e.f?i.return(Promise.reject(new fe(2,9,9006))):(e.f=!0,E(i,function(e,t,n){return f(function r(){var i,a,s,o,u,l;return P(r,function(r){switch(r.j){case 1:return i=null,a=e.b,s={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},E(r,n(),2);case 2:return(o=r.s).configure(e.a.manifest),Fu(e),k(r,3),E(r,o.start(t,s),5);case 5:return u=r.s,Fu(e),l=ju(u),E(r,Promise.all(Array.from(l).map(function(e){return e.createSegmentIndex()})),6);case 6:if(Fu(e),i)throw i;return r.return(u);case 3:return A(r),E(r,o.stop(),7);case 7:x(r,0)}})})}(e,t,r),2));case 2:if(a=i.s,Fu(e),!(!a.presentationTimeline.V()&&!a.presentationTimeline.Va()))throw new fe(2,9,9005,t);return s=null,o=new Gs,l=u=null,T(i,3,4),E(i,function(e,t,n){return f(function r(){var i,a,s;return P(r,function(r){switch(r.j){case 1:return i=new mt({rb:e.b,onError:n,kc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=Fa(t.periods),s=e.a,i.configure(s.drm),E(r,function(e,t,n){return e.o=[],e.D=n,yt(e,t)}(i,a,s.offline.usePersistentLicense),2);case 2:return E(r,gt(i),3);case 3:return E(r,_t(i),4);case 4:return r.return(i)}})})}(e,a,function(e){l=l||e}),6);case 6:if(s=i.s,Fu(e),l)throw l;return function(e,t,n){(function(e,t){for(var n={width:1/0,height:1/0},r=d(e.periods),i=r.next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter(function(e){return Dn(e,t,n)})})(t,e.a.restrictions),function(e){for(var t=(e=d(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&bn(e.audio)),e.video&&(t=t&&bn(e.video)),t})}(t),function(e,t){for(var n=d(e.periods),r=n.next();!r.done;r=n.next())(r=r.value).variants=r.variants.filter(function(e){return At(t,e)})}(t,n),Iu(t),function(e,t){var n=new xu;e.periods.forEach(function(e,r){0<r&&(e.variants=e.variants.filter(function(e){return Lu(n,new Au(e))})),t(e),n=Nu(e.variants)})}(t,function(t){for(var n=[],r=d(t.variants),i=r.next();!i.done;i=r.next())n.push(Vn(i.value));for(r=d(t.textStreams),i=r.next();!i.done;i=r.next())n.push(jn(i.value));n=e.a.offline.trackSelectionCallback(n);var a=new Set,s=new Set;for(n=d(n),r=n.next();!r.done;r=n.next())"variant"==(r=r.value).type&&a.add(r.id),"text"==r.type&&s.add(r.id);t.variants=t.variants.filter(function(e){return a.has(e.id)}),t.textStreams=t.textStreams.filter(function(e){return s.has(e.id)})}),function(e){if(0==e.periods.length)throw new fe(2,4,4014);for(var t=(e=d(e.periods)).next();!t.done;t=e.next())Hu(t.value)}(t)}(e,a,s),E(i,o.init(),7);case 7:return Fu(e),E(i,function(e){var t=null;if(e.a.forEach(function(e,n){e.getCells().forEach(function(e,r){e.hasFixedKeySpace()||t||(t={path:{ua:n,aa:r},aa:e})})}),t)return t;throw new fe(2,9,9013,"Could not find a cell that supports add-operations")}(o),8);case 8:return u=i.s,Fu(e),E(i,function(e,t,n,r,i,a){return f(function s(){var o,u,l,c;return P(s,function(s){switch(s.j){case 1:return o=function(e,t,n){var r=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.Y(),size:0,expiration:r,tracks:t=Su(t.periods[0]),appMetadata:n}}(i,r,a),u=new Os(e.b,function(t,n){o.size=n,e.a.offline.progressCallback(o,t)}),k(s,2),c=l=function(e,t,n,r,i,a,s){var o=new Tu,u=i.periods.map(function(r){return function(e,t,n,r,i,a){i.periods.forEach(function(e){e.variants.forEach(function(e){var t=e.audio,n=e.video;if(t&&!n&&(r.a[t.id]=t.bandwidth||e.bandwidth),!t&&n&&(r.a[n.id]=n.bandwidth||e.bandwidth),t&&n){var i=t.bandwidth||393216,a=n.bandwidth||e.bandwidth-i;0>=a&&(a=e.bandwidth),r.a[t.id]=i,r.a[n.id]=a}}),e.textStreams.forEach(function(e){r.a[e.id]=52})});for(var s=ju(i),o=new Map,u=(s=d(s)).next();!u.done;u=s.next()){u=u.value;var l=Uu(e,t,n,r,i,u);o.set(u.id,l)}return a.variants.forEach(function(e){e.audio&&o.get(e.audio.id).variantIds.push(e.id),e.video&&o.get(e.video.id).variantIds.push(e.id)}),{startTime:a.startTime,streams:Array.from(o.values())}}(e,t,n,o,i,r)}),l=r.a,c=Et(r);if(l&&e.a.offline.usePersistentLicense){if(!c.length)throw new fe(2,9,9007,a);l.initData=[]}return{originalManifestUri:a,duration:i.presentationTimeline.Y(),size:0,expiration:r.dc(),periods:u,sessionIds:e.a.offline.usePersistentLicense?c:[],drmInfo:l,appMetadata:s}}(e,u,t,n,r,i,a),E(s,function(e){return f(function t(){return P(t,function(t){switch(t.j){case 1:return E(t,Promise.all(e.b.values()),2);case 2:return t.return(e.a.a)}})})}(u),4);case 4:return c.size=s.s,s.return(l);case 2:return A(s),E(s,u.destroy(),5);case 5:x(s,0)}})})}(e,u.aa,s,a,t,n),9);case 9:if(c=i.s,Fu(e),l)throw l;return E(i,u.aa.addManifests([c]),10);case 10:return h=i.s,Fu(e),p=new lo("manifest",u.path.ua,u.path.aa,h[0]),i.return(Eu(p,c));case 4:return A(i),e.f=!1,e.c=[],E(i,o.destroy(),11);case 11:if(!s){i.A(12);break}return E(i,s.destroy(),12);case 12:x(i,0);break;case 3:if(m=I(i),!u){i.A(14);break}return E(i,u.aa.removeSegments(e.c,function(){}),14);case 14:throw l||m}})})}(this,e,t||{},function(){return f(function t(){var i,a;return P(t,function(t){switch(t.j){case 1:return n&&"string"!=typeof n?(Jn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=n,t.return(new i)):E(t,wi.create(e,r.b,r.a.manifest.retryParameters,n),2);case 2:return a=t.s,t.return(a)}})})}))},Ru.prototype.store=Ru.prototype.store,Ru.prototype.Ve=function(){return this.f},Ru.prototype.getStoreInProgress=Ru.prototype.Ve,Ru.prototype.remove=function(e){return Vu(this,function(e,t){return f(function n(){var r,i,a,s,o,u;return P(n,function(n){switch(n.j){case 1:return Bu(),null==(r=co(t))||"manifest"!=r.a?n.return(Promise.reject(new fe(2,9,9004,t))):(i=r,a=new Gs,k(n,2),E(n,a.init(),4));case 4:return E(n,Ws(a,i.ua(),i.aa()),5);case 5:return s=n.s,E(n,s.getManifests([i.key()]),6);case 6:return o=n.s,u=o[0],E(n,Promise.all([Ou(e,u,a),Du(e,s,i,u)]),2);case 2:return A(n),E(n,a.destroy(),8);case 8:x(n,0)}})})}(this,e))},Ru.prototype.remove=Ru.prototype.remove,Ru.prototype.Ff=function(){return Vu(this,(e=this,f(function t(){var n,r,i,a,s,o,u,l,c;return P(t,function(t){switch(t.j){case 1:return Bu(),n=e.b,r=e.a.drm,i=new Gs,a=!1,k(t,2),E(t,i.init(),4);case 4:for(s=[],function(e,t){e.a.forEach(function(e){t(e.getEmeSessionCell())})}(i,function(e){return s.push(e)}),o=Promise.resolve(),u={},l=d(s),c=l.next();!c.done;u={qc:u.qc},c=l.next())u.qc=c.value,o=o.then(function(e){return function(){return f(function t(){var i,s;return P(t,function(t){switch(t.j){case 1:return E(t,e.qc.getAll(),2);case 2:return i=t.s,E(t,go(r,n,i),3);case 3:return s=t.s,E(t,e.qc.remove(s),4);case 4:s.length!=i.length&&(a=!0),S(t)}})})}}(u));return E(t,o,2);case 2:return A(t),E(t,i.destroy(),6);case 6:x(t,3);break;case 3:return t.return(!a)}})})));var e},Ru.prototype.removeEmeSessions=Ru.prototype.Ff,Ru.prototype.list=function(){return Vu(this,f(function e(){var t,n,r;return P(e,function(e){switch(e.j){case 1:return Bu(),t=[],n=new Gs,k(e,2),E(e,n.init(),4);case 4:return r=Promise.resolve(),function(e,t){e.a.forEach(function(e,n){e.getCells().forEach(function(e,r){t({ua:n,aa:r},e)})})}(n,function(e,n){r=r.then(function(){return f(function r(){return P(r,function(r){switch(r.j){case 1:return E(r,n.getAllManifests(),2);case 2:r.s.forEach(function(n,r){var i=Eu(new lo("manifest",e.ua,e.aa,r),n);t.push(i)}),S(r)}})})})}),E(e,r,2);case 2:return A(e),E(e,n.destroy(),6);case 6:x(e,3);break;case 3:return e.return(t)}})}))},Ru.prototype.list=Ru.prototype.list,Ru.deleteAll=function(){return f(function e(){var t;return P(e,function(e){switch(e.j){case 1:return t=new Gs,k(e,2),E(e,t.erase(),2);case 2:return A(e),E(e,t.destroy(),5);case 5:x(e,0)}})})},Bo.offline=Mu,V("shaka.polyfill.installAll",function(){for(var e=0;e<Wu.length;++e)Wu[e].re()});var Ku,Gu,Wu=[];function qu(e,t){for(var n={priority:t=t||0,re:e},r=0;r<Wu.length;r++)if(Wu[r].priority<t)return void Wu.splice(r,0,n);Wu.push(n)}function zu(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var n=new Event(t,e);else(n=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(n)}function Yu(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function Xu(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];return(n=e.apply(this,n)).abort=function(){},n}}function $u(e){var t=e.target,n=t.mediaSource_;if(n.Ed){for(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.wd=!0,e=0;e<n.sourceBuffers.length;++e)if(0==n.sourceBuffers[e].wd)return;n.Ed=!1}}function Qu(e){e=e.target;for(var t=0;t<e.sourceBuffers.length;++t)e.sourceBuffers[t].removeEventListener("updateend",$u,!1);e.removeEventListener("sourceclose",Qu,!1)}function Zu(e,t){try{var n=new Ju(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Ju(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(var n=d(t),r=n.next();!r.done;r=n.next()){var i=r.value;if("required"==i.persistentState)r=null;else{r={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var a=!1,s=!1;if(i.audioCapabilities)for(var o=d(i.audioCapabilities),u=o.next();!u.done;u=o.next())if((u=u.value).contentType){a=!0;var l=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,l)&&(r.audioCapabilities.push(u),s=!0)}if(i.videoCapabilities)for(u=(i=d(i.videoCapabilities)).next();!u.done;u=i.next())(o=u.value).contentType&&(a=!0,u=o.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(r.videoCapabilities.push(o),s=!0));a||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r=s?r:null}if(r)return void(this.a=r)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function el(e){var t=this.mediaKeys;return t&&t!=e&&nl(t,null),delete this.mediaKeys,(this.mediaKeys=e)?nl(e,this):Promise.resolve()}function tl(e){this.b=new WebKitMediaKeys(e),this.a=new He,this.c=null}function nl(e,t){if(e.a.Ya(),!t)return Promise.resolve();e.a.w(t,"webkitneedkey",il);try{return 1<=t.readyState?t.webkitSetMediaKeys(e.b):e.a.ha(t,"loadedmetadata",function(){t.webkitSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function rl(e){Te.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new He,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new sl}function il(e){var t=this.mediaKeys.c,n=new Event("encrypted");n.initDataType="cenc",n.initData=function(e,t){function n(e){new DataView(a.buffer).setUint32(s,e.byteLength,!0),s+=4,a.set(e,s),s+=e.byteLength}var r=new Uint8Array(e);if(new DataView(r.buffer).getUint32(0,!0)+4!=r.byteLength)throw Error("Malformed init data!");var i=rt(r.slice(4),!0);i=new $(i).ra,i=new Uint8Array(st(i,!0));var a=new Uint8Array(r.byteLength+4+i.byteLength+4+t.byteLength),s=0;return a.set(r,s),s+=r.byteLength,n(i),n(new Uint8Array(t)),a}(e.initData,t),this.dispatchEvent(n)}function al(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function sl(){this.size=0,this.a=void 0}function ol(e){this.f=[],this.b=[],this.a=[],(new Zr).ea("pssh",this.c.bind(this)).parse(e.buffer)}function ul(e,t){try{var n=new ll(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function ll(e,t){this.keySystem=e;for(var n=!1,r=0;r<t.length;++r){var i=t[r],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label},s=!1;if(i.audioCapabilities)for(var o=0;o<i.audioCapabilities.length;++o){var u=i.audioCapabilities[o];if(u.contentType){s=!0;var l=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,l)&&(a.audioCapabilities.push(u),n=!0)}}if(i.videoCapabilities)for(o=0;o<i.videoCapabilities.length;++o)(u=i.videoCapabilities[o]).contentType&&(s=!0,l=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,l)&&(a.videoCapabilities.push(u),n=!0));if(s||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function cl(e){var t=this.mediaKeys;return t&&t!=e&&hl(t,null),delete this.mediaKeys,(this.mediaKeys=e)?hl(e,this):Promise.resolve()}function dl(e){this.a=new MSMediaKeys(e),this.b=new He}function hl(e,t){if(e.b.Ya(),!t)return Promise.resolve();e.b.w(t,"msneedkey",pl);var n=e;try{return 1<=t.readyState?t.msSetMediaKeys(e.a):t.addEventListener("loadedmetadata",function e(){t.msSetMediaKeys(n.a),t.removeEventListener("loadedmetadata",e)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function fl(e){Te.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new He,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new vl}function pl(e){if(e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new ol(e);if(1>=t.a.length)return e;for(var n=[],r=0;r<t.a.length;r++)n.push(e.subarray(t.a[r].start,t.a[r].end+1));for(e=[],t={},r=d(n),n=r.next();!n.done;t={fc:t.fc},n=r.next())t.fc=n.value,e.some(function(e){return function(t){return ft(t,e.fc)}}(t))||e.push(t.fc);for(t=0,r=d(e),n=r.next();!n.done;n=r.next())t+=n.value.length;for(t=new Uint8Array(t),r=0,e=d(e),n=e.next();!n.done;n=e.next())n=n.value,t.set(n,r),r+=n.length;return t}(e.initData),this.dispatchEvent(t)}}function ml(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function vl(){this.size=0,this.a=void 0}function yl(){return Promise.reject(Error("The key system specified is not supported."))}function gl(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function _l(){throw new TypeError("Illegal constructor.")}function bl(){throw new TypeError("Illegal constructor.")}V("shaka.polyfill.register",qu),qu(function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",zu),document.addEventListener("webkitfullscreenerror",zu),document.addEventListener("mozfullscreenchange",zu),document.addEventListener("mozfullscreenerror",zu),document.addEventListener("MSFullscreenChange",zu),document.addEventListener("MSFullscreenError",zu)}}),qu(function(){Je("CrKey")&&delete e.indexedDB}),qu(function(){Je("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Yu)}),qu(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),qu(function(){}),qu(function(){if(e.MediaSource)if(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType)!function(){var e=MediaSource.isTypeSupported,t=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(n){for(var r=n.split(/ *; */),i=r[0],a={},s=1;s<r.length;++s){var o=r[s].split("="),u=o[0];o=o[1].replace(/"(.*)"/,"$1"),a[u]=o}if(!(r=a.codecs))return e(n);var l=!1,c=!1;for(var d in n=r.split(",").filter(function(e){return t.test(e)&&(c=!0),/^(hev|hvc)1\.2/.test(e)&&(l=!0),!0}),c&&(l=!1),a.codecs=n.join(","),l&&(a.eotf="smpte2084"),a)i+="; "+d+'="'+a[d]+'"';return cast.__platform__.canDisplayType(i)}}();else if(navigator.vendor&&navigator.vendor.includes("Apple")){var t=navigator.appVersion;!function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),t.includes("Version/8")?e.MediaSource=null:t.includes("Version/9")?Xu():t.includes("Version/10")?(Xu(),function(){var e=MediaSource.prototype.endOfStream;MediaSource.prototype.endOfStream=function(t){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];for(var i=r=0;i<this.sourceBuffers.length;++i){var a=this.sourceBuffers[i];a=a.buffered.end(a.buffered.length-1),r=Math.max(r,a)}if(!isNaN(this.duration)&&r<this.duration)for(this.Ed=!0,r=0;r<this.sourceBuffers.length;++r)this.sourceBuffers[r].wd=!1;return e.apply(this,n)};var t=!1,n=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];return(r=n.apply(this,r)).mediaSource_=this,r.addEventListener("updateend",$u,!1),t||(this.addEventListener("sourceclose",Qu,!1),t=!0),r}}()):(t.includes("Version/11")||t.includes("Version/12"))&&(Xu(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}())}else Je("Tizen")&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=Xe(t)[0]&&e(t)}}()}),Ju.prototype.createMediaKeys=function(){var e=new tl(this.keySystem);return Promise.resolve(e)},Ju.prototype.getConfiguration=function(){return this.a},tl.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new rl(this.b,e)},tl.prototype.setServerCertificate=function(e){return this.c=e?new Uint8Array(e):null,Promise.resolve(!0)},j(rl,Te),(n=rl.prototype).generateRequest=function(e,t){this.a=new pe;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t)),this.f.w(this.c,"webkitkeymessage",this.Wf.bind(this)),this.f.w(this.c,"webkitkeyadded",this.Uf.bind(this)),this.f.w(this.c,"webkitkeyerror",this.Vf.bind(this)),al(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},n.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(e){this.b=new pe;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},n.close=function(){try{this.c.close(),this.closed.resolve(),this.f.Ya()}catch(e){this.closed.reject(e)}return this.closed},n.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.Wf=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ee("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},n.Uf=function(){this.b&&(al(this,"usable"),this.b.resolve(),this.b=null)},n.Vf=function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:al(this,"output-not-allowed");break;default:al(this,"internal-error")}},(n=sl.prototype).forEach=function(e){this.a&&e(this.a,Ku)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=Ku;return!(!this.a||!ft(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},qu(function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(Ku=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=el,e.MediaKeys=tl,e.MediaKeySystemAccess=Ju,navigator.requestMediaKeySystemAccess=Zu)}),ol.prototype.c=function(e){if(!(1<e.version)){var t=ht(e.reader.Xa(16)),n=[];if(0<e.version)for(var r=e.reader.F(),i=0;i<r;++i){var a=ht(e.reader.Xa(16));n.push(a)}r=e.reader.F(),e.reader.L(r),this.b.push.apply(this.b,n),this.f.push(t),this.a.push({start:e.start,end:e.start+e.size-1})}},ll.prototype.createMediaKeys=function(){var e=new dl(this.keySystem);return Promise.resolve(e)},ll.prototype.getConfiguration=function(){return this.a},dl.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new fl(this.a,e)},dl.prototype.setServerCertificate=function(){return Promise.resolve(!1)},j(fl,Te),(n=fl.prototype).generateRequest=function(e,t){this.a=new pe;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.w(this.c,"mskeymessage",this.nf.bind(this)),this.f.w(this.c,"mskeyadded",this.lf.bind(this)),this.f.w(this.c,"mskeyerror",this.mf.bind(this)),ml(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},n.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(e){this.b=new pe;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},n.close=function(){try{this.c.close(),this.closed.resolve(),this.f.Ya()}catch(e){this.closed.reject(e)}return this.closed},n.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.nf=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ee("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},n.lf=function(){this.a?(ml(this,"usable"),this.a.resolve(),this.a=null):this.b&&(ml(this,"usable"),this.b.resolve(),this.b=null)},n.mf=function(){var e=Error("EME PatchedMediaKeysMs key error");if(e.errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:ml(this,"output-not-allowed");break;default:ml(this,"internal-error")}},(n=vl.prototype).forEach=function(e){this.a&&e(this.a,Gu)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=Gu;return!(!this.a||!ft(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},qu(function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Gu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=cl,e.MediaKeys=dl,e.MediaKeySystemAccess=ll,navigator.requestMediaKeySystemAccess=ul)}),_l.prototype.createSession=function(){},_l.prototype.setServerCertificate=function(){},bl.prototype.getConfiguration=function(){},bl.prototype.createMediaKeys=function(){},qu(function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=yl,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=gl,e.MediaKeys=_l,e.MediaKeySystemAccess=bl)},-10);var wl,El="";function Sl(e){return El?El+e.charAt(0).toUpperCase()+e.slice(1):e}function Tl(e,t){try{var n=new Cl(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function kl(e){var t=this.mediaKeys;return t&&t!=e&&Al(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Al(e,this),Promise.resolve()}function Cl(e,t){this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var a=0;a<t.length;++a){var s=t[a],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},u=!1;if(s.audioCapabilities)for(var l=0;l<s.audioCapabilities.length;++l){var c=s.audioCapabilities[l];if(c.contentType){u=!0;var d=c.contentType.split(";")[0];i.canPlayType(d,this.a)&&(o.audioCapabilities.push(c),r=!0)}}if(s.videoCapabilities)for(l=0;l<s.videoCapabilities.length;++l)(c=s.videoCapabilities[l]).contentType&&(u=!0,i.canPlayType(c.contentType,this.a)&&(o.videoCapabilities.push(c),r=!0));if(u||(r=i.canPlayType("video/mp4",this.a)||i.canPlayType("video/webm",this.a)),"required"==s.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):r=!1),r)return void(this.b=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Il(e){this.g=e,this.b=null,this.a=new He,this.c=[],this.f={}}function Al(e,t){e.b=t,e.a.Ya();var n=El;t&&(e.a.w(t,n+"needkey",e.tf.bind(e)),e.a.w(t,n+"keymessage",e.Zf.bind(e)),e.a.w(t,n+"keyadded",e.Xf.bind(e)),e.a.w(t,n+"keyerror",e.Yf.bind(e)))}function xl(e,t){var n=e.f[t];return n||((n=e.c.shift())?(n.sessionId=t,e.f[t]=n):null)}function Ll(e,t,n){Te.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new pe,this.keyStatuses=new Ml}function Nl(e,t,n){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(n)var r=new Uint8Array(at("LOAD_SESSION|"+n));else{var i=at("PERSISTENT|"),a=new Uint8Array(i.byteLength+t.byteLength);a.set(new Uint8Array(i),0),a.set(new Uint8Array(t),i.byteLength),r=a}else r=new Uint8Array(t)}catch(e){return Promise.reject(e)}e.b=new pe;var s=Sl("generateKeyRequest");try{e.f[s](e.c,r)}catch(t){if("InvalidStateError"!=t.name)return e.b=null,Promise.reject(t);new ce(function(){try{e.f[s](e.c,r)}catch(t){e.b.reject(t),e.b=null}}).O(.01)}return e.b}function Rl(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function Ml(){this.size=0,this.a=void 0}function Pl(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Ol(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Dl(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Ul(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Fl(t,n,r){return new e.TextTrackCue(t,n,r)}function Bl(t,n,r){return new e.TextTrackCue(t+"-"+n+"-"+r,t,n,r)}function Vl(){}Cl.prototype.createMediaKeys=function(){var e=new Il(this.a);return Promise.resolve(e)},Cl.prototype.getConfiguration=function(){return this.b},(n=Il.prototype).createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Ll(t,this.g,e),this.c.push(e),e},n.setServerCertificate=function(){return Promise.resolve(!1)},n.tf=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.b.dispatchEvent(t)},n.Zf=function(e){var t=xl(this,e.sessionId);t&&(e=new Ee("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e))},n.Xf=function(e){(e=xl(this,e.sessionId))&&(Rl(e,"usable"),e.a&&e.a.resolve(),e.a=null)},n.Yf=function(e){var t=xl(this,e.sessionId);t&&t.handleError(e)},j(Ll,Te),(n=Ll.prototype).handleError=function(e){var t=Error("EME v0.1b key error");t.errorCode=e.errorCode,t.errorCode.systemCode=e.systemCode,!e.sessionId&&this.b?(t.method="generateRequest",45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(t.method="update",this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Rl(this,"output-restricted"):Rl(this,1==t?"expired":"internal-error"))},n.md=function(e,t){if(this.a)this.a.then(this.md.bind(this,e,t)).catch(this.md.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var n=nt(t),r=JSON.parse(n);"oct"!=r.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=ct(r.keys[0].k),r=ct(r.keys[0].kid)}else n=new Uint8Array(t),r=null;var i=Sl("addKey");try{this.f[i](this.c,n,r,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},n.generateRequest=function(e,t){return Nl(this,t,null)},n.load=function(e){return"persistent-license"==this.g?Nl(this,null,e):Promise.reject(Error("Not a persistent session."))},n.update=function(e){var t=new pe;return this.md(t,e),t},n.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Sl("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},n.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(n=Ml.prototype).forEach=function(e){this.a&&e(this.a,wl)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=wl;return!(!this.a||!ft(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},qu(function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)El="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;wl=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Tl,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=kl,e.MediaKeys=Il,e.MediaKeySystemAccess=Cl}}),qu(function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Ol,document.exitPictureInPicture=Dl,document.addEventListener("webkitpresentationmodechanged",Pl,!0))}}),qu(function(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}),qu(function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Ul)}}),qu(function(){if(!e.VTTCue&&e.TextTrackCue){var t=TextTrackCue.length;if(3==t)e.VTTCue=Fl;else if(6==t)e.VTTCue=Bl;else{try{var n=!!Fl(1,2,"")}catch(e){n=!1}n&&(e.VTTCue=Fl)}}}),Vl.prototype.parseInit=function(){},Vl.prototype.parseMedia=function(e,t){var n=nt(e),r=[],i=new DOMParser,a=null;try{a=i.parseFromString(n,"text/xml")}catch(e){throw new fe(2,2,2005)}if(a){if(!(a=a.getElementsByTagName("tt")[0]))throw new fe(2,2,2005);var s=Dr.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","frameRate"),o=Dr.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Dr.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),l=Dr.getAttributeNS(a,"http://www.w3.org/ns/ttml#parameter","tickRate");if(n=a.getAttribute("xml:space")||"default",i=a.getAttribute("tts:extent"),"default"!=n&&"preserve"!=n)throw new fe(2,2,2005);n="default"==n,s=new oc(s,o,u,l),o=Zl(a.getElementsByTagName("metadata")[0]),u=Zl(a.getElementsByTagName("styling")[0]),l=Zl(a.getElementsByTagName("layout")[0]);for(var c=[],d=0;d<l.length;d++){var h,f,p=l[d],m=u,v=i,y=new cn,g=p.getAttribute("xml:id");if(g)y.id=g,g=null,v&&(g=jl.exec(v)||Kl.exec(v)),v=g?Number(g[1]):null,g=g?Number(g[2]):null,(h=nc(p,m,"extent"))&&(null!=(h=(f=jl.exec(h))||Kl.exec(h))&&(y.width=null!=v?100*Number(h[1])/v:Number(h[1]),y.height=null!=g?100*Number(h[2])/g:Number(h[2]),y.widthUnits=f||null!=v?dn:0,y.heightUnits=f||null!=g?dn:0)),(p=nc(p,m,"origin"))&&(null!=(h=(f=jl.exec(p))||Kl.exec(p))&&(y.viewportAnchorX=null!=g?100*Number(h[1])/g:Number(h[1]),y.viewportAnchorY=null!=v?100*Number(h[2])/v:Number(h[2]),y.viewportAnchorUnits=f||null!=v?dn:0));else y=null;y&&c.push(y)}for(i=Zl(a.getElementsByTagName("body")[0]),a=0;a<i.length;a++)(d=Jl(i[a],t.periodStart,s,o,u,l,c,n))&&r.push(d)}return r};var jl=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,Hl=/^(\d+px|\d+em)$/,Kl=/^(\d+)px (\d+)px$/,Gl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Wl=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,ql=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,zl=/^(\d*(?:\.\d*)?)f$/,Yl=/^(\d*(?:\.\d*)?)t$/,Xl=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,$l={left:an,center:"center",right:"end",start:an,end:"end"},Ql={left:"line-left",center:"center",right:"line-right"};function Zl(e){var t=[];if(!e)return t;for(var n=e.childNodes,r=0;r<n.length;r++){var i="span"==n[r].nodeName&&"p"==e.nodeName;n[r].nodeType!=Node.ELEMENT_NODE||"br"==n[r].nodeName||i||(i=Zl(n[r]),t=t.concat(i))}return t.length||t.push(e),t}function Jl(e,t,n,r,i,a,s,o){if(!e.hasAttribute("begin")&&!e.hasAttribute("end")&&/^\s*$/.test(e.textContent))return null;!function e(t,n){for(var r=t.childNodes,i=0;i<r.length;i++)if("br"==r[i].nodeName&&0<i)r[i-1].textContent+="\n";else if(0<r[i].childNodes.length)e(r[i],n);else if(n){var a=r[i].textContent.trim();a=a.replace(/\s+/g," "),r[i].textContent=a}}(e,o),o=ac(e.getAttribute("begin"),n);var u=ac(e.getAttribute("end"),n);n=ac(e.getAttribute("dur"),n);var l=e.textContent;if(null==u&&null!=n&&(u=o+n),null==o||null==u)throw new fe(2,2,2001);if(t=new Xt(o+t,u+t,l),(a=ic(e,"region",a,""))&&a.getAttribute("xml:id")){var c=a.getAttribute("xml:id");s=s.filter(function(e){return e.id==c}),t.region=s[0]}return function(e,t,n,r,i){"rtl"==tc(t,n,i,"direction")&&(e.direction="rtl");var a=tc(t,n,i,"writingMode");"tb"==a||"tblr"==a?e.writingMode="vertical-lr":"tbrl"==a?e.writingMode="vertical-rl":"rltb"==a||"rl"==a?e.direction="rtl":a&&(e.direction=tn),(a=tc(t,n,i,"textAlign"))&&(e.positionAlign=Ql[a],e.lineAlign=$l[a],e.textAlign=Zt[a.toUpperCase()]);(a=tc(t,n,i,"displayAlign"))&&(e.displayAlign=en[a.toUpperCase()]);(a=tc(t,n,i,"color"))&&(e.color=a);(a=tc(t,n,i,"backgroundColor"))&&(e.backgroundColor=a);(a=tc(t,n,i,"fontFamily"))&&(e.fontFamily=a);(a=tc(t,n,i,"fontWeight"))&&"bold"==a&&(e.fontWeight=700),(a=tc(t,n,i,"wrapOption"))&&"noWrap"==a&&(e.wrapLine=!1),(a=tc(t,n,i,"lineHeight"))&&a.match(Hl)&&(e.lineHeight=a),(a=tc(t,n,i,"fontSize"))&&a.match(Hl)&&(e.fontSize=a),(a=tc(t,n,i,"fontStyle"))&&(e.fontStyle=ln[a.toUpperCase()]);if(r){a=r.getAttribute("imagetype");var s=r.getAttribute("encoding");r=r.textContent.trim(),"PNG"==a&&"Base64"==s&&r&&(e.backgroundImage="data:image/png;base64,"+r)}(n=nc(n,i,"textDecoration"))&&ec(e,n),(t=rc(t,i,"textDecoration"))&&ec(e,t)}(t,e,a,r=ic(e,"smpte:backgroundImage",r,"#"),i),t}function ec(e,t){for(var n=t.split(" "),r=0;r<n.length;r++)switch(n[r]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ie(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ie(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ie(e.textDecoration,"overline")}}function tc(e,t,n,r){return(e=rc(e,n,r))?e:nc(t,n,r)}function nc(e,t,n){for(var r=Zl(e),i=0;i<r.length;i++){var a=Dr.getAttributeNS(r[i],"http://www.w3.org/ns/ttml#styling",n);if(a)return a}return(e=ic(e,"style",t,""))?Dr.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n):null}function rc(e,t,n){return(e=ic(e,"style",t,""))?Dr.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n):null}function ic(e,t,n,r){if(!e||1>n.length)return null;var i=null,a=e;for(e=null;a&&!(e=a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(e=0;e<n.length;e++)if(r+n[e].getAttribute("xml:id")==t){i=n[e];break}return i}function ac(e,t){var n=null;if(Gl.test(e)){n=Gl.exec(e);var r=Number(n[1]),i=Number(n[2]),a=Number(n[3]),s=Number(n[4]);n=(a+=(s+=(Number(n[5])||0)/t.b)/t.frameRate)+60*i+3600*r}else Wl.test(e)?n=sc(Wl,e):ql.test(e)?n=sc(ql,e):zl.test(e)?(n=zl.exec(e),n=Number(n[1])/t.frameRate):Yl.test(e)?(n=Yl.exec(e),n=Number(n[1])/t.a):Xl.test(e)&&(n=sc(Xl,e));return n}function sc(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function oc(e,t,n,r){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(r),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function uc(){this.a=new Vl}function lc(){}function cc(e,t,n){var r;(r=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=r[1],e.textAlign="middle"==t?Qt:Zt[t.toUpperCase()]):(r=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==r[1]?"vertical-lr":"vertical-rl":(r=/^size:([\d.]+)%$/.exec(t))?e.size=Number(r[1]):(r=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(r[1]),r[2]&&(t=r[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(r=/^region:(.*)$/.exec(t))?(t=function(e,t){var n=e.filter(function(e){return e.id==t});return n.length?n[0]:null}(n,r[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=sn[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=rn,e.line=Number(n[1]),n[2]&&(e.lineAlign=sn[n[2].toUpperCase()]))}function dc(e){if(null==(e=ji(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function hc(){this.a=null}function fc(e,t,n){var r,i,a;return(new Zr).H("payl",ti(function(e){r=nt(e)})).H("iden",ti(function(e){i=nt(e)})).H("sttg",ti(function(e){a=nt(e)})).parse(e),r?function(e,t,n,r,i){if(e=new Xt(r,i,e),t&&(e.id=t),n)for(t=new Bi(n),n=Hi(t);n;)cc(e,n,[]),Vi(t),n=Hi(t);return e}(r,i,a,t,n):null}pn["application/ttml+xml"]=Vl,uc.prototype.parseInit=function(e){var t=!1;if((new Zr).H("moov",Jr).H("trak",Jr).H("mdia",Jr).H("minf",Jr).H("stbl",Jr).ea("stsd",ei).H("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new fe(2,2,2007)},uc.prototype.parseMedia=function(e,t){var n=!1,r=[];if((new Zr).H("mdat",ti(function(e){n=!0,r=r.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new fe(2,2,2007);return r},pn['application/mp4; codecs="stpp"']=uc,pn['application/mp4; codecs="stpp.TTML.im1t"']=uc,lc.prototype.parseInit=function(){},lc.prototype.parseMedia=function(e,t){var n=nt(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new fe(2,2,2e3);var r=t.segmentStart;if(null==r&&(r=0,n[0].includes("X-TIMESTAMP-MAP"))){var i=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(i&&a){if(null==(r=dc(new Bi(i[1]))))throw new fe(2,2,2e3);r=t.periodStart+(Number(a[1])/9e4-r)}}a=[];var s=n[0].split("\n");for(i=1;i<s.length;i++)if(/^Region:/.test(s[i])){var o=new Bi(s[i]),u=new cn;Hi(o),Vi(o);for(var l=Hi(o);l;){var c=u,d=l;(l=/^id=(.*)$/.exec(d))?c.id=l[1]:(l=/^width=(\d{1,2}|100)%$/.exec(d))?c.width=Number(l[1]):(l=/^lines=(\d+)$/.exec(d))?(c.height=Number(l[1]),c.heightUnits=2):(l=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.regionAnchorX=Number(l[1]),c.regionAnchorY=Number(l[2])):(l=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.viewportAnchorX=Number(l[1]),c.viewportAnchorY=Number(l[2])):/^scroll=up$/.exec(d)&&(c.scroll="up"),Vi(o),l=Hi(o)}a.push(u)}for(i=[],o=1;o<n.length;o++){if(l=s=n[o].split("\n"),d=r,s=a,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0])s=null;else{u=null,l[0].includes("--\x3e")||(u=l[0],l.splice(0,1));var h=dc(c=new Bi(l[0])),f=ji(c,/[ \t]+--\x3e[ \t]+/g),p=dc(c);if(null==h||null==f||null==p)throw new fe(2,2,2001);for(l=new Xt(h+d,p+d,l.slice(1).join("\n").trim()),Vi(c),d=Hi(c);d;)cc(l,d,s),Vi(c),d=Hi(c);null!=u&&(l.id=u),s=l}s&&i.push(s)}return i},pn["text/vtt"]=lc,pn['text/vtt; codecs="vtt"']=lc,hc.prototype.parseInit=function(e){var t=!1;if((new Zr).H("moov",Jr).H("trak",Jr).H("mdia",Jr).ea("mdhd",function(e){0==e.version?(e.reader.L(4),e.reader.L(4),this.a=e.reader.F(),e.reader.L(4)):(e.reader.L(8),e.reader.L(8),this.a=e.reader.F(),e.reader.L(8)),e.reader.L(4)}.bind(this)).H("minf",Jr).H("stbl",Jr).ea("stsd",ei).H("wvtt",function(){t=!0}).parse(e),!this.a)throw new fe(2,2,2008);if(!t)throw new fe(2,2,2008)},hc.prototype.parseMedia=function(e,t){var n=this;if(!this.a)throw new fe(2,2,2008);var r,i=0,a=[],s=[],o=!1,u=!1,l=!1,c=null;if((new Zr).H("moof",Jr).H("traf",Jr).ea("tfdt",function(e){o=!0,i=0==e.version?e.reader.F():e.reader.yb()}).ea("tfhd",function(e){var t=e.flags;(e=e.reader).L(4),1&t&&e.L(8),2&t&&e.L(4),c=8&t?e.F():null}).ea("trun",function(e){u=!0;var t=e.version,n=e.flags,r=(e=e.reader).F();1&n&&e.L(4),4&n&&e.L(4);for(var i=[],s=0;s<r;s++){var o={duration:null,sampleSize:null,od:null};256&n&&(o.duration=e.F()),512&n&&(o.sampleSize=e.F()),1024&n&&e.L(4),2048&n&&(o.od=0==t?e.F():e.Xd()),i.push(o)}a=i}).H("mdat",ti(function(e){l=!0,r=e})).parse(e),!l&&!o&&!u)throw new fe(2,2,2008);var d=i,h=new Yr(new DataView(r.buffer,r.byteOffset,r.byteLength),0);return a.forEach(function(e){var r=e.duration||c,a=e.od?i+e.od:d;d=a+(r||0);var o=0;do{var u=h.F();o+=u;var l=null;"vttc"==ri(h.F())?8<u&&(l=h.Xa(u-8)):h.L(u-8),r&&l&&s.push(fc(l,t.periodStart+a/n.a,t.periodStart+d/n.a))}while(e.sampleSize&&o<e.sampleSize)}),s.filter(jt.Ga)},pn['application/mp4; codecs="wvtt"']=hc,V("shaka.util.Dom.createHTMLElement",function(e){return document.createElement(e)}),V("shaka.util.Dom.createVideoElement",function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}),V("shaka.util.Dom.asHTMLElement",function(e){return e}),V("shaka.util.Dom.asHTMLMediaElement",function(e){return e}),V("shaka.util.Dom.removeAllChildren",function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})}.call(r,n,n),r.shaka)t[i]=r.shaka[i]}()}).call(this,n(4))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__2__},function(module,__webpack_exports__,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */__webpack_require__.d(__webpack_exports__,"a",function(){return ShakaDemoUtils});var ShakaDemoUtils=function(){function ShakaDemoUtils(){_classCallCheck(this,ShakaDemoUtils)}return _createClass(ShakaDemoUtils,null,[{key:"runThroughHashParams",value:function(e,t){var n=[],r=function(t,r){n.push(r),e(t,r)};r("audiolang","preferredAudioLanguage"),r("textlang","preferredTextLanguage"),r("channels","preferredAudioChannelCount"),n.push("abr.enabled"),n.push("streaming.jumpLargeGaps"),n.push("drm.advanced"),n.push("drm.servers");var i=[],a=[];!function e(t){for(var n in t){i.includes(n)&&!a.includes(n)&&a.push(n),i.push(n);var r=t[n];"number"!=typeof r&&"string"!=typeof r&&"boolean"!=typeof r&&e(r)}}(t);!function t(r,i){for(var s in r){var o=s,u=i+s;if(!n.includes(u)){a.includes(s)&&(o=u);var l=r[s];"number"==typeof l||"string"==typeof l||"boolean"==typeof l?e(o,u):t(l,u+".")}}}(t,"")}},{key:"browserSupportsUncompiledMode",value:function browserSupportsUncompiledMode(){try{return eval("async ()=>{}"),!0}catch(e){return!1}}}]),ShakaDemoUtils}()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){!function(){function t(e){var t=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};this.label=t.label||t.value,this.value=t.value}function n(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function r(e,t){return s.call((t||document).querySelectorAll(e))}function i(){r("input.awesomplete").forEach(function(e){new a(e)})}var a=function(e,t){var r=this;Awesomplete.count=(Awesomplete.count||0)+1,this.count=Awesomplete.count,this.isOpened=!1,this.input=n(e),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns","awesomplete_list_"+this.count),this.input.setAttribute("role","combobox"),t=t||{},function(e,t,n){for(var r in t){var i=t[r],a=e.input.getAttribute("data-"+r.toLowerCase());"number"==typeof i?e[r]=parseInt(a):!1===i?e[r]=null!==a:i instanceof Function?e[r]=null:e[r]=a,e[r]||0===e[r]||(e[r]=r in n?n[r]:i)}}(this,{minChars:2,maxItems:10,autoFirst:!1,data:a.DATA,filter:a.FILTER_CONTAINS,sort:!1!==t.sort&&a.SORT_BYLENGTH,item:a.ITEM,replace:a.REPLACE},t),this.index=-1,this.container=n.create("div",{className:"awesomplete",around:e}),this.ul=n.create("ul",{hidden:"hidden",role:"listbox",id:"awesomplete_list_"+this.count,inside:this.container}),this.status=n.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!=this.minChars?"Type "+this.minChars+" or more characters for results.":"Begin typing for results."}),this._events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown:function(e){var t=e.keyCode;r.opened&&(13===t&&r.selected?(e.preventDefault(),r.select()):27===t?r.close({reason:"esc"}):38!==t&&40!==t||(e.preventDefault(),r[38===t?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown:function(e){e.preventDefault()},click:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),r.select(t,e.target))}}}},n.bind(this.input,this._events.input),n.bind(this.input.form,this._events.form),n.bind(this.ul,this._events.ul),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||t.list||[],a.all.push(this)};a.prototype={set list(e){if(Array.isArray(e))this._list=e;else if("string"==typeof e&&e.indexOf(",")>-1)this._list=e.split(/\s*,\s*/);else if((e=n(e))&&e.children){var t=[];s.apply(e.children).forEach(function(e){if(!e.disabled){var n=e.textContent.trim(),r=e.value||n,i=e.label||n;""!==r&&t.push({label:i,value:r})}}),this._list=t}document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return this.isOpened},close:function(e){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),n.fire(this.input,"awesomplete-close",e||{}))},open:function(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),n.fire(this.input,"awesomplete-open")},destroy:function(){n.unbind(this.input,this._events.input),n.unbind(this.input.form,this._events.form);var e=this.container.parentNode;e.insertBefore(this.input,this.container),e.removeChild(this.container),this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");var t=a.all.indexOf(this);-1!==t&&a.all.splice(t,1)},next:function(){var e=this.ul.children.length;this.goto(this.index<e-1?this.index+1:e?0:-1)},previous:function(){var e=this.ul.children.length,t=this.index-1;this.goto(this.selected&&-1!==t?t:e-1)},goto:function(e){var t=this.ul.children;this.selected&&t[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&t.length>0&&(t[e].setAttribute("aria-selected","true"),this.status.textContent=t[e].textContent+", list item "+(e+1)+" of "+t.length,this.input.setAttribute("aria-activedescendant",this.ul.id+"_item_"+this.index),this.ul.scrollTop=t[e].offsetTop-this.ul.clientHeight+t[e].clientHeight,n.fire(this.input,"awesomplete-highlight",{text:this.suggestions[this.index]}))},select:function(e,t){if(e?this.index=n.siblingIndex(e):e=this.ul.children[this.index],e){var r=this.suggestions[this.index];n.fire(this.input,"awesomplete-select",{text:r,origin:t||e})&&(this.replace(r),this.close({reason:"select"}),n.fire(this.input,"awesomplete-selectcomplete",{text:r}))}},evaluate:function(){var e=this,n=this.input.value;n.length>=this.minChars&&this._list&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.map(function(r){return new t(e.data(r,n))}).filter(function(t){return e.filter(t,n)}),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems),this.suggestions.forEach(function(t,r){e.ul.appendChild(e.item(t,n,r))}),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=this.ul.children.length+" results found")):(this.close({reason:"nomatches"}),this.status.textContent="No results found")}},a.all=[],a.FILTER_CONTAINS=function(e,t){return RegExp(n.regExpEscape(t.trim()),"i").test(e)},a.FILTER_STARTSWITH=function(e,t){return RegExp("^"+n.regExpEscape(t.trim()),"i").test(e)},a.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:e<t?-1:1},a.ITEM=function(e,t,r){return n.create("li",{innerHTML:""===t.trim()?e:e.replace(RegExp(n.regExpEscape(t.trim()),"gi"),"<mark>$&</mark>"),"aria-selected":"false",id:"awesomplete_list_"+this.count+"_item_"+r})},a.REPLACE=function(e){this.input.value=e.value},a.DATA=function(e){return e},Object.defineProperty(t.prototype=Object.create(String.prototype),"length",{get:function(){return this.label.length}}),t.prototype.toString=t.prototype.valueOf=function(){return""+this.label};var s=Array.prototype.slice;n.create=function(e,t){var r=document.createElement(e);for(var i in t){var a=t[i];if("inside"===i)n(a).appendChild(r);else if("around"===i){var s=n(a);s.parentNode.insertBefore(r,s),r.appendChild(s)}else i in r?r[i]=a:r.setAttribute(i,a)}return r},n.bind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.addEventListener(t,r)})}},n.unbind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.removeEventListener(t,r)})}},n.fire=function(e,t,n){var r=document.createEvent("HTMLEvents");for(var i in r.initEvent(t,!0,!0),n)r[i]=n[i];return e.dispatchEvent(r)},n.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},n.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?i():document.addEventListener("DOMContentLoaded",i)),a.$=n,a.$$=r,"undefined"!=typeof self&&(self.Awesomplete=a),e.exports&&(e.exports=a)}()},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__6__},function(e){e.exports={FULL_SCREEN:"Full screen",EXIT_FULL_SCREEN:"Exit full screen",FAST_FORWARD:"Fast-forward",REWIND:"Rewind",MUTE:"Mute",UNMUTE:"Unmute",PAUSE:"Pause",PLAY:"Play",SEEK:"Seek",VOLUME:"Volume",SKIP_TO_LIVE:"Skip ahead to live",LIVE:"Live",MORE_SETTINGS:"More settings",BACK:"Back",CAPTIONS:"Captions",RESOLUTION:"Resolution",AUTO_QUALITY:"Auto",CAST:"Cast...",LANGUAGE:"Language",UNRECOGNIZED_LANGUAGE:"Unrecognized",UNDETERMINED_LANGUAGE:"Undetermined",MULTIPLE_LANGUAGES:"Multiple languages",NOT_APPLICABLE:"Not applicable",ENTER_PICTURE_IN_PICTURE:"Enter Picture-in-Picture",EXIT_PICTURE_IN_PICTURE:"Exit Picture-in-Picture",PICTURE_IN_PICTURE:"Picture-in-Picture",ON:"On",OFF:"Off"}},function(e,t,n){},function(e,t,n){},function(e,t){
/**
 * material-design-lite - Material Design Components in CSS, JS and HTML
 * @version v1.3.0
 * @license Apache-2.0
 * @copyright 2015 Google, Inc.
 * @link https://github.com/google/material-design-lite
 */
!function(){"use strict";function e(e,t){if(e){if(t.element_.classList.contains(t.CssClasses_.MDL_JS_RIPPLE_EFFECT)){var n=document.createElement("span");n.classList.add(t.CssClasses_.MDL_RIPPLE_CONTAINER),n.classList.add(t.CssClasses_.MDL_JS_RIPPLE_EFFECT);var r=document.createElement("span");r.classList.add(t.CssClasses_.MDL_RIPPLE),n.appendChild(r),e.appendChild(n)}e.addEventListener("click",function(n){if("#"===e.getAttribute("href").charAt(0)){n.preventDefault();var r=e.href.split("#")[1],i=t.element_.querySelector("#"+r);t.resetTabState_(),t.resetPanelState_(),e.classList.add(t.CssClasses_.ACTIVE_CLASS),i.classList.add(t.CssClasses_.ACTIVE_CLASS)}})}}function t(e,t,n,r){function i(){var i=e.href.split("#")[1],a=r.content_.querySelector("#"+i);r.resetTabState_(t),r.resetPanelState_(n),e.classList.add(r.CssClasses_.IS_ACTIVE),a.classList.add(r.CssClasses_.IS_ACTIVE)}if(r.tabBar_.classList.contains(r.CssClasses_.JS_RIPPLE_EFFECT)){var a=document.createElement("span");a.classList.add(r.CssClasses_.RIPPLE_CONTAINER),a.classList.add(r.CssClasses_.JS_RIPPLE_EFFECT);var s=document.createElement("span");s.classList.add(r.CssClasses_.RIPPLE),a.appendChild(s),e.appendChild(a)}r.tabBar_.classList.contains(r.CssClasses_.TAB_MANUAL_SWITCH)||e.addEventListener("click",function(t){"#"===e.getAttribute("href").charAt(0)&&(t.preventDefault(),i())}),e.show=i}var n={upgradeDom:function(e,t){},upgradeElement:function(e,t){},upgradeElements:function(e){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(e,t){},register:function(e){},downgradeElements:function(e){}};(n=function(){function e(e,t){for(var n=0;n<o.length;n++)if(o[n].className===e)return void 0!==t&&(o[n]=t),o[n];return!1}function t(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function n(e,n){return-1!==t(e).indexOf(n)}function r(e,t,n){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(e,{bubbles:t,cancelable:n});var r=document.createEvent("Events");return r.initEvent(e,t,n),r}function i(t,n){if(void 0===t&&void 0===n)for(var r=0;r<o.length;r++)i(o[r].className,o[r].cssClass);else{var s=t;if(void 0===n){var u=e(s);u&&(n=u.cssClass)}for(var l=document.querySelectorAll("."+n),c=0;c<l.length;c++)a(l[c],s)}}function a(i,a){if(!("object"==typeof i&&i instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var s=r("mdl-componentupgrading",!0,!0);if(i.dispatchEvent(s),!s.defaultPrevented){var c=t(i),d=[];if(a)n(i,a)||d.push(e(a));else{var h=i.classList;o.forEach(function(e){h.contains(e.cssClass)&&-1===d.indexOf(e)&&!n(i,e.className)&&d.push(e)})}for(var f,p=0,m=d.length;p<m;p++){if(!(f=d[p]))throw new Error("Unable to find a registered component for the given class.");c.push(f.className),i.setAttribute("data-upgraded",c.join(","));var v=new f.classConstructor(i);v[l]=f,u.push(v);for(var y=0,g=f.callbacks.length;y<g;y++)f.callbacks[y](i);f.widget&&(i[f.className]=v);var _=r("mdl-componentupgraded",!0,!1);i.dispatchEvent(_)}}}function s(e){if(e){var t=u.indexOf(e);u.splice(t,1);var n=e.element_.getAttribute("data-upgraded").split(","),i=n.indexOf(e[l].classAsString);n.splice(i,1),e.element_.setAttribute("data-upgraded",n.join(","));var a=r("mdl-componentdowngraded",!0,!1);e.element_.dispatchEvent(a)}}var o=[],u=[],l="mdlComponentConfigInternal_";return{upgradeDom:i,upgradeElement:a,upgradeElements:function e(t){Array.isArray(t)||(t=t instanceof Element?[t]:Array.prototype.slice.call(t));for(var n,r=0,i=t.length;r<i;r++)(n=t[r])instanceof HTMLElement&&(a(n),n.children.length>0&&e(n.children))},upgradeAllRegistered:function(){for(var e=0;e<o.length;e++)i(o[e].className)},registerUpgradedCallback:function(t,n){var r=e(t);r&&r.callbacks.push(n)},register:function(t){var n=!0;void 0===t.widget&&void 0===t.widget||(n=t.widget||t.widget);var r={classConstructor:t.constructor||t.constructor,className:t.classAsString||t.classAsString,cssClass:t.cssClass||t.cssClass,widget:n,callbacks:[]};if(o.forEach(function(e){if(e.cssClass===r.cssClass)throw new Error("The provided cssClass has already been registered: "+e.cssClass);if(e.className===r.className)throw new Error("The provided className has already been registered")}),t.constructor.prototype.hasOwnProperty(l))throw new Error("MDL component classes must not have "+l+" defined as a property.");e(t.classAsString,r)||o.push(r)},downgradeElements:function(e){var t=function(e){u.filter(function(t){return t.element_===e}).forEach(s)};if(e instanceof Array||e instanceof NodeList)for(var n=0;n<e.length;n++)t(e[n]);else{if(!(e instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");t(e)}}}}()).ComponentConfigPublic,n.ComponentConfig,n.Component,n.upgradeDom=n.upgradeDom,n.upgradeElement=n.upgradeElement,n.upgradeElements=n.upgradeElements,n.upgradeAllRegistered=n.upgradeAllRegistered,n.registerUpgradedCallback=n.registerUpgradedCallback,n.register=n.register,n.downgradeElements=n.downgradeElements,window.componentHandler=n,window.componentHandler=n,window.addEventListener("load",function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),n.upgradeAllRegistered()):(n.upgradeElement=function(){},n.register=function(){})}),Date.now||(Date.now=function(){return(new Date).getTime()},Date.now=Date.now);for(var r=["webkit","moz"],i=0;i<r.length&&!window.requestAnimationFrame;++i){var a=r[i];window.requestAnimationFrame=window[a+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a+"CancelAnimationFrame"]||window[a+"CancelRequestAnimationFrame"],window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var s=0;window.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(s+16,t);return setTimeout(function(){e(s=n)},n-t)},window.cancelAnimationFrame=clearTimeout,window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}var o=function(e){this.element_=e,this.init()};window.MaterialButton=o,o.prototype.Constant_={},o.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},o.prototype.blurHandler_=function(e){e&&this.element_.blur()},o.prototype.disable=function(){this.element_.disabled=!0},o.prototype.disable=o.prototype.disable,o.prototype.enable=function(){this.element_.disabled=!1},o.prototype.enable=o.prototype.enable,o.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),e.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(e)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},n.register({constructor:o,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0});var u=function(e){this.element_=e,this.init()};window.MaterialCheckbox=u,u.prototype.Constant_={TINY_TIMEOUT:.001},u.prototype.CssClasses_={INPUT:"mdl-checkbox__input",BOX_OUTLINE:"mdl-checkbox__box-outline",FOCUS_HELPER:"mdl-checkbox__focus-helper",TICK_OUTLINE:"mdl-checkbox__tick-outline",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-checkbox__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded"},u.prototype.onChange_=function(e){this.updateClasses_()},u.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},u.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},u.prototype.onMouseUp_=function(e){this.blur_()},u.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},u.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},u.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},u.prototype.checkToggleState=u.prototype.checkToggleState,u.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},u.prototype.checkDisabled=u.prototype.checkDisabled,u.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},u.prototype.disable=u.prototype.disable,u.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},u.prototype.enable=u.prototype.enable,u.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},u.prototype.check=u.prototype.check,u.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},u.prototype.uncheck=u.prototype.uncheck,u.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("span");e.classList.add(this.CssClasses_.BOX_OUTLINE);var t=document.createElement("span");t.classList.add(this.CssClasses_.FOCUS_HELPER);var n=document.createElement("span");if(n.classList.add(this.CssClasses_.TICK_OUTLINE),e.appendChild(n),this.element_.appendChild(t),this.element_.appendChild(e),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(r),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementMouseUp),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:u,classAsString:"MaterialCheckbox",cssClass:"mdl-js-checkbox",widget:!0});var l=function(e){this.element_=e,this.init()};window.MaterialIconToggle=l,l.prototype.Constant_={TINY_TIMEOUT:.001},l.prototype.CssClasses_={INPUT:"mdl-icon-toggle__input",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-icon-toggle__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},l.prototype.onChange_=function(e){this.updateClasses_()},l.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},l.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},l.prototype.onMouseUp_=function(e){this.blur_()},l.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},l.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},l.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},l.prototype.checkToggleState=l.prototype.checkToggleState,l.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},l.prototype.checkDisabled=l.prototype.checkDisabled,l.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},l.prototype.disable=l.prototype.disable,l.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},l.prototype.enable=l.prototype.enable,l.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},l.prototype.check=l.prototype.check,l.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},l.prototype.uncheck=l.prototype.uncheck,l.prototype.init=function(){if(this.element_){if(this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.element_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.JS_RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(e),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementOnMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementOnMouseUp),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},n.register({constructor:l,classAsString:"MaterialIconToggle",cssClass:"mdl-js-icon-toggle",widget:!0});var c=function(e){this.element_=e,this.init()};window.MaterialMenu=c,c.prototype.Constant_={TRANSITION_DURATION_SECONDS:.3,TRANSITION_DURATION_FRACTION:.8,CLOSE_TIMEOUT:150},c.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32,UP_ARROW:38,DOWN_ARROW:40},c.prototype.CssClasses_={CONTAINER:"mdl-menu__container",OUTLINE:"mdl-menu__outline",ITEM:"mdl-menu__item",ITEM_RIPPLE_CONTAINER:"mdl-menu__item-ripple-container",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_UPGRADED:"is-upgraded",IS_VISIBLE:"is-visible",IS_ANIMATING:"is-animating",BOTTOM_LEFT:"mdl-menu--bottom-left",BOTTOM_RIGHT:"mdl-menu--bottom-right",TOP_LEFT:"mdl-menu--top-left",TOP_RIGHT:"mdl-menu--top-right",UNALIGNED:"mdl-menu--unaligned"},c.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),this.container_=e;var t=document.createElement("div");t.classList.add(this.CssClasses_.OUTLINE),this.outline_=t,e.insertBefore(t,this.element_);var n=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for"),r=null;n&&((r=document.getElementById(n))&&(this.forElement_=r,r.addEventListener("click",this.handleForClick_.bind(this)),r.addEventListener("keydown",this.handleForKeyboardEvent_.bind(this))));var i=this.element_.querySelectorAll("."+this.CssClasses_.ITEM);this.boundItemKeydown_=this.handleItemKeyboardEvent_.bind(this),this.boundItemClick_=this.handleItemClick_.bind(this);for(var a=0;a<i.length;a++)i[a].addEventListener("click",this.boundItemClick_),i[a].tabIndex="-1",i[a].addEventListener("keydown",this.boundItemKeydown_);if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT))for(this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),a=0;a<i.length;a++){var s=i[a],o=document.createElement("span");o.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);var u=document.createElement("span");u.classList.add(this.CssClasses_.RIPPLE),o.appendChild(u),s.appendChild(o),s.classList.add(this.CssClasses_.RIPPLE_EFFECT)}this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT),this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT),this.element_.classList.contains(this.CssClasses_.TOP_LEFT)&&this.outline_.classList.add(this.CssClasses_.TOP_LEFT),this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)&&this.outline_.classList.add(this.CssClasses_.TOP_RIGHT),this.element_.classList.contains(this.CssClasses_.UNALIGNED)&&this.outline_.classList.add(this.CssClasses_.UNALIGNED),e.classList.add(this.CssClasses_.IS_UPGRADED)}},c.prototype.handleForClick_=function(e){if(this.element_&&this.forElement_){var t=this.forElement_.getBoundingClientRect(),n=this.forElement_.parentElement.getBoundingClientRect();this.element_.classList.contains(this.CssClasses_.UNALIGNED)||(this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?(this.container_.style.right=n.right-t.right+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"):this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.bottom=n.bottom-t.top+"px"):this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(this.container_.style.right=n.right-t.right+"px",this.container_.style.bottom=n.bottom-t.top+"px"):(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"))}this.toggle(e)},c.prototype.handleForKeyboardEvent_=function(e){if(this.element_&&this.container_&&this.forElement_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)&&(e.keyCode===this.Keycodes_.UP_ARROW?(e.preventDefault(),t[t.length-1].focus()):e.keyCode===this.Keycodes_.DOWN_ARROW&&(e.preventDefault(),t[0].focus()))}},c.prototype.handleItemKeyboardEvent_=function(e){if(this.element_&&this.container_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");if(t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)){var n=Array.prototype.slice.call(t).indexOf(e.target);if(e.keyCode===this.Keycodes_.UP_ARROW)e.preventDefault(),n>0?t[n-1].focus():t[t.length-1].focus();else if(e.keyCode===this.Keycodes_.DOWN_ARROW)e.preventDefault(),t.length>n+1?t[n+1].focus():t[0].focus();else if(e.keyCode===this.Keycodes_.SPACE||e.keyCode===this.Keycodes_.ENTER){e.preventDefault();var r=new MouseEvent("mousedown");e.target.dispatchEvent(r),r=new MouseEvent("mouseup"),e.target.dispatchEvent(r),e.target.click()}else e.keyCode===this.Keycodes_.ESCAPE&&(e.preventDefault(),this.hide())}}},c.prototype.handleItemClick_=function(e){e.target.hasAttribute("disabled")?e.stopPropagation():(this.closing_=!0,window.setTimeout(function(e){this.hide(),this.closing_=!1}.bind(this),this.Constant_.CLOSE_TIMEOUT))},c.prototype.applyClip_=function(e,t){this.element_.classList.contains(this.CssClasses_.UNALIGNED)?this.element_.style.clip="":this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?this.element_.style.clip="rect(0 "+t+"px 0 "+t+"px)":this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?this.element_.style.clip="rect("+e+"px 0 "+e+"px 0)":this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?this.element_.style.clip="rect("+e+"px "+t+"px "+e+"px "+t+"px)":this.element_.style.clip=""},c.prototype.removeAnimationEndListener_=function(e){e.target.classList.remove(c.prototype.CssClasses_.IS_ANIMATING)},c.prototype.addAnimationEndListener_=function(){this.element_.addEventListener("transitionend",this.removeAnimationEndListener_),this.element_.addEventListener("webkitTransitionEnd",this.removeAnimationEndListener_)},c.prototype.show=function(e){if(this.element_&&this.container_&&this.outline_){var t=this.element_.getBoundingClientRect().height,n=this.element_.getBoundingClientRect().width;this.container_.style.width=n+"px",this.container_.style.height=t+"px",this.outline_.style.width=n+"px",this.outline_.style.height=t+"px";for(var r=this.Constant_.TRANSITION_DURATION_SECONDS*this.Constant_.TRANSITION_DURATION_FRACTION,i=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),a=0;a<i.length;a++){var s;s=this.element_.classList.contains(this.CssClasses_.TOP_LEFT)||this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(t-i[a].offsetTop-i[a].offsetHeight)/t*r+"s":i[a].offsetTop/t*r+"s",i[a].style.transitionDelay=s}this.applyClip_(t,n),window.requestAnimationFrame(function(){this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.element_.style.clip="rect(0 "+n+"px "+t+"px 0)",this.container_.classList.add(this.CssClasses_.IS_VISIBLE)}.bind(this)),this.addAnimationEndListener_();var o=function(t){t===e||this.closing_||t.target.parentNode===this.element_||(document.removeEventListener("click",o),this.hide())}.bind(this);document.addEventListener("click",o)}},c.prototype.show=c.prototype.show,c.prototype.hide=function(){if(this.element_&&this.container_&&this.outline_){for(var e=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),t=0;t<e.length;t++)e[t].style.removeProperty("transition-delay");var n=this.element_.getBoundingClientRect(),r=n.height,i=n.width;this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.applyClip_(r,i),this.container_.classList.remove(this.CssClasses_.IS_VISIBLE),this.addAnimationEndListener_()}},c.prototype.hide=c.prototype.hide,c.prototype.toggle=function(e){this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)?this.hide():this.show(e)},c.prototype.toggle=c.prototype.toggle,n.register({constructor:c,classAsString:"MaterialMenu",cssClass:"mdl-js-menu",widget:!0});var d=function(e){this.element_=e,this.init()};window.MaterialProgress=d,d.prototype.Constant_={},d.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},d.prototype.setProgress=function(e){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=e+"%")},d.prototype.setProgress=d.prototype.setProgress,d.prototype.setBuffer=function(e){this.bufferbar_.style.width=e+"%",this.auxbar_.style.width=100-e+"%"},d.prototype.setBuffer=d.prototype.setBuffer,d.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.className="progressbar bar bar1",this.element_.appendChild(e),this.progressbar_=e,(e=document.createElement("div")).className="bufferbar bar bar2",this.element_.appendChild(e),this.bufferbar_=e,(e=document.createElement("div")).className="auxbar bar bar3",this.element_.appendChild(e),this.auxbar_=e,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},n.register({constructor:d,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0});var h=function(e){this.element_=e,this.init()};window.MaterialRadio=h,h.prototype.Constant_={TINY_TIMEOUT:.001},h.prototype.CssClasses_={IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded",JS_RADIO:"mdl-js-radio",RADIO_BTN:"mdl-radio__button",RADIO_OUTER_CIRCLE:"mdl-radio__outer-circle",RADIO_INNER_CIRCLE:"mdl-radio__inner-circle",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-radio__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple"},h.prototype.onChange_=function(e){for(var t=document.getElementsByClassName(this.CssClasses_.JS_RADIO),n=0;n<t.length;n++){t[n].querySelector("."+this.CssClasses_.RADIO_BTN).getAttribute("name")===this.btnElement_.getAttribute("name")&&void 0!==t[n].MaterialRadio&&t[n].MaterialRadio.updateClasses_()}},h.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},h.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},h.prototype.onMouseup_=function(e){this.blur_()},h.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},h.prototype.blur_=function(){window.setTimeout(function(){this.btnElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},h.prototype.checkDisabled=function(){this.btnElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},h.prototype.checkDisabled=h.prototype.checkDisabled,h.prototype.checkToggleState=function(){this.btnElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},h.prototype.checkToggleState=h.prototype.checkToggleState,h.prototype.disable=function(){this.btnElement_.disabled=!0,this.updateClasses_()},h.prototype.disable=h.prototype.disable,h.prototype.enable=function(){this.btnElement_.disabled=!1,this.updateClasses_()},h.prototype.enable=h.prototype.enable,h.prototype.check=function(){this.btnElement_.checked=!0,this.onChange_(null)},h.prototype.check=h.prototype.check,h.prototype.uncheck=function(){this.btnElement_.checked=!1,this.onChange_(null)},h.prototype.uncheck=h.prototype.uncheck,h.prototype.init=function(){if(this.element_){this.btnElement_=this.element_.querySelector("."+this.CssClasses_.RADIO_BTN),this.boundChangeHandler_=this.onChange_.bind(this),this.boundFocusHandler_=this.onChange_.bind(this),this.boundBlurHandler_=this.onBlur_.bind(this),this.boundMouseUpHandler_=this.onMouseup_.bind(this);var e=document.createElement("span");e.classList.add(this.CssClasses_.RADIO_OUTER_CIRCLE);var t,n=document.createElement("span");if(n.classList.add(this.CssClasses_.RADIO_INNER_CIRCLE),this.element_.appendChild(e),this.element_.appendChild(n),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),(t=document.createElement("span")).classList.add(this.CssClasses_.RIPPLE_CONTAINER),t.classList.add(this.CssClasses_.RIPPLE_EFFECT),t.classList.add(this.CssClasses_.RIPPLE_CENTER),t.addEventListener("mouseup",this.boundMouseUpHandler_);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),t.appendChild(r),this.element_.appendChild(t)}this.btnElement_.addEventListener("change",this.boundChangeHandler_),this.btnElement_.addEventListener("focus",this.boundFocusHandler_),this.btnElement_.addEventListener("blur",this.boundBlurHandler_),this.element_.addEventListener("mouseup",this.boundMouseUpHandler_),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:h,classAsString:"MaterialRadio",cssClass:"mdl-js-radio",widget:!0});var f=function(e){this.element_=e,this.isIE_=window.navigator.msPointerEnabled,this.init()};window.MaterialSlider=f,f.prototype.Constant_={},f.prototype.CssClasses_={IE_CONTAINER:"mdl-slider__ie-container",SLIDER_CONTAINER:"mdl-slider__container",BACKGROUND_FLEX:"mdl-slider__background-flex",BACKGROUND_LOWER:"mdl-slider__background-lower",BACKGROUND_UPPER:"mdl-slider__background-upper",IS_LOWEST_VALUE:"is-lowest-value",IS_UPGRADED:"is-upgraded"},f.prototype.onInput_=function(e){this.updateValueStyles_()},f.prototype.onChange_=function(e){this.updateValueStyles_()},f.prototype.onMouseUp_=function(e){e.target.blur()},f.prototype.onContainerMouseDown_=function(e){if(e.target===this.element_.parentElement){e.preventDefault();var t=new MouseEvent("mousedown",{target:e.target,buttons:e.buttons,clientX:e.clientX,clientY:this.element_.getBoundingClientRect().y});this.element_.dispatchEvent(t)}},f.prototype.updateValueStyles_=function(){var e=(this.element_.value-this.element_.min)/(this.element_.max-this.element_.min);0===e?this.element_.classList.add(this.CssClasses_.IS_LOWEST_VALUE):this.element_.classList.remove(this.CssClasses_.IS_LOWEST_VALUE),this.isIE_||(this.backgroundLower_.style.flex=e,this.backgroundLower_.style.webkitFlex=e,this.backgroundUpper_.style.flex=1-e,this.backgroundUpper_.style.webkitFlex=1-e)},f.prototype.disable=function(){this.element_.disabled=!0},f.prototype.disable=f.prototype.disable,f.prototype.enable=function(){this.element_.disabled=!1},f.prototype.enable=f.prototype.enable,f.prototype.change=function(e){void 0!==e&&(this.element_.value=e),this.updateValueStyles_()},f.prototype.change=f.prototype.change,f.prototype.init=function(){if(this.element_){if(this.isIE_){var e=document.createElement("div");e.classList.add(this.CssClasses_.IE_CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_)}else{var t=document.createElement("div");t.classList.add(this.CssClasses_.SLIDER_CONTAINER),this.element_.parentElement.insertBefore(t,this.element_),this.element_.parentElement.removeChild(this.element_),t.appendChild(this.element_);var n=document.createElement("div");n.classList.add(this.CssClasses_.BACKGROUND_FLEX),t.appendChild(n),this.backgroundLower_=document.createElement("div"),this.backgroundLower_.classList.add(this.CssClasses_.BACKGROUND_LOWER),n.appendChild(this.backgroundLower_),this.backgroundUpper_=document.createElement("div"),this.backgroundUpper_.classList.add(this.CssClasses_.BACKGROUND_UPPER),n.appendChild(this.backgroundUpper_)}this.boundInputHandler=this.onInput_.bind(this),this.boundChangeHandler=this.onChange_.bind(this),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.boundContainerMouseDownHandler=this.onContainerMouseDown_.bind(this),this.element_.addEventListener("input",this.boundInputHandler),this.element_.addEventListener("change",this.boundChangeHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.element_.parentElement.addEventListener("mousedown",this.boundContainerMouseDownHandler),this.updateValueStyles_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},n.register({constructor:f,classAsString:"MaterialSlider",cssClass:"mdl-js-slider",widget:!0});var p=function(e){if(this.element_=e,this.textElement_=this.element_.querySelector("."+this.cssClasses_.MESSAGE),this.actionElement_=this.element_.querySelector("."+this.cssClasses_.ACTION),!this.textElement_)throw new Error("There must be a message element for a snackbar.");if(!this.actionElement_)throw new Error("There must be an action element for a snackbar.");this.active=!1,this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.queuedNotifications_=[],this.setActionHidden_(!0)};window.MaterialSnackbar=p,p.prototype.Constant_={ANIMATION_LENGTH:250},p.prototype.cssClasses_={SNACKBAR:"mdl-snackbar",MESSAGE:"mdl-snackbar__text",ACTION:"mdl-snackbar__action",ACTIVE:"mdl-snackbar--active"},p.prototype.displaySnackbar_=function(){this.element_.setAttribute("aria-hidden","true"),this.actionHandler_&&(this.actionElement_.textContent=this.actionText_,this.actionElement_.addEventListener("click",this.actionHandler_),this.setActionHidden_(!1)),this.textElement_.textContent=this.message_,this.element_.classList.add(this.cssClasses_.ACTIVE),this.element_.setAttribute("aria-hidden","false"),setTimeout(this.cleanup_.bind(this),this.timeout_)},p.prototype.showSnackbar=function(e){if(void 0===e)throw new Error("Please provide a data object with at least a message to display.");if(void 0===e.message)throw new Error("Please provide a message to be displayed.");if(e.actionHandler&&!e.actionText)throw new Error("Please provide action text with the handler.");this.active?this.queuedNotifications_.push(e):(this.active=!0,this.message_=e.message,e.timeout?this.timeout_=e.timeout:this.timeout_=2750,e.actionHandler&&(this.actionHandler_=e.actionHandler),e.actionText&&(this.actionText_=e.actionText),this.displaySnackbar_())},p.prototype.showSnackbar=p.prototype.showSnackbar,p.prototype.checkQueue_=function(){this.queuedNotifications_.length>0&&this.showSnackbar(this.queuedNotifications_.shift())},p.prototype.cleanup_=function(){this.element_.classList.remove(this.cssClasses_.ACTIVE),setTimeout(function(){this.element_.setAttribute("aria-hidden","true"),this.textElement_.textContent="",Boolean(this.actionElement_.getAttribute("aria-hidden"))||(this.setActionHidden_(!0),this.actionElement_.textContent="",this.actionElement_.removeEventListener("click",this.actionHandler_)),this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.active=!1,this.checkQueue_()}.bind(this),this.Constant_.ANIMATION_LENGTH)},p.prototype.setActionHidden_=function(e){e?this.actionElement_.setAttribute("aria-hidden","true"):this.actionElement_.removeAttribute("aria-hidden")},n.register({constructor:p,classAsString:"MaterialSnackbar",cssClass:"mdl-js-snackbar",widget:!0});var m=function(e){this.element_=e,this.init()};window.MaterialSpinner=m,m.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},m.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},m.prototype.createLayer=function(e){var t=document.createElement("div");t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+e);var n=document.createElement("div");n.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),n.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var r=document.createElement("div");r.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var i=document.createElement("div");i.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),i.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var a=[n,r,i],s=0;s<a.length;s++){var o=document.createElement("div");o.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),a[s].appendChild(o)}t.appendChild(n),t.appendChild(r),t.appendChild(i),this.element_.appendChild(t)},m.prototype.createLayer=m.prototype.createLayer,m.prototype.stop=function(){this.element_.classList.remove("is-active")},m.prototype.stop=m.prototype.stop,m.prototype.start=function(){this.element_.classList.add("is-active")},m.prototype.start=m.prototype.start,m.prototype.init=function(){if(this.element_){for(var e=1;e<=this.Constant_.MDL_SPINNER_LAYER_COUNT;e++)this.createLayer(e);this.element_.classList.add("is-upgraded")}},n.register({constructor:m,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0});var v=function(e){this.element_=e,this.init()};window.MaterialSwitch=v,v.prototype.Constant_={TINY_TIMEOUT:.001},v.prototype.CssClasses_={INPUT:"mdl-switch__input",TRACK:"mdl-switch__track",THUMB:"mdl-switch__thumb",FOCUS_HELPER:"mdl-switch__focus-helper",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-switch__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},v.prototype.onChange_=function(e){this.updateClasses_()},v.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},v.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},v.prototype.onMouseUp_=function(e){this.blur_()},v.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},v.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},v.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},v.prototype.checkDisabled=v.prototype.checkDisabled,v.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},v.prototype.checkToggleState=v.prototype.checkToggleState,v.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},v.prototype.disable=v.prototype.disable,v.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},v.prototype.enable=v.prototype.enable,v.prototype.on=function(){this.inputElement_.checked=!0,this.updateClasses_()},v.prototype.on=v.prototype.on,v.prototype.off=function(){this.inputElement_.checked=!1,this.updateClasses_()},v.prototype.off=v.prototype.off,v.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("div");e.classList.add(this.CssClasses_.TRACK);var t=document.createElement("div");t.classList.add(this.CssClasses_.THUMB);var n=document.createElement("span");if(n.classList.add(this.CssClasses_.FOCUS_HELPER),t.appendChild(n),this.element_.appendChild(e),this.element_.appendChild(t),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.rippleContainerElement_.addEventListener("mouseup",this.boundMouseUpHandler);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(r),this.element_.appendChild(this.rippleContainerElement_)}this.boundChangeHandler=this.onChange_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.inputElement_.addEventListener("change",this.boundChangeHandler),this.inputElement_.addEventListener("focus",this.boundFocusHandler),this.inputElement_.addEventListener("blur",this.boundBlurHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},n.register({constructor:v,classAsString:"MaterialSwitch",cssClass:"mdl-js-switch",widget:!0});var y=function(e){this.element_=e,this.init()};window.MaterialTabs=y,y.prototype.Constant_={},y.prototype.CssClasses_={TAB_CLASS:"mdl-tabs__tab",PANEL_CLASS:"mdl-tabs__panel",ACTIVE_CLASS:"is-active",UPGRADED_CLASS:"is-upgraded",MDL_JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",MDL_RIPPLE_CONTAINER:"mdl-tabs__ripple-container",MDL_RIPPLE:"mdl-ripple",MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events"},y.prototype.initTabs_=function(){this.element_.classList.contains(this.CssClasses_.MDL_JS_RIPPLE_EFFECT)&&this.element_.classList.add(this.CssClasses_.MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS),this.tabs_=this.element_.querySelectorAll("."+this.CssClasses_.TAB_CLASS),this.panels_=this.element_.querySelectorAll("."+this.CssClasses_.PANEL_CLASS);for(var t=0;t<this.tabs_.length;t++)new e(this.tabs_[t],this);this.element_.classList.add(this.CssClasses_.UPGRADED_CLASS)},y.prototype.resetTabState_=function(){for(var e=0;e<this.tabs_.length;e++)this.tabs_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},y.prototype.resetPanelState_=function(){for(var e=0;e<this.panels_.length;e++)this.panels_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},y.prototype.init=function(){this.element_&&this.initTabs_()},n.register({constructor:y,classAsString:"MaterialTabs",cssClass:"mdl-js-tabs"});var g=function(e){this.element_=e,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=g,g.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},g.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},g.prototype.onKeyDown_=function(e){var t=e.target.value.split("\n").length;13===e.keyCode&&t>=this.maxRows&&e.preventDefault()},g.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},g.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},g.prototype.onReset_=function(e){this.updateClasses_()},g.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},g.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},g.prototype.checkDisabled=g.prototype.checkDisabled,g.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},g.prototype.checkFocus=g.prototype.checkFocus,g.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},g.prototype.checkValidity=g.prototype.checkValidity,g.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},g.prototype.checkDirty=g.prototype.checkDirty,g.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},g.prototype.disable=g.prototype.disable,g.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},g.prototype.enable=g.prototype.enable,g.prototype.change=function(e){this.input_.value=e||"",this.updateClasses_()},g.prototype.change=g.prototype.change,g.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var e=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),e&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},n.register({constructor:g,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0});var _=function(e){this.element_=e,this.init()};window.MaterialTooltip=_,_.prototype.Constant_={},_.prototype.CssClasses_={IS_ACTIVE:"is-active",BOTTOM:"mdl-tooltip--bottom",LEFT:"mdl-tooltip--left",RIGHT:"mdl-tooltip--right",TOP:"mdl-tooltip--top"},_.prototype.handleMouseEnter_=function(e){var t=e.target.getBoundingClientRect(),n=t.left+t.width/2,r=t.top+t.height/2,i=this.element_.offsetWidth/2*-1,a=this.element_.offsetHeight/2*-1;this.element_.classList.contains(this.CssClasses_.LEFT)||this.element_.classList.contains(this.CssClasses_.RIGHT)?(n=t.width/2,r+a<0?(this.element_.style.top="0",this.element_.style.marginTop="0"):(this.element_.style.top=r+"px",this.element_.style.marginTop=a+"px")):n+i<0?(this.element_.style.left="0",this.element_.style.marginLeft="0"):(this.element_.style.left=n+"px",this.element_.style.marginLeft=i+"px"),this.element_.classList.contains(this.CssClasses_.TOP)?this.element_.style.top=t.top-this.element_.offsetHeight-10+"px":this.element_.classList.contains(this.CssClasses_.RIGHT)?this.element_.style.left=t.left+t.width+10+"px":this.element_.classList.contains(this.CssClasses_.LEFT)?this.element_.style.left=t.left-this.element_.offsetWidth-10+"px":this.element_.style.top=t.top+t.height+10+"px",this.element_.classList.add(this.CssClasses_.IS_ACTIVE)},_.prototype.hideTooltip_=function(){this.element_.classList.remove(this.CssClasses_.IS_ACTIVE)},_.prototype.init=function(){if(this.element_){var e=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for");e&&(this.forElement_=document.getElementById(e)),this.forElement_&&(this.forElement_.hasAttribute("tabindex")||this.forElement_.setAttribute("tabindex","0"),this.boundMouseEnterHandler=this.handleMouseEnter_.bind(this),this.boundMouseLeaveAndScrollHandler=this.hideTooltip_.bind(this),this.forElement_.addEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("touchend",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("mouseleave",this.boundMouseLeaveAndScrollHandler,!1),window.addEventListener("scroll",this.boundMouseLeaveAndScrollHandler,!0),window.addEventListener("touchstart",this.boundMouseLeaveAndScrollHandler))}},n.register({constructor:_,classAsString:"MaterialTooltip",cssClass:"mdl-tooltip"});var b=function(e){this.element_=e,this.init()};window.MaterialLayout=b,b.prototype.Constant_={MAX_WIDTH:"(max-width: 1024px)",TAB_SCROLL_PIXELS:100,RESIZE_TIMEOUT:100,MENU_ICON:"&#xE5D2;",CHEVRON_LEFT:"chevron_left",CHEVRON_RIGHT:"chevron_right"},b.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32},b.prototype.Mode_={STANDARD:0,SEAMED:1,WATERFALL:2,SCROLL:3},b.prototype.CssClasses_={CONTAINER:"mdl-layout__container",HEADER:"mdl-layout__header",DRAWER:"mdl-layout__drawer",CONTENT:"mdl-layout__content",DRAWER_BTN:"mdl-layout__drawer-button",ICON:"material-icons",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-layout__tab-ripple-container",RIPPLE:"mdl-ripple",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",HEADER_SEAMED:"mdl-layout__header--seamed",HEADER_WATERFALL:"mdl-layout__header--waterfall",HEADER_SCROLL:"mdl-layout__header--scroll",FIXED_HEADER:"mdl-layout--fixed-header",OBFUSCATOR:"mdl-layout__obfuscator",TAB_BAR:"mdl-layout__tab-bar",TAB_CONTAINER:"mdl-layout__tab-bar-container",TAB:"mdl-layout__tab",TAB_BAR_BUTTON:"mdl-layout__tab-bar-button",TAB_BAR_LEFT_BUTTON:"mdl-layout__tab-bar-left-button",TAB_BAR_RIGHT_BUTTON:"mdl-layout__tab-bar-right-button",TAB_MANUAL_SWITCH:"mdl-layout__tab-manual-switch",PANEL:"mdl-layout__tab-panel",HAS_DRAWER:"has-drawer",HAS_TABS:"has-tabs",HAS_SCROLLING_HEADER:"has-scrolling-header",CASTING_SHADOW:"is-casting-shadow",IS_COMPACT:"is-compact",IS_SMALL_SCREEN:"is-small-screen",IS_DRAWER_OPEN:"is-visible",IS_ACTIVE:"is-active",IS_UPGRADED:"is-upgraded",IS_ANIMATING:"is-animating",ON_LARGE_SCREEN:"mdl-layout--large-screen-only",ON_SMALL_SCREEN:"mdl-layout--small-screen-only"},b.prototype.contentScrollHandler_=function(){if(!this.header_.classList.contains(this.CssClasses_.IS_ANIMATING)){var e=!this.element_.classList.contains(this.CssClasses_.IS_SMALL_SCREEN)||this.element_.classList.contains(this.CssClasses_.FIXED_HEADER);this.content_.scrollTop>0&&!this.header_.classList.contains(this.CssClasses_.IS_COMPACT)?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.header_.classList.add(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING)):this.content_.scrollTop<=0&&this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.header_.classList.remove(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING))}},b.prototype.keyboardEventHandler_=function(e){e.keyCode===this.Keycodes_.ESCAPE&&this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)&&this.toggleDrawer()},b.prototype.screenSizeHandler_=function(){this.screenSizeMediaQuery_.matches?this.element_.classList.add(this.CssClasses_.IS_SMALL_SCREEN):(this.element_.classList.remove(this.CssClasses_.IS_SMALL_SCREEN),this.drawer_&&(this.drawer_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN)))},b.prototype.drawerToggleHandler_=function(e){if(e&&"keydown"===e.type){if(e.keyCode!==this.Keycodes_.SPACE&&e.keyCode!==this.Keycodes_.ENTER)return;e.preventDefault()}this.toggleDrawer()},b.prototype.headerTransitionEndHandler_=function(){this.header_.classList.remove(this.CssClasses_.IS_ANIMATING)},b.prototype.headerClickHandler_=function(){this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING))},b.prototype.resetTabState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},b.prototype.resetPanelState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},b.prototype.toggleDrawer=function(){var e=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);this.drawer_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)?(this.drawer_.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true")):(this.drawer_.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"))},b.prototype.toggleDrawer=b.prototype.toggleDrawer,b.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER);var n=this.element_.querySelector(":focus");this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),n&&n.focus();for(var r=this.element_.childNodes,i=r.length,a=0;a<i;a++){var s=r[a];s.classList&&s.classList.contains(this.CssClasses_.HEADER)&&(this.header_=s),s.classList&&s.classList.contains(this.CssClasses_.DRAWER)&&(this.drawer_=s),s.classList&&s.classList.contains(this.CssClasses_.CONTENT)&&(this.content_=s)}window.addEventListener("pageshow",function(e){e.persisted&&(this.element_.style.overflowY="hidden",requestAnimationFrame(function(){this.element_.style.overflowY=""}.bind(this)))}.bind(this),!1),this.header_&&(this.tabBar_=this.header_.querySelector("."+this.CssClasses_.TAB_BAR));var o=this.Mode_.STANDARD;if(this.header_&&(this.header_.classList.contains(this.CssClasses_.HEADER_SEAMED)?o=this.Mode_.SEAMED:this.header_.classList.contains(this.CssClasses_.HEADER_WATERFALL)?(o=this.Mode_.WATERFALL,this.header_.addEventListener("transitionend",this.headerTransitionEndHandler_.bind(this)),this.header_.addEventListener("click",this.headerClickHandler_.bind(this))):this.header_.classList.contains(this.CssClasses_.HEADER_SCROLL)&&(o=this.Mode_.SCROLL,e.classList.add(this.CssClasses_.HAS_SCROLLING_HEADER)),o===this.Mode_.STANDARD?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.add(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.SEAMED||o===this.Mode_.SCROLL?(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.remove(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.WATERFALL&&(this.content_.addEventListener("scroll",this.contentScrollHandler_.bind(this)),this.contentScrollHandler_())),this.drawer_){var u=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);if(!u){(u=document.createElement("div")).setAttribute("aria-expanded","false"),u.setAttribute("role","button"),u.setAttribute("tabindex","0"),u.classList.add(this.CssClasses_.DRAWER_BTN);var l=document.createElement("i");l.classList.add(this.CssClasses_.ICON),l.innerHTML=this.Constant_.MENU_ICON,u.appendChild(l)}this.drawer_.classList.contains(this.CssClasses_.ON_LARGE_SCREEN)?u.classList.add(this.CssClasses_.ON_LARGE_SCREEN):this.drawer_.classList.contains(this.CssClasses_.ON_SMALL_SCREEN)&&u.classList.add(this.CssClasses_.ON_SMALL_SCREEN),u.addEventListener("click",this.drawerToggleHandler_.bind(this)),u.addEventListener("keydown",this.drawerToggleHandler_.bind(this)),this.element_.classList.add(this.CssClasses_.HAS_DRAWER),this.element_.classList.contains(this.CssClasses_.FIXED_HEADER)?this.header_.insertBefore(u,this.header_.firstChild):this.element_.insertBefore(u,this.content_);var c=document.createElement("div");c.classList.add(this.CssClasses_.OBFUSCATOR),this.element_.appendChild(c),c.addEventListener("click",this.drawerToggleHandler_.bind(this)),this.obfuscator_=c,this.drawer_.addEventListener("keydown",this.keyboardEventHandler_.bind(this)),this.drawer_.setAttribute("aria-hidden","true")}if(this.screenSizeMediaQuery_=window.matchMedia(this.Constant_.MAX_WIDTH),this.screenSizeMediaQuery_.addListener(this.screenSizeHandler_.bind(this)),this.screenSizeHandler_(),this.header_&&this.tabBar_){this.element_.classList.add(this.CssClasses_.HAS_TABS);var d=document.createElement("div");d.classList.add(this.CssClasses_.TAB_CONTAINER),this.header_.insertBefore(d,this.tabBar_),this.header_.removeChild(this.tabBar_);var h=document.createElement("div");h.classList.add(this.CssClasses_.TAB_BAR_BUTTON),h.classList.add(this.CssClasses_.TAB_BAR_LEFT_BUTTON);var f=document.createElement("i");f.classList.add(this.CssClasses_.ICON),f.textContent=this.Constant_.CHEVRON_LEFT,h.appendChild(f),h.addEventListener("click",function(){this.tabBar_.scrollLeft-=this.Constant_.TAB_SCROLL_PIXELS}.bind(this));var p=document.createElement("div");p.classList.add(this.CssClasses_.TAB_BAR_BUTTON),p.classList.add(this.CssClasses_.TAB_BAR_RIGHT_BUTTON);var m=document.createElement("i");m.classList.add(this.CssClasses_.ICON),m.textContent=this.Constant_.CHEVRON_RIGHT,p.appendChild(m),p.addEventListener("click",function(){this.tabBar_.scrollLeft+=this.Constant_.TAB_SCROLL_PIXELS}.bind(this)),d.appendChild(h),d.appendChild(this.tabBar_),d.appendChild(p);var v=function(){this.tabBar_.scrollLeft>0?h.classList.add(this.CssClasses_.IS_ACTIVE):h.classList.remove(this.CssClasses_.IS_ACTIVE),this.tabBar_.scrollLeft<this.tabBar_.scrollWidth-this.tabBar_.offsetWidth?p.classList.add(this.CssClasses_.IS_ACTIVE):p.classList.remove(this.CssClasses_.IS_ACTIVE)}.bind(this);this.tabBar_.addEventListener("scroll",v),v();var y=function(){this.resizeTimeoutId_&&clearTimeout(this.resizeTimeoutId_),this.resizeTimeoutId_=setTimeout(function(){v(),this.resizeTimeoutId_=null}.bind(this),this.Constant_.RESIZE_TIMEOUT)}.bind(this);window.addEventListener("resize",y),this.tabBar_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)&&this.tabBar_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);for(var g=this.tabBar_.querySelectorAll("."+this.CssClasses_.TAB),_=this.content_.querySelectorAll("."+this.CssClasses_.PANEL),b=0;b<g.length;b++)new t(g[b],g,_,this)}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},window.MaterialLayoutTab=t,n.register({constructor:b,classAsString:"MaterialLayout",cssClass:"mdl-js-layout"});var w=function(e){this.element_=e,this.init()};window.MaterialDataTable=w,w.prototype.Constant_={},w.prototype.CssClasses_={DATA_TABLE:"mdl-data-table",SELECTABLE:"mdl-data-table--selectable",SELECT_ELEMENT:"mdl-data-table__select",IS_SELECTED:"is-selected",IS_UPGRADED:"is-upgraded"},w.prototype.selectRow_=function(e,t,n){return t?function(){e.checked?t.classList.add(this.CssClasses_.IS_SELECTED):t.classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):n?function(){var t;if(e.checked)for(t=0;t<n.length;t++)n[t].querySelector("td").querySelector(".mdl-checkbox").MaterialCheckbox.check(),n[t].classList.add(this.CssClasses_.IS_SELECTED);else for(t=0;t<n.length;t++)n[t].querySelector("td").querySelector(".mdl-checkbox").MaterialCheckbox.uncheck(),n[t].classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):void 0},w.prototype.createCheckbox_=function(e,t){var r=document.createElement("label"),i=["mdl-checkbox","mdl-js-checkbox","mdl-js-ripple-effect",this.CssClasses_.SELECT_ELEMENT];r.className=i.join(" ");var a=document.createElement("input");return a.type="checkbox",a.classList.add("mdl-checkbox__input"),e?(a.checked=e.classList.contains(this.CssClasses_.IS_SELECTED),a.addEventListener("change",this.selectRow_(a,e))):t&&a.addEventListener("change",this.selectRow_(a,null,t)),r.appendChild(a),n.upgradeElement(r,"MaterialCheckbox"),r},w.prototype.init=function(){if(this.element_){var e=this.element_.querySelector("th"),t=Array.prototype.slice.call(this.element_.querySelectorAll("tbody tr")),n=Array.prototype.slice.call(this.element_.querySelectorAll("tfoot tr")),r=t.concat(n);if(this.element_.classList.contains(this.CssClasses_.SELECTABLE)){var i=document.createElement("th"),a=this.createCheckbox_(null,r);i.appendChild(a),e.parentElement.insertBefore(i,e);for(var s=0;s<r.length;s++){var o=r[s].querySelector("td");if(o){var u=document.createElement("td");if("TBODY"===r[s].parentNode.nodeName.toUpperCase()){var l=this.createCheckbox_(r[s]);u.appendChild(l)}r[s].insertBefore(u,o)}}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}}},n.register({constructor:w,classAsString:"MaterialDataTable",cssClass:"mdl-js-data-table"});var E=function(e){this.element_=e,this.init()};window.MaterialRipple=E,E.prototype.Constant_={INITIAL_SCALE:"scale(0.0001, 0.0001)",INITIAL_SIZE:"1px",INITIAL_OPACITY:"0.4",FINAL_OPACITY:"0",FINAL_SCALE:""},E.prototype.CssClasses_={RIPPLE_CENTER:"mdl-ripple--center",RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_ANIMATING:"is-animating",IS_VISIBLE:"is-visible"},E.prototype.downHandler_=function(e){if(!this.rippleElement_.style.width&&!this.rippleElement_.style.height){var t=this.element_.getBoundingClientRect();this.boundHeight=t.height,this.boundWidth=t.width,this.rippleSize_=2*Math.sqrt(t.width*t.width+t.height*t.height)+2,this.rippleElement_.style.width=this.rippleSize_+"px",this.rippleElement_.style.height=this.rippleSize_+"px"}if(this.rippleElement_.classList.add(this.CssClasses_.IS_VISIBLE),"mousedown"===e.type&&this.ignoringMouseDown_)this.ignoringMouseDown_=!1;else{if("touchstart"===e.type&&(this.ignoringMouseDown_=!0),this.getFrameCount()>0)return;this.setFrameCount(1);var n,r,i=e.currentTarget.getBoundingClientRect();if(0===e.clientX&&0===e.clientY)n=Math.round(i.width/2),r=Math.round(i.height/2);else{var a=void 0!==e.clientX?e.clientX:e.touches[0].clientX,s=void 0!==e.clientY?e.clientY:e.touches[0].clientY;n=Math.round(a-i.left),r=Math.round(s-i.top)}this.setRippleXY(n,r),this.setRippleStyles(!0),window.requestAnimationFrame(this.animFrameHandler.bind(this))}},E.prototype.upHandler_=function(e){e&&2!==e.detail&&window.setTimeout(function(){this.rippleElement_.classList.remove(this.CssClasses_.IS_VISIBLE)}.bind(this),0)},E.prototype.init=function(){if(this.element_){var e=this.element_.classList.contains(this.CssClasses_.RIPPLE_CENTER);this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT_IGNORE_EVENTS)||(this.rippleElement_=this.element_.querySelector("."+this.CssClasses_.RIPPLE),this.frameCount_=0,this.rippleSize_=0,this.x_=0,this.y_=0,this.ignoringMouseDown_=!1,this.boundDownHandler=this.downHandler_.bind(this),this.element_.addEventListener("mousedown",this.boundDownHandler),this.element_.addEventListener("touchstart",this.boundDownHandler),this.boundUpHandler=this.upHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundUpHandler),this.element_.addEventListener("mouseleave",this.boundUpHandler),this.element_.addEventListener("touchend",this.boundUpHandler),this.element_.addEventListener("blur",this.boundUpHandler),this.getFrameCount=function(){return this.frameCount_},this.setFrameCount=function(e){this.frameCount_=e},this.getRippleElement=function(){return this.rippleElement_},this.setRippleXY=function(e,t){this.x_=e,this.y_=t},this.setRippleStyles=function(t){if(null!==this.rippleElement_){var n,r,i="translate("+this.x_+"px, "+this.y_+"px)";t?(r=this.Constant_.INITIAL_SCALE,this.Constant_.INITIAL_SIZE):(r=this.Constant_.FINAL_SCALE,this.rippleSize_+"px",e&&(i="translate("+this.boundWidth/2+"px, "+this.boundHeight/2+"px)")),n="translate(-50%, -50%) "+i+r,this.rippleElement_.style.webkitTransform=n,this.rippleElement_.style.msTransform=n,this.rippleElement_.style.transform=n,t?this.rippleElement_.classList.remove(this.CssClasses_.IS_ANIMATING):this.rippleElement_.classList.add(this.CssClasses_.IS_ANIMATING)}},this.animFrameHandler=function(){this.frameCount_-- >0?window.requestAnimationFrame(this.animFrameHandler.bind(this)):this.setRippleStyles(!1)})}},n.register({constructor:E,classAsString:"MaterialRipple",cssClass:"mdl-js-ripple-effect",widget:!1})}()},function(e,t,n){e.exports=function(){"use strict";var e=window.CustomEvent;function t(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement}return null}function n(e){e&&e.blur&&e!==document.body&&e.blur()}function r(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1}function i(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function a(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window){var t=new MutationObserver(this.maybeHideModal.bind(this));t.observe(e,{attributes:!0,attributeFilter:["open"]})}else{var n,r=!1,i=function(){r?this.downgradeModal():this.maybeHideModal(),r=!1}.bind(this),a=function(t){if(t.target===e){var a="DOMNodeRemoved";r|=t.type.substr(0,a.length)===a,window.clearTimeout(n),n=window.setTimeout(i,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(t){e.addEventListener(t,a)})}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}e&&"object"!=typeof e||((e=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),n}).prototype=window.Event.prototype),a.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),s.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var n=document.createEvent("MouseEvents");n.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(n),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),!e){var t=["button","input","keygen","select","textarea"].map(function(e){return e+":not([disabled])"});t.push('[tabindex]:not([disabled]):not([tabindex=""])'),e=this.dialog_.querySelector(t.join(", "))}n(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!s.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),n=function(e,n){return!(void 0===t[e]||t[e]===n)};if(t.opacity<1||n("zIndex","auto")||n("transform","none")||n("mixBlendMode","normal")||n("filter","none")||n("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,s.needsCentering(this.dialog_)?(s.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==t&&(this.dialog_.returnValue=t);var n=new e("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(n)}};var s={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,n=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,n)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var n=document.styleSheets[t],i=null;try{i=n.cssRules}catch(e){}if(i)for(var a=0;a<i.length;++a){var s=i[a],o=null;try{o=document.querySelectorAll(s.selectorText)}catch(e){}if(o&&r(o,e)){var u=s.style.getPropertyValue("top"),l=s.style.getPropertyValue("bottom");if(u&&"auto"!==u||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||s.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new a(e)},registerDialog:function(e){e.showModal||s.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(t){var n=[];t.forEach(function(e){for(var t,r=0;t=e.removedNodes[r];++r)t instanceof Element&&("dialog"===t.localName&&n.push(t),n=n.concat(t.querySelectorAll("dialog")))}),n.length&&e(n)}))}};if(s.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},s.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},s.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,n=0;e=this.pendingDialogStack[n];++n)e.updateZIndex(--t,--t),0===n&&(this.overlay.style.zIndex=--t);var r=this.pendingDialogStack[0];r?(r.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},s.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=t(e);){for(var n,r=0;n=this.pendingDialogStack[r];++r)if(n.dialog===e)return 0===r;e=e.parentElement}return!1},s.DialogManager.prototype.handleFocus_=function(e){if(!this.containedByTopDialog_(e.target)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),n(e.target),void 0!==this.forwardTab_)){var t=this.pendingDialogStack[0];return t.dialog.compareDocumentPosition(e.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?t.focus_():e.target!==document.documentElement&&document.documentElement.focus()),!1}},s.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,27===t.keyCode){t.preventDefault(),t.stopPropagation();var n=new e("cancel",{bubbles:!1,cancelable:!0}),r=this.pendingDialogStack[0];r&&r.dialog.dispatchEvent(n)&&r.dialog.close()}else 9===t.keyCode&&(this.forwardTab_=!t.shiftKey)},s.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach(function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()})},s.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},s.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},s.dm=new s.DialogManager,s.formSubmitter=null,s.useValue=null,void 0===window.HTMLDialogElement){var o=document.createElement("form");if(o.setAttribute("method","dialog"),"dialog"!==o.method){var u=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(u){var l=u.get;u.get=function(){return i(this)?"dialog":l.call(this)};var c=u.set;u.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):c.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",u)}}document.addEventListener("click",function(e){if(s.formSubmitter=null,s.useValue=null,!e.defaultPrevented){var n=e.target;if(n&&i(n.form)){var r="submit"===n.type&&["button","input"].indexOf(n.localName)>-1;if(!r){if("input"!==n.localName||"image"!==n.type)return;s.useValue=e.offsetX+","+e.offsetY}var a=t(n);a&&(s.formSubmitter=n)}}},!1);var d=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!i(this))return d.call(this);var e=t(this);e&&e.close()},document.addEventListener("submit",function(e){var n=e.target;if(i(n)){e.preventDefault();var r=t(n);if(r){var a=s.formSubmitter;a&&a.form===n?r.close(s.useValue||a.value):r.close(),s.formSubmitter=null}}},!0)}return s}()},function(e,t,n){(function(t){e.exports=function(){"use strict";function e(e){return e&&"[object Function]"==={}.toString.call(e)}function n(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView,r=n.getComputedStyle(e,null);return t?r[t]:r}function r(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function i(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=n(e),a=t.overflow,s=t.overflowX,o=t.overflowY;return/(auto|scroll|overlay)/.test(a+o+s)?e:i(r(e))}function a(e){return 11===e?Y:10===e?X:Y||X}function s(e){if(!e)return document.documentElement;for(var t=a(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var i=r&&r.nodeName;return i&&"BODY"!==i&&"HTML"!==i?-1!==["TH","TD","TABLE"].indexOf(r.nodeName)&&"static"===n(r,"position")?s(r):r:e?e.ownerDocument.documentElement:document.documentElement}function o(e){return null===e.parentNode?e:o(e.parentNode)}function u(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=n?e:t,i=n?t:e,a=document.createRange();a.setStart(r,0),a.setEnd(i,0);var l=a.commonAncestorContainer;if(e!==l&&t!==l||r.contains(i))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||s(e.firstElementChild)===e)}(l)?l:s(l);var c=o(e);return c.host?u(c.host,t):u(e,o(t).host)}function l(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",n="top"===t?"scrollTop":"scrollLeft",r=e.nodeName;if("BODY"===r||"HTML"===r){var i=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||i;return a[n]}return e[n]}function c(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=l(t,"top"),i=l(t,"left"),a=n?-1:1;return e.top+=r*a,e.bottom+=r*a,e.left+=i*a,e.right+=i*a,e}function d(e,t){var n="x"===t?"Left":"Top",r="Left"==n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"],10)+parseFloat(e["border"+r+"Width"],10)}function h(e,t,n,r){return H(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],a(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function f(e){var t=e.body,n=e.documentElement,r=a(10)&&getComputedStyle(n);return{height:h("Height",t,n,r),width:h("Width",t,n,r)}}function p(e){return J({},e,{right:e.left+e.width,bottom:e.top+e.height})}function m(e){var t={};try{if(a(10)){t=e.getBoundingClientRect();var r=l(e,"top"),i=l(e,"left");t.top+=r,t.left+=i,t.bottom+=r,t.right+=i}else t=e.getBoundingClientRect()}catch(e){}var s={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?f(e.ownerDocument):{},u=o.width||e.clientWidth||s.right-s.left,c=o.height||e.clientHeight||s.bottom-s.top,h=e.offsetWidth-u,m=e.offsetHeight-c;if(h||m){var v=n(e);h-=d(v,"x"),m-=d(v,"y"),s.width-=h,s.height-=m}return p(s)}function v(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=a(10),o="HTML"===t.nodeName,u=m(e),l=m(t),d=i(e),h=n(t),f=parseFloat(h.borderTopWidth,10),v=parseFloat(h.borderLeftWidth,10);r&&o&&(l.top=H(l.top,0),l.left=H(l.left,0));var y=p({top:u.top-l.top-f,left:u.left-l.left-v,width:u.width,height:u.height});if(y.marginTop=0,y.marginLeft=0,!s&&o){var g=parseFloat(h.marginTop,10),_=parseFloat(h.marginLeft,10);y.top-=f-g,y.bottom-=f-g,y.left-=v-_,y.right-=v-_,y.marginTop=g,y.marginLeft=_}return(s&&!r?t.contains(d):t===d&&"BODY"!==d.nodeName)&&(y=c(y,t)),y}function y(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,r=v(e,n),i=H(n.clientWidth,window.innerWidth||0),a=H(n.clientHeight,window.innerHeight||0),s=t?0:l(n),o=t?0:l(n,"left"),u={top:s-r.top+r.marginTop,left:o-r.left+r.marginLeft,width:i,height:a};return p(u)}function g(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===n(e,"position"))return!0;var i=r(e);return!!i&&g(i)}function _(e){if(!e||!e.parentElement||a())return document.documentElement;for(var t=e.parentElement;t&&"none"===n(t,"transform");)t=t.parentElement;return t||document.documentElement}function b(e,t,n,a){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o={top:0,left:0},l=s?_(e):u(e,t);if("viewport"===a)o=y(l,s);else{var c;"scrollParent"===a?"BODY"===(c=i(r(t))).nodeName&&(c=e.ownerDocument.documentElement):c="window"===a?e.ownerDocument.documentElement:a;var d=v(c,l,s);if("HTML"!==c.nodeName||g(l))o=d;else{var h=f(e.ownerDocument),p=h.height,m=h.width;o.top+=d.top-d.marginTop,o.bottom=p+d.top,o.left+=d.left-d.marginLeft,o.right=m+d.left}}var b="number"==typeof(n=n||0);return o.left+=b?n:n.left||0,o.top+=b?n:n.top||0,o.right-=b?n:n.right||0,o.bottom-=b?n:n.bottom||0,o}function w(e){var t=e.width,n=e.height;return t*n}function E(e,t,n,r,i){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=b(n,r,a,i),o={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},u=Object.keys(o).map(function(e){return J({key:e},o[e],{area:w(o[e])})}).sort(function(e,t){return t.area-e.area}),l=u.filter(function(e){var t=e.width,r=e.height;return t>=n.clientWidth&&r>=n.clientHeight}),c=0<l.length?l[0].key:u[0].key,d=e.split("-")[1];return c+(d?"-"+d:"")}function S(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=r?_(t):u(t,n);return v(n,i,r)}function T(e){var t=e.ownerDocument.defaultView,n=t.getComputedStyle(e),r=parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0),i=parseFloat(n.marginLeft||0)+parseFloat(n.marginRight||0),a={width:e.offsetWidth+i,height:e.offsetHeight+r};return a}function k(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function C(e,t,n){n=n.split("-")[0];var r=T(e),i={width:r.width,height:r.height},a=-1!==["right","left"].indexOf(n),s=a?"top":"left",o=a?"left":"top",u=a?"height":"width",l=a?"width":"height";return i[s]=t[s]+t[u]/2-r[u]/2,i[o]=n===o?t[o]-r[l]:t[k(o)],i}function I(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function A(t,n,r){var i=void 0===r?t:t.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[t]===n});var r=I(e,function(e){return e[t]===n});return e.indexOf(r)}(t,"name",r));return i.forEach(function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var r=t.function||t.fn;t.enabled&&e(r)&&(n.offsets.popper=p(n.offsets.popper),n.offsets.reference=p(n.offsets.reference),n=r(n,t))}),n}function x(e,t){return e.some(function(e){var n=e.name,r=e.enabled;return r&&n===t})}function L(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var i=t[r],a=i?""+i+n:e;if(void 0!==document.body.style[a])return a}return null}function N(e){var t=e.ownerDocument;return t?t.defaultView:window}function R(e,t,n,r){n.updateBound=r,N(e).addEventListener("resize",n.updateBound,{passive:!0});var a=i(e);return function e(t,n,r,a){var s="BODY"===t.nodeName,o=s?t.ownerDocument.defaultView:t;o.addEventListener(n,r,{passive:!0}),s||e(i(o.parentNode),n,r,a),a.push(o)}(a,"scroll",n.updateBound,n.scrollParents),n.scrollElement=a,n.eventsEnabled=!0,n}function M(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,N(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function P(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function O(e,t){Object.keys(t).forEach(function(n){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&P(t[n])&&(r="px"),e.style[n]=t[n]+r})}function D(e,t,n){var r=I(e,function(e){var n=e.name;return n===t}),i=!!r&&e.some(function(e){return e.name===n&&e.enabled&&e.order<r.order});if(!i){var a="`"+t+"`";console.warn("`"+n+"` modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return i}function U(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=ne.indexOf(e),r=ne.slice(n+1).concat(ne.slice(0,n));return t?r.reverse():r}function F(e,t,n,r){var i=[0,0],a=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map(function(e){return e.trim()}),o=s.indexOf(I(s,function(e){return-1!==e.search(/,|\s/)}));s[o]&&-1===s[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var u=/\s*,\s*|\s+/,l=-1===o?[s]:[s.slice(0,o).concat([s[o].split(u)[0]]),[s[o].split(u)[1]].concat(s.slice(o+1))];return(l=l.map(function(e,r){var i=(1===r?!a:a)?"height":"width",s=!1;return e.reduce(function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)},[]).map(function(e){return function(e,t,n,r){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+i[1],s=i[2];if(!a)return e;if(0===s.indexOf("%")){var o;switch(s){case"%p":o=n;break;case"%":case"%r":default:o=r}var u=p(o);return u[t]/100*a}return"vh"===s||"vw"===s?("vh"===s?H(document.documentElement.clientHeight,window.innerHeight||0):H(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,i,t,n)})})).forEach(function(e,t){e.forEach(function(n,r){P(n)&&(i[t]+=n*("-"===e[r-1]?-1:1))})}),i}for(var B=Math.min,V=Math.floor,j=Math.round,H=Math.max,K="undefined"!=typeof window&&"undefined"!=typeof document,G=["Edge","Trident","Firefox"],W=0,q=0;q<G.length;q+=1)if(K&&0<=navigator.userAgent.indexOf(G[q])){W=1;break}var z=K&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},W))}},Y=K&&!(!window.MSInputMethodContext||!document.documentMode),X=K&&/MSIE 10/.test(navigator.userAgent),$=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Q=function(){function e(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Z=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},J=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ee=K&&/Firefox/i.test(navigator.userAgent),te=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ne=te.slice(3),re={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},ie=function(){function t(n,r){var i=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};$(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=z(this.update.bind(this)),this.options=J({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=n&&n.jquery?n[0]:n,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(J({},t.Defaults.modifiers,a.modifiers)).forEach(function(e){i.options.modifiers[e]=J({},t.Defaults.modifiers[e]||{},a.modifiers?a.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return J({name:e},i.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(t){t.enabled&&e(t.onLoad)&&t.onLoad(i.reference,i.popper,i.options,t,i.state)}),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return Q(t,[{key:"update",value:function(){return function(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=S(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=E(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=C(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=A(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,x(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[L("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=R(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return M.call(this)}}]),t}();return ie.Utils=("undefined"==typeof window?t:window).PopperUtils,ie.placements=te,ie.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],r=t.split("-")[1];if(r){var i=e.offsets,a=i.reference,s=i.popper,o=-1!==["bottom","top"].indexOf(n),u=o?"left":"top",l=o?"width":"height",c={start:Z({},u,a[u]),end:Z({},u,a[u]+a[l]-s[l])};e.offsets.popper=J({},s,c[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n,r=t.offset,i=e.placement,a=e.offsets,s=a.popper,o=a.reference,u=i.split("-")[0];return n=P(+r)?[+r,0]:F(r,s,o,u),"left"===u?(s.top+=n[0],s.left-=n[1]):"right"===u?(s.top+=n[0],s.left+=n[1]):"top"===u?(s.left+=n[0],s.top-=n[1]):"bottom"===u&&(s.left+=n[0],s.top+=n[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||s(e.instance.popper);e.instance.reference===n&&(n=s(n));var r=L("transform"),i=e.instance.popper.style,a=i.top,o=i.left,u=i[r];i.top="",i.left="",i[r]="";var l=b(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);i.top=a,i.left=o,i[r]=u,t.boundaries=l;var c=t.priority,d=e.offsets.popper,h={primary:function(e){var n=d[e];return d[e]<l[e]&&!t.escapeWithReference&&(n=H(d[e],l[e])),Z({},e,n)},secondary:function(e){var n="right"===e?"left":"top",r=d[n];return d[e]>l[e]&&!t.escapeWithReference&&(r=B(d[n],l[e]-("right"===e?d.width:d.height))),Z({},n,r)}};return c.forEach(function(e){var t=-1===["left","top"].indexOf(e)?"secondary":"primary";d=J({},d,h[t](e))}),e.offsets.popper=d,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,i=e.placement.split("-")[0],a=V,s=-1!==["top","bottom"].indexOf(i),o=s?"right":"bottom",u=s?"left":"top",l=s?"width":"height";return n[o]<a(r[u])&&(e.offsets.popper[u]=a(r[u])-n[l]),n[u]>a(r[o])&&(e.offsets.popper[u]=a(r[o])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var r;if(!D(e.instance.modifiers,"arrow","keepTogether"))return e;var i=t.element;if("string"==typeof i){if(!(i=e.instance.popper.querySelector(i)))return e}else if(!e.instance.popper.contains(i))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],s=e.offsets,o=s.popper,u=s.reference,l=-1!==["left","right"].indexOf(a),c=l?"height":"width",d=l?"Top":"Left",h=d.toLowerCase(),f=l?"left":"top",m=l?"bottom":"right",v=T(i)[c];u[m]-v<o[h]&&(e.offsets.popper[h]-=o[h]-(u[m]-v)),u[h]+v>o[m]&&(e.offsets.popper[h]+=u[h]+v-o[m]),e.offsets.popper=p(e.offsets.popper);var y=u[h]+u[c]/2-v/2,g=n(e.instance.popper),_=parseFloat(g["margin"+d],10),b=parseFloat(g["border"+d+"Width"],10),w=y-e.offsets.popper[h]-_-b;return w=H(B(o[c]-v,w),0),e.arrowElement=i,e.offsets.arrow=(Z(r={},h,j(w)),Z(r,f,""),r),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(x(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=b(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],i=k(r),a=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case re.FLIP:s=[r,i];break;case re.CLOCKWISE:s=U(r);break;case re.COUNTERCLOCKWISE:s=U(r,!0);break;default:s=t.behavior}return s.forEach(function(o,u){if(r!==o||s.length===u+1)return e;r=e.placement.split("-")[0],i=k(r);var l=e.offsets.popper,c=e.offsets.reference,d=V,h="left"===r&&d(l.right)>d(c.left)||"right"===r&&d(l.left)<d(c.right)||"top"===r&&d(l.bottom)>d(c.top)||"bottom"===r&&d(l.top)<d(c.bottom),f=d(l.left)<d(n.left),p=d(l.right)>d(n.right),m=d(l.top)<d(n.top),v=d(l.bottom)>d(n.bottom),y="left"===r&&f||"right"===r&&p||"top"===r&&m||"bottom"===r&&v,g=-1!==["top","bottom"].indexOf(r),_=!!t.flipVariations&&(g&&"start"===a&&f||g&&"end"===a&&p||!g&&"start"===a&&m||!g&&"end"===a&&v),b=!!t.flipVariationsByContent&&(g&&"start"===a&&p||g&&"end"===a&&f||!g&&"start"===a&&v||!g&&"end"===a&&m),w=_||b;(h||y||w)&&(e.flipped=!0,(h||y)&&(r=s[u+1]),w&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=r+(a?"-"+a:""),e.offsets.popper=J({},e.offsets.popper,C(e.instance.popper,e.offsets.reference,e.placement)),e=A(e.instance.modifiers,e,"flip"))}),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,i=r.popper,a=r.reference,s=-1!==["left","right"].indexOf(n),o=-1===["top","left"].indexOf(n);return i[s?"left":"top"]=a[n]-(o?i[s?"width":"height"]:0),e.placement=k(t),e.offsets.popper=p(i),e}},hide:{order:800,enabled:!0,fn:function(e){if(!D(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=I(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,i=e.offsets.popper,a=I(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,u,l=void 0===a?t.gpuAcceleration:a,c=s(e.instance.popper),d=m(c),h={position:i.position},f=function(e,t){var n=e.offsets,r=n.popper,i=n.reference,a=j,s=function(e){return e},o=a(i.width),u=a(r.width),l=-1!==["left","right"].indexOf(e.placement),c=-1!==e.placement.indexOf("-"),d=t?l||c||o%2==u%2?a:V:s,h=t?a:s;return{left:d(1==o%2&&1==u%2&&!c&&t?r.left-1:r.left),top:h(r.top),bottom:h(r.bottom),right:d(r.right)}}(e,2>window.devicePixelRatio||!ee),p="bottom"===n?"top":"bottom",v="right"===r?"left":"right",y=L("transform");if(u="bottom"==p?"HTML"===c.nodeName?-c.clientHeight+f.bottom:-d.height+f.bottom:f.top,o="right"==v?"HTML"===c.nodeName?-c.clientWidth+f.right:-d.width+f.right:f.left,l&&y)h[y]="translate3d("+o+"px, "+u+"px, 0)",h[p]=0,h[v]=0,h.willChange="transform";else{var g="bottom"==p?-1:1,_="right"==v?-1:1;h[p]=u*g,h[v]=o*_,h.willChange=p+", "+v}var b={"x-placement":e.placement};return e.attributes=J({},b,e.attributes),e.styles=J({},h,e.styles),e.arrowStyles=J({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return O(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach(function(n){var r=t[n];!1===r?e.removeAttribute(n):e.setAttribute(n,t[n])})}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&O(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,i){var a=S(i,t,e,n.positionFixed),s=E(n.placement,a,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",s),O(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},ie}()}).call(this,n(4))},function(e,t,n){e.exports=function(e){"use strict";function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}e=e&&e.hasOwnProperty("default")?e.default:e;var n="undefined"!=typeof window&&"undefined"!=typeof document,r=n?navigator.userAgent:"",i=/MSIE |Trident\//.test(r),a=/UCBrowser\//.test(r),s=n&&/iPhone|iPad|iPod/.test(navigator.platform)&&!window.MSStream,o={a11y:!0,allowHTML:!0,animateFill:!0,animation:"shift-away",appendTo:function(){return document.body},aria:"describedby",arrow:!1,arrowType:"sharp",boundary:"scrollParent",content:"",delay:0,distance:10,duration:[325,275],flip:!0,flipBehavior:"flip",flipOnUpdate:!1,followCursor:!1,hideOnClick:!0,ignoreAttributes:!1,inertia:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,lazy:!0,maxWidth:350,multiple:!1,offset:0,onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},placement:"top",popperOptions:{},role:"tooltip",showOnInit:!1,size:"regular",sticky:!1,target:"",theme:"dark",touch:!0,touchHold:!1,trigger:"mouseenter focus",triggerTarget:null,updateDuration:0,wait:null,zIndex:9999},u=["arrow","arrowType","boundary","distance","flip","flipBehavior","flipOnUpdate","offset","placement","popperOptions"],l=n?Element.prototype:{},c=l.matches||l.matchesSelector||l.webkitMatchesSelector||l.mozMatchesSelector||l.msMatchesSelector;function d(e){return[].slice.call(e)}function h(e,t){return f(e,function(e){return c.call(e,t)})}function f(e,t){for(;e;){if(t(e))return e;e=e.parentElement}return null}var p={passive:!0},m=4,v="x-placement",y="x-out-of-boundaries",g="tippy-iOS",_="tippy-active",b="tippy-popper",w="tippy-tooltip",E="tippy-content",S="tippy-backdrop",T="tippy-arrow",k="tippy-roundarrow",C=".".concat(b),I=".".concat(w),A=".".concat(E),x=".".concat(S),L=".".concat(T),N=".".concat(k),R=!1;function M(){R||(R=!0,s&&document.body.classList.add(g),window.performance&&document.addEventListener("mousemove",O))}var P=0;function O(){var e=performance.now();e-P<20&&(R=!1,document.removeEventListener("mousemove",O),s||document.body.classList.remove(g)),P=e}function D(){var e=document.activeElement;e&&e.blur&&e._tippy&&e.blur()}var U=Object.keys(o);function F(e,t){return{}.hasOwnProperty.call(e,t)}function B(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?n:r}return e}function V(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)};var n}function j(e,t){return e&&e.modifiers&&e.modifiers[t]}function H(e,t){return e.indexOf(t)>-1}function K(e){return e instanceof Element}function G(e){return!(!e||!F(e,"isVirtual"))||K(e)}function W(e,t){return"function"==typeof e?e.apply(null,t):e}function q(e,t){e.filter(function(e){return"flip"===e.name})[0].enabled=t}function z(){return document.createElement("div")}function Y(e,t){e.forEach(function(e){e&&(e.style.transitionDuration="".concat(t,"ms"))})}function X(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function $(e,n){var r=t({},n,{content:W(n.content,[e])},n.ignoreAttributes?{}:function(e){return U.reduce(function(t,n){var r=(e.getAttribute("data-tippy-".concat(n))||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t},{})}(e));return(r.arrow||a)&&(r.animateFill=!1),r}function Q(e,t){Object.keys(e).forEach(function(e){if(!F(t,e))throw new Error("[tippy]: `".concat(e,"` is not a valid option"))})}function Z(e,t){e.innerHTML=K(t)?t.innerHTML:t}function J(e,t){K(t.content)?(Z(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(e[t.allowHTML?"innerHTML":"textContent"]=t.content)}function ee(e){return{tooltip:e.querySelector(I),backdrop:e.querySelector(x),content:e.querySelector(A),arrow:e.querySelector(L)||e.querySelector(N)}}function te(e){e.setAttribute("data-inertia","")}function ne(e){var t=z();return"round"===e?(t.className=k,Z(t,'<svg viewBox="0 0 18 7" xmlns="http://www.w3.org/2000/svg"><path d="M0 7s2.021-.015 5.253-4.218C6.584 1.051 7.797.007 9 0c1.203-.007 2.416 1.035 3.761 2.782C16.012 7.005 18 7 18 7H0z"/></svg>')):t.className=T,t}function re(){var e=z();return e.className=S,e.setAttribute("data-state","hidden"),e}function ie(e,t){e.setAttribute("tabindex","-1"),t.setAttribute("data-interactive","")}function ae(e,t,n){var r=a&&void 0!==document.body.style.webkitTransition?"webkitTransitionEnd":"transitionend";e[t+"EventListener"](r,n)}function se(e){var t=e.getAttribute(v);return t?t.split("-")[0]:""}function oe(e,t,n){n.split(" ").forEach(function(n){e.classList[t](n+"-theme")})}function ue(e,t){var n=z();n.className=b,n.id="tippy-".concat(e),n.style.zIndex=""+t.zIndex,n.style.position="absolute",n.style.top="0",n.style.left="0",t.role&&n.setAttribute("role",t.role);var r=z();r.className=w,r.style.maxWidth=t.maxWidth+("number"==typeof t.maxWidth?"px":""),r.setAttribute("data-size",t.size),r.setAttribute("data-animation",t.animation),r.setAttribute("data-state","hidden"),oe(r,"add",t.theme);var i=z();return i.className=E,i.setAttribute("data-state","hidden"),t.interactive&&ie(n,r),t.arrow&&r.appendChild(ne(t.arrowType)),t.animateFill&&(r.appendChild(re()),r.setAttribute("data-animatefill","")),t.inertia&&te(r),J(i,t),r.appendChild(i),n.appendChild(r),n}function le(e,t,n){var r=ee(e),i=r.tooltip,a=r.content,s=r.backdrop,o=r.arrow;e.style.zIndex=""+n.zIndex,i.setAttribute("data-size",n.size),i.setAttribute("data-animation",n.animation),i.style.maxWidth=n.maxWidth+("number"==typeof n.maxWidth?"px":""),n.role?e.setAttribute("role",n.role):e.removeAttribute("role"),t.content!==n.content&&J(a,n),!t.animateFill&&n.animateFill?(i.appendChild(re()),i.setAttribute("data-animatefill","")):t.animateFill&&!n.animateFill&&(i.removeChild(s),i.removeAttribute("data-animatefill")),!t.arrow&&n.arrow?i.appendChild(ne(n.arrowType)):t.arrow&&!n.arrow&&i.removeChild(o),t.arrow&&n.arrow&&t.arrowType!==n.arrowType&&i.replaceChild(ne(n.arrowType),o),!t.interactive&&n.interactive?ie(e,i):t.interactive&&!n.interactive&&function(e,t){e.removeAttribute("tabindex"),t.removeAttribute("data-interactive")}(e,i),!t.inertia&&n.inertia?te(i):t.inertia&&!n.inertia&&function(e){e.removeAttribute("data-inertia")}(i),t.theme!==n.theme&&(oe(i,"remove",t.theme),oe(i,"add",n.theme))}var ce=1,de=[];function he(n,r){var a,s,l,g,b,w=$(n,r);if(!w.multiple&&n._tippy)return null;var E,S,T,k,I,A=!1,x=!1,L=!1,N=!1,M=[],P=V(ge,w.interactiveDebounce),O=ce++,D=ue(O,w),U=ee(D),G={id:O,reference:n,popper:D,popperChildren:U,popperInstance:null,props:w,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},clearDelayTimeouts:xe,set:Le,setContent:function(e){Le({content:e})},show:Ne,hide:Re,enable:function(){G.state.isEnabled=!0},disable:function(){G.state.isEnabled=!1},destroy:function(e){if(!G.state.isDestroyed){x=!0,G.state.isMounted&&Re(0),me(),delete n._tippy;var t=G.props.target;t&&e&&K(n)&&d(n.querySelectorAll(t)).forEach(function(e){e._tippy&&e._tippy.destroy()}),G.popperInstance&&G.popperInstance.destroy(),x=!1,G.state.isDestroyed=!0}}};return n._tippy=G,D._tippy=G,pe(),w.lazy||ke(),w.showOnInit&&Ce(),!w.a11y||w.target||!K(I=J())||c.call(I,"a[href],area[href],button,details,input,textarea,select,iframe,[tabindex]")&&!I.hasAttribute("disabled")||J().setAttribute("tabindex","0"),D.addEventListener("mouseenter",function(e){G.props.interactive&&G.state.isVisible&&"mouseenter"===a&&Ce(e,!0)}),D.addEventListener("mouseleave",function(){G.props.interactive&&"mouseenter"===a&&document.addEventListener("mousemove",P)}),G;function z(){document.removeEventListener("mousemove",ve)}function Z(){document.body.removeEventListener("mouseleave",Ie),document.removeEventListener("mousemove",P),de=de.filter(function(e){return e!==P})}function J(){return G.props.triggerTarget||n}function te(){document.addEventListener("click",Ae,!0)}function ne(){document.removeEventListener("click",Ae,!0)}function re(){return[G.popperChildren.tooltip,G.popperChildren.backdrop,G.popperChildren.content]}function ie(){var e=G.props.followCursor;return e&&"focus"!==a||R&&"initial"===e}function oe(e,t){var n=G.popperChildren.tooltip;function r(e){e.target===n&&(ae(n,"remove",r),t())}if(0===e)return t();ae(n,"remove",T),ae(n,"add",r),T=r}function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];J().addEventListener(e,t,n),M.push({eventType:e,handler:t,options:n})}function pe(){G.props.touchHold&&!G.props.target&&(fe("touchstart",ye,p),fe("touchend",_e,p)),G.props.trigger.trim().split(" ").forEach(function(e){if("manual"!==e)if(G.props.target)switch(e){case"mouseenter":fe("mouseover",we),fe("mouseout",Ee);break;case"focus":fe("focusin",we),fe("focusout",Ee);break;case"click":fe(e,we)}else switch(fe(e,ye),e){case"mouseenter":fe("mouseleave",_e);break;case"focus":fe(i?"focusout":"blur",be)}})}function me(){M.forEach(function(e){var t=e.eventType,n=e.handler,r=e.options;J().removeEventListener(t,n,r)}),M=[]}function ve(e){var r=s=e,i=r.clientX,a=r.clientY;if(k){var o=f(e.target,function(e){return e===n}),u=n.getBoundingClientRect(),l=G.props.followCursor,c="horizontal"===l,d="vertical"===l,h=H(["top","bottom"],se(D)),p=D.getAttribute(v),m=!!p&&!!p.split("-")[1],y=h?D.offsetWidth:D.offsetHeight,g=y/2,_=h?0:m?y:g,b=h?m?y:g:0;!o&&G.props.interactive||(G.popperInstance.reference=t({},G.popperInstance.reference,{referenceNode:n,clientWidth:0,clientHeight:0,getBoundingClientRect:function(){return{width:h?y:0,height:h?0:y,top:(c?u.top:a)-_,bottom:(c?u.bottom:a)+_,left:(d?u.left:i)-b,right:(d?u.right:i)+b}}}),G.popperInstance.update()),"initial"===l&&G.state.isVisible&&z()}}function ye(e){G.state.isEnabled&&!Se(e)&&(G.state.isVisible||(a=e.type,e instanceof MouseEvent&&(s=e,de.forEach(function(t){return t(e)}))),"click"===e.type&&!1!==G.props.hideOnClick&&G.state.isVisible?Ie():Ce(e))}function ge(e){var t=h(e.target,C)===D,r=f(e.target,function(e){return e===n});t||r||function(e,t,n,r){if(!e)return!0;var i=n.clientX,a=n.clientY,s=r.interactiveBorder,o=r.distance,u=t.top-a>("top"===e?s+o:s),l=a-t.bottom>("bottom"===e?s+o:s),c=t.left-i>("left"===e?s+o:s),d=i-t.right>("right"===e?s+o:s);return u||l||c||d}(se(D),D.getBoundingClientRect(),e,G.props)&&(Z(),Ie())}function _e(e){if(!Se(e))return G.props.interactive?(document.body.addEventListener("mouseleave",Ie),document.addEventListener("mousemove",P),void de.push(P)):void Ie()}function be(e){e.target===J()&&(G.props.interactive&&e.relatedTarget&&D.contains(e.relatedTarget)||Ie())}function we(e){h(e.target,G.props.target)&&Ce(e)}function Ee(e){h(e.target,G.props.target)&&Ie()}function Se(e){var t="ontouchstart"in window,n=H(e.type,"touch"),r=G.props.touchHold;return t&&R&&r&&!n||R&&!r&&n}function Te(){!N&&S&&(N=!0,D.offsetHeight,S())}function ke(){var r=G.props.popperOptions,i=G.popperChildren,a=i.tooltip,s=i.arrow,o=j(r,"preventOverflow");function u(e){G.props.flip&&!G.props.flipOnUpdate&&(e.flipped&&(G.popperInstance.options.placement=e.placement),q(G.popperInstance.modifiers,!1)),a.setAttribute(v,e.placement),!1!==e.attributes[y]?a.setAttribute(y,""):a.removeAttribute(y),E&&E!==e.placement&&L&&(a.style.transition="none",requestAnimationFrame(function(){a.style.transition=""})),E=e.placement,L=G.state.isVisible;var n=se(D),r=a.style;r.top=r.bottom=r.left=r.right="",r[n]=-(G.props.distance-10)+"px";var i=o&&void 0!==o.padding?o.padding:m,s="number"==typeof i,u=t({top:s?i:i.top,bottom:s?i:i.bottom,left:s?i:i.left,right:s?i:i.right},!s&&i);u[n]=s?i+G.props.distance:(i[n]||0)+G.props.distance,G.popperInstance.modifiers.filter(function(e){return"preventOverflow"===e.name})[0].padding=u,k=u}var l=t({eventsEnabled:!1,placement:G.props.placement},r,{modifiers:t({},r?r.modifiers:{},{preventOverflow:t({boundariesElement:G.props.boundary,padding:m},o),arrow:t({element:s,enabled:!!s},j(r,"arrow")),flip:t({enabled:G.props.flip,padding:G.props.distance+m,behavior:G.props.flipBehavior},j(r,"flip")),offset:t({offset:G.props.offset},j(r,"offset"))}),onCreate:function(e){u(e),Te(),r&&r.onCreate&&r.onCreate(e)},onUpdate:function(e){u(e),Te(),r&&r.onUpdate&&r.onUpdate(e)}});G.popperInstance=new e(n,D,l)}function Ce(e,n){if(xe(),!G.state.isVisible){if(G.props.target)return function(e){if(e){var n=h(e.target,G.props.target);n&&!n._tippy&&he(n,t({},G.props,{content:W(r.content,[n]),appendTo:r.appendTo,target:"",showOnInit:!0}))}}(e);if(A=!0,e&&!n&&G.props.onTrigger(G,e),G.props.wait)return G.props.wait(G,e);ie()&&!G.state.isMounted&&(G.popperInstance||ke(),document.addEventListener("mousemove",ve)),te();var i=B(G.props.delay,0,o.delay);i?l=setTimeout(function(){Ne()},i):Ne()}}function Ie(){if(xe(),!G.state.isVisible)return z(),void ne();A=!1;var e=B(G.props.delay,1,o.delay);e?g=setTimeout(function(){G.state.isVisible&&Re()},e):b=requestAnimationFrame(function(){Re()})}function Ae(e){if(!G.props.interactive||!D.contains(e.target)){if(J().contains(e.target)){if(R)return;if(G.state.isVisible&&H(G.props.trigger,"click"))return}!0===G.props.hideOnClick&&(xe(),Re())}}function xe(){clearTimeout(l),clearTimeout(g),cancelAnimationFrame(b)}function Le(e){Q(e=e||{},o),me();var r=G.props,i=$(n,t({},G.props,{},e,{ignoreAttributes:!0}));i.ignoreAttributes=F(e,"ignoreAttributes")?e.ignoreAttributes||!1:r.ignoreAttributes,G.props=i,pe(),Z(),P=V(ge,i.interactiveDebounce),le(D,r,i),G.popperChildren=ee(D),G.popperInstance&&(u.some(function(t){return F(e,t)&&e[t]!==r[t]})?(G.popperInstance.destroy(),ke(),G.state.isVisible&&G.popperInstance.enableEventListeners(),G.props.followCursor&&s&&ve(s)):G.popperInstance.update())}function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(G.props.duration,0,o.duration[1]);if(!G.state.isDestroyed&&G.state.isEnabled&&(!R||G.props.touch)&&!J().hasAttribute("disabled")&&!1!==G.props.onShow(G)){te(),D.style.visibility="visible",G.state.isVisible=!0,G.props.interactive&&J().classList.add(_);var t=re();Y(t.concat(D),0),S=function(){if(G.state.isVisible){var r=ie();r&&s?ve(s):r||G.popperInstance.update(),G.popperChildren.backdrop&&(G.popperChildren.content.style.transitionDelay=Math.round(e/12)+"ms"),G.props.sticky&&function(){Y([D],i?0:G.props.updateDuration);var e=n.getBoundingClientRect();!function t(){var r=n.getBoundingClientRect();e.top===r.top&&e.right===r.right&&e.bottom===r.bottom&&e.left===r.left||G.popperInstance.scheduleUpdate(),e=r,G.state.isMounted&&requestAnimationFrame(t)}()}(),Y([D],G.props.updateDuration),Y(t,e),X(t,"visible"),function(e,t){oe(e,function(){G.props.aria&&J().setAttribute("aria-".concat(G.props.aria),D.id),G.props.onShown(G),G.state.isShown=!0})}(e)}},function(){N=!1;var e=ie();G.popperInstance?(q(G.popperInstance.modifiers,G.props.flip),e||(G.popperInstance.reference=n,G.popperInstance.enableEventListeners()),G.popperInstance.scheduleUpdate()):(ke(),e||G.popperInstance.enableEventListeners());var t=G.props.appendTo,r="parent"===t?n.parentNode:W(t,[n]);r.contains(D)||(r.appendChild(D),G.props.onMount(G),G.state.isMounted=!0)}()}}function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(G.props.duration,1,o.duration[1]);if(!G.state.isDestroyed&&(G.state.isEnabled||x)&&(!1!==G.props.onHide(G)||x)){ne(),D.style.visibility="hidden",G.state.isVisible=!1,G.state.isShown=!1,L=!1,G.props.interactive&&J().classList.remove(_);var t=re();Y(t,e),X(t,"hidden"),function(e,t){oe(e,function(){!G.state.isVisible&&D.parentNode&&D.parentNode.contains(D)&&(A||z(),G.props.aria&&J().removeAttribute("aria-".concat(G.props.aria)),G.popperInstance.disableEventListeners(),G.popperInstance.options.placement=G.props.placement,D.parentNode.removeChild(D),G.props.onHidden(G),G.state.isMounted=!1)})}(e)}}}var fe=!1;function pe(e,n){Q(n||{},o),fe||(document.addEventListener("touchstart",M,p),window.addEventListener("blur",D),fe=!0);var r,i=t({},o,{},n);r=e,"[object Object]"!=={}.toString.call(r)||r.addEventListener||function(e){var t={isVirtual:!0,attributes:e.attributes||{},contains:function(){},setAttribute:function(t,n){e.attributes[t]=n},getAttribute:function(t){return e.attributes[t]},removeAttribute:function(t){delete e.attributes[t]},hasAttribute:function(t){return t in e.attributes},addEventListener:function(){},removeEventListener:function(){},classList:{classNames:{},add:function(t){e.classList.classNames[t]=!0},remove:function(t){delete e.classList.classNames[t]},contains:function(t){return t in e.classList.classNames}}};for(var n in t)e[n]=t[n]}(e);var a=function(e){if(G(e))return[e];if(e instanceof NodeList)return d(e);if(Array.isArray(e))return e;try{return d(document.querySelectorAll(e))}catch(e){return[]}}(e).reduce(function(e,t){var n=t&&he(t,i);return n&&e.push(n),e},[]);return G(e)?a[0]:a}return pe.version="4.3.5",pe.defaults=o,pe.setDefaults=function(e){Object.keys(e).forEach(function(t){o[t]=e[t]})},pe.hideAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.exclude,n=e.duration;d(document.querySelectorAll(C)).forEach(function(e){var r,i=e._tippy;if(i){var a=!1;t&&(a=(r=t)._tippy&&!c.call(r,C)?i.reference===t:e===t.popper),a||i.hide(n)}})},pe.group=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.delay,i=void 0===r?e[0].props.delay:r,a=n.duration,s=void 0===a?0:a,o=!1;function u(e){o=e,h()}function l(t){t._originalProps.onShow(t),e.forEach(function(e){e.set({duration:s}),e.state.isVisible&&e.hide()}),u(!0)}function c(e){e._originalProps.onHide(e),u(!1)}function d(e){e._originalProps.onShown(e),e.set({duration:e._originalProps.duration})}function h(){e.forEach(function(e){e.set({onShow:l,onShown:d,onHide:c,delay:o?[0,Array.isArray(i)?i[1]:i]:i,duration:o?s:e._originalProps.duration})})}e.forEach(function(e){e._originalProps?e.set(e._originalProps):e._originalProps=t({},e.props)}),h()},n&&setTimeout(function(){d(document.querySelectorAll("[data-tippy]")).forEach(function(e){var t=e.getAttribute("data-tippy");t&&pe(e,{content:t})})}),pe}(n(14))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__14__},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.goog=window.goog||{};window.goog;window.asserts=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"assert",value:function(e,t){console.assert&&console.assert(e,t)}}],(r=null)&&n(t.prototype,r),i&&n(t,i),e}(),window.asserts.ENABLE_ASSERTS&&console.assert&&(window.asserts.assert=function(e,t){return console.assert(e,t)})},function(e,t,n){(function(t,n){var r;e.exports=function e(t,n,i){function a(o,u){if(!n[o]){if(!t[o]){var l="function"==typeof r&&r;if(!u&&l)return r(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n||e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof r&&r,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){var r=e("./utils").addDataAttr,i=e("./browser");t.exports=function(e,t){r(t,i.currentScript(e)),void 0===t.isFileProtocol&&(t.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(e.location.protocol)),t.async=t.async||!1,t.fileAsync=t.fileAsync||!1,t.poll=t.poll||(t.isFileProtocol?1e3:1500),t.env=t.env||("127.0.0.1"==e.location.hostname||"0.0.0.0"==e.location.hostname||"localhost"==e.location.hostname||e.location.port&&e.location.port.length>0||t.isFileProtocol?"development":"production");var n=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(e.location.hash);n&&(t.dumpLineNumbers=n[1]),void 0===t.useFileCache&&(t.useFileCache=!0),void 0===t.onReady&&(t.onReady=!0),t.relativeUrls&&(t.rewriteUrls="all")}},{"./browser":3,"./utils":11}],2:[function(e,t,n){e("promise/polyfill");var r=e("../less/default-options")();if(window.less)for(key in window.less)window.less.hasOwnProperty(key)&&(r[key]=window.less[key]);e("./add-default-options")(window,r),r.plugins=r.plugins||[],window.LESS_PLUGINS&&(r.plugins=r.plugins.concat(window.LESS_PLUGINS));var i,a,s,o=t.exports=e("./index")(window,r);function u(e){e.filename&&console.warn(e),r.async||a.removeChild(s)}window.less=o,r.onReady&&(/!watch/.test(window.location.hash)&&o.watch(),r.async||(i="body { display: none !important }",a=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("style")).type="text/css",s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),a.appendChild(s)),o.registerStylesheetsImmediately(),o.pageLoadFinished=o.refresh("development"===o.env).then(u,u))},{"../less/default-options":17,"./add-default-options":1,"./index":8,"promise/polyfill":104}],3:[function(e,t,n){var r=e("./utils");t.exports={createCSS:function(e,t,n){var i=n.href||"",a="less:"+(n.title||r.extractId(i)),s=e.getElementById(a),o=!1,u=e.createElement("style");u.setAttribute("type","text/css"),n.media&&u.setAttribute("media",n.media),u.id=a,u.styleSheet||(u.appendChild(e.createTextNode(t)),o=null!==s&&s.childNodes.length>0&&u.childNodes.length>0&&s.firstChild.nodeValue===u.firstChild.nodeValue);var l=e.getElementsByTagName("head")[0];if(null===s||!1===o){var c=n&&n.nextSibling||null;c?c.parentNode.insertBefore(u,c):l.appendChild(u)}if(s&&!1===o&&s.parentNode.removeChild(s),u.styleSheet)try{u.styleSheet.cssText=t}catch(e){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(e){var t,n=e.document;return n.currentScript||(t=n.getElementsByTagName("script"))[t.length-1]}}},{"./utils":11}],4:[function(e,t,n){t.exports=function(e,t,n){var r=null;if("development"!==t.env)try{r=void 0===e.localStorage?null:e.localStorage}catch(e){}return{setCSS:function(e,t,i,a){if(r){n.info("saving "+e+" to cache.");try{r.setItem(e,a),r.setItem(e+":timestamp",t),i&&r.setItem(e+":vars",JSON.stringify(i))}catch(t){n.error('failed to save "'+e+'" to local storage for caching.')}}},getCSS:function(e,t,n){var i=r&&r.getItem(e),a=r&&r.getItem(e+":timestamp"),s=r&&r.getItem(e+":vars");if(n=n||{},s=s||"{}",a&&t.lastModified&&new Date(t.lastModified).valueOf()===new Date(a).valueOf()&&JSON.stringify(n)===s)return i}}}},{}],5:[function(e,t,n){var r=e("./utils"),i=e("./browser");t.exports=function(e,t,n){return{add:function(a,s){n.errorReporting&&"html"!==n.errorReporting?"console"===n.errorReporting?function(e,r){var i=e.filename||r,a=[],s=(e.type||"Syntax")+"Error: "+(e.message||"There is an error in your .less file")+" in "+i,o=function(e,t,n){void 0!==e.extract[t]&&a.push("{line} {content}".replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};e.line&&(o(e,0,""),o(e,1,"line"),o(e,2,""),s+=" on line "+e.line+", column "+(e.column+1)+":\n"+a.join("\n")),e.stack&&(e.extract||n.logLevel>=4)&&(s+="\nStack Trace\n"+e.stack),t.logger.error(s)}(a,s):"function"==typeof n.errorReporting&&n.errorReporting("add",a,s):function(t,a){var s,o,u="less-error-message:"+r.extractId(a||""),l=e.document.createElement("div"),c=[],d=t.filename||a,h=d.match(/([^\/]+(\?.*)?)$/)[1];l.id=u,l.className="less-error-message",o="<h3>"+(t.type||"Syntax")+"Error: "+(t.message||"There is an error in your .less file")+'</h3><p>in <a href="'+d+'">'+h+"</a> ";var f=function(e,t,n){void 0!==e.extract[t]&&c.push('<li><label>{line}</label><pre class="{class}">{content}</pre></li>'.replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};t.line&&(f(t,0,""),f(t,1,"line"),f(t,2,""),o+="on line "+t.line+", column "+(t.column+1)+":</p><ul>"+c.join("")+"</ul>"),t.stack&&(t.extract||n.logLevel>=4)&&(o+="<br/>Stack Trace</br />"+t.stack.split("\n").slice(1).join("<br/>")),l.innerHTML=o,i.createCSS(e.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),l.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===n.env&&(s=setInterval(function(){var t=e.document,n=t.body;n&&(t.getElementById(u)?n.replaceChild(l,t.getElementById(u)):n.insertBefore(l,n.firstChild),clearInterval(s))},10))}(a,s)},remove:function(t){n.errorReporting&&"html"!==n.errorReporting?"console"===n.errorReporting||"function"==typeof n.errorReporting&&n.errorReporting("remove",t):function(t){var n=e.document.getElementById("less-error-message:"+r.extractId(t));n&&n.parentNode.removeChild(n)}(t)}}}},{"./browser":3,"./utils":11}],6:[function(e,t,n){t.exports=function(t,n){var r=e("../less/environment/abstract-file-manager.js"),i={},a=function(){};return(a.prototype=new r).alwaysMakePathsAbsolute=function(){return!0},a.prototype.join=function(e,t){return e?this.extractUrlParts(t,e).path:t},a.prototype.doXHR=function(e,r,i,a){var s=new XMLHttpRequest,o=!t.isFileProtocol||t.fileAsync;function u(t,n,r){t.status>=200&&t.status<300?n(t.responseText,t.getResponseHeader("Last-Modified")):"function"==typeof r&&r(t.status,e)}"function"==typeof s.overrideMimeType&&s.overrideMimeType("text/css"),n.debug("XHR: Getting '"+e+"'"),s.open("GET",e,o),s.setRequestHeader("Accept",r||"text/x-less, text/css; q=0.9, */*; q=0.5"),s.send(null),t.isFileProtocol&&!t.fileAsync?0===s.status||s.status>=200&&s.status<300?i(s.responseText):a(s.status,e):o?s.onreadystatechange=function(){4==s.readyState&&u(s,i,a)}:u(s,i,a)},a.prototype.supports=function(e,t,n,r){return!0},a.prototype.clearFileCache=function(){i={}},a.prototype.loadFile=function(e,t,n,r){t&&!this.isPathAbsolute(e)&&(e=t+e),e=n.ext?this.tryAppendExtension(e,n.ext):e,n=n||{};var a=this.extractUrlParts(e,window.location.href),s=a.url,o=this;return new Promise(function(e,t){if(n.useFileCache&&i[s])try{var r=i[s];return e({contents:r,filename:s,webInfo:{lastModified:new Date}})}catch(e){return t({filename:s,message:"Error loading file "+s+" error was "+e.message})}o.doXHR(s,n.mime,function(t,n){i[s]=t,e({contents:t,filename:s,webInfo:{lastModified:n}})},function(e,n){t({type:"File",message:"'"+n+"' wasn't found ("+e+")",href:s})})})},a}},{"../less/environment/abstract-file-manager.js":18}],7:[function(e,t,n){t.exports=function(){var t=e("./../less/functions/function-registry");function n(){throw{type:"Runtime",message:"Image size functions are not supported in browser version of less"}}var r={"image-size":function(e){return n(),-1},"image-width":function(e){return n(),-1},"image-height":function(e){return n(),-1}};t.addMultiple(r)}},{"./../less/functions/function-registry":27}],8:[function(e,t,n){var r=e("./utils").addDataAttr,i=e("./browser");t.exports=function(t,n){var a=t.document,s=e("../less")();s.options=n;var o=s.environment,u=e("./file-manager")(n,s.logger),l=new u;o.addFileManager(l),s.FileManager=u,s.PluginLoader=e("./plugin-loader"),e("./log-listener")(s,n);var c=e("./error-reporting")(t,s,n),d=s.cache=n.cache||e("./cache")(t,n,s.logger);e("./image-size")(s.environment),n.functions&&s.functions.functionRegistry.addMultiple(n.functions);var h=/^text\/(x-)?less$/;function f(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function p(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var r=n.concat(Array.prototype.slice.call(arguments,0));return e.apply(t,r)}}function m(e){for(var t,r=a.getElementsByTagName("style"),i=0;i<r.length;i++)if((t=r[i]).type.match(h)){var o=f(n);o.modifyVars=e;var u=t.innerHTML||"";o.filename=a.location.href.replace(/#.*$/,""),s.render(u,o,p(function(e,t,n){t?c.add(t,"inline"):(e.type="text/css",e.styleSheet?e.styleSheet.cssText=n.css:e.innerHTML=n.css)},null,t))}}function v(e,t,i,a,u){var h=f(n);r(h,e),h.mime=e.type,u&&(h.modifyVars=u),l.loadFile(e.href,null,h,o).then(function(n){!function(n){var r=n.contents,o=n.filename,u=n.webInfo,f={currentDirectory:l.getPath(o),filename:o,rootFilename:o,rewriteUrls:h.rewriteUrls};if(f.entryPath=f.currentDirectory,f.rootpath=h.rootpath||f.currentDirectory,u){u.remaining=a;var p=d.getCSS(o,u,h.modifyVars);if(!i&&p)return u.local=!0,void t(null,p,r,e,u,o)}c.remove(o),h.rootFileInfo=f,s.render(r,h,function(n,i){n?(n.href=o,t(n)):(d.setCSS(e.href,u.lastModified,h.modifyVars,i.css),t(null,i.css,r,e,u,o))})}(n)}).catch(function(e){console.log(e),t(e)})}function y(e,t,n){for(var r=0;r<s.sheets.length;r++)v(s.sheets[r],e,t,s.sheets.length-(r+1),n)}return s.watch=function(){return s.watchMode||(s.env="development","development"===s.env&&(s.watchTimer=setInterval(function(){s.watchMode&&(l.clearFileCache(),y(function(e,n,r,a,s){e?c.add(e,e.href||a.href):n&&i.createCSS(t.document,n,a)}))},n.poll))),this.watchMode=!0,!0},s.unwatch=function(){return clearInterval(s.watchTimer),this.watchMode=!1,!1},s.registerStylesheetsImmediately=function(){var e=a.getElementsByTagName("link");s.sheets=[];for(var t=0;t<e.length;t++)("stylesheet/less"===e[t].rel||e[t].rel.match(/stylesheet/)&&e[t].type.match(h))&&s.sheets.push(e[t])},s.registerStylesheets=function(){return new Promise(function(e,t){s.registerStylesheetsImmediately(),e()})},s.modifyVars=function(e){return s.refresh(!0,e,!1)},s.refresh=function(e,n,r){return(e||r)&&!1!==r&&l.clearFileCache(),new Promise(function(r,a){var o,u,l,d;o=u=new Date,0===(d=s.sheets.length)?(u=new Date,l=u-o,s.logger.info("Less has finished and no sheets were loaded."),r({startTime:o,endTime:u,totalMilliseconds:l,sheets:s.sheets.length})):y(function(e,n,h,f,p){if(e)return c.add(e,e.href||f.href),void a(e);p.local?s.logger.info("Loading "+f.href+" from cache."):s.logger.info("Rendered "+f.href+" successfully."),i.createCSS(t.document,n,f),s.logger.info("CSS for "+f.href+" generated in "+(new Date-u)+"ms"),0==--d&&(l=new Date-o,s.logger.info("Less has finished. CSS generated in "+l+"ms"),r({startTime:o,endTime:u,totalMilliseconds:l,sheets:s.sheets.length})),u=new Date},e,n),m(n)})},s.refreshStyles=m,s}},{"../less":37,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./image-size":7,"./log-listener":9,"./plugin-loader":10,"./utils":11}],9:[function(e,t,n){t.exports=function(e,t){t.logLevel=void 0!==t.logLevel?t.logLevel:"development"===t.env?3:1,t.loggers||(t.loggers=[{debug:function(e){t.logLevel>=4&&console.log(e)},info:function(e){t.logLevel>=3&&console.log(e)},warn:function(e){t.logLevel>=2&&console.warn(e)},error:function(e){t.logLevel>=1&&console.error(e)}}]);for(var n=0;n<t.loggers.length;n++)e.logger.addListener(t.loggers[n])}},{}],10:[function(e,t,n){var r=e("../less/environment/abstract-plugin-loader.js"),i=function(e){this.less=e};(i.prototype=new r).loadPlugin=function(e,t,n,r,i){return new Promise(function(a,s){i.loadFile(e,t,n,r).then(a).catch(s)})},t.exports=i},{"../less/environment/abstract-plugin-loader.js":19}],11:[function(e,t,n){t.exports={extractId:function(e){return e.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(e,t){for(var n in t.dataset)if(t.dataset.hasOwnProperty(n))if("env"===n||"dumpLineNumbers"===n||"rootpath"===n||"errorReporting"===n)e[n]=t.dataset[n];else try{e[n]=JSON.parse(t.dataset[n])}catch(e){}}}},{}],12:[function(e,t,n){t.exports={Math:{ALWAYS:0,PARENS_DIVISION:1,PARENS:2,STRICT_LEGACY:3},RewriteUrls:{OFF:0,LOCAL:1,ALL:2}}},{}],13:[function(e,t,n){var r={};t.exports=r;var i=e("./constants"),a=function(e,t,n){if(e)for(var r=0;r<n.length;r++)e.hasOwnProperty(n[r])&&(t[n[r]]=e[n[r]])},s=["paths","rewriteUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","pluginManager"];r.Parse=function(e){a(e,this,s),"string"==typeof this.paths&&(this.paths=[this.paths])};var o=["paths","compress","ieCompat","math","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope","rewriteUrls"];function u(e){return!/^(?:[a-z-]+:|\/|#)/i.test(e)}function l(e){return"."===e.charAt(0)}r.Eval=function(e,t){a(e,this,o),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=t||[],this.importantScope=this.importantScope||[]},r.Eval.prototype.enterCalc=function(){this.calcStack||(this.calcStack=[]),this.calcStack.push(!0),this.inCalc=!0},r.Eval.prototype.exitCalc=function(){this.calcStack.pop(),this.calcStack||(this.inCalc=!1)},r.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},r.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},r.Eval.prototype.inCalc=!1,r.Eval.prototype.mathOn=!0,r.Eval.prototype.isMathOn=function(e){return!!this.mathOn&&!!("/"!==e||this.math===i.Math.ALWAYS||this.parensStack&&this.parensStack.length)&&(!(this.math>i.Math.PARENS_DIVISION)||this.parensStack&&this.parensStack.length)},r.Eval.prototype.pathRequiresRewrite=function(e){var t=this.rewriteUrls===i.RewriteUrls.LOCAL?l:u;return t(e)},r.Eval.prototype.rewritePath=function(e,t){var n;return t=t||"",n=this.normalizePath(t+e),l(e)&&u(t)&&!1===l(n)&&(n="./"+n),n},r.Eval.prototype.normalizePath=function(e){var t,n=e.split("/").reverse();for(e=[];0!==n.length;)switch(t=n.pop()){case".":break;case"..":0===e.length||".."===e[e.length-1]?e.push(t):e.pop();break;default:e.push(t)}return e.join("/")}},{"./constants":12}],14:[function(e,t,n){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],15:[function(e,t,n){t.exports={colors:e("./colors"),unitConversions:e("./unit-conversions")}},{"./colors":14,"./unit-conversions":16}],16:[function(e,t,n){t.exports={length:{m:1,cm:.01,mm:.001,in:.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],17:[function(e,t,n){t.exports=function(){return{javascriptEnabled:!1,depends:!1,compress:!1,lint:!1,paths:[],color:!0,strictImports:!1,insecure:!1,rootpath:"",rewriteUrls:!1,ieCompat:!1,math:0,strictUnits:!1,globalVars:null,modifyVars:null,urlArgs:""}}},{}],18:[function(e,t,n){var r=function(){};r.prototype.getPath=function(e){var t=e.lastIndexOf("?");return t>0&&(e=e.slice(0,t)),(t=e.lastIndexOf("/"))<0&&(t=e.lastIndexOf("\\")),t<0?"":e.slice(0,t+1)},r.prototype.tryAppendExtension=function(e,t){return/(\.[a-z]*$)|([\?;].*)$/.test(e)?e:e+t},r.prototype.tryAppendLessExtension=function(e){return this.tryAppendExtension(e,".less")},r.prototype.supportsSync=function(){return!1},r.prototype.alwaysMakePathsAbsolute=function(){return!1},r.prototype.isPathAbsolute=function(e){return/^(?:[a-z-]+:|\/|\\|#)/i.test(e)},r.prototype.join=function(e,t){return e?e+t:t},r.prototype.pathDiff=function(e,t){var n,r,i,a,s=this.extractUrlParts(e),o=this.extractUrlParts(t),u="";if(s.hostPart!==o.hostPart)return"";for(r=Math.max(o.directories.length,s.directories.length),n=0;n<r&&o.directories[n]===s.directories[n];n++);for(a=o.directories.slice(n),i=s.directories.slice(n),n=0;n<a.length-1;n++)u+="../";for(n=0;n<i.length-1;n++)u+=i[n]+"/";return u},r.prototype.extractUrlParts=function(e,t){var n,r,i=/^((?:[a-z-]+:)?\/{2}(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,a=e.match(i),s={},o=[],u=[];if(!a)throw new Error("Could not parse sheet href - '"+e+"'");if(t&&(!a[1]||a[2])){if(!(r=t.match(i)))throw new Error("Could not parse page url - '"+t+"'");a[1]=a[1]||r[1]||"",a[2]||(a[3]=r[3]+a[3])}if(a[3])for(o=a[3].replace(/\\/g,"/").split("/"),n=0;n<o.length;n++)".."===o[n]?u.pop():"."!==o[n]&&u.push(o[n]);return s.hostPart=a[1],s.directories=u,s.rawPath=(a[1]||"")+o.join("/"),s.path=(a[1]||"")+u.join("/"),s.filename=a[4],s.fileUrl=s.path+(a[4]||""),s.url=s.fileUrl+(a[5]||""),s},t.exports=r},{}],19:[function(e,t,n){var r=e("../functions/function-registry"),i=e("../less-error"),a=function(){this.require=function(){return null}};a.prototype.evalPlugin=function(e,t,n,a,s){var o,u,l,c,d,h;c=t.pluginManager,s&&(d="string"==typeof s?s:s.filename);var f=(new this.less.FileManager).extractUrlParts(d).filename;if(d&&(u=c.get(d))){if(h=this.trySetOptions(u,d,f,a))return h;try{u.use&&u.use.call(this.context,u)}catch(e){return e.message=e.message||"Error during @plugin call",new i(e,n,d)}return u}l={exports:{},pluginManager:c,fileInfo:s},o=r.create();try{new Function("module","require","registerPlugin","functions","tree","less","fileInfo",e)(l,this.require(d),function(e){u=e},o,this.less.tree,this.less,s)}catch(e){return new i(e,n,d)}if(u||(u=l.exports),(u=this.validatePlugin(u,d,f))instanceof i)return u;if(!u)return new i({message:"Not a valid plugin"},n,d);if(u.imports=n,u.filename=d,(!u.minVersion||this.compareVersion("3.0.0",u.minVersion)<0)&&(h=this.trySetOptions(u,d,f,a)))return h;if(c.addPlugin(u,s.filename,o),u.functions=o.getLocalFunctions(),h=this.trySetOptions(u,d,f,a))return h;try{u.use&&u.use.call(this.context,u)}catch(e){return e.message=e.message||"Error during @plugin call",new i(e,n,d)}return u},a.prototype.trySetOptions=function(e,t,n,r){if(r&&!e.setOptions)return new i({message:"Options have been provided but the plugin "+n+" does not support any options."});try{e.setOptions&&e.setOptions(r)}catch(e){return new i(e)}},a.prototype.validatePlugin=function(e,t,n){return e?("function"==typeof e&&(e=new e),e.minVersion&&this.compareVersion(e.minVersion,this.less.version)<0?new i({message:"Plugin "+n+" requires version "+this.versionToString(e.minVersion)}):e):null},a.prototype.compareVersion=function(e,t){"string"==typeof e&&(e=e.match(/^(\d+)\.?(\d+)?\.?(\d+)?/)).shift();for(var n=0;n<e.length;n++)if(e[n]!==t[n])return parseInt(e[n])>parseInt(t[n])?-1:1;return 0},a.prototype.versionToString=function(e){for(var t="",n=0;n<e.length;n++)t+=(t?".":"")+e[n];return t},a.prototype.printUsage=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.printUsage&&n.printUsage()}},t.exports=a},{"../functions/function-registry":27,"../less-error":38}],20:[function(e,t,n){var r=e("../logger"),i=function(e,t){this.fileManagers=t||[],e=e||{};for(var n=[],r=n.concat(["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"]),i=0;i<r.length;i++){var a=r[i],s=e[a];s?this[a]=s.bind(e):i<n.length&&this.warn("missing required function in environment - "+a)}};i.prototype.getFileManager=function(e,t,n,i,a){e||r.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==t&&r.warn("getFileManager called with null directory.. Please report this issue. continuing.");var s=this.fileManagers;n.pluginManager&&(s=[].concat(s).concat(n.pluginManager.getFileManagers()));for(var o=s.length-1;o>=0;o--){var u=s[o];if(u[a?"supportsSync":"supports"](e,t,n,i))return u}return null},i.prototype.addFileManager=function(e){this.fileManagers.push(e)},i.prototype.clearFileManagers=function(){this.fileManagers=[]},t.exports=i},{"../logger":39}],21:[function(e,t,n){var r=e("./function-registry"),i=e("../tree/anonymous"),a=e("../tree/keyword");r.addMultiple({boolean:function(e){return e?a.True:a.False},if:function(e,t,n){return e?t:n||new i}})},{"../tree/anonymous":50,"../tree/keyword":70,"./function-registry":27}],22:[function(e,t,n){var r=e("../tree/color"),i=e("./function-registry");function a(e,t,n){var i,a,s,o,u=t.alpha,l=n.alpha,c=[];s=l+u*(1-l);for(var d=0;d<3;d++)i=t.rgb[d]/255,a=n.rgb[d]/255,o=e(i,a),s&&(o=(l*a+u*(i-l*(i+a-o)))/s),c[d]=255*o;return new r(c,s)}var s={multiply:function(e,t){return e*t},screen:function(e,t){return e+t-e*t},overlay:function(e,t){return(e*=2)<=1?s.multiply(e,t):s.screen(e-1,t)},softlight:function(e,t){var n=1,r=e;return t>.5&&(r=1,n=e>.25?Math.sqrt(e):((16*e-12)*e+4)*e),e-(1-2*t)*r*(n-e)},hardlight:function(e,t){return s.overlay(t,e)},difference:function(e,t){return Math.abs(e-t)},exclusion:function(e,t){return e+t-2*e*t},average:function(e,t){return(e+t)/2},negation:function(e,t){return 1-Math.abs(e+t-1)}};for(var o in s)s.hasOwnProperty(o)&&(a[o]=a.bind(null,s[o]));i.addMultiple(a)},{"../tree/color":55,"./function-registry":27}],23:[function(e,t,n){var r,i=e("../tree/dimension"),a=e("../tree/color"),s=e("../tree/quoted"),o=e("../tree/anonymous"),u=e("./function-registry");function l(e){return Math.min(1,Math.max(0,e))}function c(e,t){var n=r.hsla(t.h,t.s,t.l,t.a);if(n)return e.value&&/^(rgb|hsl)/.test(e.value)?n.value=e.value:n.value="rgb",n}function d(e){if(e instanceof i)return parseFloat(e.unit.is("%")?e.value/100:e.value);if("number"==typeof e)return e;throw{type:"Argument",message:"color functions take numbers as parameters"}}r={rgb:function(e,t,n){var i=r.rgba(e,t,n,1);if(i)return i.value="rgb",i},rgba:function(e,t,n,r){try{if(e instanceof a)return r=t?d(t):e.alpha,new a(e.rgb,r,"rgba");var s=[e,t,n].map(function(e){return n=255,(t=e)instanceof i&&t.unit.is("%")?parseFloat(t.value*n/100):d(t);var t,n});return r=d(r),new a(s,r,"rgba")}catch(e){}},hsl:function(e,t,n){var i=r.hsla(e,t,n,1);if(i)return i.value="hsl",i},hsla:function(e,t,n,r){try{if(e instanceof a)return r=t?d(t):e.alpha,new a(e.rgb,r,"hsla");var i,s;function o(e){return 6*(e=e<0?e+1:e>1?e-1:e)<1?i+(s-i)*e*6:2*e<1?s:3*e<2?i+(s-i)*(2/3-e)*6:i}e=d(e)%360/360,t=l(d(t)),n=l(d(n)),r=l(d(r)),i=2*n-(s=n<=.5?n*(t+1):n+t-n*t);var u=[255*o(e+1/3),255*o(e),255*o(e-1/3)];return r=d(r),new a(u,r,"hsla")}catch(e){}},hsv:function(e,t,n){return r.hsva(e,t,n,1)},hsva:function(e,t,n,i){var a,s;e=d(e)%360/360*360,t=d(t),n=d(n),i=d(i),a=Math.floor(e/60%6);var o=[n,n*(1-t),n*(1-(s=e/60-a)*t),n*(1-(1-s)*t)],u=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return r.rgba(255*o[u[a][0]],255*o[u[a][1]],255*o[u[a][2]],i)},hue:function(e){return new i(e.toHSL().h)},saturation:function(e){return new i(100*e.toHSL().s,"%")},lightness:function(e){return new i(100*e.toHSL().l,"%")},hsvhue:function(e){return new i(e.toHSV().h)},hsvsaturation:function(e){return new i(100*e.toHSV().s,"%")},hsvvalue:function(e){return new i(100*e.toHSV().v,"%")},red:function(e){return new i(e.rgb[0])},green:function(e){return new i(e.rgb[1])},blue:function(e){return new i(e.rgb[2])},alpha:function(e){return new i(e.toHSL().a)},luma:function(e){return new i(e.luma()*e.alpha*100,"%")},luminance:function(e){var t=.2126*e.rgb[0]/255+.7152*e.rgb[1]/255+.0722*e.rgb[2]/255;return new i(t*e.alpha*100,"%")},saturate:function(e,t,n){if(!e.rgb)return null;var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.s+=r.s*t.value/100:r.s+=t.value/100,r.s=l(r.s),c(e,r)},desaturate:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.s-=r.s*t.value/100:r.s-=t.value/100,r.s=l(r.s),c(e,r)},lighten:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.l+=r.l*t.value/100:r.l+=t.value/100,r.l=l(r.l),c(e,r)},darken:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.l-=r.l*t.value/100:r.l-=t.value/100,r.l=l(r.l),c(e,r)},fadein:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.a+=r.a*t.value/100:r.a+=t.value/100,r.a=l(r.a),c(e,r)},fadeout:function(e,t,n){var r=e.toHSL();return void 0!==n&&"relative"===n.value?r.a-=r.a*t.value/100:r.a-=t.value/100,r.a=l(r.a),c(e,r)},fade:function(e,t){var n=e.toHSL();return n.a=t.value/100,n.a=l(n.a),c(e,n)},spin:function(e,t){var n=e.toHSL(),r=(n.h+t.value)%360;return n.h=r<0?360+r:r,c(e,n)},mix:function(e,t,n){e.toHSL&&t.toHSL||(console.log(t.type),console.dir(t)),n||(n=new i(50));var r=n.value/100,s=2*r-1,o=e.toHSL().a-t.toHSL().a,u=((s*o==-1?s:(s+o)/(1+s*o))+1)/2,l=1-u,c=[e.rgb[0]*u+t.rgb[0]*l,e.rgb[1]*u+t.rgb[1]*l,e.rgb[2]*u+t.rgb[2]*l],d=e.alpha*r+t.alpha*(1-r);return new a(c,d)},greyscale:function(e){return r.desaturate(e,new i(100))},contrast:function(e,t,n,i){if(!e.rgb)return null;if(void 0===n&&(n=r.rgba(255,255,255,1)),void 0===t&&(t=r.rgba(0,0,0,1)),t.luma()>n.luma()){var a=n;n=t,t=a}return i=void 0===i?.43:d(i),e.luma()<i?n:t},argb:function(e){return new o(e.toARGB())},color:function(e){if(e instanceof s&&/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})$/i.test(e.value)){var t=e.value.slice(1);return new a(t,void 0,"#"+t)}if(e instanceof a||(e=a.fromKeyword(e.value)))return e.value=void 0,e;throw{type:"Argument",message:"argument must be a color keyword or 3|4|6|8 digit hex e.g. #FFF"}},tint:function(e,t){return r.mix(r.rgb(255,255,255),e,t)},shade:function(e,t){return r.mix(r.rgb(0,0,0),e,t)}},u.addMultiple(r)},{"../tree/anonymous":50,"../tree/color":55,"../tree/dimension":62,"../tree/quoted":80,"./function-registry":27}],24:[function(e,t,n){t.exports=function(t){var n=e("../tree/quoted"),r=e("../tree/url"),i=e("../utils"),a=e("./function-registry"),s=function(e,t){return new r(t,e.index,e.currentFileInfo).eval(e.context)},o=e("../logger");a.add("data-uri",function(e,a){a||(a=e,e=null);var u=e&&e.value,l=a.value,c=this.currentFileInfo,d=c.rewriteUrls?c.currentDirectory:c.entryPath,h=l.indexOf("#"),f="";-1!==h&&(f=l.slice(h),l=l.slice(0,h));var p=i.clone(this.context);p.rawBuffer=!0;var m=t.getFileManager(l,d,p,t,!0);if(!m)return s(this,a);var v=!1;if(e)v=/;base64$/.test(u);else{if("image/svg+xml"===(u=t.mimeLookup(l)))v=!1;else{var y=t.charsetLookup(u);v=["US-ASCII","UTF-8"].indexOf(y)<0}v&&(u+=";base64")}var g=m.loadFileSync(l,d,p,t);if(!g.contents)return o.warn("Skipped data-uri embedding of "+l+" because file not found"),s(this,a||e);var _=g.contents;if(v&&!t.encodeBase64)return s(this,a);_=v?t.encodeBase64(_):encodeURIComponent(_);var b="data:"+u+","+_+f;return b.length>=32768&&!1!==this.context.ieCompat?(o.warn("Skipped data-uri embedding of "+l+" because its size ("+b.length+" characters) exceeds IE8-safe 32768 characters!"),s(this,a||e)):new r(new n('"'+b+'"',b,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":39,"../tree/quoted":80,"../tree/url":85,"../utils":89,"./function-registry":27}],25:[function(e,t,n){var r=e("../tree/keyword"),i=e("./function-registry"),a={eval:function(){var e=this.value_,t=this.error_;if(t)throw t;if(null!=e)return e?r.True:r.False},value:function(e){this.value_=e},error:function(e){this.error_=e},reset:function(){this.value_=this.error_=null}};i.add("default",a.eval.bind(a)),t.exports=a},{"../tree/keyword":70,"./function-registry":27}],26:[function(e,t,n){var r=e("../tree/expression"),i=function(e,t,n,r){this.name=e.toLowerCase(),this.index=n,this.context=t,this.currentFileInfo=r,this.func=t.frames[0].functionRegistry.get(this.name)};i.prototype.isValid=function(){return Boolean(this.func)},i.prototype.call=function(e){return Array.isArray(e)&&(e=e.filter(function(e){return"Comment"!==e.type}).map(function(e){if("Expression"===e.type){var t=e.value.filter(function(e){return"Comment"!==e.type});return 1===t.length?t[0]:new r(t)}return e})),this.func.apply(this,e)},t.exports=i},{"../tree/expression":64}],27:[function(e,t,n){t.exports=function e(t){return{_data:{},add:function(e,t){e=e.toLowerCase(),this._data.hasOwnProperty(e),this._data[e]=t},addMultiple:function(e){Object.keys(e).forEach(function(t){this.add(t,e[t])}.bind(this))},get:function(e){return this._data[e]||t&&t.get(e)},getLocalFunctions:function(){return this._data},inherit:function(){return e(this)},create:function(t){return e(t)}}}(null)},{}],28:[function(e,t,n){t.exports=function(t){var n={functionRegistry:e("./function-registry"),functionCaller:e("./function-caller")};return e("./boolean"),e("./default"),e("./color"),e("./color-blending"),e("./data-uri")(t),e("./list"),e("./math"),e("./number"),e("./string"),e("./svg")(t),e("./types"),n}},{"./boolean":21,"./color":23,"./color-blending":22,"./data-uri":24,"./default":25,"./function-caller":26,"./function-registry":27,"./list":29,"./math":31,"./number":32,"./string":33,"./svg":34,"./types":35}],29:[function(e,t,n){var r=e("../tree/comment"),i=e("../tree/dimension"),a=e("../tree/declaration"),s=e("../tree/expression"),o=e("../tree/ruleset"),u=e("../tree/selector"),l=e("../tree/element"),c=e("./function-registry"),d=function(e){var t=Array.isArray(e.value)?e.value:Array(e);return t};c.addMultiple({_SELF:function(e){return e},extract:function(e,t){return t=t.value-1,d(e)[t]},length:function(e){return new i(d(e).length)},range:function(e,t,n){var r,a,o=1,u=[];t?(a=t,r=e.value,n&&(o=n.value)):(r=1,a=e);for(var l=r;l<=a.value;l+=o)u.push(new i(l,a.unit));return new s(u)},each:function(e,t){var n,s,c=[];s=e.value?Array.isArray(e.value)?e.value:[e.value]:e.ruleset?e.ruleset.rules:e.rules?e.rules:Array.isArray(e)?e:[e];var d="@value",h="@key",f="@index";t.params?(d=t.params[0]&&t.params[0].name,h=t.params[1]&&t.params[1].name,f=t.params[2]&&t.params[2].name,t=t.rules):t=t.ruleset;for(var p=0;p<s.length;p++){var m,v,y=s[p];y instanceof a?(m="string"==typeof y.name?y.name:y.name[0].value,v=y.value):(m=new i(p+1),v=y),y instanceof r||(n=t.rules.slice(0),d&&n.push(new a(d,v,!1,!1,this.index,this.currentFileInfo)),f&&n.push(new a(f,new i(p+1),!1,!1,this.index,this.currentFileInfo)),h&&n.push(new a(h,m,!1,!1,this.index,this.currentFileInfo)),c.push(new o([new u([new l("","&")])],n,t.strictImports,t.visibilityInfo())))}return new o([new u([new l("","&")])],c,t.strictImports,t.visibilityInfo()).eval(this.context)}})},{"../tree/comment":57,"../tree/declaration":60,"../tree/dimension":62,"../tree/element":63,"../tree/expression":64,"../tree/ruleset":81,"../tree/selector":82,"./function-registry":27}],30:[function(e,t,n){var r=e("../tree/dimension"),i=function(){};i._math=function(e,t,n){if(!(n instanceof r))throw{type:"Argument",message:"argument must be a number"};return null==t?t=n.unit:n=n.unify(),new r(e(parseFloat(n.value)),t)},t.exports=i},{"../tree/dimension":62}],31:[function(e,t,n){var r=e("./function-registry"),i=e("./math-helper.js"),a={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var s in a)a.hasOwnProperty(s)&&(a[s]=i._math.bind(null,Math[s],a[s]));a.round=function(e,t){var n=void 0===t?0:t.value;return i._math(function(e){return e.toFixed(n)},null,e)},r.addMultiple(a)},{"./function-registry":27,"./math-helper.js":30}],32:[function(e,t,n){var r=e("../tree/dimension"),i=e("../tree/anonymous"),a=e("./function-registry"),s=e("./math-helper.js"),o=function(e,t){switch((t=Array.prototype.slice.call(t)).length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var n,a,s,o,u,l,c,d,h=[],f={};for(n=0;n<t.length;n++)if((s=t[n])instanceof r)if(o=""===s.unit.toString()&&void 0!==d?new r(s.value,d).unify():s.unify(),l=""===o.unit.toString()&&void 0!==c?c:o.unit.toString(),c=""!==l&&void 0===c||""!==l&&""===h[0].unify().unit.toString()?l:c,d=""!==l&&void 0===d?s.unit.toString():d,void 0!==(a=void 0!==f[""]&&""!==l&&l===c?f[""]:f[l]))u=""===h[a].unit.toString()&&void 0!==d?new r(h[a].value,d).unify():h[a].unify(),(e&&o.value<u.value||!e&&o.value>u.value)&&(h[a]=s);else{if(void 0!==c&&l!==c)throw{type:"Argument",message:"incompatible types"};f[l]=h.length,h.push(s)}else Array.isArray(t[n].value)&&Array.prototype.push.apply(t,Array.prototype.slice.call(t[n].value));return 1==h.length?h[0]:(t=h.map(function(e){return e.toCSS(this.context)}).join(this.context.compress?",":", "),new i((e?"min":"max")+"("+t+")"))};a.addMultiple({min:function(){return o(!0,arguments)},max:function(){return o(!1,arguments)},convert:function(e,t){return e.convertTo(t.value)},pi:function(){return new r(Math.PI)},mod:function(e,t){return new r(e.value%t.value,e.unit)},pow:function(e,t){if("number"==typeof e&&"number"==typeof t)e=new r(e),t=new r(t);else if(!(e instanceof r&&t instanceof r))throw{type:"Argument",message:"arguments must be numbers"};return new r(Math.pow(e.value,t.value),e.unit)},percentage:function(e){var t=s._math(function(e){return 100*e},"%",e);return t}})},{"../tree/anonymous":50,"../tree/dimension":62,"./function-registry":27,"./math-helper.js":30}],33:[function(e,t,n){var r=e("../tree/quoted"),i=e("../tree/anonymous"),a=e("../tree/javascript"),s=e("./function-registry");s.addMultiple({e:function(e){return new i(e instanceof a?e.evaluated:e.value)},escape:function(e){return new i(encodeURI(e.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(e,t,n,i){var a=e.value;return n="Quoted"===n.type?n.value:n.toCSS(),a=a.replace(new RegExp(t.value,i?i.value:""),n),new r(e.quote||"",a,e.escaped)},"%":function(e){for(var t=Array.prototype.slice.call(arguments,1),n=e.value,i=0;i<t.length;i++)n=n.replace(/%[sda]/i,function(e){var n="Quoted"===t[i].type&&e.match(/s/i)?t[i].value:t[i].toCSS();return e.match(/[A-Z]$/)?encodeURIComponent(n):n});return n=n.replace(/%%/g,"%"),new r(e.quote||"",n,e.escaped)}})},{"../tree/anonymous":50,"../tree/javascript":68,"../tree/quoted":80,"./function-registry":27}],34:[function(e,t,n){t.exports=function(t){var n=e("../tree/dimension"),r=e("../tree/color"),i=e("../tree/expression"),a=e("../tree/quoted"),s=e("../tree/url"),o=e("./function-registry");o.add("svg-gradient",function(e){var t,o,u,l,c,d,h,f,p="linear",m='x="0" y="0" width="1" height="1"',v={compress:!1},y=e.toCSS(v);function g(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}switch(2==arguments.length?(arguments[1].value.length<2&&g(),t=arguments[1].value):arguments.length<3?g():t=Array.prototype.slice.call(arguments,1),y){case"to bottom":o='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":o='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":o='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":o='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":p="radial",o='cx="50%" cy="50%" r="75%"',m='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><'+p+'Gradient id="g" '+o+">",l=0;l<t.length;l+=1)t[l]instanceof i?(c=t[l].value[0],d=t[l].value[1]):(c=t[l],d=void 0),c instanceof r&&((0===l||l+1===t.length)&&void 0===d||d instanceof n)||g(),h=d?d.toCSS(v):0===l?"0%":"100%",f=c.alpha,u+='<stop offset="'+h+'" stop-color="'+c.toRGB()+'"'+(f<1?' stop-opacity="'+f+'"':"")+"/>";return u+="</"+p+"Gradient><rect "+m+' fill="url(#g)" /></svg>',u=encodeURIComponent(u),new s(new a("'"+(u="data:image/svg+xml,"+u)+"'",u,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":55,"../tree/dimension":62,"../tree/expression":64,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],35:[function(e,t,n){var r=e("../tree/keyword"),i=e("../tree/detached-ruleset"),a=e("../tree/dimension"),s=e("../tree/color"),o=e("../tree/quoted"),u=e("../tree/anonymous"),l=e("../tree/url"),c=e("../tree/operation"),d=e("./function-registry"),h=function(e,t){return e instanceof t?r.True:r.False},f=function(e,t){if(void 0===t)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(t="string"==typeof t.value?t.value:t))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return e instanceof a&&e.unit.is(t)?r.True:r.False};d.addMultiple({isruleset:function(e){return h(e,i)},iscolor:function(e){return h(e,s)},isnumber:function(e){return h(e,a)},isstring:function(e){return h(e,o)},iskeyword:function(e){return h(e,r)},isurl:function(e){return h(e,l)},ispixel:function(e){return f(e,"px")},ispercentage:function(e){return f(e,"%")},isem:function(e){return f(e,"em")},isunit:f,unit:function(e,t){if(!(e instanceof a))throw{type:"Argument",message:"the first argument to unit must be a number"+(e instanceof c?". Have you forgotten parenthesis?":"")};return t=t?t instanceof r?t.value:t.toCSS():"",new a(e.value,t)},"get-unit":function(e){return new u(e.unit)}})},{"../tree/anonymous":50,"../tree/color":55,"../tree/detached-ruleset":61,"../tree/dimension":62,"../tree/keyword":70,"../tree/operation":77,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],36:[function(e,t,n){var r=e("./contexts"),i=e("./parser/parser"),a=e("./less-error"),s=e("./utils"),o=("undefined"==typeof Promise?e("promise"):Promise,e("./logger"));t.exports=function(e){var t=function(e,t,n){this.less=e,this.rootFilename=n.filename,this.paths=t.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=t.mime,this.error=null,this.context=t,this.queue=[],this.files={}};return t.prototype.push=function(t,n,u,l,c){var d=this,h=this.context.pluginManager.Loader;this.queue.push(t);var f=function(e,n,r){d.queue.splice(d.queue.indexOf(t),1);var i=r===d.rootFilename;l.optional&&e?(c(null,{rules:[]},!1,null),o.info("The file "+r+" was skipped because it was not found and the import was marked optional.")):(d.files[r]||l.inline||(d.files[r]={root:n,options:l}),e&&!d.error&&(d.error=e),c(e,n,i,r))},p={rewriteUrls:this.context.rewriteUrls,entryPath:u.entryPath,rootpath:u.rootpath,rootFilename:u.rootFilename},m=e.getFileManager(t,u.currentDirectory,this.context,e);if(m){var v,y=function(e){var t,n=e.filename,s=e.contents.replace(/^\uFEFF/,"");p.currentDirectory=m.getPath(n),p.rewriteUrls&&(p.rootpath=m.join(d.context.rootpath||"",m.pathDiff(p.currentDirectory,p.entryPath)),!m.isPathAbsolute(p.rootpath)&&m.alwaysMakePathsAbsolute()&&(p.rootpath=m.join(p.entryPath,p.rootpath))),p.filename=n;var o=new r.Parse(d.context);o.processImports=!1,d.contents[n]=s,(u.reference||l.reference)&&(p.reference=!0),l.isPlugin?(t=h.evalPlugin(s,o,d,l.pluginArgs,p))instanceof a?f(t,null,n):f(null,t,n):l.inline?f(null,s,n):!d.files[n]||d.files[n].options.multiple||l.multiple?new i(o,d,p).parse(s,function(e,t){f(e,t,n)}):f(null,d.files[n].root,n)},g=s.clone(this.context);n&&(g.ext=l.isPlugin?".js":".less"),(v=l.isPlugin?h.loadPlugin(t,u.currentDirectory,g,e,m):m.loadFile(t,u.currentDirectory,g,e,function(e,t){e?f(e):y(t)}))&&v.then(y,f)}else f({message:"Could not find a file-manager for "+t})},t}},{"./contexts":13,"./less-error":38,"./logger":39,"./parser/parser":44,"./utils":89,promise:void 0}],37:[function(e,t,n){t.exports=function(t,n){var r,i,a,s,o,u,l={version:[3,9,0],data:e("./data"),tree:e("./tree"),Environment:o=e("./environment/environment"),AbstractFileManager:e("./environment/abstract-file-manager"),AbstractPluginLoader:e("./environment/abstract-plugin-loader"),environment:t=new o(t,n),visitors:e("./visitors"),Parser:e("./parser/parser"),functions:e("./functions")(t),contexts:e("./contexts"),SourceMapOutput:r=e("./source-map-output")(t),SourceMapBuilder:i=e("./source-map-builder")(r,t),ParseTree:a=e("./parse-tree")(i),ImportManager:s=e("./import-manager")(t),render:e("./render")(t,a,s),parse:e("./parse")(t,a,s),LessError:e("./less-error"),transformTree:e("./transform-tree"),utils:e("./utils"),PluginManager:e("./plugin-manager"),logger:e("./logger")},c=function(e){return function(){var t=Object.create(e.prototype);return e.apply(t,Array.prototype.slice.call(arguments,0)),t}},d=Object.create(l);for(var h in l.tree)if("function"==typeof(u=l.tree[h]))d[h.toLowerCase()]=c(u);else for(var f in d[h]=Object.create(null),u)d[h][f.toLowerCase()]=c(u[f]);return d}},{"./contexts":13,"./data":15,"./environment/abstract-file-manager":18,"./environment/abstract-plugin-loader":19,"./environment/environment":20,"./functions":28,"./import-manager":36,"./less-error":38,"./logger":39,"./parse":41,"./parse-tree":40,"./parser/parser":44,"./plugin-manager":45,"./render":46,"./source-map-builder":47,"./source-map-output":48,"./transform-tree":49,"./tree":67,"./utils":89,"./visitors":93}],38:[function(e,t,n){var r=e("./utils"),i=t.exports=function(e,t,n){Error.call(this);var i=e.filename||n;if(this.message=e.message,this.stack=e.stack,t&&i){var a=t.contents[i],s=r.getLocation(e.index,a),o=s.line,u=s.column,l=e.call&&r.getLocation(e.call,a).line,c=a?a.split("\n"):"";if(this.type=e.type||"Syntax",this.filename=i,this.index=e.index,this.line="number"==typeof o?o+1:null,this.column=u,!this.line&&this.stack){var d=this.stack.match(/(<anonymous>|Function):(\d+):(\d+)/);d&&(d[2]&&(this.line=parseInt(d[2])-2),d[3]&&(this.column=parseInt(d[3])))}this.callLine=l+1,this.callExtract=c[l],this.extract=[c[this.line-2],c[this.line-1],c[this.line]]}};if(void 0===Object.create){var a=function(){};a.prototype=Error.prototype,i.prototype=new a}else i.prototype=Object.create(Error.prototype);i.prototype.constructor=i,i.prototype.toString=function(e){e=e||{};var t="",n=this.extract||[],r=[],i=function(e){return e};if(e.stylize){var a=typeof e.stylize;if("function"!==a)throw Error("options.stylize should be a function, got a "+a+"!");i=e.stylize}if(null!==this.line){if("string"==typeof n[0]&&r.push(i(this.line-1+" "+n[0],"grey")),"string"==typeof n[1]){var s=this.line+" ";n[1]&&(s+=n[1].slice(0,this.column)+i(i(i(n[1].substr(this.column,1),"bold")+n[1].slice(this.column+1),"red"),"inverse")),r.push(s)}"string"==typeof n[2]&&r.push(i(this.line+1+" "+n[2],"grey")),r=r.join("\n")+i("","reset")+"\n"}return t+=i(this.type+"Error: "+this.message,"red"),this.filename&&(t+=i(" in ","red")+this.filename),this.line&&(t+=i(" on line "+this.line+", column "+(this.column+1)+":","grey")),t+="\n"+r,this.callLine&&(t+=i("from ","red")+(this.filename||"")+"/n",t+=i(this.callLine,"grey")+" "+this.callExtract+"/n"),t}},{"./utils":89}],39:[function(e,t,n){t.exports={error:function(e){this._fireEvent("error",e)},warn:function(e){this._fireEvent("warn",e)},info:function(e){this._fireEvent("info",e)},debug:function(e){this._fireEvent("debug",e)},addListener:function(e){this._listeners.push(e)},removeListener:function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)},_fireEvent:function(e,t){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n][e];r&&r(t)}},_listeners:[]}},{}],40:[function(e,t,n){var r=e("./less-error"),i=e("./transform-tree"),a=e("./logger");t.exports=function(e){var t=function(e,t){this.root=e,this.imports=t};return t.prototype.toCSS=function(t){var n,s,o={};try{n=i(this.root,t)}catch(e){throw new r(e,this.imports)}try{var u=Boolean(t.compress);u&&a.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var l={compress:u,dumpLineNumbers:t.dumpLineNumbers,strictUnits:Boolean(t.strictUnits),numPrecision:8};t.sourceMap?(s=new e(t.sourceMap),o.css=s.toCSS(n,l,this.imports)):o.css=n.toCSS(l)}catch(e){throw new r(e,this.imports)}if(t.pluginManager)for(var c=t.pluginManager.getPostProcessors(),d=0;d<c.length;d++)o.css=c[d].process(o.css,{sourceMap:s,options:t,imports:this.imports});for(var h in t.sourceMap&&(o.map=s.getExternalSourceMap()),o.imports=[],this.imports.files)this.imports.files.hasOwnProperty(h)&&h!==this.imports.rootFilename&&o.imports.push(h);return o},t}},{"./less-error":38,"./logger":39,"./transform-tree":49}],41:[function(e,t,n){var r,i=e("./contexts"),a=e("./parser/parser"),s=e("./plugin-manager"),o=e("./less-error"),u=e("./utils");t.exports=function(t,n,l){var c=function(t,n,d){if("function"==typeof n?(d=n,n=u.copyOptions(this.options,{})):n=u.copyOptions(this.options,n||{}),!d){r||(r="undefined"==typeof Promise?e("promise"):Promise);var h=this;return new r(function(e,r){c.call(h,t,n,function(t,n){t?r(t):e(n)})})}var f,p,m=new s(this,!n.reUsePluginManager);if(n.pluginManager=m,f=new i.Parse(n),n.rootFileInfo)p=n.rootFileInfo;else{var v=n.filename||"input",y=v.replace(/[^\/\\]*$/,"");(p={filename:v,rewriteUrls:f.rewriteUrls,rootpath:f.rootpath||"",currentDirectory:y,entryPath:y,rootFilename:v}).rootpath&&"/"!==p.rootpath.slice(-1)&&(p.rootpath+="/")}var g=new l(this,f,p);this.importManager=g,n.plugins&&n.plugins.forEach(function(e){var t,n;if(e.fileContent){if(n=e.fileContent.replace(/^\uFEFF/,""),(t=m.Loader.evalPlugin(n,f,g,e.options,e.filename))instanceof o)return d(t)}else m.addPlugin(e)}),new a(f,g,p).parse(t,function(e,t){if(e)return d(e);d(null,t,g,n)},n)};return c}},{"./contexts":13,"./less-error":38,"./parser/parser":44,"./plugin-manager":45,"./utils":89,promise:void 0}],42:[function(e,t,n){t.exports=function(e,t){var n,r,i,a,s,o,u,l,c,d=e.length,h=0,f=0,p=[],m=0;function v(t){var n=s-m;n<512&&!t||!n||(p.push(e.slice(m,s+1)),m=s+1)}for(s=0;s<d;s++)if(!((u=e.charCodeAt(s))>=97&&u<=122||u<34))switch(u){case 40:f++,r=s;continue;case 41:if(--f<0)return t("missing opening `(`",s);continue;case 59:f||v();continue;case 123:h++,n=s;continue;case 125:if(--h<0)return t("missing opening `{`",s);h||f||v();continue;case 92:if(s<d-1){s++;continue}return t("unescaped `\\`",s);case 34:case 39:case 96:for(c=0,o=s,s+=1;s<d;s++)if(!((l=e.charCodeAt(s))>96)){if(l==u){c=1;break}if(92==l){if(s==d-1)return t("unescaped `\\`",s);s++}}if(c)continue;return t("unmatched `"+String.fromCharCode(u)+"`",o);case 47:if(f||s==d-1)continue;if(47==(l=e.charCodeAt(s+1)))for(s+=2;s<d&&(!((l=e.charCodeAt(s))<=13)||10!=l&&13!=l);s++);else if(42==l){for(i=o=s,s+=2;s<d-1&&(125==(l=e.charCodeAt(s))&&(a=s),42!=l||47!=e.charCodeAt(s+1));s++);if(s==d-1)return t("missing closing `*/`",o);s++}continue;case 42:if(s<d-1&&47==e.charCodeAt(s+1))return t("unmatched `/*`",s);continue}return 0!==h?t(i>n&&a>i?"missing closing `}` or `*/`":"missing closing `}`",n):0!==f?t("missing closing `)`",r):(v(!0),p)}},{}],43:[function(e,t,n){var r=e("./chunker");t.exports=function(){var e,t,n,i,a,s,o,u=[],l={},c=32,d=9,h=10,f=13,p=47;function m(n){for(var r,i,u,v=l.i,y=t,g=l.i-o,_=l.i+s.length-g,b=l.i+=n,w=e;l.i<_;l.i++){if(r=w.charCodeAt(l.i),l.autoCommentAbsorb&&r===p){if("/"===(i=w.charAt(l.i+1))){u={index:l.i,isLineComment:!0};var E=w.indexOf("\n",l.i+2);E<0&&(E=_),l.i=E,u.text=w.substr(u.index,l.i-u.index),l.commentStore.push(u);continue}if("*"===i){var S=w.indexOf("*/",l.i+2);if(S>=0){u={index:l.i,text:w.substr(l.i,S+2-l.i),isLineComment:!1},l.i+=u.text.length-1,l.commentStore.push(u);continue}}break}if(r!==c&&r!==h&&r!==d&&r!==f)break}if(s=s.slice(n+l.i-b+g),o=l.i,!s.length){if(t<a.length-1)return s=a[++t],m(0),!0;l.finished=!0}return v!==l.i||y!==t}return l.save=function(){o=l.i,u.push({current:s,i:l.i,j:t})},l.restore=function(e){(l.i>n||l.i===n&&e&&!i)&&(n=l.i,i=e);var r=u.pop();s=r.current,o=l.i=r.i,t=r.j},l.forget=function(){u.pop()},l.isWhitespace=function(t){var n=l.i+(t||0),r=e.charCodeAt(n);return r===c||r===f||r===d||r===h},l.$re=function(e){l.i>o&&(s=s.slice(l.i-o),o=l.i);var t=e.exec(s);return t?(m(t[0].length),"string"==typeof t?t:1===t.length?t[0]:t):null},l.$char=function(t){return e.charAt(l.i)!==t?null:(m(1),t)},l.$str=function(t){for(var n=t.length,r=0;r<n;r++)if(e.charAt(l.i+r)!==t.charAt(r))return null;return m(n),t},l.$quoted=function(t){var n=t||l.i,r=e.charAt(n);if("'"===r||'"'===r){for(var i=e.length,a=n,s=1;s+a<i;s++){var o=e.charAt(s+a);switch(o){case"\\":s++;continue;case"\r":case"\n":break;case r:var u=e.substr(a,s+1);return t||0===t?[r,u]:(m(s+1),u)}}return null}},l.$parseUntil=function(t){var n,r="",i=null,a=!1,s=0,o=[],u=[],c=e.length,d=l.i,h=l.i,f=l.i,p=!0;n="string"==typeof t?function(e){return e===t}:function(e){return t.test(e)};do{var v=e.charAt(f);if(0===s&&n(v))(i=e.substr(h,f-h))?u.push(i):u.push(" "),i=u,m(f-d),p=!1;else{if(a){"*"===v&&"/"===e.charAt(f+1)&&(f++,s--,a=!1),f++;continue}switch(v){case"\\":f++,v=e.charAt(f),u.push(e.substr(h,f-h+1)),h=f+1;break;case"/":"*"===e.charAt(f+1)&&(f++,a=!0,s++);break;case"'":case'"':(r=l.$quoted(f))?(u.push(e.substr(h,f-h),r),f+=r[1].length-1,h=f+1):(m(f-d),i=v,p=!1);break;case"{":o.push("}"),s++;break;case"(":o.push(")"),s++;break;case"[":o.push("]"),s++;break;case"}":case")":case"]":var y=o.pop();v===y?s--:(m(f-d),i=y,p=!1)}++f>c&&(p=!1)}}while(p);return i||null},l.autoCommentAbsorb=!0,l.commentStore=[],l.finished=!1,l.peek=function(t){if("string"==typeof t){for(var n=0;n<t.length;n++)if(e.charAt(l.i+n)!==t.charAt(n))return!1;return!0}return t.test(s)},l.peekChar=function(t){return e.charAt(l.i)===t},l.currentChar=function(){return e.charAt(l.i)},l.prevChar=function(){return e.charAt(l.i-1)},l.getInput=function(){return e},l.peekNotNumeric=function(){var t=e.charCodeAt(l.i);return t>57||t<43||t===p||44===t},l.start=function(i,u,c){e=i,l.i=t=o=n=0,a=u?r(i,c):[i],s=a[0],m(0)},l.end=function(){var t,r=l.i>=e.length;return l.i<n&&(t=i,l.i=n),{isFinished:r,furthest:l.i,furthestPossibleErrorMessage:t,furthestReachedEnd:l.i>=e.length-1,furthestChar:e[l.i]}},l}},{"./chunker":42}],44:[function(e,t,n){var r=e("../less-error"),i=e("../tree"),a=e("../visitors"),s=e("./parser-input"),o=e("../utils"),u=e("../functions/function-registry"),l=function e(t,n,l){var c,d=s();function h(e,t){throw new r({index:d.i,filename:l.filename,type:t||"Syntax",message:e},n)}function f(e,t){var n=e instanceof Function?e.call(c):d.$re(e);if(n)return n;h(t||("string"==typeof e?"expected '"+e+"' got '"+d.currentChar()+"'":"unexpected token"))}function p(e,t){if(d.$char(e))return e;h(t||"expected '"+e+"' got '"+d.currentChar()+"'")}function m(e){var t=l.filename;return{lineNumber:o.getLocation(e,d.getInput()).line+1,fileName:t}}return{parserInput:d,imports:n,fileInfo:l,parseNode:function(e,t,i,a,s){var o,u=[],l=d;try{l.start(e,!1,function(e,t){s({message:e,index:t+i})});for(var h,f,p=0;h=t[p];p++)f=l.i,(o=c[h]())?(o._index=f+i,o._fileInfo=a,u.push(o)):u.push(null);var m=l.end();m.isFinished?s(null,u):s(!0,null)}catch(e){throw new r({index:e.index+i,message:e.message},n,a.filename)}},parse:function(s,o,c){var h,f,p,m,v=null,y="";if(f=c&&c.globalVars?e.serializeVars(c.globalVars)+"\n":"",p=c&&c.modifyVars?"\n"+e.serializeVars(c.modifyVars):"",t.pluginManager)for(var g=t.pluginManager.getPreProcessors(),_=0;_<g.length;_++)s=g[_].process(s,{context:t,imports:n,fileInfo:l});(f||c&&c.banner)&&(y=(c&&c.banner?c.banner:"")+f,(m=n.contentsIgnoredChars)[l.filename]=m[l.filename]||0,m[l.filename]+=y.length),s=s.replace(/\r\n?/g,"\n"),s=y+s.replace(/^\uFEFF/,"")+p,n.contents[l.filename]=s;try{d.start(s,t.chunkInput,function(e,t){throw new r({index:t,type:"Parse",message:e,filename:l.filename},n)}),i.Node.prototype.parse=this,h=new i.Ruleset(null,this.parsers.primary()),i.Node.prototype.rootNode=h,h.root=!0,h.firstRoot=!0,h.functionRegistry=u.inherit()}catch(e){return o(new r(e,n,l.filename))}var b=d.end();if(!b.isFinished){var w=b.furthestPossibleErrorMessage;w||(w="Unrecognised input","}"===b.furthestChar?w+=". Possibly missing opening '{'":")"===b.furthestChar?w+=". Possibly missing opening '('":b.furthestReachedEnd&&(w+=". Possibly missing something")),v=new r({type:"Parse",message:w,index:b.furthest,filename:l.filename},n)}var E=function(e){return(e=v||e||n.error)?(e instanceof r||(e=new r(e,n,l.filename)),o(e)):o(null,h)};if(!1===t.processImports)return E();new a.ImportVisitor(n,E).run(h)},parsers:c={primary:function(){for(var e,t=this.mixin,n=[];;){for(;e=this.comment();)n.push(e);if(d.finished)break;if(d.peek("}"))break;if(e=this.extendRule())n=n.concat(e);else if(e=t.definition()||this.declaration()||this.ruleset()||t.call(!1,!1)||this.variableCall()||this.entities.call()||this.atrule())n.push(e);else{for(var r=!1;d.$char(";");)r=!0;if(!r)break}}return n},comment:function(){if(d.commentStore.length){var e=d.commentStore.shift();return new i.Comment(e.text,e.isLineComment,e.index,l)}},entities:{mixinLookup:function(){return c.mixin.call(!0,!0)},quoted:function(e){var t,n=d.i,r=!1;if(d.save(),d.$char("~"))r=!0;else if(e)return void d.restore();if(t=d.$quoted())return d.forget(),new i.Quoted(t.charAt(0),t.substr(1,t.length-2),r,n,l);d.restore()},keyword:function(){var e=d.$char("%")||d.$re(/^\[?(?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+\]?/);if(e)return i.Color.fromKeyword(e)||new i.Keyword(e)},call:function(){var e,t,n,r=d.i;if(!d.peek(/^url\(/i))if(d.save(),e=d.$re(/^([\w-]+|%|progid:[\w\.]+)\(/)){if(e=e[1],(n=this.customFuncCall(e))&&(t=n.parse())&&n.stop)return d.forget(),t;if(t=this.arguments(t),d.$char(")"))return d.forget(),new i.Call(e,t,r,l);d.restore("Could not parse call arguments or missing ')'")}else d.forget()},customFuncCall:function(e){return{alpha:t(c.ieAlpha,!0),boolean:t(n),if:t(n)}[e.toLowerCase()];function t(e,t){return{parse:e,stop:t}}function n(){return[f(c.condition,"expected condition")]}},arguments:function(e){var t,n,r=e||[],a=[];for(d.save();;){if(e)e=!1;else{if(!(n=c.detachedRuleset()||this.assignment()||c.expression()))break;n.value&&1==n.value.length&&(n=n.value[0]),r.push(n)}d.$char(",")||(d.$char(";")||t)&&(t=!0,n=r.length<1?r[0]:new i.Value(r),a.push(n),r=[])}return d.forget(),t?a:r},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var e,t;if(d.save(),e=d.$re(/^\w+(?=\s?=)/i))if(d.$char("=")){if(t=c.entity())return d.forget(),new i.Assignment(e,t);d.restore()}else d.restore();else d.restore()},url:function(){var e,t=d.i;if(d.autoCommentAbsorb=!1,d.$str("url("))return e=this.quoted()||this.variable()||this.property()||d.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",d.autoCommentAbsorb=!0,p(")"),new i.URL(null!=e.value||e instanceof i.Variable||e instanceof i.Property?e:new i.Anonymous(e,t),t,l);d.autoCommentAbsorb=!0},variable:function(){var e,t,n=d.i;if(d.save(),"@"===d.currentChar()&&(t=d.$re(/^@@?[\w-]+/))){if("("===(e=d.currentChar())||"["===e&&!d.prevChar().match(/^\s/)){var r=c.variableCall(t);if(r)return d.forget(),r}return d.forget(),new i.Variable(t,n,l)}d.restore()},variableCurly:function(){var e,t=d.i;if("@"===d.currentChar()&&(e=d.$re(/^@\{([\w-]+)\}/)))return new i.Variable("@"+e[1],t,l)},property:function(){var e,t=d.i;if("$"===d.currentChar()&&(e=d.$re(/^\$[\w-]+/)))return new i.Property(e,t,l)},propertyCurly:function(){var e,t=d.i;if("$"===d.currentChar()&&(e=d.$re(/^\$\{([\w-]+)\}/)))return new i.Property("$"+e[1],t,l)},color:function(){var e;if("#"===d.currentChar()&&(e=d.$re(/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})/)))return new i.Color(e[1],void 0,e[0])},colorKeyword:function(){d.save();var e=d.autoCommentAbsorb;d.autoCommentAbsorb=!1;var t=d.$re(/^[_A-Za-z-][_A-Za-z0-9-]+/);if(d.autoCommentAbsorb=e,t){d.restore();var n=i.Color.fromKeyword(t);return n?(d.$str(t),n):void 0}d.forget()},dimension:function(){if(!d.peekNotNumeric()){var e=d.$re(/^([+-]?\d*\.?\d+)(%|[a-z_]+)?/i);return e?new i.Dimension(e[1],e[2]):void 0}},unicodeDescriptor:function(){var e;if(e=d.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))return new i.UnicodeDescriptor(e[0])},javascript:function(){var e,t=d.i;d.save();var n=d.$char("~"),r=d.$char("`");if(r){if(e=d.$re(/^[^`]*`/))return d.forget(),new i.JavaScript(e.substr(0,e.length-1),Boolean(n),t,l);d.restore("invalid javascript definition")}else d.restore()}},variable:function(){var e;if("@"===d.currentChar()&&(e=d.$re(/^(@[\w-]+)\s*:/)))return e[1]},variableCall:function(e){var t,n,r=d.i,a=!!e,s=e;if(d.save(),s||"@"===d.currentChar()&&(s=d.$re(/^(@[\w-]+)(\(\s*\))?/))){if(!(t=this.mixin.ruleLookups())&&(a&&"()"!==d.$str("()")||"()"!==s[2]))return void d.restore("Missing '[...]' lookup in variable call");a||(s=s[1]),t&&c.important()&&(n=!0);var o=new i.VariableCall(s,r,l);return!a&&c.end()?(d.forget(),o):(d.forget(),new i.NamespaceValue(o,t,n,r,l))}d.restore()},extend:function(e){var t,n,r,a,s,o=d.i;if(d.$str(e?"&:extend(":":extend(")){do{for(r=null,t=null;!(r=d.$re(/^(all)(?=\s*(\)|,))/))&&(n=this.element());)t?t.push(n):t=[n];r=r&&r[1],t||h("Missing target selector for :extend()."),s=new i.Extend(new i.Selector(t),r,o,l),a?a.push(s):a=[s]}while(d.$char(","));return f(/^\)/),e&&f(/^;/),a}},extendRule:function(){return this.extend(!0)},mixin:{call:function(e,t){var n,r,a,s,o=d.currentChar(),u=!1,h=d.i;if("."===o||"#"===o){if(d.save(),r=this.elements()){if(d.$char("(")&&(a=this.args(!0).args,p(")"),s=!0),!1!==t&&(n=this.ruleLookups()),!0===t&&!n)return void d.restore();if(e&&!n&&!s)return void d.restore();if(!e&&c.important()&&(u=!0),e||c.end()){d.forget();var f=new i.mixin.Call(r,a,h,l,!n&&u);return n?new i.NamespaceValue(f,n,u):f}}d.restore()}},elements:function(){for(var e,t,n,r,a,s=/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/;a=d.i,t=d.$re(s);)r=new i.Element(n,t,!1,a,l),e?e.push(r):e=[r],n=d.$char(">");return e},args:function(e){var t,n,r,a,s,o,u,l=c.entities,f={args:null,variadic:!1},p=[],m=[],v=[],y=!0;for(d.save();;){if(e)o=c.detachedRuleset()||c.expression();else{if(d.commentStore.length=0,d.$str("...")){f.variadic=!0,d.$char(";")&&!t&&(t=!0),(t?m:v).push({variadic:!0});break}o=l.variable()||l.property()||l.literal()||l.keyword()||this.call(!0)}if(!o||!y)break;a=null,o.throwAwayComments&&o.throwAwayComments(),s=o;var g=null;if(e?o.value&&1==o.value.length&&(g=o.value[0]):g=o,g&&(g instanceof i.Variable||g instanceof i.Property))if(d.$char(":")){if(p.length>0&&(t&&h("Cannot mix ; and , as delimiter types"),n=!0),!(s=c.detachedRuleset()||c.expression())){if(!e)return d.restore(),f.args=[],f;h("could not understand value for named argument")}a=r=g.name}else if(d.$str("...")){if(!e){f.variadic=!0,d.$char(";")&&!t&&(t=!0),(t?m:v).push({name:o.name,variadic:!0});break}u=!0}else e||(r=a=g.name,s=null);s&&p.push(s),v.push({name:a,value:s,expand:u}),d.$char(",")?y=!0:((y=";"===d.$char(";"))||t)&&(n&&h("Cannot mix ; and , as delimiter types"),t=!0,p.length>1&&(s=new i.Value(p)),m.push({name:r,value:s,expand:u}),r=null,p=[],n=!1)}return d.forget(),f.args=t?m:v,f},definition:function(){var e,t,n,r,a=[],s=!1;if(!("."!==d.currentChar()&&"#"!==d.currentChar()||d.peek(/^[^{]*\}/)))if(d.save(),t=d.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){e=t[1];var o=this.args(!1);if(a=o.args,s=o.variadic,!d.$char(")"))return void d.restore("Missing closing ')'");if(d.commentStore.length=0,d.$str("when")&&(r=f(c.conditions,"expected condition")),n=c.block())return d.forget(),new i.mixin.Definition(e,a,n,r,s);d.restore()}else d.forget()},ruleLookups:function(){var e,t=[];if("["===d.currentChar()){for(;;){if(d.save(),!(e=this.lookupValue())&&""!==e){d.restore();break}t.push(e),d.forget()}return t.length>0?t:void 0}},lookupValue:function(){if(d.save(),d.$char("[")){var e=d.$re(/^(?:[@$]{0,2})[_a-zA-Z0-9-]*/);if(d.$char("]"))return e||""===e?(d.forget(),e):void d.restore();d.restore()}else d.restore()}},entity:function(){var e=this.entities;return this.comment()||e.literal()||e.variable()||e.url()||e.property()||e.call()||e.keyword()||this.mixin.call(!0)||e.javascript()},end:function(){return d.$char(";")||d.peek("}")},ieAlpha:function(){var e;if(d.$re(/^opacity=/i))return(e=d.$re(/^\d+/))||(e="@{"+(e=f(c.entities.variable,"Could not parse alpha")).name.slice(1)+"}"),p(")"),new i.Quoted("","alpha(opacity="+e+")")},element:function(){var e,t,n,r=d.i;if(t=this.combinator(),(e=d.$re(/^(?:\d+\.\d+|\d+)%/)||d.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||d.$char("*")||d.$char("&")||this.attribute()||d.$re(/^\([^&()@]+\)/)||d.$re(/^[\.#:](?=@)/)||this.entities.variableCurly())||(d.save(),d.$char("(")?(n=this.selector(!1))&&d.$char(")")?(e=new i.Paren(n),d.forget()):d.restore("Missing closing ')'"):d.forget()),e)return new i.Element(t,e,e instanceof i.Variable,r,l)},combinator:function(){var e=d.currentChar();if("/"===e){d.save();var t=d.$re(/^\/[a-z]+\//i);if(t)return d.forget(),new i.Combinator(t);d.restore()}if(">"===e||"+"===e||"~"===e||"|"===e||"^"===e){for(d.i++,"^"===e&&"^"===d.currentChar()&&(e="^^",d.i++);d.isWhitespace();)d.i++;return new i.Combinator(e)}return d.isWhitespace(-1)?new i.Combinator(" "):new i.Combinator(null)},selector:function(e){var t,n,r,a,s,o,u,c=d.i;for(e=!1!==e;(e&&(n=this.extend())||e&&(o=d.$str("when"))||(a=this.element()))&&(o?u=f(this.conditions,"expected condition"):u?h("CSS guard can only be used at the end of selector"):n?s=s?s.concat(n):n:(s&&h("Extend can only be used at the end of selector"),r=d.currentChar(),t?t.push(a):t=[a],a=null),"{"!==r&&"}"!==r&&";"!==r&&","!==r&&")"!==r););if(t)return new i.Selector(t,s,u,c,l);s&&h("Extend must be used to extend a selector, it cannot be used on its own")},selectors:function(){for(var e,t;(e=this.selector())&&(t?t.push(e):t=[e],d.commentStore.length=0,e.condition&&t.length>1&&h("Guards are only currently allowed on a single selector."),d.$char(","));)e.condition&&h("Guards are only currently allowed on a single selector."),d.commentStore.length=0;return t},attribute:function(){if(d.$char("[")){var e,t,n,r=this.entities;return(e=r.variableCurly())||(e=f(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),(n=d.$re(/^[|~*$^]?=/))&&(t=r.quoted()||d.$re(/^[0-9]+%/)||d.$re(/^[\w-]+/)||r.variableCurly()),p("]"),new i.Attribute(e,n,t)}},block:function(){var e;if(d.$char("{")&&(e=this.primary())&&d.$char("}"))return e},blockRuleset:function(){var e=this.block();return e&&(e=new i.Ruleset(null,e)),e},detachedRuleset:function(){var e,t,n;if(d.save(),!d.$re(/^[.#]\(/)||(e=this.mixin.args(!1),t=e.args,n=e.variadic,d.$char(")"))){var r=this.blockRuleset();if(r)return d.forget(),t?new i.mixin.Definition(null,t,r,null,n):new i.DetachedRuleset(r);d.restore()}else d.restore()},ruleset:function(){var e,n,r;if(d.save(),t.dumpLineNumbers&&(r=m(d.i)),(e=this.selectors())&&(n=this.block())){d.forget();var a=new i.Ruleset(e,n,t.strictImports);return t.dumpLineNumbers&&(a.debugInfo=r),a}d.restore()},declaration:function(){var e,t,n,r,a,s,o=d.i,u=d.currentChar();if("."!==u&&"#"!==u&&"&"!==u&&":"!==u)if(d.save(),e=this.variable()||this.ruleProperty()){if((s="string"==typeof e)&&(t=this.detachedRuleset())&&(n=!0),d.commentStore.length=0,!t){if(a=!s&&e.length>1&&e.pop().value,t=e[0].value&&"--"===e[0].value.slice(0,2)?this.permissiveValue():this.anonymousValue())return d.forget(),new i.Declaration(e,t,!1,a,o,l);t||(t=this.value()),t?r=this.important():s&&(t=this.permissiveValue())}if(t&&(this.end()||n))return d.forget(),new i.Declaration(e,t,r,a,o,l);d.restore()}else d.restore()},anonymousValue:function(){var e=d.i,t=d.$re(/^([^.#@\$+\/'"*`(;{}-]*);/);if(t)return new i.Anonymous(t[1],e)},permissiveValue:function(e){var t,n,r,a,s=e||";",o=d.i,u=[];function c(){var e=d.currentChar();return"string"==typeof s?e===s:s.test(e)}if(!c()){a=[];do{(n=this.comment())?a.push(n):(n=this.entity())&&a.push(n)}while(n);if(r=c(),a.length>0){if(a=new i.Expression(a),r)return a;u.push(a)," "===d.prevChar()&&u.push(new i.Anonymous(" ",o))}if(d.save(),a=d.$parseUntil(s)){if("string"==typeof a&&h("Expected '"+a+"'","Parse"),1===a.length&&" "===a[0])return d.forget(),new i.Anonymous("",o);var f;for(t=0;t<a.length;t++)if(f=a[t],Array.isArray(f))u.push(new i.Quoted(f[0],f[1],!0,o,l));else{t===a.length-1&&(f=f.trim());var p=new i.Quoted("'",f,!0,o,l);p.variableRegex=/@([\w-]+)/g,p.propRegex=/\$([\w-]+)/g,u.push(p)}return d.forget(),new i.Expression(u,!0)}d.restore()}},import:function(){var e,t,n=d.i,r=d.$re(/^@import?\s+/);if(r){var a=(r?this.importOptions():null)||{};if(e=this.entities.quoted()||this.entities.url())return t=this.mediaFeatures(),d.$char(";")||(d.i=n,h("missing semi-colon or unrecognised media features on import")),t=t&&new i.Value(t),new i.Import(e,t,a,n,l);d.i=n,h("malformed import statement")}},importOptions:function(){var e,t,n,r={};if(!d.$char("("))return null;do{if(e=this.importOption()){switch(n=!0,t=e){case"css":t="less",n=!1;break;case"once":t="multiple",n=!1}if(r[t]=n,!d.$char(","))break}}while(e);return p(")"),r},importOption:function(){var e=d.$re(/^(less|css|multiple|once|inline|reference|optional)/);if(e)return e[1]},mediaFeature:function(){var e,t,n=this.entities,r=[];d.save();do{(e=n.keyword()||n.variable()||n.mixinLookup())?r.push(e):d.$char("(")&&(t=this.property(),e=this.value(),d.$char(")")?t&&e?r.push(new i.Paren(new i.Declaration(t,e,null,null,d.i,l,!0))):e?r.push(new i.Paren(e)):h("badly formed media feature definition"):h("Missing closing ')'","Parse"))}while(e);if(d.forget(),r.length>0)return new i.Expression(r)},mediaFeatures:function(){var e,t=this.entities,n=[];do{if(e=this.mediaFeature()){if(n.push(e),!d.$char(","))break}else if((e=t.variable()||t.mixinLookup())&&(n.push(e),!d.$char(",")))break}while(e);return n.length>0?n:null},media:function(){var e,n,r,a,s=d.i;if(t.dumpLineNumbers&&(a=m(s)),d.save(),d.$str("@media"))return e=this.mediaFeatures(),(n=this.block())||h("media definitions require block statements after any features"),d.forget(),r=new i.Media(n,e,s,l),t.dumpLineNumbers&&(r.debugInfo=a),r;d.restore()},plugin:function(){var e,t,n,r=d.i,a=d.$re(/^@plugin?\s+/);if(a){if(t=this.pluginArgs(),n=t?{pluginArgs:t,isPlugin:!0}:{isPlugin:!0},e=this.entities.quoted()||this.entities.url())return d.$char(";")||(d.i=r,h("missing semi-colon on @plugin")),new i.Import(e,null,n,r,l);d.i=r,h("malformed @plugin statement")}},pluginArgs:function(){if(d.save(),!d.$char("("))return d.restore(),null;var e=d.$re(/^\s*([^\);]+)\)\s*/);return e[1]?(d.forget(),e[1].trim()):(d.restore(),null)},atrule:function(){var e,n,r,a,s,o,u,c=d.i,f=!0,p=!0;if("@"===d.currentChar()){if(n=this.import()||this.plugin()||this.media())return n;if(d.save(),e=d.$re(/^@[a-z-]+/)){switch(a=e,"-"==e.charAt(1)&&e.indexOf("-",2)>0&&(a="@"+e.slice(e.indexOf("-",2)+1)),a){case"@charset":s=!0,f=!1;break;case"@namespace":o=!0,f=!1;break;case"@keyframes":case"@counter-style":s=!0;break;case"@document":case"@supports":u=!0,p=!1;break;default:u=!0}if(d.commentStore.length=0,s?(n=this.entity())||h("expected "+e+" identifier"):o?(n=this.expression())||h("expected "+e+" expression"):u&&(n=this.permissiveValue(/^[{;]/),f="{"===d.currentChar(),n?n.value||(n=null):f||";"===d.currentChar()||h(e+" rule is missing block or ending semi-colon")),f&&(r=this.blockRuleset()),r||!f&&n&&d.$char(";"))return d.forget(),new i.AtRule(e,n,r,c,l,t.dumpLineNumbers?m(c):null,p);d.restore("at-rule options not recognised")}}},value:function(){var e,t=[],n=d.i;do{if((e=this.expression())&&(t.push(e),!d.$char(",")))break}while(e);if(t.length>0)return new i.Value(t,n)},important:function(){if("!"===d.currentChar())return d.$re(/^! *important/)},sub:function(){var e,t;if(d.save(),d.$char("("))return(e=this.addition())&&d.$char(")")?(d.forget(),(t=new i.Expression([e])).parens=!0,t):void d.restore("Expected ')'");d.restore()},multiplication:function(){var e,t,n,r,a;if(e=this.operand()){for(a=d.isWhitespace(-1);!d.peek(/^\/[*\/]/);){if(d.save(),!(n=d.$char("/")||d.$char("*")||d.$str("./"))){d.forget();break}if(!(t=this.operand())){d.restore();break}d.forget(),e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],a),a=d.isWhitespace(-1)}return r||e}},addition:function(){var e,t,n,r,a;if(e=this.multiplication()){for(a=d.isWhitespace(-1);(n=d.$re(/^[-+]\s+/)||!a&&(d.$char("+")||d.$char("-")))&&(t=this.multiplication());)e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],a),a=d.isWhitespace(-1);return r||e}},conditions:function(){var e,t,n,r=d.i;if(e=this.condition(!0)){for(;d.peek(/^,\s*(not\s*)?\(/)&&d.$char(",")&&(t=this.condition(!0));)n=new i.Condition("or",n||e,t,r);return n||e}},condition:function(e){var t,n,r;if(t=this.conditionAnd(e)){if(n=d.$str("or")){if(!(r=this.condition(e)))return;t=new i.Condition(n,t,r)}return t}},conditionAnd:function(e){var t,n,r,a,s=this;if(a=s.negatedCondition(e)||s.parenthesisCondition(e),t=a||e?a:s.atomicCondition(e)){if(n=d.$str("and")){if(!(r=this.conditionAnd(e)))return;t=new i.Condition(n,t,r)}return t}},negatedCondition:function(e){if(d.$str("not")){var t=this.parenthesisCondition(e);return t&&(t.negate=!t.negate),t}},parenthesisCondition:function(e){var t;if(d.save(),d.$str("(")){if(t=function(t){var n;if(d.save(),n=t.condition(e)){if(d.$char(")"))return d.forget(),n;d.restore()}else d.restore()}(this))return d.forget(),t;if(t=this.atomicCondition(e)){if(d.$char(")"))return d.forget(),t;d.restore("expected ')' got '"+d.currentChar()+"'")}else d.restore()}else d.restore()},atomicCondition:function(e){var t,n,r,a,s=this.entities,o=d.i;function u(){return this.addition()||s.keyword()||s.quoted()||s.mixinLookup()}if(u=u.bind(this),t=u())return d.$char(">")?a=d.$char("=")?">=":">":d.$char("<")?a=d.$char("=")?"<=":"<":d.$char("=")&&(a=d.$char(">")?"=>":d.$char("<")?"=<":"="),a?(n=u())?r=new i.Condition(a,t,n,o,!1):h("expected expression"):r=new i.Condition("=",t,new i.Keyword("true"),o,!1),r},operand:function(){var e,t=this.entities;d.peek(/^-[@\$\(]/)&&(e=d.$char("-"));var n=this.sub()||t.dimension()||t.color()||t.variable()||t.property()||t.call()||t.quoted(!0)||t.colorKeyword()||t.mixinLookup();return e&&(n.parensInOp=!0,n=new i.Negative(n)),n},expression:function(){var e,t,n=[],r=d.i;do{(e=this.comment())?n.push(e):(e=this.addition()||this.entity())&&(n.push(e),d.peek(/^\/[\/*]/)||(t=d.$char("/"))&&n.push(new i.Anonymous(t,r)))}while(e);if(n.length>0)return new i.Expression(n)},property:function(){var e=d.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);if(e)return e[1]},ruleProperty:function(){var e,t,n=[],r=[];d.save();var a=d.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(a)return n=[new i.Keyword(a[1])],d.forget(),n;function s(e){var t=d.i,i=d.$re(e);if(i)return r.push(t),n.push(i[1])}for(s(/^(\*?)/);s(/^((?:[\w-]+)|(?:[@\$]\{[\w-]+\}))/););if(n.length>1&&s(/^((?:\+_|\+)?)\s*:/)){for(d.forget(),""===n[0]&&(n.shift(),r.shift()),t=0;t<n.length;t++)e=n[t],n[t]="@"!==e.charAt(0)&&"$"!==e.charAt(0)?new i.Keyword(e):"@"===e.charAt(0)?new i.Variable("@"+e.slice(2,-1),r[t],l):new i.Property("$"+e.slice(2,-1),r[t],l);return n}d.restore()}}}};l.serializeVars=function(e){var t="";for(var n in e)if(Object.hasOwnProperty.call(e,n)){var r=e[n];t+=("@"===n[0]?"":"@")+n+": "+r+(";"===String(r).slice(-1)?"":";")}return t},t.exports=l},{"../functions/function-registry":27,"../less-error":38,"../tree":67,"../utils":89,"../visitors":93,"./parser-input":43}],45:[function(e,t,n){var r,i=function(e){this.less=e,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[],this.iterator=-1,this.pluginCache={},this.Loader=new e.PluginLoader(e)};i.prototype.addPlugins=function(e){if(e)for(var t=0;t<e.length;t++)this.addPlugin(e[t])},i.prototype.addPlugin=function(e,t,n){this.installedPlugins.push(e),t&&(this.pluginCache[t]=e),e.install&&e.install(this.less,this,n||this.less.functions.functionRegistry)},i.prototype.get=function(e){return this.pluginCache[e]},i.prototype.addVisitor=function(e){this.visitors.push(e)},i.prototype.addPreProcessor=function(e,t){var n;for(n=0;n<this.preProcessors.length&&!(this.preProcessors[n].priority>=t);n++);this.preProcessors.splice(n,0,{preProcessor:e,priority:t})},i.prototype.addPostProcessor=function(e,t){var n;for(n=0;n<this.postProcessors.length&&!(this.postProcessors[n].priority>=t);n++);this.postProcessors.splice(n,0,{postProcessor:e,priority:t})},i.prototype.addFileManager=function(e){this.fileManagers.push(e)},i.prototype.getPreProcessors=function(){for(var e=[],t=0;t<this.preProcessors.length;t++)e.push(this.preProcessors[t].preProcessor);return e},i.prototype.getPostProcessors=function(){for(var e=[],t=0;t<this.postProcessors.length;t++)e.push(this.postProcessors[t].postProcessor);return e},i.prototype.getVisitors=function(){return this.visitors},i.prototype.visitor=function(){var e=this;return{first:function(){return e.iterator=-1,e.visitors[e.iterator]},get:function(){return e.iterator+=1,e.visitors[e.iterator]}}},i.prototype.getFileManagers=function(){return this.fileManagers},t.exports=function(e,t){return!t&&r||(r=new i(e)),r}},{}],46:[function(e,t,n){var r,i=e("./utils");t.exports=function(t,n,a){var s=function(t,a,o){if("function"==typeof a?(o=a,a=i.copyOptions(this.options,{})):a=i.copyOptions(this.options,a||{}),!o){r||(r="undefined"==typeof Promise?e("promise"):Promise);var u=this;return new r(function(e,n){s.call(u,t,a,function(t,r){t?n(t):e(r)})})}this.parse(t,a,function(e,t,r,i){if(e)return o(e);var a;try{var s=new n(t,r);a=s.toCSS(i)}catch(e){return o(e)}o(null,a)})};return s}},{"./utils":89,promise:void 0}],47:[function(e,t,n){t.exports=function(e,t){var n=function(e){this.options=e};return n.prototype.toCSS=function(t,n,r){var i=new e({contentsIgnoredCharsMap:r.contentsIgnoredChars,rootNode:t,contentsMap:r.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),a=i.toCSS(n);return this.sourceMap=i.sourceMap,this.sourceMapURL=i.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=i.normalizeFilename(this.options.sourceMapInputFilename)),void 0!==this.options.sourceMapBasepath&&void 0!==this.sourceMapURL&&(this.sourceMapURL=i.removeBasepath(this.sourceMapURL)),a+this.getCSSAppendage()},n.prototype.getCSSAppendage=function(){var e=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";e="data:application/json;base64,"+t.encodeBase64(this.sourceMap)}return e?"/*# sourceMappingURL="+e+" */":""},n.prototype.getExternalSourceMap=function(){return this.sourceMap},n.prototype.setExternalSourceMap=function(e){this.sourceMap=e},n.prototype.isInline=function(){return this.options.sourceMapFileInline},n.prototype.getSourceMapURL=function(){return this.sourceMapURL},n.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},n.prototype.getInputFilename=function(){return this.sourceMapInputFilename},n}},{}],48:[function(e,t,n){t.exports=function(e){var t=function(t){this._css=[],this._rootNode=t.rootNode,this._contentsMap=t.contentsMap,this._contentsIgnoredCharsMap=t.contentsIgnoredCharsMap,t.sourceMapFilename&&(this._sourceMapFilename=t.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=t.outputFilename,this.sourceMapURL=t.sourceMapURL,t.sourceMapBasepath&&(this._sourceMapBasepath=t.sourceMapBasepath.replace(/\\/g,"/")),t.sourceMapRootpath?(this._sourceMapRootpath=t.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=t.outputSourceFiles,this._sourceMapGeneratorConstructor=e.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return t.prototype.removeBasepath=function(e){return this._sourceMapBasepath&&0===e.indexOf(this._sourceMapBasepath)&&("\\"!==(e=e.substring(this._sourceMapBasepath.length)).charAt(0)&&"/"!==e.charAt(0)||(e=e.substring(1))),e},t.prototype.normalizeFilename=function(e){return e=e.replace(/\\/g,"/"),e=this.removeBasepath(e),(this._sourceMapRootpath||"")+e},t.prototype.add=function(e,t,n,r){if(e){var i,a,s,o,u;if(t&&t.filename){var l=this._contentsMap[t.filename];this._contentsIgnoredCharsMap[t.filename]&&((n-=this._contentsIgnoredCharsMap[t.filename])<0&&(n=0),l=l.slice(this._contentsIgnoredCharsMap[t.filename])),l=l.substring(0,n),a=l.split("\n"),o=a[a.length-1]}if(i=e.split("\n"),s=i[i.length-1],t&&t.filename)if(r)for(u=0;u<i.length;u++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+u+1,column:0===u?this._column:0},original:{line:a.length+u,column:0===u?o.length:0},source:this.normalizeFilename(t.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:a.length,column:o.length},source:this.normalizeFilename(t.filename)});1===i.length?this._column+=s.length:(this._lineNumber+=i.length-1,this._column=s.length),this._css.push(e)}},t.prototype.isEmpty=function(){return 0===this._css.length},t.prototype.toCSS=function(e){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var t in this._contentsMap)if(this._contentsMap.hasOwnProperty(t)){var n=this._contentsMap[t];this._contentsIgnoredCharsMap[t]&&(n=n.slice(this._contentsIgnoredCharsMap[t])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(t),n)}if(this._rootNode.genCSS(e,this),this._css.length>0){var r,i=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?r=this.sourceMapURL:this._sourceMapFilename&&(r=this._sourceMapFilename),this.sourceMapURL=r,this.sourceMap=i}return this._css.join("")},t}},{}],49:[function(e,t,n){var r=e("./contexts"),i=e("./visitors"),a=e("./tree");t.exports=function(e,t){var n,s=(t=t||{}).variables,o=new r.Eval(t);"object"!=typeof s||Array.isArray(s)||(s=Object.keys(s).map(function(e){var t=s[e];return t instanceof a.Value||(t instanceof a.Expression||(t=new a.Expression([t])),t=new a.Value([t])),new a.Declaration("@"+e,t,!1,null,0)}),o.frames=[new a.Ruleset(null,s)]);var u,l,c=[new i.JoinSelectorVisitor,new i.MarkVisibleSelectorsVisitor(!0),new i.ExtendVisitor,new i.ToCSSVisitor({compress:Boolean(t.compress)})],d=[];if(t.pluginManager){l=t.pluginManager.visitor();for(var h=0;h<2;h++)for(l.first();u=l.get();)u.isPreEvalVisitor?0!==h&&-1!==d.indexOf(u)||(d.push(u),u.run(e)):0!==h&&-1!==c.indexOf(u)||(u.isPreVisitor?c.unshift(u):c.push(u))}n=e.eval(o);for(var h=0;h<c.length;h++)c[h].run(n);if(t.pluginManager)for(l.first();u=l.get();)-1===c.indexOf(u)&&-1===d.indexOf(u)&&u.run(n);return n}},{"./contexts":13,"./tree":67,"./visitors":93}],50:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r,i,a){this.value=e,this._index=t,this._fileInfo=n,this.mapLines=r,this.rulesetLike=void 0!==i&&i,this.allowRoot=!0,this.copyVisibilityInfo(a)};(i.prototype=new r).type="Anonymous",i.prototype.eval=function(){return new i(this.value,this._index,this._fileInfo,this.mapLines,this.rulesetLike,this.visibilityInfo())},i.prototype.compare=function(e){return e.toCSS&&this.toCSS()===e.toCSS()?0:void 0},i.prototype.isRulesetLike=function(){return this.rulesetLike},i.prototype.genCSS=function(e,t){this.nodeVisible=Boolean(this.value),this.nodeVisible&&t.add(this.value,this._fileInfo,this._index,this.mapLines)},t.exports=i},{"./node":76}],51:[function(e,t,n){var r=e("./node"),i=function(e,t){this.key=e,this.value=t};(i.prototype=new r).type="Assignment",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.eval=function(e){return this.value.eval?new i(this.key,this.value.eval(e)):this},i.prototype.genCSS=function(e,t){t.add(this.key+"="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value)},t.exports=i},{"./node":76}],52:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=e("./ruleset"),s=e("./anonymous"),o=function(e,t,n,a,o,u,l,c){var d;if(this.name=e,this.value=t instanceof r?t:t?new s(t):t,n){for(Array.isArray(n)?this.rules=n:(this.rules=[n],this.rules[0].selectors=new i([],null,null,a,o).createEmptySelectors()),d=0;d<this.rules.length;d++)this.rules[d].allowImports=!0;this.setParent(this.rules,this)}this._index=a,this._fileInfo=o,this.debugInfo=u,this.isRooted=l||!1,this.copyVisibilityInfo(c),this.allowRoot=!0};(o.prototype=new r).type="AtRule",o.prototype.accept=function(e){var t=this.value,n=this.rules;n&&(this.rules=e.visitArray(n)),t&&(this.value=e.visit(t))},o.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},o.prototype.isCharset=function(){return"@charset"===this.name},o.prototype.genCSS=function(e,t){var n=this.value,r=this.rules;t.add(this.name,this.fileInfo(),this.getIndex()),n&&(t.add(" "),n.genCSS(e,t)),r?this.outputRuleset(e,t,r):t.add(";")},o.prototype.eval=function(e){var t,n,r=this.value,i=this.rules;return t=e.mediaPath,n=e.mediaBlocks,e.mediaPath=[],e.mediaBlocks=[],r&&(r=r.eval(e)),i&&((i=[i[0].eval(e)])[0].root=!0),e.mediaPath=t,e.mediaBlocks=n,new o(this.name,r,i,this.getIndex(),this.fileInfo(),this.debugInfo,this.isRooted,this.visibilityInfo())},o.prototype.variable=function(e){if(this.rules)return a.prototype.variable.call(this.rules[0],e)},o.prototype.find=function(){if(this.rules)return a.prototype.find.apply(this.rules[0],arguments)},o.prototype.rulesets=function(){if(this.rules)return a.prototype.rulesets.apply(this.rules[0])},o.prototype.outputRuleset=function(e,t,n){var r,i=n.length;if(e.tabLevel=1+(0|e.tabLevel),e.compress){for(t.add("{"),r=0;r<i;r++)n[r].genCSS(e,t);return t.add("}"),void e.tabLevel--}var a="\n"+Array(e.tabLevel).join("  "),s=a+"  ";if(i){for(t.add(" {"+s),n[0].genCSS(e,t),r=1;r<i;r++)t.add(s),n[r].genCSS(e,t);t.add(a+"}")}else t.add(" {"+a+"}");e.tabLevel--},t.exports=o},{"./anonymous":50,"./node":76,"./ruleset":81,"./selector":82}],53:[function(e,t,n){var r=e("./node"),i=function(e,t,n){this.key=e,this.op=t,this.value=n};(i.prototype=new r).type="Attribute",i.prototype.eval=function(e){return new i(this.key.eval?this.key.eval(e):this.key,this.op,this.value&&this.value.eval?this.value.eval(e):this.value)},i.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},i.prototype.toCSS=function(e){var t=this.key.toCSS?this.key.toCSS(e):this.key;return this.op&&(t+=this.op,t+=this.value.toCSS?this.value.toCSS(e):this.value),"["+t+"]"},t.exports=i},{"./node":76}],54:[function(e,t,n){var r=e("./node"),i=e("./anonymous"),a=e("../functions/function-caller"),s=function(e,t,n,r){this.name=e,this.args=t,this.calc="calc"===e,this._index=n,this._fileInfo=r};(s.prototype=new r).type="Call",s.prototype.accept=function(e){this.args&&(this.args=e.visitArray(this.args))},s.prototype.eval=function(e){var t=e.mathOn;e.mathOn=!this.calc,(this.calc||e.inCalc)&&e.enterCalc();var n=this.args.map(function(t){return t.eval(e)});(this.calc||e.inCalc)&&e.exitCalc(),e.mathOn=t;var o,u=new a(this.name,e,this.getIndex(),this.fileInfo());if(u.isValid()){try{o=u.call(n)}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.getIndex(),filename:this.fileInfo().filename,line:e.lineNumber,column:e.columnNumber}}if(null!=o)return o instanceof r||(o=new i(o&&!0!==o?o.toString():null)),o._index=this._index,o._fileInfo=this._fileInfo,o}return new s(this.name,n,this.getIndex(),this.fileInfo())},s.prototype.genCSS=function(e,t){t.add(this.name+"(",this.fileInfo(),this.getIndex());for(var n=0;n<this.args.length;n++)this.args[n].genCSS(e,t),n+1<this.args.length&&t.add(", ");t.add(")")},t.exports=s},{"../functions/function-caller":26,"./anonymous":50,"./node":76}],55:[function(e,t,n){var r=e("./node"),i=e("../data/colors"),a=function(e,t,n){var r=this;Array.isArray(e)?this.rgb=e:e.length>=6?(this.rgb=[],e.match(/.{2}/g).map(function(e,t){t<3?r.rgb.push(parseInt(e,16)):r.alpha=parseInt(e,16)/255})):(this.rgb=[],e.split("").map(function(e,t){t<3?r.rgb.push(parseInt(e+e,16)):r.alpha=parseInt(e+e,16)/255})),this.alpha=this.alpha||("number"==typeof t?t:1),void 0!==n&&(this.value=n)};function s(e,t){return Math.min(Math.max(e,0),t)}function o(e){return"#"+e.map(function(e){return((e=s(Math.round(e),255))<16?"0":"")+e.toString(16)}).join("")}(a.prototype=new r).type="Color",a.prototype.luma=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),n=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),.2126*e+.7152*t+.0722*n},a.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},a.prototype.toCSS=function(e,t){var n,r,i,a=e&&e.compress&&!t,o=[];if(r=this.fround(e,this.alpha),this.value)if(0===this.value.indexOf("rgb"))r<1&&(i="rgba");else{if(0!==this.value.indexOf("hsl"))return this.value;i=r<1?"hsla":"hsl"}else r<1&&(i="rgba");switch(i){case"rgba":o=this.rgb.map(function(e){return s(Math.round(e),255)}).concat(s(r,1));break;case"hsla":o.push(s(r,1));case"hsl":n=this.toHSL(),o=[this.fround(e,n.h),this.fround(e,100*n.s)+"%",this.fround(e,100*n.l)+"%"].concat(o)}if(i)return i+"("+o.join(","+(a?"":" "))+")";if(n=this.toRGB(),a){var u=n.split("");u[1]===u[2]&&u[3]===u[4]&&u[5]===u[6]&&(n="#"+u[1]+u[3]+u[5])}return n},a.prototype.operate=function(e,t,n){for(var r=new Array(3),i=this.alpha*(1-n.alpha)+n.alpha,s=0;s<3;s++)r[s]=this._operate(e,t,this.rgb[s],n.rgb[s]);return new a(r,i)},a.prototype.toRGB=function(){return o(this.rgb)},a.prototype.toHSL=function(){var e,t,n=this.rgb[0]/255,r=this.rgb[1]/255,i=this.rgb[2]/255,a=this.alpha,s=Math.max(n,r,i),o=Math.min(n,r,i),u=(s+o)/2,l=s-o;if(s===o)e=t=0;else{switch(t=u>.5?l/(2-s-o):l/(s+o),s){case n:e=(r-i)/l+(r<i?6:0);break;case r:e=(i-n)/l+2;break;case i:e=(n-r)/l+4}e/=6}return{h:360*e,s:t,l:u,a:a}},a.prototype.toHSV=function(){var e,t,n=this.rgb[0]/255,r=this.rgb[1]/255,i=this.rgb[2]/255,a=this.alpha,s=Math.max(n,r,i),o=Math.min(n,r,i),u=s,l=s-o;if(t=0===s?0:l/s,s===o)e=0;else{switch(s){case n:e=(r-i)/l+(r<i?6:0);break;case r:e=(i-n)/l+2;break;case i:e=(n-r)/l+4}e/=6}return{h:360*e,s:t,v:u,a:a}},a.prototype.toARGB=function(){return o([255*this.alpha].concat(this.rgb))},a.prototype.compare=function(e){return e.rgb&&e.rgb[0]===this.rgb[0]&&e.rgb[1]===this.rgb[1]&&e.rgb[2]===this.rgb[2]&&e.alpha===this.alpha?0:void 0},a.fromKeyword=function(e){var t,n=e.toLowerCase();if(i.hasOwnProperty(n)?t=new a(i[n].slice(1)):"transparent"===n&&(t=new a([0,0,0],0)),t)return t.value=e,t},t.exports=a},{"../data/colors":14,"./node":76}],56:[function(e,t,n){var r=e("./node"),i=function(e){" "===e?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=e?e.trim():"",this.emptyOrWhitespace=""===this.value)};(i.prototype=new r).type="Combinator";var a={"":!0," ":!0,"|":!0};i.prototype.genCSS=function(e,t){var n=e.compress||a[this.value]?"":" ";t.add(n+this.value+n)},t.exports=i},{"./node":76}],57:[function(e,t,n){var r=e("./node"),i=e("./debug-info"),a=function(e,t,n,r){this.value=e,this.isLineComment=t,this._index=n,this._fileInfo=r,this.allowRoot=!0};(a.prototype=new r).type="Comment",a.prototype.genCSS=function(e,t){this.debugInfo&&t.add(i(e,this),this.fileInfo(),this.getIndex()),t.add(this.value)},a.prototype.isSilent=function(e){var t=e.compress&&"!"!==this.value[2];return this.isLineComment||t},t.exports=a},{"./debug-info":59,"./node":76}],58:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r,i){this.op=e.trim(),this.lvalue=t,this.rvalue=n,this._index=r,this.negate=i};(i.prototype=new r).type="Condition",i.prototype.accept=function(e){this.lvalue=e.visit(this.lvalue),this.rvalue=e.visit(this.rvalue)},i.prototype.eval=function(e){var t=function(e,t,n){switch(e){case"and":return t&&n;case"or":return t||n;default:switch(r.compare(t,n)){case-1:return"<"===e||"=<"===e||"<="===e;case 0:return"="===e||">="===e||"=<"===e||"<="===e;case 1:return">"===e||">="===e;default:return!1}}}(this.op,this.lvalue.eval(e),this.rvalue.eval(e));return this.negate?!t:t},t.exports=i},{"./node":76}],59:[function(e,t,n){var r=function(e,t,n){var i="";if(e.dumpLineNumbers&&!e.compress)switch(e.dumpLineNumbers){case"comments":i=r.asComment(t);break;case"mediaquery":i=r.asMediaQuery(t);break;case"all":i=r.asComment(t)+(n||"")+r.asMediaQuery(t)}return i};r.asComment=function(e){return"/* line "+e.debugInfo.lineNumber+", "+e.debugInfo.fileName+" */\n"},r.asMediaQuery=function(e){var t=e.debugInfo.fileName;return/^[a-z]+:\/\//i.test(t)||(t="file://"+t),"@media -sass-debug-info{filename{font-family:"+t.replace(/([.:\/\\])/g,function(e){return"\\"==e&&(e="/"),"\\"+e})+"}line{font-family:\\00003"+e.debugInfo.lineNumber+"}}\n"},t.exports=r},{}],60:[function(e,t,n){var r=e("./node"),i=e("./value"),a=e("./keyword"),s=e("./anonymous"),o=e("../constants").Math,u=function(e,t,n,a,o,u,l,c){this.name=e,this.value=t instanceof r?t:new i([t?new s(t):null]),this.important=n?" "+n.trim():"",this.merge=a,this._index=o,this._fileInfo=u,this.inline=l||!1,this.variable=void 0!==c?c:e.charAt&&"@"===e.charAt(0),this.allowRoot=!0,this.setParent(this.value,this)};(u.prototype=new r).type="Declaration",u.prototype.genCSS=function(e,t){t.add(this.name+(e.compress?":":": "),this.fileInfo(),this.getIndex());try{this.value.genCSS(e,t)}catch(e){throw e.index=this._index,e.filename=this._fileInfo.filename,e}t.add(this.important+(this.inline||e.lastRule&&e.compress?"":";"),this._fileInfo,this._index)},u.prototype.eval=function(e){var t,n,r=!1,i=this.name,s=this.variable;"string"!=typeof i&&(i=1===i.length&&i[0]instanceof a?i[0].value:function(e,t){var n,r="",i=t.length,a={add:function(e){r+=e}};for(n=0;n<i;n++)t[n].eval(e).genCSS(e,a);return r}(e,i),s=!1),"font"===i&&e.math===o.ALWAYS&&(r=!0,t=e.math,e.math=o.PARENS_DIVISION);try{if(e.importantScope.push({}),n=this.value.eval(e),!this.variable&&"DetachedRuleset"===n.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.getIndex(),filename:this.fileInfo().filename};var l=this.important,c=e.importantScope.pop();return!l&&c.important&&(l=c.important),new u(i,n,l,this.merge,this.getIndex(),this.fileInfo(),this.inline,s)}catch(e){throw"number"!=typeof e.index&&(e.index=this.getIndex(),e.filename=this.fileInfo().filename),e}finally{r&&(e.math=t)}},u.prototype.makeImportant=function(){return new u(this.name,this.value,"!important",this.merge,this.getIndex(),this.fileInfo(),this.inline)},t.exports=u},{"../constants":12,"./anonymous":50,"./keyword":70,"./node":76,"./value":86}],61:[function(e,t,n){var r=e("./node"),i=e("../contexts"),a=e("../utils"),s=function(e,t){this.ruleset=e,this.frames=t,this.setParent(this.ruleset,this)};(s.prototype=new r).type="DetachedRuleset",s.prototype.evalFirst=!0,s.prototype.accept=function(e){this.ruleset=e.visit(this.ruleset)},s.prototype.eval=function(e){var t=this.frames||a.copyArray(e.frames);return new s(this.ruleset,t)},s.prototype.callEval=function(e){return this.ruleset.eval(this.frames?new i.Eval(e,this.frames.concat(e.frames)):e)},t.exports=s},{"../contexts":13,"../utils":89,"./node":76}],62:[function(e,t,n){var r=e("./node"),i=e("../data/unit-conversions"),a=e("./unit"),s=e("./color"),o=function(e,t){if(this.value=parseFloat(e),isNaN(this.value))throw new Error("Dimension is not a number.");this.unit=t&&t instanceof a?t:new a(t?[t]:void 0),this.setParent(this.unit,this)};(o.prototype=new r).type="Dimension",o.prototype.accept=function(e){this.unit=e.visit(this.unit)},o.prototype.eval=function(e){return this},o.prototype.toColor=function(){return new s([this.value,this.value,this.value])},o.prototype.genCSS=function(e,t){if(e&&e.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var n=this.fround(e,this.value),r=String(n);if(0!==n&&n<1e-6&&n>-1e-6&&(r=n.toFixed(20).replace(/0+$/,"")),e&&e.compress){if(0===n&&this.unit.isLength())return void t.add(r);n>0&&n<1&&(r=r.substr(1))}t.add(r),this.unit.genCSS(e,t)},o.prototype.operate=function(e,t,n){var r=this._operate(e,t,this.value,n.value),i=this.unit.clone();if("+"===t||"-"===t)if(0===i.numerator.length&&0===i.denominator.length)i=n.unit.clone(),this.unit.backupUnit&&(i.backupUnit=this.unit.backupUnit);else if(0===n.unit.numerator.length&&0===i.denominator.length);else{if(n=n.convertTo(this.unit.usedUnits()),e.strictUnits&&n.unit.toString()!==i.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+i.toString()+"' and '"+n.unit.toString()+"'.");r=this._operate(e,t,this.value,n.value)}else"*"===t?(i.numerator=i.numerator.concat(n.unit.numerator).sort(),i.denominator=i.denominator.concat(n.unit.denominator).sort(),i.cancel()):"/"===t&&(i.numerator=i.numerator.concat(n.unit.denominator).sort(),i.denominator=i.denominator.concat(n.unit.numerator).sort(),i.cancel());return new o(r,i)},o.prototype.compare=function(e){var t,n;if(e instanceof o){if(this.unit.isEmpty()||e.unit.isEmpty())t=this,n=e;else if(t=this.unify(),n=e.unify(),0!==t.unit.compare(n.unit))return;return r.numericCompare(t.value,n.value)}},o.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},o.prototype.convertTo=function(e){var t,n,r,a,s,u=this.value,l=this.unit.clone(),c={};if("string"==typeof e){for(t in i)i[t].hasOwnProperty(e)&&((c={})[t]=e);e=c}for(n in s=function(e,t){return r.hasOwnProperty(e)?(t?u/=r[e]/r[a]:u*=r[e]/r[a],a):e},e)e.hasOwnProperty(n)&&(a=e[n],r=i[n],l.map(s));return l.cancel(),new o(u,l)},t.exports=o},{"../data/unit-conversions":16,"./color":55,"./node":76,"./unit":84}],63:[function(e,t,n){var r=e("./node"),i=e("./paren"),a=e("./combinator"),s=function(e,t,n,r,i,s){this.combinator=e instanceof a?e:new a(e),this.value="string"==typeof t?t.trim():t||"",this.isVariable=n,this._index=r,this._fileInfo=i,this.copyVisibilityInfo(s),this.setParent(this.combinator,this)};(s.prototype=new r).type="Element",s.prototype.accept=function(e){var t=this.value;this.combinator=e.visit(this.combinator),"object"==typeof t&&(this.value=e.visit(t))},s.prototype.eval=function(e){return new s(this.combinator,this.value.eval?this.value.eval(e):this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},s.prototype.clone=function(){return new s(this.combinator,this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},s.prototype.genCSS=function(e,t){t.add(this.toCSS(e),this.fileInfo(),this.getIndex())},s.prototype.toCSS=function(e){e=e||{};var t=this.value,n=e.firstSelector;return t instanceof i&&(e.firstSelector=!0),t=t.toCSS?t.toCSS(e):t,e.firstSelector=n,""===t&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(e)+t},t.exports=s},{"./combinator":56,"./node":76,"./paren":78}],64:[function(e,t,n){var r=e("./node"),i=e("./paren"),a=e("./comment"),s=e("./dimension"),o=e("../constants").Math,u=function(e,t){if(this.value=e,this.noSpacing=t,!e)throw new Error("Expression requires an array parameter")};(u.prototype=new r).type="Expression",u.prototype.accept=function(e){this.value=e.visitArray(this.value)},u.prototype.eval=function(e){var t,n=e.isMathOn(),r=this.parens&&(e.math!==o.STRICT_LEGACY||!this.parensInOp),a=!1;return r&&e.inParenthesis(),this.value.length>1?t=new u(this.value.map(function(t){return t.eval?t.eval(e):t}),this.noSpacing):1===this.value.length?(!this.value[0].parens||this.value[0].parensInOp||e.inCalc||(a=!0),t=this.value[0].eval(e)):t=this,r&&e.outOfParenthesis(),!this.parens||!this.parensInOp||n||a||t instanceof s||(t=new i(t)),t},u.prototype.genCSS=function(e,t){for(var n=0;n<this.value.length;n++)this.value[n].genCSS(e,t),!this.noSpacing&&n+1<this.value.length&&t.add(" ")},u.prototype.throwAwayComments=function(){this.value=this.value.filter(function(e){return!(e instanceof a)})},t.exports=u},{"../constants":12,"./comment":57,"./dimension":62,"./node":76,"./paren":78}],65:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=function e(t,n,r,i,a){switch(this.selector=t,this.option=n,this.object_id=e.next_id++,this.parent_ids=[this.object_id],this._index=r,this._fileInfo=i,this.copyVisibilityInfo(a),this.allowRoot=!0,n){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}this.setParent(this.selector,this)};a.next_id=0,(a.prototype=new r).type="Extend",a.prototype.accept=function(e){this.selector=e.visit(this.selector)},a.prototype.eval=function(e){return new a(this.selector.eval(e),this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.clone=function(e){return new a(this.selector,this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.findSelfSelectors=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t].elements,t>0&&n.length&&""===n[0].combinator.value&&(n[0].combinator.value=" "),r=r.concat(e[t].elements);this.selfSelectors=[new i(r)],this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo())},t.exports=a},{"./node":76,"./selector":82}],66:[function(e,t,n){var r=e("./node"),i=e("./media"),a=e("./url"),s=e("./quoted"),o=e("./ruleset"),u=e("./anonymous"),l=e("../utils"),c=e("../less-error"),d=function(e,t,n,r,i,a){if(this.options=n,this._index=r,this._fileInfo=i,this.path=e,this.features=t,this.allowRoot=!0,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var s=this.getPath();s&&/[#\.\&\?]css([\?;].*)?$/.test(s)&&(this.css=!0)}this.copyVisibilityInfo(a),this.setParent(this.features,this),this.setParent(this.path,this)};(d.prototype=new r).type="Import",d.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.path=e.visit(this.path),this.options.isPlugin||this.options.inline||!this.root||(this.root=e.visit(this.root))},d.prototype.genCSS=function(e,t){this.css&&void 0===this.path._fileInfo.reference&&(t.add("@import ",this._fileInfo,this._index),this.path.genCSS(e,t),this.features&&(t.add(" "),this.features.genCSS(e,t)),t.add(";"))},d.prototype.getPath=function(){return this.path instanceof a?this.path.value.value:this.path.value},d.prototype.isVariableImport=function(){var e=this.path;return e instanceof a&&(e=e.value),!(e instanceof s)||e.containsVariables()},d.prototype.evalForImport=function(e){var t=this.path;return t instanceof a&&(t=t.value),new d(t.eval(e),this.features,this.options,this._index,this._fileInfo,this.visibilityInfo())},d.prototype.evalPath=function(e){var t=this.path.eval(e),n=this._fileInfo;if(!(t instanceof a)){var r=t.value;n&&r&&e.pathRequiresRewrite(r)?t.value=e.rewritePath(r,n.rootpath):t.value=e.normalizePath(t.value)}return t},d.prototype.eval=function(e){var t=this.doEval(e);return(this.options.reference||this.blocksVisibility())&&(t.length||0===t.length?t.forEach(function(e){e.addVisibilityBlock()}):t.addVisibilityBlock()),t},d.prototype.doEval=function(e){var t,n,r=this.features&&this.features.eval(e);if(this.options.isPlugin){if(this.root&&this.root.eval)try{this.root.eval(e)}catch(e){throw e.message="Plugin error during evaluation",new c(e,this.root.imports,this.root.filename)}return(n=e.frames[0]&&e.frames[0].functionRegistry)&&this.root&&this.root.functions&&n.addMultiple(this.root.functions),[]}if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var a=new u(this.root,0,{filename:this.importedFilename,reference:this.path._fileInfo&&this.path._fileInfo.reference},!0,!0);return this.features?new i([a],this.features.value):[a]}if(this.css){var s=new d(this.evalPath(e),r,this.options,this._index);if(!s.css&&this.error)throw this.error;return s}return(t=new o(null,l.copyArray(this.root.rules))).evalImports(e),this.features?new i(t.rules,this.features.value):t.rules},t.exports=d},{"../less-error":38,"../utils":89,"./anonymous":50,"./media":71,"./node":76,"./quoted":80,"./ruleset":81,"./url":85}],67:[function(e,t,n){var r=Object.create(null);r.Node=e("./node"),r.Color=e("./color"),r.AtRule=e("./atrule"),r.DetachedRuleset=e("./detached-ruleset"),r.Operation=e("./operation"),r.Dimension=e("./dimension"),r.Unit=e("./unit"),r.Keyword=e("./keyword"),r.Variable=e("./variable"),r.Property=e("./property"),r.Ruleset=e("./ruleset"),r.Element=e("./element"),r.Attribute=e("./attribute"),r.Combinator=e("./combinator"),r.Selector=e("./selector"),r.Quoted=e("./quoted"),r.Expression=e("./expression"),r.Declaration=e("./declaration"),r.Call=e("./call"),r.URL=e("./url"),r.Import=e("./import"),r.mixin={Call:e("./mixin-call"),Definition:e("./mixin-definition")},r.Comment=e("./comment"),r.Anonymous=e("./anonymous"),r.Value=e("./value"),r.JavaScript=e("./javascript"),r.Assignment=e("./assignment"),r.Condition=e("./condition"),r.Paren=e("./paren"),r.Media=e("./media"),r.UnicodeDescriptor=e("./unicode-descriptor"),r.Negative=e("./negative"),r.Extend=e("./extend"),r.VariableCall=e("./variable-call"),r.NamespaceValue=e("./namespace-value"),t.exports=r},{"./anonymous":50,"./assignment":51,"./atrule":52,"./attribute":53,"./call":54,"./color":55,"./combinator":56,"./comment":57,"./condition":58,"./declaration":60,"./detached-ruleset":61,"./dimension":62,"./element":63,"./expression":64,"./extend":65,"./import":66,"./javascript":68,"./keyword":70,"./media":71,"./mixin-call":72,"./mixin-definition":73,"./namespace-value":74,"./negative":75,"./node":76,"./operation":77,"./paren":78,"./property":79,"./quoted":80,"./ruleset":81,"./selector":82,"./unicode-descriptor":83,"./unit":84,"./url":85,"./value":86,"./variable":88,"./variable-call":87}],68:[function(e,t,n){var r=e("./js-eval-node"),i=e("./dimension"),a=e("./quoted"),s=e("./anonymous"),o=function(e,t,n,r){this.escaped=t,this.expression=e,this._index=n,this._fileInfo=r};(o.prototype=new r).type="JavaScript",o.prototype.eval=function(e){var t=this.evaluateJavaScript(this.expression,e),n=typeof t;return"number"!==n||isNaN(t)?"string"===n?new a('"'+t+'"',t,this.escaped,this._index):Array.isArray(t)?new s(t.join(", ")):new s(t):new i(t)},t.exports=o},{"./anonymous":50,"./dimension":62,"./js-eval-node":69,"./quoted":80}],69:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=function(){};(a.prototype=new r).evaluateJavaScript=function(e,t){var n,r=this,a={};if(!t.javascriptEnabled)throw{message:"Inline JavaScript is not enabled. Is it set in your options?",filename:this.fileInfo().filename,index:this.getIndex()};e=e.replace(/@\{([\w-]+)\}/g,function(e,n){return r.jsify(new i("@"+n,r.getIndex(),r.fileInfo()).eval(t))});try{e=new Function("return ("+e+")")}catch(t){throw{message:"JavaScript evaluation error: "+t.message+" from `"+e+"`",filename:this.fileInfo().filename,index:this.getIndex()}}var s=t.frames[0].variables();for(var o in s)s.hasOwnProperty(o)&&(a[o.slice(1)]={value:s[o].value,toJS:function(){return this.value.eval(t).toCSS()}});try{n=e.call(a)}catch(e){throw{message:"JavaScript evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:this.fileInfo().filename,index:this.getIndex()}}return n},a.prototype.jsify=function(e){return Array.isArray(e.value)&&e.value.length>1?"["+e.value.map(function(e){return e.toCSS()}).join(", ")+"]":e.toCSS()},t.exports=a},{"./node":76,"./variable":88}],70:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="Keyword",i.prototype.genCSS=function(e,t){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};t.add(this.value)},i.True=new i("true"),i.False=new i("false"),t.exports=i},{"./node":76}],71:[function(e,t,n){var r=e("./ruleset"),i=e("./value"),a=e("./selector"),s=e("./anonymous"),o=e("./expression"),u=e("./atrule"),l=e("../utils"),c=function(e,t,n,s,o){this._index=n,this._fileInfo=s;var u=new a([],null,null,this._index,this._fileInfo).createEmptySelectors();this.features=new i(t),this.rules=[new r(u,e)],this.rules[0].allowImports=!0,this.copyVisibilityInfo(o),this.allowRoot=!0,this.setParent(u,this),this.setParent(this.features,this),this.setParent(this.rules,this)};(c.prototype=new u).type="Media",c.prototype.isRulesetLike=function(){return!0},c.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.rules&&(this.rules=e.visitArray(this.rules))},c.prototype.genCSS=function(e,t){t.add("@media ",this._fileInfo,this._index),this.features.genCSS(e,t),this.outputRuleset(e,t,this.rules)},c.prototype.eval=function(e){e.mediaBlocks||(e.mediaBlocks=[],e.mediaPath=[]);var t=new c(null,[],this._index,this._fileInfo,this.visibilityInfo());return this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,t.debugInfo=this.debugInfo),t.features=this.features.eval(e),e.mediaPath.push(t),e.mediaBlocks.push(t),this.rules[0].functionRegistry=e.frames[0].functionRegistry.inherit(),e.frames.unshift(this.rules[0]),t.rules=[this.rules[0].eval(e)],e.frames.shift(),e.mediaPath.pop(),0===e.mediaPath.length?t.evalTop(e):t.evalNested(e)},c.prototype.evalTop=function(e){var t=this;if(e.mediaBlocks.length>1){var n=new a([],null,null,this.getIndex(),this.fileInfo()).createEmptySelectors();(t=new r(n,e.mediaBlocks)).multiMedia=!0,t.copyVisibilityInfo(this.visibilityInfo()),this.setParent(t,this)}return delete e.mediaBlocks,delete e.mediaPath,t},c.prototype.evalNested=function(e){var t,n,a=e.mediaPath.concat([this]);for(t=0;t<a.length;t++)n=a[t].features instanceof i?a[t].features.value:a[t].features,a[t]=Array.isArray(n)?n:[n];return this.features=new i(this.permute(a).map(function(e){for(e=e.map(function(e){return e.toCSS?e:new s(e)}),t=e.length-1;t>0;t--)e.splice(t,0,new s("and"));return new o(e)})),this.setParent(this.features,this),new r([],[])},c.prototype.permute=function(e){if(0===e.length)return[];if(1===e.length)return e[0];for(var t=[],n=this.permute(e.slice(1)),r=0;r<n.length;r++)for(var i=0;i<e[0].length;i++)t.push([e[0][i]].concat(n[r]));return t},c.prototype.bubbleSelectors=function(e){e&&(this.rules=[new r(l.copyArray(e),[this.rules[0]])],this.setParent(this.rules,this))},t.exports=c},{"../utils":89,"./anonymous":50,"./atrule":52,"./expression":64,"./ruleset":81,"./selector":82,"./value":86}],72:[function(e,t,n){var r=e("./node"),i=e("./selector"),a=e("./mixin-definition"),s=e("../functions/default"),o=function(e,t,n,r,a){this.selector=new i(e),this.arguments=t||[],this._index=n,this._fileInfo=r,this.important=a,this.allowRoot=!0,this.setParent(this.selector,this)};(o.prototype=new r).type="MixinCall",o.prototype.accept=function(e){this.selector&&(this.selector=e.visit(this.selector)),this.arguments.length&&(this.arguments=e.visitArray(this.arguments))},o.prototype.eval=function(e){var t,n,r,i,o,u,l,c,d,h,f,p,m,v,y,g=[],_=[],b=!1,w=[],E=[],S=-1,T=0,k=1,C=2;function I(t,n){var r,i,a;for(r=0;r<2;r++){for(E[r]=!0,s.value(r),i=0;i<n.length&&E[r];i++)(a=n[i]).matchCondition&&(E[r]=E[r]&&a.matchCondition(null,e));t.matchCondition&&(E[r]=E[r]&&t.matchCondition(g,e))}return E[0]||E[1]?E[0]!=E[1]?E[1]?k:C:T:S}for(this.selector=this.selector.eval(e),u=0;u<this.arguments.length;u++)if(i=this.arguments[u],o=i.value.eval(e),i.expand&&Array.isArray(o.value))for(o=o.value,l=0;l<o.length;l++)g.push({value:o[l]});else g.push({name:i.name,value:o});for(y=function(t){return t.matchArgs(null,e)},u=0;u<e.frames.length;u++)if((t=e.frames[u].find(this.selector,null,y)).length>0){for(h=!0,l=0;l<t.length;l++){for(n=t[l].rule,r=t[l].path,d=!1,c=0;c<e.frames.length;c++)if(!(n instanceof a)&&n===(e.frames[c].originalRuleset||e.frames[c])){d=!0;break}d||n.matchArgs(g,e)&&((f={mixin:n,group:I(n,r)}).group!==S&&w.push(f),b=!0)}for(s.reset(),m=[0,0,0],l=0;l<w.length;l++)m[w[l].group]++;if(m[T]>0)p=C;else if(p=k,m[k]+m[C]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(g)+"`",index:this.getIndex(),filename:this.fileInfo().filename};for(l=0;l<w.length;l++)if((f=w[l].group)===T||f===p)try{(n=w[l].mixin)instanceof a||(v=n.originalRuleset||n,(n=new a("",[],n.rules,null,!1,null,v.visibilityInfo())).originalRuleset=v);var A=n.evalCall(e,g,this.important).rules;this._setVisibilityToReplacement(A),Array.prototype.push.apply(_,A)}catch(e){throw{message:e.message,index:this.getIndex(),filename:this.fileInfo().filename,stack:e.stack}}if(b)return _}throw h?{type:"Runtime",message:"No matching definition was found for `"+this.format(g)+"`",index:this.getIndex(),filename:this.fileInfo().filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.getIndex(),filename:this.fileInfo().filename}},o.prototype._setVisibilityToReplacement=function(e){var t;if(this.blocksVisibility())for(t=0;t<e.length;t++)e[t].addVisibilityBlock()},o.prototype.format=function(e){return this.selector.toCSS().trim()+"("+(e?e.map(function(e){var t="";return e.name&&(t+=e.name+":"),e.value.toCSS?t+=e.value.toCSS():t+="???",t}).join(", "):"")+")"},t.exports=o},{"../functions/default":25,"./mixin-definition":73,"./node":76,"./selector":82}],73:[function(e,t,n){var r=e("./selector"),i=e("./element"),a=e("./ruleset"),s=e("./declaration"),o=e("./detached-ruleset"),u=e("./expression"),l=e("../contexts"),c=e("../utils"),d=function(e,t,n,a,s,o,u){this.name=e||"anonymous mixin",this.selectors=[new r([new i(null,e,!1,this._index,this._fileInfo)])],this.params=t,this.condition=a,this.variadic=s,this.arity=t.length,this.rules=n,this._lookups={};var l=[];this.required=t.reduce(function(e,t){return!t.name||t.name&&!t.value?e+1:(l.push(t.name),e)},0),this.optionalParameters=l,this.frames=o,this.copyVisibilityInfo(u),this.allowRoot=!0};(d.prototype=new a).type="MixinDefinition",d.prototype.evalFirst=!0,d.prototype.accept=function(e){this.params&&this.params.length&&(this.params=e.visitArray(this.params)),this.rules=e.visitArray(this.rules),this.condition&&(this.condition=e.visit(this.condition))},d.prototype.evalParams=function(e,t,n,r){var i,d,h,f,p,m,v,y,g=new a(null,null),_=c.copyArray(this.params),b=0;if(t.frames&&t.frames[0]&&t.frames[0].functionRegistry&&(g.functionRegistry=t.frames[0].functionRegistry.inherit()),t=new l.Eval(t,[g].concat(t.frames)),n)for(n=c.copyArray(n),b=n.length,h=0;h<b;h++)if(d=n[h],m=d&&d.name){for(v=!1,f=0;f<_.length;f++)if(!r[f]&&m===_[f].name){r[f]=d.value.eval(e),g.prependRule(new s(m,d.value.eval(e))),v=!0;break}if(v){n.splice(h,1),h--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+n[h].name+" not found"}}for(y=0,h=0;h<_.length;h++)if(!r[h]){if(d=n&&n[y],m=_[h].name)if(_[h].variadic){for(i=[],f=y;f<b;f++)i.push(n[f].value.eval(e));g.prependRule(new s(m,new u(i).eval(e)))}else{if(p=d&&d.value)p=Array.isArray(p)?new o(new a("",p)):p.eval(e);else{if(!_[h].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+b+" for "+this.arity+")"};p=_[h].value.eval(t),g.resetCache()}g.prependRule(new s(m,p)),r[h]=p}if(_[h].variadic&&n)for(f=y;f<b;f++)r[f]=n[f].value.eval(e);y++}return g},d.prototype.makeImportant=function(){var e=this.rules?this.rules.map(function(e){return e.makeImportant?e.makeImportant(!0):e}):this.rules,t=new d(this.name,this.params,e,this.condition,this.variadic,this.frames);return t},d.prototype.eval=function(e){return new d(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||c.copyArray(e.frames))},d.prototype.evalCall=function(e,t,n){var r,i,o=[],d=this.frames?this.frames.concat(e.frames):e.frames,h=this.evalParams(e,new l.Eval(e,d),t,o);return h.prependRule(new s("@arguments",new u(o).eval(e))),r=c.copyArray(this.rules),(i=new a(null,r)).originalRuleset=this,i=i.eval(new l.Eval(e,[this,h].concat(d))),n&&(i=i.makeImportant()),i},d.prototype.matchCondition=function(e,t){return!(this.condition&&!this.condition.eval(new l.Eval(t,[this.evalParams(t,new l.Eval(t,this.frames?this.frames.concat(t.frames):t.frames),e,[])].concat(this.frames||[]).concat(t.frames))))},d.prototype.matchArgs=function(e,t){var n,r=e&&e.length||0,i=this.optionalParameters,a=e?e.reduce(function(e,t){return i.indexOf(t.name)<0?e+1:e},0):0;if(this.variadic){if(a<this.required-1)return!1}else{if(a<this.required)return!1;if(r>this.params.length)return!1}n=Math.min(a,this.arity);for(var s=0;s<n;s++)if(!this.params[s].name&&!this.params[s].variadic&&e[s].value.eval(t).toCSS()!=this.params[s].value.eval(t).toCSS())return!1;return!0},t.exports=d},{"../contexts":13,"../utils":89,"./declaration":60,"./detached-ruleset":61,"./element":63,"./expression":64,"./ruleset":81,"./selector":82}],74:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./ruleset"),s=e("./selector"),o=function(e,t,n,r,i){this.value=e,this.lookups=t,this.important=n,this._index=r,this._fileInfo=i};(o.prototype=new r).type="NamespaceValue",o.prototype.eval=function(e){var t,n,r=this.value.eval(e);for(t=0;t<this.lookups.length;t++){if(n=this.lookups[t],Array.isArray(r)&&(r=new a([new s],r)),""===n)r=r.lastDeclaration();else if("@"===n.charAt(0)){if("@"===n.charAt(1)&&(n="@"+new i(n.substr(1)).eval(e).value),r.variables&&(r=r.variable(n)),!r)throw{type:"Name",message:"variable "+n+" not found",filename:this.fileInfo().filename,index:this.getIndex()}}else{if(n="$@"===n.substring(0,2)?"$"+new i(n.substr(1)).eval(e).value:"$"===n.charAt(0)?n:"$"+n,r.properties&&(r=r.property(n)),!r)throw{type:"Name",message:'property "'+n.substr(1)+'" not found',filename:this.fileInfo().filename,index:this.getIndex()};r=r[r.length-1]}r.value&&(r=r.eval(e).value),r.ruleset&&(r=r.ruleset.eval(e))}return r},t.exports=o},{"./node":76,"./ruleset":81,"./selector":82,"./variable":88}],75:[function(e,t,n){var r=e("./node"),i=e("./operation"),a=e("./dimension"),s=function(e){this.value=e};(s.prototype=new r).type="Negative",s.prototype.genCSS=function(e,t){t.add("-"),this.value.genCSS(e,t)},s.prototype.eval=function(e){return e.isMathOn()?new i("*",[new a(-1),this.value]).eval(e):new s(this.value.eval(e))},t.exports=s},{"./dimension":62,"./node":76,"./operation":77}],76:[function(e,t,n){var r=function(){this.parent=null,this.visibilityBlocks=void 0,this.nodeVisible=void 0,this.rootNode=null,this.parsed=null;var e=this;Object.defineProperty(this,"currentFileInfo",{get:function(){return e.fileInfo()}}),Object.defineProperty(this,"index",{get:function(){return e.getIndex()}})};r.prototype.setParent=function(e,t){function n(e){e&&e instanceof r&&(e.parent=t)}Array.isArray(e)?e.forEach(n):n(e)},r.prototype.getIndex=function(){return this._index||this.parent&&this.parent.getIndex()||0},r.prototype.fileInfo=function(){return this._fileInfo||this.parent&&this.parent.fileInfo()||{}},r.prototype.isRulesetLike=function(){return!1},r.prototype.toCSS=function(e){var t=[];return this.genCSS(e,{add:function(e,n,r){t.push(e)},isEmpty:function(){return 0===t.length}}),t.join("")},r.prototype.genCSS=function(e,t){t.add(this.value)},r.prototype.accept=function(e){this.value=e.visit(this.value)},r.prototype.eval=function(){return this},r.prototype._operate=function(e,t,n,r){switch(t){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r}},r.prototype.fround=function(e,t){var n=e&&e.numPrecision;return n?Number((t+2e-16).toFixed(n)):t},r.compare=function(e,t){if(e.compare&&"Quoted"!==t.type&&"Anonymous"!==t.type)return e.compare(t);if(t.compare)return-t.compare(e);if(e.type===t.type){if(e=e.value,t=t.value,!Array.isArray(e))return e===t?0:void 0;if(e.length===t.length){for(var n=0;n<e.length;n++)if(0!==r.compare(e[n],t[n]))return;return 0}}},r.numericCompare=function(e,t){return e<t?-1:e===t?0:e>t?1:void 0},r.prototype.blocksVisibility=function(){return null==this.visibilityBlocks&&(this.visibilityBlocks=0),0!==this.visibilityBlocks},r.prototype.addVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks+1},r.prototype.removeVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks-1},r.prototype.ensureVisibility=function(){this.nodeVisible=!0},r.prototype.ensureInvisibility=function(){this.nodeVisible=!1},r.prototype.isVisible=function(){return this.nodeVisible},r.prototype.visibilityInfo=function(){return{visibilityBlocks:this.visibilityBlocks,nodeVisible:this.nodeVisible}},r.prototype.copyVisibilityInfo=function(e){e&&(this.visibilityBlocks=e.visibilityBlocks,this.nodeVisible=e.nodeVisible)},t.exports=r},{}],77:[function(e,t,n){var r=e("./node"),i=e("./color"),a=e("./dimension"),s=e("../constants").Math,o=function(e,t,n){this.op=e.trim(),this.operands=t,this.isSpaced=n};(o.prototype=new r).type="Operation",o.prototype.accept=function(e){this.operands=e.visit(this.operands)},o.prototype.eval=function(e){var t,n=this.operands[0].eval(e),r=this.operands[1].eval(e);if(e.isMathOn(this.op)){if(t="./"===this.op?"/":this.op,n instanceof a&&r instanceof i&&(n=n.toColor()),r instanceof a&&n instanceof i&&(r=r.toColor()),!n.operate){if(n instanceof o&&"/"===n.op&&e.math===s.PARENS_DIVISION)return new o(this.op,[n,r],this.isSpaced);throw{type:"Operation",message:"Operation on an invalid type"}}return n.operate(e,t,r)}return new o(this.op,[n,r],this.isSpaced)},o.prototype.genCSS=function(e,t){this.operands[0].genCSS(e,t),this.isSpaced&&t.add(" "),t.add(this.op),this.isSpaced&&t.add(" "),this.operands[1].genCSS(e,t)},t.exports=o},{"../constants":12,"./color":55,"./dimension":62,"./node":76}],78:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="Paren",i.prototype.genCSS=function(e,t){t.add("("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){return new i(this.value.eval(e))},t.exports=i},{"./node":76}],79:[function(e,t,n){var r=e("./node"),i=e("./declaration"),a=function(e,t,n){this.name=e,this._index=t,this._fileInfo=n};(a.prototype=new r).type="Property",a.prototype.eval=function(e){var t,n=this.name,r=e.pluginManager.less.visitors.ToCSSVisitor.prototype._mergeRules;if(this.evaluating)throw{type:"Name",message:"Recursive property reference for "+n,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var a,s=t.property(n);if(s){for(var o=0;o<s.length;o++)a=s[o],s[o]=new i(a.name,a.value,a.important,a.merge,a.index,a.currentFileInfo,a.inline,a.variable);if(r(s),(a=s[s.length-1]).important){var u=e.importantScope[e.importantScope.length-1];u.important=a.important}return a=a.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"Property '"+n+"' is undefined",filename:this.currentFileInfo.filename,index:this.index}},a.prototype.find=function(e,t){for(var n,r=0;r<e.length;r++)if(n=t.call(e,e[r]))return n;return null},t.exports=a},{"./declaration":60,"./node":76}],80:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./property"),s=function(e,t,n,r,i){this.escaped=null==n||n,this.value=t||"",this.quote=e.charAt(0),this._index=r,this._fileInfo=i,this.variableRegex=/@\{([\w-]+)\}/g,this.propRegex=/\$\{([\w-]+)\}/g};(s.prototype=new r).type="Quoted",s.prototype.genCSS=function(e,t){this.escaped||t.add(this.quote,this.fileInfo(),this.getIndex()),t.add(this.value),this.escaped||t.add(this.quote)},s.prototype.containsVariables=function(){return this.value.match(this.variableRegex)},s.prototype.eval=function(e){var t=this,n=this.value;function r(e,t,n){var r=e;do{r=(e=r).replace(t,n)}while(e!==r);return r}return n=r(n,this.variableRegex,function(n,r){var a=new i("@"+r,t.getIndex(),t.fileInfo()).eval(e,!0);return a instanceof s?a.value:a.toCSS()}),n=r(n,this.propRegex,function(n,r){var i=new a("$"+r,t.getIndex(),t.fileInfo()).eval(e,!0);return i instanceof s?i.value:i.toCSS()}),new s(this.quote+n+this.quote,n,this.escaped,this.getIndex(),this.fileInfo())},s.prototype.compare=function(e){return"Quoted"!==e.type||this.escaped||e.escaped?e.toCSS&&this.toCSS()===e.toCSS()?0:void 0:r.numericCompare(this.value,e.value)},t.exports=s},{"./node":76,"./property":79,"./variable":88}],81:[function(e,t,n){var r=e("./node"),i=e("./declaration"),a=e("./keyword"),s=e("./comment"),o=e("./paren"),u=e("./selector"),l=e("./element"),c=e("./anonymous"),d=e("../contexts"),h=e("../functions/function-registry"),f=e("../functions/default"),p=e("./debug-info"),m=e("../utils"),v=function(e,t,n,r){this.selectors=e,this.rules=t,this._lookups={},this._variables=null,this._properties=null,this.strictImports=n,this.copyVisibilityInfo(r),this.allowRoot=!0,this.setParent(this.selectors,this),this.setParent(this.rules,this)};(v.prototype=new r).type="Ruleset",v.prototype.isRuleset=!0,v.prototype.isRulesetLike=function(){return!0},v.prototype.accept=function(e){this.paths?this.paths=e.visitArray(this.paths,!0):this.selectors&&(this.selectors=e.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=e.visitArray(this.rules))},v.prototype.eval=function(e){var t,n,a,s,o,u=!1;if(this.selectors&&(n=this.selectors.length)){for(t=new Array(n),f.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),s=0;s<n;s++){a=this.selectors[s].eval(e);for(var l=0;l<a.elements.length;l++)if(a.elements[l].isVariable){o=!0;break}t[s]=a,a.evaldCondition&&(u=!0)}if(o){var c=new Array(n);for(s=0;s<n;s++)a=t[s],c[s]=a.toCSS(e);this.parse.parseNode(c.join(","),["selectors"],t[0].getIndex(),t[0].fileInfo(),function(e,n){n&&(t=m.flattenArray(n))})}f.reset()}else u=!0;var d,p,y=this.rules?m.copyArray(this.rules):null,g=new v(t,y,this.strictImports,this.visibilityInfo());g.originalRuleset=this,g.root=this.root,g.firstRoot=this.firstRoot,g.allowImports=this.allowImports,this.debugInfo&&(g.debugInfo=this.debugInfo),u||(y.length=0),g.functionRegistry=function(e){for(var t,n=0,r=e.length;n!==r;++n)if(t=e[n].functionRegistry)return t;return h}(e.frames).inherit();var _=e.frames;_.unshift(g);var b=e.selectors;b||(e.selectors=b=[]),b.unshift(this.selectors),(g.root||g.allowImports||!g.strictImports)&&g.evalImports(e);var w=g.rules;for(s=0;d=w[s];s++)d.evalFirst&&(w[s]=d.eval(e));var E=e.mediaBlocks&&e.mediaBlocks.length||0;for(s=0;d=w[s];s++)"MixinCall"===d.type?(y=d.eval(e).filter(function(e){return!(e instanceof i&&e.variable&&g.variable(e.name))}),w.splice.apply(w,[s,1].concat(y)),s+=y.length-1,g.resetCache()):"VariableCall"===d.type&&(y=d.eval(e).rules.filter(function(e){return!(e instanceof i&&e.variable)}),w.splice.apply(w,[s,1].concat(y)),s+=y.length-1,g.resetCache());for(s=0;d=w[s];s++)d.evalFirst||(w[s]=d=d.eval?d.eval(e):d);for(s=0;d=w[s];s++)if(d instanceof v&&d.selectors&&1===d.selectors.length&&d.selectors[0]&&d.selectors[0].isJustParentSelector()){w.splice(s--,1);for(var l=0;p=d.rules[l];l++)p instanceof r&&(p.copyVisibilityInfo(d.visibilityInfo()),p instanceof i&&p.variable||w.splice(++s,0,p))}if(_.shift(),b.shift(),e.mediaBlocks)for(s=E;s<e.mediaBlocks.length;s++)e.mediaBlocks[s].bubbleSelectors(t);return g},v.prototype.evalImports=function(e){var t,n,r=this.rules;if(r)for(t=0;t<r.length;t++)"Import"===r[t].type&&((n=r[t].eval(e))&&(n.length||0===n.length)?(r.splice.apply(r,[t,1].concat(n)),t+=n.length-1):r.splice(t,1,n),this.resetCache())},v.prototype.makeImportant=function(){var e=new v(this.selectors,this.rules.map(function(e){return e.makeImportant?e.makeImportant():e}),this.strictImports,this.visibilityInfo());return e},v.prototype.matchArgs=function(e){return!e||0===e.length},v.prototype.matchCondition=function(e,t){var n=this.selectors[this.selectors.length-1];return!(!n.evaldCondition||n.condition&&!n.condition.eval(new d.Eval(t,t.frames)))},v.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._properties=null,this._lookups={}},v.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(e,t){if(t instanceof i&&!0===t.variable&&(e[t.name]=t),"Import"===t.type&&t.root&&t.root.variables){var n=t.root.variables();for(var r in n)n.hasOwnProperty(r)&&(e[r]=t.root.variable(r))}return e},{}):{}),this._variables},v.prototype.properties=function(){return this._properties||(this._properties=this.rules?this.rules.reduce(function(e,t){if(t instanceof i&&!0!==t.variable){var n=1===t.name.length&&t.name[0]instanceof a?t.name[0].value:t.name;e["$"+n]?e["$"+n].push(t):e["$"+n]=[t]}return e},{}):{}),this._properties},v.prototype.variable=function(e){var t=this.variables()[e];if(t)return this.parseValue(t)},v.prototype.property=function(e){var t=this.properties()[e];if(t)return this.parseValue(t)},v.prototype.lastDeclaration=function(){for(var e=this.rules.length;e>0;e--){var t=this.rules[e-1];if(t instanceof i)return this.parseValue(t)}},v.prototype.parseValue=function(e){var t=this;function n(e){return e.value instanceof c&&!e.parsed?("string"==typeof e.value.value?this.parse.parseNode(e.value.value,["value","important"],e.value.getIndex(),e.fileInfo(),function(t,n){t&&(e.parsed=!0),n&&(e.value=n[0],e.important=n[1]||"",e.parsed=!0)}):e.parsed=!0,e):e}if(Array.isArray(e)){var r=[];return e.forEach(function(e){r.push(n.call(t,e))}),r}return n.call(t,e)},v.prototype.rulesets=function(){if(!this.rules)return[];var e,t,n=[],r=this.rules;for(e=0;t=r[e];e++)t.isRuleset&&n.push(t);return n},v.prototype.prependRule=function(e){var t=this.rules;t?t.unshift(e):this.rules=[e],this.setParent(e,this)},v.prototype.find=function(e,t,n){t=t||this;var r,i,a=[],s=e.toCSS();return s in this._lookups?this._lookups[s]:(this.rulesets().forEach(function(s){if(s!==t)for(var o=0;o<s.selectors.length;o++)if(r=e.match(s.selectors[o])){if(e.elements.length>r){if(!n||n(s)){i=s.find(new u(e.elements.slice(r)),t,n);for(var l=0;l<i.length;++l)i[l].path.push(s);Array.prototype.push.apply(a,i)}}else a.push({rule:s,path:[]});break}}),this._lookups[s]=a,a)},v.prototype.genCSS=function(e,t){var n,r,i,a,o,u=[];e.tabLevel=e.tabLevel||0,this.root||e.tabLevel++;var l,c=e.compress?"":Array(e.tabLevel+1).join("  "),d=e.compress?"":Array(e.tabLevel).join("  "),h=0,f=0;for(n=0;a=this.rules[n];n++)a instanceof s?(f===n&&f++,u.push(a)):a.isCharset&&a.isCharset()?(u.splice(h,0,a),h++,f++):"Import"===a.type?(u.splice(f,0,a),f++):u.push(a);if(u=[].concat(u),!this.root){(i=p(e,this,d))&&(t.add(i),t.add(d));var m,v=this.paths,y=v.length;for(l=e.compress?",":",\n"+d,n=0;n<y;n++)if(o=v[n],m=o.length)for(n>0&&t.add(l),e.firstSelector=!0,o[0].genCSS(e,t),e.firstSelector=!1,r=1;r<m;r++)o[r].genCSS(e,t);t.add((e.compress?"{":" {\n")+c)}for(n=0;a=u[n];n++){n+1===u.length&&(e.lastRule=!0);var g=e.lastRule;a.isRulesetLike(a)&&(e.lastRule=!1),a.genCSS?a.genCSS(e,t):a.value&&t.add(a.value.toString()),e.lastRule=g,!e.lastRule&&a.isVisible()?t.add(e.compress?"":"\n"+c):e.lastRule=!1}this.root||(t.add(e.compress?"}":"\n"+d+"}"),e.tabLevel--),t.isEmpty()||e.compress||!this.firstRoot||t.add("\n")},v.prototype.joinSelectors=function(e,t,n){for(var r=0;r<n.length;r++)this.joinSelector(e,t,n[r])},v.prototype.joinSelector=function(e,t,n){function r(e,t){var n,r;if(0===e.length)n=new o(e[0]);else{var i=new Array(e.length);for(r=0;r<e.length;r++)i[r]=new l(null,e[r],t.isVariable,t._index,t._fileInfo);n=new o(new u(i))}return n}function i(e,t,n,r){var i,a,s;if(i=[],e.length>0?(i=m.copyArray(e),a=i.pop(),s=r.createDerived(m.copyArray(a.elements))):s=r.createDerived([]),t.length>0){var o=n.combinator,u=t[0].elements[0];o.emptyOrWhitespace&&!u.combinator.emptyOrWhitespace&&(o=u.combinator),s.elements.push(new l(o,u.value,n.isVariable,n._index,n._fileInfo)),s.elements=s.elements.concat(t[0].elements.slice(1))}if(0!==s.elements.length&&i.push(s),t.length>1){var c=t.slice(1);c=c.map(function(e){return e.createDerived(e.elements,[])}),i=i.concat(c)}return i}function a(e,t,n,r,a){var s;for(s=0;s<e.length;s++){var o=i(e[s],t,n,r);a.push(o)}return a}function s(e,t){var n,r;if(0!==e.length)if(0!==t.length)for(n=0;r=t[n];n++)r.length>0?r[r.length-1]=r[r.length-1].createDerived(r[r.length-1].elements.concat(e)):r.push(new u(e));else t.push([new u(e)])}function c(e,t){var n=t.createDerived(t.elements,t.extendList,t.evaldCondition);return n.copyVisibilityInfo(e),n}var d,h;if(!function e(t,n,c){var d,h,f,p,m,v,y,g,_,b,w,E,S,T=!1;function k(e){var t;return e.value instanceof o&&(t=e.value.value)instanceof u?t:null}for(p=[],m=[[]],d=0;g=c.elements[d];d++)if("&"!==g.value){var C=k(g);if(null!=C){s(p,m);var I,A=[],x=[];for(I=e(A,n,C),T=T||I,f=0;f<A.length;f++){var L=(w=r(A[f],g),S=void 0,S=new l(null,w,(E=g).isVariable,E._index,E._fileInfo),new u([S]));a(m,[L],g,c,x)}m=x,p=[]}else p.push(g)}else{for(T=!0,v=[],s(p,m),h=0;h<m.length;h++)if(y=m[h],0===n.length)y.length>0&&y[0].elements.push(new l(g.combinator,"",g.isVariable,g._index,g._fileInfo)),v.push(y);else for(f=0;f<n.length;f++){var N=i(y,n[f],g,c);v.push(N)}m=v,p=[]}for(s(p,m),d=0;d<m.length;d++)(_=m[d].length)>0&&(t.push(m[d]),b=m[d][_-1],m[d][_-1]=b.createDerived(b.elements,c.extendList));return T}(h=[],t,n))if(t.length>0)for(h=[],d=0;d<t.length;d++){var f=t[d].map(c.bind(this,n.visibilityInfo()));f.push(n),h.push(f)}else h=[[n]];for(d=0;d<h.length;d++)e.push(h[d])},t.exports=v},{"../contexts":13,"../functions/default":25,"../functions/function-registry":27,"../utils":89,"./anonymous":50,"./comment":57,"./debug-info":59,"./declaration":60,"./element":63,"./keyword":70,"./node":76,"./paren":78,"./selector":82}],82:[function(e,t,n){var r=e("./node"),i=e("./element"),a=e("../less-error"),s=function(e,t,n,r,i,a){this.extendList=t,this.condition=n,this.evaldCondition=!n,this._index=r,this._fileInfo=i,this.elements=this.getElements(e),this.mixinElements_=void 0,this.copyVisibilityInfo(a),this.setParent(this.elements,this)};(s.prototype=new r).type="Selector",s.prototype.accept=function(e){this.elements&&(this.elements=e.visitArray(this.elements)),this.extendList&&(this.extendList=e.visitArray(this.extendList)),this.condition&&(this.condition=e.visit(this.condition))},s.prototype.createDerived=function(e,t,n){e=this.getElements(e);var r=new s(e,t||this.extendList,null,this.getIndex(),this.fileInfo(),this.visibilityInfo());return r.evaldCondition=null!=n?n:this.evaldCondition,r.mediaEmpty=this.mediaEmpty,r},s.prototype.getElements=function(e){return e?("string"==typeof e&&this.parse.parseNode(e,["selector"],this._index,this._fileInfo,function(t,n){if(t)throw new a({index:t.index,message:t.message},this.parse.imports,this._fileInfo.filename);e=n[0].elements}),e):[new i("","&",!1,this._index,this._fileInfo)]},s.prototype.createEmptySelectors=function(){var e=new i("","&",!1,this._index,this._fileInfo),t=[new s([e],null,null,this._index,this._fileInfo)];return t[0].mediaEmpty=!0,t},s.prototype.match=function(e){var t,n,r=this.elements,i=r.length;if(e=e.mixinElements(),0===(t=e.length)||i<t)return 0;for(n=0;n<t;n++)if(r[n].value!==e[n])return 0;return t},s.prototype.mixinElements=function(){if(this.mixinElements_)return this.mixinElements_;var e=this.elements.map(function(e){return e.combinator.value+(e.value.value||e.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);return e?"&"===e[0]&&e.shift():e=[],this.mixinElements_=e},s.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},s.prototype.eval=function(e){var t=this.condition&&this.condition.eval(e),n=this.elements,r=this.extendList;return n=n&&n.map(function(t){return t.eval(e)}),r=r&&r.map(function(t){return t.eval(e)}),this.createDerived(n,r,t)},s.prototype.genCSS=function(e,t){var n;for(e&&e.firstSelector||""!==this.elements[0].combinator.value||t.add(" ",this.fileInfo(),this.getIndex()),n=0;n<this.elements.length;n++)this.elements[n].genCSS(e,t)},s.prototype.getIsOutput=function(){return this.evaldCondition},t.exports=s},{"../less-error":38,"./element":63,"./node":76}],83:[function(e,t,n){var r=e("./node"),i=function(e){this.value=e};(i.prototype=new r).type="UnicodeDescriptor",t.exports=i},{"./node":76}],84:[function(e,t,n){var r=e("./node"),i=e("../data/unit-conversions"),a=e("../utils"),s=function(e,t,n){this.numerator=e?a.copyArray(e).sort():[],this.denominator=t?a.copyArray(t).sort():[],n?this.backupUnit=n:e&&e.length&&(this.backupUnit=e[0])};(s.prototype=new r).type="Unit",s.prototype.clone=function(){return new s(a.copyArray(this.numerator),a.copyArray(this.denominator),this.backupUnit)},s.prototype.genCSS=function(e,t){var n=e&&e.strictUnits;1===this.numerator.length?t.add(this.numerator[0]):!n&&this.backupUnit?t.add(this.backupUnit):!n&&this.denominator.length&&t.add(this.denominator[0])},s.prototype.toString=function(){var e,t=this.numerator.join("*");for(e=0;e<this.denominator.length;e++)t+="/"+this.denominator[e];return t},s.prototype.compare=function(e){return this.is(e.toString())?0:void 0},s.prototype.is=function(e){return this.toString().toUpperCase()===e.toUpperCase()},s.prototype.isLength=function(){return RegExp("^(px|em|ex|ch|rem|in|cm|mm|pc|pt|ex|vw|vh|vmin|vmax)$","gi").test(this.toCSS())},s.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},s.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},s.prototype.map=function(e){var t;for(t=0;t<this.numerator.length;t++)this.numerator[t]=e(this.numerator[t],!1);for(t=0;t<this.denominator.length;t++)this.denominator[t]=e(this.denominator[t],!0)},s.prototype.usedUnits=function(){var e,t,n,r={};for(n in t=function(t){return e.hasOwnProperty(t)&&!r[n]&&(r[n]=t),t},i)i.hasOwnProperty(n)&&(e=i[n],this.map(t));return r},s.prototype.cancel=function(){var e,t,n={};for(t=0;t<this.numerator.length;t++)e=this.numerator[t],n[e]=(n[e]||0)+1;for(t=0;t<this.denominator.length;t++)e=this.denominator[t],n[e]=(n[e]||0)-1;for(e in this.numerator=[],this.denominator=[],n)if(n.hasOwnProperty(e)){var r=n[e];if(r>0)for(t=0;t<r;t++)this.numerator.push(e);else if(r<0)for(t=0;t<-r;t++)this.denominator.push(e)}this.numerator.sort(),this.denominator.sort()},t.exports=s},{"../data/unit-conversions":16,"../utils":89,"./node":76}],85:[function(e,t,n){var r=e("./node"),i=function(e,t,n,r){this.value=e,this._index=t,this._fileInfo=n,this.isEvald=r};(i.prototype=new r).type="Url",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.genCSS=function(e,t){t.add("url("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){var t,n=this.value.eval(e);if(!this.isEvald&&("string"==typeof(t=this.fileInfo()&&this.fileInfo().rootpath)&&"string"==typeof n.value&&e.pathRequiresRewrite(n.value)?(n.quote||(t=t.replace(/[\(\)'"\s]/g,function(e){return"\\"+e})),n.value=e.rewritePath(n.value,t)):n.value=e.normalizePath(n.value),e.urlArgs&&!n.value.match(/^\s*data:/))){var r=-1===n.value.indexOf("?")?"?":"&",a=r+e.urlArgs;-1!==n.value.indexOf("#")?n.value=n.value.replace("#",a+"#"):n.value+=a}return new i(n,this.getIndex(),this.fileInfo(),!0)},t.exports=i},{"./node":76}],86:[function(e,t,n){var r=e("./node"),i=function(e){if(!e)throw new Error("Value requires an array argument");Array.isArray(e)?this.value=e:this.value=[e]};(i.prototype=new r).type="Value",i.prototype.accept=function(e){this.value&&(this.value=e.visitArray(this.value))},i.prototype.eval=function(e){return 1===this.value.length?this.value[0].eval(e):new i(this.value.map(function(t){return t.eval(e)}))},i.prototype.genCSS=function(e,t){var n;for(n=0;n<this.value.length;n++)this.value[n].genCSS(e,t),n+1<this.value.length&&t.add(e&&e.compress?",":", ")},t.exports=i},{"./node":76}],87:[function(e,t,n){var r=e("./node"),i=e("./variable"),a=e("./ruleset"),s=e("./detached-ruleset"),o=e("../less-error"),u=function(e,t,n){this.variable=e,this._index=t,this._fileInfo=n,this.allowRoot=!0};(u.prototype=new r).type="VariableCall",u.prototype.eval=function(e){var t,n=new i(this.variable,this.getIndex(),this.fileInfo()).eval(e),r=new o({message:"Could not evaluate variable call "+this.variable});if(!n.ruleset){if(n.rules)t=n;else if(Array.isArray(n))t=new a("",n);else{if(!Array.isArray(n.value))throw r;t=new a("",n.value)}n=new s(t)}if(n.ruleset)return n.callEval(e);throw r},t.exports=u},{"../less-error":38,"./detached-ruleset":61,"./node":76,"./ruleset":81,"./variable":88}],88:[function(e,t,n){var r=e("./node"),i=e("./call"),a=function(e,t,n){this.name=e,this._index=t,this._fileInfo=n};(a.prototype=new r).type="Variable",a.prototype.eval=function(e){var t,n=this.name;if(0===n.indexOf("@@")&&(n="@"+new a(n.slice(1),this.getIndex(),this.fileInfo()).eval(e).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+n,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var r=t.variable(n);if(r){if(r.important){var a=e.importantScope[e.importantScope.length-1];a.important=r.important}return e.inCalc?new i("_SELF",[r.value]).eval(e):r.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"variable "+n+" is undefined",filename:this.fileInfo().filename,index:this.getIndex()}},a.prototype.find=function(e,t){for(var n,r=0;r<e.length;r++)if(n=t.call(e,e[r]))return n;return null},t.exports=a},{"./call":54,"./node":76}],89:[function(e,t,n){var r=e("./constants"),i=e("clone"),a={getLocation:function(e,t){for(var n=e+1,r=null,i=-1;--n>=0&&"\n"!==t.charAt(n);)i++;return"number"==typeof e&&(r=(t.slice(0,e).match(/\n/g)||"").length),{line:r,column:i}},copyArray:function(e){var t,n=e.length,r=new Array(n);for(t=0;t<n;t++)r[t]=e[t];return r},clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},copyOptions:function(e,t){if(t&&t._defaults)return t;var n=a.defaults(e,t);if(n.strictMath&&(n.math=r.Math.STRICT_LEGACY),n.relativeUrls&&(n.rewriteUrls=r.RewriteUrls.ALL),"string"==typeof n.math)switch(n.math.toLowerCase()){case"always":n.math=r.Math.ALWAYS;break;case"parens-division":n.math=r.Math.PARENS_DIVISION;break;case"strict":case"parens":n.math=r.Math.PARENS;break;case"strict-legacy":n.math=r.Math.STRICT_LEGACY}if("string"==typeof n.rewriteUrls)switch(n.rewriteUrls.toLowerCase()){case"off":n.rewriteUrls=r.RewriteUrls.OFF;break;case"local":n.rewriteUrls=r.RewriteUrls.LOCAL;break;case"all":n.rewriteUrls=r.RewriteUrls.ALL}return n},defaults:function(e,t){var n=t||{};if(!t._defaults){n={};var r=i(e);n._defaults=r;var a=t?i(t):{};Object.assign(n,r,a)}return n},merge:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},flattenArray:function(e,t){t=t||[];for(var n=0,r=e.length;n<r;n++){var i=e[n];Array.isArray(i)?a.flattenArray(i,t):void 0!==i&&t.push(i)}return t}};t.exports=a},{"./constants":12,clone:100}],90:[function(e,t,n){var r=e("../tree"),i=e("./visitor"),a=e("../logger"),s=e("../utils"),o=function(){this._visitor=new i(this),this.contexts=[],this.allExtendsStack=[[]]};o.prototype={run:function(e){return(e=this._visitor.visit(e)).allExtends=this.allExtendsStack[0],e},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var n,i,a,o,u=[],l=e.rules,c=l?l.length:0;for(n=0;n<c;n++)e.rules[n]instanceof r.Extend&&(u.push(l[n]),e.extendOnEveryPath=!0);var d=e.paths;for(n=0;n<d.length;n++){var h=d[n],f=h[h.length-1],p=f.extendList;for((o=p?s.copyArray(p).concat(u):u)&&(o=o.map(function(e){return e.clone()})),i=0;i<o.length;i++)this.foundExtends=!0,(a=o[i]).findSelfSelectors(h),a.ruleset=e,0===i&&(a.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(a)}this.contexts.push(e.selectors)}},visitRulesetOut:function(e){e.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitMediaOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1},visitAtRule:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitAtRuleOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1}};var u=function(){this._visitor=new i(this)};u.prototype={run:function(e){var t=new o;if(this.extendIndices={},t.run(e),!t.foundExtends)return e;e.allExtends=e.allExtends.concat(this.doExtendChaining(e.allExtends,e.allExtends)),this.allExtendsStack=[e.allExtends];var n=this._visitor.visit(e);return this.checkExtendsForNonMatched(e.allExtends),n},checkExtendsForNonMatched:function(e){var t=this.extendIndices;e.filter(function(e){return!e.hasFoundMatches&&1==e.parent_ids.length}).forEach(function(e){var n="_unknown_";try{n=e.selector.toCSS({})}catch(e){}t[e.index+" "+n]||(t[e.index+" "+n]=!0,a.warn("extend '"+n+"' has no matches"))})},doExtendChaining:function(e,t,n){var i,a,s,o,u,l,c,d,h=[],f=this;for(n=n||0,i=0;i<e.length;i++)for(a=0;a<t.length;a++)l=e[i],c=t[a],l.parent_ids.indexOf(c.object_id)>=0||(u=[c.selfSelectors[0]],(s=f.findMatch(l,u)).length&&(l.hasFoundMatches=!0,l.selfSelectors.forEach(function(e){var t=c.visibilityInfo();o=f.extendSelector(s,u,e,l.isVisible()),(d=new r.Extend(c.selector,c.option,0,c.fileInfo(),t)).selfSelectors=o,o[o.length-1].extendList=[d],h.push(d),d.ruleset=c.ruleset,d.parent_ids=d.parent_ids.concat(c.parent_ids,l.parent_ids),c.firstExtendOnThisSelectorPath&&(d.firstExtendOnThisSelectorPath=!0,c.ruleset.paths.push(o))})));if(h.length){if(this.extendChainCount++,n>100){var p="{unable to calculate}",m="{unable to calculate}";try{p=h[0].selfSelectors[0].toCSS(),m=h[0].selector.toCSS()}catch(e){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+p+":extend("+m+")"}}return h.concat(f.doExtendChaining(h,t,n+1))}return h},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitSelector:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var n,r,i,a,s=this.allExtendsStack[this.allExtendsStack.length-1],o=[],u=this;for(i=0;i<s.length;i++)for(r=0;r<e.paths.length;r++)if(a=e.paths[r],!e.extendOnEveryPath){var l=a[a.length-1].extendList;l&&l.length||(n=this.findMatch(s[i],a)).length&&(s[i].hasFoundMatches=!0,s[i].selfSelectors.forEach(function(e){var t;t=u.extendSelector(n,a,e,s[i].isVisible()),o.push(t)}))}e.paths=e.paths.concat(o)}},findMatch:function(e,t){var n,r,i,a,s,o,u,l=e.selector.elements,c=[],d=[];for(n=0;n<t.length;n++)for(r=t[n],i=0;i<r.elements.length;i++)for(a=r.elements[i],(e.allowBefore||0===n&&0===i)&&c.push({pathIndex:n,index:i,matched:0,initialCombinator:a.combinator}),o=0;o<c.length;o++)u=c[o],""===(s=a.combinator.value)&&0===i&&(s=" "),!this.isElementValuesEqual(l[u.matched].value,a.value)||u.matched>0&&l[u.matched].combinator.value!==s?u=null:u.matched++,u&&(u.finished=u.matched===l.length,u.finished&&!e.allowAfter&&(i+1<r.elements.length||n+1<t.length)&&(u=null)),u?u.finished&&(u.length=l.length,u.endPathIndex=n,u.endPathElementIndex=i+1,c.length=0,d.push(u)):(c.splice(o,1),o--);return d},isElementValuesEqual:function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;if(e instanceof r.Attribute)return e.op===t.op&&e.key===t.key&&(e.value&&t.value?(e=e.value.value||e.value,t=t.value.value||t.value,e===t):!e.value&&!t.value);if(e=e.value,t=t.value,e instanceof r.Selector){if(!(t instanceof r.Selector)||e.elements.length!==t.elements.length)return!1;for(var n=0;n<e.elements.length;n++){if(e.elements[n].combinator.value!==t.elements[n].combinator.value&&(0!==n||(e.elements[n].combinator.value||" ")!==(t.elements[n].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(e.elements[n].value,t.elements[n].value))return!1}return!0}return!1},extendSelector:function(e,t,n,i){var a,s,o,u,l,c=0,d=0,h=[];for(a=0;a<e.length;a++)u=e[a],s=t[u.pathIndex],o=new r.Element(u.initialCombinator,n.elements[0].value,n.elements[0].isVariable,n.elements[0].getIndex(),n.elements[0].fileInfo()),u.pathIndex>c&&d>0&&(h[h.length-1].elements=h[h.length-1].elements.concat(t[c].elements.slice(d)),d=0,c++),l=s.elements.slice(d,u.index).concat([o]).concat(n.elements.slice(1)),c===u.pathIndex&&a>0?h[h.length-1].elements=h[h.length-1].elements.concat(l):(h=h.concat(t.slice(c,u.pathIndex))).push(new r.Selector(l)),c=u.endPathIndex,(d=u.endPathElementIndex)>=t[c].elements.length&&(d=0,c++);return c<t.length&&d>0&&(h[h.length-1].elements=h[h.length-1].elements.concat(t[c].elements.slice(d)),c++),h=(h=h.concat(t.slice(c,t.length))).map(function(e){var t=e.createDerived(e.elements);return i?t.ensureVisibility():t.ensureInvisibility(),t})},visitMedia:function(e,t){var n=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);n=n.concat(this.doExtendChaining(n,e.allExtends)),this.allExtendsStack.push(n)},visitMediaOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t},visitAtRule:function(e,t){var n=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);n=n.concat(this.doExtendChaining(n,e.allExtends)),this.allExtendsStack.push(n)},visitAtRuleOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t}},t.exports=u},{"../logger":39,"../tree":67,"../utils":89,"./visitor":97}],91:[function(e,t,n){function r(e){this.imports=[],this.variableImports=[],this._onSequencerEmpty=e,this._currentDepth=0}r.prototype.addImport=function(e){var t=this,n={callback:e,args:null,isReady:!1};return this.imports.push(n),function(){n.args=Array.prototype.slice.call(arguments,0),n.isReady=!0,t.tryRun()}},r.prototype.addVariableImport=function(e){this.variableImports.push(e)},r.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var e=this.imports[0];if(!e.isReady)return;this.imports=this.imports.slice(1),e.callback.apply(null,e.args)}if(0===this.variableImports.length)break;var t=this.variableImports[0];this.variableImports=this.variableImports.slice(1),t()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},t.exports=r},{}],92:[function(e,t,n){var r=e("../contexts"),i=e("./visitor"),a=e("./import-sequencer"),s=e("../utils"),o=function(e,t){this._visitor=new i(this),this._importer=e,this._finish=t,this.context=new r.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new a(this._onSequencerEmpty.bind(this))};o.prototype={isReplacing:!1,run:function(e){try{this._visitor.visit(e)}catch(e){this.error=e}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(e,t){var n=e.options.inline;if(!e.css||n){var i=new r.Eval(this.context,s.copyArray(this.context.frames)),a=i.frames[0];this.importCount++,e.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,e,i,a)):this.processImportNode(e,i,a)}t.visitDeeper=!1},processImportNode:function(e,t,n){var r,i=e.options.inline;try{r=e.evalForImport(t)}catch(t){t.filename||(t.index=e.getIndex(),t.filename=e.fileInfo().filename),e.css=!0,e.error=t}if(!r||r.css&&!i)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{r.options.multiple&&(t.importMultiple=!0);for(var a=void 0===r.css,s=0;s<n.rules.length;s++)if(n.rules[s]===e){n.rules[s]=r;break}var o=this.onImported.bind(this,r,t),u=this._sequencer.addImport(o);this._importer.push(r.getPath(),a,r.fileInfo(),r.options,u)}},onImported:function(e,t,n,r,i,a){n&&(n.filename||(n.index=e.getIndex(),n.filename=e.fileInfo().filename),this.error=n);var s=this,o=e.options.inline,u=e.options.isPlugin,l=e.options.optional,c=i||a in s.recursionDetector;if(t.importMultiple||(e.skip=!!c||function(){return a in s.onceFileDetectionMap||(s.onceFileDetectionMap[a]=!0,!1)}),!a&&l&&(e.skip=!0),r&&(e.root=r,e.importedFilename=a,!o&&!u&&(t.importMultiple||!c))){s.recursionDetector[a]=!0;var d=this.context;this.context=t;try{this._visitor.visit(r)}catch(n){this.error=n}this.context=d}s.importCount--,s.isFinished&&s._sequencer.tryRun()},visitDeclaration:function(e,t){"DetachedRuleset"===e.value.type?this.context.frames.unshift(e):t.visitDeeper=!1},visitDeclarationOut:function(e){"DetachedRuleset"===e.value.type&&this.context.frames.shift()},visitAtRule:function(e,t){this.context.frames.unshift(e)},visitAtRuleOut:function(e){this.context.frames.shift()},visitMixinDefinition:function(e,t){this.context.frames.unshift(e)},visitMixinDefinitionOut:function(e){this.context.frames.shift()},visitRuleset:function(e,t){this.context.frames.unshift(e)},visitRulesetOut:function(e){this.context.frames.shift()},visitMedia:function(e,t){this.context.frames.unshift(e.rules[0])},visitMediaOut:function(e){this.context.frames.shift()}},t.exports=o},{"../contexts":13,"../utils":89,"./import-sequencer":91,"./visitor":97}],93:[function(e,t,n){var r={Visitor:e("./visitor"),ImportVisitor:e("./import-visitor"),MarkVisibleSelectorsVisitor:e("./set-tree-visibility-visitor"),ExtendVisitor:e("./extend-visitor"),JoinSelectorVisitor:e("./join-selector-visitor"),ToCSSVisitor:e("./to-css-visitor")};t.exports=r},{"./extend-visitor":90,"./import-visitor":92,"./join-selector-visitor":94,"./set-tree-visibility-visitor":95,"./to-css-visitor":96,"./visitor":97}],94:[function(e,t,n){var r=e("./visitor"),i=function(){this.contexts=[[]],this._visitor=new r(this)};i.prototype={run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){var n,r=this.contexts[this.contexts.length-1],i=[];this.contexts.push(i),e.root||((n=e.selectors)&&(n=n.filter(function(e){return e.getIsOutput()}),e.selectors=n.length?n:n=null,n&&e.joinSelectors(i,r,n)),n||(e.rules=null),e.paths=i)},visitRulesetOut:function(e){this.contexts.length=this.contexts.length-1},visitMedia:function(e,t){var n=this.contexts[this.contexts.length-1];e.rules[0].root=0===n.length||n[0].multiMedia},visitAtRule:function(e,t){var n=this.contexts[this.contexts.length-1];e.rules&&e.rules.length&&(e.rules[0].root=e.isRooted||0===n.length||null)}},t.exports=i},{"./visitor":97}],95:[function(e,t,n){var r=function(e){this.visible=e};r.prototype.run=function(e){this.visit(e)},r.prototype.visitArray=function(e){if(!e)return e;var t,n=e.length;for(t=0;t<n;t++)this.visit(e[t]);return e},r.prototype.visit=function(e){return e?e.constructor===Array?this.visitArray(e):!e.blocksVisibility||e.blocksVisibility()?e:(this.visible?e.ensureVisibility():e.ensureInvisibility(),e.accept(this),e):e},t.exports=r},{}],96:[function(e,t,n){var r=e("../tree"),i=e("./visitor"),a=function(e){this._visitor=new i(this),this._context=e};a.prototype={containsSilentNonBlockedChild:function(e){var t;if(!e)return!1;for(var n=0;n<e.length;n++)if((t=e[n]).isSilent&&t.isSilent(this._context)&&!t.blocksVisibility())return!0;return!1},keepOnlyVisibleChilds:function(e){e&&e.rules&&(e.rules=e.rules.filter(function(e){return e.isVisible()}))},isEmpty:function(e){return!e||!e.rules||0===e.rules.length},hasVisibleSelector:function(e){return!(!e||!e.paths)&&e.paths.length>0},resolveVisibility:function(e,t){if(!e.blocksVisibility()){if(this.isEmpty(e)&&!this.containsSilentNonBlockedChild(t))return;return e}var n=e.rules[0];if(this.keepOnlyVisibleChilds(n),!this.isEmpty(n))return e.ensureVisibility(),e.removeVisibilityBlock(),e},isVisibleRuleset:function(e){return!!e.firstRoot||!this.isEmpty(e)&&!(!e.root&&!this.hasVisibleSelector(e))}};var s=function(e){this._visitor=new i(this),this._context=e,this.utils=new a(e)};s.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){if(!e.blocksVisibility()&&!e.variable)return e},visitMixinDefinition:function(e,t){e.frames=[]},visitExtend:function(e,t){},visitComment:function(e,t){if(!e.blocksVisibility()&&!e.isSilent(this._context))return e},visitMedia:function(e,t){var n=e.rules[0].rules;return e.accept(this._visitor),t.visitDeeper=!1,this.utils.resolveVisibility(e,n)},visitImport:function(e,t){if(!e.blocksVisibility())return e},visitAtRule:function(e,t){return e.rules&&e.rules.length?this.visitAtRuleWithBody(e,t):this.visitAtRuleWithoutBody(e,t)},visitAnonymous:function(e,t){if(!e.blocksVisibility())return e.accept(this._visitor),e},visitAtRuleWithBody:function(e,t){var n=function(e){var t=e.rules;return function(e){var t=e.rules;return 1===t.length&&(!t[0].paths||0===t[0].paths.length)}(e)?t[0].rules:t}(e);return e.accept(this._visitor),t.visitDeeper=!1,this.utils.isEmpty(e)||this._mergeRules(e.rules[0].rules),this.utils.resolveVisibility(e,n)},visitAtRuleWithoutBody:function(e,t){if(!e.blocksVisibility()){if("@charset"===e.name){if(this.charset){if(e.debugInfo){var n=new r.Comment("/* "+e.toCSS(this._context).replace(/\n/g,"")+" */\n");return n.debugInfo=e.debugInfo,this._visitor.visit(n)}return}this.charset=!0}return e}},checkValidNodes:function(e,t){if(e)for(var n=0;n<e.length;n++){var i=e[n];if(t&&i instanceof r.Declaration&&!i.variable)throw{message:"Properties must be inside selector blocks. They cannot be in the root",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename};if(i instanceof r.Call)throw{message:"Function '"+i.name+"' is undefined",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename};if(i.type&&!i.allowRoot)throw{message:i.type+" node returned by a function is not valid here",index:i.getIndex(),filename:i.fileInfo()&&i.fileInfo().filename}}},visitRuleset:function(e,t){var n,r=[];if(this.checkValidNodes(e.rules,e.firstRoot),e.root)e.accept(this._visitor),t.visitDeeper=!1;else{this._compileRulesetPaths(e);for(var i=e.rules,a=i?i.length:0,s=0;s<a;)(n=i[s])&&n.rules?(r.push(this._visitor.visit(n)),i.splice(s,1),a--):s++;a>0?e.accept(this._visitor):e.rules=null,t.visitDeeper=!1}return e.rules&&(this._mergeRules(e.rules),this._removeDuplicateRules(e.rules)),this.utils.isVisibleRuleset(e)&&(e.ensureVisibility(),r.splice(0,0,e)),1===r.length?r[0]:r},_compileRulesetPaths:function(e){e.paths&&(e.paths=e.paths.filter(function(e){var t;for(" "===e[0].elements[0].combinator.value&&(e[0].elements[0].combinator=new r.Combinator("")),t=0;t<e.length;t++)if(e[t].isVisible()&&e[t].getIsOutput())return!0;return!1}))},_removeDuplicateRules:function(e){if(e){var t,n,i,a={};for(i=e.length-1;i>=0;i--)if((n=e[i])instanceof r.Declaration)if(a[n.name]){(t=a[n.name])instanceof r.Declaration&&(t=a[n.name]=[a[n.name].toCSS(this._context)]);var s=n.toCSS(this._context);-1!==t.indexOf(s)?e.splice(i,1):t.push(s)}else a[n.name]=n}},_mergeRules:function(e){if(e){for(var t={},n=[],i=0;i<e.length;i++){var a=e[i];if(a.merge){var s=a.name;t[s]?e.splice(i--,1):n.push(t[s]=[]),t[s].push(a)}}n.forEach(function(e){if(e.length>0){var t=e[0],n=[],i=[new r.Expression(n)];e.forEach(function(e){"+"===e.merge&&n.length>0&&i.push(new r.Expression(n=[])),n.push(e.value),t.important=t.important||e.important}),t.value=new r.Value(i)}})}}},t.exports=s},{"../tree":67,"./visitor":97}],97:[function(e,t,n){var r=e("../tree"),i={visitDeeper:!0},a=!1;function s(e){return e}var o=function(e){this._implementation=e,this._visitInCache={},this._visitOutCache={},a||(function e(t,n){var r,i;for(r in t)switch(typeof(i=t[r])){case"function":i.prototype&&i.prototype.type&&(i.prototype.typeIndex=n++);break;case"object":n=e(i,n)}return n}(r,1),a=!0)};o.prototype={visit:function(e){if(!e)return e;var t=e.typeIndex;if(!t)return e.value&&e.value.typeIndex&&this.visit(e.value),e;var n,r=this._implementation,a=this._visitInCache[t],o=this._visitOutCache[t],u=i;if(u.visitDeeper=!0,a||(n="visit"+e.type,a=r[n]||s,o=r[n+"Out"]||s,this._visitInCache[t]=a,this._visitOutCache[t]=o),a!==s){var l=a.call(r,e,u);e&&r.isReplacing&&(e=l)}return u.visitDeeper&&e&&e.accept&&e.accept(this),o!=s&&o.call(r,e),e},visitArray:function(e,t){if(!e)return e;var n,r=e.length;if(t||!this._implementation.isReplacing){for(n=0;n<r;n++)this.visit(e[n]);return e}var i=[];for(n=0;n<r;n++){var a=this.visit(e[n]);void 0!==a&&(a.splice?a.length&&this.flatten(a,i):i.push(a))}return i},flatten:function(e,t){var n,r,i,a,s,o;for(t||(t=[]),r=0,n=e.length;r<n;r++)if(void 0!==(i=e[r]))if(i.splice)for(s=0,a=i.length;s<a;s++)void 0!==(o=i[s])&&(o.splice?o.length&&this.flatten(o,t):t.push(o));else t.push(i);return t}},t.exports=o},{"../tree":67}],98:[function(e,t,n){"use strict";var r=e("./raw"),i=[],a=[],s=r.makeRequestCallFromTimer(function(){if(a.length)throw a.shift()});function o(e){var t;(t=i.length?i.pop():new u).task=e,r(t)}function u(){this.task=null}t.exports=o,u.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(a.push(e),s())}finally{this.task=null,i[i.length]=this}}},{"./raw":99}],99:[function(e,n,r){(function(e){"use strict";function t(e){i.length||r(),i[i.length]=e}n.exports=t;var r,i=[],a=0,s=1024;function o(){for(;a<i.length;){var e=a;if(a+=1,i[e].call(),a>s){for(var t=0,n=i.length-a;t<n;t++)i[t]=i[t+a];i.length-=a,a=0}}i.length=0,a=0}var u,l,c,d=void 0!==e?e:self,h=d.MutationObserver||d.WebKitMutationObserver;function f(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof h?(u=1,l=new h(o),c=document.createTextNode(""),l.observe(c,{characterData:!0}),r=function(){u=-u,c.data=u}):r=f(o),t.requestFlush=r,t.makeRequestCallFromTimer=f}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],100:[function(e,t,r){var i=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,r,i;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{i=Promise}catch(e){i=function(){}}function a(s,u,l,c,d){"object"==typeof u&&(l=u.depth,c=u.prototype,d=u.includeNonEnumerable,u=u.circular);var h=[],f=[],p=void 0!==n;return void 0===u&&(u=!0),void 0===l&&(l=1/0),function s(l,m){if(null===l)return null;if(0===m)return l;var v,y;if("object"!=typeof l)return l;if(e(l,t))v=new t;else if(e(l,r))v=new r;else if(e(l,i))v=new i(function(e,t){l.then(function(t){e(s(t,m-1))},function(e){t(s(e,m-1))})});else if(a.__isArray(l))v=[];else if(a.__isRegExp(l))v=new RegExp(l.source,o(l)),l.lastIndex&&(v.lastIndex=l.lastIndex);else if(a.__isDate(l))v=new Date(l.getTime());else{if(p&&n.isBuffer(l))return v=n.allocUnsafe?n.allocUnsafe(l.length):new n(l.length),l.copy(v),v;e(l,Error)?v=Object.create(l):void 0===c?(y=Object.getPrototypeOf(l),v=Object.create(y)):(v=Object.create(c),y=c)}if(u){var g=h.indexOf(l);if(-1!=g)return f[g];h.push(l),f.push(v)}for(var _ in e(l,t)&&l.forEach(function(e,t){var n=s(t,m-1),r=s(e,m-1);v.set(n,r)}),e(l,r)&&l.forEach(function(e){var t=s(e,m-1);v.add(t)}),l){var b;y&&(b=Object.getOwnPropertyDescriptor(y,_)),b&&null==b.set||(v[_]=s(l[_],m-1))}if(Object.getOwnPropertySymbols)for(var w=Object.getOwnPropertySymbols(l),_=0;_<w.length;_++){var E=w[_],S=Object.getOwnPropertyDescriptor(l,E);(!S||S.enumerable||d)&&(v[E]=s(l[E],m-1),S.enumerable||Object.defineProperty(v,E,{enumerable:!1}))}if(d)for(var T=Object.getOwnPropertyNames(l),_=0;_<T.length;_++){var k=T[_],S=Object.getOwnPropertyDescriptor(l,k);S&&S.enumerable||(v[k]=s(l[k],m-1),Object.defineProperty(v,k,{enumerable:!1}))}return v}(s,l)}function s(e){return Object.prototype.toString.call(e)}function o(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=s,a.__isDate=function(e){return"object"==typeof e&&"[object Date]"===s(e)},a.__isArray=function(e){return"object"==typeof e&&"[object Array]"===s(e)},a.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===s(e)},a.__getRegExpFlags=o,a}();"object"==typeof t&&t.exports&&(t.exports=i)},{}],101:[function(e,t,n){"use strict";var r=e("asap/raw");function i(){}var a=null,s={};function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._40=0,this._65=0,this._55=null,this._72=null,e!==i&&f(e,this)}function u(e,t){for(;3===e._65;)e=e._55;if(o._37&&o._37(e),0===e._65)return 0===e._40?(e._40=1,void(e._72=t)):1===e._40?(e._40=2,void(e._72=[e._72,t])):void e._72.push(t);!function(e,t){r(function(){var n=1===e._65?t.onFulfilled:t.onRejected;if(null!==n){var r=function(e,t){try{return e(t)}catch(e){return a=e,s}}(n,e._55);r===s?c(t.promise,a):l(t.promise,r)}else 1===e._65?l(t.promise,e._55):c(t.promise,e._55)})}(e,t)}function l(e,t){if(t===e)return c(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=function(e){try{return e.then}catch(e){return a=e,s}}(t);if(n===s)return c(e,a);if(n===e.then&&t instanceof o)return e._65=3,e._55=t,void d(e);if("function"==typeof n)return void f(n.bind(t),e)}e._65=1,e._55=t,d(e)}function c(e,t){e._65=2,e._55=t,o._87&&o._87(e,t),d(e)}function d(e){if(1===e._40&&(u(e,e._72),e._72=null),2===e._40){for(var t=0;t<e._72.length;t++)u(e,e._72[t]);e._72=null}}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1,r=function(e,t,n){try{e(t,n)}catch(e){return a=e,s}}(e,function(e){n||(n=!0,l(t,e))},function(e){n||(n=!0,c(t,e))});n||r!==s||(n=!0,c(t,a))}t.exports=o,o._37=null,o._87=null,o._61=i,o.prototype.then=function(e,t){if(this.constructor!==o)return function(e,t,n){return new e.constructor(function(r,a){var s=new o(i);s.then(r,a),u(e,new h(t,n,s))})}(this,e,t);var n=new o(i);return u(this,new h(e,t,n)),n}},{"asap/raw":99}],102:[function(e,t,n){"use strict";var r=e("./core.js");t.exports=r;var i=c(!0),a=c(!1),s=c(null),o=c(void 0),u=c(0),l=c("");function c(e){var t=new r(r._61);return t._65=1,t._55=e,t}r.resolve=function(e){if(e instanceof r)return e;if(null===e)return s;if(void 0===e)return o;if(!0===e)return i;if(!1===e)return a;if(0===e)return u;if(""===e)return l;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new r(t.bind(e))}catch(e){return new r(function(t,n){n(e)})}return c(e)},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);var i=t.length;function a(s,o){if(o&&("object"==typeof o||"function"==typeof o)){if(o instanceof r&&o.then===r.prototype.then){for(;3===o._65;)o=o._55;return 1===o._65?a(s,o._55):(2===o._65&&n(o._55),void o.then(function(e){a(s,e)},n))}var u=o.then;if("function"==typeof u){var l=new r(u.bind(o));return void l.then(function(e){a(s,e)},n)}}t[s]=o,0==--i&&e(t)}for(var s=0;s<t.length;s++)a(s,t[s])})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){e.forEach(function(e){r.resolve(e).then(t,n)})})},r.prototype.catch=function(e){return this.then(null,e)}},{"./core.js":101}],103:[function(e,t,n){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(e,t){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(e){setTimeout(function(){throw e},0)})})},{}],104:[function(e,t,n){e("asap"),"undefined"==typeof Promise&&(Promise=e("./lib/core.js"),e("./lib/es6-extensions.js")),e("./polyfill-done.js")},{"./lib/core.js":101,"./lib/es6-extensions.js":102,"./polyfill-done.js":103,asap:98}]},{},[2])(2)}).call(this,n(4),n(17).Buffer)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(18),i=n(19),a=n(20);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=o(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|f(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?o(e,0):h(e,t);if("Buffer"===t.type&&a(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=o(e,t<0?0:0|f(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(r)return V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a,s=1,o=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,u/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(a=n;a<o;a++)if(l(e,a)===l(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(n+u>o&&(n=o-u),a=n;a>=0;a--){for(var d=!0,h=0;h<u;h++)if(l(e,a+h)!==l(t,h)){d=!1;break}if(d)return a}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[n+s]=o}return s}function _(e,t,n,r){return H(V(t,e.length-n),e,n,r)}function b(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return b(e,t,n,r)}function E(e,t,n,r){return H(j(t),e,n,r)}function S(e,t,n,r){return H(function(e,t){for(var n,r,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,s,o,u,l=e[i],c=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(c=l);break;case 2:128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=e[i+1],s=e[i+2],128==(192&a)&&128==(192&s)&&(u=(15&l)<<12|(63&a)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=e[i+1],s=e[i+2],o=e[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(u=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&u<1114112&&(c=u)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),o=Math.min(a,s),l=this.slice(r,i),c=e.slice(t,n),d=0;d<o;++d)if(l[d]!==c[d]){a=l[d],s=c[d];break}return a<s?-1:s<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function L(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function P(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,a){return a||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,a){return a||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<n&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=u.isBuffer(e)?e:V(new u(e,r).toString()),o=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function j(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(4))},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],s=n[1],o=new a(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),u=0,c=s>0?r-4:r,d=0;d<c;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],o[u++]=t>>16&255,o[u++]=t>>8&255,o[u++]=255&t;2===s&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,o[u++]=255&t);1===s&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,o[u++]=t>>8&255,o[u++]=255&t);return o},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=0,o=n-i;s<o;s+=16383)a.push(c(e,s,s+16383>o?o:s+16383));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=s.length;o<u;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,s,o=8*i-r-1,u=(1<<o)-1,l=u>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+d],d+=h,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=r;c>0;s=256*s+e[t+d],d+=h,c-=8);if(0===a)a=1-l;else{if(a===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=l}return(f?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var s,o,u,l=8*a-i-1,c=(1<<l)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+d>=1?h/u:h*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(t*u-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&o,f+=p,o/=256,i-=8);for(s=s<<i|o,l+=i;l>0;e[n+f]=255&s,f+=p,s/=256,l-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};var i=window.shaka;window.goog=window.goog||{};var a,s=window.goog;(i.log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"alwaysError",value:function(){}},{key:"alwaysWarn",value:function(){}},{key:"error",value:function(){}},{key:"warning",value:function(){}},{key:"info",value:function(){}},{key:"debug",value:function(){}},{key:"v1",value:function(){}},{key:"v2",value:function(){}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}(),i.log.Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,V1:5,V2:6},i.log.MAX_LOG_LEVEL=3,window.console)&&(i.log.logMap_=(n(a={},i.log.Level.ERROR,function(){var e;return(e=console).error.apply(e,arguments)}),n(a,i.log.Level.WARNING,function(){var e;return(e=console).warn.apply(e,arguments)}),n(a,i.log.Level.INFO,function(){var e;return(e=console).info.apply(e,arguments)}),n(a,i.log.Level.DEBUG,function(){var e;return(e=console).log.apply(e,arguments)}),n(a,i.log.Level.V1,function(){var e;return(e=console).debug.apply(e,arguments)}),n(a,i.log.Level.V2,function(){var e;return(e=console).debug.apply(e,arguments)}),a),i.log.alwaysWarn=i.log.logMap_[i.log.Level.WARNING],i.log.alwaysError=i.log.logMap_[i.log.Level.ERROR],s.DEBUG?(i.log.currentLevel,i.log.setLevel=function(e){var t=function(t){return t<=e?(window.asserts.assert(i.log.logMap_[t],"Unexpected log level"),i.log.logMap_[t]):function(){}};i.log.currentLevel=e,i.log.error=t(i.log.Level.ERROR),i.log.warning=t(i.log.Level.WARNING),i.log.info=t(i.log.Level.INFO),i.log.debug=t(i.log.Level.DEBUG),i.log.v1=t(i.log.Level.V1),i.log.v2=t(i.log.Level.V2)},i.log.setLevel(i.log.MAX_LOG_LEVEL)):(i.log.MAX_LOG_LEVEL>=i.log.Level.ERROR&&(i.log.error=i.log.logMap_[i.log.Level.ERROR]),i.log.MAX_LOG_LEVEL>=i.log.Level.WARNING&&(i.log.warning=i.log.logMap_[i.log.Level.WARNING]),i.log.MAX_LOG_LEVEL>=i.log.Level.INFO&&(i.log.info=i.log.logMap_[i.log.Level.INFO]),i.log.MAX_LOG_LEVEL>=i.log.Level.DEBUG&&(i.log.debug=i.log.logMap_[i.log.Level.DEBUG]),i.log.MAX_LOG_LEVEL>=i.log.Level.V1&&(i.log.v1=i.log.logMap_[i.log.Level.V1]),i.log.MAX_LOG_LEVEL>=i.log.Level.V2&&(i.log.v2=i.log.logMap_[i.log.Level.V2])))},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=(n(8),n(9),n(10),n(11),n(5)),s=n.n(a),o=(n(12),n(13),n(15),n(16),{UNKNOWN:"Unknown",CUSTOM:"Custom",SHAKA:"Shaka",AXINOM:"Axinom",UNIFIED_STREAMING:"Unified Streaming",DASH_IF:"DASH-IF",WOWZA:"Wowza",BITCODIN:"Bitcodin",NIMBLE_STREAMER:"Nimble Streamer",AZURE_MEDIA_SERVICES:"Azure Media Services",GPAC:"GPAC",UPLYNK:"Verizon Digital Media Services"}),u={CLEAR_KEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps.1_0",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha",CLEAR:"no drm protection"},l={MULTIKEY:"multiple keys",MULTIPERIOD:"multiple Periods",ENCRYPTED_WITH_CLEAR:"mixing encrypted and unencrypted periods",AESCTR_16_BYTE_IV:"encrypted with AES CTR Mode using a 16 byte IV",AESCTR_8_BYTE_IV:"encrypted with AES CTR Mode using a 8 byte IV",TRICK_MODE:"Special trick mode track",XLINK:"XLink",SUBTITLES:"Subtitles",CAPTIONS:"Captions",EMBEDDED_TEXT:"embedded text",MULTIPLE_LANGUAGES:"multiple languages",AUDIO_ONLY:"audio only",OFFLINE:"Downloadable",STORED:"Downloaded",LIVE:"Live",WEBM:"WebM",MP4:"MP4",MP2TS:"MPEG-2 TS",TTML:"TTML",WEBVTT:"WebVTT",HIGH_DEFINITION:"High definition",ULTRA_HIGH_DEFINITION:"Ultra-high definition",SURROUND:"Surround sound",DASH:"DASH",HLS:"HLS"},c=n(0);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var f=c.net.NetworkingEngine;window.shaka=window.shaka||{};window.shaka;var p=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.shortName="",this.iconUri=n,this.manifestUri=r,this.source=i,this.focus=!1,this.disabled=!1,this.extraText=[],this.certificateUri=null,this.description="",this.isFeatured=!1,this.drm=[u.CLEAR],this.features=[],this.licenseServers=new Map,this.licenseRequestHeaders=new Map,this.requestFilter=null,this.responseFilter=null,this.drmCallback=null,this.clearKeys=new Map,this.extraConfig=null,this.storeCallback=null,this.unstoreCallback=null,this.storedContent=null,this.storedProgress=1}var t,n,r;return t=e,r=[{key:"caseLessAlphaComparator_",value:function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}},{key:"makeBlankAsset",value:function(){return new e("","","",o.CUSTOM)}},{key:"fromJSON",value:function(t){var n={};for(var r in t){var i=t[r];if(i&&"object"==d(i)&&"map"===i.__type__){var a=new Map;for(var s in i)"__type__"!==s&&a.set(s,i[s]);n[r]=a}else n[r]=i}var o=e.makeBlankAsset();return Object.assign(o,n),o}}],(n=[{key:"addDescription",value:function(e){return this.description=e,this}},{key:"addCertificateUri",value:function(e){return this.certificateUri=e,this}},{key:"addFeature",value:function(t){return this.features.push(t),this.features.sort(e.caseLessAlphaComparator_),this}},{key:"addKeySystem",value:function(t){return 1===this.drm.length&&this.drm[0]===u.CLEAR&&(this.drm=[]),this.drm.push(t),this.drm.sort(e.caseLessAlphaComparator_),this}},{key:"setExtraConfig",value:function(e){return this.extraConfig=e,this}},{key:"setRequestFilter",value:function(e){return this.requestFilter=e,this}},{key:"setResponseFilter",value:function(e){return this.responseFilter=e,this}},{key:"addLicenseServer",value:function(e,t){return this.licenseServers.set(e,t),this}},{key:"addLicenseRequestHeader",value:function(e,t){return this.licenseRequestHeaders.set(e,t),this}},{key:"addExtraText",value:function(e){return this.extraText.push(e),this}},{key:"markAsFocused",value:function(){return this.focus=!0,this}},{key:"markAsFeatured",value:function(e){return this.isFeatured=!0,this.shortName=e||this.shortName,this}},{key:"markAsDisabled",value:function(){return this.disabled=!0,this}},{key:"toJSON",value:function(){var e={};for(var t in this){var n=this[t];if(n instanceof Map){var r={__type__:"map"},i=!0,a=!1,s=void 0;try{for(var o,u=n.entries()[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;r[l[0]]=l[1]}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}e[t]=r}else e[t]=n}return e}},{key:"applyFilters",value:function(e){var t=this;if(e.clearAllRequestFilters(),e.clearAllResponseFilters(),this.licenseRequestHeaders.size){e.registerRequestFilter(function(e,n){return t.addLicenseRequestHeaders_(t.licenseRequestHeaders,e,n)})}this.requestFilter&&e.registerRequestFilter(this.requestFilter),this.responseFilter&&e.registerResponseFilter(this.responseFilter)}},{key:"getConfiguration",value:function(){var e={drm:{},manifest:{dash:{}}};if(this.licenseServers.size&&(e.drm.servers={},this.licenseServers.forEach(function(t,n){e.drm.servers[n]=t})),this.drmCallback&&(e.manifest.dash.customScheme=this.drmCallback),this.clearKeys.size&&(e.drm.clearKeys={},this.clearKeys.forEach(function(t,n){e.drm.clearKeys[n]=t})),this.extraConfig)for(var t in this.extraConfig)e[t]=this.extraConfig[t];return e}},{key:"addLicenseRequestHeaders_",value:function(e,t,n){t===f.RequestType.LICENSE&&e.forEach(function(e,t){n.headers[t]=e})}},{key:"isStored",value:function(){return null!=this.storedContent}}])&&h(t.prototype,n),r&&h(t,r),e}(),m=c.net.NetworkingEngine;window.shaka=window.shaka||{};var v=window.shaka,y={};y.Source=o,y.Feature=l,y.KeySystem=u,y.ExtraText={},y.lastUplynkPrefix="",y.UplynkResponseFilter=function(e,t){e===m.RequestType.MANIFEST&&(t.headers["x-uplynk-prefix"]?y.lastUplynkPrefix=t.headers["x-uplynk-prefix"]:y.lastUplynkPrefix="")},y.UplynkRequestFilter=function(e,t){e===v.net.NetworkingEngine.RequestType.LICENSE&&(t.uris[0].includes("wv")&&y.lastUplynkPrefix?t.uris[0]=y.lastUplynkPrefix.concat("/wv"):t.uris[0].includes("ck")&&y.lastUplynkPrefix?t.uris[0]=y.lastUplynkPrefix.concat("/ck"):t.uris[0].includes("pr")&&y.lastUplynkPrefix&&(t.uris[0]=y.lastUplynkPrefix.concat("/pr")))},y.testAssets=[new p("Big Buck Bunny: the Dark Truths of a Video Dev Cartoon (DASH)","https://storage.googleapis.com/shaka-asset-icons/dark_truth.png","https://storage.googleapis.com/shaka-demo-assets/bbb-dark-truths/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.WEBM).addFeature(l.OFFLINE),new p("Big Buck Bunny: the Dark Truths of a Video Dev Cartoon (HLS)","https://storage.googleapis.com/shaka-asset-icons/dark_truth.png","https://storage.googleapis.com/shaka-demo-assets/bbb-dark-truths-hls/hls.m3u8",o.SHAKA).addDescription("A serious documentary about a problem plaguing video developers.").markAsFeatured("Big Buck Bunny: the Dark Truths").addFeature(l.HLS).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.OFFLINE),new p("Angel One (multicodec, multilingual)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd",o.SHAKA).addDescription("A clip from a classic Star Trek TNG episode, presented in MPEG-DASH.").markAsFeatured("Angel One").addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Angel One (multicodec, multilingual, Widevine)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine/dash.mpd",o.SHAKA).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.MULTIKEY).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new p("Angel One (multicodec, multilingual, ClearKey server)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-clearkey/dash.mpd",o.SHAKA).addKeySystem(u.CLEAR_KEY).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE).addLicenseServer("org.w3.clearkey","https://cwip-shaka-proxy.appspot.com/clearkey?_u3wDe7erb7v8Lqt8A3QDQ=ABEiM0RVZneImaq7zN3u_w"),new p("Angel One (HLS, MP4, multilingual)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-hls/hls.m3u8",o.SHAKA).addFeature(l.HLS).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.SURROUND).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Angel One (HLS, MP4, multilingual, Widevine)","https://storage.googleapis.com/shaka-asset-icons/angel_one.png","https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine-hls/hls.m3u8",o.SHAKA).addKeySystem(u.WIDEVINE).addFeature(l.HLS).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.SURROUND).addFeature(l.MULTIKEY).addFeature(l.WEBVTT).addFeature(l.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new p("Sintel 4k (multicodec)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Sintel w/ trick mode (MP4 only, 720p)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-trickplay/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.TRICK_MODE).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Sintel 4k (WebM only)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-webm-only/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Sintel 4k (MP4 only)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-mp4-only/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Sintel 4k (multicodec, Widevine)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-widevine/dash.mpd",o.SHAKA).addDescription("A Blender Foundation short film, protected by Widevine encryption.").markAsFeatured("Sintel").addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIKEY).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBM).addFeature(l.WEBVTT).addFeature(l.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new p("Sintel 4k (multicodec, VTT in MP4)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-mp4-wvtt/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Sintel w/ 44 subtitle languages","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://storage.googleapis.com/shaka-demo-assets/sintel-many-subs/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.SURROUND).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Heliocentrism (multicodec, multiperiod)","https://storage.googleapis.com/shaka-asset-icons/heliocentricism.png","https://storage.googleapis.com/shaka-demo-assets/heliocentrism/heliocentrism.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPERIOD).addFeature(l.WEBM).addFeature(l.OFFLINE),new p("Heliocentrism (multicodec, multiperiod, xlink)","https://storage.googleapis.com/shaka-asset-icons/heliocentricism.png","https://storage.googleapis.com/shaka-demo-assets/heliocentrism-xlink/heliocentrism.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPERIOD).addFeature(l.WEBM).addFeature(l.XLINK).addFeature(l.OFFLINE),new p('"Dig the Uke" by Stefan Kartenberg (audio only, multicodec)',"https://storage.googleapis.com/shaka-asset-icons/audio_only.png","https://storage.googleapis.com/shaka-demo-assets/dig-the-uke-clear/dash.mpd",o.SHAKA).addDescription("An audio-only presentation performed by Stefan Kartenberg.").markAsFeatured("Dig the Uke").addFeature(l.DASH).addFeature(l.MP4).addFeature(l.AUDIO_ONLY).addFeature(l.WEBM).addFeature(l.OFFLINE),new p('"Dig the Uke" by Stefan Kartenberg (audio only, multicodec, Widevine)',"https://storage.googleapis.com/shaka-asset-icons/audio_only.png","https://storage.googleapis.com/shaka-demo-assets/dig-the-uke/dash.mpd",o.SHAKA).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.AUDIO_ONLY).addFeature(l.WEBM).addFeature(l.OFFLINE).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new p("Tears of Steel (multicodec, TTML)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://storage.googleapis.com/shaka-demo-assets/tos-ttml/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.TTML).addFeature(l.WEBM).addFeature(l.OFFLINE),new p("Tears of Steel (multicodec, surround + stereo)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://storage.googleapis.com/shaka-demo-assets/tos-surround/dash.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.SURROUND).addFeature(l.WEBM).addFeature(l.OFFLINE),new p("Shaka Player History (multicodec, live, DASH)","https://storage.googleapis.com/shaka-asset-icons/shaka.png","https://storage.googleapis.com/shaka-live-assets/player-source.mpd",o.SHAKA).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.LIVE).addFeature(l.MP4).addFeature(l.WEBM),new p("Shaka Player History (live, HLS)","https://storage.googleapis.com/shaka-asset-icons/shaka.png","https://storage.googleapis.com/shaka-live-assets/player-source.m3u8",o.SHAKA).addDescription("A self-indulgent HLS livestream.").markAsFeatured("Shaka Player History").addFeature(l.HIGH_DEFINITION).addFeature(l.HLS).addFeature(l.LIVE).addFeature(l.MP4),new p("Multi-DRM","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-SingleKey/Manifest.mpd",o.AXINOM).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.TTML).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiOWViNDA1MGQtZTQ0Yi00ODAyLTkzMmUtMjdkNzUwODNlMjY2IiwiZW5jcnlwdGVkX2tleSI6ImxLM09qSExZVzI0Y3Iya3RSNzRmbnc9PSJ9XX19.4lWwW46k-oWcah8oN18LPj5OLS5ZU-_AQv7fe0JhNjA"),new p("Multi-DRM, multi-key","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-MultiKey/Manifest.mpd",o.AXINOM).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.MULTIKEY).addFeature(l.SUBTITLES).addFeature(l.TTML).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiODAzOTliZjUtOGEyMS00MDE0LTgwNTMtZTI3ZTc0OGU5OGMwIiwiZW5jcnlwdGVkX2tleSI6ImxpTkpxVmFZa05oK01LY3hKRms3SWc9PSJ9LHsiaWQiOiI5MDk1M2UwOS02Y2IyLTQ5YTMtYTI2MC03YTVmZWZlYWQ0OTkiLCJlbmNyeXB0ZWRfa2V5Ijoia1l0SEh2cnJmQ01lVmRKNkxrYmtuZz09In0seyJpZCI6IjBlNGRhOTJiLWQwZTgtNGE2Ni04YzNmLWMyNWE5N2ViNjUzMiIsImVuY3J5cHRlZF9rZXkiOiI3dzdOWkhITE1nSjRtUUtFSzVMVE1RPT0ifSx7ImlkIjoiNTg1ZjIzM2YtMzA3Mi00NmYxLTlmYTQtNmRjMjJjNjZhMDE0IiwiZW5jcnlwdGVkX2tleSI6IkFjNFVVbVl0Qko1blBROU4xNXJjM2c9PSJ9LHsiaWQiOiI0MjIyYmQ3OC1iYzQ1LTQxYmYtYjYzZS02ZjgxNGRjMzkxZGYiLCJlbmNyeXB0ZWRfa2V5IjoiTzZGTzBmcVNXb3BwN2JqYy9ENGxNQT09In1dfX0.uF6YlKAREOmbniAeYiH070HSJhV0YS7zSKjlCtiDR5Y"),new p("Multi-DRM, multi-key, multi-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-MultiDRM-MultiKey-MultiPeriod/Manifest.mpd",o.AXINOM).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.SUBTITLES).addFeature(l.MULTIKEY).addFeature(l.MULTIPERIOD).addFeature(l.TTML).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addLicenseServer("com.widevine.alpha","https://drm-widevine-licensing.axtest.net/AcquireLicense").addLicenseServer("com.microsoft.playready","https://drm-playready-licensing.axtest.net/AcquireLicense").addLicenseRequestHeader("X-AxDRM-Message","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2ZXJzaW9uIjoxLCJjb21fa2V5X2lkIjoiYjMzNjRlYjUtNTFmNi00YWUzLThjOTgtMzNjZWQ1ZTMxYzc4IiwibWVzc2FnZSI6eyJ0eXBlIjoiZW50aXRsZW1lbnRfbWVzc2FnZSIsImtleXMiOlt7ImlkIjoiMDg3Mjc4NmUtZjllNy00NjVmLWEzYTItNGU1YjBlZjhmYTQ1IiwiZW5jcnlwdGVkX2tleSI6IlB3NitlRVlOY3ZqWWJmc2gzWDNmbWc9PSJ9LHsiaWQiOiJjMTRmMDcwOS1mMmI5LTQ0MjctOTE2Yi02MWI1MjU4NjUwNmEiLCJlbmNyeXB0ZWRfa2V5IjoiLzErZk5paDM4bXFSdjR5Y1l6bnQvdz09In0seyJpZCI6IjhiMDI5ZTUxLWQ1NmEtNDRiZC05MTBmLWQ0YjVmZDkwZmJhMiIsImVuY3J5cHRlZF9rZXkiOiJrcTBKdVpFanBGTjhzYVRtdDU2ME9nPT0ifSx7ImlkIjoiMmQ2ZTkzODctNjBjYS00MTQ1LWFlYzItYzQwODM3YjRiMDI2IiwiZW5jcnlwdGVkX2tleSI6IlRjUlFlQld4RW9IT0tIcmFkNFNlVlE9PSJ9LHsiaWQiOiJkZTAyZjA3Zi1hMDk4LTRlZTAtYjU1Ni05MDdjMGQxN2ZiYmMiLCJlbmNyeXB0ZWRfa2V5IjoicG9lbmNTN0dnbWVHRmVvSjZQRUFUUT09In0seyJpZCI6IjkxNGU2OWY0LTBhYjMtNDUzNC05ZTlmLTk4NTM2MTVlMjZmNiIsImVuY3J5cHRlZF9rZXkiOiJlaUkvTXNsbHJRNHdDbFJUL0xObUNBPT0ifSx7ImlkIjoiZGE0NDQ1YzItZGI1ZS00OGVmLWIwOTYtM2VmMzQ3YjE2YzdmIiwiZW5jcnlwdGVkX2tleSI6IjJ3K3pkdnFycERWM3hSMGJKeTR1Z3c9PSJ9LHsiaWQiOiIyOWYwNWU4Zi1hMWFlLTQ2ZTQtODBlOS0yMmRjZDQ0Y2Q3YTEiLCJlbmNyeXB0ZWRfa2V5IjoiL3hsU0hweHdxdTNnby9nbHBtU2dhUT09In0seyJpZCI6IjY5ZmU3MDc3LWRhZGQtNGI1NS05NmNkLWMzZWRiMzk5MTg1MyIsImVuY3J5cHRlZF9rZXkiOiJ6dTZpdXpOMnBzaTBaU3hRaUFUa1JRPT0ifV19fQ.BXr93Et1krYMVs-CUnf7F3ywJWFRtxYdkR7Qn4w3-to"),new p("Clear, single-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-Clear/Manifest.mpd",o.AXINOM).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.TTML).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Clear, multi-Period","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://media.axprod.net/TestVectors/v7-Clear/Manifest_MultiPeriod.mpd",o.AXINOM).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.MULTIPERIOD).addFeature(l.TTML).addFeature(l.SUBTITLES).addFeature(l.ULTRA_HIGH_DEFINITION).addFeature(l.WEBVTT).addFeature(l.OFFLINE),new p("Clear, Live DASH","https://storage.googleapis.com/shaka-asset-icons/axinom_test.png","https://akamai-axtest.akamaized.net/routes/lapd-v1-acceptance/www_c4/Manifest.mpd",o.AXINOM).addFeature(l.LIVE).addFeature(l.MP4).addFeature(l.DASH).addFeature(l.MULTIPERIOD).addFeature(l.HIGH_DEFINITION).addFeature(l.WEBVTT),new p("Clear, Live HLS","https://storage.googleapis.com/shaka-asset-icons/axinom_test.png","https://akamai-axtest.akamaized.net/routes/lapd-v1-acceptance/www_c4/Manifest.m3u8",o.AXINOM).addFeature(l.HLS).addFeature(l.LIVE).addFeature(l.MP4).addFeature(l.HIGH_DEFINITION),new p("Tears of Steel","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel.ism/.mpd",o.UNIFIED_STREAMING).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.OFFLINE),new p("Tears of Steel (Widevine)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-dash-widevine.ism/.mpd",o.UNIFIED_STREAMING).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.TTML).addLicenseServer("com.widevine.alpha","https://cwip-shaka-proxy.appspot.com/no_auth"),new p("Tears of Steel (PlayReady)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-dash-playready.ism/.mpd",o.UNIFIED_STREAMING).addKeySystem(u.PLAYREADY).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.TTML).addLicenseServer("com.microsoft.playready","https://test.playready.microsoft.com/service/rightsmanager.asmx?PlayRight=1&UseSimpleNonPersistentLicense=1"),new p("Tears of Steel (subtitles)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel-en.ism/.mpd",o.UNIFIED_STREAMING).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.TTML).addFeature(l.OFFLINE),new p("Big Buck Bunny (DASH-IF)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://dash.akamaized.net/dash264/TestCases/1c/qualcomm/2/MultiRate.mpd",o.DASH_IF).addFeature(l.MP4).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.OFFLINE),new p("Live sim (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/utc_head/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(l.LIVE).addFeature(l.MP4).addFeature(l.DASH),new p("Live sim SegmentTimeline w $Time$ (6s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimeline_1/utc_head/testpic_6s/Manifest.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.LIVE).addFeature(l.MP4),new p("Live sim SegmentTimeline w $Number$ (6s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimelinenr_1/utc_head/testpic_6s/Manifest.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.LIVE).addFeature(l.MP4),new p("Live sim SegmentTimeline StartOver [-20s, +20s] (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/segtimeline_1/startrel_-20/stoprel_20/timeoffset_0/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.MP4),new p("Live sim StartOver SegTmpl Duration [-20s, +20s] (2s segments)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/startrel_-20/stoprel_20/timeoffset_0/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.MP4),new p("Live sim SegTmpl Duration (multi-period 60s)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/livesim/utc_head/periods_60/testpic_2s/Manifest.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.LIVE).addFeature(l.MP4).addFeature(l.MULTIPERIOD),new p("Live sim TTML Image Subtitles embedded (VoD)","https://storage.googleapis.com/shaka-asset-icons/dash_if_test_pattern.png","https://livesim.dashif.org/dash/vod/testpic_2s/img_subs.mpd",o.DASH_IF).addFeature(l.DASH).addFeature(l.SUBTITLES).addFeature(l.MP4).addFeature(l.TTML),new p("Big Buck Bunny (Live)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://wowzaec2demo.streamlock.net/live/bigbuckbunny/manifest_mpm4sav_mvtime.mpd",o.WOWZA).addFeature(l.DASH).addFeature(l.LIVE).addFeature(l.MP4),new p("Art of Motion (DASH)","https://storage.googleapis.com/shaka-asset-icons/art_of_motion.png","https://bitdash-a.akamaihd.net/content/MI201109210084_1/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd",o.BITCODIN).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.OFFLINE),new p("Art of Motion (HLS, TS)","https://storage.googleapis.com/shaka-asset-icons/art_of_motion.png","https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8",o.BITCODIN).markAsDisabled().addFeature(l.HIGH_DEFINITION).addFeature(l.HLS).addFeature(l.MP2TS).addFeature(l.OFFLINE),new p("Sintel (HLS, TS, 4k)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",o.BITCODIN).markAsDisabled().addFeature(l.HIGH_DEFINITION).addFeature(l.HLS).addFeature(l.MP2TS).addFeature(l.OFFLINE),new p("Big Buck Bunny (Nimble)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://video.wmspanel.com/local/raw/BigBuckBunny_320x180.mp4/manifest.mpd",o.NIMBLE_STREAMER).markAsDisabled().addFeature(l.DASH).addFeature(l.MP4).addFeature(l.HIGH_DEFINITION),new p("Azure Trailer","https://storage.googleapis.com/shaka-asset-icons/azure.png","https://amssamples.streaming.mediaservices.windows.net/91492735-c523-432b-ba01-faba6c2206a2/AzureMediaServicesPromo.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.HIGH_DEFINITION).addFeature(l.OFFLINE),new p("Big Buck Bunny (Azure)","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://amssamples.streaming.mediaservices.windows.net/622b189f-ec39-43f2-93a2-201ac4e31ce1/BigBuckBunny.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.HIGH_DEFINITION).addFeature(l.MP4).addFeature(l.OFFLINE).addLicenseServer("com.widevine.alpha","https://amssamples.keydelivery.mediaservices.windows.net/Widevine/?KID=1ab45440-532c-4399-94dc-5c5ad9584bac").addLicenseServer("com.microsoft.playready","https://amssamples.keydelivery.mediaservices.windows.net/PlayReady/"),new p("Tears of Steel (external text)","https://storage.googleapis.com/shaka-asset-icons/tears_of_steel.png","https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TearsOfSteel_WAMEH264SmoothStreaming720p.ism/manifest(format=mpd-time-csf)",o.AZURE_MEDIA_SERVICES).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.WEBVTT).addFeature(l.OFFLINE).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-en.vtt",language:"en",kind:"subtitle",mime:"text/vtt"}).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-es.vtt",language:"es",kind:"subtitle",mime:"text/vtt"}).addExtraText({uri:"https://ams-samplescdn.streaming.mediaservices.windows.net/11196e3d-2f40-4835-9a4d-fc52751b0323/TOS-fr.vtt",language:"fr",kind:"subtitle",mime:"text/vtt"}),new p("live profile","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-live/mp4-live-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(l.DASH).addFeature(l.MP4),new p("live profile with five periods","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-live-periods/mp4-live-periods-mpd.mpd",o.GPAC).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPERIOD).addFeature(l.HIGH_DEFINITION).addFeature(l.OFFLINE),new p("main profile, single file","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-single/mp4-main-single-mpd-AV-NBS.mpd",o.GPAC).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.HIGH_DEFINITION).addFeature(l.OFFLINE),new p("main profile, multiple files","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-multi/mp4-main-multi-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(l.DASH).addFeature(l.MP4),new p("onDemand profile","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-onDemand/mp4-onDemand-mpd-AV.mpd",o.GPAC).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.HIGH_DEFINITION).addFeature(l.OFFLINE),new p("main profile, open GOP","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-main-ogop/mp4-main-ogop-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(l.DASH).addFeature(l.MP4),new p("full profile, gradual decoding refresh","https://storage.googleapis.com/shaka-asset-icons/gpac_test_pattern.png","https://download.tsi.telecom-paristech.fr/gpac/DASH_CONFORMANCE/TelecomParisTech/mp4-full-gdr/mp4-full-gdr-mpd-AV-BS.mpd",o.GPAC).markAsDisabled().addFeature(l.DASH).addFeature(l.MP4),new p("Multi DRM - 8 Byte IV","https://storage.googleapis.com/shaka-asset-icons/azure.png","https://content.uplynk.com/847859273a4b4a81959d8fea181672a4.mpd?pr.version=2&pr.playenabler=B621D91F-EDCC-4035-8D4B-DC71760D43E9&pr.securitylevel=150",o.UPLYNK).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIKEY).addFeature(l.AESCTR_8_BYTE_IV).addFeature(l.HIGH_DEFINITION).addLicenseServer("com.microsoft.playready","https://content.uplynk.com/pr").addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(y.UplynkRequestFilter).setResponseFilter(y.UplynkResponseFilter),new p("Multi DRM - MultiPeriod - 8 Byte IV","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://content.uplynk.com/054225d59be2454fabdca3e96912d847.mpd?ad=cleardash&pr.version=2&pr.playenabler=B621D91F-EDCC-4035-8D4B-DC71760D43E9&pr.securitylevel=150",o.UPLYNK).addKeySystem(u.PLAYREADY).addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.SUBTITLES).addFeature(l.MULTIKEY).addFeature(l.MULTIPERIOD).addFeature(l.WEBVTT).addFeature(l.AESCTR_8_BYTE_IV).addFeature(l.HIGH_DEFINITION).addLicenseServer("com.microsoft.playready","https://content.uplynk.com/pr").addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(y.UplynkRequestFilter).setResponseFilter(y.UplynkResponseFilter),new p("Widevine - 16 Byte IV","https://storage.googleapis.com/shaka-asset-icons/big_buck_bunny.png","https://content.uplynk.com/224ac8717e714b68831997ab6cea4015.mpd",o.UPLYNK).markAsDisabled().addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIKEY).addFeature(l.AESCTR_16_BYTE_IV).addFeature(l.HIGH_DEFINITION).addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(y.UplynkRequestFilter).setResponseFilter(y.UplynkResponseFilter),new p("Widevine - 16 Byte IV - (mix of encrypted and unencrypted periods)","https://storage.googleapis.com/shaka-asset-icons/sintel.png","https://content.uplynk.com/1eb40d8e64234f5c9879db7045c3d48c.mpd?ad=cleardash&rays=cdefg",o.UPLYNK).markAsDisabled().addKeySystem(u.WIDEVINE).addFeature(l.DASH).addFeature(l.MP4).addFeature(l.MULTIPLE_LANGUAGES).addFeature(l.MULTIPERIOD).addFeature(l.MULTIKEY).addFeature(l.HIGH_DEFINITION).addFeature(l.AESCTR_16_BYTE_IV).addFeature(l.ENCRYPTED_WITH_CLEAR).addLicenseServer("com.widevine.alpha","https://content.uplynk.com/wv").setRequestFilter(y.UplynkRequestFilter).setResponseFilter(y.UplynkResponseFilter)];var g=y,_=n(3),b=n(6),w=n.n(b);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"make",value:function(e,t){w()(e,{content:t,placement:"bottom",arrow:!0,animation:"scale",size:"large"})}}],(n=null)&&E(t.prototype,n),r&&E(t,r),e}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka;var C=window.goog,I=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"severity",{RECOVERABLE:1,CRITICAL:2}),k(this,"category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9}),k(this,"code",{UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013});for(var i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];if(this.data=a,this.handled=!1,C.DEBUG){var o="UNKNOWN",u="UNKNOWN";for(var l in e.Category)e.Category[l]==this.category&&(o=l);for(var c in e.Code)e.Code[c]==this.code&&(u=c);if(this.message="Shaka Error "+o+"."+u+" ("+this.data.toString()+")",e.createStack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}}}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"Error "+JSON.stringify(this,null,"  ")}}])&&T(t.prototype,n),r&&T(t,r),e}();C.DEBUG&&(I.createStack=!0);var A=I,x={ARIA_LABEL:"aria-label",SEEK_BAR_BASE_COLOR:"rgba(255, 255, 255, 0.3)",SEEK_BAR_PLAYED_COLOR:"rgb(255, 255, 255)",SEEK_BAR_BUFFERED_COLOR:"rgba(255, 255, 255, 0.54)",VOLUME_BAR_VOLUME_LEVEL_COLOR:"rgb(255, 255, 255)",VOLUME_BAR_BASE_COLOR:"rgba(255, 255, 255, 0.54)",MIN_SEEK_WINDOW_TO_SHOW_SEEKBAR:5,KEYCODE_TAB:9,KEYCODE_SHIFT:16,KEYCODE_ESCAPE:27},L=x,N={MaterialDesignIcons:{FULLSCREEN:"fullscreen",EXIT_FULLSCREEN:"fullscreen_exit",CLOSED_CAPTIONS:"closed_caption",CHECKMARK:"done",LANGUAGE:"language",PIP:"picture_in_picture_alt",EXIT_PIP:"branding_watermark",BACK:"arrow_back",RESOLUTION:"settings",MUTE:"volume_up",UNMUTE:"volume_off",CAST:"cast",EXIT_CAST:"cast_connected",OPEN_OVERFLOW:"more_vert",REWIND:"fast_rewind",FAST_FORWARD:"fast_forward",PLAY:"play_arrow",PAUSE:"pause"},Opacity:{TRANSPARENT:0,OPAQUE:1}},R=N,M={addTo:function(e){e.insert("ar",new Map([["AUTO_QUALITY","تلقائي"],["BACK","رجوع"],["CAPTIONS","الترجمة"],["CAST","إرسال..."],["ENTER_PICTURE_IN_PICTURE",'الدخول في وضع "نافذة ضمن نافذة"'],["EXIT_FULL_SCREEN","إنهاء وضع ملء الشاشة"],["EXIT_PICTURE_IN_PICTURE",'الخروج من وضع "نافذة ضمن نافذة"'],["FAST_FORWARD","تقديم سريع"],["FULL_SCREEN","ملء الشاشة"],["LANGUAGE","اللغة"],["LIVE","مباشر"],["MORE_SETTINGS","إعدادات إضافية"],["MUTE","كتم الصوت"],["NOT_APPLICABLE","غير سارٍ"],["OFF","إيقاف"],["ON","تشغيل"],["PAUSE","إيقاف مؤقت"],["PICTURE_IN_PICTURE","نافذة ضمن النافذة"],["PLAY","تشغيل"],["RESOLUTION",""],["REWIND","إرجاع"],["SEEK","شريط تمرير البحث"],["SKIP_TO_LIVE","مباشر"],["UNDETERMINED_LANGUAGE","غير معروفة"],["UNMUTE","إلغاء كتم الصوت"],["UNRECOGNIZED_LANGUAGE","غير معروفة"],["VOLUME","الحجم"]])),e.insert("de",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Zurück"],["CAPTIONS","Untertitel"],["CAST","Streamen…"],["ENTER_PICTURE_IN_PICTURE","Bild-im-Bild-Modus aktivieren"],["EXIT_FULL_SCREEN","Vollbildmodus beenden"],["EXIT_PICTURE_IN_PICTURE","Bild-im-Bild-Modus beenden"],["FAST_FORWARD","Vorspulen"],["FULL_SCREEN","Vollbild"],["LANGUAGE","Sprache"],["LIVE","Live"],["MORE_SETTINGS","Weitere Einstellungen"],["MULTIPLE_LANGUAGES","mehrere Sprachen"],["MUTE","Stummschalten"],["NOT_APPLICABLE","Nicht zutreffend"],["OFF","Aus"],["ON","An"],["PAUSE","Pausieren"],["PICTURE_IN_PICTURE","Bild-in-Bild"],["PLAY","Wiedergeben"],["RESOLUTION","Auflösung"],["REWIND","Zurückspulen"],["SEEK","Schieberegler für Suche"],["SKIP_TO_LIVE","Live"],["UNDETERMINED_LANGUAGE","Unbestimmt"],["UNMUTE","Stummschaltung aufheben"],["UNRECOGNIZED_LANGUAGE","Unerkannt"],["VOLUME","Lautstärke"]])),e.insert("en",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),e.insert("en-GB",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),e.insert("es",new Map([["AUTO_QUALITY","Automática"],["BACK","Atrás"],["CAPTIONS","Subtítulos"],["CAST","Reparto..."],["ENTER_PICTURE_IN_PICTURE","abrir el modo imagen en imagen"],["EXIT_FULL_SCREEN","Salir del modo de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","salir del modo imagen en imagen"],["FAST_FORWARD","Avance rápido"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["MORE_SETTINGS","Más ajustes"],["MULTIPLE_LANGUAGES","varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","No"],["ON","activado"],["PAUSE","Pausa"],["PICTURE_IN_PICTURE","Imagen en imagen"],["PLAY","Reproducir"],["RESOLUTION","Resolución"],["REWIND","Retroceder"],["SEEK","Barra deslizante de búsqueda"],["SKIP_TO_LIVE","En directo"],["UNDETERMINED_LANGUAGE","Desconocido"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","Desconocido"],["VOLUME","volumen"]])),e.insert("es-419",new Map([["AUTO_QUALITY","Auto"],["BACK","Atrás"],["CAPTIONS","Subtítulos"],["CAST","Transmitir…"],["ENTER_PICTURE_IN_PICTURE","ingresar al modo de pantalla en pantalla"],["EXIT_FULL_SCREEN","Salir de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","salir del modo de pantalla en pantalla"],["FAST_FORWARD","Avance rápido"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En vivo"],["MORE_SETTINGS","Más opciones de configuración"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","activado"],["PAUSE","Detener"],["PICTURE_IN_PICTURE","Pantalla en pantalla"],["PLAY","Jugar"],["RESOLUTION","Resolución"],["REWIND","Retroceder"],["SEEK","Barra deslizante de búsqueda"],["SKIP_TO_LIVE","En vivo"],["UNDETERMINED_LANGUAGE","Desconocido"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","Desconocido"],["VOLUME","volumen"]])),e.insert("fr",new Map([["AUTO_QUALITY","Auto"],["BACK","Retour"],["CAPTIONS","Sous-titres"],["CAST","Caster sur…"],["ENTER_PICTURE_IN_PICTURE","utiliser le mode PIP"],["EXIT_FULL_SCREEN","Quitter le mode plein écran"],["EXIT_PICTURE_IN_PICTURE","quitter le mode PIP"],["FAST_FORWARD","Avance rapide"],["FULL_SCREEN","Plein écran"],["LANGUAGE","Langue"],["LIVE","En direct"],["MORE_SETTINGS","Autres paramètres"],["MULTIPLE_LANGUAGES","plusieurs langues"],["MUTE","Désactiver le son"],["NOT_APPLICABLE","Non applicable"],["OFF","Désactivée"],["ON","activé"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Lire"],["RESOLUTION","Résolution"],["REWIND","Retour arrière"],["SEEK","Barre de recherche"],["SKIP_TO_LIVE","Aller au direct"],["UNDETERMINED_LANGUAGE","Inconnue"],["UNMUTE","Activer le son"],["UNRECOGNIZED_LANGUAGE","Inconnue"],["VOLUME","volume"]])),e.insert("it",new Map([["AUTO_QUALITY","Auto"],["BACK","Indietro"],["CAPTIONS","Sottotitoli"],["CAST","Trasmetti…"],["ENTER_PICTURE_IN_PICTURE","attiva picture in picture"],["EXIT_FULL_SCREEN","Esci dalla modalità a schermo intero"],["EXIT_PICTURE_IN_PICTURE","esci da picture in picture"],["FAST_FORWARD","Avanti veloce"],["FULL_SCREEN","Schermo intero"],["LANGUAGE","Lingua"],["LIVE","Dal vivo"],["MORE_SETTINGS","Altre impostazioni"],["MUTE","Disattiva audio"],["NOT_APPLICABLE","Non applicable"],["OFF","Disattivato"],["ON","on"],["PAUSE","Metti in pausa"],["PICTURE_IN_PICTURE","Picture in picture"],["PLAY","Riproduci"],["RESOLUTION","Risoluzione"],["REWIND","Riavvolgi"],["SEEK","Dispositivo di scorrimento"],["SKIP_TO_LIVE","Dal vivo"],["UNDETERMINED_LANGUAGE","Sconosciuto"],["UNMUTE","Riattiva audio"],["UNRECOGNIZED_LANGUAGE","Sconosciuto"],["VOLUME","volume"]])),e.insert("ja",new Map([["AUTO_QUALITY","自動"],["BACK","戻る"],["CAPTIONS","字幕"],["CAST","キャスト..."],["ENTER_PICTURE_IN_PICTURE","ピクチャー イン ピクチャーを開始します"],["EXIT_FULL_SCREEN","全画面モードの終了"],["EXIT_PICTURE_IN_PICTURE","ピクチャー イン ピクチャーを終了します"],["FAST_FORWARD","早送り"],["FULL_SCREEN","全画面"],["LANGUAGE","言語"],["LIVE","ライブ"],["MORE_SETTINGS","その他の設定"],["MULTIPLE_LANGUAGES","複数の言語"],["MUTE","ミュート"],["NOT_APPLICABLE","--"],["OFF","オフ"],["ON","オン"],["PAUSE","一時停止"],["PICTURE_IN_PICTURE","ピクチャー イン ピクチャー"],["PLAY","再生"],["RESOLUTION","解像度"],["REWIND","巻き戻し"],["SEEK","シーク バー"],["SKIP_TO_LIVE","ライブ"],["UNDETERMINED_LANGUAGE","不明"],["UNMUTE","ミュート解除"],["UNRECOGNIZED_LANGUAGE","不明"],["VOLUME","音量"]])),e.insert("ko",new Map([["AUTO_QUALITY","자동"],["BACK","뒤로"],["CAPTIONS","자막"],["CAST","전송..."],["ENTER_PICTURE_IN_PICTURE","PIP 모드 시작"],["EXIT_FULL_SCREEN","전체화면 종료"],["EXIT_PICTURE_IN_PICTURE","PIP 모드 종료"],["FAST_FORWARD","빨리감기"],["FULL_SCREEN","전체화면"],["LANGUAGE","언어"],["LIVE","라이브"],["MORE_SETTINGS","설정 더보기"],["MULTIPLE_LANGUAGES","여러 언어"],["MUTE","음소거"],["NOT_APPLICABLE","해당 사항 없음"],["OFF","사용 안함"],["ON","사용"],["PAUSE","일시중지"],["PICTURE_IN_PICTURE","PIP 모드"],["PLAY","재생"],["RESOLUTION","해상도"],["REWIND","되감기"],["SEEK","탐색 슬라이더"],["SKIP_TO_LIVE","라이브"],["UNDETERMINED_LANGUAGE","알 수 없음"],["UNMUTE","음소거 해제"],["UNRECOGNIZED_LANGUAGE","알 수 없음"],["VOLUME","볼륨"]])),e.insert("nl",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Terug"],["CAPTIONS","Ondertiteling"],["CAST","Casten..."],["ENTER_PICTURE_IN_PICTURE","scherm-in-scherm openen"],["EXIT_FULL_SCREEN","Volledig scherm afsluiten"],["EXIT_PICTURE_IN_PICTURE","scherm-in-scherm afsluiten"],["FAST_FORWARD","Vooruitspoelen"],["FULL_SCREEN","Volledig scherm"],["LANGUAGE","Taal"],["LIVE","Live"],["MORE_SETTINGS","Meer instellingen"],["MUTE","Dempen"],["NOT_APPLICABLE","Niet van toepassing"],["OFF","Uit"],["ON","aan"],["PAUSE","Onderbreken"],["PICTURE_IN_PICTURE","Scherm-in-scherm"],["PLAY","Afspelen"],["RESOLUTION","Resolutie"],["REWIND","Terugspoelen"],["SEEK","Zoekschuifbalk"],["SKIP_TO_LIVE","Live"],["UNDETERMINED_LANGUAGE","Onbekend"],["UNMUTE","Dempen opheffen"],["UNRECOGNIZED_LANGUAGE","Onbekend"],["VOLUME","volume"]])),e.insert("pl",new Map([["AUTO_QUALITY","Automatyczna"],["BACK","Wstecz"],["CAPTIONS","Napisy"],["CAST","Prześlij..."],["ENTER_PICTURE_IN_PICTURE","włącz tryb obrazu w obrazie"],["EXIT_FULL_SCREEN","Zamknij pełny ekran"],["EXIT_PICTURE_IN_PICTURE","wyłącz tryb obrazu w obrazie"],["FAST_FORWARD","Przewiń do przodu"],["FULL_SCREEN","Pełny ekran"],["LANGUAGE","Język"],["LIVE","Na żywo"],["MORE_SETTINGS","Więcej ustawień"],["MUTE","Wycisz"],["NOT_APPLICABLE","Nie dotyczy"],["OFF","Wyłączone"],["ON","wł."],["PAUSE","Wstrzymaj"],["PICTURE_IN_PICTURE","Obraz w obrazie"],["PLAY","Odtwarzaj"],["RESOLUTION","Rozdzielczość"],["REWIND","Przewiń do tyłu"],["SEEK","Suwak przewijania"],["SKIP_TO_LIVE","Na żywo"],["UNDETERMINED_LANGUAGE","Nieznane"],["UNMUTE","Wyłącz wyciszenie"],["UNRECOGNIZED_LANGUAGE","Nieznane"],["VOLUME","głośność"]])),e.insert("pt",new Map([["AUTO_QUALITY","Automático"],["BACK","Voltar"],["CAPTIONS","Legendas ocultas"],["CAST","Elenco..."],["ENTER_PICTURE_IN_PICTURE","entrar no modo picture-in-picture"],["EXIT_FULL_SCREEN","Sair da tela inteira"],["EXIT_PICTURE_IN_PICTURE","sair de picture-in-picture"],["FAST_FORWARD","Avançar"],["FULL_SCREEN","Tela inteira"],["LANGUAGE","Idioma"],["LIVE","Ao vivo"],["MORE_SETTINGS","Mais configurações"],["MULTIPLE_LANGUAGES","vários idiomas"],["MUTE","Desativar som"],["NOT_APPLICABLE","Não aplicável"],["OFF","Desativado"],["ON","ativado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Reproduzir"],["RESOLUTION","Resolução"],["REWIND","Retroceder"],["SEEK","Botão deslizante de busca"],["SKIP_TO_LIVE","Ao vivo"],["UNDETERMINED_LANGUAGE","Desconhecido"],["UNMUTE","Ativar som"],["UNRECOGNIZED_LANGUAGE","Desconhecido"],["VOLUME","volume"]])),e.insert("ru",new Map([["AUTO_QUALITY","Автонастройка"],["BACK","Назад"],["CAPTIONS","Субтитры"],["CAST","Хромкаст"],["ENTER_PICTURE_IN_PICTURE",'включить режим "Картинка в картинке"'],["EXIT_FULL_SCREEN","Выход из полноэкранного режима"],["EXIT_PICTURE_IN_PICTURE",'выйти из режима "Картинка в картинке"'],["FAST_FORWARD","Перемотать вперед"],["FULL_SCREEN","Во весь экран"],["LANGUAGE","Язык"],["LIVE","Прямой эфир"],["MORE_SETTINGS","Дополнительные настройки"],["MULTIPLE_LANGUAGES","поддержка нескольких языков"],["MUTE","Отключить звук"],["NOT_APPLICABLE","Неприменимо"],["OFF","Выкл."],["ON","ВКЛ"],["PAUSE","Приостановить"],["PICTURE_IN_PICTURE","Картинка в картинке"],["PLAY","Смотреть"],["RESOLUTION","Разрешение"],["REWIND","Перемотать назад"],["SEEK","Ползунок поиска"],["SKIP_TO_LIVE","Смотреть прямой эфир"],["UNDETERMINED_LANGUAGE","Неизвестно"],["UNMUTE","Включить звук"],["UNRECOGNIZED_LANGUAGE","Неизвестно"],["VOLUME","громкость"]])),e.insert("th",new Map([["AUTO_QUALITY","อัตโนมัติ"],["BACK","กลับ"],["CAPTIONS","คำอธิบายวิดีโอ"],["CAST","แคสต์..."],["ENTER_PICTURE_IN_PICTURE","เข้าสู่การแสดงภาพซ้อนภาพ"],["EXIT_FULL_SCREEN","ออกจากโหมดเต็มหน้าจอ"],["EXIT_PICTURE_IN_PICTURE","ออกจากการแสดงภาพซ้อนภาพ"],["FAST_FORWARD","กรอไปข้างหน้า"],["FULL_SCREEN","เต็มหน้าจอ"],["LANGUAGE","ภาษา"],["LIVE","สด"],["MORE_SETTINGS","การตั้งค่าเพิ่มเติม"],["MUTE","ปิดเสียง"],["NOT_APPLICABLE","ไม่เกี่ยวข้อง"],["OFF","ปิด"],["ON","เปิด"],["PAUSE","หยุดชั่วคราว"],["PICTURE_IN_PICTURE","การแสดงภาพซ้อนภาพ"],["PLAY","เล่น"],["RESOLUTION","ความละเอียด"],["REWIND","กรอกลับ"],["SEEK","แถบเลื่อนค้นหา"],["SKIP_TO_LIVE","สด"],["UNDETERMINED_LANGUAGE","ไม่ทราบ"],["UNMUTE","เปิดเสียง"],["UNRECOGNIZED_LANGUAGE","ไม่ทราบ"],["VOLUME","ระดับเสียง"]])),e.insert("tr",new Map([["AUTO_QUALITY","Otomatik"],["BACK","Geri"],["CAPTIONS","Altyazılar"],["CAST","Yayınla..."],["ENTER_PICTURE_IN_PICTURE","pencere içinde pencere moduna gir"],["EXIT_FULL_SCREEN","Tam ekrandan çık"],["EXIT_PICTURE_IN_PICTURE","pencere içinde pencere modundan çıkın"],["FAST_FORWARD","İleri sar"],["FULL_SCREEN","Tam ekran"],["LANGUAGE","Dil"],["LIVE","Canlı"],["MORE_SETTINGS","Diğer ayarlar"],["MUTE","Sesi kapat"],["NOT_APPLICABLE","Kullanılmıyor"],["OFF","Kapalı"],["ON","açık"],["PAUSE","Duraklat"],["PICTURE_IN_PICTURE","Pencere içinde Pencere"],["PLAY","Oynat"],["RESOLUTION","Çözünürlük"],["REWIND","Geri sar"],["SEEK","Arama kaydırma çubuğu"],["SKIP_TO_LIVE","Canlı"],["UNDETERMINED_LANGUAGE","Bilinmiyor"],["UNMUTE","Sesi aç"],["UNRECOGNIZED_LANGUAGE","Bilinmiyor"],["VOLUME","ses düzeyi"]])),e.insert("zh",new Map([["AUTO_QUALITY","自动"],["BACK","返回"],["CAPTIONS","字幕"],["CAST","投射…"],["ENTER_PICTURE_IN_PICTURE","进入“画中画”模式"],["EXIT_FULL_SCREEN","退出全屏"],["EXIT_PICTURE_IN_PICTURE","退出“画中画”模式"],["FAST_FORWARD","快进"],["FULL_SCREEN","全屏"],["LANGUAGE","语言"],["LIVE","直播"],["MORE_SETTINGS","更多设置"],["MUTE","静音"],["NOT_APPLICABLE","不適用"],["OFF","关闭"],["ON","开启"],["PAUSE","暂停"],["PICTURE_IN_PICTURE","画中画"],["PLAY","播放"],["RESOLUTION","分辨率"],["REWIND","快退"],["SEEK","播放滑块"],["SKIP_TO_LIVE","直播"],["UNDETERMINED_LANGUAGE","未知"],["UNMUTE","取消静音"],["UNRECOGNIZED_LANGUAGE","未知"],["VOLUME","音量"]])),e.insert("zh-TW",new Map([["AUTO_QUALITY","自動"],["BACK","返回"],["CAPTIONS","字幕"],["CAST","投放…"],["ENTER_PICTURE_IN_PICTURE","進入子母畫面"],["EXIT_FULL_SCREEN","結束全螢幕"],["EXIT_PICTURE_IN_PICTURE","離開子母畫面"],["FAST_FORWARD","快轉"],["FULL_SCREEN","全螢幕"],["LANGUAGE","語言"],["LIVE","直播"],["MORE_SETTINGS","更多設定"],["MUTE","靜音"],["NOT_APPLICABLE","不適用"],["OFF","關閉"],["ON","開啟"],["PAUSE","暫停"],["PICTURE_IN_PICTURE","子母畫面"],["PLAY","播放"],["RESOLUTION","解析度"],["REWIND","倒轉"],["SEEK","搜尋滑桿"],["SKIP_TO_LIVE","直播"],["UNDETERMINED_LANGUAGE","未知"],["UNMUTE","解除靜音"],["UNRECOGNIZED_LANGUAGE","未知"],["VOLUME","音量"]]))},Ids:{ENTER_PICTURE_IN_PICTURE:"ENTER_PICTURE_IN_PICTURE",MULTIPLE_LANGUAGES:"MULTIPLE_LANGUAGES",BACK:"BACK",VOLUME:"VOLUME",EXIT_FULL_SCREEN:"EXIT_FULL_SCREEN",NOT_APPLICABLE:"NOT_APPLICABLE",SEEK:"SEEK",LANGUAGE:"LANGUAGE",SKIP_TO_LIVE:"SKIP_TO_LIVE",FULL_SCREEN:"FULL_SCREEN",CAST:"CAST",LIVE:"LIVE",UNRECOGNIZED_LANGUAGE:"UNRECOGNIZED_LANGUAGE",RESOLUTION:"RESOLUTION",PICTURE_IN_PICTURE:"PICTURE_IN_PICTURE",PLAY:"PLAY",PAUSE:"PAUSE",OFF:"OFF",MUTE:"MUTE",UNDETERMINED_LANGUAGE:"UNDETERMINED_LANGUAGE",CAPTIONS:"CAPTIONS",AUTO_QUALITY:"AUTO_QUALITY",ON:"ON",MORE_SETTINGS:"MORE_SETTINGS",EXIT_PICTURE_IN_PICTURE:"EXIT_PICTURE_IN_PICTURE",UNMUTE:"UNMUTE",FAST_FORWARD:"FAST_FORWARD",REWIND:"REWIND"}},P=M;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var D=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n)Object.defineProperty(this,r,{value:n[r],writable:!0,enumerable:!0});this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1}var t,n,r;return t=e,(n=[{key:"preventDefault",value:function(){this.cancelable&&(this.defaultPrevented=!0)}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}])&&O(t.prototype,n),r&&O(t,r),e}();function U(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map_={}}var t,n,r;return t=e,(n=[{key:"push",value:function(e,t){this.map_.hasOwnProperty(e)?this.map_[e].push(t):this.map_[e]=[t]}},{key:"get",value:function(e){var t=this.map_[e];return t?t.slice():null}},{key:"getAll",value:function(){var e=[];for(var t in this.map_)e.push.apply(e,U(this.map_[t]));return e}},{key:"remove",value:function(e,t){var n=this.map_[e];if(n)for(var r=0;r<n.length;++r)n[r]===t&&(n.splice(r,1),--r)}},{key:"clear",value:function(){this.map_={}}},{key:"forEach",value:function(e){for(var t in this.map_)e(t,this.map_[t])}}])&&F(t.prototype,n),r&&F(t,r),e}();function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};var j=window.shaka;j.util;window.goog=window.goog||{};window.goog;var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners_=new B,this.dispatchTarget=this}var t,n,r;return t=e,(n=[{key:"addEventListener",value:function(e,t,n){this.listeners_.push(e,t)}},{key:"removeEventListener",value:function(e,t,n){this.listeners_.remove(e,t)}},{key:"dispatchEvent",value:function(e){window.asserts.assert(e instanceof D,"FakeEventTarget can only dispatch FakeEvents!");var t=this.listeners_.get(e.type)||[],n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;try{o.handleEvent?o.handleEvent(e):o.call(this,e)}catch(e){j.log.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.stopped)break}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e.defaultPrevented}}])&&V(t.prototype,n),r&&V(t,r),e}();function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"map",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;n.push(t(u))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"every",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){if(!t(a.value))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0}},{key:"some",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){if(t(a.value))return!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}},{key:"filter",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;t(u)&&n.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}}],(n=null)&&K(t.prototype,n),r&&K(t,r),e}();function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createFallbackPromiseChain",value:function(e,t){return e.reduce(function(e,n){return e.catch(function(){return t(n)})},Promise.reject())}},{key:"collapseArrays",value:function(e,t){return e.concat(t)}},{key:"noop",value:function(){}},{key:"isNotNull",value:function(e){return null!=e}}],(n=null)&&W(t.prototype,n),r&&W(t,r),e}(),z=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),Y={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7},X=function(e){return e.match(z)},$=$||{};$.global=window,$.isDef=function(e){return void 0!==e},$.exportPath_=function(e,t,n){var r,i=e.split("."),a=n||$.global;i[0]in a||!a.execScript||a.execScript("var "+i[0]);for(;i.length&&(r=i.shift());)!i.length&&$.isDef(t)?a[r]=t:a=a[r]?a[r]:a[r]={}},$.define=function(e,t){var n=t;$.exportPath_(e,n)},$.DEBUG=!0,$.define("goog.LOCALE","en"),$.define("goog.TRUSTED_SITE",!0),$.define("goog.STRICT_MODE_COMPATIBLE",!1),$.provide=function(e){if($.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete $.implicitNamespaces_[e];for(var t=e;(t=t.substring(0,t.lastIndexOf(".")))&&!$.getObjectByName(t);)$.implicitNamespaces_[t]=!0;$.exportPath_(e)},$.forwardDeclare=function(e){},$.isProvided_=function(e){return!$.implicitNamespaces_[e]&&$.isDefAndNotNull($.getObjectByName(e))},$.implicitNamespaces_={},$.getObjectByName=function(e,t){for(var n,r=e.split("."),i=t||$.global;n=r.shift();){if(!$.isDefAndNotNull(i[n]))return null;i=i[n]}return i},$.globalize=function(e,t){for(var n in t=t||$.global,e)t[n]=e[n]},$.addDependency=function(e,t,n){if($.DEPENDENCIES_ENABLED){for(var r,i,a=e.replace(/\\/g,"/"),s=$.dependencies_,o=0;r=t[o];o++)s.nameToPath[r]=a;for(var u=0;i=n[u];u++)a in s.requires||(s.requires[a]={}),s.requires[a][i]=!0}},$.define("goog.ENABLE_DEBUG_LOADER",!0),$.logToConsole_=function(e){$.global.console&&$.global.console.error(e)},$.require=function(e){if($.isProvided_(e))return null;if($.ENABLE_DEBUG_LOADER){var t=$.getPathFromDeps_(e);if(t)return $.included_[t]=!0,$.writeScripts_(),null}var n="goog.require could not find: "+e;throw $.logToConsole_(n),Error(n)},$.basePath="",$.global.CLOSURE_BASE_PATH,$.global.CLOSURE_NO_DEPS=!0,$.global.CLOSURE_IMPORT_SCRIPT,$.DEPENDENCIES_ENABLED=$.ENABLE_DEBUG_LOADER,$.DEPENDENCIES_ENABLED&&($.included_={},$.dependencies_={nameToPath:{},requires:{},visited:{},written:{}},$.inHtmlDocument_=function(){var e=$.global.document;return void 0!==e&&"write"in e},$.findBasePath_=function(){if($.global.CLOSURE_BASE_PATH)$.basePath=$.global.CLOSURE_BASE_PATH;else if($.inHtmlDocument_())for(var e=$.global.document.getElementsByTagName("script"),t=e.length-1;t>=0;--t){var n=e[t].src,r=n.lastIndexOf("?"),i=-1==r?n.length:r;if("base.js"==n.substr(i-7,7))return void($.basePath=n.substr(0,i-7))}},$.importScript_=function(e,t){($.global.CLOSURE_IMPORT_SCRIPT||$.writeScriptTag_)(e,t)&&($.dependencies_.written[e]=!0)},$.writeScriptTag_=function(e,t){if($.inHtmlDocument_()){var n=$.global.document;if("complete"==n.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}return void 0===t?n.write('<script type="text/javascript" src="'+e+'"><\/script>'):n.write('<script type="text/javascript">'+t+"<\/script>"),!0}return!1},$.writeScripts_=function(){var e=[],t={},n=$.dependencies_;function r(i){if(!(i in n.written))if(i in n.visited)i in t||(t[i]=!0,e.push(i));else{if(n.visited[i]=!0,i in n.requires)for(var a in n.requires[i])if(!$.isProvided_(a)){if(!(a in n.nameToPath))throw Error("Undefined nameToPath for "+a);r(n.nameToPath[a])}i in t||(t[i]=!0,e.push(i))}}for(var i in $.included_)n.written[i]||r(i);for(var a=0;a<e.length;a++){i=e[a];$.dependencies_.written[i]=!0}for(a=0;a<e.length;a++){(i=e[a])&&$.importScript_($.basePath+i)}},$.getPathFromDeps_=function(e){return e in $.dependencies_.nameToPath?$.dependencies_.nameToPath[e]:null},$.findBasePath_(),$.global.CLOSURE_NO_DEPS||$.importScript_($.basePath+"deps.js")),$.isDefAndNotNull=function(e){return null!=e},$.isString=function(e){return"string"==typeof e},$.exportSymbol=function(e,t,n){$.exportPath_(e,t,n)},$.exportProperty=function(e,t,n){e[t]=n},$.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.base=function(e,n,r){var i=Array.prototype.slice.call(arguments,2);return t.prototype[n].apply(e,i)}},$.global.COMPILED=!1;var Q=$;function Z(e){var t;e instanceof Z?(this.setScheme(e.getScheme()),this.setUserInfo(e.getUserInfo()),this.setDomain(e.getDomain()),this.setPort(e.getPort()),this.setPath(e.getPath()),this.setQueryData(e.getQueryData().clone()),this.setFragment(e.getFragment())):e&&(t=X(String(e)))?(this.setScheme(t[Y.SCHEME]||"",!0),this.setUserInfo(t[Y.USER_INFO]||"",!0),this.setDomain(t[Y.DOMAIN]||"",!0),this.setPort(t[Y.PORT]),this.setPath(t[Y.PATH]||"",!0),this.setQueryData(t[Y.QUERY_DATA]||"",!0),this.setFragment(t[Y.FRAGMENT]||"",!0)):this.queryData_=new Z.QueryData(null,null)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Z.prototype.scheme_="",Z.prototype.userInfo_="",Z.prototype.domain_="",Z.prototype.port_=null,Z.prototype.path_="",Z.prototype.queryData_,Z.prototype.fragment_="",Z.prototype.toString=function(){var e=[],t=this.getScheme();t&&e.push(Z.encodeSpecialChars_(t,Z.reDisallowedInSchemeOrUserInfo_,!0),":");var n=this.getDomain();if(n){e.push("//");var r=this.getUserInfo();r&&e.push(Z.encodeSpecialChars_(r,Z.reDisallowedInSchemeOrUserInfo_,!0),"@"),e.push(Z.removeDoubleEncoding_(encodeURIComponent(n)));var i=this.getPort();null!=i&&e.push(":",String(i))}var a=this.getPath();a&&(this.hasDomain()&&"/"!=a.charAt(0)&&e.push("/"),e.push(Z.encodeSpecialChars_(a,"/"==a.charAt(0)?Z.reDisallowedInAbsolutePath_:Z.reDisallowedInRelativePath_,!0)));var s=this.getEncodedQuery();s&&e.push("?",s);var o=this.getFragment();return o&&e.push("#",Z.encodeSpecialChars_(o,Z.reDisallowedInFragment_)),e.join("")},Z.prototype.resolve=function(e){var t=this.clone();"data"===t.scheme_&&(t=new Z);var n=e.hasScheme();n?t.setScheme(e.getScheme()):n=e.hasUserInfo(),n?t.setUserInfo(e.getUserInfo()):n=e.hasDomain(),n?t.setDomain(e.getDomain()):n=e.hasPort();var r=e.getPath();if(n)t.setPort(e.getPort());else if(n=e.hasPath()){if("/"!=r.charAt(0))if(this.hasDomain()&&!this.hasPath())r="/"+r;else{var i=t.getPath().lastIndexOf("/");-1!=i&&(r=t.getPath().substr(0,i+1)+r)}r=Z.removeDotSegments(r)}return n?t.setPath(r):n=e.hasQuery(),n?t.setQueryData(e.getQueryData().clone()):n=e.hasFragment(),n&&t.setFragment(e.getFragment()),t},Z.prototype.clone=function(){return new Z(this)},Z.prototype.getScheme=function(){return this.scheme_},Z.prototype.setScheme=function(e,t){return this.scheme_=t?Z.decodeOrEmpty_(e,!0):e,this.scheme_&&(this.scheme_=this.scheme_.replace(/:$/,"")),this},Z.prototype.hasScheme=function(){return!!this.scheme_},Z.prototype.getUserInfo=function(){return this.userInfo_},Z.prototype.setUserInfo=function(e,t){return this.userInfo_=t?Z.decodeOrEmpty_(e):e,this},Z.prototype.hasUserInfo=function(){return!!this.userInfo_},Z.prototype.getDomain=function(){return this.domain_},Z.prototype.setDomain=function(e,t){return this.domain_=t?Z.decodeOrEmpty_(e,!0):e,this},Z.prototype.hasDomain=function(){return!!this.domain_},Z.prototype.getPort=function(){return this.port_},Z.prototype.setPort=function(e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);this.port_=e}else this.port_=null;return this},Z.prototype.hasPort=function(){return null!=this.port_},Z.prototype.getPath=function(){return this.path_},Z.prototype.setPath=function(e,t){return this.path_=t?Z.decodeOrEmpty_(e,!0):e,this},Z.prototype.hasPath=function(){return!!this.path_},Z.prototype.hasQuery=function(){return""!==this.queryData_.toString()},Z.prototype.setQueryData=function(e,t){return e instanceof Z.QueryData?this.queryData_=e:(t||(e=Z.encodeSpecialChars_(e,Z.reDisallowedInQuery_)),this.queryData_=new Z.QueryData(e,null)),this},Z.prototype.getEncodedQuery=function(){return this.queryData_.toString()},Z.prototype.getDecodedQuery=function(){return this.queryData_.toDecodedString()},Z.prototype.getQueryData=function(){return this.queryData_},Z.prototype.getFragment=function(){return this.fragment_},Z.prototype.setFragment=function(e,t){return this.fragment_=t?Z.decodeOrEmpty_(e):e,this},Z.prototype.hasFragment=function(){return!!this.fragment_},Z.removeDotSegments=function(e){if(".."==e||"."==e)return"";if(-1==e.indexOf("./")&&-1==e.indexOf("/."))return e;for(var t=0==e.lastIndexOf("/",0),n=e.split("/"),r=[],i=0;i<n.length;){var a=n[i++];"."==a?t&&i==n.length&&r.push(""):".."==a?((r.length>1||1==r.length&&""!=r[0])&&r.pop(),t&&i==n.length&&r.push("")):(r.push(a),t=!0)}return r.join("/")},Z.decodeOrEmpty_=function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""},Z.encodeSpecialChars_=function(e,t,n){if(Q.isString(e)){var r=encodeURI(e).replace(t,Z.encodeChar_);return n&&(r=Z.removeDoubleEncoding_(r)),r}return null},Z.encodeChar_=function(e){var t=e.charCodeAt(0);return"%"+(t>>4&15).toString(16)+(15&t).toString(16)},Z.removeDoubleEncoding_=function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")},Z.reDisallowedInSchemeOrUserInfo_=/[#\/\?@]/g,Z.reDisallowedInRelativePath_=/[\#\?:]/g,Z.reDisallowedInAbsolutePath_=/[\#\?]/g,Z.reDisallowedInQuery_=/[\#\?@]/g,Z.reDisallowedInFragment_=/#/g,Z.QueryData=function(e,t){this.encodedQuery_=e||null},Z.QueryData.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_={},this.count_=0,this.encodedQuery_))for(var e=this.encodedQuery_.split("&"),t=0;t<e.length;t++){var n=e[t].indexOf("="),r=null,i=null;n>=0?(r=e[t].substring(0,n),i=e[t].substring(n+1)):r=e[t],r=decodeURIComponent(r.replace(/\+/g," ")),i=i||"",this.add(r,decodeURIComponent(i.replace(/\+/g," ")))}},Z.QueryData.prototype.keyMap_=null,Z.QueryData.prototype.count_=null,Z.QueryData.prototype.getCount=function(){return this.ensureKeyMapInitialized_(),this.count_},Z.QueryData.prototype.add=function(e,t){this.ensureKeyMapInitialized_(),this.encodedQuery_=null;var n=this.keyMap_.hasOwnProperty(e)&&this.keyMap_[e];return n||(this.keyMap_[e]=n=[]),n.push(t),this.count_++,this},Z.QueryData.prototype.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_)return"";var e=[];for(var t in this.keyMap_)for(var n=encodeURIComponent(t),r=this.keyMap_[t],i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),e.push(a)}return this.encodedQuery_=e.join("&")},Z.QueryData.prototype.toDecodedString=function(){return Z.decodeOrEmpty_(this.toString())},Z.QueryData.prototype.clone=function(){var e=new Z.QueryData;if(e.encodedQuery_=this.encodedQuery_,this.keyMap_){var t={};for(var n in this.keyMap_)t[n]=this.keyMap_[n].concat();e.keyMap_=t,e.count_=this.count_}return e};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"resolveUris",value:function(e,t){if(0==t.length)return e;var n=t.map(function(e){return new Z(e)});return e.map(function(e){return new Z(e)}).map(function(e){return n.map(function(t){return e.resolve(t)})}).reduce(q.collapseArrays,[]).map(function(e){return e.toString()})}},{key:"createDrmInfo",value:function(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}}],(n=null)&&J(t.prototype,n),r&&J(t,r),e}();function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ee.ContentType={VIDEO:"video",AUDIO:"audio",TEXT:"text",APPLICATION:"application"},ee.TextStreamKind={SUBTITLE:"subtitle",CLOSED_CAPTION:"caption"},ee.GAP_OVERLAP_TOLERANCE_SECONDS=1/15;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"areLocaleCompatible",value:function(t,n){return(t=e.normalize(t))==(n=e.normalize(n))}},{key:"areLanguageCompatible",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return r[0]==i[0]}},{key:"isParentOf",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return r[0]==i[0]&&1==r.length&&2==i.length}},{key:"isSiblingOf",value:function(t,n){t=e.normalize(t),n=e.normalize(n);var r=e.disassembleLocale_(t),i=e.disassembleLocale_(n);return 2==r.length&&2==i.length&&r[0]==i[0]}},{key:"normalize",value:function(t){var n=t.split("-"),r=n[0]||"",i=n[1]||"";return r=r.toLowerCase(),r=e.isoMap_.get(r)||r,(i=i.toUpperCase())?r+"-"+i:r}},{key:"areSiblings",value:function(t,n){var r=e.getBase(t),i=e.getBase(n);return t!=r&&n!=i&&r==i}},{key:"getBase",value:function(t){var n,r=t.indexOf("-");return n=(n=r>=0?t.substring(0,r):t).toLowerCase(),n=e.isoMap_.get(n)||n}},{key:"getLocaleForText",value:function(t){var n=ee.ContentType;window.asserts.assert(t.type==n.TEXT,"Can only get language from text streams");var r=t.language||"und";return e.normalize(r)}},{key:"getLocaleForVariant",value:function(t){return t.language?e.normalize(t.language):t.audio&&t.audio.language?e.normalize(t.audio.language):t.video&&t.video.language?e.normalize(t.video.language):"und"}},{key:"findClosestLocale",value:function(t,n){var r=e.normalize(t),i=new Set,a=!0,s=!1,o=void 0;try{for(var u,l=n[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;i.add(e.normalize(c))}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}var d=!0,h=!1,f=void 0;try{for(var p,m=i[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v==r)return v}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}var y=!0,g=!1,_=void 0;try{for(var b,w=i[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var E=b.value;if(e.isParentOf(E,r))return E}}catch(e){g=!0,_=e}finally{try{y||null==w.return||w.return()}finally{if(g)throw _}}var S=!0,T=!1,k=void 0;try{for(var C,I=i[Symbol.iterator]();!(S=(C=I.next()).done);S=!0){var A=C.value;if(e.isSiblingOf(A,r))return A}}catch(e){T=!0,k=e}finally{try{S||null==I.return||I.return()}finally{if(T)throw k}}var x=!0,L=!1,N=void 0;try{for(var R,M=i[Symbol.iterator]();!(x=(R=M.next()).done);x=!0){var P=R.value;if(e.isParentOf(r,P))return P}}catch(e){L=!0,N=e}finally{try{x||null==M.return||M.return()}finally{if(L)throw N}}return null}},{key:"disassembleLocale_",value:function(e){var t=e.split("-");return window.asserts.assert(t.length<=2,["Locales should not have more than 2 components. ",e," has too many components."].join()),t}}],(n=null)&&te(t.prototype,n),r&&te(t,r),e}();function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ne.isoMap_=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fallbackLocale_=ne.normalize(t),this.currentMap_=new Map,this.currentLocales_=new Set,this.localizations_=new Map,this.events_=new H}var t,n,r;return t=e,r=[{key:"findMissingKeys_",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;e.get(u)||n.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}}],(n=[{key:"addEventListener",value:function(e,t,n){this.events_.addEventListener(e,t,n)}},{key:"removeEventListener",value:function(e,t,n){this.events_.removeEventListener(e,t,n||void 0)}},{key:"dispatchEvent",value:function(e){return this.events_.dispatchEvent(e)}},{key:"changeLocale",value:function(t){var n=this,r=e;this.currentLocales_.clear();var i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;this.currentLocales_.add(ne.normalize(l))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}this.updateCurrentMap_(),this.events_.dispatchEvent(new D(r.LOCALE_CHANGED));var c=G.filter(this.currentLocales_,function(e){return!n.localizations_.has(e)});if(c.length){var d={locales:c};this.events_.dispatchEvent(new D(r.UNKNOWN_LOCALES,d))}}},{key:"insert",value:function(t,n,r){var i=e,a=e.ConflictResolution;t=ne.normalize(t),void 0===r&&(r=a.USE_NEW);var s=this.localizations_.get(t)||new Map;return n.forEach(function(e,t){s.has(t)&&r!=a.USE_NEW||s.set(t,e)}),this.localizations_.set(t,s),this.updateCurrentMap_(),this.events_.dispatchEvent(new D(i.LOCALE_UPDATED)),this}},{key:"resolveDictionary",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.keys()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.set(s,this.resolve(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"resolve",value:function(t){var n=e,r=this.currentMap_.get(t);if(r)return r;var i={locales:Array.from(this.currentLocales_),missing:t};return this.events_.dispatchEvent(new D(n.UNKNOWN_LOCALIZATION,i)),""}},{key:"updateCurrentMap_",value:function(){var t=this,n=this.localizations_,r=this.fallbackLocale_,i=this.currentLocales_,a=new Set,s=!0,o=!1,u=void 0;try{for(var l,c=function(){var e=l.value;a.add(e),a.add(ne.getBase(e));var t=G.filter(n.keys(),function(t){return ne.areSiblings(t,e)});t.sort();var r=!0,i=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value;a.add(c)}}catch(e){i=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw s}}var d=G.filter(n.keys(),function(t){return ne.getBase(t)==e});d.sort();var h=!0,f=!1,p=void 0;try{for(var m,v=d[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;a.add(y)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}},d=i[Symbol.iterator]();!(s=(l=d.next()).done);s=!0)c()}catch(e){o=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(o)throw u}}a.add(r);var h=[],f=!0,p=!1,m=void 0;try{for(var v,y=a[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value,_=n.get(g);_&&h.push(_)}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}h.reverse(),this.currentMap_.clear();for(var b=0,w=h;b<w.length;b++){w[b].forEach(function(e,n){t.currentMap_.set(n,e)})}var E=this.currentMap_.keys(),S=new Set,T=!0,k=!1,C=void 0;try{for(var I,A=this.currentLocales_[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){var x=I.value,L=this.localizations_.get(x)||new Map;e.findMissingKeys_(L,E,S)}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}if(S.size>0){var N={locales:Array.from(i),missing:Array.from(S)};this.events_.dispatchEvent(new D(e.MISSING_LOCALIZATIONS,N))}}}])&&re(t.prototype,n),r&&re(t,r),e}();function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ie.ConflictResolution={USE_OLD:0,USE_NEW:1},ie.UNKNOWN_LOCALES="unknown-locales",ie.UNKNOWN_LOCALIZATION="unknown-localization",ie.MISSING_LOCALIZATIONS="missing-localizations",ie.LOCALE_CHANGED="locale-changed",ie.LOCALE_UPDATED="locale-updated",ie.UnknownLocalesEvent,ie.UnknownLocalizationEvent,ie.MissingLocalizationsEvent;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var se=c.util.Dom,oe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getFirstDescendantWithClassName",value:function(t,n){return e.getDescendantIfExists(t,n)}},{key:"getDescendantIfExists",value:function(e,t){var n=e.getElementsByClassName(t);return n.length?n[0]:null}},{key:"focusOnTheChosenItem",value:function(t){if(t){var n=e.getDescendantIfExists(t,"shaka-chosen-item");n&&n.parentElement.focus()}}},{key:"checkmarkIcon",value:function(){var e=se.createHTMLElement("i");return e.classList.add("material-icons"),e.classList.add("shaka-chosen-item"),e.textContent=R.MaterialDesignIcons.CHECKMARK,e.setAttribute("aria-hidden","true"),e}},{key:"setDisplay",value:function(e,t){e&&(t?(e.classList.add("shaka-displayed"),e.classList.remove("shaka-hidden")):(e.classList.add("shaka-hidden"),e.classList.remove("shaka-displayed")))}}],(n=null)&&ae(t.prototype,n),r&&ae(t,r),e}();
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t,n){return t&&le(e.prototype,t),n&&le(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var de=function(){function e(){ue(this,e),this.bindingMap_=new B}return ce(e,[{key:"release",value:function(){this.removeAll(),this.bindingMap_=null}},{key:"listen",value:function(t,n,r,i){if(this.bindingMap_){var a=new e.Binding_(t,n,r,i);this.bindingMap_.push(n,a)}}},{key:"listenOnce",value:function(e,t,n,r){var i=this;this.listen(e,t,function r(a){i.unlisten(e,t,r),n(a)},r)}},{key:"unlisten",value:function(e,t,n){if(this.bindingMap_){var r=this.bindingMap_.get(t)||[],i=!0,a=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;l.target===e&&(n!==l.listener&&n||(l.unlisten(),this.bindingMap_.remove(t,l)))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}}}},{key:"removeAll",value:function(){if(this.bindingMap_){var e=this.bindingMap_.getAll(),t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.unlisten()}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.bindingMap_.clear()}}}]),e}();de.ListenerType=null,de.Binding_=function(){function e(t,n,r,i){ue(this,e),this.target=t,this.type=n,this.listener=r,this.options=de.Binding_.convertOptions_(t,i),this.target.addEventListener(n,r,this.options)}return ce(e,[{key:"unlisten",value:function(){window.asserts.assert(this.target,"Missing target"),this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=!1}}],[{key:"convertOptions_",value:function(e,t){if(void 0===t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]),r=Object.keys(t).filter(function(e){return!n.has(e)});return window.asserts.assert(0===r.length,"Unsupported flag(s) to addEventListener: "+r.join(",")),de.Binding_.doesSupportObject_(e)?t:t.capture||!1}},{key:"doesSupportObject_",value:function(e){var t=de.Binding_.supportsObject_;if(void 0===t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r);var i=function(){};e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}de.Binding_.supportsObject_=t}return t||!1}}]),e}(),de.Binding_.supportsObject_=void 0;var he=de;function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var pe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onTick_=t,this.cancelPending_=null}var t,n,r;return t=e,(n=[{key:"tickAfter",value:function(e){var t=this;this.stop();var n=!0,r=null;this.cancelPending_=function(){window.clearTimeout(r),n=!1};return r=window.setTimeout(function(){n&&t.onTick_()},1e3*e),this}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}])&&fe(t.prototype,n),r&&fe(t,r),e}();function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ve=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onTick_=t,this.ticker_=null}var t,n,r;return t=e,(n=[{key:"tickNow",value:function(){return this.stop(),this.onTick_(),this}},{key:"tickAfter",value:function(e){var t=this;return this.stop(),this.ticker_=new pe(function(){t.onTick_()}).tickAfter(e),this}},{key:"tickEvery",value:function(e){var t=this;return this.stop(),this.ticker_=new pe(function(){t.ticker_.tickAfter(e),t.onTick_()}).tickAfter(e),this}},{key:"stop",value:function(){this.ticker_&&(this.ticker_.stop(),this.ticker_=null)}}])&&me(t.prototype,n),r&&me(t,r),e}();function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var _e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"serialize",value:function(t){return JSON.stringify(t,function(t,n){if("function"!=typeof n){if(n instanceof Event||n instanceof D){var r={};for(var i in n){var a=n[i];a&&"object"==ye(a)?"detail"==i&&(r[i]=a):i in Event||(r[i]=a)}return r}return n instanceof TimeRanges?e.unpackTimeRanges_(n):n instanceof Uint8Array?e.unpackUint8Array_(n):"number"==typeof n?isNaN(n)?"NaN":isFinite(n)?n:n<0?"-Infinity":"Infinity":n}})}},{key:"deserialize",value:function(t){return JSON.parse(t,function(t,n){return"NaN"==n?NaN:"-Infinity"==n?-1/0:"Infinity"==n?1/0:n&&"object"==ye(n)&&"TimeRanges"==n.__type__?e.simulateTimeRanges_(n):n&&"object"==ye(n)&&"Uint8Array"==n.__type__?e.makeUint8Array_(n):n})}},{key:"unpackTimeRanges_",value:function(e){for(var t={__type__:"TimeRanges",length:e.length,start:[],end:[]},n=0;n<e.length;++n)t.start.push(e.start(n)),t.end.push(e.end(n));return t}},{key:"simulateTimeRanges_",value:function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}},{key:"unpackUint8Array_",value:function(e){return{__type__:"Uint8Array",entries:Array.from(e)}}},{key:"makeUint8Array_",value:function(e){return new Uint8Array(e.entries)}}],(n=null)&&ge(t.prototype,n),r&&ge(t,r),e}();function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}_e.VideoEvents=["ended","play","playing","pause","pausing","ratechange","seeked","seeking","timeupdate","volumechange"],_e.VideoAttributes=["buffered","currentTime","duration","ended","loop","muted","paused","playbackRate","seeking","videoHeight","videoWidth","volume"],_e.VideoInitStateAttributes=["loop","playbackRate"],_e.VideoVoidMethods=["pause","play"],_e.PlayerEvents=["abrstatuschanged","adaptation","buffering","emsg","error","loading","streaming","texttrackvisibility","timelineregionadded","timelineregionenter","timelineregionexit","trackschanged","unloading","variantchanged","textchanged"],_e.PlayerGetterMethods={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},_e.PlayerGetterMethodsThatRequireLive={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},_e.PlayerInitState=[["getConfiguration","configure"]],_e.PlayerInitAfterLoadState=[["isTextTrackVisible","setTextTrackVisibility"]],_e.PlayerVoidMethods=["addTextTrack","cancelTrickPlay","configure","resetConfiguration","retryStreaming","selectAudioLanguage","selectEmbeddedTextTrack","selectTextLanguage","selectTextTrack","selectVariantTrack","setTextTrackVisibility","trickPlay"],_e.PlayerPromiseMethods=["attach","detach","load","unload"],_e.InitStateType,_e.SHAKA_MESSAGE_NAMESPACE="urn:x-cast:com.google.shaka.v2",_e.GENERIC_MESSAGE_NAMESPACE="urn:x-cast:com.google.cast.media";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var we=function(){function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Promise(function(e,r){t=e,n=r});return r.resolve=t,r.reject=n,r}var t,n,r;return t=e,(n=[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}])&&be(t.prototype,n),r&&be(t,r),e}();function Ee(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Te=window.shaka,ke=function(){function e(t,n,r,i,a,s){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.receiverAppId_=t,this.statusChangeTimer_=new ve(n),this.onFirstCastStateUpdate_=r,this.hasJoinedExistingSession_=!1,this.onRemoteEvent_=i,this.onResumeLocal_=a,this.onInitStateRequired_=s,this.apiReady_=!1,this.isCasting_=!1,this.receiverName_="",this.appData_=null,this.onConnectionStatusChangedBound_=function(){return o.onConnectionStatusChanged_()},this.onMessageReceivedBound_=function(e,t){return o.onMessageReceived_(e,t)},this.cachedProperties_={video:{},player:{}},this.nextAsyncCallId_=0,this.asyncCallPromises_={},this.castPromise_=null,e.instances_.add(this)}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return e.instances_.delete(this),this.rejectAllPromises_(),e.session_&&this.removeListeners_(),this.statusChangeTimer_&&(this.statusChangeTimer_.stop(),this.statusChangeTimer_=null),this.onRemoteEvent_=null,this.onResumeLocal_=null,this.apiReady_=!1,this.isCasting_=!1,this.appData_=null,this.cachedProperties_=null,this.asyncCallPromises_=null,this.castPromise_=null,this.onConnectionStatusChangedBound_=null,this.onMessageReceivedBound_=null,Promise.resolve()}},{key:"apiReady",value:function(){return this.apiReady_}},{key:"hasReceivers",value:function(){return e.hasReceivers_}},{key:"isCasting",value:function(){return this.isCasting_}},{key:"receiverName",value:function(){return this.receiverName_}},{key:"hasRemoteProperties",value:function(){return 0!=Object.keys(this.cachedProperties_.video).length}},{key:"init",value:function(){var t=this;if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.apiReady_=!0,this.statusChangeTimer_.tickNow();var n=new chrome.cast.SessionRequest(this.receiverAppId_),r=new chrome.cast.ApiConfig(n,function(e){return t.onExistingSessionJoined_(e)},function(e){return t.onReceiverStatusChanged_(e)},"origin_scoped");chrome.cast.initialize(r,function(){Te.log.debug("CastSender: init")},function(e){Te.log.error("CastSender: init error",e)}),e.hasReceivers_&&this.statusChangeTimer_.tickAfter(e.STATUS_DELAY);var i=e.session_;i&&i.status!=chrome.cast.SessionStatus.STOPPED?(Te.log.debug("CastSender: re-using existing connection"),this.onExistingSessionJoined_(i)):e.session_=null}}},{key:"setAppData",value:function(e){this.appData_=e,this.isCasting_&&this.sendMessage_({type:"appData",appData:this.appData_})}},{key:"cast",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(n){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.apiReady_){t.next=2;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.CAST_API_UNAVAILABLE);case 2:if(e.hasReceivers_){t.next=4;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.NO_CAST_RECEIVERS);case 4:if(!this.isCasting_){t.next=6;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.ALREADY_CASTING);case 6:return this.castPromise_=new we,chrome.cast.requestSession(function(e){return r.onSessionInitiated_(n,e)},function(e){return r.onConnectionError_(e)}),t.next=10,this.castPromise_;case 10:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){Ee(a,r,i,s,o,"next",e)}function o(e){Ee(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return n.apply(this,arguments)}}()},{key:"showDisconnectDialog",value:function(){var e=this;if(this.isCasting_){var t=this.onInitStateRequired_();chrome.cast.requestSession(function(n){return e.onSessionInitiated_(t,n)},function(t){return e.onConnectionError_(t)})}}},{key:"forceDisconnect",value:function(){this.isCasting_&&(this.rejectAllPromises_(),e.session_&&(this.removeListeners_(),e.session_.stop(function(){},function(){}),e.session_=null))}},{key:"get",value:function(e,t){var n=this;window.asserts.assert("video"==e||"player"==e,"Unexpected target name");var r=r;if("video"==e){if(r.VideoVoidMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteCall_.apply(n,[e,t].concat(i))}}else if("player"==e){if(r.PlayerGetterMethodsThatRequireLive[t]){var i=this.get("player","isLive")();if(window.asserts.assert(i,t+" should be called on a live stream!"),!i)return function(){}}if(r.PlayerVoidMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteCall_.apply(n,[e,t].concat(i))};if(r.PlayerPromiseMethods.includes(t))return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.remoteAsyncCall_.apply(n,[e,t].concat(i))};if(r.PlayerGetterMethods[t])return function(){return n.propertyGetter_(e,t)}}return this.propertyGetter_(e,t)}},{key:"set",value:function(e,t,n){window.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]=n,this.sendMessage_({type:"set",targetName:e,property:t,value:n})}},{key:"onSessionInitiated_",value:function(e,t){Te.log.debug("CastSender: onSessionInitiated"),this.onSessionCreated_(t),this.sendMessage_({type:"init",initState:e,appData:this.appData_}),this.castPromise_.resolve()}},{key:"onConnectionError_",value:function(e){var t=Error.Code.UNEXPECTED_CAST_ERROR;switch(e.code){case"cancel":t=Error.Code.CAST_CANCELED_BY_USER;break;case"timeout":t=Error.Code.CAST_CONNECTION_TIMED_OUT;break;case"receiver_unavailable":t=Error.Code.CAST_RECEIVER_APP_UNAVAILABLE}this.castPromise_.reject(new Error(Error.Severity.CRITICAL,Error.Category.CAST,t,e))}},{key:"propertyGetter_",value:function(e,t){return window.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]}},{key:"remoteCall_",value:function(e,t){window.asserts.assert("video"==e||"player"==e,"Unexpected target name");for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];this.sendMessage_({type:"call",targetName:e,methodName:t,args:r})}},{key:"remoteAsyncCall_",value:function(e,t){window.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=new we,r=this.nextAsyncCallId_.toString();this.nextAsyncCallId_++,this.asyncCallPromises_[r]=n;for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];return this.sendMessage_({type:"asyncCall",targetName:e,methodName:t,args:a,id:r}),n}},{key:"onExistingSessionJoined_",value:function(e){Te.log.debug("CastSender: onExistingSessionJoined");var t=this.onInitStateRequired_();this.castPromise_=new we,this.hasJoinedExistingSession_=!0,this.onSessionInitiated_(t,e)}},{key:"onReceiverStatusChanged_",value:function(t){Te.log.debug("CastSender: receiver status",t),e.hasReceivers_="available"==t,this.statusChangeTimer_.tickNow()}},{key:"onSessionCreated_",value:function(t){e.session_=t,t.addUpdateListener(this.onConnectionStatusChangedBound_),t.addMessageListener(CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_),this.onConnectionStatusChanged_()}},{key:"removeListeners_",value:function(){var t=e.session_;t.removeUpdateListener(this.onConnectionStatusChangedBound_),t.removeMessageListener(CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_)}},{key:"onConnectionStatusChanged_",value:function(){var t=!!e.session_&&"connected"==e.session_.status;if(Te.log.debug("CastSender: connection status",t),this.isCasting_&&!t){for(var n in this.onResumeLocal_(),this.cachedProperties_)this.cachedProperties_[n]={};this.rejectAllPromises_()}this.isCasting_=t,this.receiverName_=t?e.session_.receiver.friendlyName:"",this.statusChangeTimer_.tickNow()}},{key:"rejectAllPromises_",value:function(){for(var e in this.asyncCallPromises_){var t=this.asyncCallPromises_[e];delete this.asyncCallPromises_[e],t.reject(new Error(Error.Severity.RECOVERABLE,Error.Category.PLAYER,Error.Code.LOAD_INTERRUPTED))}}},{key:"onMessageReceived_",value:function(e,t){var n=CastUtils.deserialize(t);switch(Te.log.v2("CastSender: message",n),n.type){case"event":var r=n.targetName,i=n.event,a=new D(i.type,i);this.onRemoteEvent_(r,a);break;case"update":var s=n.update;for(var o in s){var u=this.cachedProperties_[o]||{};for(var l in s[o])u[l]=s[o][l]}this.hasJoinedExistingSession_&&(this.onFirstCastStateUpdate_(),this.hasJoinedExistingSession_=!1);break;case"asyncComplete":var c=n.id,d=n.error,h=this.asyncCallPromises_[c];if(delete this.asyncCallPromises_[c],window.asserts.assert(h,"Unexpected async id"),!h)break;if(d){var f=new Error(d.severity,d.category,d.code);for(var p in d)f[p]=d[p];h.reject(f)}else h.resolve()}}},{key:"sendMessage_",value:function(t){var n=CastUtils.serialize(t);e.session_.sendMessage(CastUtils.SHAKA_MESSAGE_NAMESPACE,n,function(){},Te.log.error)}}])&&Se(t.prototype,n),r&&Se(t,r),e}();function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ae(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ie(a,r,i,s,o,"next",e)}function o(e){Ie(a,r,i,s,o,"throw",e)}s(void 0)})}}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return!t||"object"!==Ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ke.STATUS_DELAY=.02,ke.hasReceivers_=!1,ke.session_=null,ke.instances_=new Set,ke.onSdkLoaded_=function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var i,a=ke.instances_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.init()}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},window.__onGCastApiAvailable=ke.onSdkLoaded_;var Me=window.shaka,Pe=(window.goog,function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Le(this,Ne(t).call(this))).localVideo_=e,i.localPlayer_=n,i.videoProxy_=null,i.playerProxy_=null,i.videoEventTarget_=null,i.playerEventTarget_=null,i.eventManager_=null,i.receiverAppId_=r,i.receiverAppId_&&(i.sender_=new ke(r,function(){return i.onCastStatusChanged_()},function(){return i.onFirstCastStateUpdate_()},function(e,t){return i.onRemoteEvent_(e,t)},function(){return i.onResumeLocal_()},function(){return i.getInitState_()})),i.init_(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,H),n=t,(r=[{key:"destroy",value:function(e){e&&this.sender_&&this.sender_.forceDisconnect(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null);var t=[];return this.localPlayer_&&(t.push(this.localPlayer_.destroy()),this.localPlayer_=null),this.sender_&&(t.push(this.sender_.destroy()),this.sender_=null),this.localVideo_=null,this.videoProxy_=null,this.playerProxy_=null,Promise.all(t)}},{key:"getVideo",value:function(){return this.videoProxy_}},{key:"getPlayer",value:function(){return this.playerProxy_}},{key:"canCast",value:function(){return!!this.sender_&&(this.sender_.apiReady()&&this.sender_.hasReceivers())}},{key:"isCasting",value:function(){return!!this.sender_&&this.sender_.isCasting()}},{key:"receiverName",value:function(){return this.sender_?this.sender_.receiverName():""}},{key:"cast",value:function(){var e=Ae(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender_){e.next=2;break}throw new Error(Error.Severity.RECOVERABLE,Error.Category.CAST,Error.Code.CAST_RECEIVER_APP_ID_MISSING);case 2:return t=this.getInitState_(),e.next=5,this.sender_.cast(t);case 5:if(this.localPlayer_){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.localPlayer_.unload();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setAppData",value:function(e){this.sender_&&this.sender_.setAppData(e)}},{key:"suggestDisconnect",value:function(){this.sender_&&this.sender_.showDisconnectDialog()}},{key:"forceDisconnect",value:function(){this.sender_&&this.sender_.forceDisconnect()}},{key:"changeReceiverId",value:function(){var e=Ae(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!=this.receiverAppId_){e.next=2;break}return e.abrupt("return");case 2:if(this.receiverAppId_=t,!this.sender_){e.next=8;break}return this.sender_.forceDisconnect(),e.next=7,this.sender_.destroy();case 7:this.sender_=null;case 8:this.sender_=new ke(t,function(){return n.onCastStatusChanged_()},function(){return n.onFirstCastStateUpdate_()},function(e,t){return n.onRemoteEvent_(e,t)},function(){return n.onResumeLocal_()},function(){return n.getInitState_()}),this.sender_.init();case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"init_",value:function(){var e=this;this.sender_&&this.sender_.init(),this.eventManager_=new he;var t=!0,n=!1,r=void 0;try{for(var i,a=_e.VideoEvents[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.eventManager_.listen(this.localVideo_,s,function(t){return e.videoProxyLocalEvent_(t)})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,u=!1,l=void 0;try{for(var c,d=_e.PlayerEvents[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;this.eventManager_.listen(this.localPlayer_,h,function(t){return e.playerProxyLocalEvent_(t)})}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}this.videoProxy_={};var f=function(t){Object.defineProperty(e.videoProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.videoProxyGet_(t)},set:function(n){return e.videoProxySet_(t,n)}})};for(var p in this.localVideo_)f(p);this.playerProxy_={},this.iterateOverPlayerMethods_(function(t,n){window.asserts.assert(e.playerProxy_,"Must have player proxy!"),Object.defineProperty(e.playerProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.playerProxyGet_(t)}})}),this.videoEventTarget_=new H,this.videoEventTarget_.dispatchTarget=this.videoProxy_,this.playerEventTarget_=new H,this.playerEventTarget_.dispatchTarget=this.playerProxy_}},{key:"iterateOverPlayerMethods_",value:function(e){window.asserts.assert(this.localPlayer_,"Must have player!");var t=this.localPlayer_,n=new Set;for(var r in t)n.has(r)||(n.add(r),e(r,t[r]));for(var i=Object.getPrototypeOf(t),a=Object.getPrototypeOf({});i&&i!=a;){var s=!0,o=!1,u=void 0;try{for(var l,c=Object.getOwnPropertyNames(i)[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;if(!d.endsWith("_")&&"constructor"!=d){var h=t[d];"function"==typeof h&&(n.has(d)||(n.add(d),e(d,h)))}}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}i=Object.getPrototypeOf(i)}}},{key:"getInitState_",value:function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.localPlayer_.getAssetUri(),startTime:null};this.localVideo_.pause();var t=!0,n=!1,r=void 0;try{for(var i,a=_e.VideoInitStateAttributes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.video[s]=this.localVideo_[s]}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.localVideo_.ended||(e.startTime=this.localVideo_.currentTime);var o=!0,u=!1,l=void 0;try{for(var c,d=_e.PlayerInitState[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=h[0],p=h[1],m=this.localPlayer_[f]();e.player[p]=m}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}var v=!0,y=!1,g=void 0;try{for(var _,b=_e.PlayerInitAfterLoadState[Symbol.iterator]();!(v=(_=b.next()).done);v=!0){var w=_.value,E=w[0],S=w[1],T=this.localPlayer_[E]();e.playerAfterLoad[S]=T}}catch(e){y=!0,g=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}return e}},{key:"onCastStatusChanged_",value:function(){var e=new D("caststatuschanged");this.dispatchEvent(e)}},{key:"onFirstCastStateUpdate_",value:function(){var e=this.videoProxy_.paused?"pause":"play",t=new D(e);this.videoEventTarget_.dispatchEvent(t)}},{key:"onResumeLocal_",value:function(){var e=this;window.asserts.assert(this.sender_,"Cast sender should not be null!");var t=!0,n=!1,r=void 0;try{for(var i,a=_e.PlayerInitState[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s[0],u=s[1],l=this.sender_.get("player",o)();this.localPlayer_[u](l)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var c=this.sender_.get("player","getAssetUri")(),d=this.sender_.get("video","ended"),h=Promise.resolve(),f=this.localVideo_.autoplay,p=null;d||(p=this.sender_.get("video","currentTime")),c&&(this.localVideo_.autoplay=!1,h=this.localPlayer_.load(c,p));var m={},v=!0,y=!1,g=void 0;try{for(var _,b=_e.VideoInitStateAttributes[Symbol.iterator]();!(v=(_=b.next()).done);v=!0){var w=_.value;m[w]=this.sender_.get("video",w)}}catch(e){y=!0,g=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}h.then(function(){if(e.localVideo_){var t=!0,n=!1,r=void 0;try{for(var i,a=_e.VideoInitStateAttributes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.localVideo_[s]=m[s]}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,u=!1,l=void 0;try{for(var d,h=_e.PlayerInitAfterLoadState[Symbol.iterator]();!(o=(d=h.next()).done);o=!0){var p=d.value,v=p[0],y=p[1],g=e.sender_.get("player",v)();e.localPlayer_[y](g)}}catch(e){u=!0,l=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw l}}e.localVideo_.autoplay=f,c&&e.localVideo_.play()}},function(t){window.asserts.assert(t instanceof Error,"Wrong error type!");var n=new D("error",{detail:t});e.localPlayer_.dispatchEvent(n)})}},{key:"videoProxyGet_",value:function(e){var t=this;if("addEventListener"==e)return function(e,n,r){return t.videoEventTarget_.addEventListener(e,n,r)};if("removeEventListener"==e)return function(e,n,r){return t.videoEventTarget_.removeEventListener(e,n,r)};if(this.sender_&&this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()){var n=this.localVideo_[e];if("function"!=typeof n)return n}if(!this.sender_||!this.sender_.isCasting()){var r=this.localVideo_[e];return"function"==typeof r&&(r=r.bind(this.localVideo_)),r}return this.sender_.get("video",e)}},{key:"videoProxySet_",value:function(e,t){this.sender_&&this.sender_.isCasting()?this.sender_.set("video",e,t):this.localVideo_[e]=t}},{key:"videoProxyLocalEvent_",value:function(e){if(!this.sender_||!this.sender_.isCasting()){var t=new D(e.type,e);this.videoEventTarget_.dispatchEvent(t)}}},{key:"playerProxyGet_",value:function(e){var t=this;if("addEventListener"==e)return function(e,n,r){return t.playerEventTarget_.addEventListener(e,n,r)};if("removeEventListener"==e)return function(e,n,r){return t.playerEventTarget_.removeEventListener(e,n,r)};if("getMediaElement"==e)return function(){return t.videoProxy_};if("getSharedConfiguration"==e)return Me.log.warning("Can't share configuration across a network. Returning copy."),this.sender_?this.sender_.get("player","getConfiguration"):this.localPlayer_.getConfiguration();if("getNetworkingEngine"==e)return this.sender_.isCasting()&&Me.log.warning("NOTE: getNetworkingEngine() is always local!"),function(){return t.localPlayer_.getNetworkingEngine()};if(this.sender_&&this.sender_.isCasting()){if("getManifest"==e||"drmInfo"==e)return function(){return Me.log.alwaysWarn(e+"() does not work while casting!"),null};if("getManifestUri"==e)return Me.Deprecate.deprecateFeature(2,6,"getManifestUri",'Please use "getAssetUri" instead.'),this.playerProxyGet_("getAssetUri");if("attach"==e||"detach"==e)return function(){return Me.log.alwaysWarn(e+"() does not work while casting!"),Promise.resolve()}}if(this.sender_&&this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()&&_e.PlayerGetterMethods[e]){var n=this.localPlayer_[e];return window.asserts.assert("function"==typeof n,"only methods on Player"),n.bind(this.localPlayer_)}if(!this.sender_||!this.sender_.isCasting()){var r=this.localPlayer_[e];return window.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_)}return this.sender_.get("player",e)}},{key:"playerProxyLocalEvent_",value:function(e){this.sender_&&this.sender_.isCasting()||this.playerEventTarget_.dispatchEvent(e)}},{key:"onRemoteEvent_",value:function(e,t){window.asserts.assert(this.sender_&&this.sender_.isCasting(),"Should only receive remote events while casting"),this.sender_.isCasting()&&("video"==e?this.videoEventTarget_.dispatchEvent(t):"player"==e&&this.playerEventTarget_.dispatchEvent(t))}}])&&xe(n.prototype,r),i&&xe(n,i),t}());function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je=c.util.Dom;window.shaka=window.shaka||{};var He=window.shaka;window.goog=window.goog||{};window.goog;var Ke=function(e){function t(e,n,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Fe(this,Be(t).call(this))).enabled_=!0,a.overrideCssShowControls_=!1,a.config_=i,a.castProxy_=new Pe(r,e,a.config_.castReceiverAppId),a.castAllowed_=!0,a.video_=a.castProxy_.getVideo(),a.localVideo_=r,a.player_=a.castProxy_.getPlayer(),a.localPlayer_=e,a.videoContainer_=n,a.isSeeking_=!1,a.seekTimer_=new ve(function(){window.asserts.assert(null!=a.seekBar_,"Seekbar should not be null!"),a.video_.currentTime=parseFloat(a.seekBar_.value)}),a.mouseStillTimer_=new ve(function(){a.onMouseStill_()}),a.hideSettingsMenusTimer_=new ve(function(){var e,t=!0,n=!1,r=void 0;try{for(var i,s=a.settingsMenus_[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;e=o,oe.setDisplay(e,!1)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}),a.timeAndSeekRangeTimer_=new ve(function(){a.updateTimeAndSeekRange_()}),a.lastTouchEventTime_=null,a.elements_=[],a.localization_=t.createLocalization_(),a.eventManager_=new he,a.configure(a.config_),a.updateLocalizedStrings_(),a.pressedKeys_=new Set,a.onCastStatusChange_(),a.timeAndSeekRangeTimer_.tickEvery(.125),a}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,H),n=t,r=[{key:"destroy",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.seekTimer_&&(this.seekTimer_.stop(),this.seekTimer_=null),this.mouseStillTimer_&&(this.mouseStillTimer_.stop(),this.mouseStillTimer_=null),this.hideSettingsMenusTimer_&&(this.hideSettingsMenusTimer_.stop(),this.hideSettingsMenusTimer_=null),this.timeAndSeekRangeTimer_&&(this.timeAndSeekRangeTimer_.stop(),this.timeAndSeekRangeTimer_=null),!this.castProxy_){e.next=9;break}return e.next=8,this.castProxy_.destroy();case 8:this.castProxy_=null;case 9:if(!this.localPlayer_){e.next=13;break}return e.next=12,this.localPlayer_.destroy();case 12:this.localPlayer_=null;case 13:return this.player_=null,this.localVideo_=null,this.video_=null,this.localization_=null,this.pressedKeys_.clear(),e.next=20,Promise.all(this.elements_.map(function(e){return e.destroy()}));case 20:this.elements_=[];case 21:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){De(a,r,i,s,o,"next",e)}function o(e){De(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"allowCast",value:function(e){this.castAllowed_=e,this.onCastStatusChange_()}},{key:"loadComplete",value:function(){this.onPlayStateChange_()}},{key:"configure",value:function(e){this.config_=e,this.castProxy_.changeReceiverId(e.castReceiverAppId),this.controlsContainer_?(je.removeAllChildren(this.controlsContainer_),this.videoContainer_.removeChild(this.spinnerContainer_)):this.addControlsContainer_(),this.createDOM_(),this.addEventListeners_()}},{key:"setEnabledShakaControls",value:function(e){this.enabled_=e,e?(oe.setDisplay(this.controlsContainer_,!0),oe.setDisplay(this.spinnerContainer_,this.player_.isBuffering()),this.video_.tabIndex=-1,this.video_.controls=!1):(oe.setDisplay(this.controlsContainer_,!1),oe.setDisplay(this.spinnerContainer_,!1)),this.onPlayStateChange_()}},{key:"setEnabledNativeControls",value:function(e){this.video_.controls=e,this.video_.tabIndex=e?0:-1,e&&this.setEnabledShakaControls(!1)}},{key:"getCastProxy",value:function(){return this.castProxy_}},{key:"getLocalization",value:function(){return this.localization_}},{key:"getVideoContainer",value:function(){return this.videoContainer_}},{key:"getVideo",value:function(){return this.video_}},{key:"getLocalVideo",value:function(){return this.localVideo_}},{key:"getPlayer",value:function(){return this.player_}},{key:"getLocalPlayer",value:function(){return this.localPlayer_}},{key:"getControlsContainer",value:function(){return this.controlsContainer_}},{key:"getConfig",value:function(){return this.config_}},{key:"isSeeking",value:function(){return this.isSeeking_}},{key:"isCastAllowed",value:function(){return this.castAllowed_}},{key:"getDisplayTime",value:function(){return this.isSeeking_?Number(this.seekBar_.value):Number(this.video_.currentTime)}},{key:"setLastTouchEventTime",value:function(e){this.lastTouchEventTime_=e}},{key:"overrideCssShowControls",value:function(){this.overrideCssShowControls_=!0}},{key:"anySettingsMenusAreOpen",value:function(){return this.settingsMenus_.some(function(e){return e.classList.contains("shaka-displayed")})}},{key:"hideSettingsMenus",value:function(){this.hideSettingsMenusTimer_.tickNow()}},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.seekBar_&&this.seekBar_.setAttribute(L.ARIA_LABEL,this.localization_.resolve(e.SEEK));var t=this.video_.paused&&!this.isSeeking_?e.PLAY:e.PAUSE;this.playButton_.setAttribute(L.ARIA_LABEL,this.localization_.resolve(t))}},{key:"createDOM_",value:function(){if(this.seekBarContainer_=null,this.seekBar_=null,this.videoContainer_.classList.add("shaka-video-container"),this.video_.classList.add("shaka-video"),this.addPlayButton_(),this.addBufferingSpinner_(),this.addControlsButtonPanel_(),this.config_.addSeekBar&&this.addSeekBar_(),this.settingsMenus_=Array.from(this.videoContainer_.getElementsByClassName("shaka-settings-menu")),!this.seekBar_){var e=!0,t=!1,n=void 0;try{for(var r,i=this.settingsMenus_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.classList.add("shaka-low-position")}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}},{key:"addControlsContainer_",value:function(){var e=this;this.controlsContainer_=je.createHTMLElement("div"),this.controlsContainer_.classList.add("shaka-controls-container"),this.videoContainer_.appendChild(this.controlsContainer_),this.eventManager_.listen(this.controlsContainer_,"touchstart",function(t){e.onContainerTouch_(t)},{passive:!1}),this.eventManager_.listen(this.controlsContainer_,"click",function(){e.onContainerClick_()})}},{key:"addPlayButton_",value:function(){this.playButtonContainer_=je.createHTMLElement("div"),this.playButtonContainer_.classList.add("shaka-play-button-container"),this.controlsContainer_.appendChild(this.playButtonContainer_),this.playButton_=je.createHTMLElement("button"),this.playButton_.classList.add("shaka-play-button"),this.playButtonContainer_.appendChild(this.playButton_),this.onPlayStateChange_()}},{key:"addBufferingSpinner_",value:function(){this.spinnerContainer_=je.createHTMLElement("div"),this.spinnerContainer_.classList.add("shaka-spinner-container"),this.videoContainer_.appendChild(this.spinnerContainer_);var e=je.createHTMLElement("div");e.classList.add("shaka-spinner"),this.spinnerContainer_.appendChild(e);var t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("class","shaka-spinner-svg"),n.setAttribute("viewBox","0 0 30 30"),e.appendChild(n);var r=document.createElementNS(t,"circle");r.setAttribute("class","shaka-spinner-path"),r.setAttribute("cx","15"),r.setAttribute("cy","15"),r.setAttribute("r","14.5"),r.setAttribute("fill","none"),r.setAttribute("stroke-width","1"),r.setAttribute("stroke-miterlimit","10"),n.appendChild(r)}},{key:"addControlsButtonPanel_",value:function(){this.bottomControls_=je.createHTMLElement("div"),this.bottomControls_.classList.add("shaka-bottom-controls"),this.controlsContainer_.appendChild(this.bottomControls_),this.controlsButtonPanel_=je.createHTMLElement("div"),this.controlsButtonPanel_.classList.add("shaka-controls-button-panel"),this.controlsButtonPanel_.classList.add("shaka-no-propagation"),this.controlsButtonPanel_.classList.add("shaka-show-controls-on-mouse-over"),this.bottomControls_.appendChild(this.controlsButtonPanel_);for(var e=0;e<this.config_.controlPanelElements.length;e++){var t=this.config_.controlPanelElements[e];if(Ge.elementNamesToFactories_.get(t)){var n=Ge.elementNamesToFactories_.get(t);this.elements_.push(n.create(this.controlsButtonPanel_,this))}else He.log.alwaysWarn("Unrecognized control panel element requested:",t)}}},{key:"addEventListeners_",value:function(){var e=this;this.eventManager_.listen(this.player_,"buffering",function(){e.onBufferingStateChange_()}),this.onBufferingStateChange_(),this.eventManager_.listen(window,"keydown",function(t){return e.onKeyDown_(t)}),this.eventManager_.listen(this.video_,"play",function(){e.onPlayStateChange_()}),this.eventManager_.listen(this.video_,"pause",function(){e.onPlayStateChange_()}),this.eventManager_.listen(this.video_,"ended",function(){e.onPlayStateChange_()}),this.seekBar_&&(this.eventManager_.listen(this.seekBar_,"mousedown",function(){e.onSeekStart_()}),this.eventManager_.listen(this.seekBar_,"touchstart",function(){e.onSeekStart_()},{passive:!0}),this.eventManager_.listen(this.seekBar_,"input",function(){e.onSeekInput_()}),this.eventManager_.listen(this.seekBar_,"touchend",function(){e.onSeekEnd_()}),this.eventManager_.listen(this.seekBar_,"mouseup",function(){e.onSeekEnd_()}));var t=this.videoContainer_.getElementsByClassName("shaka-no-propagation"),n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;this.eventManager_.listen(o,"click",function(e){e.stopPropagation()})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var u=this.videoContainer_.getElementsByClassName("shaka-show-controls-on-mouse-over"),l=!0,c=!1,d=void 0;try{for(var h,f=u[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;this.eventManager_.listen(p,"mouseover",function(){e.overrideCssShowControls_=!0}),this.eventManager_.listen(p,"mouseleave",function(){e.overrideCssShowControls_=!1})}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}this.eventManager_.listen(this.videoContainer_,"mousemove",function(t){e.onMouseMove_(t)}),this.eventManager_.listen(this.videoContainer_,"touchmove",function(t){e.onMouseMove_(t)},{passive:!0}),this.eventManager_.listen(this.videoContainer_,"touchend",function(t){e.onMouseMove_(t)},{passive:!0}),this.eventManager_.listen(this.videoContainer_,"mouseleave",function(){e.onMouseLeave_()}),this.eventManager_.listen(this.controlsButtonPanel_,"click",function(){e.hideSettingsMenus()}),this.eventManager_.listen(this.castProxy_,"caststatuschanged",function(){e.onCastStatusChange_()}),this.eventManager_.listen(this.videoContainer_,"keyup",function(t){e.onKeyUp_(t)}),this.eventManager_.listen(this.localization_,ie.LOCALE_UPDATED,function(t){return e.updateLocalizedStrings_()}),this.eventManager_.listen(this.localization_,ie.LOCALE_CHANGED,function(t){return e.updateLocalizedStrings_()})}},{key:"addSeekBar_",value:function(){this.seekBarContainer_=je.createHTMLElement("div"),this.seekBarContainer_.classList.add("shaka-seek-bar-container"),this.seekBar_=document.createElement("input"),this.seekBar_.classList.add("shaka-seek-bar"),this.seekBar_.type="range",this.seekBar_.setAttribute("step","any"),this.seekBar_.setAttribute("min","0"),this.seekBar_.setAttribute("max","1"),this.seekBar_.value="0",this.seekBar_.classList.add("shaka-no-propagation"),this.seekBar_.classList.add("shaka-show-controls-on-mouse-over"),this.seekBarContainer_.appendChild(this.seekBar_),this.bottomControls_.appendChild(this.seekBarContainer_)}},{key:"onMouseMove_",value:function(e){"mousemove"==e.type&&this.controlsContainer_.classList.remove("shaka-keyboard-navigation"),"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"keyup"==e.type?this.lastTouchEventTime_=Date.now():this.lastTouchEventTime_+1e3<Date.now()&&(this.lastTouchEventTime_=null),this.lastTouchEventTime_&&"mousemove"==e.type||(this.videoContainer_.style.cursor="",this.hideSettingsMenusTimer_.stop(),this.setControlsOpacity_(R.Opacity.OPAQUE),this.updateTimeAndSeekRange_(),this.mouseStillTimer_.stop(),"touchend"!=e.type&&"keyup"!=e.type&&this.lastTouchEventTime_||this.mouseStillTimer_.tickAfter(3))}},{key:"onMouseLeave_",value:function(){this.lastTouchEventTime_||this.mouseStillTimer_.tickNow()}},{key:"onMouseStill_",value:function(){this.videoContainer_.style.cursor="none",this.video_.paused&&!this.isSeeking_||this.overrideCssShowControls_?this.setControlsOpacity_(R.Opacity.OPAQUE):this.setControlsOpacity_(R.Opacity.TRANSPARENT)}},{key:"onContainerTouch_",value:function(e){this.video_.duration&&(this.isOpaque_()?this.lastTouchEventTime_=Date.now():(this.onMouseMove_(e),e.preventDefault()))}},{key:"onContainerClick_",value:function(){this.enabled_&&(this.anySettingsMenusAreOpen()?this.hideSettingsMenusTimer_.tickNow():this.onPlayPauseClick_())}},{key:"onPlayPauseClick_",value:function(){this.enabled_&&this.video_.duration&&(this.player_.cancelTrickPlay(),this.video_.paused?this.video_.play():this.video_.pause())}},{key:"onCastStatusChange_",value:function(){var e=this.castProxy_.isCasting();this.dispatchEvent(new D("caststatuschanged",{newStatus:e})),e?this.controlsContainer_.setAttribute("casting","true"):this.controlsContainer_.removeAttribute("casting")}},{key:"onPlayStateChange_",value:function(){this.video_.ended&&!this.video_.paused&&this.video_.pause(),this.enabled_&&this.video_.paused&&!this.isSeeking_?(this.playButton_.setAttribute("icon","play"),this.playButton_.setAttribute(L.ARIA_LABEL,this.localization_.resolve(P.Ids.PLAY))):(this.playButton_.setAttribute("icon","pause"),this.playButton_.setAttribute(L.ARIA_LABEL,this.localization_.resolve(P.Ids.PAUSE)))}},{key:"onSeekStart_",value:function(){this.enabled_&&(this.isSeeking_=!0,this.video_.pause())}},{key:"onSeekInput_",value:function(){this.enabled_&&this.video_.duration&&(this.updateTimeAndSeekRange_(),this.seekTimer_.tickAfter(.125))}},{key:"onSeekEnd_",value:function(){this.enabled_&&(this.seekTimer_.tickNow(),this.isSeeking_=!1,this.video_.play())}},{key:"onKeyUp_",value:function(e){var t=e.key,n=document.activeElement,r=!(!n||!n.classList)&&n.classList.contains("shaka-volume-bar"),i=n&&n.classList&&n.classList.contains("shaka-seek-bar");switch(this.controlsContainer_.contains(n)&&this.onMouseMove_(e),this.pressedKeys_.delete(e.keyCode),t){case"ArrowLeft":r||this.seek_(this.video_.currentTime-5,e);break;case"ArrowRight":r||this.seek_(this.video_.currentTime+5,e);break;case"Home":this.seek_(this.player_.seekRange().start,e);break;case"End":this.seek_(this.player_.seekRange().end,e);break;case" ":i&&this.onPlayPauseClick_()}}},{key:"onBufferingStateChange_",value:function(){this.enabled_&&oe.setDisplay(this.spinnerContainer_,this.player_.isBuffering())}},{key:"isOpaque_",value:function(){return!!this.enabled_&&(!(!this.castProxy_||!this.castProxy_.isCasting())||null!=this.controlsContainer_.getAttribute("shown"))}},{key:"seek_",value:function(e,t){this.video_.currentTime=e,this.updateTimeAndSeekRange_()}},{key:"updateTimeAndSeekRange_",value:function(){if(this.isOpaque_()){var e=this.isSeeking_?Number(this.seekBar_.value):Number(this.video_.currentTime),t=this.video_.buffered.length,n=t?this.video_.buffered.start(0):0,r=t?this.video_.buffered.end(t-1):0,i=this.player_.seekRange(),a=i.end-i.start;if(this.seekBar_&&(this.seekBar_.min=i.start,this.seekBar_.max=i.end),this.player_.isLive()){var s=Math.floor(i.end-e);e=Math.max(0,s),!this.isSeeking_&&this.seekBar_&&(this.seekBar_.value=i.end-e)}else!this.isSeeking_&&this.seekBar_&&(this.seekBar_.value=e);if(this.seekBar_){var o=this.player_.seekRange();if(o.end-o.start<L.MIN_SEEK_WINDOW_TO_SHOW_SEEKBAR){oe.setDisplay(this.seekBarContainer_,!1);var u=!0,l=!1,c=void 0;try{for(var d,h=this.settingsMenus_[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){d.value.classList.add("shaka-low-position")}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}else{oe.setDisplay(this.seekBarContainer_,!0);var f=!0,p=!1,m=void 0;try{for(var v,y=this.settingsMenus_[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){v.value.classList.remove("shaka-low-position")}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}var g=["to right"];if(0==t)g.push("#000 0%");else{var _=Math.max(n,o.start),b=Math.min(r,o.end),w=(_-o.start)/a||0,E=(b-o.start)/a||0,S=(e-o.start)/a||0;g.push(L.SEEK_BAR_BASE_COLOR+" "+100*w+"%"),g.push(L.SEEK_BAR_PLAYED_COLOR+" "+100*w+"%"),g.push(L.SEEK_BAR_PLAYED_COLOR+" "+100*S+"%"),g.push(L.SEEK_BAR_BUFFERED_COLOR+" "+100*S+"%"),g.push(L.SEEK_BAR_BUFFERED_COLOR+" "+100*E+"%"),g.push(L.SEEK_BAR_BASE_COLOR+" "+100*E+"%")}this.seekBarContainer_.style.background="linear-gradient("+g.join(",")+")"}}this.dispatchEvent(new D("timeandseekrangeupdated"))}}},{key:"onKeyDown_",value:function(e){var t=this;this.pressedKeys_.add(e.keyCode);var n=this.anySettingsMenusAreOpen();e.keyCode==L.KEYCODE_TAB&&(this.controlsContainer_.classList.add("shaka-keyboard-navigation"),this.eventManager_.listen(window,"mousedown",function(){return t.onMouseDown_()})),e.keyCode==L.KEYCODE_ESCAPE&&this.hideSettingsMenusTimer_.tickNow(),n&&this.pressedKeys_.has(L.KEYCODE_TAB)&&this.keepFocusInMenu_(e)}},{key:"keepFocusInMenu_",value:function(e){var t=this.settingsMenus_.filter(function(e){return e.classList.contains("shaka-displayed")})[0];if(t.childNodes.length){for(var n=t.firstElementChild;n&&n.classList.contains("shaka-hidden");)n=n.nextElementSibling;for(var r=t.lastElementChild;r&&r.classList.contains("shaka-hidden");)r=r.previousElementSibling;var i=document.activeElement;this.pressedKeys_.has(L.KEYCODE_SHIFT)?i==n&&(e.preventDefault(),r.focus()):i==r&&(e.preventDefault(),n.focus())}}},{key:"onMouseDown_",value:function(){var e=this;this.eventManager_.unlisten(window,"mousedown"),this.eventManager_.listen(window,"keydown",function(t){return e.onKeyDown_(t)})}},{key:"setControlsOpacity_",value:function(e){e==R.Opacity.OPAQUE?this.controlsContainer_.setAttribute("shown","true"):(this.controlsContainer_.removeAttribute("shown"),this.hideSettingsMenusTimer_.tickAfter(2))}}],i=[{key:"registerElement",value:function(e,t){Ge.elementNamesToFactories_.set(e,t)}},{key:"createLocalization_",value:function(){var e=new ie("en");return P.addTo(e),e.changeLocale(navigator.languages||[]),e}}],r&&Ue(n.prototype,r),i&&Ue(n,i),t}(),Ge={};function We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t,n){return t&&qe(e.prototype,t),n&&qe(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ge.elementNamesToFactories_=new Map;var Ye=function(){function e(t,n){We(this,e),this.parent=t,this.button_=document.createElement("button"),this.button_.classList.add("material-icons"),this.button_.classList.add("close-button"),this.button_.textContent="close",this.parent.appendChild(this.button_),this.button_.addEventListener("click",function(){document.fullscreenElement&&document.exitFullscreen(),document.pictureInPictureElement&&document.exitPictureInPicture(),Ga.unload()})}return ze(e,[{key:"destroy",value:function(){return Promise.resolve()}}]),e}();function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ye.Factory=function(){function e(){We(this,e)}return ze(e,[{key:"create",value:function(e,t){return new Ye(e,t)}}]),e}();
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $e=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.asserts.assert(t>0,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/t),this.estimate_=0,this.totalWeight_=0}var t,n,r;return t=e,(n=[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e),r=t*(1-n)+n*this.estimate_;isNaN(r)||(this.estimate_=r,this.totalWeight_+=e)}},{key:"getEstimate",value:function(){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}}])&&Xe(t.prototype,n),r&&Xe(t,r),e}();function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fast_=new $e(2),this.slow_=new $e(5),this.bytesSampled_=0,this.minTotalBytes_=128e3,this.minBytes_=16e3}var t,n,r;return t=e,(n=[{key:"sample",value:function(e,t){if(!(t<this.minBytes_)){var n=8e3*t/e,r=e/1e3;this.bytesSampled_+=t,this.fast_.sample(r,n),this.slow_.sample(r,n)}}},{key:"getBandwidthEstimate",value:function(e){return this.bytesSampled_<this.minTotalBytes_?e:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}},{key:"hasGoodEstimate",value:function(){return this.bytesSampled_>=this.minTotalBytes_}}])&&Qe(t.prototype,n),r&&Qe(t,r),e}();function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var et=new A,tt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.destroyed_=!1,this.waitOnDestroy_=new we,this.onDestroy_=t}var t,n,r;return t=e,r=[{key:"destroyedError",value:function(e){return new A(et.severity.CRITICAL,et.category.PLAYER,et.code.OBJECT_DESTROYED,e)}}],(n=[{key:"destroyed",value:function(){return this.destroyed_}},{key:"destroy",value:function(){var e=this;return this.destroyed_?this.waitOnDestroy_:(this.destroyed_=!0,this.onDestroy_().then(function(){e.waitOnDestroy_.resolve()},function(){e.waitOnDestroy_.resolve()}))}},{key:"ensureNotDestroyed",value:function(t){if(this.destroyed_)throw t&&t.code===et.code.OBJECT_DESTROYED?t:e.destroyedError(t)}}])&&Je(t.prototype,n),r&&Je(t,r),e}();
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"asMap",value:function(e){for(var t=new Map,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.set(i,e[i])}return t}},{key:"asObject",value:function(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}}],(n=null)&&nt(t.prototype,n),r&&nt(t,r),e}();function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var at=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getFullType",value:function(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}},{key:"getExtendedType",value:function(t){var n=[t.mimeType];return e.EXTENDED_MIME_PARAMETERS_.forEach(function(e,r){var i=t[r];i&&n.push(e+'="'+i+'"')}),n.join(";")}},{key:"splitCodecs",value:function(e){return e.split(",")}},{key:"getCodecBase",value:function(t){return e.getCodecParts_(t)[0]}},{key:"getCodecParts_",value:function(e){var t=e.split("."),n=t[0];return t.pop(),[n,t.join(".")]}}],(n=null)&&it(t.prototype,n),r&&it(t,r),e}();at.EXTENDED_MIME_PARAMETERS_=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),at.CLOSED_CAPTION_MIMETYPE="application/cea-608";var st=at;function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var ut=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"supportsMediaSource",value:function(){return!!window.MediaSource&&!!MediaSource.isTypeSupported}},{key:"supportsMediaType",value:function(t){return""!=e.anyMediaElement_().canPlayType(t)}},{key:"isEdge",value:function(){return e.userAgentContains_("Edge/")}},{key:"isIE",value:function(){return e.userAgentContains_("Trident/")}},{key:"isTizen",value:function(){return e.userAgentContains_("Tizen")}},{key:"isTizen3",value:function(){return e.userAgentContains_("Tizen 3")}},{key:"isWebOS",value:function(){return e.userAgentContains_("Web0S")}},{key:"isChromecast",value:function(){return e.userAgentContains_("CrKey")}},{key:"isChrome",value:function(){return e.userAgentContains_("Chrome")&&!e.isEdge()}},{key:"isApple",value:function(){return!!navigator.vendor&&navigator.vendor.includes("Apple")}},{key:"isMobile",value:function(){return/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)}},{key:"userAgentContains_",value:function(e){return(navigator.userAgent||"").includes(e)}},{key:"anyMediaElement_",value:function(){return e.cachedMediaElement_?e.cachedMediaElement_:(e.cacheExpirationTimer_||(e.cacheExpirationTimer_=new ve(function(){e.cachedMediaElement_=null})),e.cachedMediaElement_=document.querySelector("video")||document.querySelector("audio"),e.cachedMediaElement_||(e.cachedMediaElement_=document.createElement("video")),e.cacheExpirationTimer_.tickAfter(1),e.cachedMediaElement_)}}],(n=null)&&ot(t.prototype,n),r&&ot(t,r),e}();ut.cacheExpirationTimer_=null,ut.cachedMediaElement_=null;var lt=ut;function ct(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ht=window.shaka,ft=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fromUTF8",value:function(t){if(!t)return"";var n=new Uint8Array(t);239==n[0]&&187==n[1]&&191==n[2]&&(n=n.subarray(3));var r=e.fromCharCode(n),i=escape(r);try{return decodeURIComponent(i)}catch(e){throw new ht.util.Error(ht.util.Error.Severity.CRITICAL,ht.util.Error.Category.TEXT,ht.util.Error.Code.BAD_ENCODING)}}},{key:"fromUTF16",value:function(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw ht.log.error("Data has an incorrect length, must be even."),new ht.util.Error(ht.util.Error.Severity.CRITICAL,ht.util.Error.Category.TEXT,ht.util.Error.Code.BAD_ENCODING);var r;if(e instanceof ArrayBuffer)r=e;else{var i=new Uint8Array(e.byteLength);i.set(new Uint8Array(e)),r=i.buffer}for(var a=Math.floor(e.byteLength/2),s=new Uint16Array(a),o=new DataView(r),u=0;u<a;u++)s[u]=o.getUint16(2*u,t);return ht.util.StringUtils.fromCharCode(s)}},{key:"fromBytesAutoDetect",value:function(e){var t=ht.util.StringUtils,n=new Uint8Array(e);if(239==n[0]&&187==n[1]&&191==n[2])return t.fromUTF8(n);if(254==n[0]&&255==n[1])return t.fromUTF16(n.subarray(2),!1);if(255==n[0]&&254==n[1])return t.fromUTF16(n.subarray(2),!0);var r=function(e){return n.byteLength<=e||n[e]>=32&&n[e]<=126};if(ht.log.debug("Unable to find byte-order-mark, making an educated guess."),0==n[0]&&0==n[2])return t.fromUTF16(e,!1);if(0==n[1]&&0==n[3])return t.fromUTF16(e,!0);if(r(0)&&r(1)&&r(2)&&r(3))return t.fromUTF8(e);throw new ht.util.Error(ht.util.Error.Severity.CRITICAL,ht.util.Error.Category.TEXT,ht.util.Error.Code.UNABLE_TO_DETECT_ENCODING)}},{key:"toUTF8",value:function(e){for(var t=encodeURIComponent(e),n=unescape(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r.buffer}},{key:"toUTF16",value:function(e,t){for(var n=new Uint8Array(2*e.length),r=new DataView(n.buffer),i=0;i<e.length;++i){var a=e.charCodeAt(i);r.setUint16(2*i,a,t)}return n.buffer}},{key:"fromCharCode",value:function(t){if(!e.fromCharCodeImpl_)for(var n=function(t){if(function(e){try{var t=new Uint8Array(e),n=String.fromCharCode.apply(String,ct(t));return window.asserts.assert(n,"Should get value"),!0}catch(e){return!1}}(t))return e.fromCharCodeImpl_=function(e){for(var n="",r=0;r<e.length;r+=t){var i=e.subarray(r,r+t);n+=String.fromCharCode.apply(String,ct(i))}return n},"break"},r=65536;r>0;r/=2){if("break"===n(r))break}return window.asserts.assert(e.fromCharCodeImpl_,"Unable to create a fromCharCode method"),e.fromCharCodeImpl_(t)}}],(n=null)&&dt(t.prototype,n),r&&dt(t,r),e}());function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ft.fromCharCodeImpl_=null;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"toStandardBase64",value:function(e){var t=ft.fromCharCode(e);return btoa(t)}},{key:"toBase64",value:function(t,n){n=null==n||n;var r=e.toStandardBase64(t).replace(/\+/g,"-").replace(/\//g,"_");return n?r:r.replace(/[=]*$/,"")}},{key:"fromBase64",value:function(e){for(var t=window.atob(e.replace(/-/g,"+").replace(/_/g,"/")),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}},{key:"fromHex",value:function(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=window.parseInt(e.substr(n,2),16);return t}},{key:"toHex",value:function(e){for(var t="",n=0;n<e.length;++n){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t}},{key:"equal",value:function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0}},{key:"concat",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)e+=n[i].length;for(var a=new Uint8Array(e),s=0,o=0;o<n.length;++o)a.set(n[o],s),s+=n[o].length;return a}},{key:"toDataView",value:function(e){return e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength)}}],(n=null)&&pt(t.prototype,n),r&&pt(t,r),e}();function vt(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null}}function yt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function gt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){yt(a,r,i,s,o,"next",e)}function o(e){yt(a,r,i,s,o,"throw",e)}s(void 0)})}}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bt=c.net.NetworkingEngine,wt=new A,Et=window.shaka,St=(window.goog,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playerInterface_=t,this.supportedTypes_=new Set,this.mediaKeys_=null,this.video_=null,this.initialized_=!1,this.currentDrmInfo_=null,this.eventManager_=new he,this.activeSessions_=new Map,this.offlineSessionIds_=[],this.allSessionsLoaded_=new we,this.config_=null,this.onError_=function(e){n.allSessionsLoaded_.reject(e),t.onError(e)},this.keyStatusByKeyId_=new Map,this.announcedKeyStatusByKeyId_=new Map,this.keyStatusTimer_=new ve(function(){return n.processKeyStatusChanges_()}),this.usePersistentLicenses_=!1,this.mediaKeyMessageEvents_=[],this.initialRequestsSent_=!1,this.expirationTimer_=new ve(function(){n.pollExpiration_()}).tickEvery(1);this.allSessionsLoaded_.catch(function(){}),this.destroyer_=new tt(function(){return n.destroyNow_()})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"destroyNow_",value:function(){var t=gt(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.eventManager_.release(),this.eventManager_=null,this.allSessionsLoaded_.reject(),this.expirationTimer_.stop(),this.expirationTimer_=null,this.keyStatusTimer_.stop(),this.keyStatusTimer_=null,n=Array.from(this.activeSessions_.keys()),this.activeSessions_.clear(),t.next=11,Promise.all(n.map(function(t){return Promise.resolve().then(gt(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Et.log.v1("Closing session",t.sessionId),n.prev=1,n.next=4,e.closeSession_(t);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])})))}));case 11:if(!this.video_){t.next=21;break}return window.asserts.assert(!this.video_.src,"video src must be removed first!"),t.prev=13,t.next=16,this.video_.setMediaKeys(null);case 16:t.next=20;break;case 18:t.prev=18,t.t0=t.catch(13);case 20:this.video_=null;case 21:this.currentDrmInfo_=null,this.supportedTypes_.clear(),this.mediaKeys_=null,this.offlineSessionIds_=[],this.config_=null,this.onError_=function(){},this.playerInterface_=null;case 28:case"end":return t.stop()}},t,this,[[13,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"configure",value:function(e){this.config_=e}},{key:"initForStorage",value:function(e,t){return this.offlineSessionIds_=[],this.usePersistentLicenses_=t,this.init_(e)}},{key:"initForPlayback",value:function(e,t){return this.offlineSessionIds_=t,this.usePersistentLicenses_=t.length>0,this.init_(e)}},{key:"initForRemoval",value:function(e,t,n,r,i){var a=new Map;return a.set(e,{audioCapabilities:r,videoCapabilities:i,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e,drmInfos:[{keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:n,initData:null,keyIds:null}]}),this.queryMediaKeys_(a)}},{key:"init_",value:function(t){window.asserts.assert(this.config_,"DrmEngine configure() must be called before init()!");var n=t.some(function(e){return e.drmInfos.length>0});if(!n){var r=rt.asMap(this.config_.servers);e.replaceDrmInfo_(t,r)}var i=this.configureClearKey_();if(i){var a=!0,s=!1,o=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.drmInfos=[i]}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}}var c=!0,d=!1,h=void 0;try{for(var f,p=t[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=!0,y=!1,g=void 0;try{for(var _,b=m.drmInfos[Symbol.iterator]();!(v=(_=b.next()).done);v=!0){var w=_.value;e.fillInDrmInfoDefaults_(w,rt.asMap(this.config_.servers),rt.asMap(this.config_.advanced||{}))}}catch(e){y=!0,g=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var E=this.prepareMediaKeyConfigsForVariants_(t);if(!E.size)return this.initialized_=!0,Promise.resolve();var S=this.queryMediaKeys_(E);return n?S:S.catch(function(){})}},{key:"attach",value:function(){var e=gt(regeneratorRuntime.mark(function e(t){var n,r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaKeys_){e.next=3;break}return this.eventManager_.listenOnce(t,"encrypted",function(e){a.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO))}),e.abrupt("return");case 3:return this.video_=t,this.eventManager_.listenOnce(this.video_,"play",function(){return a.onPlay_()}),n=(n=this.video_.setMediaKeys(this.mediaKeys_)).catch(function(e){return Promise.reject(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_ATTACH_TO_VIDEO,e.message))}),r=this.setServerCertificate(),e.next=10,Promise.all([n,r]);case 10:this.destroyer_.ensureNotDestroyed(),this.createOrLoad(),this.currentDrmInfo_.initData.length||this.offlineSessionIds_.length||(i=function(e){return a.newInitData(e.initDataType,new Uint8Array(e.initData))},this.eventManager_.listen(this.video_,"encrypted",i));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setServerCertificate",value:function(){var e=gt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(this.initialized_,"Must call init() before setServerCertificate"),!(this.mediaKeys_&&this.currentDrmInfo_&&this.currentDrmInfo_.serverCertificate&&this.currentDrmInfo_.serverCertificate.length)){e.next=12;break}return e.prev=2,e.next=5,this.mediaKeys_.setServerCertificate(this.currentDrmInfo_.serverCertificate);case 5:e.sent||Et.log.warning("Server certificates are not supported by the key system.  The server certificate has been ignored."),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(2),new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.INVALID_SERVER_CERTIFICATE,e.t0.message);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"removeSession",value:function(){var e=gt(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.mediaKeys_,"Must call init() before removeSession"),e.next=3,this.loadOfflineSession_(t);case 3:if(n=e.sent){e.next=7;break}return Et.log.v2("Ignoring attempt to remove missing session",t),e.abrupt("return");case 7:return r=[],(i=this.activeSessions_.get(n))&&(i.updatePromise=new we,r.push(i.updatePromise)),Et.log.v2("Attempting to remove session",t),r.push(n.remove()),e.next=14,Promise.all(r);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createOrLoad",value:function(){var e=(this.currentDrmInfo_?this.currentDrmInfo_.initData:[])||[],t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.createTemporarySession_(s.initDataType,s.initData)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,u=!1,l=void 0;try{for(var c,d=this.offlineSessionIds_[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;this.loadOfflineSession_(h)}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}return e.length||this.offlineSessionIds_.length||this.allSessionsLoaded_.resolve(),this.allSessionsLoaded_}},{key:"newInitData",value:function(e,t){var n=this.activeSessions_.values(),r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;if(mt.equal(t,u.initData))return void Et.log.debug("Ignoring duplicate init data.")}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}this.createTemporarySession_(e,t)}},{key:"initialized",value:function(){return this.initialized_}},{key:"keySystem",value:function(){return this.currentDrmInfo_?this.currentDrmInfo_.keySystem:""}},{key:"willSupport",value:function(e){return!!lt.isEdge()||this.supportedTypes_.has(e)}},{key:"getSessionIds",value:function(){var e=this.activeSessions_.keys(),t=G.map(e,function(e){return e.sessionId});return Array.from(t)}},{key:"getExpiration",value:function(){var e=1/0,t=this.activeSessions_.keys(),n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;isNaN(o.expiration)||(e=Math.min(e,o.expiration))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e}},{key:"getDrmInfo",value:function(){return this.currentDrmInfo_}},{key:"getKeyStatuses",value:function(){return rt.asObject(this.announcedKeyStatusByKeyId_)}},{key:"prepareMediaKeyConfigsForVariants_",value:function(t){var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=!0,c=!1,d=void 0;try{for(var h,f=u.drmInfos[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;n.add(p)}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var m=!0,v=!1,y=void 0;try{for(var g,_=n[Symbol.iterator]();!(m=(g=_.next()).done);m=!0){var b=g.value;e.fillInDrmInfoDefaults_(b,rt.asMap(this.config_.servers),rt.asMap(this.config_.advanced||{}))}}catch(e){v=!0,y=e}finally{try{m||null==_.return||_.return()}finally{if(v)throw y}}var w=this.usePersistentLicenses_?"required":"optional",E=this.usePersistentLicenses_?["persistent-license"]:["temporary"],S=new Map,T=!0,k=!1,C=void 0;try{for(var I,A=n[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){var x=I.value,L={audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:w,sessionTypes:E,label:x.keySystem,drmInfos:[]};S.set(x.keySystem,L)}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}var N=!0,R=!1,M=void 0;try{for(var P,O=t[Symbol.iterator]();!(N=(P=O.next()).done);N=!0){var D=P.value,U=D.audio,F=D.video,B=U?st.getFullType(U.mimeType,U.codecs):"",V=F?st.getFullType(F.mimeType,F.codecs):"",j=!0,H=!1,K=void 0;try{for(var G,W=D.drmInfos[Symbol.iterator]();!(j=(G=W.next()).done);j=!0){var q=G.value,z=S.get(q.keySystem);if(window.asserts.assert(z,"Any missing configs should have be filled in before."),z.drmInfos.push(q),q.distinctiveIdentifierRequired&&(z.distinctiveIdentifier="required"),q.persistentStateRequired&&(z.persistentState="required"),U){var Y={robustness:q.audioRobustness||"",contentType:B};z.audioCapabilities.push(Y)}if(F){var X={robustness:q.videoRobustness||"",contentType:V};z.videoCapabilities.push(X)}}}catch(e){H=!0,K=e}finally{try{j||null==W.return||W.return()}finally{if(H)throw K}}}}catch(e){R=!0,M=e}finally{try{N||null==O.return||O.return()}finally{if(R)throw M}}return S}},{key:"queryMediaKeys_",value:function(){var t=gt(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,E,S,T,k,C,I,x,L,N,R,M,P,O,D;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=n.size||!n.has("")){t.next=2;break}throw new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.NO_RECOGNIZED_KEY_SYSTEMS);case 2:for(r=!0,i=!1,a=void 0,t.prev=5,s=n.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)0==(u=o.value).audioCapabilities.length&&delete u.audioCapabilities,0==u.videoCapabilities.length&&delete u.videoCapabilities;t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),i=!0,a=t.t0;case 13:t.prev=13,t.prev=14,r||null==s.return||s.return();case 16:if(t.prev=16,!i){t.next=19;break}throw a;case 19:return t.finish(16);case 20:return t.finish(13);case 21:c=0,d=[!0,!1];case 22:if(!(c<d.length)){t.next=67;break}h=d[c],f=!0,p=!1,m=void 0,t.prev=27,v=n.keys()[Symbol.iterator]();case 29:if(f=(y=v.next()).done){t.next=48;break}if(g=y.value,_=n.get(g),_.drmInfos.some(function(e){return!!e.licenseServerUri})==h){t.next=35;break}return t.abrupt("continue",45);case 35:return t.prev=35,t.next=38,navigator.requestMediaKeySystemAccess(g,[_]);case 38:return l=t.sent,t.abrupt("break",48);case 42:t.prev=42,t.t1=t.catch(35);case 44:this.destroyer_.ensureNotDestroyed();case 45:f=!0,t.next=29;break;case 48:t.next=54;break;case 50:t.prev=50,t.t2=t.catch(27),p=!0,m=t.t2;case 54:t.prev=54,t.prev=55,f||null==v.return||v.return();case 57:if(t.prev=57,!p){t.next=60;break}throw m;case 60:return t.finish(57);case 61:return t.finish(54);case 62:if(!l){t.next=64;break}return t.abrupt("break",67);case 64:c++,t.next=22;break;case 67:if(l){t.next=69;break}throw new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE);case 69:for(this.destroyer_.ensureNotDestroyed(),t.prev=70,this.supportedTypes_.clear(),b=l.getConfiguration(),w=b.audioCapabilities||[],E=b.videoCapabilities||[],S=!0,T=!1,k=void 0,t.prev=78,C=w[Symbol.iterator]();!(S=(I=C.next()).done);S=!0)x=I.value,this.supportedTypes_.add(x.contentType);t.next=86;break;case 82:t.prev=82,t.t3=t.catch(78),T=!0,k=t.t3;case 86:t.prev=86,t.prev=87,S||null==C.return||C.return();case 89:if(t.prev=89,!T){t.next=92;break}throw k;case 92:return t.finish(89);case 93:return t.finish(86);case 94:for(L=!0,N=!1,R=void 0,t.prev=97,M=E[Symbol.iterator]();!(L=(P=M.next()).done);L=!0)O=P.value,this.supportedTypes_.add(O.contentType);t.next=105;break;case 101:t.prev=101,t.t4=t.catch(97),N=!0,R=t.t4;case 105:t.prev=105,t.prev=106,L||null==M.return||M.return();case 108:if(t.prev=108,!N){t.next=111;break}throw R;case 111:return t.finish(108);case 112:return t.finish(105);case 113:if(window.asserts.assert(this.supportedTypes_.size,"We should get at least one supported MIME type"),this.currentDrmInfo_=e.createDrmInfoFor_(l.keySystem,n.get(l.keySystem)),this.currentDrmInfo_.licenseServerUri){t.next=117;break}throw new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.NO_LICENSE_SERVER_GIVEN,this.currentDrmInfo_.keySystem);case 117:return t.next=119,l.createMediaKeys();case 119:D=t.sent,this.destroyer_.ensureNotDestroyed(),Et.log.info("Created MediaKeys object for key system",this.currentDrmInfo_.keySystem),this.mediaKeys_=D,this.initialized_=!0,t.next=134;break;case 126:if(t.prev=126,t.t5=t.catch(70),this.destroyer_.ensureNotDestroyed(t.t5),this.currentDrmInfo_=null,this.supportedTypes_.clear(),!(t.t5 instanceof A)){t.next=133;break}throw t.t5;case 133:throw new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_CREATE_CDM,t.t5.message);case 134:case"end":return t.stop()}},t,this,[[5,9,13,21],[14,,16,20],[27,50,54,62],[35,42],[55,,57,61],[70,126],[78,82,86,94],[87,,89,93],[97,101,105,113],[106,,108,112]])}));return function(e){return t.apply(this,arguments)}}()},{key:"configureClearKey_",value:function(){var e=rt.asMap(this.config_.clearKeys);if(0==e.size)return null;var t=[],n=[];e.forEach(function(e,r){var i=mt.fromHex(r),a=mt.fromHex(e),s={kty:"oct",kid:mt.toBase64(i,!1),k:mt.toBase64(a,!1)};t.push(s),n.push(s.kid)});var r={keys:t},i=JSON.stringify(r),a=JSON.stringify({kids:n}),s=[{initData:new Uint8Array(ft.toUTF8(a)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(i),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:s,keyIds:[]}}},{key:"loadOfflineSession_",value:function(){var e=gt(regeneratorRuntime.mark(function e(t){var n,r,i,a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,Et.log.v1("Attempting to load an offline session",t),n=this.mediaKeys_.createSession("persistent-license"),e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),r=new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_CREATE_SESSION,e.t0.message),this.onError_(r),e.abrupt("return",Promise.reject(r));case 10:return this.eventManager_.listen(n,"message",function(e){return s.onSessionMessage_(e)}),this.eventManager_.listen(n,"keystatuseschange",function(e){return s.onKeyStatusesChange_(e)}),i={initData:null,loaded:!1,oldExpiration:1/0,updatePromise:null},this.activeSessions_.set(n,i),e.prev=14,e.next=17,n.load(t);case 17:if(a=e.sent,this.destroyer_.ensureNotDestroyed(),Et.log.v2("Loaded offline session",t,a),a){e.next=24;break}return this.activeSessions_.delete(n),this.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.OFFLINE_SESSION_REMOVED)),e.abrupt("return",Promise.resolve());case 24:return i.loaded=!0,this.areAllSessionsLoaded_()&&this.allSessionsLoaded_.resolve(),e.abrupt("return",n);case 29:e.prev=29,e.t1=e.catch(14),this.destroyer_.ensureNotDestroyed(e.t1),this.activeSessions_.delete(n),this.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_CREATE_SESSION,e.t1.message));case 34:return e.abrupt("return",Promise.resolve());case 35:case"end":return e.stop()}},e,this,[[0,5],[14,29]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createTemporarySession_",value:function(e,t){var n,r=this;try{this.usePersistentLicenses_?(Et.log.v1("Creating new persistent session"),n=this.mediaKeys_.createSession("persistent-license")):(Et.log.v1("Creating new temporary session"),n=this.mediaKeys_.createSession())}catch(e){return void this.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_CREATE_SESSION,e.message))}this.eventManager_.listen(n,"message",function(e){return r.onSessionMessage_(e)}),this.eventManager_.listen(n,"keystatuseschange",function(e){return r.onKeyStatusesChange_(e)});var i={initData:t,loaded:!1,oldExpiration:1/0,updatePromise:null};this.activeSessions_.set(n,i),n.generateRequest(e,t.buffer).catch(function(e){var t;r.destroyer_.destroyed()||(r.activeSessions_.delete(n),e.errorCode&&e.errorCode.systemCode&&((t=e.errorCode.systemCode)<0&&(t+=Math.pow(2,32)),t="0x"+t.toString(16)),r.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.FAILED_TO_GENERATE_LICENSE_REQUEST,e.message,e,t)))})}},{key:"onSessionMessage_",value:function(e){this.delayLicenseRequest_()?this.mediaKeyMessageEvents_.push(e):this.sendLicenseRequest_(e)}},{key:"delayLicenseRequest_",value:function(){return this.config_.delayLicenseRequestUntilPlayed&&this.video_.paused&&!this.initialRequestsSent_}},{key:"sendLicenseRequest_",value:function(){var t=gt(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d,h,f,p=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.target,Et.log.v2("Sending license request for session",r.sessionId),i=this.activeSessions_.get(r),a=this.currentDrmInfo_.licenseServerUri,s=this.config_.advanced[this.currentDrmInfo_.keySystem],"individualization-request"==n.messageType&&s&&s.individualizationServer&&(a=s.individualizationServer),o=bt.RequestType.LICENSE,(u=vt([a],this.config_.retryParameters)).body=n.message,u.method="POST",u.licenseRequestType=n.messageType,"com.microsoft.playready"!=this.currentDrmInfo_.keySystem&&"com.chromecast.playready"!=this.currentDrmInfo_.keySystem||this.unpackPlayReadyRequest_(u),this.currentDrmInfo_.keySystem.startsWith("com.apple.fps")&&this.formatFairPlayRequest_(u),t.prev=13,c=this.playerInterface_.netEngine.request(o,u),t.next=17,c.promise;case 17:l=t.sent,t.next=27;break;case 20:return t.prev=20,t.t0=t.catch(13),window.asserts.assert(t.t0 instanceof A,"Wrong NetworkingEngine error type!"),d=new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.LICENSE_REQUEST_FAILED,t.t0),this.onError_(d),i&&i.updatePromise&&i.updatePromise.reject(d),t.abrupt("return");case 27:if(!this.destroyer_.destroyed()){t.next=29;break}return t.abrupt("return");case 29:return this.currentDrmInfo_.keySystem.startsWith("com.apple.fps")&&this.parseFairPlayResponse_(l),t.prev=30,t.next=33,r.update(l.data);case 33:t.next=41;break;case 35:return t.prev=35,t.t1=t.catch(30),h=new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.LICENSE_RESPONSE_REJECTED,t.t1.message),this.onError_(h),i&&i.updatePromise&&i.updatePromise.reject(h),t.abrupt("return");case 41:f=new D("drmsessionupdate"),this.playerInterface_.onEvent(f),i&&(i.updatePromise&&i.updatePromise.resolve(),new ve(function(){i.loaded=!0,p.areAllSessionsLoaded_()&&p.allSessionsLoaded_.resolve()}).tickAfter(e.SESSION_LOAD_TIMEOUT_));case 44:case"end":return t.stop()}},t,this,[[13,20],[30,35]])}));return function(e){return t.apply(this,arguments)}}()},{key:"unpackPlayReadyRequest_",value:function(e){var t=ft.fromUTF16(e.body,!0,!0);if(!t.includes("PlayReadyKeyMessage"))return Et.log.debug("PlayReady request is already unwrapped."),void(e.headers["Content-Type"]="text/xml; charset=utf-8");Et.log.debug("Unwrapping PlayReady request.");var n=(new DOMParser).parseFromString(t,"application/xml"),r=n.getElementsByTagName("HttpHeader"),i=!0,a=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=l.querySelector("name"),d=l.querySelector("value");window.asserts.assert(c&&d,"Malformed PlayReady headers!"),e.headers[c.textContent]=d.textContent}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var h=n.querySelector("Challenge");window.asserts.assert(h,"Malformed PlayReady challenge!"),window.asserts.assert("base64encoded"==h.getAttribute("encoding"),"Unexpected PlayReady challenge encoding!"),e.body=mt.fromBase64(h.textContent).buffer}},{key:"formatFairPlayRequest_",value:function(e){var t=new Uint8Array(e.body),n="spc="+mt.toStandardBase64(t);e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=ft.toUTF8(encodeURIComponent(n))}},{key:"parseFairPlayResponse_",value:function(e){var t;try{t=ft.fromUTF8(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=mt.fromBase64(t).buffer}},{key:"onKeyStatusesChange_",value:function(t){var n=this,r=t.target;Et.log.v2("Key status changed for session",r.sessionId);var i=this.activeSessions_.get(r),a=r.keyStatuses,s=!1;a.forEach(function(e,t){if("string"==typeof t){var r=t;t=e,e=r}if("com.microsoft.playready"==n.currentDrmInfo_.keySystem&&16==t.byteLength&&!lt.isTizen()){var a=mt.toDataView(t),o=a.getUint32(0,!0),u=a.getUint16(4,!0),l=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,u,!1),a.setUint16(6,l,!1)}"com.microsoft.playready"==n.currentDrmInfo_.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(i.loaded=!0),i||window.asserts.assert("usable"!=e,"Usable keys found in closed session"),"expired"==e&&(s=!0);var c=mt.toHex(new Uint8Array(t));n.keyStatusByKeyId_.set(c,e)});var o=r.expiration-Date.now();(o<0||s&&o<1e3)&&i&&!i.updatePromise&&(Et.log.debug("Session has expired",r.sessionId),this.activeSessions_.delete(r),r.close().catch(function(){})),this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.keyStatusTimer_.tickAfter(e.KEY_STATUS_BATCH_TIME))}},{key:"processKeyStatusChanges_",value:function(){var e=this.keyStatusByKeyId_,t=this.announcedKeyStatusByKeyId_;t.clear(),e.forEach(function(e,n){return t.set(n,e)});var n=Array.from(t.values());n.length&&n.every(function(e){return"expired"==e})&&this.onError_(new A(wt.severity.CRITICAL,wt.category.DRM,wt.code.EXPIRED)),this.playerInterface_.onKeyStatus(rt.asObject(t))}},{key:"onPlay_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.mediaKeyMessageEvents_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.sendLicenseRequest_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.initialRequestsSent_=!0,this.mediaKeyMessageEvents_=[]}},{key:"supportsVariant",value:function(e){var t=e.audio,n=e.video;if(t&&t.encrypted){var r=st.getFullType(t.mimeType,t.codecs);if(!this.willSupport(r))return!1}if(n&&n.encrypted){var i=st.getFullType(n.mimeType,n.codecs);if(!this.willSupport(i))return!1}var a=this.keySystem();return 0==e.drmInfos.length||e.drmInfos.some(function(e){return e.keySystem==a})}},{key:"pollExpiration_",value:function(){var e=this;this.activeSessions_.forEach(function(t,n){var r=t.oldExpiration,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.playerInterface_.onExpirationUpdated(n.sessionId,i),t.oldExpiration=i)})}},{key:"areAllSessionsLoaded_",value:function(){var e=this.activeSessions_.values();return G.every(e,function(e){return e.loaded})}}],r=[{key:"isBrowserSupported",value:function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)}},{key:"probeSupport",value:function(){var t=gt(regeneratorRuntime.mark(function t(){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert(e.isBrowserSupported(),"Must have basic EME support"),n=["org.w3.clearkey","com.widevine.alpha","com.microsoft.playready","com.apple.fps.3_0","com.apple.fps.2_0","com.apple.fps.1_0","com.apple.fps","com.adobe.primetime"],i=[{videoCapabilities:r=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:r}],a=new Map,s=function(){var e=gt(regeneratorRuntime.mark(function e(t){var n,r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.requestMediaKeySystemAccess(t,i);case 3:return n=e.sent,r=n.getConfiguration().sessionTypes,s=!!r&&r.includes("persistent-license"),lt.isTizen3()&&(s=!1),a.set(t,{persistentState:s}),e.next=10,n.createMediaKeys();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),a.set(t,null);case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),o=n.map(function(e){return s(e)}),t.next=11,Promise.all(o);case 11:return t.abrupt("return",rt.asObject(a));case 12:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"areDrmCompatible",value:function(t,n){return!t.length||!n.length||e.getCommonDrmInfos(t,n).length>0}},{key:"getCommonDrmInfos",value:function(e,t){if(!e.length)return t;if(!t.length)return e;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=!0,c=!1,d=void 0;try{for(var h,f=t[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;if(u.keySystem==p.keySystem){var m=[];m=(m=m.concat(u.initData||[])).concat(p.initData||[]);var v=[];v=(v=v.concat(u.keyIds)).concat(p.keyIds);var y={keySystem:u.keySystem,licenseServerUri:u.licenseServerUri||p.licenseServerUri,distinctiveIdentifierRequired:u.distinctiveIdentifierRequired||p.distinctiveIdentifierRequired,persistentStateRequired:u.persistentStateRequired||p.persistentStateRequired,videoRobustness:u.videoRobustness||p.videoRobustness,audioRobustness:u.audioRobustness||p.audioRobustness,serverCertificate:u.serverCertificate||p.serverCertificate,initData:m,keyIds:v};n.push(y);break}}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"replaceDrmInfo_",value:function(e,t){var n=[];t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});var r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.drmInfos=n}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"createDrmInfoFor_",value:function(t,n){var r=[],i=[],a=[],s=[];e.processDrmInfos_(n.drmInfos,r,i,a,s),i.length>1&&Et.log.warning("Multiple unique server certificates found! Only the first will be used."),r.length>1&&Et.log.warning("Multiple unique license server URIs found! Only the first will be used.");var o=n.audioCapabilities?n.audioCapabilities[0].robustness:"",u=n.videoCapabilities?n.videoCapabilities[0].robustness:"",l=n.distinctiveIdentifier;return{keySystem:t,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==l,persistentStateRequired:"required"==n.persistentState,audioRobustness:o,videoRobustness:u,serverCertificate:i[0],initData:a,keyIds:s}}},{key:"processDrmInfos_",value:function(e,t,n,r,i){var a=!0,s=!1,o=void 0;try{for(var u,l=function(){var e=u.value;(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate)&&(n.some(function(t){return mt.equal(t,e.serverCertificate)})||n.push(e.serverCertificate));if(e.initData){var a=!0,s=!1,o=void 0;try{for(var l,c=function(){var e=l.value;r.some(function(t){return r=e,!(!(n=t).keyId||n.keyId!=r.keyId)||n.initDataType==r.initDataType&&mt.equal(n.initData,r.initData);var n,r})||r.push(e)},d=e.initData[Symbol.iterator]();!(a=(l=d.next()).done);a=!0)c()}catch(e){s=!0,o=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw o}}}if(e.keyIds){var h=!0,f=!1,p=void 0;try{for(var m,v=e.keyIds[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;i.includes(y)||i.push(y)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}},c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)l()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}}},{key:"fillInDrmInfoDefaults_",value:function(e,t,n){if(e.keySystem&&("org.w3.clearkey"!=e.keySystem||!e.licenseServerUri)){if(t.size){var r=t.get(e.keySystem)||"";e.licenseServerUri=r}e.keyIds||(e.keyIds=[]);var i=n.get(e.keySystem);i&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=i.persistentStateRequired),e.videoRobustness||(e.videoRobustness=i.videoRobustness),e.audioRobustness||(e.audioRobustness=i.audioRobustness),e.serverCertificate||(e.serverCertificate=i.serverCertificate)),window.cast&&window.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready")}}},{key:"closeSession_",value:function(){var t=gt(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Promise(function(t){new ve(t).tickAfter(e.CLOSE_TIMEOUT_)}),t.next=3,Promise.race([n.close().then(function(){return!0}),r.then(function(){return!1})]);case 3:t.sent||Et.log.warning("Timeout waiting for session close");case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}],n&&_t(t.prototype,n),r&&_t(t,r),e}());St.SessionMetaData={},St.PlayerInterface={},St.CLOSE_TIMEOUT_=1,St.SESSION_LOAD_TIMEOUT_=5,St.KEY_STATUS_BATCH_TIME=.5;var Tt=St,kt=n(2),Ct=n.n(kt);function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t,n){return t&&At(e.prototype,t),n&&At(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka;var Lt=function(){function e(){It(this,e),this.muxCaptionParser_=new Ct.a.mp4.CaptionParser,this.videoTrackIds_=[],this.timescales_={}}return xt(e,[{key:"init",value:function(e){var t=Ct.a.mp4.probe,n=new Uint8Array(e);this.videoTrackIds_=t.videoTrackIds(n),this.timescales_=t.timescale(n),this.muxCaptionParser_.init()}},{key:"parseFrom",value:function(e,t){var n=new Uint8Array(e),r=this.muxCaptionParser_.parse(n,this.videoTrackIds_,this.timescales_);r&&r.captions&&t(r.captions),this.muxCaptionParser_.clearParsedCaptions()}},{key:"reset",value:function(){this.muxCaptionParser_.resetCaptionStream()}}],[{key:"isSupported",value:function(){return!!Ct.a}}]),e}(),Nt=function(){function e(){It(this,e)}return xt(e,[{key:"init",value:function(e){}},{key:"parseFrom",value:function(e,t){}},{key:"reset",value:function(){}}]),e}();function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"bufferStart",value:function(e){return e?1==e.length&&e.end(0)-e.start(0)<1e-6?null:1==e.length&&e.start(0)<0?0:e.length?e.start(0):null:null}},{key:"bufferEnd",value:function(e){return e?1==e.length&&e.end(0)-e.start(0)<1e-6?null:e.length?e.end(e.length-1):null:null}},{key:"isBuffered",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!(!e||!e.length)&&(!(1==e.length&&e.end(0)-e.start(0)<1e-6)&&(!(t>e.end(e.length-1))&&t+n>=e.start(0)))}},{key:"bufferedAheadOf",value:function(e,t){if(!e||!e.length)return 0;if(1==e.length&&e.end(0)-e.start(0)<1e-6)return 0;for(var n=0,r=e.length-1;r>=0&&e.end(r)>t;--r)n+=e.end(r)-Math.max(e.start(r),t);return n}},{key:"getGapIndex",value:function(e,t){if(!e||!e.length)return null;if(1==e.length&&e.end(0)-e.start(0)<1e-6)return null;for(var n=lt.isEdge()||lt.isIE()||lt.isTizen()||lt.isChromecast()?.5:.1,r=0;r<e.length;r++)if(e.start(r)>t&&(0==r||e.end(r-1)-t<=n))return r;return null}},{key:"getBufferedInfo",value:function(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}}],(n=null)&&Rt(t.prototype,n),r&&Rt(t,r),e}();function Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot=window.shaka,Dt=function e(t,n,r){Pt(this,e),this.startTime=t,this.direction=e.direction.HORIZONTAL_LEFT_TO_RIGHT,this.endTime=n,this.payload=r,this.region=new Ot.text.CueRegion,this.position=null,this.positionAlign=e.positionAlign.AUTO,this.size=100,this.textAlign=e.textAlign.CENTER,this.writingMode=e.writingMode.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=e.lineInterpretation.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=e.lineAlign.START,this.displayAlign=e.displayAlign.AFTER,this.color="",this.backgroundColor="",this.backgroundImage=null,this.fontSize="",this.fontWeight=e.fontWeight.NORMAL,this.fontStyle=e.fontStyle.NORMAL,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id=""};Dt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},Dt.textAlign={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},Dt.displayAlign={BEFORE:"before",CENTER:"center",AFTER:"after"},Dt.direction={HORIZONTAL_LEFT_TO_RIGHT:"ltr",HORIZONTAL_RIGHT_TO_LEFT:"rtl"},Dt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},Dt.lineInterpretation={LINE_NUMBER:0,PERCENTAGE:1},Dt.lineAlign={CENTER:"center",START:"start",END:"end"},Dt.fontWeight={NORMAL:400,BOLD:700},Dt.fontStyle={NORMAL:"normal",ITALIC:"italic",OBLIQUE:"oblique"},Dt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var Ut=function e(){Pt(this,e),this.id="",this.viewportAnchorX=0,this.viewportAnchorY=0,this.regionAnchorX=0,this.regionAnchorY=0,this.width=100,this.height=100,this.heightUnits=e.units.PERCENTAGE,this.widthUnits=e.units.PERCENTAGE,this.viewportAnchorUnits=e.units.PERCENTAGE,this.scroll=e.scrollMode.NONE};function Ft(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Bt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ft(a,r,i,s,o,"next",e)}function o(e){Ft(a,r,i,s,o,"throw",e)}s(void 0)})}}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ut.units={PX:0,PERCENTAGE:1,LINES:2},Ut.scrollMode={NONE:"",UP:"up"};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var jt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parser_=null,this.displayer_=t,this.timestampOffset_=0,this.appendWindowStart_=0,this.appendWindowEnd_=1/0,this.bufferStart_=null,this.bufferEnd_=null,this.selectedClosedCaptionId_="",this.closedCaptionsMap_=new Map}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.parser_=null,this.displayer_=null,this.closedCaptionsMap_.clear(),Promise.resolve()}},{key:"setDisplayer",value:function(e){this.displayer_=e}},{key:"initParser",value:function(t){if(t!=st.CLOSED_CAPTION_MIMETYPE){var n=e.parserMap_[t];window.asserts.assert(n,"Text type negotiation should have happened already"),this.parser_=new n}}},{key:"getStartTime",value:function(e){window.asserts.assert(this.parser_,"The parser should already be initialized");try{return this.parser_.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.UNABLE_TO_EXTRACT_CUE_START_TIME,e)}}},{key:"appendBuffer",value:function(){var e=Bt(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.parser_,"The parser should already be initialized"),e.next=3,Promise.resolve();case 3:if(this.parser_&&this.displayer_){e.next=5;break}return e.abrupt("return");case 5:if(null!=n&&null!=r){e.next=8;break}return this.parser_.parseInit(new Uint8Array(t)),e.abrupt("return");case 8:i={periodStart:this.timestampOffset_,segmentStart:n,segmentEnd:r},a=this.parser_.parseMedia(new Uint8Array(t),i),s=a.filter(function(e){return e.startTime>=o.appendWindowStart_&&e.startTime<o.appendWindowEnd_}),this.displayer_.append(s),null==this.bufferStart_?this.bufferStart_=Math.max(n,this.appendWindowStart_):(window.asserts.assert(null!=this.bufferEnd_,"There should already be a buffered range end."),window.asserts.assert(n-this.bufferEnd_<=1,"There should not be a gap in text references >1s")),this.bufferEnd_=Math.min(r,this.appendWindowEnd_);case 14:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Bt(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:this.displayer_&&this.displayer_.remove(t,n)&&(null==this.bufferStart_?window.asserts.assert(null==this.bufferEnd_,"end must be null if startTime is null"):(window.asserts.assert(null!=this.bufferEnd_,"end must be non-null if startTime is non-null"),n<=this.bufferStart_||t>=this.bufferEnd_||(t<=this.bufferStart_&&n>=this.bufferEnd_?this.bufferStart_=this.bufferEnd_=null:t<=this.bufferStart_&&n<this.bufferEnd_?this.bufferStart_=n:t>this.bufferStart_&&n>=this.bufferEnd_?this.bufferEnd_=t:window.asserts.assert(!1,"removal from the middle is not supported by TextEngine"))));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"setTimestampOffset",value:function(e){this.timestampOffset_=e}},{key:"setAppendWindow",value:function(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t}},{key:"bufferStart",value:function(){return this.bufferStart_}},{key:"bufferEnd",value:function(){return this.bufferEnd_}},{key:"isBuffered",value:function(e){return null!=this.bufferStart_&&null!=this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)}},{key:"bufferedAheadOf",value:function(e){return null==this.bufferEnd_||this.bufferEnd_<e?0:(window.asserts.assert(null!=this.bufferStart_,"start should not be null if end is not null"),this.bufferEnd_-Math.max(e,this.bufferStart_))}},{key:"appendCues",value:function(e){this.displayer_.append(e)}},{key:"setSelectedClosedCaptionId",value:function(e,t){this.selectedClosedCaptionId_=e;var n=this.closedCaptionsMap_.get(e);if(n){var r=!0,i=!1,a=void 0;try{for(var s,o=n.keys()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=n.get(u);l&&(l=l.filter(function(e){return e.endTime<=t}),this.displayer_.append(l))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}}},{key:"storeAndAppendClosedCaptions",value:function(e,t,n,r){var i=t+" "+n,a=new Map,s=!0,o=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value,h=d.stream;if(a.has(h)||a.set(h,new Map),a.get(h).has(i)||a.get(h).set(i,[]),d.startTime+=r,d.endTime+=r,d.startTime>=this.appendWindowStart_&&d.startTime<this.appendWindowEnd_){var f=new Dt(d.startTime,d.endTime,d.text);a.get(h).get(i).push(f),h==this.selectedClosedCaptionId_&&this.displayer_.append([f])}}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}var p=!0,m=!1,v=void 0;try{for(var y,g=a.keys()[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value;this.closedCaptionsMap_.has(_)||this.closedCaptionsMap_.set(_,new Map);var b=!0,w=!1,E=void 0;try{for(var S,T=a.get(_).keys()[Symbol.iterator]();!(b=(S=T.next()).done);b=!0){var k=S.value,C=a.get(_).get(k);this.closedCaptionsMap_.get(_).set(k,C)}}catch(e){w=!0,E=e}finally{try{b||null==T.return||T.return()}finally{if(w)throw E}}}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}null==this.bufferStart_?this.bufferStart_=Math.max(t,this.appendWindowStart_):this.bufferStart_=Math.min(this.bufferStart_,Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.max(this.bufferEnd_,Math.min(n,this.appendWindowEnd_))}},{key:"getNumberOfClosedCaptionChannels",value:function(){return this.closedCaptionsMap_.size}},{key:"getNumberOfClosedCaptionsInChannel",value:function(e){var t=this.closedCaptionsMap_.get(e);return t?t.size:0}}],r=[{key:"registerParser",value:function(t,n){e.parserMap_[t]=n}},{key:"unregisterParser",value:function(t){delete e.parserMap_[t]}},{key:"isTypeSupported",value:function(t){return!!e.parserMap_[t]||!(!Ct.a||t!==st.CLOSED_CAPTION_MIMETYPE)}}],n&&Vt(t.prototype,n),r&&Vt(t,r),e}();jt.parserMap_={};var Ht=jt;function Kt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Wt=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.muxTransmuxer_=new Ct.a.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.transmuxPromise_=null,this.transmuxedData_=[],this.captions_=[],this.isTransmuxing_=!1,this.muxTransmuxer_.on("data",function(e){return t.onTransmuxed_(e)}),this.muxTransmuxer_.on("done",function(){return t.onTransmuxDone_()})}var t,n,r;return t=e,r=[{key:"isSupported",value:function(t,n){if(!Ct.a||!e.isTsContainer(t))return!1;var r=e.convertTsCodecs;if(n)return MediaSource.isTypeSupported(r(n,t));var i=ee.ContentType;return MediaSource.isTypeSupported(r(i.AUDIO,t))||MediaSource.isTypeSupported(r(i.VIDEO,t))}},{key:"isTsContainer",value:function(e){return"mp2t"==e.split(";")[0].split("/")[1]}},{key:"convertTsCodecs",value:function(e,t){var n=ee.ContentType,r=t.replace("mp2t","mp4");e==n.AUDIO&&(r=r.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(r);if(i){var a="avc1.",s=i[1];"66"==s?a+="4200":"77"==s?a+="4d00":(window.asserts.assert("100"==s,"Legacy avc1 parsing code out of sync with regex!"),a+="6400");var o=Number(i[2]);window.asserts.assert(o<256,"Invalid legacy avc1 level number!"),a+=(o>>4).toString(16),a+=(15&o).toString(16),r=r.replace(i[0],a)}return r}}],(n=[{key:"destroy",value:function(){return this.muxTransmuxer_.dispose(),this.muxTransmuxer_=null,Promise.resolve()}},{key:"transmux",value:function(e){window.asserts.assert(!this.isTransmuxing_,"No transmuxing should be in progress."),this.isTransmuxing_=!0,this.transmuxPromise_=new we,this.transmuxedData_=[],this.captions_=[];var t=new Uint8Array(e);return this.muxTransmuxer_.push(t),this.muxTransmuxer_.flush(),this.isTransmuxing_&&this.transmuxPromise_.reject(new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.TRANSMUXING_FAILED)),this.transmuxPromise_}},{key:"onTransmuxed_",value:function(e){this.captions_=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.transmuxedData_.push(t)}},{key:"onTransmuxDone_",value:function(){var e={data:mt.concat.apply(mt,Kt(this.transmuxedData_)),captions:this.captions_};this.transmuxPromise_.resolve(e),this.isTransmuxing_=!1}}])&&Gt(t.prototype,n),r&&Gt(t,r),e}();function qt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function zt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){qt(a,r,i,s,o,"next",e)}function o(e){qt(a,r,i,s,o,"throw",e)}s(void 0)})}}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xt=new A,$t=window.shaka,Qt=window.goog,Zt=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=t,this.textDisplayer_=r,this.sourceBuffers_={},this.textEngine_=null,this.queues_={},this.eventManager_=new he,this.transmuxers_={},this.captionParser_=n,this.mediaSourceOpen_=new we,this.mediaSource_=this.createMediaSource(this.mediaSourceOpen_),this.destroyer_=new tt(function(){return i.doDestroy_()})}var t,n,r;return t=e,n=[{key:"createMediaSource",value:function(t){var n=new MediaSource;return this.eventManager_.listenOnce(n,"sourceopen",t.resolve),console.log(e.createObjectURL(n)),this.video_.src=e.createObjectURL(n),n}},{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=zt(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=[],this.queues_)for(r=this.queues_[n],i=r[0],this.queues_[n]=r.slice(0,1),i&&t.push(i.p.catch(q.noop)),a=1;a<r.length;++a)r[a].p.reject(tt.destroyedError());for(s in this.textEngine_&&t.push(this.textEngine_.destroy()),this.textDisplayer_&&t.push(this.textDisplayer_.destroy()),this.transmuxers_)t.push(this.transmuxers_[s].destroy());return e.next=7,Promise.all(t);case 7:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.video_&&(this.video_.removeAttribute("src"),this.video_.load(),this.video_=null),this.mediaSource_=null,this.textEngine_=null,this.textDisplayer_=null,this.sourceBuffers_={},this.transmuxers_={},this.captionParser_=null,Qt.DEBUG)for(o in this.queues_)window.asserts.assert(0==this.queues_[o].length,o+" queue should be empty after destroy!");this.queues_={};case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"open",value:function(){return this.mediaSourceOpen_}},{key:"init",value:function(){var t=zt(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,u,l,c,d=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=ee.ContentType,t.next=3,this.mediaSourceOpen_;case 3:for(a=!0,s=!1,o=void 0,t.prev=6,u=function(){var t=c.value,a=n.get(t);window.asserts.assert(e.isStreamSupported(a),"Type negotiation should happen before MediaSourceEngine.init!");var s=st.getFullType(a.mimeType,a.codecs);if(t==i.TEXT)d.reinitText(s);else{!r&&MediaSource.isTypeSupported(s)||!Wt.isSupported(s,t)||(d.transmuxers_[t]=new Wt,s=Wt.convertTsCodecs(t,s));var o=d.mediaSource_.addSourceBuffer(s);console.log({sourceBuffer:o}),d.eventManager_.listen(o,"error",function(){return d.onError_(t)}),d.eventManager_.listen(o,"updateend",function(){return d.onUpdateEnd_(t)}),d.sourceBuffers_[t]=o,d.queues_[t]=[]}},l=n.keys()[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)u();t.next=15;break;case 11:t.prev=11,t.t0=t.catch(6),s=!0,o=t.t0;case 15:t.prev=15,t.prev=16,a||null==l.return||l.return();case 18:if(t.prev=18,!s){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}},t,this,[[6,11,15,23],[16,,18,22]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"reinitText",value:function(e){this.textEngine_||(this.textEngine_=new Ht(this.textDisplayer_)),this.textEngine_.initParser(e)}},{key:"ended",value:function(){return!this.mediaSource_||"ended"==this.mediaSource_.readyState}},{key:"bufferStart",value:function(e){return e==ee.ContentType.TEXT?this.textEngine_.bufferStart():Mt.bufferStart(this.getBuffered_(e))}},{key:"bufferEnd",value:function(e){return e==ee.ContentType.TEXT?this.textEngine_.bufferEnd():Mt.bufferEnd(this.getBuffered_(e))}},{key:"isBuffered",value:function(e,t,n){if(e==ee.ContentType.TEXT)return this.textEngine_.isBuffered(t);var r=this.getBuffered_(e);return Mt.isBuffered(r,t,n)}},{key:"bufferedAheadOf",value:function(e,t){if(e==ee.ContentType.TEXT)return this.textEngine_.bufferedAheadOf(t);var n=this.getBuffered_(e);return Mt.bufferedAheadOf(n,t)}},{key:"getBufferedInfo",value:function(e){var t=ee.ContentType,n=Mt.getBufferedInfo;if(e.total=n(this.video_.buffered),e.audio=n(this.getBuffered_(t.AUDIO)),e.video=n(this.getBuffered_(t.VIDEO)),e.text=[],this.textEngine_){var r=this.textEngine_.bufferStart(),i=this.textEngine_.bufferEnd();null!=r&&null!=i&&e.text.push({start:r,end:i})}}},{key:"getBuffered_",value:function(e){try{return this.sourceBuffers_[e].buffered}catch(t){return e in this.sourceBuffers_&&$t.log.error("failed to get buffered range for "+e,t),null}}},{key:"appendBuffer",value:function(){var e=zt(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,u,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=ee.ContentType,t!=s.TEXT){e.next=6;break}return e.next=4,this.textEngine_.appendBuffer(n,r,i);case 4:e.next=25;break;case 6:if(!this.transmuxers_[t]){e.next=16;break}return e.next=9,this.transmuxers_[t].transmux(n);case 9:return o=e.sent,this.textEngine_||this.reinitText("text/vtt"),o.captions&&(u=this.sourceBuffers_[s.VIDEO].timestampOffset,this.textEngine_.storeAndAppendClosedCaptions(o.captions,r,i,u)),e.next=14,this.enqueueOperation_(t,function(){return l.append_(t,o.data.buffer)});case 14:e.next=25;break;case 16:if(!a||!Ct.a){e.next=23;break}return this.textEngine_||this.reinitText("text/vtt"),null==r&&null==i?this.captionParser_.init(n):this.captionParser_.parseFrom(n,function(e){if(e.length){var t=l.sourceBuffers_[s.VIDEO].timestampOffset;l.textEngine_.storeAndAppendClosedCaptions(e,r,i,t)}}),e.next=21,this.enqueueOperation_(t,function(){return l.append_(t,n)});case 21:e.next=25;break;case 23:return e.next=25,this.enqueueOperation_(t,function(){return l.append_(t,n)});case 25:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"setSelectedClosedCaptionId",value:function(e){var t=ee.ContentType.VIDEO,n=this.bufferEnd(t)||0;this.textEngine_.setSelectedClosedCaptionId(e,n)}},{key:"remove",value:function(){var e=zt(regeneratorRuntime.mark(function e(t,n,r){var i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(r<Number.MAX_VALUE,"remove() with MAX_VALUE or Infinity is not IE-compatible!"),i=ee.ContentType,t!=i.TEXT){e.next=7;break}return e.next=5,this.textEngine_.remove(n,r);case 5:e.next=9;break;case 7:return e.next=9,this.enqueueOperation_(t,function(){return a.remove_(t,n,r)});case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"clear",value:function(){var e=zt(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ee.ContentType,t!=n.TEXT){e.next=9;break}if(this.textEngine_){e.next=4;break}return e.abrupt("return");case 4:return this.captionParser_.reset(),e.next=7,this.textEngine_.remove(0,1/0);case 7:e.next=11;break;case 9:return e.next=11,this.enqueueOperation_(t,function(){return r.remove_(t,0,r.mediaSource_.duration)});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"flush",value:function(){var e=zt(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ee.ContentType,t!=n.TEXT){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.enqueueOperation_(t,function(){return r.flush_(t)});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setStreamProperties",value:function(){var e=zt(regeneratorRuntime.mark(function e(t,n,r,i){var a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=ee.ContentType,t!=a.TEXT){e.next=5;break}return this.textEngine_.setTimestampOffset(n),this.textEngine_.setAppendWindow(r,i),e.abrupt("return");case 5:return e.next=7,Promise.all([this.enqueueOperation_(t,function(){return s.abort_(t)}),this.enqueueOperation_(t,function(){return s.setTimestampOffset_(t,n)}),this.enqueueOperation_(t,function(){return s.setAppendWindow_(t,r,i)})]);case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"endOfStream",value:function(){var e=zt(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enqueueBlockingOperation_(function(){t?n.mediaSource_.endOfStream(t):n.mediaSource_.endOfStream()});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setDuration",value:function(){var e=zt(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(isNaN(this.mediaSource_.duration)||this.mediaSource_.duration<=t,"duration cannot decrease: "+this.mediaSource_.duration+" -> "+t),e.next=3,this.enqueueBlockingOperation_(function(){n.mediaSource_.duration=t});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getDuration",value:function(){return this.mediaSource_.duration}},{key:"append_",value:function(e,t){this.sourceBuffers_[e].appendBuffer(t)}},{key:"remove_",value:function(e,t,n){n<=t?this.onUpdateEnd_(e):this.sourceBuffers_[e].remove(t,n)}},{key:"abort_",value:function(e){var t=this.sourceBuffers_[e].appendWindowStart,n=this.sourceBuffers_[e].appendWindowEnd;this.sourceBuffers_[e].abort(),this.sourceBuffers_[e].appendWindowStart=t,this.sourceBuffers_[e].appendWindowEnd=n,this.onUpdateEnd_(e)}},{key:"flush_",value:function(e){window.asserts.assert(0==this.video_.buffered.length,"MediaSourceEngine.flush_ should only be used after clearing all data!"),this.video_.currentTime-=.001,this.onUpdateEnd_(e)}},{key:"setTimestampOffset_",value:function(e,t){t<0&&(t+=.001),this.sourceBuffers_[e].timestampOffset=t,this.onUpdateEnd_(e)}},{key:"setAppendWindow_",value:function(e,t,n){this.sourceBuffers_[e].appendWindowStart=0,this.sourceBuffers_[e].appendWindowEnd=n,this.sourceBuffers_[e].appendWindowStart=t,this.onUpdateEnd_(e)}},{key:"onError_",value:function(e){var t=this.queues_[e][0];window.asserts.assert(t,"Spurious error event!"),window.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on error!");var n=this.video_.error?this.video_.error.code:0;t.p.reject(new A(Xt.severity.CRITICAL,Xt.category.MEDIA,Xt.code.MEDIA_SOURCE_OPERATION_FAILED,n))}},{key:"onUpdateEnd_",value:function(e){var t=this.queues_[e][0];window.asserts.assert(t,"Spurious updateend event!"),t&&(window.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on updateend!"),t.p.resolve(),this.popFromQueue_(e))}},{key:"enqueueOperation_",value:function(e,t){this.destroyer_.ensureNotDestroyed();var n={start:t,p:new we};if(this.queues_[e].push(n),1==this.queues_[e].length)try{n.start()}catch(t){"QuotaExceededError"==t.name?n.p.reject(new A(Xt.severity.CRITICAL,Xt.category.MEDIA,Xt.code.QUOTA_EXCEEDED_ERROR,e)):n.p.reject(new A(Xt.severity.CRITICAL,Xt.category.MEDIA,Xt.code.MEDIA_SOURCE_OPERATION_THREW,t)),this.popFromQueue_(e)}return n.p}},{key:"enqueueBlockingOperation_",value:function(){var e=zt(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i in this.destroyer_.ensureNotDestroyed(),n=[],r=function(e){var t=new we,r={start:function(){return t.resolve()},p:t};u.queues_[e].push(r),n.push(t),1==u.queues_[e].length&&r.start()},this.sourceBuffers_)r(i);return e.prev=4,e.next=7,Promise.all(n);case 7:if(Qt.DEBUG)for(i in this.sourceBuffers_)window.asserts.assert(0==this.sourceBuffers_[i].updating,"SourceBuffers should not be updating after a blocking op!");try{t()}catch(e){a=Promise.reject(new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.MEDIA_SOURCE_OPERATION_THREW,e))}for(s in this.sourceBuffers_)this.popFromQueue_(s);return e.abrupt("return",a);case 13:if(e.prev=13,e.t0=e.catch(4),window.asserts.assert(this.destroyer_.destroyed(),"Should be destroyed by now"),Qt.DEBUG)for(o in this.sourceBuffers_)this.queues_[o].length&&(window.asserts.assert(1==this.queues_[o].length,"Should be at most one item in queue!"),window.asserts.assert(n.includes(this.queues_[o][0].p),"The item in queue should be one of our waiters!"),this.queues_[o].shift());throw e.t0;case 18:case"end":return e.stop()}},e,this,[[4,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"popFromQueue_",value:function(e){this.queues_[e].shift();var t=this.queues_[e][0];if(t)try{t.start()}catch(n){t.p.reject(new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.MEDIA_SOURCE_OPERATION_THREW,n)),this.popFromQueue_(e)}}},{key:"getTextDisplayer",value:function(){return window.asserts.assert(this.textDisplayer_,"TextDisplayer should only be null when this is destroyed"),this.textDisplayer_}},{key:"setTextDisplayer",value:function(e){var t=this.textDisplayer_;this.textDisplayer_=e,t&&(e.setTextVisibility(t.isTextVisible()),t.destroy()),this.textEngine_&&this.textEngine_.setDisplayer(e)}}],r=[{key:"isStreamSupported",value:function(e){var t=st.getFullType(e.mimeType,e.codecs),n=st.getExtendedType(e);return Ht.isTypeSupported(t)||MediaSource.isTypeSupported(n)||Wt.isSupported(t,e.type)}},{key:"probeSupport",value:function(){for(var e={},t=0,n=['video/mp4; codecs="avc1.42E01E"','video/mp4; codecs="avc3.42E01E"','video/mp4; codecs="hev1.1.6.L93.90"','video/mp4; codecs="hvc1.1.6.L93.90"','video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084"','video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084"','video/mp4; codecs="vp9"','video/mp4; codecs="vp09.00.10.08"','audio/mp4; codecs="mp4a.40.2"','audio/mp4; codecs="ac-3"','audio/mp4; codecs="ec-3"','audio/mp4; codecs="opus"','audio/mp4; codecs="flac"','video/webm; codecs="vp8"','video/webm; codecs="vp9"','video/webm; codecs="vp09.00.10.08"','audio/webm; codecs="vorbis"','audio/webm; codecs="opus"','video/mp2t; codecs="avc1.42E01E"','video/mp2t; codecs="avc3.42E01E"','video/mp2t; codecs="hvc1.1.6.L93.90"','video/mp2t; codecs="mp4a.40.2"','video/mp2t; codecs="ac-3"','video/mp2t; codecs="ec-3"',"text/vtt",'application/mp4; codecs="wvtt"',"application/ttml+xml",'application/mp4; codecs="stpp"'];t<n.length;t++){var r=n[t];lt.supportsMediaSource()?Ht.isTypeSupported(r)?e[r]=!0:e[r]=MediaSource.isTypeSupported(r)||Wt.isSupported(r):e[r]=lt.supportsMediaType(r);var i=r.split(";")[0];e[i]=e[i]||e[r]}return e}}],n&&Yt(t.prototype,n),r&&Yt(t,r),e}();Zt.createObjectURL=window.URL.createObjectURL,Zt.Operation;var Jt=Zt;function en(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nn=window.shaka,rn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"meetsRestrictions",value:function(e,t,n){var r=function(e,t,n){return e>=t&&e<=n},i=e.video;if(i&&i.width&&i.height){if(!r(i.width,t.minWidth,Math.min(t.maxWidth,n.width)))return!1;if(!r(i.height,t.minHeight,Math.min(t.maxHeight,n.height)))return!1;if(!r(i.width*i.height,t.minPixels,t.maxPixels))return!1}return!!r(e.bandwidth,t.minBandwidth,t.maxBandwidth)}},{key:"applyRestrictions",value:function(t,n,r){var i=!1,a=!0,s=!1,o=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=c.allowedByApplication;c.allowedByApplication=e.meetsRestrictions(c,n,r),d!=c.allowedByApplication&&(i=!0)}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}return i}},{key:"filterNewPeriod",value:function(t,n,r,i){n&&window.asserts.assert(e.isAudio(n),"Audio streams must have the audio type."),r&&window.asserts.assert(e.isVideo(r),"Video streams must have the video type."),i.variants=i.variants.filter(function(i){if(t&&t.initialized()&&!t.supportsVariant(i))return nn.log.debug("Dropping variant - not compatible with key system",i),!1;var a=i.audio,s=i.video;return a&&!Jt.isStreamSupported(a)?(nn.log.debug("Dropping variant - audio not compatible with platform",e.getStreamSummaryString_(a)),!1):s&&!Jt.isStreamSupported(s)?(nn.log.debug("Dropping variant - video not compatible with platform",e.getStreamSummaryString_(s)),!1):a&&n&&!e.areStreamsCompatible_(a,n)?(nn.log.debug("Droping variant - not compatible with active audio","active audio",e.getStreamSummaryString_(n),"variant.audio",e.getStreamSummaryString_(a)),!1):!(s&&r&&!e.areStreamsCompatible_(s,r))||(nn.log.debug("Droping variant - not compatible with active video","active video",e.getStreamSummaryString_(r),"variant.video",e.getStreamSummaryString_(s)),!1)}),i.textStreams=i.textStreams.filter(function(e){var t=st.getFullType(e.mimeType,e.codecs),n=Ht.isTypeSupported(t);return n||nn.log.debug("Dropping text stream. Is not supported by the platform.",e),n})}},{key:"areStreamsCompatible_",value:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}},{key:"variantToTrack",value:function(e){var t=e.audio,n=e.video,r=t?t.codecs:null,i=n?n.codecs:null,a=[];i&&a.push(i),r&&a.push(r);var s=[];n&&s.push(n.mimeType),t&&s.push(t.mimeType);var o=s[0]||null,u=[];t&&u.push(t.kind),n&&u.push(n.kind);var l=u[0]||null,c=new Set;if(t){var d=!0,h=!1,f=void 0;try{for(var p,m=t.roles[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;c.add(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}if(n){var y=!0,g=!1,_=void 0;try{for(var b,w=n.roles[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var E=b.value;c.add(E)}}catch(e){g=!0,_=e}finally{try{y||null==w.return||w.return()}finally{if(g)throw _}}}var S={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:l,width:null,height:null,frameRate:null,mimeType:o,codecs:a.join(", "),audioCodec:r,videoCodec:i,primary:e.primary,roles:Array.from(c),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};return n&&(S.videoId=n.id,S.originalVideoId=n.originalId,S.width=n.width||null,S.height=n.height||null,S.frameRate=n.frameRate||null,S.videoBandwidth=n.bandwidth||null),t&&(S.audioId=t.id,S.originalAudioId=t.originalId,S.channelsCount=t.channelsCount,S.audioBandwidth=t.bandwidth||null,S.label=t.label,S.audioRoles=t.roles),S}},{key:"textStreamToTrack",value:function(e){var t=ee.ContentType;return{id:e.id,active:!1,type:t.TEXT,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}}},{key:"html5TrackId",value:function(t){return t.__shaka_id||(t.__shaka_id=e.nextTrackId_++),t.__shaka_id}},{key:"html5TextTrackToTrack",value:function(t){var n=st.CLOSED_CAPTION_MIMETYPE,r=e.html5TrackToGenericShakaTrack_(t);return r.active="disabled"!=t.mode,r.type="text",r.originalTextId=t.id,"captions"==t.kind&&(r.mimeType=n),r}},{key:"html5AudioTrackToTrack",value:function(t){var n=e.html5TrackToGenericShakaTrack_(t);return n.active=t.enabled,n.type="variant",n.originalAudioId=t.id,"main"==t.kind?(n.primary=!0,n.roles=["main"],n.audioRoles=["main"]):n.audioRoles=[],n}},{key:"html5TrackToGenericShakaTrack_",value:function(t){return{id:e.html5TrackId(t),active:!1,type:"",bandwidth:0,language:ne.normalize(t.language),label:t.label,kind:t.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}},{key:"isPlayable",value:function(e){return e.allowedByApplication&&e.allowedByKeySystem}},{key:"getPlayableVariants",value:function(t){return t.filter(function(t){return e.isPlayable(t)})}},{key:"filterVariantsByAudioChannelCount",value:function(e,t){var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),r=new Map,i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=l.audio.channelsCount;window.asserts.assert(null!=c,"Must have count after filtering!"),r.has(c)||r.set(c,[]),r.get(c).push(l)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var d=Array.from(r.keys());if(0==d.length)return e;var h=d.filter(function(e){return e<=t});return h.length?r.get(Math.max.apply(Math,en(h))):r.get(Math.min.apply(Math,en(d)))}},{key:"filterStreamsByLanguageAndRole",value:function(t,n,r){var i=t,a=t.filter(function(e){return e.primary});a.length&&(i=a);var s=i.length?i[0].language:"";if(i=i.filter(function(e){return e.language==s}),n){var o=ne.findClosestLocale(ne.normalize(n),t.map(function(e){return e.language}));o&&(i=t.filter(function(e){return ne.normalize(e.language)==o}))}if(r){var u=e.filterTextStreamsByRole_(i,r);if(u.length)return u;nn.log.warning("No exact match for the text role could be found.")}else{var l=i.filter(function(e){return 0==e.roles.length});if(l.length)return l}var c=i.map(function(e){return e.roles}).reduce(q.collapseArrays,[]);return c.length?e.filterTextStreamsByRole_(i,c[0]):i}},{key:"filterTextStreamsByRole_",value:function(e,t){return e.filter(function(e){return e.roles.includes(t)})}},{key:"getVariantByStreams",value:function(t,n,r){t&&window.asserts.assert(e.isAudio(t),"Audio streams must have the audio type."),n&&window.asserts.assert(e.isVideo(n),"Video streams must have the video type.");for(var i=0;i<r.length;i++)if(r[i].audio==t&&r[i].video==n)return r[i];return null}},{key:"isAudio",value:function(e){var t=ee.ContentType;return e.type==t.AUDIO}},{key:"isVideo",value:function(e){var t=ee.ContentType;return e.type==t.VIDEO}},{key:"getVariantStreams",value:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}},{key:"getStreamSummaryString_",value:function(t){return e.isAudio(t)?"type=audio codecs="+t.codecs+" bandwidth="+t.bandwidth+" channelsCount="+t.channelsCount:e.isVideo(t)?"type=video codecs="+t.codecs+" bandwidth="+t.bandwidth+" frameRate="+t.frameRate+" width="+t.width+" height="+t.height:"unexpected stream type"}}],(n=null)&&tn(t.prototype,n),r&&tn(t,r),e}());rn.nextTrackId_=0;var an=rn;function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var on=window.shaka,un=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.switch_=null,this.enabled_=!1,this.bandwidthEstimator_=new Ze,this.variants_=[],this.startupComplete_=!1,this.lastTimeChosenMs_=null,this.config_=null}var t,n,r;return t=e,r=[{key:"filterAndSortVariants_",value:function(e,t){return e&&(t=t.filter(function(t){return window.asserts.assert(e,"Restrictions should exist!"),an.meetsRestrictions(t,e,{width:1/0,height:1/0})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}}],(n=[{key:"stop",value:function(){this.switch_=null,this.enabled_=!1,this.variants_=[],this.lastTimeChosenMs_=null}},{key:"init",value:function(e){this.switch_=e}},{key:"chooseVariant",value:function(){var t=e.filterAndSortVariants_(this.config_.restrictions,this.variants_),n=this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate);this.variants_.length&&!t.length&&(on.log.warning("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),t=[(t=e.filterAndSortVariants_(null,this.variants_))[0]]);for(var r=t[0]||null,i=0;i<t.length;++i){var a=t[i],s=t[i+1]||{bandwidth:1/0},o=a.bandwidth/this.config_.bandwidthDowngradeTarget,u=s.bandwidth/this.config_.bandwidthUpgradeTarget;on.log.v2("Bandwidth ranges:",(a.bandwidth/1e6).toFixed(3),(o/1e6).toFixed(3),(u/1e6).toFixed(3)),n>=o&&n<=u&&(r=a)}return this.lastTimeChosenMs_=Date.now(),r}},{key:"enable",value:function(){this.enabled_=!0}},{key:"disable",value:function(){this.enabled_=!1}},{key:"segmentDownloaded",value:function(e,t){on.log.v2("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.lastTimeChosenMs_,"enabled="+this.enabled_),window.asserts.assert(e>=0,"expected a non-negative duration"),this.bandwidthEstimator_.sample(e,t),null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()}},{key:"getBandwidthEstimate",value:function(){return this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate)}},{key:"setVariants",value:function(e){this.variants_=e}},{key:"configure",value:function(e){this.config_=e}},{key:"suggestStreams_",value:function(){if(on.log.v2("Suggesting Streams..."),window.asserts.assert(null!=this.lastTimeChosenMs_,"lastTimeChosenMs_ should not be null"),this.startupComplete_){if(Date.now()-this.lastTimeChosenMs_<1e3*this.config_.switchInterval)return void on.log.v2("Still within switch interval...")}else{if(!this.bandwidthEstimator_.hasGoodEstimate())return void on.log.v2("Still waiting for a good estimate...");this.startupComplete_=!0}var e=this.chooseVariant(),t=this.bandwidthEstimator_.getBandwidthEstimate(this.config_.defaultBandwidthEstimate),n=Math.round(t/1e3);on.log.debug("Calling switch_(), bandwidth="+n+" kbps"),this.switch_(e)}}])&&sn(t.prototype,n),r&&sn(t,r),e}());function ln(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var dn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=e.defaultRetryParameters();this.maxAttempts_=null==t.maxAttempts?r.maxAttempts:t.maxAttempts,window.asserts.assert(this.maxAttempts_>=1,"maxAttempts should be >= 1"),this.baseDelay_=null==t.baseDelay?r.baseDelay:t.baseDelay,window.asserts.assert(this.baseDelay_>=0,"baseDelay should be >= 0"),this.fuzzFactor_=null==t.fuzzFactor?r.fuzzFactor:t.fuzzFactor,window.asserts.assert(this.fuzzFactor_>=0,"fuzzFactor should be >= 0"),this.backoffFactor_=null==t.backoffFactor?r.backoffFactor:t.backoffFactor,window.asserts.assert(this.backoffFactor_>=0,"backoffFactor should be >= 0"),this.numAttempts_=0,this.nextUnfuzzedDelay_=this.baseDelay_,this.autoReset_=n,this.autoReset_&&(window.asserts.assert(this.maxAttempts_>=2,"maxAttempts must be >= 2 for autoReset == true"),this.numAttempts_=1)}var t,n,r;return t=e,n=[{key:"attempt",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.numAttempts_>=this.maxAttempts_)){t.next=6;break}if(!this.autoReset_){t.next=5;break}this.reset_(),t.next=6;break;case 5:throw new Error(Error.Severity.CRITICAL,Error.Category.PLAYER,Error.Code.ATTEMPTS_EXHAUSTED);case 6:if(n=this.numAttempts_,this.numAttempts_++,0!=n){t.next=11;break}return window.asserts.assert(!this.autoReset_,"Failed to delay with auto-reset!"),t.abrupt("return");case 11:return r=e.fuzz_(this.nextUnfuzzedDelay_,this.fuzzFactor_),t.next=14,new Promise(function(t){e.defer(r,t)});case 14:this.nextUnfuzzedDelay_*=this.backoffFactor_;case 15:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){ln(a,r,i,s,o,"next",e)}function o(e){ln(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()},{key:"reset_",value:function(){window.asserts.assert(this.autoReset_,"Should only be used for auto-reset!"),this.numAttempts_=1,this.nextUnfuzzedDelay_=this.baseDelay_}}],r=[{key:"defaultRetryParameters",value:function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}},{key:"fuzz_",value:function(e,t){return e*(1+(2*Math.random()-1)*t)}},{key:"defer",value:function(e,t){new ve(t).tickAfter(e/1e3)}}],n&&cn(t.prototype,n),r&&cn(t,r),e}();function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
console.log({net:c.net,util:c.util});var fn=c.net.NetworkingEngine,pn=c.util.ConfigUtils;console.log({NetworkingEngine:fn});var mn=window.shaka,vn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createDefault",value:function(){var t=1e6,n=1/0;navigator.connection&&(t=1e6*navigator.connection.downlink,navigator.connection.saveData&&(n=360));var r={retryParameters:dn.defaultRetryParameters(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1},i={retryParameters:dn.defaultRetryParameters(),availabilityWindowOverride:NaN,dash:{customScheme:function(e){return e&&null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0}},a={retryParameters:dn.defaultRetryParameters(),failureCallback:function(e){mn.log.error("Unhandled streaming error",e)},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1};lt.isWebOS()&&(a.stallEnabled=!1);var s={trackSelectionCallback:function(e){return e},progressCallback:function(e,t){mn.log.v2("Offline operation on",e.originalManifestUri,"progress at",t)},usePersistentLicense:!0},o={drm:r,manifest:i,streaming:a,offline:s,abrFactory:un,abr:{enabled:!0,defaultBandwidthEstimate:t,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:n,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return s.trackSelectionCallback=function(t){return e.defaultTrackSelect(t,o.preferredAudioLanguage)},o}},{key:"mergeConfigObjects",value:function(t,n,r){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return pn.mergeConfigObjects(t,n,r||e.createDefault(),i,"")}},{key:"defaultTrackSelect",value:function(e,t){var n=ee.ContentType,r=e.filter(function(e){return"variant"==e.type}),i=[],a=ne.findClosestLocale(t,r.map(function(e){return e.language}));(a&&(i=r.filter(function(e){return ne.normalize(e.language)==a})),0==i.length&&(i=r.filter(function(e){return e.primary})),0==i.length)&&(new Set(r.map(function(e){return e.language})).size>1&&mn.log.warning("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=r);var s=i.filter(function(e){return e.height&&e.height<=480});s.length&&(s.sort(function(e,t){return t.height-e.height}),i=s.filter(function(e){return e.height==s[0].height}));var o=[];if(i.length){var u=Math.floor(i.length/2);i.sort(function(e,t){return e.bandwidth-t.bandwidth}),o.push(i[u])}var l=!0,c=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;p.type==n.TEXT&&o.push(p)}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}return o}}],(n=null)&&hn(t.prototype,n),r&&hn(t,r),e}());function yn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function gn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){yn(a,r,i,s,o,"next",e)}function o(e){yn(a,r,i,s,o,"throw",e)}s(void 0)})}}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bn=c.net.NetworkingEngine,wn=new A,En=window.shaka,Sn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=null,r=[{key:"registerParserByExtension",value:function(t,n){e.parsersByExtension[t]=n}},{key:"registerParserByMime",value:function(t,n){e.parsersByMime[t]=n}},{key:"probeSupport",value:function(){var t={};if(lt.supportsMediaSource()){for(var n in e.parsersByMime)t[n]=!0;for(var r in e.parsersByExtension)t[r]=!0}for(var i={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"},a=0,s=["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"];a<s.length;a++){var o=s[a];lt.supportsMediaSource()?t[o]=!!e.parsersByMime[o]:t[o]=lt.supportsMediaType(o)}for(var u in i)if(lt.supportsMediaSource())t[u]=!!e.parsersByExtension[u];else{var l=i[u];t[u]=lt.supportsMediaType(l)}return t}},{key:"create",value:function(){var t=gn(regeneratorRuntime.mark(function t(n,r,i,a){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getFactory_(n,r,i,a);case 3:return s=t.sent,t.abrupt("return",new s);case 7:throw t.prev=7,t.t0=t.catch(0),window.asserts.assert(t.t0 instanceof A,"Incorrect error type"),t.t0.severity=wn.severity.CRITICAL,t.t0;case 12:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getFactory_",value:function(){var t=gn(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}if(!(s=e.parsersByMime[a.toLowerCase()])){t.next=4;break}return t.abrupt("return",s);case 4:En.log.warning("Could not determine manifest type using MIME type ",a);case 5:if(!(o=e.getExtension(n))){t.next=13;break}if(!(u=e.parsersByExtension[o])){t.next=10;break}return t.abrupt("return",u);case 10:En.log.warning("Could not determine manifest type for extension ",o),t.next=14;break;case 13:En.log.warning("Could not find extension for ",n);case 14:if(a){t.next=23;break}return t.next=17,e.getMimeType(n,r,i);case 17:if(!(a=t.sent)){t.next=23;break}if(!(l=e.parsersByMime[a])){t.next=22;break}return t.abrupt("return",l);case 22:En.log.warning("Could not determine manifest type using MIME type",a);case 23:throw new wn(wn.severity.CRITICAL,wn.category.MANIFEST,wn.code.UNABLE_TO_GUESS_MANIFEST_TYPE,n);case 24:case"end":return t.stop()}},t)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getMimeType",value:function(){var e=gn(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=bn.RequestType.MANIFEST,(a=vt([t],r)).method="HEAD",e.next=5,n.request(i,a).promise;case 5:return s=e.sent,o=s.headers["content-type"],e.abrupt("return",o?o.toLowerCase():"");case 8:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getExtension",value:function(e){var t=new Z(e).getPath().split("/").pop().split(".");return 1==t.length?"":t.pop().toLowerCase()}},{key:"isSupported",value:function(t,n){return!!lt.supportsMediaSource()&&(n in e.parsersByMime||e.getExtension(t)in e.parsersByExtension)}}],n&&_n(t.prototype,n),r&&_n(t,r),e}());Sn.parsersByMime={},Sn.parsersByExtension={};var Tn=Sn;function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Cn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.estimatedTotal_=0,this.estimatedDownloaded_=0,this.actualDownloaded_=0,this.pending_=new Map,this.nextId_=0}var t,n,r;return t=e,(n=[{key:"open",value:function(e){this.estimatedTotal_+=e;var t=this.nextId_;return this.nextId_++,this.pending_.set(t,e),t}},{key:"close",value:function(e,t){if(this.pending_.has(e)){var n=this.pending_.get(e);this.pending_.delete(e),this.estimatedDownloaded_+=n,this.actualDownloaded_+=t}}},{key:"getEstimatedProgress",value:function(){return 0==this.estimatedTotal_?0:this.estimatedDownloaded_/this.estimatedTotal_}},{key:"getTotalDownloaded",value:function(){return this.actualDownloaded_}}])&&kn(t.prototype,n),r&&kn(t,r),e}();function In(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function An(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){In(a,r,i,s,o,"next",e)}function o(e){In(a,r,i,s,o,"throw",e)}s(void 0)})}}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ln=c.net.NetworkingEngine,Nn=window.shaka,Rn=(window.goog,function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.networkingEngine_=t,this.groups_=new Map,this.destroyer_=new tt(function(){var e=Array.from(r.groups_.values());return Promise.all(e.map(function(e){return e.catch(function(){})}))}),this.onProgress_=n,this.estimator_=new Cn}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"queue",value:function(e,t,n,r){var i=this;this.destroyer_.ensureNotDestroyed();var a=this.estimator_.open(n),s=this.groups_.get(e)||Promise.resolve();this.groups_.set(e,s.then(An(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.fetchSegment_(t);case 2:if(n=e.sent,!i.destroyer_.destroyed()){e.next=5;break}throw new Nn.util.Error(Nn.util.Error.Severity.CRITICAL,Nn.util.Error.Category.STORAGE,Nn.util.Error.Code.OPERATION_ABORTED);case 5:return i.estimator_.close(a,n.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),e.abrupt("return",r(n));case 8:case"end":return e.stop()}},e)}))))}},{key:"waitToFinish",value:function(){var e=An(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.groups_.values());case 2:return e.abrupt("return",this.estimator_.getTotalDownloaded());case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchSegment_",value:function(){var e=An(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ln.RequestType.SEGMENT,r=this.networkingEngine_.request(n,t),e.next=4,r.promise;case 4:return i=e.sent,window.asserts.assert(i.data,"Response data should be non-null!"),e.abrupt("return",i.data);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}])&&xn(t.prototype,n),r&&xn(t,r),e}());function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Pn=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type_=t,this.mechanism_=n,this.cell_=r,this.key_=i,this.asString_=["offline:",t,"/",n,"/",r,"/",i].join("")}var t,n,r;return t=e,r=[{key:"parse",value:function(t){var n=/^offline:([a-z]+)\/([^\/]+)\/([^\/]+)\/([0-9]+)$/.exec(t);if(null==n)return null;var r=n[1];if("manifest"!=r&&"segment"!=r)return null;var i=n[2];if(!i)return null;var a=n[3];if(!a)return null;var s=Number(n[4]);return null==r?null:new e(r,i,a,s)}},{key:"manifest",value:function(t,n,r){return new e("manifest",t,n,r)}},{key:"segment",value:function(t,n,r){return new e("segment",t,n,r)}}],(n=[{key:"isManifest",value:function(){return"manifest"==this.type_}},{key:"isSegment",value:function(){return"segment"==this.type_}},{key:"mechanism",value:function(){return this.mechanism_}},{key:"cell",value:function(){return this.cell_}},{key:"key",value:function(){return this.key_}},{key:"toString",value:function(){return this.asString_}}])&&Mn(t.prototype,n),r&&Mn(t,r),e}();function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Un=window.shaka,Fn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"defaultEquals",value:function(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}},{key:"remove",value:function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},{key:"count",value:function(e,t){var n=0,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){n+=t(s.value)?1:0}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"hasSameElements",value:function(e,t,n){if(n||(n=Un.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;var r=t.slice(),i=!0,a=!1,s=void 0;try{for(var o,u=function(){var e=o.value,t=r.findIndex(function(t){return n(e,t)});if(-1==t)return{v:!1};r[t]=r[r.length-1],r.pop()},l=e[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var c=u();if("object"===On(c))return c.v}}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}return 0==r.length}}],(n=null)&&Dn(t.prototype,n),r&&Dn(t,r),e}());function Bn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Vn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Bn(a,r,i,s,o,"next",e)}function o(e){Bn(a,r,i,s,o,"throw",e)}s(void 0)})}}function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hn=window.shaka,Kn=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"delete",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,u,l,c,d,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=i,a=[],s=!0,o=!1,u=void 0,e.prev=5,l=i.createBuckets_(r)[Symbol.iterator]();case 7:if(s=(c=l.next()).done){e.next=17;break}return d=c.value,h=this.doDelete_(t,n,d),e.next=12,h;case 12:f=e.sent,a=a.concat(f);case 14:s=!0,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),o=!0,u=e.t0;case 23:e.prev=23,e.prev=24,s||null==l.return||l.return();case 26:if(e.prev=26,!o){e.next=29;break}throw u;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.abrupt("return",a);case 32:case"end":return e.stop()}},e,this,[[5,19,23,31],[24,,26,30]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"doDelete_",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Tt({netEngine:n,onError:function(){},onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),e.prev=1,i.configure(t),e.next=5,i.initForRemoval(r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities);case 5:e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),Hn.log.warning("Error initializing EME",e.t0),e.next=12,i.destroy();case 12:return e.abrupt("return",[]);case 13:return e.prev=13,e.next=16,i.setServerCertificate();case 16:e.next=24;break;case 18:return e.prev=18,e.t1=e.catch(13),Hn.log.warning("Error setting server certificate",e.t1),e.next=23,i.destroy();case 23:return e.abrupt("return",[]);case 24:return a=[],e.next=27,Promise.all(r.sessionIds.map(function(){var e=Vn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.removeSession(t);case 3:a.push(t),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),Hn.log.warning("Error deleting offline session",e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()));case 27:return e.next=29,i.destroy();case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}},e,null,[[1,7],[13,18]])}));return function(t,n,r){return e.apply(this,arguments)}}()}],r=[{key:"createBuckets_",value:function(e){var t=t,n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){for(var u=s.value,l=!1,c=0,d=n;c<d.length;c++){var h=d[c];if(t.isCompatible_(h.info,u)){h.sessionIds.push(u.sessionId),l=!0;break}}l||n.push({info:u,sessionIds:[u.sessionId]})}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"isCompatible_",value:function(e,t){var n=function(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType};return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Fn.hasSameElements(e.audioCapabilities,t.audioCapabilities,n)&&Fn.hasSameElements(e.videoCapabilities,t.videoCapabilities,n)}}],n&&jn(t.prototype,n),r&&jn(t,r),e}());Kn.Bucket_={};var Gn=Kn;function Wn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var zn=window.shaka,Yn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mechanisms_=new Map}var t,n,r;return t=e,n=[{key:"destroy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.mechanisms_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(s.destroy())}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return this.mechanisms_.clear(),Promise.all(e)}},{key:"init",value:function(){var t=this;e.getRegistry_().forEach(function(e,n){var r=e();r?t.mechanisms_.set(n,r):zn.log.info("Skipping "+n+" as it is not supported on this platform")});var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=this.mechanisms_.values()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;n.push(u.init())}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return Promise.all(n)}},{key:"getActive",value:function(){var e=null;if(this.mechanisms_.forEach(function(t,n){t.getCells().forEach(function(t,r){t.hasFixedKeySpace()||e||(e={path:{mechanism:n,cell:r},cell:t})})}),e)return e;throw new zn.util.Error(zn.util.Error.Severity.CRITICAL,zn.util.Error.Category.STORAGE,zn.util.Error.Code.MISSING_STORAGE_CELL,"Could not find a cell that supports add-operations")}},{key:"forEachCell",value:function(e){this.mechanisms_.forEach(function(t,n){t.getCells().forEach(function(t,r){e({mechanism:n,cell:r},t)})})}},{key:"getCell",value:function(e,t){var n=this.mechanisms_.get(e);if(!n)throw new zn.util.Error(zn.util.Error.Severity.CRITICAL,zn.util.Error.Category.STORAGE,zn.util.Error.Code.MISSING_STORAGE_CELL,"Could not find mechanism with name "+e);var r=n.getCells().get(t);if(!r)throw new zn.util.Error(zn.util.Error.Severity.CRITICAL,zn.util.Error.Category.STORAGE,zn.util.Error.Code.MISSING_STORAGE_CELL,"Could not find cell with name "+t);return r}},{key:"forEachEmeSessionCell",value:function(e){this.mechanisms_.forEach(function(t,n){e(t.getEmeSessionCell())})}},{key:"getEmeSessionCell",value:function(){var e=Array.from(this.mechanisms_.keys());if(!e.length)throw new zn.util.Error(zn.util.Error.Severity.CRITICAL,zn.util.Error.Category.STORAGE,zn.util.Error.Code.STORAGE_NOT_SUPPORTED,"No supported storage mechanisms found");return this.mechanisms_.get(e[0]).getEmeSessionCell()}},{key:"resolvePath",value:function(e){var t=this.mechanisms_.get(e.mechanism);return t?t.getCells().get(e.cell):null}},{key:"erase",value:function(){var t,n=(t=regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(this.mechanisms_.values()),(r=n.length>0)||e.getRegistry_().forEach(function(e,t){var r=e();r&&n.push(r)}),t.next=5,Promise.all(n.map(function(e){return e.erase()}));case 5:if(r){t.next=8;break}return t.next=8,Promise.all(n.map(function(e){return e.destroy()}));case 8:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(e){Wn(a,r,i,s,o,"next",e)}function o(e){Wn(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()}],r=[{key:"register",value:function(t,n){e.registry_.set(t,n)}},{key:"unregister",value:function(t){e.registry_.delete(t)}},{key:"support",value:function(){var t=e.getRegistry_(),n=!0,r=!1,i=void 0;try{for(var a,s=t.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=(0,a.value)();if(o)return o.destroy(),!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}},{key:"overrideSupport",value:function(t){e.override_=t}},{key:"clearOverride",value:function(){e.override_=null}},{key:"getRegistry_",value:function(){var t=e.override_,n=e.registry_;return window.COMPILED?n:t||n}}],n&&qn(t.prototype,n),r&&qn(t,r),e}();Yn.override_=null,Yn.registry_=new Map;var Xn=Yn;function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qn=window.shaka,Zn=window.goog,Jn=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.presentationStartTime_=t,this.presentationDelay_=n,this.duration_=1/0,this.segmentAvailabilityDuration_=1/0,this.maxSegmentDuration_=1,this.minSegmentStartTime_=null,this.maxSegmentEndTime_=null,this.clockOffset_=0,this.static_=!0,this.userSeekStart_=0,this.autoCorrectDrift_=r}var t,n,r;return t=e,(n=[{key:"getDuration",value:function(){return this.duration_}},{key:"getMaxSegmentDuration",value:function(){return this.maxSegmentDuration_}},{key:"setDuration",value:function(e){window.asserts.assert(e>0,"duration must be > 0"),this.duration_=e}},{key:"getPresentationStartTime",value:function(){return this.presentationStartTime_}},{key:"setClockOffset",value:function(e){this.clockOffset_=e}},{key:"setStatic",value:function(e){this.static_=e}},{key:"setSegmentAvailabilityDuration",value:function(e){window.asserts.assert(e>=0,"segmentAvailabilityDuration must be >= 0"),this.segmentAvailabilityDuration_=e}},{key:"setDelay",value:function(e){window.asserts.assert(e>=0,"delay must be >= 0"),this.presentationDelay_=e}},{key:"getDelay",value:function(){return this.presentationDelay_}},{key:"notifySegments",value:function(e,t){if(0!=e.length){var n=e[0].startTime+t,r=e[e.length-1].endTime+t;if(this.notifyMinSegmentStartTime(n),this.maxSegmentDuration_=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.maxSegmentDuration_),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_){var i=(Date.now()+this.clockOffset_)/1e3;this.presentationStartTime_=i-this.maxSegmentEndTime_-this.maxSegmentDuration_}Qn.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}}},{key:"notifyMinSegmentStartTime",value:function(e){null==this.minSegmentStartTime_?this.minSegmentStartTime_=e:this.minSegmentStartTime_=Math.min(this.minSegmentStartTime_,e)}},{key:"notifyMaxSegmentDuration",value:function(e){this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,e),Qn.log.v1("notifyNewSegmentDuration:","maxSegmentDuration="+this.maxSegmentDuration_)}},{key:"offset",value:function(e){null!=this.minSegmentStartTime_&&(this.minSegmentStartTime_+=e),null!=this.maxSegmentEndTime_&&(this.maxSegmentEndTime_+=e)}},{key:"isLive",value:function(){return this.duration_==1/0&&!this.static_}},{key:"isInProgress",value:function(){return this.duration_!=1/0&&!this.static_}},{key:"getSegmentAvailabilityStart",value:function(){if(window.asserts.assert(this.segmentAvailabilityDuration_>=0,"The availability duration should be positive"),this.segmentAvailabilityDuration_==1/0)return this.userSeekStart_;var e=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return Math.max(this.userSeekStart_,e)}},{key:"setUserSeekStart",value:function(e){this.userSeekStart_=e}},{key:"getSegmentAvailabilityEnd",value:function(){return this.isLive()||this.isInProgress()?Math.min(this.getLiveEdge_(),this.duration_):this.duration_}},{key:"getSafeSeekRangeStart",value:function(e){var t=Math.max(this.minSegmentStartTime_,this.userSeekStart_);if(this.segmentAvailabilityDuration_==1/0)return t;var n=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_,r=Math.min(n+e,this.getSeekRangeEnd());return Math.max(t,r)}},{key:"getSeekRangeStart",value:function(){return this.getSafeSeekRangeStart(0)}},{key:"getSeekRangeEnd",value:function(){var e=this.isLive()||this.isInProgress()?this.presentationDelay_:0;return Math.max(0,this.getSegmentAvailabilityEnd()-e)}},{key:"usingPresentationStartTime",value:function(){return null!=this.presentationStartTime_&&null==this.maxSegmentEndTime_}},{key:"getLiveEdge_",value:function(){window.asserts.assert(null!=this.presentationStartTime_,"Cannot compute timeline live edge without start time");var e=(Date.now()+this.clockOffset_)/1e3;return Math.max(0,e-this.maxSegmentDuration_-this.presentationStartTime_)}},{key:"assertIsValid",value:function(){Zn.DEBUG&&(this.isLive()?window.asserts.assert(null!=this.presentationStartTime_,"Detected as live stream, but does not match our model of live!"):this.isInProgress()?window.asserts.assert(null!=this.presentationStartTime_&&this.segmentAvailabilityDuration_==1/0,"Detected as IPR stream, but does not match our model of IPR!"):window.asserts.assert(this.segmentAvailabilityDuration_==1/0&&this.duration_!=1/0&&this.static_,"Detected as VOD stream, but does not match our model of VOD!"))}}])&&$n(t.prototype,n),r&&$n(t,r),e}();function er(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nr(e,t,n){return t&&tr(e.prototype,t),n&&tr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var rr=function(){function e(t,n,r){er(this,e),this.getUris=t,this.startByte=n,this.endByte=r}return nr(e,[{key:"createUris",value:function(){return this.getUris()}},{key:"getStartByte",value:function(){return this.startByte}},{key:"getEndByte",value:function(){return this.endByte}},{key:"getSize",value:function(){return this.endByte?this.endByte-this.startByte:null}}]),e}(),ir=function(){function e(t,n,r,i,a,s){er(this,e),window.asserts.assert(n<r,"startTime must be less than endTime"),window.asserts.assert(a<s||null==s,"startByte must be < endByte"),this.position=t,this.startTime=n,this.endTime=r,this.getUris=i,this.startByte=a,this.endByte=s}return nr(e,[{key:"getPosition",value:function(){return this.position}},{key:"getStartTime",value:function(){return this.startTime}},{key:"getEndTime",value:function(){return this.endTime}},{key:"createUris",value:function(){return this.getUris()}},{key:"getStartByte",value:function(){return this.startByte}},{key:"getEndByte",value:function(){return this.endByte}},{key:"getSize",value:function(){return this.endByte?this.endByte-this.startByte:null}}]),e}();function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var sr=window.shaka,or=window.goog,ur=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),or.DEBUG&&e.assertCorrectReferences_(t),this.references_=t}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.references_=null,Promise.resolve()}},{key:"find",value:function(e){for(var t=this.references_.length-1;t>=0;--t){var n=this.references_[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.references_.length&&e<this.references_[0].startTime?this.references_[0].position:null}},{key:"get",value:function(e){if(0==this.references_.length)return null;var t=e-this.references_[0].position;return t<0||t>=this.references_.length?null:this.references_[t]}},{key:"offset",value:function(e){for(var t=0;t<this.references_.length;++t)this.references_[t].startTime+=e,this.references_[t].endTime+=e}},{key:"merge",value:function(t){or.DEBUG&&e.assertCorrectReferences_(t);for(var n=[],r=0,i=0;r<this.references_.length&&i<t.length;){var a=this.references_[r],s=t[i];if(a.startTime<s.startTime)n.push(a),r++;else if(a.startTime>s.startTime)0==r?n.push(s):sr.log.warning("Refusing to rewrite original references on update!"),i++;else{if(Math.abs(a.endTime-s.endTime)>.1){window.asserts.assert(s.endTime>a.endTime&&r==this.references_.length-1&&i==t.length-1,"This should be an update of the last segment in a period");var o=new ir(a.position,s.startTime,s.endTime,s.getUris,s.startByte,s.endByte);n.push(o)}else n.push(a);r++,i++}}for(;r<this.references_.length;)n.push(this.references_[r++]);if(n.length)for(var u=n[n.length-1].position+1;i<t.length;){var l=t[i++],c=new ir(u++,l.startTime,l.endTime,l.getUris,l.startByte,l.endByte);n.push(c)}else n=t;or.DEBUG&&e.assertCorrectReferences_(n),this.references_=n}},{key:"replace",value:function(t){or.DEBUG&&e.assertCorrectReferences_(t),this.references_=t}},{key:"evict",value:function(e){for(var t=0;t<this.references_.length;++t)if(this.references_[t].endTime>e)return void this.references_.splice(0,t);this.references_=[]}},{key:"fit",value:function(e){for(window.asserts.assert(null!=e,"Period duration must be known for static content!"),window.asserts.assert(e!=1/0,"Period duration must be finite for static content!");this.references_.length;){if(!(this.references_[this.references_.length-1].startTime>=e))break;this.references_.pop()}for(;this.references_.length;){if(!(this.references_[0].endTime<=0))break;this.references_.shift()}if(0!=this.references_.length){var t=this.references_[this.references_.length-1];this.references_[this.references_.length-1]=new ir(t.position,t.startTime,e,t.getUris,t.startByte,t.endByte)}}}])&&ar(t.prototype,n),r&&ar(t,r),e}();function lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}or.DEBUG&&(ur.assertCorrectReferences_=function(e){window.asserts.assert(e.every(function(t,n){if(0==n)return!0;var r=e[n-1];return t.position==r.position+1&&(r.startTime<t.startTime||!(r.startTime>t.startTime)&&r.endTime<=t.endTime)}),"SegmentReferences are incorrect")});
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var cr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mechanism_=t,this.cell_=n}var t,n,r;return t=e,(n=[{key:"fromManifestDB",value:function(e){var t=this,n=new Jn(null,0);n.setDuration(e.duration);var r=e.periods.map(function(e){return t.fromPeriodDB(e,n)}),i=e.drmInfo?[e.drmInfo]:[];if(e.drmInfo){var a=!0,s=!1,o=void 0;try{for(var u,l=r[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=!0,h=!1,f=void 0;try{for(var p,m=c.variants[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){p.value.drmInfos=i}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}}return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:r}}},{key:"fromPeriodDB",value:function(e,t){var n=this,r=e.streams.filter(function(e){return n.isAudio_(e)}),i=e.streams.filter(function(e){return n.isVideo_(e)}),a=this.createVariants(r,i),s=e.streams.filter(function(e){return n.isText_(e)}).map(function(e){return n.fromStreamDB_(e)}),o=!0,u=!1,l=void 0;try{for(var c,d=e.streams[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value.segments.map(function(e,t){return n.fromSegmentDB_(t,e)});t.notifySegments(h,e.startTime)}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}return{startTime:e.startTime,variants:Array.from(a.values()),textStreams:s}}},{key:"createVariants",value:function(e,t){var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=!0,c=!1,d=void 0;try{for(var h,f=u.variantIds[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;n.add(p)}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var m=!0,v=!1,y=void 0;try{for(var g,_=t[Symbol.iterator]();!(m=(g=_.next()).done);m=!0){var b=g.value,w=!0,E=!1,S=void 0;try{for(var T,k=b.variantIds[Symbol.iterator]();!(w=(T=k.next()).done);w=!0){var C=T.value;n.add(C)}}catch(e){E=!0,S=e}finally{try{w||null==k.return||k.return()}finally{if(E)throw S}}}}catch(e){v=!0,y=e}finally{try{m||null==_.return||_.return()}finally{if(v)throw y}}var I=new Map,A=!0,x=!1,L=void 0;try{for(var N,R=n[Symbol.iterator]();!(A=(N=R.next()).done);A=!0){var M=N.value;I.set(M,this.createEmptyVariant_(M))}}catch(e){x=!0,L=e}finally{try{A||null==R.return||R.return()}finally{if(x)throw L}}var P=!0,O=!1,D=void 0;try{for(var U,F=e[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value,V=this.fromStreamDB_(B),j=!0,H=!1,K=void 0;try{for(var G,W=B.variantIds[Symbol.iterator]();!(j=(G=W.next()).done);j=!0){var q=G.value,z=I.get(q);window.asserts.assert(!z.audio,"A variant should only have one audio stream"),z.language=V.language,z.primary=z.primary||V.primary,z.audio=V}}catch(e){H=!0,K=e}finally{try{j||null==W.return||W.return()}finally{if(H)throw K}}}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}var Y=!0,X=!1,$=void 0;try{for(var Q,Z=t[Symbol.iterator]();!(Y=(Q=Z.next()).done);Y=!0){var J=Q.value,ee=this.fromStreamDB_(J),te=!0,ne=!1,re=void 0;try{for(var ie,ae=J.variantIds[Symbol.iterator]();!(te=(ie=ae.next()).done);te=!0){var se=ie.value,oe=I.get(se);window.asserts.assert(!oe.video,"A variant should only have one video stream"),oe.primary=oe.primary||ee.primary,oe.video=ee}}catch(e){ne=!0,re=e}finally{try{te||null==ae.return||ae.return()}finally{if(ne)throw re}}}}catch(e){X=!0,$=e}finally{try{Y||null==Z.return||Z.return()}finally{if(X)throw $}}return I}},{key:"fromStreamDB_",value:function(e){var t=this,n=e.segments.map(function(e,n){return t.fromSegmentDB_(n,e)}),r=new ur(n),i={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return r.find(e)},getSegmentReference:function(e){return r.get(e)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null};return null!=e.initSegmentKey&&(i.initSegmentReference=this.fromInitSegmentDB_(e.initSegmentKey)),i}},{key:"fromSegmentDB_",value:function(e,t){var n=Pn.segment(this.mechanism_,this.cell_,t.dataKey);return new ir(e,t.startTime,t.endTime,function(){return[n.toString()]},0,null)}},{key:"fromInitSegmentDB_",value:function(e){var t=Pn.segment(this.mechanism_,this.cell_,e);return new rr(function(){return[t.toString()]},0,null)}},{key:"isAudio_",value:function(e){var t=ee.ContentType;return e.contentType==t.AUDIO}},{key:"isVideo_",value:function(e){var t=ee.ContentType;return e.contentType==t.VIDEO}},{key:"isText_",value:function(e){var t=ee.ContentType;return e.contentType==t.TEXT}},{key:"createEmptyVariant_",value:function(e){return{id:e,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0}}}])&&lr(t.prototype,n),r&&lr(t,r),e}();function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var hr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fromManifest",value:function(t,n,r,i){window.asserts.assert(n.periods.length,"Cannot create stored content from manifest with no periods.");var a=null==n.expiration?1/0:n.expiration,s=n.presentationTimeline.getDuration(),o=n.periods[0];return{offlineUri:null,originalManifestUri:t,duration:s,size:r,expiration:a,tracks:e.getTracks_(o),appMetadata:i}}},{key:"fromManifestDB",value:function(t,n){window.asserts.assert(n.periods.length,"Cannot create stored content from manifestDB with no periods.");var r=new cr(t.mechanism(),t.cell()),i=n.periods[0],a=new Jn(null,0),s=r.fromPeriodDB(i,a),o=n.appMetadata||{},u=e.getTracks_(s);return{offlineUri:t.toString(),originalManifestUri:n.originalManifestUri,duration:n.duration,size:n.size,expiration:n.expiration,tracks:u,appMetadata:o}}},{key:"getTracks_",value:function(e){var t=an,n=[],r=t.getPlayableVariants(e.variants),i=!0,a=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;n.push(t.variantToTrack(l))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var c=e.textStreams,d=!0,h=!1,f=void 0;try{for(var p,m=c[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;n.push(t.textStreamToTrack(v))}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}return n}}],(n=null)&&dr(t.prototype,n),r&&dr(t,r),e}();function fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pr=window.shaka,mr=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.estimateByStreamId_={}}var t,n,r;return t=e,(n=[{key:"addVariant",value:function(t){var n=t.audio,r=t.video;if(n&&!r){var i=n.bandwidth||t.bandwidth;this.setBitrate_(n.id,i)}if(!n&&r){var a=r.bandwidth||t.bandwidth;this.setBitrate_(r.id,a)}if(n&&r){var s=n.bandwidth||e.DEFAULT_AUDIO_BITRATE_,o=r.bandwidth||t.bandwidth-s;o<=0&&(pr.log.warning("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),o=t.bandwidth),this.setBitrate_(n.id,s),this.setBitrate_(r.id,o)}}},{key:"setBitrate_",value:function(e,t){this.estimateByStreamId_[e]=t}},{key:"addText",value:function(t){this.estimateByStreamId_[t.id]=e.DEFAULT_TEXT_BITRATE_}},{key:"getSegmentEstimate",value:function(e,t){var n=t.endTime-t.startTime;return this.getEstimate_(e)*n}},{key:"getInitSegmentEstimate",value:function(e){return.5*this.getEstimate_(e)}},{key:"getEstimate_",value:function(e){var t=this.estimateByStreamId_[e];return null==t&&(t=0,pr.log.error("Asking for bitrate of stream not given to the estimator")),0==t&&pr.log.warning("Using bitrate of 0, this stream won't affect progress"),t}}])&&fr(t.prototype,n),r&&fr(t,r),e}());mr.DEFAULT_AUDIO_BITRATE_=393216,mr.DEFAULT_TEXT_BITRATE_=52;var vr=mr;function yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e,t,n){return t&&gr(e.prototype,t),n&&gr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var br=function(){function e(){yr(this,e)}return _r(e,null,[{key:"filterByRestrictions",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=e.periods[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;u.variants=u.variants.filter(function(e){return an.meetsRestrictions(e,t,n)})}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"filterByMediaSourceSupport",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.periods[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;s.variants=s.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&Jt.isStreamSupported(e.audio)),e.video&&(t=t&&Jt.isStreamSupported(e.video)),t})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"filterByDrmSupport",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.variants=o.variants.filter(function(e){return t.supportsVariant(e)})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"filterByCommonCodecs",value:function(t){window.asserts.assert(t.periods.length>0,"There should be at least be one period");var n=new e.VariantCodecSummarySet,r=!0,i=!0,a=!1,s=void 0;try{for(var o,u=t.periods[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=e.VariantCodecSummarySet.fromVariants(l.variants);r?(n.includeAll(c),r=!1):n.onlyKeep(c)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=t.periods[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.variants=v.variants.filter(function(t){var r=new e.VariantCodecSummary(t);return n.contains(r)})}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"rollingFilter",value:function(t,n){var r=null,i=!0,a=!1,s=void 0;try{for(var o,u=t.periods[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;r&&(l.variants=l.variants.filter(function(t){var n=new e.VariantCodecSummary(t);return r.contains(n)})),n(l),r=e.VariantCodecSummarySet.fromVariants(l.variants)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}}}]),e}();br.VariantCodecSummary=function(){function e(t){yr(this,e);var n=t.audio,r=t.video;this.audioMime_=n?n.mimeType:null,this.audioCodec_=n?n.codecs.split(".")[0]:null,this.videoMime_=r?r.mimeType:null,this.videoCodec_=r?r.codecs.split(".")[0]:null}return _r(e,[{key:"equals",value:function(e){return this.audioMime_==e.audioMime_&&this.audioCodec_==e.audioCodec_&&this.videoMime_==e.videoMime_&&this.videoCodec_==e.videoCodec_}}]),e}(),br.VariantCodecSummarySet=function(){function e(){yr(this,e),this.all_=[]}return _r(e,[{key:"add",value:function(e){this.contains(e)||this.all_.push(e)}},{key:"includeAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.all_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.add(s)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onlyKeep",value:function(e){this.all_=this.all_.filter(function(t){return e.contains(t)})}},{key:"contains",value:function(e){return this.all_.some(function(t){return e.equals(t)})}}],[{key:"fromVariants",value:function(e){var t=new br.VariantCodecSummarySet,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.add(new br.VariantCodecSummary(o))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}}]),e}();var wr=br;function Er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
c.net.NetworkingEngine,window.shaka,window.goog;var Sr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createSegmentRequest",value:function(e,t,n,r){var i=vt(e,r);return 0==t&&null==n||(i.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),i}}],(n=null)&&Er(t.prototype,n),r&&Er(t,r),e}();function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var kr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getAllVariantsFrom",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=!0,l=!1,c=void 0;try{for(var d,h=o.variants[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value;t.push(f)}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"findPeriodForTime",value:function(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;t>=u.startTime&&(n=u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}}],(n=null)&&Tr(t.prototype,n),r&&Tr(t,r),e}();function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Ar=function(){function e(){Cr(this,e),this.history_=new Map}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this.history_.clear()}},{key:"useVariant",value:function(e,t){this.getFrameFor_(e).variant=t}},{key:"useText",value:function(e,t){this.getFrameFor_(e).text=t}},{key:"getVariant",value:function(e){return this.getFrameFor_(e).variant}},{key:"getText",value:function(e){return this.getFrameFor_(e).text}},{key:"getFrameFor_",value:function(t){if(!this.history_.has(t)){var n=new e.Frame;this.history_.set(t,n)}return this.history_.get(t)}}])&&Ir(t.prototype,n),r&&Ir(t,r),e}();Ar.Frame=function(){return function e(){Cr(this,e),this.variant=null,this.text=null}}();var xr=Ar;function Lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Nr=window.shaka,Rr=(window.goog,function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root_=t,this.variants_=new Set([t]),n=n||[];var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;this.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}var t,n,r;return t=e,r=[{key:"areAdaptable",value:function(t,n){return!!t.audio==!!n.audio&&(!!t.video==!!n.video&&(t.language==n.language&&(window.asserts.assert(!!t.audio==!!n.audio,"Both should either have audio or not have audio."),!(t.audio&&n.audio&&!e.areAudiosCompatible_(t.audio,n.audio))&&(window.asserts.assert(!!t.video==!!n.video,"Both should either have video or not have video."),!(t.video&&n.video&&!e.areVideosCompatible_(t.video,n.video))))))}},{key:"areAudiosCompatible_",value:function(t,n){return t.channelsCount==n.channelsCount&&(!!e.canTransitionBetween_(t,n)&&!!e.areRolesEqual_(t.roles,n.roles))}},{key:"areVideosCompatible_",value:function(t,n){return!!e.canTransitionBetween_(t,n)&&!!e.areRolesEqual_(t.roles,n.roles)}},{key:"canTransitionBetween_",value:function(e,t){if(e.mimeType!=t.mimeType)return!1;var n=st.splitCodecs(e.codecs).map(function(e){return st.getCodecBase(e)}),r=st.splitCodecs(t.codecs).map(function(e){return st.getCodecBase(e)});if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=0;i<n.length;i++)if(n[i]!=r[i])return!1;return!0}},{key:"areRolesEqual_",value:function(e,t){var n=new Set(e),r=new Set(t);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;var i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;if(!r.has(l))return!1}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return!0}}],(n=[{key:"add",value:function(e){return this.canInclude(e)?(this.variants_.add(e),!0):(Nr.log.warning("Rejecting variant - not compatible with root."),!1)}},{key:"canInclude",value:function(t){return e.areAdaptable(this.root_,t)}},{key:"values",value:function(){return this.variants_.values()}}])&&Lr(t.prototype,n),r&&Lr(t,r),e}());function Mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Or(e,t,n){return t&&Pr(e.prototype,t),n&&Pr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dr=window.shaka,Ur=function(){function e(t){Mr(this,e),this.example_=t;var n=t.audio&&t.audio.channelsCount?t.audio.channelsCount:0;this.fallback_=new Fr(t.language,"",n)}return Or(e,[{key:"create",value:function(e){var t=this,n=e.filter(function(e){return Rr.areAdaptable(t.example_,e)});return n.length?new Rr(n[0],n):this.fallback_.create(e)}}]),e}(),Fr=function(){function e(t,n,r){Mr(this,e),this.language_=t,this.role_=n,this.channelCount_=r}return Or(e,[{key:"create",value:function(t){var n=e,r=[],i=n.filterByLanguage_(t,this.language_),a=t.filter(function(e){return e.primary});if(r=i.length?i:a.length?a:t,this.role_){var s=n.filterVariantsByRole_(r,this.role_);s.length?r=s:Dr.log.warning("No exact match for variant role could be found.")}if(this.channelCount_){var o=an.filterVariantsByAudioChannelCount(r,this.channelCount_);o.length?r=o:Dr.log.warning("No exact match for the channel count could be found.")}var u=new Rr(r[0]),l=!0,c=!1,d=void 0;try{for(var h,f=r[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;u.canInclude(p)&&u.add(p)}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}return u}}],[{key:"filterByLanguage_",value:function(e,t){var n=ne.normalize(t),r=ne.findClosestLocale(n,e.map(function(e){return ne.getLocaleForVariant(e)}));return r?e.filter(function(e){return r==ne.getLocaleForVariant(e)}):[]}},{key:"filterVariantsByRole_",value:function(e,t){return e.filter(function(e){var n=e.audio,r=e.video;return n&&n.roles.indexOf(t)>=0||r&&r.roles.indexOf(t)>=0})}}]),e}();function Br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Vr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=e.State;this.previousState_=r.SATISFIED,this.thresholds_=(new Map).set(r.SATISFIED,n).set(r.STARVING,t)}var t,n,r;return t=e,(n=[{key:"update",value:function(t,n){var r=e.State,i=this.thresholds_.get(this.previousState_),a=this.previousState_,s=n||t>=i?r.SATISFIED:r.STARVING;return this.previousState_=s,a!=s}},{key:"setState",value:function(e){this.previousState_=e}},{key:"getState",value:function(){return this.previousState_}}])&&Br(t.prototype,n),r&&Br(t,r),e}();Vr.State={STARVING:0,SATISFIED:1};var jr=Vr;function Hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Kr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest_=t,this.currentPeriod_=null,this.onChangedPeriods_=function(e){}}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.manifest_=null,this.currentPeriod_=null,this.onChangedPeriods_=function(e){}}},{key:"poll",value:function(e,t){var n=this.currentPeriod_,r=this.findCurrentPeriod_(e);n!=r&&this.onChangedPeriods_(r),this.currentPeriod_=r}},{key:"setListeners",value:function(e){this.onChangedPeriods_=e}},{key:"findCurrentPeriod_",value:function(e){var t=this.manifest_.periods;return kr.findPeriodForTime(t,e)||t[0]}}])&&Hr(t.prototype,n),r&&Hr(t,r),e}();function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Wr=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.harness_=t,this.isBuffering_=!1,this.rate_=this.harness_.getRate(),this.pollRate_=.25,this.timer_=new ve(function(){n.harness_.movePlayhead(n.rate_*n.pollRate_)})}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.harness_=null}},{key:"setBuffering",value:function(e){this.isBuffering_=e,this.apply_()}},{key:"set",value:function(e){window.asserts.assert(0!=e,"Should never set rate of 0 explicitly!"),this.rate_=e,this.apply_()}},{key:"getActiveRate",value:function(){return this.calculateCurrentRate_()}},{key:"apply_",value:function(){this.timer_.stop();var e=this.calculateCurrentRate_();if(e>=0)try{return void this.applyRate_(e)}catch(e){}this.timer_.tickEvery(this.pollRate_),this.applyRate_(0)}},{key:"calculateCurrentRate_",value:function(){return this.isBuffering_?0:this.rate_}},{key:"applyRate_",value:function(e){var t=this.harness_.getRate();return t!=e&&this.harness_.setRate(e),t!=e}}])&&Gr(t.prototype,n),r&&Gr(t,r),e}();Wr.Harness;var qr=Wr;function zr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xr(e,t,n){return t&&Yr(e.prototype,t),n&&Yr(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $r=window.shaka,Qr=(window.goog,function(){function e(t,n,r){zr(this,e),this.video_=t,this.onSeek_=n,this.startTime_=r,this.eventManager_=new he,this.mover_=new Zr(t,10),t.readyState>0?this.setStartTime_(r):this.delaySetStartTime_(r)}return Xr(e,[{key:"release",value:function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.mover_&&(this.mover_.release(),this.mover_=null),this.onSeek_=function(){},this.video_=null}},{key:"getTime",value:function(){return this.video_.readyState>0?this.video_.currentTime:this.startTime_}},{key:"setTime",value:function(e){this.video_.readyState>0?this.mover_.moveTo(e):this.delaySetStartTime_(e)}},{key:"delaySetStartTime_",value:function(e){var t=this;this.startTime_=e,this.eventManager_.unlisten(this.video_,"loadedmetadata"),this.eventManager_.listenOnce(this.video_,"loadedmetadata",function(){t.setStartTime_(e)})}},{key:"setStartTime_",value:function(e){var t=this;Math.abs(this.video_.currentTime-e)<.001?this.startListeningToSeeks_():(this.eventManager_.listenOnce(this.video_,"seeking",function(){t.startListeningToSeeks_()}),this.mover_.moveTo(0==this.video_.currentTime?e:this.video_.currentTime))}},{key:"startListeningToSeeks_",value:function(){var e=this;window.asserts.assert(this.video_.readyState>0,"The media element should be ready before we listen for seeking."),this.eventManager_.listen(this.video_,"seeking",function(){return e.onSeek_()})}}]),e}()),Zr=function(){function e(t,n){var r=this;zr(this,e),this.mediaElement_=t,this.maxAttempts_=n,this.remainingAttempts_=0,this.originTime_=0,this.targetTime_=0,this.timer_=new ve(function(){return r.onTick_()})}return Xr(e,[{key:"release",value:function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.mediaElement_=null}},{key:"moveTo",value:function(e){this.originTime_=this.mediaElement_.currentTime,this.targetTime_=e,this.remainingAttempts_=this.maxAttempts_,this.mediaElement_.currentTime=e,this.timer_.tickEvery(.1)}},{key:"onTick_",value:function(){if(this.remainingAttempts_<=0)return $r.log.warning(["Failed to move playhead from",this.originTime_,"to",this.targetTime_].join(" ")),void this.timer_.stop();this.mediaElement_.currentTime==this.originTime_?(this.mediaElement_.currentTime=this.targetTime_,this.remainingAttempts_--):this.timer_.stop()}}]),e}();function Jr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ei(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ti(e,t,n){return t&&ei(e.prototype,t),n&&ei(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var ni=function(){function e(t,n){Jr(this,e),this.implementation_=t,this.wasMakingProgress_=t.shouldBeMakingProgress(),this.value_=t.getPresentationSeconds(),this.lastUpdateSeconds_=t.getWallSeconds(),this.stallThresholdSeconds_=n,this.onStall_=function(){}}return ti(e,[{key:"release",value:function(){this.implementation_=null,this.onStall_=function(){}}},{key:"onStall",value:function(e){this.onStall_=e}},{key:"poll",value:function(){var e=this.implementation_,t=e.shouldBeMakingProgress(),n=e.getPresentationSeconds(),r=e.getWallSeconds();(this.value_!=n||this.wasMakingProgress_!=t)&&(this.lastUpdateSeconds_=r,this.value_=n,this.wasMakingProgress_=t);var i=r-this.lastUpdateSeconds_;i>=this.stallThresholdSeconds_&&t&&this.onStall_(this.value_,i)}}]),e}(),ri=function(){function e(t){Jr(this,e),this.mediaElement_=t}return ti(e,[{key:"shouldBeMakingProgress",value:function(){return!this.mediaElement_.paused&&(0!=this.mediaElement_.playbackRate&&(null!=this.mediaElement_.buffered&&e.hasContentFor_(this.mediaElement_.buffered,this.mediaElement_.currentTime)))}},{key:"getPresentationSeconds",value:function(){return this.mediaElement_.currentTime}},{key:"getWallSeconds",value:function(){return Date.now()/1e3}}],[{key:"hasContentFor_",value:function(e,t){for(var n=0;n<e.length;n++){var r=e.start(n),i=e.end(n);if(!(t<r)&&!(t>i-.5))return!0}return!1}}]),e}();function ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ai=window.shaka,si=function(){function e(t,n,r,i,a){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=t,this.timeline_=n,this.config_=r,this.onEvent_=a,this.eventManager_=new he,this.seekingEventReceived_=!1,this.prevReadyState_=t.readyState,this.didFireLargeGap_=!1,this.stallDetector_=i,this.hadSegmentAppended_=!1,this.eventManager_.listen(t,"waiting",function(){return s.onPollGapJump_()}),this.gapJumpTimer_=new ve(function(){s.onPollGapJump_()}).tickEvery(.25)}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.gapJumpTimer_&&(this.gapJumpTimer_.stop(),this.gapJumpTimer_=null),this.stallDetector_&&(this.stallDetector_.release(),this.stallDetector_=null),this.onEvent_=null,this.timeline_=null,this.video_=null}},{key:"onSegmentAppended",value:function(){this.hadSegmentAppended_=!0,this.onPollGapJump_()}},{key:"onSeeking",value:function(){this.seekingEventReceived_=!0,this.hadSegmentAppended_=!1,this.didFireLargeGap_=!1}},{key:"onPollGapJump_",value:function(){if(0!=this.video_.readyState){if(this.video_.seeking){if(!this.seekingEventReceived_)return}else this.seekingEventReceived_=!1;if(!this.video_.paused){this.video_.readyState!=this.prevReadyState_&&(this.didFireLargeGap_=!1,this.prevReadyState_=this.video_.readyState);var t=this.config_.smallGapLimit,n=this.video_.currentTime,r=this.video_.buffered,i=Mt.getGapIndex(r,n);if(null!=i){if(0!=i||this.hadSegmentAppended_){var a=r.start(i);if(!(a>=this.timeline_.getSeekRangeEnd())){var s=a-n,o=s<=t,u=!1;if(!(s<e.BROWSER_GAP_TOLERANCE)){if(!o&&!this.didFireLargeGap_){this.didFireLargeGap_=!0;var l=new D("largegap",{currentTime:n,gapSize:s});l.cancelable=!0,this.onEvent_(l),this.config_.jumpLargeGaps&&!l.defaultPrevented?u=!0:ai.log.info("Ignoring large gap at",n,"size",s)}(o||u)&&(0==i?ai.log.info("Jumping forward",s,"seconds because of gap before start time of",a):ai.log.info("Jumping forward",s,"seconds because of gap starting at",r.end(i-1),"and ending at",a),this.video_.currentTime=a)}}}}else this.stallDetector_&&this.stallDetector_.poll()}}}}])&&ii(t.prototype,n),r&&ii(t,r),e}();si.BROWSER_GAP_TOLERANCE=.001;var oi=si;function ui(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ci(e,t,n){return t&&li(e.prototype,t),n&&li(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var di=window.shaka,hi=(window.goog,function(){function e(t,n,r,i,a,s){var o=this;ui(this,e),this.minSeekRange_=3,this.mediaElement_=t,this.timeline_=n.presentationTimeline,this.minBufferTime_=n.minBufferTime||0,this.config_=r,this.onSeek_=a,this.lastCorrectiveSeek_=null,this.gapController_=new oi(t,n.presentationTimeline,r,this.createStallDetector_(t,r),s),this.videoWrapper_=new Qr(t,function(){return o.onSeeking_()},this.getStartTime_(i)),this.checkWindowTimer_=new ve(function(){o.onPollWindow_()}).tickEvery(.25)}return ci(e,[{key:"release",value:function(){this.videoWrapper_&&(this.videoWrapper_.release(),this.videoWrapper_=null),this.gapController_&&(this.gapController_.release(),this.gapController_=null),this.checkWindowTimer_&&(this.checkWindowTimer_.stop(),this.checkWindowTimer_=null),this.config_=null,this.timeline_=null,this.videoWrapper_=null,this.mediaElement_=null,this.onSeek_=function(){}}},{key:"setStartTime",value:function(e){this.videoWrapper_.setTime(e)}},{key:"getTime",value:function(){var e=this.videoWrapper_.getTime();return this.mediaElement_.readyState>0&&!this.mediaElement_.paused?this.clampTime_(e):e}},{key:"getStartTime_",value:function(e){return null==e?e=this.timeline_.getDuration()<1/0?this.timeline_.getSeekRangeStart():this.timeline_.getSeekRangeEnd():e<0&&(e=this.timeline_.getSeekRangeEnd()+e),this.clampSeekToDuration_(this.clampTime_(e))}},{key:"notifyOfBufferingChange",value:function(){this.gapController_.onSegmentAppended()}},{key:"onPollWindow_",value:function(){if(0!=this.mediaElement_.readyState&&!this.mediaElement_.paused){var e=this.mediaElement_.currentTime,t=this.timeline_.getSeekRangeStart(),n=this.timeline_.getSeekRangeEnd();if(n-t<this.minSeekRange_&&(t=n-this.minSeekRange_),e<t){var r=this.reposition_(e);di.log.info("Jumping forward "+(r-e)+" seconds to catch up with the seek range."),this.mediaElement_.currentTime=r}}}},{key:"onSeeking_",value:function(){this.gapController_.onSeeking();var e=this.videoWrapper_.getTime(),t=this.reposition_(e),n=oi.BROWSER_GAP_TOLERANCE;if(Math.abs(t-e)>n){var r=(new Date).getTime()/1e3;if(!this.lastCorrectiveSeek_||this.lastCorrectiveSeek_<r-1)return this.lastCorrectiveSeek_=r,void this.videoWrapper_.setTime(t)}di.log.v1("Seek to "+e),this.onSeek_()}},{key:"clampSeekToDuration_",value:function(e){var t=this.timeline_.getDuration();return e>=t?(window.asserts.assert(this.config_.durationBackoff>=0,"Duration backoff must be non-negative!"),t-this.config_.durationBackoff):e}},{key:"reposition_",value:function(e){var t=this;window.asserts.assert(this.config_,"Cannot reposition playhead when it has beeen destroyed");var n=function(e){return Mt.isBuffered(t.mediaElement_.buffered,e)},r=Math.max(this.minBufferTime_,this.config_.rebufferingGoal),i=this.config_.safeSeekOffset,a=this.timeline_.getSeekRangeStart(),s=this.timeline_.getSeekRangeEnd(),o=this.timeline_.getDuration();s-a<this.minSeekRange_&&(a=s-this.minSeekRange_);var u=this.timeline_.getSafeSeekRangeStart(r),l=this.timeline_.getSafeSeekRangeStart(i),c=this.timeline_.getSafeSeekRangeStart(r+i);return e>=o?(di.log.v1("Playhead past duration."),this.clampSeekToDuration_(e)):e>s?(di.log.v1("Playhead past end."),s):e<a?n(l)?(di.log.v1("Playhead before start & start is buffered"),l):(di.log.v1("Playhead before start & start is unbuffered"),c):e>=u||n(e)?(di.log.v1("Playhead in safe region or in buffered region."),e):(di.log.v1("Playhead outside safe region & in unbuffered region."),c)}},{key:"clampTime_",value:function(e){var t=this.timeline_.getSeekRangeStart();if(e<t)return t;var n=this.timeline_.getSeekRangeEnd();return e>n?n:e}},{key:"createStallDetector_",value:function(e,t){if(!t.stallEnabled)return null;var n=t.stallThreshold,r=t.stallSkip,i=new ni(new ri(e),n);return i.onStall(function(t,n){di.log.debug(["Stall detected at",t,"for",n,"seconds. Seeking forward",r,"seconds."].join(" ")),e.currentTime+=r}),i}}]),e}());function fi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mi(e,t,n){return t&&pi(e.prototype,t),n&&pi(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.goog;var vi=function(){function e(t){var n=this;fi(this,e),this.mediaElement_=t,this.observers_=new Set,this.pollingLoop_=new ve(function(){n.pollAllObservers_(!1)}).tickEvery(.25)}return mi(e,[{key:"release",value:function(){this.pollingLoop_.stop();var e=!0,t=!1,n=void 0;try{for(var r,i=this.observers_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.release()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.observers_.clear()}},{key:"manage",value:function(e){this.observers_.add(e)}},{key:"notifyOfSeek",value:function(){this.pollAllObservers_(!0)}},{key:"pollAllObservers_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.observers_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.poll(this.mediaElement_.currentTime,e)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}]),e}();function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var gi=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeline_=t,this.oldPosition_=new Map,this.onEnter_=function(e,t){},this.onExit_=function(e,t){},this.onSkip_=function(e,t){};var r=e.RelativePosition_,i=r.BEFORE_THE_REGION,a=r.IN_THE_REGION,s=r.AFTER_THE_REGION;this.rules_=[{weWere:null,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:i,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:s,weAre:a,invoke:function(e,t){return n.onEnter_(e,t)}},{weWere:a,weAre:i,invoke:function(e,t){return n.onExit_(e,t)}},{weWere:a,weAre:s,invoke:function(e,t){return n.onExit_(e,t)}},{weWere:i,weAre:s,invoke:function(e,t){return n.onSkip_(e,t)}},{weWere:s,weAre:i,invoke:function(e,t){return n.onSkip_(e,t)}}]}var t,n,r;return t=e,r=[{key:"determinePositionRelativeTo_",value:function(t,n){var r=e.RelativePosition_;return n<t.startTime?r.BEFORE_THE_REGION:n>t.endTime?r.AFTER_THE_REGION:r.IN_THE_REGION}}],(n=[{key:"release",value:function(){this.timeline_=null,this.oldPosition_.clear(),this.onEnter_=function(e,t){},this.onExit_=function(e,t){},this.onSkip_=function(e,t){}}},{key:"poll",value:function(t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=this.timeline_.regions()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=this.oldPosition_.get(u),c=e.determinePositionRelativeTo_(u,t);this.oldPosition_.set(u,c);var d=!0,h=!1,f=void 0;try{for(var p,m=this.rules_[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.weWere==l&&v.weAre==c&&v.invoke(u,n)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"setListeners",value:function(e,t,n){this.onEnter_=e,this.onExit_=t,this.onSkip_=n}}])&&yi(t.prototype,n),r&&yi(t,r),e}();function _i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}gi.RelativePosition_={BEFORE_THE_REGION:1,IN_THE_REGION:2,AFTER_THE_REGION:3},gi.EventListener={},gi.Rule_={};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var bi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onAddRegion_=function(e){},this.regions_=new Set}var t,n,r;return t=e,(n=[{key:"release",value:function(){this.onAddRegion_=function(e){},this.regions_.clear()}},{key:"setListeners",value:function(e){this.onAddRegion_=e}},{key:"addRegion",value:function(e){null==this.findSimilarRegion_(e)&&(this.regions_.add(e),this.onAddRegion_(e))}},{key:"findSimilarRegion_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.regions_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;if(s.schemeIdUri==e.schemeIdUri&&s.startTime==e.startTime&&s.endTime==e.endTime)return s}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"regions",value:function(){return this.regions_}}])&&_i(t.prototype,n),r&&_i(t,r),e}();function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ei=window.shaka,Si=(window.goog,function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataView_=t,this.littleEndian_=n===e.Endianness.LITTLE_ENDIAN,this.position_=0}var t,n,r;return t=e,(n=[{key:"hasMoreData",value:function(){return this.position_<this.dataView_.byteLength}},{key:"getPosition",value:function(){return this.position_}},{key:"getLength",value:function(){return this.dataView_.byteLength}},{key:"readUint8",value:function(){try{var e=this.dataView_.getUint8(this.position_);return this.position_+=1,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint16",value:function(){try{var e=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint32",value:function(){try{var e=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}}},{key:"readInt32",value:function(){try{var e=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}}},{key:"readUint64",value:function(){var e,t;try{this.littleEndian_?(e=this.dataView_.getUint32(this.position_,!0),t=this.dataView_.getUint32(this.position_+4,!0)):(t=this.dataView_.getUint32(this.position_,!1),e=this.dataView_.getUint32(this.position_+4,!1))}catch(e){throw this.outOfBounds_()}if(t>2097151)throw new Ei.util.Error(Ei.util.Error.Severity.CRITICAL,Ei.util.Error.Category.MEDIA,Ei.util.Error.Code.JS_INTEGER_OVERFLOW);return this.position_+=8,t*Math.pow(2,32)+e}},{key:"readBytes",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.readBytes"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();var t=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+this.position_,e);return this.position_+=e,new Uint8Array(t)}},{key:"skip",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.skip"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_+=e}},{key:"rewind",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.rewind"),this.position_<e)throw this.outOfBounds_();this.position_-=e}},{key:"seek",value:function(e){if(window.asserts.assert(e>=0,"Bad call to DataViewReader.seek"),e<0||e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_=e}},{key:"readTerminatedString",value:function(){for(var e=this.position_;this.hasMoreData();){if(0==this.dataView_.getUint8(this.position_))break;this.position_+=1}var t=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+e,this.position_-e);return this.position_+=1,ft.fromUTF8(t)}},{key:"outOfBounds_",value:function(){return new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.BUFFER_READ_OUT_OF_BOUNDS)}}])&&wi(t.prototype,n),r&&wi(t,r),e}());Si.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1};var Ti=Si;function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ci=window.shaka,Ii=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.headers_=[],this.boxDefinitions_=[],this.done_=!1}var t,n,r;return t=e,r=[{key:"children",value:function(e){for(;e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start,e.reader,e.partialOkay)}},{key:"sampleDescription",value:function(e){for(var t=e.reader.readUint32();t>0&&!e.parser.done_;t-=1)e.parser.parseNext(e.start,e.reader,e.partialOkay)}},{key:"allData",value:function(e){return function(t){var n=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(n))}}},{key:"typeFromString_",value:function(e){window.asserts.assert(4==e.length,"Mp4 box names must be 4 characters long");for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}},{key:"typeToString",value:function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}}],(n=[{key:"box",value:function(t,n){var r=e.typeFromString_(t);return this.headers_[r]=e.BoxType_.BASIC_BOX,this.boxDefinitions_[r]=n,this}},{key:"fullBox",value:function(t,n){var r=e.typeFromString_(t);return this.headers_[r]=e.BoxType_.FULL_BOX,this.boxDefinitions_[r]=n,this}},{key:"stop",value:function(){this.done_=!0}},{key:"parse",value:function(e,t){var n=new Uint8Array(e),r=new Ti(new DataView(n.buffer,n.byteOffset,n.byteLength),Ti.Endianness.BIG_ENDIAN);for(this.done_=!1;r.hasMoreData()&&!this.done_;)this.parseNext(0,r,t)}},{key:"parseNext",value:function(t,n,r){var i=n.getPosition(),a=n.readUint32(),s=n.readUint32(),o=e.typeToString(s);switch(Ci.log.v2("Parsing MP4 box",o),a){case 0:a=n.getLength()-i;break;case 1:a=n.readUint64()}var u=this.boxDefinitions_[s];if(u){var l=null,c=null;if(this.headers_[s]===e.BoxType_.FULL_BOX){var d=n.readUint32();l=d>>>24,c=16777215&d}var h=i+a;r&&h>n.getLength()&&(h=n.getLength());var f=h-n.getPosition(),p=f>0?n.readBytes(f):new Uint8Array(0);u({parser:this,partialOkay:r||!1,version:l,flags:c,reader:new Ti(new DataView(p.buffer,p.byteOffset,p.byteLength),Ti.Endianness.BIG_ENDIAN),size:a,start:i+t})}else{var m=Math.min(i+a-n.getPosition(),n.getLength()-n.getPosition());n.skip(m)}}}])&&ki(t.prototype,n),r&&ki(t,r),e}());Ii.CallbackType={},Ii.BoxType_={BASIC_BOX:0,FULL_BOX:1};var Ai=Ii;function xi(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Li(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){xi(a,r,i,s,o,"next",e)}function o(e){xi(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ri=c.net.NetworkingEngine,Mi=new A,Pi=window.shaka,Oi=(window.goog,function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log(t,n),this.playerInterface_=n,this.manifest_=t,this.config_=null,this.bufferingGoalScale_=1,this.setupPeriodPromise_=Promise.resolve(),this.canSwitchPeriod_=[],this.canSwitchStream_=new Map,this.mediaStates_=new Map,this.startupComplete_=!1,this.failureCallbackBackoff_=null,this.fatalError_=!1,this.unloadingTextStream_=!1,this.textStreamSequenceId_=0,this.destroyer_=new tt(function(){return r.doDestroy_()})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.mediaStates_.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.cancelUpdate_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}return this.mediaStates_.clear(),this.canSwitchStream_.clear(),this.playerInterface_=null,this.manifest_=null,this.setupPeriodPromise_=null,this.canSwitchPeriod_=null,this.config_=null,Promise.resolve()}},{key:"configure",value:function(e){this.config_=e;var t={maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0};this.failureCallbackBackoff_=new dn(t,!0)}},{key:"start",value:function(){var e=Li(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(this.config_,"StreamingEngine configure() must be called before init()!"),t=this.playerInterface_.getPresentationTime(),n=this.findPeriodForTime_(t),(r=this.playerInterface_.onChooseStreams(this.manifest_.periods[n])).variant||r.text){e.next=7;break}throw Pi.log.error("init: no Streams chosen"),new A(Mi.severity.CRITICAL,Mi.category.STREAMING,Mi.code.INVALID_STREAMS_CHOSEN);case 7:return e.next=9,this.initStreams_(r.variant?r.variant.audio:null,r.variant?r.variant.video:null,r.text,t);case 9:this.destroyer_.ensureNotDestroyed(),Pi.log.debug("init: completed initial Stream setup"),this.playerInterface_&&this.playerInterface_.onInitialStreamsSetup&&(Pi.log.v1("init: calling onInitialStreamsSetup()..."),this.playerInterface_.onInitialStreamsSetup());case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBufferingPeriod",value:function(){var e=ee.ContentType,t=this.mediaStates_.get(e.VIDEO);if(t)return this.manifest_.periods[t.needPeriodIndex];var n=this.mediaStates_.get(e.AUDIO);return n?this.manifest_.periods[n.needPeriodIndex]:null}},{key:"getBufferingAudio",value:function(){var e=ee.ContentType;return this.getStream_(e.AUDIO)}},{key:"getBufferingVideo",value:function(){var e=ee.ContentType;return this.getStream_(e.VIDEO)}},{key:"getBufferingText",value:function(){var e=ee.ContentType;return this.getStream_(e.TEXT)}},{key:"getStream_",value:function(e){var t=this.mediaStates_.get(e);return t?t.restoreStreamAfterTrickPlay||t.stream:null}},{key:"loadNewTextStream",value:function(){var e=Li(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee.ContentType,e.next=3,this.playerInterface_.mediaSourceEngine.clear(n.TEXT);case 3:return this.textStreamSequenceId_++,this.unloadingTextStream_=!1,r=this.textStreamSequenceId_,i=this.playerInterface_.mediaSourceEngine,a=new Map,s=new Set,a.set(n.TEXT,t),s.add(t),e.next=13,i.init(a,!1);case 13:return this.destroyer_.ensureNotDestroyed(),e.next=16,this.setupStreams_(s);case 16:this.destroyer_.ensureNotDestroyed(),this.textStreamSequenceId_!=r||this.mediaStates_.has(n.TEXT)||this.unloadingTextStream_||(o=this.playerInterface_.getPresentationTime(),u=this.findPeriodForTime_(o),l=this.createMediaState_(t,u,0),this.mediaStates_.set(n.TEXT,l),this.scheduleUpdate_(l,0));case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadTextStream",value:function(){var e=ee.ContentType;this.unloadingTextStream_=!0;var t=this.mediaStates_.get(e.TEXT);t&&(this.cancelUpdate_(t),this.mediaStates_.delete(e.TEXT))}},{key:"setTrickPlay",value:function(e){var t=ee.ContentType,n=this.mediaStates_.get(t.VIDEO);if(n){var r=n.stream;if(r)if(Pi.log.debug("setTrickPlay",e),e){var i=r.trickModeVideo;if(!i)return;if(n.restoreStreamAfterTrickPlay)return;Pi.log.debug("Engaging trick mode stream",i),this.switchInternal_(i,!1,0,!1),n.restoreStreamAfterTrickPlay=r}else{var a=n.restoreStreamAfterTrickPlay;if(!a)return;Pi.log.debug("Restoring non-trick-mode stream",a),n.restoreStreamAfterTrickPlay=null,this.switchInternal_(a,!0,0,!1)}}}},{key:"switchVariant",value:function(e,t,n){e.video&&this.switchInternal_(e.video,t,n,!1),e.audio&&this.switchInternal_(e.audio,t,n,!1)}},{key:"switchTextStream",value:function(e){var t=ee.ContentType;window.asserts.assert(e&&e.type==t.TEXT,"Wrong stream type passed to switchTextStream!"),this.switchInternal_(e,!0,0,!1)}},{key:"reloadTextStream",value:function(){var e=ee.ContentType,t=this.mediaStates_.get(e.TEXT);t&&this.switchInternal_(t.stream,!0,0,!0)}},{key:"switchInternal_",value:function(t,n,r,i){var a=this,s=ee.ContentType,o=t.type,u=this.mediaStates_.get(o);if(u||t.type!=s.TEXT||!this.config_.ignoreTextStreamFailures){if(window.asserts.assert(u,"switch: expected mediaState to exist"),u){var l=this.findPeriodContainingStream_(t),c=Array.from(this.mediaStates_.values()).every(function(e){return e.needPeriodIndex==u.needPeriodIndex});if(n&&l!=u.needPeriodIndex&&c){Pi.log.debug("switch: switching to stream in another Period; clearing buffer and changing Periods");var d=!0,h=!1,f=void 0;try{for(var p,m=this.mediaStates_.values()[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;this.forceClearBuffer_(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}else{u.restoreStreamAfterTrickPlay&&(Pi.log.debug("switch during trick play mode",t),t.trickModeVideo?(u.restoreStreamAfterTrickPlay=t,t=t.trickModeVideo,Pi.log.debug("switch found trick play stream",t)):(u.restoreStreamAfterTrickPlay=null,Pi.log.debug("switch found no special trick play stream")));var y=this.canSwitchPeriod_[l];if(window.asserts.assert(y&&y.resolved,"switch: expected Period "+l+" to be ready"),y&&y.resolved&&(y=this.canSwitchStream_.get(t.id),window.asserts.assert(y&&y.resolved,"switch: expected Stream "+t.id+" to be ready"),y&&y.resolved))if(u.stream!=t||i){if(t.type==s.TEXT){var g=st.getFullType(t.mimeType,t.codecs);this.playerInterface_.mediaSourceEngine.reinitText(g)}u.stream=t,u.needInitSegment=!0;var _=e.logPrefix_(u);Pi.log.debug("switch: switching to Stream "+_),this.shouldAbortCurrentRequest_(u,l)&&(Pi.log.info("Aborting current segment request to switch."),u.operation.abort()),n&&(u.clearingBuffer?u.waitingToFlushBuffer=!0:u.performingUpdate?(u.waitingToClearBuffer=!0,u.clearBufferSafeMargin=r,u.waitingToFlushBuffer=!0):(this.cancelUpdate_(u),this.clearBuffer_(u,!0,r).catch(function(e){a.playerInterface_&&a.playerInterface_.onError(e)})))}else{var b=e.logPrefix_(u);Pi.log.debug("switch: Stream "+b+" already active")}}}}else this.loadNewTextStream(t)}},{key:"shouldAbortCurrentRequest_",value:function(e,t){if(!e.operation)return!1;var n=this.playerInterface_.getPresentationTime(),r=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),i=this.getSegmentReferenceNeeded_(e,n,r,t),a=i?i.getSize():null;if(null==a)return!1;var s=e.stream.initSegmentReference;return s&&(a+=s.getSize()||0),8*a/this.playerInterface_.getBandwidthEstimate()<r-n-Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal)||e.operation.getBytesRemaining()>a}},{key:"seeked",value:function(){var e=this,t=this.playerInterface_.getPresentationTime(),n=this.config_.smallGapLimit,r=function(r){return e.playerInterface_.mediaSourceEngine.isBuffered(r,t,n)},i=!1,a=this.findPeriodForTime_(t);if(G.every(this.mediaStates_.values(),function(e){return e.needPeriodIndex==a})){var s=!0,o=!1,u=void 0;try{for(var l,c=this.mediaStates_.keys()[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;r(d)||(this.forceClearBuffer_(this.mediaStates_.get(d)),i=!0)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}}else{if(!G.every(this.mediaStates_.keys(),r)){Pi.log.debug("(all): seeked: unbuffered seek: clearing all buffers");var h=!0,f=!1,p=void 0;try{for(var m,v=this.mediaStates_.values()[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;this.forceClearBuffer_(y)}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}i=!0}}i||Pi.log.debug("(all): seeked: buffered seek: presentationTime="+t)}},{key:"forceClearBuffer_",value:function(t){var n=this,r=e.logPrefix_(t);if(t.clearingBuffer)Pi.log.debug(r,"clear: already clearing the buffer");else if(t.waitingToClearBuffer)Pi.log.debug(r,"clear: already waiting");else{if(t.performingUpdate)return Pi.log.debug(r,"clear: currently updating"),t.waitingToClearBuffer=!0,void(t.clearBufferSafeMargin=0);var i=t.type;if(null==this.playerInterface_.mediaSourceEngine.bufferStart(i))return Pi.log.debug(r,"clear: nothing buffered"),void(null==t.updateTimer&&this.scheduleUpdate_(t,0));Pi.log.debug(r,"clear: handling right now"),this.cancelUpdate_(t),this.clearBuffer_(t,!1,0).catch(function(e){n.playerInterface_&&n.playerInterface_.onError(e)})}}},{key:"initStreams_",value:function(){var e=Li(regeneratorRuntime.mark(function e(t,n,r,i){var a,s,o,u,l,c,d,h,f,p,m,v,y,g,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"StreamingEngine configure() must be called before init()!"),a=this.playerInterface_.getPresentationTime(),s=this.findPeriodForTime_(a),o=ee.ContentType,u=new Map,l=new Set,t&&(u.set(o.AUDIO,t),l.add(t)),n&&(u.set(o.VIDEO,n),l.add(n)),r&&(u.set(o.TEXT,r),l.add(r)),c=this.playerInterface_.mediaSourceEngine,d=this.config_.forceTransmuxTS,e.next=13,c.init(u,d);case 13:return this.destroyer_.ensureNotDestroyed(),this.setDuration_(),e.next=17,this.setupStreams_(l);case 17:for(this.destroyer_.ensureNotDestroyed(),h=!0,f=!1,p=void 0,e.prev=21,m=u.keys()[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)y=v.value,g=u.get(y),this.mediaStates_.has(y)||(_=this.createMediaState_(g,s,i),this.mediaStates_.set(y,_),this.scheduleUpdate_(_,0));e.next=29;break;case 25:e.prev=25,e.t0=e.catch(21),f=!0,p=e.t0;case 29:e.prev=29,e.prev=30,h||null==m.return||m.return();case 32:if(e.prev=32,!f){e.next=35;break}throw p;case 35:return e.finish(32);case 36:return e.finish(29);case 37:case"end":return e.stop()}},e,this,[[21,25,29,37],[30,,32,36]])}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"createMediaState_",value:function(e,t,n){return{stream:e,type:e.type,lastStream:null,lastSegmentReference:null,restoreStreamAfterTrickPlay:null,needInitSegment:!0,needPeriodIndex:t,endOfStream:!1,performingUpdate:!1,updateTimer:null,waitingToClearBuffer:!1,clearBufferSafeMargin:0,waitingToFlushBuffer:!1,clearingBuffer:!1,recovering:!1,hasError:!1,resumeAt:n||0,operation:null}}},{key:"setupPeriod_",value:function(e){var t=this,n=this.canSwitchPeriod_[e];if(n)return Pi.log.debug("(all) Period "+e+" is being or has been set up"),window.asserts.assert(n.promise,"promise must not be null"),n.promise;Pi.log.debug("(all) setting up Period "+e),n={promise:new we,resolved:!1},this.canSwitchPeriod_[e]=n;var r=new Set,i=!0,a=!1,s=void 0;try{for(var o,u=this.manifest_.periods[e].variants[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;l.video&&r.add(l.video),l.video&&l.video.trickModeVideo&&r.add(l.video.trickModeVideo),l.audio&&r.add(l.audio)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var c=!0,d=!1,h=void 0;try{for(var f,p=this.manifest_.periods[e].textStreams[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;r.add(m)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var v=function(){var n=Li(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.setupPeriodPromise_;case 3:return t.destroyer_.ensureNotDestroyed(),n.next=6,t.setupStreams_(r);case 6:t.destroyer_.ensureNotDestroyed(),t.canSwitchPeriod_[e].promise.resolve(),t.canSwitchPeriod_[e].resolved=!0,Pi.log.v1("(all) setup Period "+e),n.next=21;break;case 12:n.prev=12,n.t0=n.catch(0),t.destroyer_.ensureNotDestroyed(n.t0),t.canSwitchPeriod_[e].promise.catch(function(){}),t.canSwitchPeriod_[e].promise.reject(),delete t.canSwitchPeriod_[e],Pi.log.warning("(all) failed to setup Period "+e),window.asserts.assert(n.t0 instanceof A,"Bad error type"),t.playerInterface_.onError(n.t0);case 21:case"end":return n.stop()}},n,null,[[0,12]])}));return function(){return n.apply(this,arguments)}}();return this.setupPeriodPromise_=v(),n.promise}},{key:"setupStreams_",value:function(){var e=Li(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,E;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],r=!0,i=!1,a=void 0,e.prev=4,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u=o.value,(l=this.canSwitchStream_.get(u.id))?(Pi.log.debug("(all) Stream "+u.id+" is being or has been set up"),n.push(l.promise)):(Pi.log.v1("(all) setting up Stream "+u.id),this.canSwitchStream_.set(u.id,{promise:new we,resolved:!1}),n.push(u.createSegmentIndex()));e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),i=!0,a=e.t0;case 12:e.prev=12,e.prev=13,r||null==s.return||s.return();case 15:if(e.prev=15,!i){e.next=18;break}throw a;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.prev=20,e.next=23,Promise.all(n);case 23:this.destroyer_.ensureNotDestroyed(),e.next=49;break;case 26:for(e.prev=26,e.t1=e.catch(20),this.destroyer_.ensureNotDestroyed(e.t1),c=!0,d=!1,h=void 0,e.prev=32,f=t[Symbol.iterator]();!(c=(p=f.next()).done);c=!0)m=p.value,this.canSwitchStream_.get(m.id).promise.catch(function(){}),this.canSwitchStream_.get(m.id).promise.reject(),this.canSwitchStream_.delete(m.id);e.next=40;break;case 36:e.prev=36,e.t2=e.catch(32),d=!0,h=e.t2;case 40:e.prev=40,e.prev=41,c||null==f.return||f.return();case 43:if(e.prev=43,!d){e.next=46;break}throw h;case 46:return e.finish(43);case 47:return e.finish(40);case 48:throw e.t1;case 49:for(v=!0,y=!1,g=void 0,e.prev=52,_=t[Symbol.iterator]();!(v=(b=_.next()).done);v=!0)w=b.value,(E=this.canSwitchStream_.get(w.id)).resolved||(E.promise.resolve(),E.resolved=!0,Pi.log.v1("(all) setup Stream "+w.id));e.next=60;break;case 56:e.prev=56,e.t3=e.catch(52),y=!0,g=e.t3;case 60:e.prev=60,e.prev=61,v||null==_.return||_.return();case 63:if(e.prev=63,!y){e.next=66;break}throw g;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19],[20,26],[32,36,40,48],[41,,43,47],[52,56,60,68],[61,,63,67]])}));return function(t){return e.apply(this,arguments)}}()},{key:"setDuration_",value:function(){var e=this.manifest_.presentationTimeline.getDuration();e<1/0?this.playerInterface_.mediaSourceEngine.setDuration(e):this.playerInterface_.mediaSourceEngine.setDuration(Math.pow(2,32))}},{key:"onUpdate_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n){var r,i,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.destroyer_.ensureNotDestroyed(),r=e.logPrefix_(n),window.asserts.assert(!n.performingUpdate&&null!=n.updateTimer,r+" unexpected call to onUpdate_()"),!n.performingUpdate&&null!=n.updateTimer){t.next=5;break}return t.abrupt("return");case 5:if(window.asserts.assert(!n.clearingBuffer,r+" onUpdate_() should not be called when clearing the buffer"),!n.clearingBuffer){t.next=8;break}return t.abrupt("return");case 8:if(n.updateTimer=null,!n.waitingToClearBuffer){t.next=14;break}return Pi.log.debug(r,"skipping update and clearing the buffer"),t.next=13,this.clearBuffer_(n,n.waitingToFlushBuffer,n.clearBufferSafeMargin);case 13:return t.abrupt("return");case 14:t.prev=14,null!=(i=this.update_(n))&&(this.scheduleUpdate_(n,i),n.hasError=!1),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(14),this.handleStreamingError_(t.t0),t.abrupt("return");case 23:if(a=Array.from(this.mediaStates_.values()),this.handlePeriodTransition_(n),!this.startupComplete_||!a.every(function(e){return e.endOfStream})){t.next=32;break}return Pi.log.v1(r,"calling endOfStream()..."),t.next=29,this.playerInterface_.mediaSourceEngine.endOfStream();case 29:this.destroyer_.ensureNotDestroyed(),(s=this.playerInterface_.mediaSourceEngine.getDuration())<this.manifest_.presentationTimeline.getDuration()&&this.manifest_.presentationTimeline.setDuration(s);case 32:case"end":return t.stop()}},t,this,[[14,19]])}));return function(e){return t.apply(this,arguments)}}()},{key:"update_",value:function(t){window.asserts.assert(this.manifest_,"manifest_ should not be null"),window.asserts.assert(this.config_,"config_ should not be null");var n=ee.ContentType,r=function(e){return e.type==n.TEXT&&e.stream.mimeType==st.CLOSED_CAPTION_MIMETYPE};if(r(t))return this.playerInterface_.mediaSourceEngine.setSelectedClosedCaptionId(t.stream.originalId||""),null;var i=e.logPrefix_(t),a=this.playerInterface_.getPresentationTime(),s=this.getTimeNeeded_(t,a);Pi.log.v2(i,"timeNeeded="+s);var o=this.findPeriodContainingStream_(t.stream),u=this.findPeriodForTime_(s),l=this.playerInterface_.mediaSourceEngine.bufferedAheadOf(t.type,a);Pi.log.v2(i,"update_:","presentationTime="+a,"bufferedAhead="+l);var c=Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal,this.config_.bufferingGoal)*this.bufferingGoalScale_;if(s>=this.manifest_.presentationTimeline.getDuration()){if(Pi.log.debug(i,"buffered to end of presentation"),t.endOfStream=!0,t.type==n.VIDEO){var d=this.mediaStates_.get(n.TEXT);d&&d.stream.mimeType==st.CLOSED_CAPTION_MIMETYPE&&(d.endOfStream=!0)}return null}if(t.endOfStream=!1,t.needPeriodIndex=u,u!=o)return Pi.log.debug(i,"need Period "+u,"presentationTime="+a,"timeNeeded="+s,"currentPeriodIndex="+o),null;if(l>=c)return Pi.log.v2(i,"buffering goal met"),.5;var h=this.playerInterface_.mediaSourceEngine.bufferEnd(t.type),f=this.getSegmentReferenceNeeded_(t,a,h,o);if(!f)return 1;for(var p=1/0,m=0,v=Array.from(this.mediaStates_.values());m<v.length;m++){var y=v[m];if(r(y))return null;var g=this.getTimeNeeded_(y,a);p=Math.min(p,g)}return s>=p+this.manifest_.presentationTimeline.getMaxSegmentDuration()*e.MAX_RUN_AHEAD_SEGMENTS_?1:(t.resumeAt=0,this.fetchAndAppend_(t,a,o,f).catch(function(e){console.error(e)}),null)}},{key:"getTimeNeeded_",value:function(e,t){if(!e.lastStream||!e.lastSegmentReference)return Math.max(t,e.resumeAt);var n=this.findPeriodContainingStream_(e.lastStream);return this.manifest_.periods[n].startTime+e.lastSegmentReference.endTime}},{key:"getSegmentReferenceNeeded_",value:function(t,n,r,i){var a,s=e.logPrefix_(t);if(t.lastSegmentReference&&t.stream==t.lastStream){var o=t.lastSegmentReference.position+1;return Pi.log.v2(s,"next position known:","position="+o),this.getSegmentReferenceIfAvailable_(t,i,o)}if(t.lastSegmentReference){window.asserts.assert(t.lastStream,"lastStream should not be null"),Pi.log.v1(s,"next position unknown: another Stream buffered");var u=this.findPeriodContainingStream_(t.lastStream),l=this.manifest_.periods[u];a=this.lookupSegmentPosition_(t,l.startTime+t.lastSegmentReference.endTime,i)}else window.asserts.assert(!t.lastStream,"lastStream should be null"),Pi.log.v1(s,"next position unknown: nothing buffered"),a=this.lookupSegmentPosition_(t,r||n,i);if(null==a)return null;var c=null;if(null==r){var d=Math.max(0,a-1);c=this.getSegmentReferenceIfAvailable_(t,i,d)}return c||this.getSegmentReferenceIfAvailable_(t,i,a)}},{key:"lookupSegmentPosition_",value:function(t,n,r){var i=e.logPrefix_(t),a=this.manifest_.periods[r];Pi.log.debug(i,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+a.startTime);var s=Math.max(0,n-a.startTime),o=t.stream.findSegmentPosition(s);return null==o&&Pi.log.warning(i,"cannot find segment:","currentPeriod.startTime="+a.startTime,"lookupTime="+s),o}},{key:"getSegmentReferenceIfAvailable_",value:function(t,n,r){var i=e.logPrefix_(t),a=this.manifest_.periods[n],s=t.stream.getSegmentReference(r);if(!s)return Pi.log.v1(i,"segment does not exist:","currentPeriod.startTime="+a.startTime,"position="+r),null;var o=this.manifest_.presentationTimeline,u=o.getSegmentAvailabilityStart(),l=o.getSegmentAvailabilityEnd();return a.startTime+s.endTime<u||a.startTime+s.startTime>l?(Pi.log.v2(i,"segment is not available:","currentPeriod.startTime="+a.startTime,"reference.startTime="+s.startTime,"reference.endTime="+s.endTime,"availabilityStart="+u,"availabilityEnd="+l),null):s}},{key:"fetchAndAppend_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,u,l,c,d,h,f,p,m,v;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=ee.ContentType,o=e.logPrefix_(n),u=this.manifest_.periods[i],Pi.log.v1(o,"fetchAndAppend_:","presentationTime="+r,"currentPeriod.startTime="+u.startTime,"reference.position="+a.position,"reference.startTime="+a.startTime,"reference.endTime="+a.endTime),l=n.stream,c=this.manifest_.presentationTimeline.getDuration(),d=this.manifest_.periods[i+1],h=Math.max(0,u.startTime-e.APPEND_WINDOW_START_FUDGE_),f=d?d.startTime+e.APPEND_WINDOW_END_FUDGE_:c,window.asserts.assert(a.startTime<=f,o+" segment should start before append window end"),p=this.initSourceBuffer_(n,i,h,f),n.performingUpdate=!0,n.needInitSegment=!1,Pi.log.v2(o,"fetching segment"),m=this.fetch_(n,a),t.prev=15,t.next=18,Promise.all([p,m]);case 18:if(v=t.sent,this.destroyer_.ensureNotDestroyed(),!this.fatalError_){t.next=22;break}return t.abrupt("return");case 22:return t.next=24,this.append_(n,r,u,l,a,v[1]);case 24:if(this.destroyer_.ensureNotDestroyed(),!this.fatalError_){t.next=27;break}return t.abrupt("return");case 27:n.performingUpdate=!1,n.recovering=!1,n.waitingToClearBuffer||this.playerInterface_.onSegmentAppended(),this.scheduleUpdate_(n,0),this.handleStartup_(n,l),Pi.log.v1(o,"finished fetch and append"),t.next=43;break;case 35:if(t.prev=35,t.t0=t.catch(15),this.destroyer_.ensureNotDestroyed(t.t0),!this.fatalError_){t.next=40;break}return t.abrupt("return");case 40:window.asserts.assert(t.t0 instanceof A,"Should only receive a Shaka error"),n.performingUpdate=!1,n.type==s.TEXT&&this.config_.ignoreTextStreamFailures?(t.t0.code==Mi.code.BAD_HTTP_STATUS?Pi.log.warning(o,"Text stream failed to download. Proceeding without it."):Pi.log.warning(o,"Text stream failed to parse. Proceeding without it."),this.mediaStates_.delete(s.TEXT)):t.t0.code==Mi.code.OPERATION_ABORTED?(n.performingUpdate=!1,n.updateTimer=null,this.scheduleUpdate_(n,0)):t.t0.code==Mi.code.QUOTA_EXCEEDED_ERROR?this.handleQuotaExceeded_(n,t.t0):(Pi.log.error(o,"failed fetch and append: code="+t.t0.code),n.hasError=!0,t.t0.severity=Mi.severity.CRITICAL,this.handleStreamingError_(t.t0));case 43:case"end":return t.stop()}},t,this,[[15,35]])}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"retry",value:function(){if(this.destroyer_.destroyed())return Pi.log.error("Unable to retry after StreamingEngine is destroyed!"),!1;if(this.fatalError_)return Pi.log.error("Unable to retry after StreamingEngine encountered a fatal error!"),!1;var t=!0,n=!1,r=void 0;try{for(var i,a=this.mediaStates_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=e.logPrefix_(s);s.hasError&&(Pi.log.info(o,"Retrying after failure..."),s.hasError=!1,this.scheduleUpdate_(s,.1))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}},{key:"handleQuotaExceeded_",value:function(t,n){var r=e.logPrefix_(t);if(Array.from(this.mediaStates_.values()).some(function(e){return e!=t&&e.recovering}))Pi.log.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var i=Math.round(100*this.bufferingGoalScale_);if(i>20)this.bufferingGoalScale_-=.2;else{if(!(i>4))return Pi.log.error(r,"MediaSource threw QuotaExceededError too many times"),t.hasError=!0,this.fatalError_=!0,void this.playerInterface_.onError(n);this.bufferingGoalScale_-=.04}var a=Math.round(100*this.bufferingGoalScale_);Pi.log.warning(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-a)+"%"),t.recovering=!0}this.scheduleUpdate_(t,4)}},{key:"initSourceBuffer_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,u,l,c,d,h=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.needInitSegment){t.next=2;break}return t.abrupt("return");case 2:if(s=e.logPrefix_(n),o=this.manifest_.periods[r],u=o.startTime-n.stream.presentationTimeOffset,Pi.log.v1(s,"setting timestamp offset to "+u),Pi.log.v1(s,"setting append window start to "+i),Pi.log.v1(s,"setting append window end to "+a),l=this.playerInterface_.mediaSourceEngine.setStreamProperties(n.type,u,i,a),n.stream.initSegmentReference){t.next=13;break}return t.next=12,l;case 12:return t.abrupt("return");case 13:return Pi.log.v1(s,"fetching init segment"),window.asserts.assert(n.stream.initSegmentReference,"Should have init segment"),c=this.fetch_(n,n.stream.initSegmentReference),d=function(){var e=Li(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c;case 3:return t=e.sent,h.destroyer_.ensureNotDestroyed(),Pi.log.v1(s,"appending init segment"),r=n.stream.closedCaptions&&n.stream.closedCaptions.size>0,e.next=9,h.playerInterface_.mediaSourceEngine.appendBuffer(n.type,t,null,null,r);case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),n.needInitSegment=!0,e.t0;case 15:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),t.next=19,Promise.all([l,d()]);case 19:case"end":return t.stop()}},t,this)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"append_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n,r,i,a,s,o){var u,l,c,d,h=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=e.logPrefix_(n),l=a.closedCaptions&&a.closedCaptions.size>0,null!=a.emsgSchemeIdUris&&a.emsgSchemeIdUris.length>0&&(new Ai).fullBox("emsg",function(e){return h.parseEMSG_(i,s,a.emsgSchemeIdUris,e)}).parse(o),t.next=5,this.evict_(n,r);case 5:return this.destroyer_.ensureNotDestroyed(),Pi.log.v1(u,"appending media segment"),c=s.startTime+i.startTime,d=s.endTime+i.startTime,t.next=11,this.playerInterface_.mediaSourceEngine.appendBuffer(n.type,o,c,d,l);case 11:this.destroyer_.ensureNotDestroyed(),Pi.log.v2(u,"appended media segment"),n.lastStream=a,n.lastSegmentReference=s;case 15:case"end":return t.stop()}},t,this)}));return function(e,n,r,i,a,s){return t.apply(this,arguments)}}()},{key:"parseEMSG_",value:function(e,t,n,r){var i=r.reader.readTerminatedString(),a=r.reader.readTerminatedString(),s=r.reader.readUint32(),o=r.reader.readUint32(),u=r.reader.readUint32(),l=r.reader.readUint32(),c=r.reader.readBytes(r.reader.getLength()-r.reader.getPosition()),d=e.startTime+t.startTime+o/s;if(n.includes(i))if("urn:mpeg:dash:event:2012"==i)this.playerInterface_.onManifestUpdate();else{var h=new D("emsg",{detail:{startTime:d,endTime:d+u/s,schemeIdUri:i,value:a,timescale:s,presentationTimeDelta:o,eventDuration:u,id:l,messageData:c}});this.playerInterface_.onEvent(h)}}},{key:"evict_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.logPrefix_(n),Pi.log.v2(i,"checking buffer length"),a=Math.max(this.config_.bufferBehind,this.manifest_.presentationTimeline.getMaxSegmentDuration()),null!=(s=this.playerInterface_.mediaSourceEngine.bufferStart(n.type))){t.next=7;break}return Pi.log.v2(i,"buffer behind okay because nothing buffered:","presentationTime="+r,"bufferBehind="+a),t.abrupt("return");case 7:if(!((u=(o=r-s)-a)<=0)){t.next=12;break}return Pi.log.v2(i,"buffer behind okay:","presentationTime="+r,"bufferedBehind="+o,"bufferBehind="+a,"underflow="+-u),t.abrupt("return");case 12:return Pi.log.v1(i,"buffer behind too large:","presentationTime="+r,"bufferedBehind="+o,"bufferBehind="+a,"overflow="+u),t.next=15,this.playerInterface_.mediaSourceEngine.remove(n.type,s,s+u);case 15:this.destroyer_.ensureNotDestroyed(),Pi.log.v1(i,"evicted "+u+" seconds");case 17:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"handleStartup_",value:function(t,n){var r=this,i=ee.ContentType;if(!this.startupComplete_){var a=e.logPrefix_(t),s=Array.from(this.mediaStates_.values());if(1==s.length&&s[0].type==i.TEXT||(this.startupComplete_=s.every(function(e){return e.type==i.TEXT||!e.waitingToClearBuffer&&!e.clearingBuffer&&e.lastSegmentReference})),this.startupComplete_){Pi.log.debug(a,"startup complete");var o=this.findPeriodContainingStream_(n);if(window.asserts.assert(s.every(function(e){return e.needPeriodIndex==o||e.needPeriodIndex==o+1}),a+" expected all MediaStates to need same Period"),!this.canSwitchPeriod_[o])(function(){var e=Li(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.setupPeriod_(o);case 3:r.destroyer_.ensureNotDestroyed(),Pi.log.v1(a,"calling onCanSwitch()..."),r.playerInterface_.onCanSwitch(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}})()();for(var u=0;u<this.manifest_.periods.length;++u)this.setupPeriod_(u).catch(q.noop);this.playerInterface_.onStartupComplete&&(Pi.log.v1(a,"calling onStartupComplete()..."),this.playerInterface_.onStartupComplete())}}}},{key:"handlePeriodTransition_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,E,S,T=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.logPrefix_(n),i=ee.ContentType,a=this.findPeriodContainingStream_(n.stream),n.needPeriodIndex!=a){t.next=5;break}return t.abrupt("return");case 5:if(s=n.needPeriodIndex,o=Array.from(this.mediaStates_.values()),window.asserts.assert(o.every(function(t){return t.needPeriodIndex==s||t.hasError||!e.isIdle_(t)}),"All MediaStates should need the same Period or be performingupdates."),o.every(function(e){return e.needPeriodIndex==s})){t.next=12;break}return Pi.log.debug(r,"not all MediaStates need Period "+s),t.abrupt("return");case 12:if(o.every(e.isIdle_)){t.next=16;break}return Pi.log.debug(r,"all MediaStates need Period "+s+", but not all MediaStates are idle"),t.abrupt("return");case 16:return Pi.log.debug(r,"all need Period "+s),t.prev=17,t.next=20,this.setupPeriod_(s);case 20:if(this.destroyer_.ensureNotDestroyed(),o.every(function(t){var n=e.isIdle_(t),r=T.findPeriodContainingStream_(t.stream);return n&&t.needPeriodIndex==s&&r!=s})){t.next=25;break}return Pi.log.debug(r,"ignoring transition to Period",s,"since another is happening"),t.abrupt("return");case 25:u=this.manifest_.periods[s],Pi.log.v1(r,"calling onChooseStreams()..."),l=this.playerInterface_.onChooseStreams(u),c=new Map,l.variant&&l.variant.video&&c.set(i.VIDEO,l.variant.video),l.variant&&l.variant.audio&&c.set(i.AUDIO,l.variant.audio),l.text&&c.set(i.TEXT,l.text),d=!0,h=!1,f=void 0,t.prev=35,p=this.mediaStates_.keys()[Symbol.iterator]();case 37:if(d=(m=p.next()).done){t.next=47;break}if(v=m.value,!c.has(v)&&v!=i.TEXT){t.next=41;break}return t.abrupt("continue",44);case 41:return Pi.log.error(r,"invalid Streams chosen: missing "+v+" Stream"),this.playerInterface_.onError(new A(Mi.severity.CRITICAL,Mi.category.STREAMING,Mi.code.INVALID_STREAMS_CHOSEN)),t.abrupt("return");case 44:d=!0,t.next=37;break;case 47:t.next=53;break;case 49:t.prev=49,t.t0=t.catch(35),h=!0,f=t.t0;case 53:t.prev=53,t.prev=54,d||null==p.return||p.return();case 56:if(t.prev=56,!h){t.next=59;break}throw f;case 59:return t.finish(56);case 60:return t.finish(53);case 61:y=0,g=Array.from(c.keys());case 62:if(!(y<g.length)){t.next=76;break}if(_=g[y],!this.mediaStates_.has(_)){t.next=66;break}return t.abrupt("continue",73);case 66:if(_!=i.TEXT){t.next=70;break}return this.initStreams_(null,null,c.get(i.TEXT),u.startTime),c.delete(_),t.abrupt("continue",73);case 70:return Pi.log.error(r,"invalid Streams chosen: unusable "+_+" Stream"),this.playerInterface_.onError(new A(Mi.severity.CRITICAL,Mi.category.STREAMING,Mi.code.INVALID_STREAMS_CHOSEN)),t.abrupt("return");case 73:y++,t.next=62;break;case 76:for(b=0,w=Array.from(this.mediaStates_.keys());b<w.length;b++)E=w[b],(S=c.get(E))?(this.switchInternal_(S,!1,0,!1),this.scheduleUpdate_(this.mediaStates_.get(E),0)):(window.asserts.assert(E==i.TEXT,"Invalid streams chosen"),this.mediaStates_.delete(E));Pi.log.v1(r,"calling onCanSwitch()..."),this.playerInterface_.onCanSwitch(),t.next=83;break;case 81:t.prev=81,t.t1=t.catch(17);case 83:case"end":return t.stop()}},t,this,[[17,81],[35,49,53,61],[54,,56,60]])}));return function(e){return t.apply(this,arguments)}}()},{key:"findPeriodForTime_",value:function(e){var t=e+ee.GAP_OVERLAP_TOLERANCE_SECONDS,n=kr.findPeriodForTime(this.manifest_.periods,t);return n?this.manifest_.periods.indexOf(n):0}},{key:"findPeriodContainingStream_",value:function(e){window.asserts.assert(this.manifest_,"Must have a manifest to find a stream.");for(var t=this.manifest_.periods,n=0;n<t.length;n++){var r=t[n],i=new Set,a=!0,s=!1,o=void 0;try{for(var u,l=r.variants[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;c.audio&&i.add(c.audio),c.video&&i.add(c.video),c.video&&c.video.trickModeVideo&&i.add(c.video.trickModeVideo)}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}var d=!0,h=!1,f=void 0;try{for(var p,m=r.textStreams[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;i.add(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}if(i.has(e))return n}return-1}},{key:"fetch_",value:function(){var e=Li(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ri.RequestType.SEGMENT,i=Sr.createSegmentRequest(n.getUris(),n.startByte,n.endByte,this.config_.retryParameters),Pi.log.v2("fetching: reference=",n),a=this.playerInterface_.netEngine.request(r,i),t.operation=a,e.next=7,a.promise;case 7:return s=e.sent,t.operation=null,e.abrupt("return",s.data);case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearBuffer_",value:function(){var t=Li(regeneratorRuntime.mark(function t(n,r,i){var a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.logPrefix_(n),window.asserts.assert(!n.performingUpdate&&null==n.updateTimer,a+" unexpected call to clearBuffer_()"),n.waitingToClearBuffer=!1,n.waitingToFlushBuffer=!1,n.clearBufferSafeMargin=0,n.clearingBuffer=!0,Pi.log.debug(a,"clearing buffer"),!i){t.next=14;break}return s=this.playerInterface_.getPresentationTime(),o=this.playerInterface_.mediaSourceEngine.getDuration(),t.next=12,this.playerInterface_.mediaSourceEngine.remove(n.type,s+i,o);case 12:t.next=20;break;case 14:return t.next=16,this.playerInterface_.mediaSourceEngine.clear(n.type);case 16:if(this.destroyer_.ensureNotDestroyed(),!r){t.next=20;break}return t.next=20,this.playerInterface_.mediaSourceEngine.flush(n.type);case 20:this.destroyer_.ensureNotDestroyed(),Pi.log.debug(a,"cleared buffer"),n.lastStream=null,n.lastSegmentReference=null,n.clearingBuffer=!1,n.endOfStream=!1,this.scheduleUpdate_(n,0);case 27:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"scheduleUpdate_",value:function(t,n){var r=this,i=e.logPrefix_(t);Pi.log.v2(i,"updating in "+n+" seconds"),window.asserts.assert(null==t.updateTimer,i+" did not expect update to be scheduled"),t.updateTimer=new pe(Li(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.onUpdate_(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r.playerInterface_&&r.playerInterface_.onError(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}))).tickAfter(n)}},{key:"cancelUpdate_",value:function(e){null!=e.updateTimer&&(e.updateTimer.stop(),e.updateTimer=null)}},{key:"handleStreamingError_",value:function(){var e=Li(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.failureCallbackBackoff_.attempt();case 2:this.destroyer_.ensureNotDestroyed(),this.playerInterface_.onError(t),t.handled||this.config_.failureCallback(t);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],r=[{key:"isIdle_",value:function(e){return!e.performingUpdate&&null==e.updateTimer&&!e.waitingToClearBuffer&&!e.clearingBuffer}},{key:"logPrefix_",value:function(e){return"("+e.type+":"+e.stream.id+")"}}],n&&Ni(t.prototype,n),r&&Ni(t,r),e}());Oi.ChosenStreams,Oi.PlayerInterface,Oi.MediaState_,Oi.APPEND_WINDOW_START_FUDGE_=.1,Oi.APPEND_WINDOW_END_FUDGE_=.01,Oi.MAX_RUN_AHEAD_SEGMENTS_=1;var Di=Oi;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */window.shaka,window.shaka;function Ui(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Fi(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ui(a,r,i,s,o,"next",e)}function o(e){Ui(a,r,i,s,o,"throw",e)}s(void 0)})}}function Bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Vi=new A,ji=(window.shaka,window.goog,function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.implementation_=r,this.currentlyAt_=t,this.currentlyWith_=n,this.waitForWork_=null,this.requests_=[],this.currentRoute_=null,this.currentStep_=null,this.mainLoopPromise_=Promise.resolve().then(function(){return i.mainLoop_()}),this.destroyer_=new tt(function(){return i.doDestroy_()})}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"doDestroy_",value:function(){var e=Fi(regeneratorRuntime.mark(function e(){var t,n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentStep_&&this.currentStep_.abort(),this.unblockMainLoop_(),e.next=4,this.mainLoopPromise_;case 4:for(this.currentRoute_&&this.currentRoute_.listeners.onCancel(),t=!0,n=!1,r=void 0,e.prev=8,i=this.requests_[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)a.value.listeners.onCancel();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),n=!0,r=e.t0;case 16:e.prev=16,e.prev=17,t||null==i.return||i.return();case 19:if(e.prev=19,!n){e.next=22;break}throw r;case 22:return e.finish(19);case 23:return e.finish(16);case 24:this.currentRoute_=null,this.requests_=[],this.implementation_=null;case 27:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])}));return function(){return e.apply(this,arguments)}}()},{key:"startNewRoute",value:function(e){var t={onStart:function(){},onEnd:function(){},onCancel:function(){},onError:function(e){},onSkip:function(){},onEnter:function(){}};return this.requests_.push({create:e,listeners:t}),this.currentStep_&&this.currentStep_.abort(),this.unblockMainLoop_(),t}},{key:"mainLoop_",value:function(){var e=Fi(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.destroyer_.destroyed()){e.next=5;break}return e.next=3,this.doOneThing_();case 3:e.next=0;break;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"doOneThing_",value:function(){return this.tryNewRoute_()?Promise.resolve():this.currentRoute_?this.takeNextStep_():(window.asserts.assert(null==this.waitForWork_,"We should not have a promise yet."),this.implementation_.onIdle(this.currentlyAt_),this.waitForWork_=new we,this.waitForWork_)}},{key:"tryNewRoute_",value:function(){if(window.asserts.assert(null==this.currentStep_,"We should never have a current step between taking steps."),0==this.requests_.length)return!1;if(this.currentRoute_&&!this.currentRoute_.interruptible)return!1;this.currentRoute_&&(this.currentRoute_.listeners.onCancel(),this.currentRoute_=null);var e=this.requests_.shift(),t=e.create(this.currentlyWith_);return t?(e.listeners.onStart(),this.currentRoute_={node:t.node,payload:t.payload,interruptible:t.interruptible,listeners:e.listeners}):e.listeners.onSkip(),!0}},{key:"takeNextStep_",value:function(){var e=Fi(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.currentRoute_,"We need a current route to take the next step."),this.currentlyAt_=this.implementation_.getNext(this.currentlyAt_,this.currentlyWith_,this.currentRoute_.node,this.currentRoute_.payload),this.currentRoute_.listeners.onEnter(this.currentlyAt_),e.prev=3,this.currentStep_=this.implementation_.enterNode(this.currentlyAt_,this.currentlyWith_,this.currentRoute_.payload),e.next=7,this.currentStep_.promise;case 7:this.currentStep_=null,this.currentlyAt_==this.currentRoute_.node&&(this.currentRoute_.listeners.onEnd(),this.currentRoute_=null),e.next=19;break;case 11:return e.prev=11,e.t0=e.catch(3),e.t0.code==Vi.code.OPERATION_ABORTED?(window.asserts.assert(this.currentRoute_.interruptible,"Do not put abortable steps in non-interruptible routes!"),this.currentRoute_.listeners.onCancel()):this.currentRoute_.listeners.onError(e.t0),this.currentRoute_=null,this.currentStep_=null,e.next=18,this.implementation_.handleError(this.currentlyWith_,e.t0);case 18:this.currentlyAt_=e.sent;case 19:case"end":return e.stop()}},e,this,[[3,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"unblockMainLoop_",value:function(){this.waitForWork_&&(this.waitForWork_.resolve(),this.waitForWork_=null)}}])&&Bi(t.prototype,n),r&&Bi(t,r),e}());function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ji.Implementation,ji.Listeners,ji.Route,ji.ActiveRoute_,ji.Request_;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ki=window.shaka,Gi=(window.goog,function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textTrack_=null;for(var n=0;n<t.textTracks.length;++n){var r=t.textTracks[n];r.mode="disabled",r.label==Ki.text.SimpleTextDisplayer.TextTrackLabel_&&(this.textTrack_=r)}this.textTrack_||(this.textTrack_=t.addTextTrack("subtitles",Ki.text.SimpleTextDisplayer.TextTrackLabel_)),this.textTrack_.mode="hidden"}var t,n,r;return t=e,r=[{key:"convertToTextTrackCue_",value:function(e){if(e.startTime>=e.endTime)return Ki.log.warning("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=Ki.text.Cue,n=new VTTCue(e.startTime,e.endTime,e.payload);n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,n.size=e.size;try{n.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),e.writingMode==t.writingMode.VERTICAL_LEFT_TO_RIGHT?n.vertical="lr":e.writingMode==t.writingMode.VERTICAL_RIGHT_TO_LEFT&&(n.vertical="rl"),e.lineInterpretation==t.lineInterpretation.PERCENTAGE&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}},{key:"removeWhere_",value:function(e,t){var n=e.mode,r="showing"==n?"showing":"hidden";e.mode=r,window.asserts.assert(e.cues,'Cues should be accessible when mode is set to "'+r+'".');for(var i=e.cues,a=i.length-1;a>=0;a--){var s=i[a];s&&t(s)&&e.removeCue(s)}e.mode=n}}],(n=[{key:"remove",value:function(e,t){if(!this.textTrack_)return!1;return Ki.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,function(n){return n.startTime<t&&n.endTime>e}),!0}},{key:"append",value:function(e){for(var t=Ki.text.SimpleTextDisplayer.convertToTextTrackCue_,n=[],r=0;r<e.length;r++){var i=t(e[r]);i&&n.push(i)}var a=n.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:n.indexOf(t)-n.indexOf(e)}),s=!0,o=!1,u=void 0;try{for(var l,c=a[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;this.textTrack_.addCue(d)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}}},{key:"destroy",value:function(){if(this.textTrack_){Ki.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,function(e){return!0})}return this.textTrack_=null,Promise.resolve()}},{key:"isTextVisible",value:function(){return"showing"==this.textTrack_.mode}},{key:"setTextVisibility",value:function(e){this.textTrack_.mode=e?"showing":"hidden"}}])&&Hi(t.prototype,n),r&&Hi(t,r),e}());Gi.TextTrackLabel_="Shaka Player TextTrack";var Wi=Gi;function qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var zi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.open_=null,this.closed_=[]}var t,n,r;return t=e,(n=[{key:"update",value:function(e){null==this.open_?this.start_(e):this.update_(e)}},{key:"getTimeSpentIn",value:function(e){var t=0;this.open_&&this.open_.state==e&&(t+=this.open_.duration);var n=!0,r=!1,i=void 0;try{for(var a,s=this.closed_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t+=o.state==e?o.duration:0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"getCopy",value:function(){var e=function(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}},t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.closed_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.push(e(o))}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return this.open_&&t.push(e(this.open_)),t}},{key:"start_",value:function(e){window.asserts.assert(null==this.open_,"There must be no open entry in order when we start"),this.open_={timestamp:this.getNowInSeconds_(),state:e,duration:0}}},{key:"update_",value:function(e){window.asserts.assert(this.open_,"There must be an open entry in order to update it");var t=this.getNowInSeconds_();this.open_.duration=t-this.open_.timestamp,this.open_.state!=e&&(this.closed_.push(this.open_),this.open_={timestamp:t,state:e,duration:0})}},{key:"getNowInSeconds_",value:function(){return Date.now()/1e3}}])&&qi(t.prototype,n),r&&qi(t,r),e}();function Yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Xi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentVariant_=null,this.currentText_=null,this.history_=[]}var t,n,r;return t=e,(n=[{key:"updateCurrentVariant",value:function(e,t){this.currentVariant_!=e&&(this.currentVariant_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"variant",fromAdaptation:t,bandwidth:e.bandwidth}))}},{key:"updateCurrentText",value:function(e,t){this.currentText_!=e&&(this.currentText_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"text",fromAdaptation:t,bandwidth:null}))}},{key:"getCopy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.history_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(this.clone_(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"getNowInSeconds_",value:function(){return Date.now()/1e3}},{key:"clone_",value:function(e){return{timestamp:e.timestamp,id:e.id,type:e.type,fromAdaptation:e.fromAdaptation,bandwidth:e.bandwidth}}}])&&Yi(t.prototype,n),r&&Yi(t,r),e}();function $i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Qi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width_=NaN,this.height_=NaN,this.totalDroppedFrames_=NaN,this.totalDecodedFrames_=NaN,this.loadLatencySeconds_=NaN,this.variantBandwidth_=NaN,this.bandwidthEstimate_=NaN,this.stateHistory_=new zi,this.switchHistory_=new Xi}var t,n,r;return t=e,r=[{key:"getEmptyBlob",value:function(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]}}}],(n=[{key:"setDroppedFrames",value:function(e,t){this.totalDroppedFrames_=e,this.totalDecodedFrames_=t}},{key:"setResolution",value:function(e,t){this.width_=e,this.height_=t}},{key:"setLoadLatency",value:function(e){this.loadLatencySeconds_=e}},{key:"setVariantBandwidth",value:function(e){this.variantBandwidth_=e}},{key:"setBandwidthEstimate",value:function(e){this.bandwidthEstimate_=e}},{key:"getStateHistory",value:function(){return this.stateHistory_}},{key:"getSwitchHistory",value:function(){return this.switchHistory_}},{key:"getBlob",value:function(){return{width:this.width_,height:this.height_,streamBandwidth:this.variantBandwidth_,decodedFrames:this.totalDecodedFrames_,droppedFrames:this.totalDroppedFrames_,estimatedBandwidth:this.bandwidthEstimate_,loadLatency:this.loadLatencySeconds_,playTime:this.stateHistory_.getTimeSpentIn("playing"),pauseTime:this.stateHistory_.getTimeSpentIn("paused"),bufferingTime:this.stateHistory_.getTimeSpentIn("buffering"),stateHistory:this.stateHistory_.getCopy(),switchHistory:this.switchHistory_.getCopy()}}}])&&$i(t.prototype,n),r&&$i(t,r),e}();function Zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Ji=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.libraryVersion_=t,this.onPending_=n,this.onExpired_=r}var t,n,r;return t=e,(n=[{key:"enforce",value:function(e,t,n){(e.compareTo(this.libraryVersion_)>0?this.onPending_:this.onExpired_)(this.libraryVersion_,e,t,n)}}])&&Zi(t.prototype,n),r&&Zi(t,r),e}();function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var ta=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.major_=t,this.minor_=n}var t,n,r;return t=e,r=[{key:"parse",value:function(t){var n=t.substring(1).split(".",2);return new e(Number(n[0]),Number(n[1]))}}],(n=[{key:"major",value:function(){return this.major_}},{key:"minor",value:function(){return this.minor_}},{key:"compareTo",value:function(e){var t=this.major_-e.major_,n=this.minor_-e.minor_;return t||n}},{key:"toString",value:function(){return"v"+this.major_+"."+this.minor_}}])&&ea(t.prototype,n),r&&ea(t,r),e}();function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ra=window.shaka,ia=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"init",value:function(t){window.asserts.assert(null==e.enforcer_,"Deprecate.init should only be called once."),e.enforcer_=new Ji(ta.parse(t),e.onPending_,e.onExpired_)}},{key:"deprecateFeature",value:function(t,n,r,i){var a=e.enforcer_;window.asserts.assert(a,"Missing deprecation enforcer. Was |init| called?");var s=new e.Version(t,n);a.enforce(s,r,i)}},{key:"onPending_",value:function(e,t,n,r){ra.log.alwaysWarn([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}},{key:"onExpired_",value:function(e,t,n,r){var i=[n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join("");ra.log.alwaysError(i),window.asserts.assert(!1,i)}}],(n=null)&&na(t.prototype,n),r&&na(t,r),e}());function aa(e){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sa(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function oa(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){sa(a,r,i,s,o,"next",e)}function o(e){sa(a,r,i,s,o,"throw",e)}s(void 0)})}}function ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function la(e){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function da(e,t){return(da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ia.enforcer_=null;var ha=c.net.NetworkingEngine,fa=c.util.ConfigUtils,pa=c.util.AbortableOperation,ma=new A;window.shaka=window.shaka||{};var va=window.shaka;window.goog=window.goog||{};var ya=window.goog,ga=function(e){function t(e,n){var r,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,a=la(t).call(this),(r=!a||"object"!==aa(a)&&"function"!=typeof a?ca(i):a).loadMode_=t.LoadMode.NOT_LOADED,r.video_=null,r.isTextVisible_=!1,r.eventManager_=new he,r.networkingEngine_=null,r.drmEngine_=null,r.mediaSourceEngine_=null,r.playhead_=null,r.playheadObservers_=null,r.playRateController_=null,r.bufferPoller_=null,r.bufferObserver_=null,r.regionTimeline_=null,r.streamingEngine_=null,r.parser_=null,r.manifest_=null,r.assetUri_=null,r.abrManager_=null,r.abrManagerFactory_=null,r.nextExternalStreamId_=1e9,r.loadingTextStreams_=new Set,r.switchingPeriods_=!0,r.deferredVariant_=null,r.deferredVariantClearBuffer_=!1,r.deferredVariantClearBufferSafeMargin_=0,r.deferredTextStream_=null,r.activeStreams_=new xr,r.config_=r.defaultConfig_(),r.lastTextFactory_,r.maxHwRes_={width:1/0,height:1/0},r.stats_=null,r.currentAdaptationSetCriteria_=new Fr(r.config_.preferredAudioLanguage,r.config_.preferredVariantRole,r.config_.preferredAudioChannelCount),r.currentTextLanguage_=r.config_.preferredTextLanguage,r.currentTextRole_=r.config_.preferredTextRole,n&&n(ca(r)),r.networkingEngine_=r.createNetworkingEngine(),r.eventManager_.listen(window,"online",function(){r.retryStreaming()}),r.detachNode_={name:"detach"},r.attachNode_={name:"attach"},r.unloadNode_={name:"unload"},r.parserNode_={name:"manifest-parser"},r.manifestNode_={name:"manifest"},r.mediaSourceNode_={name:"media-source"},r.drmNode_={name:"drm-engine"},r.loadNode_={name:"load"},r.srcEqualsDrmNode_={name:"src-equals-drm-engine"},r.srcEqualsNode_={name:"src-equals"};var s=new Map;s.set(r.attachNode_,function(e,t){return pa.notAbortable(r.onAttach_(e,t))}),s.set(r.detachNode_,function(e,t){return pa.notAbortable(r.onDetach_(e,t))}),s.set(r.unloadNode_,function(e,t){return pa.notAbortable(r.onUnload_(e,t))}),s.set(r.mediaSourceNode_,function(e,t){var n=r.onInitializeMediaSourceEngine_(e,t);return pa.notAbortable(n)}),s.set(r.parserNode_,function(e,t){var n=r.onInitializeParser_(e,t);return pa.notAbortable(n)}),s.set(r.manifestNode_,function(e,t){return r.onParseManifest_(e,t)}),s.set(r.drmNode_,function(e,t){var n=r.onInitializeDrm_(e,t);return pa.notAbortable(n)}),s.set(r.loadNode_,function(e,t){return pa.notAbortable(r.onLoad_(e,t))}),s.set(r.srcEqualsDrmNode_,function(e,t){var n=r.onInitializeSrcEqualsDrm_(e,t);return pa.notAbortable(n)}),s.set(r.srcEqualsNode_,function(e,t){return r.onSrcEquals_(e,t)});var o={getNext:function(e,t,n,i){return r.getNextStep_(e,t,n,i)},enterNode:function(e,t,n){return r.dispatchEvent(new D("onstatechange",{state:e.name})),s.get(e)(t,n)},handleError:function(){var e=oa(regeneratorRuntime.mark(function e(n,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return va.log.warning("The walker saw an error:"),i instanceof A?va.log.warning("Error Code:",i.code):(va.log.warning("Error Message:",i.message),va.log.warning("Error Stack:",i.stack)),e.next=4,r.onUnload_(n,t.createEmptyPayload_());case 4:return e.abrupt("return",n.mediaElement?r.attachNode_:r.detachNode_);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),onIdle:function(e){r.dispatchEvent(new D("onstateidle",{state:e.name}))}};return r.walker_=new ji(r.detachNode_,t.createEmptyPayload_(),o),e&&r.attach(e,!0),r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&da(e,t)}(t,H),n=t,r=[{key:"destroy",value:function(){var e=oa(regeneratorRuntime.mark(function e(){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.DESTROYED){e.next=2;break}return e.abrupt("return");case 2:return this.loadMode_=t.LoadMode.DESTROYED,n=this.walker_.startNewRoute(function(e){return{node:r.detachNode_,payload:t.createEmptyPayload_(),interruptible:!1}}),e.next=6,new Promise(function(e){n.onStart=function(){va.log.info("Preparing to destroy walker...")},n.onEnd=function(){e()},n.onCancel=function(){window.asserts.assert(!1,"Our final detach call should never be cancelled."),e()},n.onError=function(){window.asserts.assert(!1,"Our final detach call should never see an error"),e()},n.onSkip=function(){window.asserts.assert(!1,"Our final detach call should never be skipped"),e()}});case 6:return e.next=8,this.walker_.destroy();case 8:if(this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.abrManagerFactory_=null,this.abrManager_=null,this.config_=null,!this.networkingEngine_){e.next=16;break}return e.next=15,this.networkingEngine_.destroy();case 15:this.networkingEngine_=null;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"attach",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var r=t.createEmptyPayload_();r.mediaElement=e,lt.supportsMediaSource()||(n=!1);var i=n?this.mediaSourceNode_:this.attachNode_,a=this.walker_.startNewRoute(function(e){return{node:i,payload:r,interruptible:!1}});return a.onStart=function(){return va.log.info("Starting attach...")},this.wrapWalkerListenersWithPromise_(a)}},{key:"detach",value:function(){var e=this;if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var n=this.walker_.startNewRoute(function(n){return{node:e.detachNode_,payload:t.createEmptyPayload_(),interruptible:!1}});return n.onStart=function(){return va.log.info("Starting detach...")},this.wrapWalkerListenersWithPromise_(n)}},{key:"unload",value:function(){var e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());lt.supportsMediaSource()||(n=!1);var r=t.createEmptyPayload_(),i=this.walker_.startNewRoute(function(t){var i=null;return i=t.mediaElement&&n?e.mediaSourceNode_:t.mediaElement?e.attachNode_:e.detachNode_,window.asserts.assert(i,"We should have picked a destination."),r.mediaElement=t.mediaElement,{node:i,payload:r,interruptible:!1}});return i.onStart=function(){return va.log.info("Starting unload...")},this.wrapWalkerListenersWithPromise_(i)}},{key:"load",value:function(e,n,r){var i=this;if(this.loadMode_==t.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());this.dispatchEvent(new D("loading"));var a=t.createEmptyPayload_();if(console.log({payload:a}),a.uri=e,a.startTimeOfLoad=Date.now()/1e3,r&&"string"!=typeof r){ia.deprecateFeature(2,6,"Loading with a manifest parser factory","Please register a manifest parser and for the mime-type.");var s=r;a.factory=function(){return new s}}r&&"string"==typeof r&&(a.mimeType=r),void 0!==n&&(a.startTime=n);var o=this.shouldUseSrcEquals_(a)?this.srcEqualsNode_:this.loadNode_,u=this.walker_.startNewRoute(function(e){return null==e.mediaElement?null:(a.mediaElement=e.mediaElement,{node:o,payload:a,interruptible:!0})});return u.onStart=function(){return va.log.info("Starting load of "+e+"...")},new Promise(function(e,t){u.onSkip=function(){return t(new A(ma.severity.CRITICAL,ma.category.PLAYER,ma.code.NO_VIDEO_ELEMENT))},u.onEnd=function(){return e()},u.onCancel=function(){return t(i.createAbortLoadError_())},u.onError=function(e){return t(e)}})}},{key:"shouldUseSrcEquals_",value:function(e){if(e.factory)return!1;if(!lt.supportsMediaSource())return!0;var t=e.mimeType,n=e.uri||"";t||(t={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[Tn.getExtension(n)]);if(t){var r=lt.supportsMediaType(t);if(!r)return!1;var i=Tn.isSupported(n,t);return!i||(window.asserts.assert(r&&i,"Both native and MSE playback should be possible!"),lt.isApple())}return!1}},{key:"onAttach_",value:function(e,t){var n=this;if(window.asserts.assert(null==e.mediaElement||e.mediaElement==t.mediaElement,"The routing logic failed. MediaElement requirement failed."),null==e.mediaElement){e.mediaElement=t.mediaElement;this.eventManager_.listen(e.mediaElement,"error",function(e){return n.onVideoError_(e)})}return this.video_=e.mediaElement,Promise.resolve()}},{key:"onDetach_",value:function(e,t){return e.mediaElement&&(this.eventManager_.unlisten(e.mediaElement,"error"),e.mediaElement=null),this.video_=null,Promise.resolve()}},{key:"onUnload_",value:function(){var e=oa(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.DESTROYED&&(this.loadMode_=t.LoadMode.NOT_LOADED),this.dispatchEvent(new D("unloading")),n.factory=null,n.mimeType=null,n.startTime=null,n.uri=null,n.mediaElement&&(this.eventManager_.unlisten(n.mediaElement,"loadeddata"),this.eventManager_.unlisten(n.mediaElement,"playing"),this.eventManager_.unlisten(n.mediaElement,"pause"),this.eventManager_.unlisten(n.mediaElement,"ended"),this.eventManager_.unlisten(n.mediaElement,"ratechange")),this.playheadObservers_&&(this.playheadObservers_.release(),this.playheadObservers_=null),this.bufferPoller_&&(this.bufferPoller_.stop(),this.bufferPoller_=null),!this.parser_){e.next=13;break}return e.next=12,this.parser_.stop();case 12:this.parser_=null;case 13:if(!this.abrManager_){e.next=16;break}return e.next=16,this.abrManager_.stop();case 16:if(!this.streamingEngine_){e.next=20;break}return e.next=19,this.streamingEngine_.destroy();case 19:this.streamingEngine_=null;case 20:if(this.playhead_&&(this.playhead_.release(),this.playhead_=null),!this.mediaSourceEngine_){e.next=25;break}return e.next=24,this.mediaSourceEngine_.destroy();case 24:this.mediaSourceEngine_=null;case 25:if(n.mediaElement&&n.mediaElement.src&&(n.mediaElement.removeAttribute("src"),n.mediaElement.load()),!this.drmEngine_){e.next=30;break}return e.next=29,this.drmEngine_.destroy();case 29:this.drmEngine_=null;case 30:this.activeStreams_.clear(),this.assetUri_=null,this.bufferObserver_=null,this.loadingTextStreams_.clear(),this.manifest_=null,this.stats_=null,this.lastTextFactory_=null,this.switchingPeriods_=!0,this.updateBufferState_();case 39:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeMediaSourceEngine_",value:function(){var e=oa(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(lt.supportsMediaSource(),"We should not be initializing media source on a platform that does not support media source."),window.asserts.assert(t.mediaElement,"We should have a media element when initializing media source."),window.asserts.assert(t.mediaElement==n.mediaElement,"|has| and |wants| should have the same media element when initializing media source."),window.asserts.assert(null==this.mediaSourceEngine_,"We should not have a media source engine yet."),r=Lt.isSupported()?new Lt:new Nt,i=this.config_.textDisplayFactory,a=new i,this.lastTextFactory_=i,s=this.createMediaSourceEngine(t.mediaElement,r,a),e.next=11,s.open();case 11:this.mediaSourceEngine_=s;case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeParser_",value:function(){var e=oa(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.asserts.assert(t.mediaElement,"We should have a media element when initializing the parser."),window.asserts.assert(t.mediaElement==n.mediaElement,"|has| and |wants| should have the same media element when initializing the parser."),window.asserts.assert(this.networkingEngine_,"Need networking engine when initializing the parser."),window.asserts.assert(this.config_,"Need player config when initializing the parser."),t.factory=n.factory,t.mimeType=n.mimeType,t.uri=n.uri,window.asserts.assert(t.uri,"We should have an asset uri when initializing the parsing."),r=t.uri,i=this.networkingEngine_,this.assetUri_=r,!t.factory){e.next=15;break}this.parser_=t.factory(),e.next=18;break;case 15:return e.next=17,Tn.create(r,i,this.config_.manifest.retryParameters,t.mimeType);case 17:this.parser_=e.sent;case 18:this.parser_.configure(this.config_.manifest);case 19:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onParseManifest_",value:function(e,n){var r=this;window.asserts.assert(e.factory==n.factory,"|has| and |wants| should have the same factory when parsing."),window.asserts.assert(e.mimeType==n.mimeType,"|has| and |wants| should have the same mime type when parsing."),window.asserts.assert(e.uri==n.uri,"|has| and |wants| should have the same uri when parsing."),window.asserts.assert(e.uri,"|has| should have a valid uri when parsing."),window.asserts.assert(e.uri==this.assetUri_,"|has.uri| should match the cached asset uri."),window.asserts.assert(this.networkingEngine_,"Need networking engine to parse manifest."),window.asserts.assert(this.config_,"Need player config to parse manifest."),window.asserts.assert(this.parser_,"|this.parser_| should have been set in an earlier step.");var i=e.uri,a=this.networkingEngine_;this.regionTimeline_=new bi,this.regionTimeline_.setListeners(function(e){r.onRegionEvent_("timelineregionadded",e)});var s={networkingEngine:a,filterNewPeriod:function(e){return r.filterNewPeriod_(e)},filterAllPeriods:function(e){return r.filterAllPeriods_(e)},onTimelineRegionAdded:function(e){return r.regionTimeline_.addRegion(e)},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.onError_(e)}};return new pa(oa(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.parser_.start(i,s);case 2:if(r.manifest_=e.sent,r.dispatchEvent(new D("manifestparsed")),0!=r.manifest_.periods.length){e.next=6;break}throw new A(ma.severity.CRITICAL,ma.category.MANIFEST,ma.code.NO_PERIODS);case 6:t.filterForAVVariants_(r.manifest_.periods);case 7:case"end":return e.stop()}},e)}))(),function(){return va.log.info("Aborting parser step..."),r.parser_.stop()})}},{key:"onInitializeDrm_",value:function(){var e=oa(regeneratorRuntime.mark(function e(t,n){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(t.factory==n.factory,"The load graph should have ensured the factories matched."),window.asserts.assert(t.mimeType==n.mimeType,"The load graph should have ensured the mime types matched."),window.asserts.assert(t.uri==n.uri,"The load graph should have ensured the uris matched"),window.asserts.assert(this.networkingEngine_,"|onInitializeDrm_| should never be called after |destroy|"),window.asserts.assert(this.config_,"|onInitializeDrm_| should never be called after |destroy|"),window.asserts.assert(this.manifest_,"|this.manifest_| should have been set in an earlier step."),this.drmEngine_=this.createDrmEngine({netEngine:this.networkingEngine_,onError:function(e){r.onError_(e)},onKeyStatus:function(e){r.onKeyStatus_(e)},onExpirationUpdated:function(e,t){r.onExpirationUpdated_(e,t)},onEvent:function(e){r.dispatchEvent(e)}}),this.drmEngine_.configure(this.config_.drm),e.next=10,this.drmEngine_.initForPlayback(kr.getAllVariantsFrom(this.manifest_.periods),this.manifest_.offlineSessionIds);case 10:this.filterAllPeriods_(this.manifest_.periods);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onLoad_",value:function(){var e=oa(regeneratorRuntime.mark(function e(n,r){var i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(n.factory==r.factory,"|has| and |wants| should have the same factory when loading."),window.asserts.assert(n.mimeType==r.mimeType,"|has| and |wants| should have the same mime type when loading."),window.asserts.assert(n.uri==r.uri,"|has| and |wants| should have the same uri when loading."),window.asserts.assert(n.mediaElement,"We should have a media element when loading."),window.asserts.assert(r.startTimeOfLoad,"|wants| should tell us when the load was originally requested"),n.startTime=r.startTime,i=n.mediaElement,a=n.uri,this.assetUri_=a,this.stats_=new Qi,s=function(){return b.updateStateHistory_()},o=function(){return b.onRateChange_()},this.eventManager_.listen(i,"playing",s),this.eventManager_.listen(i,"pause",s),this.eventManager_.listen(i,"ended",s),this.eventManager_.listen(i,"ratechange",o),u=this.config_.abrFactory,this.abrManager_&&this.abrManagerFactory_==u||(this.abrManagerFactory_=u,this.abrManager_=new u,this.abrManager_.configure(this.config_.abr)),this.createTextStreamsForClosedCaptions_(this.manifest_.periods),this.currentAdaptationSetCriteria_=new Fr(this.config_.preferredAudioLanguage,this.config_.preferredVariantRole,this.config_.preferredAudioChannelCount),this.currentTextLanguage_=this.config_.preferredTextLanguage,t.applyPlayRange_(this.manifest_.presentationTimeline,this.config_.playRangeStart,this.config_.playRangeEnd),e.next=24,this.drmEngine_.attach(i);case 24:return this.abrManager_.init(function(e,t,n){return b.switch_(e,t,n)}),this.playhead_=this.createPlayhead(n.startTime),this.playheadObservers_=this.createPlayheadObserversForMSE_(),this.playRateController_=new qr({getRate:function(){return n.mediaElement.playbackRate},setRate:function(e){n.mediaElement.playbackRate=e},movePlayhead:function(e){n.mediaElement.currentTime+=e}}),l=Math.max(this.manifest_.minBufferTime,this.config_.streaming.rebufferingGoal),this.startBufferManagement_(l),this.streamingEngine_=this.createStreamingEngine(),this.streamingEngine_.configure(this.config_.streaming),this.chooseCodecsAndFilterManifest_(),this.loadMode_=t.LoadMode.MEDIA_SOURCE,this.dispatchEvent(new D("streaming")),e.next=37,this.streamingEngine_.start();case 37:for(this.config_.streaming.startAtSegmentBoundary&&(c=this.playhead_.getTime(),d=this.adjustStartTime_(c),this.playhead_.setStartTime(d)),h=!0,f=!1,p=void 0,e.prev=41,m=this.manifest_.periods[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)y=v.value,this.filterNewPeriod_(y);e.next=49;break;case 45:e.prev=45,e.t0=e.catch(41),f=!0,p=e.t0;case 49:e.prev=49,e.prev=50,h||null==m.return||m.return();case 52:if(e.prev=52,!f){e.next=55;break}throw p;case 55:return e.finish(52);case 56:return e.finish(49);case 57:this.onTracksChanged_(),this.onAdaptation_(),g=this.getPresentationPeriod_(),_=g.variants.some(function(e){return e.primary}),this.config_.preferredAudioLanguage||_||va.log.warning("No preferred audio language set.  We will choose an arbitrary language initially"),this.chooseVariant_(g.variants),this.eventManager_.listenOnce(i,"loadeddata",function(){var e=Date.now()/1e3-r.startTimeOfLoad;b.stats_.setLoadLatency(e)});case 64:case"end":return e.stop()}},e,this,[[41,45,49,57],[50,,52,56]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onInitializeSrcEqualsDrm_",value:function(){var e=oa(regeneratorRuntime.mark(function e(t,n){var r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee.ContentType,window.asserts.assert(this.networkingEngine_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),window.asserts.assert(this.config_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),this.drmEngine_=this.createDrmEngine({netEngine:this.networkingEngine_,onError:function(e){a.onError_(e)},onKeyStatus:function(e){a.onKeyStatus_(e)},onExpirationUpdated:function(e,t){a.onExpirationUpdated_(e,t)},onEvent:function(e){a.dispatchEvent(e)}}),this.drmEngine_.configure(this.config_.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return null},getSegmentReference:function(e){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:r.VIDEO,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},e.next=8,this.drmEngine_.initForPlayback([i],[]);case 8:return e.next=10,this.drmEngine_.attach(t.mediaElement);case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onSrcEquals_",value:function(e,n){var r=this;window.asserts.assert(e.mediaElement,"We should have a media element when loading."),window.asserts.assert(n.uri,"|has| should have a valid uri when loading."),window.asserts.assert(n.startTimeOfLoad,"|wants| should tell us when the load was originally requested"),window.asserts.assert(this.video_==e.mediaElement,"The video element should match our media element"),e.uri=n.uri,e.startTime=n.startTime,this.assetUri_=e.uri,this.stats_=new Qi,this.playhead_=new SrcEqualsPlayhead(e.mediaElement),null!=e.startTime&&this.playhead_.setStartTime(e.startTime),this.playRateController_=new qr({getRate:function(){return e.mediaElement.playbackRate},setRate:function(t){e.mediaElement.playbackRate=t},movePlayhead:function(t){e.mediaElement.currentTime+=t}});var i=this.config_.streaming.rebufferingGoal;this.startBufferManagement_(i);var a=function(){return r.updateStateHistory_()};if(this.eventManager_.listen(e.mediaElement,"playing",a),this.eventManager_.listen(e.mediaElement,"pause",a),this.eventManager_.listen(e.mediaElement,"ended",a),this.eventManager_.listenOnce(e.mediaElement,"loadeddata",function(){var e=Date.now()/1e3-n.startTimeOfLoad;r.stats_.setLoadLatency(e)}),this.video_.audioTracks&&(this.eventManager_.listen(this.video_.audioTracks,"addtrack",function(){return r.onTracksChanged_()}),this.eventManager_.listen(this.video_.audioTracks,"removetrack",function(){return r.onTracksChanged_()})),this.video_.textTracks){var s=this.video_.textTracks;this.eventManager_.listen(s,"addtrack",function(){return r.onTracksChanged_()}),this.eventManager_.listen(s,"removetrack",function(){return r.onTracksChanged_()})}e.mediaElement.src=e.uri,this.loadMode_=t.LoadMode.SRC_EQUALS,this.dispatchEvent(new D("streaming"));var o=new PublicPromise;return this.video_.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?o.resolve():this.video_.error?o.reject(this.videoErrorToShakaError_()):(this.eventManager_.listenOnce(this.video_,"loadeddata",function(){o.resolve()}),this.eventManager_.listenOnce(this.video_,"error",function(){o.reject(r.videoErrorToShakaError_())})),new pa(o,function(){var e=new A(ma.severity.CRITICAL,ma.category.PLAYER,ma.code.OPERATION_ABORTED);return o.reject(e),Promise.resolve()})}},{key:"chooseCodecsAndFilterManifest_",value:function(){var e=this.manifest_.periods.reduce(function(e,t){return e.concat(t.variants)},[]);function t(e){var t="";e.video&&(t=st.getCodecBase(e.video.codecs));var n="";return e.audio&&(n=st.getCodecBase(e.audio.codecs)),t+"-"+n}e=an.filterVariantsByAudioChannelCount(e,this.config_.preferredAudioChannelCount);var n=new B,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=t(u);n.push(l,u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var c=null,d=1/0;n.forEach(function(e,t){var n=0,r=0,i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){n+=o.value.bandwidth||0,++r}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var l=n/r;va.log.debug("codecs",e,"avg bandwidth",l),l<d&&(c=e,d=l)}),window.asserts.assert(null!=c,"Should have chosen codecs!"),window.asserts.assert(!isNaN(d),"Bandwidth should be a number!");var h=!0,f=!1,p=void 0;try{for(var m,v=this.manifest_.periods[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;y.variants=y.variants.filter(function(e){return t(e)==c||(va.log.debug("Dropping Variant (better codec available)",e),!1)})}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}},{key:"createDrmEngine",value:function(e){return new Tt(e)}},{key:"createNetworkingEngine",value:function(){var e=this;return new ha(function(t,n){e.abrManager_&&e.abrManager_.segmentDownloaded(t,n)})}},{key:"createPlayhead",value:function(e){var t=this;return window.asserts.assert(this.manifest_,"Must have manifest"),window.asserts.assert(this.video_,"Must have video"),new hi(this.video_,this.manifest_,this.config_.streaming,e,function(){return t.onSeek_()},function(e){return t.dispatchEvent(e)})}},{key:"createPlayheadObserversForMSE_",value:function(){var e=this;window.asserts.assert(this.manifest_,"Must have manifest"),window.asserts.assert(this.regionTimeline_,"Must have region timeline"),window.asserts.assert(this.video_,"Must have video element");var t=new Kr(this.manifest_);t.setListeners(function(t){return e.onChangePeriod_()});var n=new gi(this.regionTimeline_);n.setListeners(function(t,n){e.onRegionEvent_("timelineregionenter",t)},function(t,n){e.onRegionEvent_("timelineregionexit",t)},function(t,n){n||(e.onRegionEvent_("timelineregionenter",t),e.onRegionEvent_("timelineregionexit",t))});var r=new vi(this.video_);return r.manage(t),r.manage(n),r}},{key:"startBufferManagement_",value:function(e){var n=this;window.asserts.assert(!this.bufferObserver_,"No buffering observer should exist before initialization."),window.asserts.assert(!this.bufferPoller_,"No buffer timer should exist before initialization.");var r=e,i=Math.min(t.TYPICAL_BUFFERING_THRESHOLD_,e/2);this.bufferObserver_=new jr(r,i),this.bufferObserver_.setState(jr.State.STARVING),this.updateBufferState_(),this.bufferPoller_=new ve(function(){n.pollBufferState_()}).tickEvery(.25)}},{key:"pollBufferState_",value:function(){var e;switch(window.asserts.assert(this.video_,"Need a media element to update the buffering observer"),window.asserts.assert(this.bufferObserver_,"Need a buffering observer to update"),this.loadMode_){case t.LoadMode.SRC_EQUALS:e=this.isBufferedToEndSrc_();break;case t.LoadMode.MEDIA_SOURCE:e=this.isBufferedToEndMS_();break;default:e=!1}var n=Mt.bufferedAheadOf(this.video_.buffered,this.video_.currentTime);this.bufferObserver_.update(n,e)&&this.updateBufferState_()}},{key:"createMediaSourceEngine",value:function(e,t,n){return new Jt(e,t,n)}},{key:"createStreamingEngine",value:function(){var e=this;window.asserts.assert(this.playhead_&&this.abrManager_&&this.mediaSourceEngine_&&this.manifest_,"Must not be destroyed");var t={getPresentationTime:function(){return e.playhead_.getTime()},getBandwidthEstimate:function(){return e.abrManager_.getBandwidthEstimate()},mediaSourceEngine:this.mediaSourceEngine_,netEngine:this.networkingEngine_,onChooseStreams:function(t){return e.onChooseStreams_(t)},onCanSwitch:function(){return e.canSwitch_()},onError:function(t){return e.onError_(t)},onEvent:function(t){return e.dispatchEvent(t)},onManifestUpdate:function(){return e.onManifestUpdate_()},onSegmentAppended:function(){return e.onSegmentAppended_()}};return new Di(this.manifest_,t)}},{key:"configure",value:function(e,t){window.asserts.assert(this.config_,"Config must not be null!"),window.asserts.assert("object"==aa(e)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=fa.convertToConfigObject(e,t)),window.asserts.assert("object"==aa(e),"Should be an object!");var n=vn.mergeConfigObjects(this.config_,e,this.defaultConfig_());return this.applyConfig_(),n}},{key:"applyConfig_",value:function(){if(this.parser_&&this.parser_.configure(this.config_.manifest),this.drmEngine_&&this.drmEngine_.configure(this.config_.drm),this.streamingEngine_){this.streamingEngine_.configure(this.config_.streaming);try{var e=!0,t=!1,n=void 0;try{for(var r,i=this.manifest_.periods[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.filterNewPeriod_(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}catch(e){this.onError_(e)}var s=this.streamingEngine_.getBufferingAudio(),o=this.streamingEngine_.getBufferingVideo(),u=this.getPresentationPeriod_(),l=an.getVariantByStreams(s,o,u.variants);this.abrManager_&&l&&l.allowedByApplication&&l.allowedByKeySystem?this.chooseVariant_(u.variants):(va.log.debug("Choosing new streams after changing configuration"),this.chooseStreamsAndSwitch_(u))}if(this.mediaSourceEngine_){var c=this.config_.textDisplayFactory;if(this.lastTextFactory_!=c){var d=new c;this.mediaSourceEngine_.setTextDisplayer(d),this.lastTextFactory_=c,this.streamingEngine_&&this.streamingEngine_.reloadTextStream()}}this.abrManager_&&(this.abrManager_.configure(this.config_.abr),this.config_.abr.enabled&&!this.switchingPeriods_?this.abrManager_.enable():this.abrManager_.disable(),this.onAbrStatusChanged_())}},{key:"getConfiguration",value:function(){window.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return vn.mergeConfigObjects(e,this.config_,this.defaultConfig_()),e}},{key:"getSharedConfiguration",value:function(){return window.asserts.assert(this.config_,"Cannot call getSharedConfiguration after call destroy!"),this.config_}},{key:"resetConfiguration",value:function(){for(var e in window.asserts.assert(this.config_,"Cannot be destroyed"),this.config_)delete this.config_[e];vn.mergeConfigObjects(this.config_,this.defaultConfig_(),this.defaultConfig_()),this.applyConfig_()}},{key:"getLoadMode",value:function(){return this.loadMode_}},{key:"getMediaElement",value:function(){return this.video_}},{key:"getNetworkingEngine",value:function(){return this.networkingEngine_}},{key:"getAssetUri",value:function(){return this.assetUri_}},{key:"getManifestUri",value:function(){return ia.deprecateFeature(2,6,"getManifestUri",'Please use "getAssetUri" instead.'),this.getAssetUri()}},{key:"isLive",value:function(){return this.manifest_?this.manifest_.presentationTimeline.isLive():!(!this.video_||!this.video_.src)&&this.video_.duration==1/0}},{key:"isInProgress",value:function(){return!!this.manifest_&&this.manifest_.presentationTimeline.isInProgress()}},{key:"isAudioOnly",value:function(){if(this.manifest_){if(!this.manifest_.periods.length)return!1;var e=this.manifest_.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.video_||!this.video_.src)&&(this.video_.videoTracks?0==this.video_.videoTracks.length:0==this.video_.videoHeight)}},{key:"seekRange",value:function(){if(this.manifest_){var e=this.manifest_.presentationTimeline;return{start:e.getSeekRangeStart(),end:e.getSeekRangeEnd()}}if(this.video_&&this.video_.src){var t=this.video_.seekable;if(t.length)return{start:t.start(0),end:t.end(t.length-1)}}return{start:0,end:0}}},{key:"keySystem",value:function(){return this.drmEngine_?this.drmEngine_.keySystem():""}},{key:"drmInfo",value:function(){return this.drmEngine_?this.drmEngine_.getDrmInfo():null}},{key:"getExpiration",value:function(){return this.drmEngine_?this.drmEngine_.getExpiration():1/0}},{key:"isBuffering",value:function(){var e=jr.State;return!!this.bufferObserver_&&this.bufferObserver_.getState()==e.STARVING}},{key:"getPlaybackRate",value:function(){return this.playRateController_?this.playRateController_.getActiveRate():0}},{key:"trickPlay",value:function(e){window.asserts.assert(0!=e,"Should never set a trick play rate of 0!"),0!=e?(this.video_.paused&&this.video_.play(),this.playRateController_.set(e),this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.setTrickPlay(Math.abs(e)>1)):va.log.alwaysWarn("A trick play rate of 0 is unsupported!")}},{key:"cancelTrickPlay",value:function(){this.loadMode_==t.LoadMode.SRC_EQUALS&&this.playRateController_.set(1),this.loadMode_==t.LoadMode.MEDIA_SOURCE&&(this.playRateController_.set(1),this.streamingEngine_.setTrickPlay(!1))}},{key:"getVariantTracks",value:function(){if(this.manifest_&&this.playhead_){var e=this.getPresentationVariant_(),t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.getSelectableVariants_()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=an.variantToTrack(o);u.active=o==e,t.push(u)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}return this.video_&&this.video_.audioTracks?Array.from(this.video_.audioTracks).map(function(e){return an.html5AudioTrackToTrack(e)}):[]}},{key:"getTextTracks",value:function(){if(this.manifest_&&this.playhead_){var e=this.getPresentationText_(),t=[],n=!0,r=!1,i=void 0;try{for(var a,s=this.getSelectableText_()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=an.textStreamToTrack(o);u.active=o==e,t.push(u)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}return this.video_&&this.video_.src&&this.video_.textTracks?Array.from(this.video_.textTracks).map(function(e){return an.html5TextTrackToTrack(e)}):[]}},{key:"selectTextTrack",value:function(e){if(this.manifest_&&this.streamingEngine_){var t=this.getPresentationPeriod_(),n=t.textStreams.find(function(t){return t.id==e.id});if(!n)return void va.log.error("No stream with id",e.id);this.addTextStreamToSwitchHistory_(t,n,!1),this.switchTextStream_(n),this.currentTextLanguage_=n.language}else if(this.video_&&this.video_.src&&this.video_.textTracks){for(var r=0,i=Array.from(this.video_.textTracks);r<i.length;r++){var a=i[r];an.html5TrackId(a)==e.id?a.mode=this.isTextVisible_?"showing":"hidden":a.mode="disabled"}this.onTextChanged_()}}},{key:"selectEmbeddedTextTrack",value:function(){ia.deprecateFeature(2,6,"selectEmbeddedTextTrack",["If closed captions are signaled in the manifest, a text stream will","be created to represent them. Please use SelectTextTrack."].join(" "));var e=this.getTextTracks().filter(function(e){return e.mimeType==st.CLOSED_CAPTION_MIMETYPE});e.length>0?this.selectTextTrack(e[0]):va.log.warning("Unable to find the text track embedded in the video.")}},{key:"usingEmbeddedTextTrack",value:function(){ia.deprecateFeature(2,6,"usingEmbeddedTextTrack",["If closed captions are signaled in the manifest, a text stream will","be created to represent them. There should be no reason to know if","the player is playing embedded text."].join(" "));var e=this.getTextTracks().filter(function(e){return e.active})[0];return!!e&&e.mimeType==st.CLOSED_CAPTION_MIMETYPE}},{key:"selectVariantTrack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.manifest_&&this.streamingEngine_){var r=this.getPresentationPeriod_();this.config_.abr.enabled&&va.log.alwaysWarn("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=r.variants.find(function(t){return t.id==e.id});if(!i)return void va.log.error("No variant with id",e.id);if(!an.isPlayable(i))return void va.log.error("Unable to switch to restricted track",e.id);this.addVariantToSwitchHistory_(r,i,!1),this.switchVariant_(i,t,n),this.currentAdaptationSetCriteria_=new Ur(i),this.chooseVariant_(r.variants)}else if(this.video_&&this.video_.audioTracks){for(var a=0,s=Array.from(this.video_.audioTracks);a<s.length;a++){var o=s[a];an.html5TrackId(o)==e.id&&(o.enabled=!0)}this.onVariantChanged_()}}},{key:"getAudioLanguagesAndRoles",value:function(){return t.getLanguageAndRolesFrom_(this.getVariantTracks())}},{key:"getTextLanguagesAndRoles",value:function(){return t.getLanguageAndRolesFrom_(this.getTextTracks())}},{key:"getAudioLanguages",value:function(){return Array.from(t.getLanguagesFrom_(this.getVariantTracks()))}},{key:"getTextLanguages",value:function(){return Array.from(t.getLanguagesFrom_(this.getTextTracks()))}},{key:"selectAudioLanguage",value:function(e,t){if(this.manifest_&&this.playhead_){var n=this.getPresentationPeriod_();this.currentAdaptationSetCriteria_=new Fr(e,t||"",0),this.chooseStreamsAndSwitch_(n)}else if(this.video_&&this.video_.audioTracks){for(var r=0,i=Array.from(this.video_.audioTracks);r<i.length;r++){var a=i[r];a.language==e&&(a.enabled=!0)}this.onVariantChanged_()}}},{key:"selectTextLanguage",value:function(e,t){if(this.manifest_&&this.playhead_){var n=this.getPresentationPeriod_();this.currentTextLanguage_=e,this.currentTextRole_=t||"",this.chooseStreamsAndSwitch_(n)}else{var r=this.getTextTracks().filter(function(t){return t.language==e})[0];r&&this.selectTextTrack(r)}}},{key:"isTextTrackVisible",value:function(){var e=this.isTextVisible_;if(this.manifest_){var t=this.mediaSourceEngine_.getTextDisplayer().isTextVisible();return window.asserts.assert(t==e,"text visibility has fallen out of sync"),t}return this.video_&&this.video_.src&&this.video_.textTracks?Array.from(this.video_.textTracks).some(function(e){return"showing"==e.mode}):e}},{key:"setTextTrackVisibility",value:function(){var e=oa(regeneratorRuntime.mark(function e(n){var r,i,a,s,o,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isTextVisible_!=(r=n)){e.next=4;break}return e.abrupt("return");case 4:if(this.isTextVisible_=r,this.loadMode_!=t.LoadMode.MEDIA_SOURCE){e.next=19;break}if(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(n),this.config_.streaming.alwaysStreamText){e.next=17;break}if(!n){e.next=16;break}if(i=this.getPresentationPeriod_(),!((a=an.filterStreamsByLanguageAndRole(i.textStreams,this.currentTextLanguage_,this.currentTextRole_)).length>0)){e.next=14;break}return e.next=14,this.streamingEngine_.loadNewTextStream(a[0]);case 14:e.next=17;break;case 16:this.streamingEngine_.unloadTextStream();case 17:e.next=20;break;case 19:if(this.video_&&this.video_.src&&this.video_.textTracks)for(s=Array.from(this.video_.textTracks),o=0,u=s;o<u.length;o++)"disabled"!=(l=u[o]).mode&&(l.mode=n?"showing":"hidden");case 20:this.onTextTrackVisibility_();case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPlayheadTimeAsDate",value:function(){if(!this.isLive())return va.log.warning("getPlayheadTimeAsDate is for live streams!"),null;if(this.manifest_){var e=this.manifest_.presentationTimeline.getPresentationStartTime(),t=this.video_.currentTime;return new Date(1e3*(e+t))}if(this.video_&&this.video_.getStartDate){var n=this.video_.getStartDate();return isNaN(n.getTime())?(va.log.warning("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(n.getTime()+1e3*this.video_.currentTime)}return va.log.warning("No way to get playhead time as Date!"),null}},{key:"getPresentationStartTimeAsDate",value:function(){if(!this.isLive())return va.log.warning("getPresentationStartTimeAsDate is for live streams!"),null;if(this.manifest_){var e=this.manifest_.presentationTimeline.getPresentationStartTime();return new Date(1e3*e)}if(this.video_&&this.video_.getStartDate){var t=this.video_.getStartDate();return isNaN(t.getTime())?(va.log.warning("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):t}return va.log.warning("No way to get presentation start time as Date!"),null}},{key:"getBufferedInfo",value:function(){var e={total:[],audio:[],video:[],text:[]};if(this.loadMode_==t.LoadMode.SRC_EQUALS){var n=n;e.total=n.getBufferedInfo(this.video_.buffered)}return this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.mediaSourceEngine_.getBufferedInfo(e),e}},{key:"getStats",value:function(){if(!(this.loadMode_==t.LoadMode.MEDIA_SOURCE||this.loadMode_==t.LoadMode.SRC_EQUALS))return Qi.getEmptyBlob();this.updateStateHistory_(),window.asserts.assert(this.video_,"If we have stats, we should have video_");var e=this.video_;if(e.getVideoPlaybackQuality){var n=e.getVideoPlaybackQuality();this.stats_.setDroppedFrames(Number(n.droppedVideoFrames),Number(n.totalVideoFrames))}if(this.loadMode_==t.LoadMode.MEDIA_SOURCE){var r=this.getPresentationVariant_();r&&this.stats_.setVariantBandwidth(r.bandwidth),r&&r.video&&this.stats_.setResolution(r.video.width||NaN,r.video.height||NaN);var i=this.abrManager_.getBandwidthEstimate();this.stats_.setBandwidthEstimate(i)}return this.stats_.getBlob()}},{key:"addTextTrack",value:function(){var e=oa(regeneratorRuntime.mark(function e(n,r,i,a,s,o){var u,l,c,d,h,f,p,m,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadMode_!=t.LoadMode.SRC_EQUALS){e.next=3;break}throw va.log.error("Cannot add text when loaded with src="),new A("State error!");case 3:if(this.loadMode_==t.LoadMode.MEDIA_SOURCE){e.next=6;break}throw va.log.error("Must call load() and wait for it to resolve before adding text tracks."),new A("State error!");case 6:if(u=this.getPresentationPeriod_(),l=ee.ContentType,c=this.manifest_.periods.indexOf(u),h=(d=c+1)>=this.manifest_.periods.length?this.manifest_.presentationTimeline.getDuration():this.manifest_.periods[d].startTime,(f=h-u.startTime)!=1/0){e.next=14;break}throw new A(ma.severity.RECOVERABLE,ma.category.MANIFEST,ma.code.CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM);case 14:return p=new ir(1,0,f,function(){return[n]},0,null),m={id:this.nextExternalStreamId_++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:a,codecs:s||"",kind:i,encrypted:!1,keyId:null,language:r,label:o||null,type:l.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},this.loadingTextStreams_.add(m),u.textStreams.push(m),e.next=20,this.streamingEngine_.loadNewTextStream(m);case 20:return window.asserts.assert(u,"The period should still be non-null here."),(v=this.streamingEngine_.getBufferingText())&&this.activeStreams_.useText(u,v),this.loadingTextStreams_.delete(m),va.log.debug("Choosing new streams after adding a text stream"),this.chooseStreamsAndSwitch_(u),this.onTracksChanged_(),e.abrupt("return",an.textStreamToTrack(m));case 28:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a,s){return e.apply(this,arguments)}}()},{key:"setMaxHardwareResolution",value:function(e,t){this.maxHwRes_.width=e,this.maxHwRes_.height=t}},{key:"retryStreaming",value:function(){return this.loadMode_==t.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.retry()}},{key:"getManifest",value:function(){return this.manifest_}},{key:"getManifestParserFactory",value:function(){return this.parser_?this.parser_.constructor:null}},{key:"addVariantToSwitchHistory_",value:function(e,t,n){this.activeStreams_.useVariant(e,t),this.stats_.getSwitchHistory().updateCurrentVariant(t,n)}},{key:"addTextStreamToSwitchHistory_",value:function(e,t,n){this.activeStreams_.useText(e,t),this.stats_.getSwitchHistory().updateCurrentText(t,n)}},{key:"defaultConfig_",value:function(){var e=this,t=vn.createDefault();t.streaming.failureCallback=function(t){e.defaultStreamingFailureCallback_(t)};var n=this;return t.textDisplayFactory=function(){return new Wi(n.video_)},t}},{key:"defaultStreamingFailureCallback_",value:function(e){var t=[ma.code.BAD_HTTP_STATUS,ma.code.HTTP_ERROR,ma.code.TIMEOUT];this.isLive()&&t.includes(e.code)&&(e.severity=ma.severity.RECOVERABLE,va.log.warning("Live streaming error.  Retrying automatically..."),this.retryStreaming())}},{key:"createTextStreamsForClosedCaptions_",value:function(e){var t=ee.ContentType,n=ee.TextStreamKind,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=new Map,c=!0,d=!1,h=void 0;try{for(var f,p=u.variants[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;if(m.video&&m.video.closedCaptions){var v=m.video,y=!0,g=!1,_=void 0;try{for(var b,w=v.closedCaptions.keys()[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var E=b.value;if(!l.has(E)){var S={id:this.nextExternalStreamId_++,originalId:E,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return null},getSegmentReference:function(e){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:st.CLOSED_CAPTION_MIMETYPE,codecs:"",kind:n.CLOSED_CAPTION,encrypted:!1,keyId:null,language:v.closedCaptions.get(E),label:null,type:t.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:v.roles,channelsCount:null,closedCaptions:null};l.set(E,S)}}}catch(e){g=!0,_=e}finally{try{y||null==w.return||w.return()}finally{if(g)throw _}}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var T=!0,k=!1,C=void 0;try{for(var I,A=l.values()[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){var x=I.value;u.textStreams.push(x)}}catch(e){k=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(k)throw C}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"filterAllPeriods_",value:function(e){window.asserts.assert(this.video_,"Must not be destroyed");var t=this.streamingEngine_?this.streamingEngine_.getBufferingAudio():null,n=this.streamingEngine_?this.streamingEngine_.getBufferingVideo():null,r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;an.filterNewPeriod(this.drmEngine_,t,n,u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var l=Fn.count(e,function(e){return e.variants.some(an.isPlayable)});if(0==l)throw new A(ma.severity.CRITICAL,ma.category.MANIFEST,ma.code.CONTENT_UNSUPPORTED_BY_BROWSER);if(l<e.length)throw new A(ma.severity.CRITICAL,ma.category.MANIFEST,ma.code.UNPLAYABLE_PERIOD);var c=!0,d=!1,h=void 0;try{for(var f,p=e[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;an.applyRestrictions(m.variants,this.config_.restrictions,this.maxHwRes_)&&this.streamingEngine_&&this.getPresentationPeriod_()==m&&this.onTracksChanged_(),this.checkRestrictedVariants_(m.variants)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}},{key:"filterNewPeriod_",value:function(e){window.asserts.assert(this.video_,"Must not be destroyed");var t=this.streamingEngine_?this.streamingEngine_.getBufferingAudio():null,n=this.streamingEngine_?this.streamingEngine_.getBufferingVideo():null;an.filterNewPeriod(this.drmEngine_,t,n,e);var r=e.variants;if(!r.some(an.isPlayable))throw new A(ma.severity.CRITICAL,ma.category.MANIFEST,ma.code.UNPLAYABLE_PERIOD);this.checkRestrictedVariants_(e.variants),an.applyRestrictions(r,this.config_.restrictions,this.maxHwRes_)&&this.streamingEngine_&&this.getPresentationPeriod_()==e&&this.onTracksChanged_();var i=this.drmEngine_?this.drmEngine_.getDrmInfo():null;if(i){var a=!0,s=!1,o=void 0;try{for(var u,l=r[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=!0,h=!1,f=void 0;try{for(var p,m=c.drmInfos[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v.keySystem==i.keySystem){var y=!0,g=!1,_=void 0;try{for(var b,w=(v.initData||[])[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var E=b.value;this.drmEngine_.newInitData(E.initDataType,E.initData)}}catch(e){g=!0,_=e}finally{try{y||null==w.return||w.return()}finally{if(g)throw _}}}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}}}},{key:"switchVariant_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.switchingPeriods_?(this.deferredVariant_=e,this.deferredVariantClearBuffer_=t,this.deferredVariantClearBufferSafeMargin_=n):(this.streamingEngine_.switchVariant(e,t,n),this.onVariantChanged_())}},{key:"switchTextStream_",value:function(e){this.switchingPeriods_?this.deferredTextStream_=e:(this.streamingEngine_.switchTextStream(e),this.onTextChanged_())}},{key:"assertCorrectActiveStreams_",value:function(){if(this.streamingEngine_&&this.manifest_&&ya.DEBUG){var e=this.streamingEngine_.getBufferingPeriod(),t=this.getPresentationPeriod_();if(null!=e&&e==t){var n=this.streamingEngine_.getBufferingAudio(),r=this.streamingEngine_.getBufferingVideo(),i=this.streamingEngine_.getBufferingText(),a=this.deferredVariant_?this.deferredVariant_.audio:n,s=this.deferredVariant_?this.deferredVariant_.video:r,o=this.deferredTextStream_||i,u=this.activeStreams_.getVariant(t),l=this.activeStreams_.getText(t);window.asserts.assert(u.audio==a,"Inconsistent active audio stream"),window.asserts.assert(u.video==s,"Inconsistent active video stream"),window.asserts.assert(null==o||l==o,"Inconsistent active text stream")}}}},{key:"adjustStartTime_",value:function(e){var t=this.streamingEngine_.getBufferingAudio(),n=this.streamingEngine_.getBufferingVideo(),r=this.getPresentationPeriod_();function i(e,t){if(!e)return null;var n=e.findSegmentPosition(t-r.startTime);if(null==n)return null;var i=e.getSegmentReference(n);if(!i)return null;var a=i.startTime+r.startTime;return window.asserts.assert(a<=t,"Segment should start before time"),a}var a=i(t,e),s=i(n,e);return null!=s&&null!=a?Math.max(s,a):null!=s?s:null!=a?a:e}},{key:"updateBufferState_",value:function(){var e=this.isBuffering();this.stats_&&this.bufferObserver_&&this.playhead_&&(this.playRateController_.setBuffering(e),this.updateStateHistory_());var t=new D("buffering",{buffering:e});this.dispatchEvent(t)}},{key:"onChangePeriod_",value:function(){this.onTracksChanged_()}},{key:"onRateChange_",value:function(){var e=this.video_.playbackRate;0!=e&&this.playRateController_.set(e)}},{key:"updateStateHistory_",value:function(){if(this.stats_&&this.bufferObserver_){var e=jr.State,t=this.stats_.getStateHistory();this.bufferObserver_.getState()==e.STARVING?t.update("buffering"):this.video_.paused?t.update("paused"):this.video_.ended?t.update("ended"):t.update("playing")}}},{key:"onSeek_",value:function(){this.playheadObservers_&&this.playheadObservers_.notifyOfSeek(),this.streamingEngine_&&this.streamingEngine_.seeked()}},{key:"chooseVariant_",value:function(e){window.asserts.assert(this.config_,"Must not be destroyed");try{this.checkRestrictedVariants_(e)}catch(e){return this.onError_(e),null}window.asserts.assert(e.length,"Should have thrown for no Variants.");var t=e.filter(function(e){return an.isPlayable(e)}),n=this.currentAdaptationSetCriteria_.create(t);return this.abrManager_.setVariants(Array.from(n.values())),this.abrManager_.chooseVariant()}},{key:"chooseTextStream_",value:function(e){return an.filterStreamsByLanguageAndRole(e,this.currentTextLanguage_,this.currentTextRole_)[0]||null}},{key:"chooseStreamsAndSwitch_",value:function(e){window.asserts.assert(this.config_,"Must not be destroyed");var t=this.chooseVariant_(e.variants);t&&(this.addVariantToSwitchHistory_(e,t,!0),this.switchVariant_(t,!0));var n=this.chooseTextStream_(e.textStreams);n&&this.shouldStreamText_()&&(this.addTextStreamToSwitchHistory_(e,n,!0),this.switchTextStream_(n)),this.onAdaptation_()}},{key:"onChooseStreams_",value:function(e){va.log.debug("onChooseStreams_",e),window.asserts.assert(this.config_,"Must not be destroyed");try{va.log.v2("onChooseStreams_, choosing variant from ",e.variants),va.log.v2("onChooseStreams_, choosing text from ",e.textStreams);var t=this.chooseStreams_(e);return va.log.v2("onChooseStreams_, chose variant ",t.variant),va.log.v2("onChooseStreams_, chose text ",t.text),t}catch(e){return this.onError_(e),{variant:null,text:null}}}},{key:"chooseStreams_",value:function(e){this.switchingPeriods_=!0,this.abrManager_.disable(),this.onAbrStatusChanged_(),va.log.debug("Choosing new streams after period changed");var t=this.chooseVariant_(e.variants),n=this.chooseTextStream_(e.textStreams);this.deferredVariant_&&(e.variants.includes(this.deferredVariant_)&&(t=this.deferredVariant_),this.deferredVariant_=null),this.deferredTextStream_&&(e.textStreams.includes(this.deferredTextStream_)&&(n=this.deferredTextStream_),this.deferredTextStream_=null),t&&this.addVariantToSwitchHistory_(e,t,!0),n&&this.addTextStreamToSwitchHistory_(e,n,!0);var r=!this.streamingEngine_.getBufferingPeriod(),i=t?t.audio:null;return r&&n&&(i&&this.shouldShowText_(i,n)&&(this.isTextVisible_=!0),this.isTextVisible_&&(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(!0),window.asserts.assert(this.shouldStreamText_(),"Should be streaming text")),this.onTextTrackVisibility_()),this.shouldStreamText_()?{variant:t,text:n}:{variant:t,text:null}}},{key:"shouldShowText_",value:function(e,t){var n=ne.normalize(this.config_.preferredTextLanguage),r=ne.normalize(e.language),i=ne.normalize(t.language);return ne.areLanguageCompatible(i,n)&&!ne.areLanguageCompatible(r,i)}},{key:"canSwitch_",value:function(){va.log.debug("canSwitch_"),window.asserts.assert(this.config_,"Must not be destroyed"),this.switchingPeriods_=!1,this.config_.abr.enabled&&(this.abrManager_.enable(),this.onAbrStatusChanged_()),this.deferredVariant_&&(this.streamingEngine_.switchVariant(this.deferredVariant_,this.deferredVariantClearBuffer_,this.deferredVariantClearBufferSafeMargin_),this.onVariantChanged_(),this.deferredVariant_=null),this.deferredTextStream_&&(this.streamingEngine_.switchTextStream(this.deferredTextStream_),this.onTextChanged_(),this.deferredTextStream_=null)}},{key:"onManifestUpdate_",value:function(){this.parser_&&this.parser_.update&&this.parser_.update()}},{key:"onSegmentAppended_",value:function(){this.playhead_&&this.playhead_.notifyOfBufferingChange()}},{key:"switch_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;va.log.debug("switch_"),window.asserts.assert(this.config_.abr.enabled,"AbrManager should not call switch while disabled!"),window.asserts.assert(!this.switchingPeriods_,"AbrManager should not call switch while transitioning between Periods!"),window.asserts.assert(this.manifest_,"We need a manifest to switch variants.");var r=this.findPeriodWithVariant_(e);window.asserts.assert(r,"A period should contain the variant."),this.addVariantToSwitchHistory_(r,e,!0),this.streamingEngine_&&(this.streamingEngine_.switchVariant(e,t,n),this.onAdaptation_())}},{key:"onAdaptation_",value:function(){this.delayDispatchEvent_(new D("adaptation"))}},{key:"onTracksChanged_",value:function(){this.delayDispatchEvent_(new D("trackschanged"))}},{key:"onVariantChanged_",value:function(){this.delayDispatchEvent_(new D("variantchanged"))}},{key:"onTextChanged_",value:function(){this.delayDispatchEvent_(new D("textchanged"))}},{key:"onTextTrackVisibility_",value:function(){this.delayDispatchEvent_(new D("texttrackvisibility"))}},{key:"onAbrStatusChanged_",value:function(){this.delayDispatchEvent_(new D("abrstatuschanged",{newStatus:this.config_.abr.enabled}))}},{key:"onError_",value:function(e){if(window.asserts.assert(e instanceof A,"Wrong error type!"),this.loadMode_!=t.LoadMode.DESTROYED){var n=new D("error",{detail:e});this.dispatchEvent(n),n.defaultPrevented&&(e.handled=!0)}}},{key:"onRegionEvent_",value:function(e,t){var n={schemeIdUri:t.schemeIdUri,value:t.value,startTime:t.startTime,endTime:t.endTime,id:t.id,eventElement:t.eventElement};this.dispatchEvent(new D(e,{detail:n}))}},{key:"videoErrorToShakaError_",value:function(){if(window.asserts.assert(this.video_.error,"Video error expected, but missing!"),!this.video_.error)return null;var e=this.video_.error.code;if(1==e)return null;var t=this.video_.error.msExtendedCode;t&&(t<0&&(t+=Math.pow(2,32)),t=t.toString(16));var n=this.video_.error.message;return new A(ma.severity.CRITICAL,ma.category.MEDIA,ma.code.VIDEO_ERROR,e,t,n)}},{key:"onVideoError_",value:function(e){var t=this.videoErrorToShakaError_();t&&this.onError_(t)}},{key:"onKeyStatus_",value:function(e){if(this.streamingEngine_){var n=t.restrictedStatuses_,r=this.getPresentationPeriod_(),i=!1,a=Object.keys(e);0==a.length&&va.log.warning("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var s=1==a.length&&"00"==a[0];if(s&&va.log.warning("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),a.length){var o=!0,u=!1,l=void 0;try{for(var c,d=r.variants[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=an.getVariantStreams(h),p=!0,m=!1,v=void 0;try{for(var y,g=f[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value,b=h.allowedByKeySystem;if(_.keyId){var w=e[s?"00":_.keyId];h.allowedByKeySystem=!!w&&!n.includes(w)}b!=h.allowedByKeySystem&&(i=!0)}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}var E=this.streamingEngine_.getBufferingAudio(),S=this.streamingEngine_.getBufferingVideo(),T=an.getVariantByStreams(E,S,r.variants);T&&!T.allowedByKeySystem&&(va.log.debug("Choosing new streams after key status changed"),this.chooseStreamsAndSwitch_(r)),i&&(this.onTracksChanged_(),this.chooseVariant_(r.variants))}}},{key:"onExpirationUpdated_",value:function(e,t){this.parser_&&this.parser_.onExpirationUpdated&&this.parser_.onExpirationUpdated(e,t);var n=new D("expirationupdated");this.dispatchEvent(n)}},{key:"shouldStreamText_",value:function(){return this.config_.streaming.alwaysStreamText||this.isTextTrackVisible()}},{key:"checkRestrictedVariants_",value:function(e){var n=t.restrictedStatuses_,r=this.drmEngine_?this.drmEngine_.getKeyStatuses():{},i=Object.keys(r),a=i.length&&"00"==i[0],s=!1,o=!1,u=[],l=[],c=!0,d=!1,h=void 0;try{for(var f,p=e[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=[];m.audio&&v.push(m.audio),m.video&&v.push(m.video);for(var y=0,g=v;y<g.length;y++){var _=g[y];if(_.keyId){var b=r[a?"00":_.keyId];b?n.includes(b)&&(l.includes(b)||l.push(b)):u.includes(_.keyId)||u.push(_.keyId)}}m.allowedByApplication?m.allowedByKeySystem&&(s=!0):o=!0}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}if(!s){var w={hasAppRestrictions:o,missingKeys:u,restrictedKeyStatuses:l};throw new A(ma.severity.CRITICAL,ma.category.MANIFEST,ma.code.RESTRICTIONS_CANNOT_BE_MET,w)}}},{key:"delayDispatchEvent_",value:function(){var e=oa(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:this.loadMode_!=t.LoadMode.DESTROYED&&this.dispatchEvent(n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectableVariants_",value:function(){var e=this.getPresentationPeriod_();return null==e?[]:(this.assertCorrectActiveStreams_(),e.variants.filter(function(e){return an.isPlayable(e)}))}},{key:"getSelectableText_",value:function(){var e=this,t=this.getPresentationPeriod_();return null==t?[]:(this.assertCorrectActiveStreams_(),t.textStreams.filter(function(t){return!e.loadingTextStreams_.has(t)}))}},{key:"getPresentationPeriod_",value:function(){window.asserts.assert(this.manifest_&&this.playhead_,"Only ask for the presentation period when loaded with media source.");var e=this.playhead_.getTime(),t=null,n=!0,r=!1,i=void 0;try{for(var a,s=this.manifest_.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.startTime<=e&&(t=o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return window.asserts.assert(t,"Should have found a period."),t}},{key:"getPresentationVariant_",value:function(){var e=this.getPresentationPeriod_();return this.activeStreams_.getVariant(e)}},{key:"getPresentationText_",value:function(){var e=this.getPresentationPeriod_();if(null==e)return null;if(!this.activeStreams_.getText(e)){var t=an.filterStreamsByLanguageAndRole(e.textStreams,this.currentTextLanguage_,this.currentTextRole_);t.length&&this.activeStreams_.useText(e,t[0])}return this.activeStreams_.getText(e)}},{key:"isBufferedToEndMS_",value:function(){if(window.asserts.assert(this.video_,"We need a video element to get buffering information"),window.asserts.assert(this.mediaSourceEngine_,"We need a media source engine to get buffering information"),window.asserts.assert(this.manifest_,"We need a manifest to get buffering information"),this.video_.ended)return!0;if(this.mediaSourceEngine_.ended())return!0;if(this.manifest_.presentationTimeline.isLive()){var e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd();if(Mt.bufferEnd(this.video_.buffered)>=e)return!0}return!1}},{key:"isBufferedToEndSrc_",value:function(){if(window.asserts.assert(this.video_,"We need a video element to get buffering information"),this.video_.ended)return!0;return Mt.bufferEnd(this.video_.buffered)>=this.video_.duration-.1}},{key:"findPeriodWithVariant_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.manifest_.periods[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;if(s.variants.includes(e))return s}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"createAbortLoadError_",value:function(){return new A(ma.severity.CRITICAL,ma.category.PLAYER,ma.code.LOAD_INTERRUPTED)}},{key:"getNextStep_",value:function(e,t,n,r){var i=null;return e==this.detachNode_&&(i=n==this.detachNode_?this.detachNode_:this.attachNode_),e==this.attachNode_&&(i=this.getNextAfterAttach_(n,t,r)),e==this.mediaSourceNode_&&(i=this.getNextAfterMediaSource_(n,t,r)),e==this.parserNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.manifestNode_,this.unloadNode_,n,t,r)),e==this.manifestNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.drmNode_,this.unloadNode_,n,t,r)),e==this.drmNode_&&(i=this.getNextMatchingAllDependencies_(this.loadNode_,this.loadNode_,this.unloadNode_,n,t,r)),e==this.srcEqualsDrmNode_&&(i=n==this.srcEqualsNode_&&t.mediaElement==r.mediaElement?this.srcEqualsNode_:this.unloadNode_),e!=this.loadNode_&&e!=this.srcEqualsNode_||(i=this.unloadNode_),e==this.unloadNode_&&(i=this.getNextAfterUnload_(n,t,r)),window.asserts.assert(i,"Missing next step!"),i}},{key:"getNextAfterAttach_",value:function(e,t,n){return e==this.detachNode_?this.detachNode_:t.mediaElement!=n.mediaElement?this.detachNode_:e==this.attachNode_?this.attachNode_:e==this.mediaSourceNode_||e==this.loadNode_?this.mediaSourceNode_:e==this.srcEqualsNode_?this.srcEqualsDrmNode_:null}},{key:"getNextAfterMediaSource_",value:function(e,t,n){return e==this.loadNode_&&t.mediaElement==n.mediaElement?this.parserNode_:this.unloadNode_}},{key:"getNextAfterUnload_",value:function(e,t,n){return n.mediaElement&&t.mediaElement==n.mediaElement?this.attachNode_:this.detachNode_}},{key:"getNextMatchingAllDependencies_",value:function(e,t,n,r,i,a){return r==e&&i.mediaElement==a.mediaElement&&i.uri==a.uri&&i.mimeType==a.mimeType&&i.factory==a.factory?t:n}},{key:"wrapWalkerListenersWithPromise_",value:function(e){var t=this;return new Promise(function(n,r){e.onCancel=function(){return r(t.createAbortLoadError_())},e.onEnd=function(){return n()},e.onError=function(e){return r(e)},e.onSkip=function(){return r(t.createAbortLoadError_())}})}}],i=[{key:"registerSupportPlugin",value:function(e,n){t.supportPlugins_[e]=n}},{key:"isBrowserSupported",value:function(){return!!(window.Promise&&window.Uint8Array&&Array.prototype.forEach)&&(!!Tt.isBrowserSupported()&&(!!lt.supportsMediaSource()||lt.supportsMediaType("application/x-mpegurl")))}},{key:"probeSupport",value:function(){var e=oa(regeneratorRuntime.mark(function e(){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(t.isBrowserSupported(),"Must have basic support"),e.next=3,Tt.probeSupport();case 3:for(o in n=e.sent,r=Tn.probeSupport(),i=Jt.probeSupport(),a={manifest:r,media:i,drm:n},s=t.supportPlugins_)a[o]=s[o]();return e.abrupt("return",a);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"filterForAVVariants_",value:function(e){var t=function(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")};if(e.some(function(e){return e.variants.some(t)})){va.log.debug("Found variant with audio and video content, so filtering out audio-only content in all periods.");var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.variants=o.variants.filter(t)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}},{key:"applyPlayRange_",value:function(e,t,n){t>0&&(e.isLive()?va.log.warning("|playRangeStart| has been configured for live content. Ignoring the setting."):e.setUserSeekStart(t)),n<e.getDuration()&&(e.isLive()?va.log.warning("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.setDuration(n))}},{key:"getLanguagesFrom_",value:function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;o.language?t.add(ne.normalize(o.language)):t.add("und")}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"getLanguageAndRolesFrom_",value:function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u="und",l=[];o.language&&(u=ne.normalize(o.language)),(l="variant"==o.type?o.audioRoles:o.roles)&&l.length||(l=[""]),t.has(u)||t.set(u,new Set);var c=!0,d=!1,h=void 0;try{for(var f,p=l[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;t.get(u).add(m)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var v=[];return t.forEach(function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;v.push({language:t,role:o})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}),v}},{key:"createEmptyPayload_",value:function(){return{factory:null,mediaElement:null,mimeType:null,startTime:null,startTimeOfLoad:null,uri:null}}}],r&&ua(n.prototype,r),i&&ua(n,i),t}();function _a(e){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ba(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function wa(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ba(a,r,i,s,o,"next",e)}function o(e){ba(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ga.LoadMode={DESTROYED:0,NOT_LOADED:1,MEDIA_SOURCE:2,SRC_EQUALS:3},ga.TYPICAL_BUFFERING_THRESHOLD_=.5,ga.version="v2.5.2-master-uncompiled",ia.init(ga.version),ga.restrictedStatuses_=["output-restricted","internal-error"],ga.supportPlugins_={};
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Sa=c.net.NetworkingEngine,Ta=c.util.ConfigUtils,ka=window.shaka,Ca=(window.goog,function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.constructor!=ga)throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);this.config_=null,this.networkingEngine_=null,t?(this.config_=t.getSharedConfiguration(),this.networkingEngine_=t.getNetworkingEngine(),window.asserts.assert(this.networkingEngine_,"Storage should not be initialized with a player that had |destroy| called on it.")):(this.config_=vn.createDefault(),this.networkingEngine_=new Sa),this.storeInProgress_=!1,this.segmentsFromStore_=[],this.openOperations_=[];var r=!t;this.destroyer_=new tt(wa(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){},e.next=3,Promise.all(n.openOperations_.map(function(e){return e.then(t,t)}));case 3:if(!r){e.next=6;break}return e.next=6,n.networkingEngine_.destroy();case 6:n.config_=null,n.networkingEngine_=null;case 8:case"end":return e.stop()}},e)})))}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.destroyer_.destroy()}},{key:"configure",value:function(t,n){return window.asserts.assert("object"==_a(t)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof t&&(t=Ta.convertToConfigObject(t,n)),window.asserts.assert("object"==_a(t),"Should be an object!"),e.verifyConfig_(t),window.asserts.assert(this.config_,"Cannot reconfigure stroage after calling destroy."),vn.mergeConfigObjects(this.config_,t)}},{key:"getConfiguration",value:function(){window.asserts.assert(this.config_,"Config must not be null!");var e=vn.createDefault();return vn.mergeConfigObjects(e,this.config_,vn.createDefault()),e}},{key:"getNetworkingEngine",value:function(){return this.networkingEngine_}},{key:"store",value:function(e,t,n){var r=this,i=function(){var t=wa(regeneratorRuntime.mark(function t(){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||"string"==typeof n){t.next=4;break}return ka.Deprecate.deprecateFeature(2,6,"Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=n,t.abrupt("return",new i);case 4:return window.asserts.assert(r.networkingEngine_,"Should not call |store| after |destroy|"),t.next=7,Tn.create(e,r.networkingEngine_,r.config_.manifest.retryParameters,n);case 7:return a=t.sent,t.abrupt("return",a);case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return this.startOperation_(this.store_(e,t||{},i))}},{key:"getStoreInProgress",value:function(){return this.storeInProgress_}},{key:"store_",value:function(){var e=wa(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,u,l,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requireSupport_(),!this.storeInProgress_){e.next=3;break}throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.STORE_ALREADY_IN_PROGRESS);case 3:return this.storeInProgress_=!0,e.next=6,this.parseManifest(t,r);case 6:if(i=e.sent,this.ensureNotDestroyed_(),!i.presentationTimeline.isLive()&&!i.presentationTimeline.isInProgress()){e.next=11;break}throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.CANNOT_STORE_LIVE_OFFLINE,t);case 11:return a=null,s=new Xn,o=null,u=null,e.prev=15,e.next=18,this.createDrmEngine(i,function(e){u=u||e});case 18:if(a=e.sent,this.ensureNotDestroyed_(),!u){e.next=22;break}throw u;case 22:return this.filterManifest_(i,a),e.next=25,s.init();case 25:return this.ensureNotDestroyed_(),e.next=28,s.getActive();case 28:return o=e.sent,this.ensureNotDestroyed_(),window.asserts.assert(a,"drmEngine should be non-null here."),e.next=33,this.downloadManifest_(o.cell,a,i,t,n);case 33:if(l=e.sent,this.ensureNotDestroyed_(),!u){e.next=37;break}throw u;case 37:return e.next=39,o.cell.addManifests([l]);case 39:return c=e.sent,this.ensureNotDestroyed_(),d=Pn.manifest(o.path.mechanism,o.path.cell,c[0]),e.abrupt("return",hr.fromManifestDB(d,l));case 45:if(e.prev=45,e.t0=e.catch(15),!o){e.next=50;break}return e.next=50,o.cell.removeSegments(this.segmentsFromStore_,function(){});case 50:throw u||e.t0;case 51:return e.prev=51,this.storeInProgress_=!1,this.segmentsFromStore_=[],e.next=56,s.destroy();case 56:if(!a){e.next=59;break}return e.next=59,a.destroy();case 59:return e.finish(51);case 60:case"end":return e.stop()}},e,this,[[15,45,51,60]])}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"filterManifest_",value:function(t,n){var r=this,i={width:1/0,height:1/0};wr.filterByRestrictions(t,this.config_.restrictions,i),wr.filterByMediaSourceSupport(t),wr.filterByDrmSupport(t,n),wr.filterByCommonCodecs(t),wr.rollingFilter(t,function(e){var t=an,n=[],i=!0,a=!1,s=void 0;try{for(var o,u=e.variants[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;window.asserts.assert(t.isPlayable(l),'We should have already filtered by "is playable"'),n.push(t.variantToTrack(l))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var c=!0,d=!1,h=void 0;try{for(var f,p=e.textStreams[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;n.push(t.textStreamToTrack(m))}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var v=r.config_.offline.trackSelectionCallback(n),y=new Set,g=new Set,_=!0,b=!1,w=void 0;try{for(var E,S=v[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var T=E.value;"variant"==T.type&&y.add(T.id),"text"==T.type&&g.add(T.id)}}catch(e){b=!0,w=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw w}}e.variants=e.variants.filter(function(e){return y.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return g.has(e.id)})}),e.validateManifest_(t)}},{key:"downloadManifest_",value:function(){var e=wa(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,u,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot call |downloadManifest_| after calling |destroy|."),s=hr.fromManifest(i,r,0,a),o=new Rn(this.networkingEngine_,function(e,t){s.size=t,l.config_.offline.progressCallback(s,e)}),e.prev=3,u=this.createOfflineManifest_(o,t,n,r,i,a),e.next=7,o.waitToFinish();case 7:return u.size=e.sent,e.abrupt("return",u);case 9:return e.prev=9,e.next=12,o.destroy();case 12:return e.finish(9);case 13:case"end":return e.stop()}},e,this,[[3,,9,13]])}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"remove",value:function(e){return this.startOperation_(this.remove_(e))}},{key:"remove_",value:function(){var e=wa(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requireSupport_(),null!=(n=Pn.parse(t))&&n.isManifest()){e.next=4;break}throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.MALFORMED_OFFLINE_URI,t);case 4:return r=n,i=new Xn,e.prev=6,e.next=9,i.init();case 9:return e.next=11,i.getCell(r.mechanism(),r.cell());case 11:return a=e.sent,e.next=14,a.getManifests([r.key()]);case 14:return s=e.sent,o=s[0],e.next=18,Promise.all([this.removeFromDRM_(r,o,i),this.removeFromStorage_(a,r,o)]);case 18:return e.prev=18,e.next=21,i.destroy();case 21:return e.finish(18);case 22:case"end":return e.stop()}},e,this,[[6,,18,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"removeFromDRM_",value:function(){var t=wa(regeneratorRuntime.mark(function t(n,r,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot be destroyed"),t.next=3,e.deleteLicenseFor_(this.networkingEngine_,this.config_.drm,i,r);case 3:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"removeFromStorage_",value:function(t,n,r){var i=this,a=e.getAllSegmentIds_(r),s=a.length+1,o=0,u=hr.fromManifestDB(n,r),l=function(e){o+=1,i.config_.offline.progressCallback(u,o/s)};return Promise.all([t.removeSegments(a,l),t.removeManifests([n.key()],l)])}},{key:"removeEmeSessions",value:function(){return this.startOperation_(this.removeEmeSessions_())}},{key:"removeEmeSessions_",value:function(){var e=wa(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o,u,l,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.requireSupport_(),window.asserts.assert(this.networkingEngine_,"Cannot be destroyed"),t=this.networkingEngine_,n=this.config_.drm,r=new Xn,i=new Gn,a=!1,e.prev=7,e.next=10,r.init();case 10:s=[],r.forEachEmeSessionCell(function(e){return s.push(e)}),o=0,u=s;case 13:if(!(o<u.length)){e.next=27;break}return l=u[o],e.next=17,l.getAll();case 17:return c=e.sent,e.next=20,i.delete(n,t,c);case 20:return d=e.sent,e.next=23,l.remove(d);case 23:d.length!=c.length&&(a=!0);case 24:o++,e.next=13;break;case 27:return e.prev=27,e.next=30,r.destroy();case 30:return e.finish(27);case 31:return e.abrupt("return",!a);case 32:case"end":return e.stop()}},e,this,[[7,,27,31]])}));return function(){return e.apply(this,arguments)}}()},{key:"list",value:function(){return this.startOperation_(this.list_())}},{key:"list_",value:function(){var e=wa(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.requireSupport_(),t=[],n=new Xn,e.prev=3,e.next=6,n.init();case 6:return r=Promise.resolve(),n.forEachCell(function(e,n){r=r.then(wa(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getAllManifests();case 2:r.sent.forEach(function(n,r){var i=Pn.manifest(e.mechanism,e.cell,r),a=hr.fromManifestDB(i,n);t.push(a)});case 4:case"end":return r.stop()}},r)})))}),e.next=10,r;case 10:return e.prev=10,e.next=13,n.destroy();case 13:return e.finish(10);case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}},e,this,[[3,,10,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"parseManifest",value:function(){var t=wa(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=null,a=this.networkingEngine_,window.asserts.assert(a,"Should be initialized!"),s={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e}},t.next=6,r();case 6:return(o=t.sent).configure(this.config_.manifest),this.ensureNotDestroyed_(),t.prev=9,t.next=12,o.start(n,s);case 12:return u=t.sent,this.ensureNotDestroyed_(),l=e.getStreamSet_(u),t.next=17,Promise.all(Array.from(l).map(function(e){return e.createSegmentIndex()}));case 17:if(this.ensureNotDestroyed_(),!i){t.next=20;break}throw i;case 20:return t.abrupt("return",u);case 21:return t.prev=21,t.next=24,o.stop();case 24:return t.finish(21);case 25:case"end":return t.stop()}},t,this,[[9,,21,25]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"createDrmEngine",value:function(){var e=wa(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.networkingEngine_,"Cannot call |createDrmEngine| after |destroy|"),r=new Tt({netEngine:this.networkingEngine_,onError:n,onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),i=kr.getAllVariantsFrom(t.periods),a=this.config_,r.configure(a.drm),e.next=7,r.initForStorage(i,a.offline.usePersistentLicense);case 7:return e.next=9,r.setServerCertificate();case 9:return e.next=11,r.createOrLoad();case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOfflineManifest_",value:function(e,t,n,r,i,a){var s=this,o=new vr,u=r.periods.map(function(i){return s.createPeriod_(e,t,o,n,r,i)}),l=n.getDrmInfo(),c=n.getSessionIds();if(l&&this.config_.offline.usePersistentLicense){if(!c.length)throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.NO_INIT_DATA_FOR_OFFLINE,i);l.initData=[]}return{originalManifestUri:i,duration:r.presentationTimeline.getDuration(),size:0,expiration:n.getExpiration(),periods:u,sessionIds:this.config_.offline.usePersistentLicense?c:[],drmInfo:l,appMetadata:a}}},{key:"createPeriod_",value:function(t,n,r,i,a,s){var o=!0,u=!1,l=void 0;try{for(var c,d=a.periods[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=!0,p=!1,m=void 0;try{for(var v,y=h.variants[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;r.addVariant(g)}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}var _=!0,b=!1,w=void 0;try{for(var E,S=h.textStreams[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var T=E.value;r.addText(T)}}catch(e){b=!0,w=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw w}}}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}var k=e.getStreamSet_(a),C=new Map,I=!0,A=!1,x=void 0;try{for(var L,N=k[Symbol.iterator]();!(I=(L=N.next()).done);I=!0){var R=L.value,M=this.createStream_(t,n,r,a,s,R);C.set(R.id,M)}}catch(e){A=!0,x=e}finally{try{I||null==N.return||N.return()}finally{if(A)throw x}}var P=!0,O=!1,D=void 0;try{for(var U,F=s.variants[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value;B.audio&&C.get(B.audio.id).variantIds.push(B.id),B.video&&C.get(B.video.id).variantIds.push(B.id)}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}return{startTime:s.startTime,streams:Array.from(C.values())}}},{key:"createStream_",value:function(t,n,r,i,a,s){var o=this,u={id:s.id,originalId:s.originalId,primary:s.primary,presentationTimeOffset:s.presentationTimeOffset||0,contentType:s.type,mimeType:s.mimeType,codecs:s.codecs,frameRate:s.frameRate,kind:s.kind,language:s.language,label:s.label,width:s.width||null,height:s.height||null,initSegmentKey:null,encrypted:s.encrypted,keyId:s.keyId,segments:[],variantIds:[]},l=i.presentationTimeline.getSegmentAvailabilityStart(),c=s.id;e.forEachSegment_(s,l,function(e){var i=Sr.createSegmentRequest(e.getUris(),e.startByte,e.endByte,o.config_.streaming.retryParameters);t.queue(c,i,r.getSegmentEstimate(s.id,e),function(){var t=wa(regeneratorRuntime.mark(function t(r){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.addSegments([{data:r}]);case 2:i=t.sent,o.segmentsFromStore_.push(i[0]),u.segments.push({startTime:e.startTime,endTime:e.endTime,dataKey:i[0]});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())});var d=s.initSegmentReference;if(d){var h=Sr.createSegmentRequest(d.getUris(),d.startByte,d.endByte,this.config_.streaming.retryParameters);t.queue(c,h,r.getInitSegmentEstimate(s.id),function(){var e=wa(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.addSegments([{data:t}]);case 2:r=e.sent,o.segmentsFromStore_.push(r[0]),u.initSegmentKey=r[0];case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}return u}},{key:"ensureNotDestroyed_",value:function(){if(this.destroyer_.destroyed())throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.OPERATION_ABORTED)}},{key:"requireSupport_",value:function(){if(!e.support())throw new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.STORAGE_NOT_SUPPORTED)}},{key:"startOperation_",value:function(){var e=wa(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.openOperations_.push(t),e.prev=1,e.next=4,t;case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,Fn.remove(this.openOperations_,t),e.finish(5);case 8:case"end":return e.stop()}},e,this,[[1,,5,8]])}));return function(t){return e.apply(this,arguments)}}()}],r=[{key:"support",value:function(){return!!lt.supportsMediaSource()&&Xn.support()}},{key:"getCapabilities_",value:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e.periods[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=!0,c=!1,d=void 0;try{for(var h,f=u.streams[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value;t&&"video"==p.contentType?n.push({contentType:st.getFullType(p.mimeType,p.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=p.contentType||n.push({contentType:st.getFullType(p.mimeType,p.codecs),robustness:e.drmInfo.audioRobustness})}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"forEachSegment_",value:function(e,t,n){for(var r=e.findSegmentPosition(t),i=null==r?null:e.getSegmentReference(r);i;)n(i),i=e.getSegmentReference(++r)}},{key:"getAllSegmentIds_",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=!0,l=!1,c=void 0;try{for(var d,h=o.streams[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value;null!=f.initSegmentKey&&t.push(f.initSegmentKey);var p=!0,m=!1,v=void 0;try{for(var y,g=f.segments[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value;t.push(_.dataKey)}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"deleteAll",value:function(){var e=wa(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Xn,e.prev=1,e.next=4,t.erase();case 4:return e.prev=4,e.next=7,t.destroy();case 7:return e.finish(4);case 8:case"end":return e.stop()}},e,null,[[1,,4,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"deleteLicenseFor_",value:function(){var t=wa(regeneratorRuntime.mark(function t(n,r,i,a){var s,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.drmInfo){t.next=2;break}return t.abrupt("return");case 2:return s=i.getEmeSessionCell(),o=a.sessionIds.map(function(t){return{sessionId:t,keySystem:a.drmInfo.keySystem,licenseUri:a.drmInfo.licenseServerUri,serverCertificate:a.drmInfo.serverCertificate,audioCapabilities:e.getCapabilities_(a,!1),videoCapabilities:e.getCapabilities_(a,!0)}}),u=new Gn,t.next=7,u.delete(r,n,o);case 7:return l=t.sent,t.next=10,s.remove(l);case 10:return t.next=12,s.add(o.filter(function(e){return-1==l.indexOf(e.sessionId)}));case 12:case"end":return t.stop()}},t)}));return function(e,n,r,i){return t.apply(this,arguments)}}()},{key:"getStreamSet_",value:function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,s=e.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=!0,l=!1,c=void 0;try{for(var d,h=o.textStreams[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value;t.add(f)}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}var p=!0,m=!1,v=void 0;try{for(var y,g=o.variants[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value;_.audio&&t.add(_.audio),_.video&&t.add(_.video)}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"verifyConfig_",value:function(e){var t=!1;null!=e.trackSelectionCallback&&(t=!0,e.offline=e.offline||{},e.offline.trackSelectionCallback=e.trackSelectionCallback,delete e.trackSelectionCallback),null!=e.progressCallback&&(t=!0,e.offline=e.offline||{},e.offline.progressCallback=e.progressCallback,delete e.progressCallback),null!=e.usePersistentLicense&&(t=!0,e.offline=e.offline||{},e.offline.usePersistentLicense=e.usePersistentLicense,delete e.usePersistentLicense),t&&ka.Deprecate.deprecateFeature(2,6,"Storage.configure with OfflineConfig","Please configure storage with a player configuration.")}},{key:"validateManifest_",value:function(t){if(0==t.periods.length)throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.NO_PERIODS);var n=!0,r=!1,i=void 0;try{for(var a,s=t.periods[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.validatePeriod_(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"validatePeriod_",value:function(e){var t=new Set(e.variants.map(function(e){return e.video})),n=new Set(e.variants.map(function(e){return e.audio})),r=e.textStreams;t.size>1&&ka.log.warning("Multiple video tracks selected to be stored");var i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=!0,d=!1,h=void 0;try{for(var f,p=n[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;l!=m&&l.language==m.language&&ka.log.warning("Similar audio tracks were selected to be stored",l.id,m.id)}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var v=!0,y=!1,g=void 0;try{for(var _,b=r[Symbol.iterator]();!(v=(_=b.next()).done);v=!0){var w=_.value,E=!0,S=!1,T=void 0;try{for(var k,C=r[Symbol.iterator]();!(E=(k=C.next()).done);E=!0){var I=k.value;w!=I&&w.language==I.language&&ka.log.warning("Similar text tracks were selected to be stored",w.id,I.id)}}catch(e){S=!0,T=e}finally{try{E||null==C.return||C.return()}finally{if(S)throw T}}}}catch(e){y=!0,g=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}}}],n&&Ea(t.prototype,n),r&&Ea(t,r),e}());ga.registerSupportPlugin("offline",Ca.support);var Ia=Ca;function Aa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xa=c.util.Dom,La=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isTextVisible_=!1,this.cues_=[],this.video_=t,this.videoContainer_=n,this.textContainer_=xa.createHTMLElement("div"),this.textContainer_.classList.add("shaka-text-container"),this.videoContainer_.appendChild(this.textContainer_);this.captionsTimer_=new ve(function(){r.updateCaptions_()}).tickEvery(.25),this.currentCuesMap_=new Map}var t,n,r;return t=e,(n=[{key:"append",value:function(e){this.cues_=this.cues_.concat(e)}},{key:"destroy",value:function(){this.videoContainer_.removeChild(this.textContainer_),this.textContainer_=null,this.isTextVisible_=!1,this.cues_=[],this.captionsTimer_&&this.captionsTimer_.stop(),this.currentCuesMap_.clear()}},{key:"remove",value:function(e,t){if(!this.textContainer_)return!1;var n=new Set,r=!0,i=!1,a=void 0;try{for(var s,o=this.cues_[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;u.startTime>e&&u.endTime<t&&n.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var l=!0,c=!1,d=void 0;try{for(var h,f=n[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var p=h.value,m=this.currentCuesMap_.get(p);m&&(this.textContainer_.removeChild(m),this.currentCuesMap_.delete(p))}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}return this.cues_=this.cues_.filter(function(e){return!n.has(e)}),!0}},{key:"isTextVisible",value:function(){return this.isTextVisible_}},{key:"setTextVisibility",value:function(e){this.isTextVisible_=e}},{key:"updateCaptions_",value:function(){var e=this,t=this.video_.currentTime,n=function(n){return e.isTextVisible_&&n.startTime<=t&&n.endTime>=t},r=!0,i=!1,a=void 0;try{for(var s,o=this.currentCuesMap_.keys()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;if(!n(u)){var l=this.currentCuesMap_.get(u);this.textContainer_.removeChild(l),this.currentCuesMap_.delete(u)}}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var c=this.cues_.filter(function(t){return n(t)&&!e.currentCuesMap_.has(t)}).sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),d=!0,h=!1,f=void 0;try{for(var p,m=c[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value,y=xa.createHTMLElement("span");this.setCaptionStyles_(y,v),this.currentCuesMap_.set(v,y),this.textContainer_.appendChild(y)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"setCaptionStyles_",value:function(e,t){var n=shaka.text.Cue,r=e.style,i=this.textContainer_.style;if(r.whiteSpace="pre",e.textContent=t.payload,r.backgroundColor=t.backgroundColor,r.color=t.color,r.direction=t.direction,t.backgroundImage&&(r.backgroundImage="url('"+t.backgroundImage+"')",r.backgroundRepeat="no-repeat",r.backgroundSize="contain",r.backgroundPosition="center"),t.backgroundImage&&t.region){var a=shaka.text.CueRegion.units.PERCENTAGE,s=t.region.heightUnits==a?"%":"px",o=t.region.widthUnits==a?"%":"px";r.height=t.region.height+s,r.width=t.region.width+o}t.displayAlign==n.displayAlign.BEFORE?i.alignItems="flex-start":t.displayAlign==n.displayAlign.CENTER?i.alignItems="flex-top":i.alignItems="flex-end",r.fontFamily=t.fontFamily,r.fontWeight=t.fontWeight.toString(),r.fontSize=t.fontSize,r.fontStyle=t.fontStyle,t.line&&t.lineInterpretation==n.lineInterpretation.PERCENTAGE&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?t.lineAlign==n.lineAlign.START?i.top=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.bottom=t.line+"%"):t.writingMode==n.writingMode.VERTICAL_LEFT_TO_RIGHT?t.lineAlign==n.lineAlign.START?i.left=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.right=t.line+"%"):t.lineAlign==n.lineAlign.START?i.right=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.left=t.line+"%")),r.lineHeight=t.lineHeight,t.position&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.paddingLeft=t.position:i.paddingTop=t.position),t.positionAlign==n.positionAlign.LEFT?i.cssFloat="left":t.positionAlign==n.positionAlign.RIGHT?i.cssFloat="right":i.margin="auto",r.textAlign=t.textAlign,r.textDecoration=t.textDecoration.join(" "),r.writingMode=t.writingMode,t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.width=t.size+"%":i.height=t.size+"%"}}])&&Aa(t.prototype,n),r&&Aa(t,r),e}(),Na=n(7);function Ra(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ma(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pa(e,t,n){return t&&Ma(e.prototype,t),n&&Ma(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oa=function(){function e(){Ra(this,e)}return Pa(e,null,[{key:"upgradeDom",value:function(){}}]),e}();function Da(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ua(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Da(a,r,i,s,o,"next",e)}function o(e){Da(a,r,i,s,o,"throw",e)}s(void 0)})}}function Fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Element.prototype.MaterialLayout;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ba=c.util.ConfigUtils,Va=new A,ja=window.shaka,Ha=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video_=null,this.container_=null,this.player_=null,this.selectedAsset=null,this.desiredConfig_,this.defaultConfig_,this.fullyLoaded_=!1,this.controls_=null,this.initialStoredList_,this.nativeControlsEnabled_=!1,this.support_,this.uiLocale_=""}var t,n,r;return t=e,(n=[{key:"initCommon_",value:function(){var e=this;window.addEventListener("error",function(t){t.message.includes("cvox.Api")||e.onError_(t.error)}),document.getElementById("error-display-close-button").addEventListener("click",function(t){return e.closeError_()}),this.setUpVersionString_()}},{key:"initFailed",value:function(){this.initCommon_();var e=Error.Severity.CRITICAL;this.handleError_(e,"Your browser is not supported!","https://github.com/google/shaka-player#platform-and-browser-support-matrix"),Oa.upgradeDom();var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=document.getElementsByClassName("should-disable-on-fail")[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.push(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}t.push(document.getElementsByClassName("mdl-layout__drawer-button"));for(var u=0,l=t;u<l.length;u++){var c=l[u];c.tabIndex=-1,c.classList.add("disabled-by-fail")}}},{key:"init",value:function(){var t=Ua(regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.initCommon_(),t.next=3,ga.probeSupport();case 3:return this.support_=t.sent,this.video_=document.getElementById("video"),this.video_.poster=e.mainPoster_,this.container_=document.getElementsByClassName("video-container")[0],this.setupPlayer_(),this.readHash_(),window.addEventListener("hashchange",function(){return r.hashChanged_()}),t.next=12,this.setupStorage_();case 12:this.dispatchEventWithName_("shaka-main-loaded"),Oa.upgradeDom(),n=this.getLastAssetFromHash_(),this.fullyLoaded_=!0,this.remakeHash(),n&&!this.selectedAsset&&this.loadAsset(n);case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setupPlayer_",value:function(){var e=this,t=this.video_.ui;this.player_=t.getControls().getPlayer(),Ke.registerElement("close",new Ye.Factory);var n=t.getConfiguration();n.controlPanelElements.push("close"),t.configure(n),this.player_.configure("manifest.dash.clockSyncUri","https://shaka-player-demo.appspot.com/time.txt"),this.defaultConfig_=this.player_.getConfiguration(),this.desiredConfig_=this.player_.getConfiguration();var r=navigator.languages||["en-us"];this.configure("preferredAudioLanguage",r[0]),this.configure("preferredTextLanguage",r[0]),this.uiLocale_=r[0];var i=function(t){return e.onErrorEvent_(t)};this.player_.addEventListener("error",i),this.controls_=t.getControls(),this.controls_.addEventListener("error",i),this.controls_.addEventListener("caststatuschanged",function(t){e.onCastStatusChange_(t.newStatus)});var a=this.controls_.getLocalization(),s=ie.UNKNOWN_LOCALES;a.addEventListener(s,function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=t.locales[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.loadUILocale_(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}),this.loadUILocale_(this.uiLocale_);var o=document.getElementById("drawer-close-button");o.addEventListener("click",function(){document.getElementById("main-layout").MaterialLayout.toggleDrawer(),e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.hideNode_(o)});var u=document.querySelector(".mdl-layout__drawer-button");window.asserts.assert(u,"There should be a drawer button."),u.addEventListener("click",function(){e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.showNode_(o)});var l=document.querySelector(".mdl-layout__obfuscator");window.asserts.assert(l,"There should be an obfuscator."),l.addEventListener("click",function(){e.dispatchEventWithName_("shaka-main-drawer-state-change"),e.hideNode_(o)}),this.hideNode_(o)}},{key:"getIsDrawerOpen",value:function(){var e=document.querySelector(".mdl-layout__drawer");return window.asserts.assert(e,"There should be a drawer."),e.classList.contains("is-visible")}},{key:"getIdentifierFromAsset_",value:function(e){return e.name+(e.source==g.Source.CUSTOM?" [CUSTOM]":"")}},{key:"makeStorageInstance_",value:function(){var e=this;if(!Ia.support())return null;var t=new Ia;return t.configure("offline.progressCallback",function(t,n){var r=function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=g.testAssets[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(e.getIdentifierFromAsset_(o)==t)return o}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(shakaDemoCustom){var u=!0,l=!1,c=void 0;try{for(var d,h=shakaDemoCustom.assets()[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value;if(e.getIdentifierFromAsset_(f)==t)return f}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}}return null}(t.appMetadata.identifier);r&&(r.storedProgress=n,e.dispatchEventWithName_("shaka-main-offline-progress"))}),t}},{key:"setupOfflineSupport",value:function(e){var t=this;if(this.initialStoredList_){var n=!0,r=!1,i=void 0;try{for(var a,s=this.initialStoredList_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=o.appMetadata.identifier;this.getIdentifierFromAsset_(e)==u&&(e.storedContent=o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.storeCallback=Ua(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.makeStorageInstance_()){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,t.drmConfiguration_(e,r);case 6:return i={identifier:t.getIdentifierFromAsset_(e),downloaded:new Date},e.storedProgress=0,t.dispatchEventWithName_("shaka-main-offline-progress"),n.next=11,r.store(e.manifestUri,i);case 11:a=n.sent,e.storedContent=a,n.next=19;break;case 15:n.prev=15,n.t0=n.catch(3),t.onError_(n.t0),e.storedContent=null;case 19:r.destroy(),e.storedProgress=1,t.dispatchEventWithName_("shaka-main-offline-progress");case 22:case"end":return n.stop()}},n,null,[[3,15]])})),e.unstoreCallback=Ua(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e==t.selectedAsset&&t.unload(),!e.storedContent||!e.storedContent.offlineUri){n.next=19;break}if(r=t.makeStorageInstance_()){n.next=5;break}return n.abrupt("return");case 5:return n.prev=5,e.storedProgress=0,t.dispatchEventWithName_("shaka-main-offline-progress"),n.next=10,r.remove(e.storedContent.offlineUri);case 10:e.storedContent=null,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),t.onError_(n.t0);case 16:r.destroy(),e.storedProgress=1,t.dispatchEventWithName_("shaka-main-offline-progress");case 19:case"end":return n.stop()}},n,null,[[5,13]])}))}}},{key:"setupStorage_",value:function(){var e=Ua(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.makeStorageInstance_()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.list();case 6:this.initialStoredList_=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0),this.initialStoredList_=null;case 13:return e.prev=13,t.destroy(),e.finish(13);case 16:n=!0,r=!1,i=void 0,e.prev=19,a=g.testAssets[Symbol.iterator]();case 21:if(n=(s=a.next()).done){e.next=29;break}if(o=s.value,!this.getAssetUnsupportedReason(o,!0)){e.next=25;break}return e.abrupt("continue",26);case 25:this.setupOfflineSupport(o);case 26:n=!0,e.next=21;break;case 29:e.next=35;break;case 31:e.prev=31,e.t1=e.catch(19),r=!0,i=e.t1;case 35:e.prev=35,e.prev=36,n||null==a.return||a.return();case 38:if(e.prev=38,!r){e.next=41;break}throw i;case 41:return e.finish(38);case 42:return e.finish(35);case 43:case"end":return e.stop()}},e,this,[[3,9,13,16],[19,31,35,43],[36,,38,42]])}));return function(){return e.apply(this,arguments)}}()},{key:"hashChanged_",value:function(){this.readHash_(),this.dispatchEventWithName_("shaka-main-config-change")}},{key:"getAssetUnsupportedReason",value:function(e,t){var n=this;if(e.source==g.Source.CUSTOM)return null;if(e.disabled)return"This asset is disabled.";if(t&&!e.features.includes(g.Feature.OFFLINE))return"This asset cannot be downloaded.";if(t&&!Ia.support())return"Your browser does not support offline storage.";if(!e.drm.includes(g.KeySystem.CLEAR)){if(!e.drm.some(function(e){return n.support_.drm[e]}))return"Your browser does not support the required key systems.";if(t)if(!e.drm.some(function(e){return n.support_.drm[e]&&n.support_.drm[e].persistentState}))return"Your browser does not support offline licenses for the required key systems."}if(e.features.includes(g.Feature.DASH)&&!this.support_.manifest.mpd)return"Your browser does not support MPEG-DASH manifests.";if(e.features.includes(g.Feature.HLS)&&!this.support_.manifest.m3u8)return"Your browser does not support HLS manifests.";var r=[];return e.features.includes(g.Feature.WEBM)&&r.push("video/webm"),e.features.includes(g.Feature.MP4)&&r.push("video/mp4"),e.features.includes(g.Feature.MP2TS)&&r.push("video/mp2t"),r.some(function(e){return n.support_.media[e]})?null:"Your browser does not support the required video format."}},{key:"setNativeControlsEnabled",value:function(e){this.nativeControlsEnabled_=e,this.remakeHash()}},{key:"getNativeControlsEnabled",value:function(){return this.nativeControlsEnabled_}},{key:"loadUILocale_",value:function(){var e=Ua(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=Na,r=new Map,n)r.set(i,n[i]);this.controls_.getLocalization().insert(t,r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setUILocale",value:function(e){this.uiLocale_=e;var t=[e].concat(navigator.languages);this.controls_.getLocalization().changeLocale(t)}},{key:"getUILocale",value:function(){return this.uiLocale_}},{key:"getLastAssetFromHash_",value:function(){var t=this.getParams_(),n=t.asset;if(n){var r=!0,i=!1,a=void 0;try{for(var s,o=g.testAssets[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;if(u.manifestUri==n)return u}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var l=!0,c=!1,d=void 0;try{for(var h,f=shakaDemoCustom.assets()[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var m=h.value;if(m.manifestUri==n)return m}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}var v=new p("loaded asset","",n,g.Source.UNKNOWN);if("license"in t){var y=e.commonDrmSystems;"drmSystem"in t&&(y=[t.drmSystem]);var _=!0,b=!1,w=void 0;try{for(var E,S=y[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var T=E.value;v.addLicenseServer(T,t.license)}}catch(e){b=!0,w=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw w}}}return"certificate"in t&&v.addCertificateUri(t.certificate),v}return null}},{key:"readHash_",value:function(){var e=this,t=this.getParams_();if(this.player_){var n=this.player_.getConfiguration();_.a.runThroughHashParams(function(n,r){if(n in t){var i=e.getCurrentConfigValue(r),a=t[n];"boolean"==typeof i?a="true"==a:"number"==typeof i&&(a=parseFloat(a)),e.configure(r,a)}},n)}if("lang"in t){var r=t.lang;this.configure("preferredAudioLanguage",r),this.configure("preferredTextLanguage",r),this.setUILocale(r)}"uilang"in t&&this.setUILocale(t.uilang),"noadaptation"in t&&this.configure("abr.enabled",!1),"jumpLargeGaps"in t&&this.configure("streaming.jumpLargeGaps",!0);if("build"in t?t.build:"compiled"in t&&"compiled",this.nativeControlsEnabled_="nativecontrols"in t,!_.a.browserSupportsUncompiledMode()){var i=document.getElementById("uncompiled-link");i.setAttribute("disabled",""),i.removeAttribute("href"),i.title="requires a newer browser"}ja.log&&("vv"in t?ja.log.setLevel(ja.log.Level.V2):"v"in t?ja.log.setLevel(ja.log.Level.V1):"debug"in t?ja.log.setLevel(ja.log.Level.DEBUG):"info"in t&&ja.log.setLevel(ja.log.Level.INFO))}},{key:"getParams_",value:function(){var e=location.search.substr(1);e=e?e.split(";"):[];var t=location.hash.substr(1);t=t?t.split(";"):[];for(var n=e.concat(t),r={},i=0;i<n.length;++i){var a=n[i].split("=");r[a[0]]=a.slice(1).join("=")}return r}},{key:"getValueFromGivenConfig_",value:function(e,t){for(var n=t,r=e;r;){var i=r.split(/\.(.+)/);if(3!=i.length)return n[i[0]];r=i[1],n=n[i[0]]}}},{key:"getCurrentConfigValue",value:function(e){var t=this.desiredConfig_;return this.getValueFromGivenConfig_(e,t)}},{key:"resetConfiguration",value:function(e){this.configure(e,void 0)}},{key:"configure",value:function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ba.convertToConfigObject(e,t));var n=e;vn.mergeConfigObjects(this.desiredConfig_,n,this.defaultConfig_),this.player_.configure(e,t)}},{key:"getConfiguration",value:function(){return this.desiredConfig_}},{key:"requestCertificate_",value:function(){var e=Ua(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=NetworkingEngine.RequestType.APP,i={uris:[t]},e.next=4,n.request(r,i).promise;case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"unload",value:function(){this.selectedAsset=null;var t=document.getElementById("video-bar");this.hideNode_(t),this.video_.poster=e.mainPoster_,this.player_.unload(),this.dispatchEventWithName_("shaka-main-selected-asset-changed"),this.remakeHash()}},{key:"drmConfiguration_",value:function(){var e=Ua(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n?n.getNetworkingEngine():this.player_.getNetworkingEngine(),window.asserts.assert(r,"There should be a net engine."),t.applyFilters(r),i=t.getConfiguration(),n?n.configure(i):(this.player_.configure(this.desiredConfig_),this.player_.configure(i)),a=n?n.getConfiguration():this.player_.getConfiguration(),!t.certificateUri){e.next=32;break}return e.next=9,this.requestCertificate_(t.certificateUri,r);case 9:for(s=e.sent,o=new Uint8Array(s),u=!0,l=!1,c=void 0,e.prev=14,d=t.licenseServers.keys()[Symbol.iterator]();!(u=(h=d.next()).done);u=!0)f=h.value,a.drm.advanced[f]=a.drm.advanced[f]||{},a.drm.advanced[f].serverCertificate=o;e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),l=!0,c=e.t0;case 22:e.prev=22,e.prev=23,u||null==d.return||d.return();case 25:if(e.prev=25,!l){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=51;break;case 32:for(p=!0,m=!1,v=void 0,e.prev=35,y=t.licenseServers.keys()[Symbol.iterator]();!(p=(g=y.next()).done);p=!0)_=g.value,a.drm.advanced[_]&&delete a.drm.advanced[_].serverCertificate;e.next=43;break;case 39:e.prev=39,e.t1=e.catch(35),m=!0,v=e.t1;case 43:e.prev=43,e.prev=44,p||null==y.return||y.return();case 46:if(e.prev=46,!m){e.next=49;break}throw v;case 49:return e.finish(46);case 50:return e.finish(43);case 51:n?n.configure(a):this.player_.configure("drm.advanced",a.drm.advanced),this.remakeHash();case 53:case"end":return e.stop()}},e,this,[[14,18,22,30],[23,,25,29],[35,39,43,51],[44,,46,50]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"showPlayer_",value:function(){var t=document.getElementById("video-bar");this.showNode_(t),this.closeError_(),this.video_.poster=e.mainPoster_,t.scrollIntoView({behavior:"smooth",block:"start"})}},{key:"loadAsset",value:function(){var t=Ua(regeneratorRuntime.mark(function t(n){var r,i,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.selectedAsset=n,this.showPlayer_(),this.dispatchEventWithName_("shaka-main-selected-asset-changed"),t.next=6,this.drmConfiguration_(n);case 6:return this.controls_.getCastProxy().setAppData({asset:n}),this.nativeControlsEnabled_?(this.controls_.setEnabledShakaControls(!1),this.controls_.setEnabledNativeControls(!0)):(this.controls_.setEnabledShakaControls(!0),this.controls_.setEnabledNativeControls(!1)),r=this,i=function(){return r.nativeControlsEnabled_?new Wi(r.video_):new La(r.video_,r.container_)},this.player_.configure("textDisplayFactory",i),a=(n.storedContent?n.storedContent.offlineUri:null)||n.manifestUri,console.log(this.player_,a),t.next=15,this.player_.load(a);case 15:this.player_.isAudioOnly()&&(this.video_.poster=e.audioOnlyPoster_),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),(s=t.t0).code==Va.code.LOAD_INTERRUPTED?console.debug("load() interrupted"):this.onError_(s);case 22:this.remakeHash();case 23:case"end":return t.stop()}},t,this,[[0,18]])}));return function(e){return t.apply(this,arguments)}}()},{key:"remakeHash",value:function(){var t=this;if(this.fullyLoaded_){var n=[];if(this.player_){var r=this.player_.getConfiguration();_.a.runThroughHashParams(function(e,r){var i=t.getCurrentConfigValue(r),a=t.defaultConfig_,s=t.getValueFromGivenConfig_(r,a),o=isNaN(i)&&isNaN(s);i==s||o||n.push(e+"="+i)},r)}if(this.getCurrentConfigValue("abr.enabled")||n.push("noadaptation"),this.getCurrentConfigValue("streaming.jumpLargeGaps")&&n.push("jumpLargeGaps"),n.push("uilang="+this.getUILocale()),this.selectedAsset){var i=g.testAssets.includes(this.selectedAsset);if(n.push("asset="+this.selectedAsset.manifestUri),!i&&this.selectedAsset.licenseServers.size){var a=this.selectedAsset.licenseServers.values().next().value;n.push("license="+a);var s=!0,o=!1,u=void 0;try{for(var l,c=this.selectedAsset.licenseServers.keys()[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;if(!e.commonDrmSystems.includes(d)){n.push("drmSystem="+d);break}}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}}!i&&this.selectedAsset.certificateUri&&n.push("certificate="+this.selectedAsset.certificateUri)}var h=document.getElementById("nav-button-container"),f=!0,p=!1,m=void 0;try{for(var v,y=h.childNodes[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var b=v.value;if(b.nodeType==Node.ELEMENT_NODE&&b.classList.contains("mdl-button--accent")){n.push("panel="+b.textContent);break}}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}if(this.nativeControlsEnabled_&&n.push("nativecontrols"),ja.log&&ja.log.currentLevel!=ja.log.MAX_LOG_LEVEL)switch(ja.log.currentLevel){case ja.log.Level.INFO:n.push("info");break;case ja.log.Level.DEBUG:n.push("debug");break;case ja.log.Level.V2:n.push("vv");break;case ja.log.Level.V1:n.push("v")}this.setNewHashSilent_(n.join(";"))}}},{key:"setNewHashSilent_",value:function(e){var t=document.location.pathname+"#"+e;history.replaceState(null,"",t)}},{key:"getHamburgerMenu",value:function(){return document.getElementById("hamburger-menu-contents")}},{key:"hideNode_",value:function(e){e.classList.add("hidden")}},{key:"showNode_",value:function(e){e.classList.remove("hidden")}},{key:"addNavButton",value:function(e){var t=this,n=document.getElementById("nav-button-container"),r=document.getElementById("contents"),i=document.getElementById("nav-button-"+e),a=this.getParams_(),s=a.panel==encodeURI(i.textContent);s||a.panel||(s=null!=i.getAttribute("defaultselected"));var o=document.createElement("div");this.hideNode_(o),r.appendChild(o);var u=function(){var e=!0,a=!1,s=void 0;try{for(var u,l=n.childNodes[Symbol.iterator]();!(e=(u=l.next()).done);e=!0){var c=u.value;c.nodeType==Node.ELEMENT_NODE&&c.classList.remove("mdl-button--accent")}}catch(e){a=!0,s=e}finally{try{e||null==l.return||l.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=r.childNodes[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;v.nodeType==Node.ELEMENT_NODE&&t.hideNode_(v)}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}i.classList.add("mdl-button--accent"),t.showNode_(o),t.remakeHash(),t.dispatchEventWithName_("shaka-main-page-changed"),o.scrollIntoView({behavior:"smooth",block:"start"})};return i.addEventListener("click",u),s&&Promise.resolve().then(u),o}},{key:"dispatchEventWithName_",value:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,null),document.dispatchEvent(t)}},{key:"setUpVersionString_",value:function(){for(var e=ga.version.split("-"),t=[],n=function(){var n=i[r];e.includes(n)&&(t.push(n),e=e.filter(function(e){return e!=n}))},r=0,i=["debug","uncompiled"];r<i.length;r++)n()}},{key:"closeError_",value:function(){document.getElementById("error-display").classList.add("hidden");var e=document.getElementById("error-display-link");e.href="",e.textContent="",e.severity=null}},{key:"onErrorEvent_",value:function(e){this.onError_(e.detail)}},{key:"onError_",value:function(e){var t=e.severity;null!=t&&null!=e.severity||(t=Va.severity.CRITICAL);var n=e.message||"Error code "+e.code,r="";e.code&&(r="../docs/api/Error.html#value:"+e.code),console.error(e),this.handleError_(t,n,r)}},{key:"handleError_",value:function(e,t,n){var r=document.getElementById("error-display-link");(null==r.severity||e>r.severity)&&(r.href=n,void 0===r.textContent?r.innerText=t:r.textContent=t,r.severity=e,r.href?r.classList.remove("input-disabled"):r.classList.add("input-disabled"),document.getElementById("error-display").classList.remove("hidden"))}},{key:"onCastStatusChange_",value:function(e){e&&!this.selectedAsset&&(this.selectedAsset=p.makeBlankAsset(),this.showPlayer_())}}])&&Fa(t.prototype,n),r&&Fa(t,r),e}();Ha.commonDrmSystems=["com.widevine.alpha","com.microsoft.playready","com.apple.fps.1_0","com.adobe.primetime","org.w3.clearkey"];var Ka=new Ha,Ga=Ka;function Wa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ha.mainPoster_="https://shaka-player-demo.appspot.com/assets/poster.jpg",Ha.audioOnlyPoster_="https://shaka-player-demo.appspot.com/assets/audioOnly.gif",Ha.initWrapper=function(){var e=Ua(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),Ka.onError_(e.t0),console.error(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("shaka-ui-loaded",function(){Ha.initWrapper(function(){return Ka.init()})}),document.addEventListener("shaka-ui-load-failed",function(e){Ha.initWrapper(function(){return Ka.initFailed()})});
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerDialog",value:function(e){}}],(n=null)&&Wa(t.prototype,n),r&&Wa(t,r),e}();function za(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ya(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){za(a,r,i,s,o,"next",e)}function o(e){za(a,r,i,s,o,"throw",e)}s(void 0)})}}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $a=c.util.Dom;window.shaka=window.shaka||{};window.shaka;var Qa=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.card_=document.createElement("div"),this.asset_=n,this.actions_=document.createElement("div"),this.featureIconsContainer_=document.createElement("div"),this.progressBar_=document.createElement("progress"),this.remakeButtonsFn_=i,this.card_.classList.add("mdl-card-wide"),this.card_.classList.add("mdl-card"),this.card_.classList.add("mdl-shadow--2dp"),this.card_.classList.add("asset-card");var a=document.createElement("div");a.classList.add("mdl-card__title"),this.card_.appendChild(a);var s=document.createElement("h2");if(s.classList.add("mdl-card__title-text"),s.textContent=n.shortName||n.name,a.appendChild(s),n.iconUri){var o=document.createElement("picture"),u=document.createElement("source");u.srcset=n.iconUri.replace(/.png$/,".webp"),u.type="image/webp";var l=document.createElement("source");l.srcset=n.iconUri,l.type="image/png";var c=document.createElement("img");c.src=n.iconUri,c.alt="",o.appendChild(u),o.appendChild(l),o.appendChild(c),this.card_.appendChild(o)}if(n.description&&r){var d=document.createElement("div");d.classList.add("mdl-card__supporting-text"),d.textContent=n.description,this.card_.appendChild(d)}this.card_.appendChild(this.featureIconsContainer_),this.addFeatureIcons_(n),this.actions_.classList.add("mdl-card__actions"),this.actions_.classList.add("mdl-card--border"),this.card_.appendChild(this.actions_);var h=document.createElement("div");this.progressBar_.classList.add("hidden"),this.progressBar_.setAttribute("max",1),this.progressBar_.setAttribute("value",n.storedProgress),h.appendChild(this.progressBar_),this.card_.appendChild(h),t.appendChild(this.card_),this.remakeButtons()}var t,n,r;return t=e,(n=[{key:"addFeatureIcon_",value:function(e,t){var n=document.createElement("div");n.classList.add("feature-icon"),n.setAttribute("icon",e),this.featureIconsContainer_.appendChild(n),S.make(n,t)}},{key:"addFeatureIcons_",value:function(e){var t=g.Feature,n=g.KeySystem,r=(new Map).set(t.SUBTITLES,"subtitles").set(t.CAPTIONS,"closed_caption").set(t.LIVE,"live").set(t.TRICK_MODE,"trick_mode").set(t.HIGH_DEFINITION,"high_definition").set(t.ULTRA_HIGH_DEFINITION,"ultra_high_definition").set(t.SURROUND,"surround_sound").set(t.MULTIPLE_LANGUAGES,"multiple_languages").set(t.AUDIO_ONLY,"audio_only"),i=!0,a=!1,s=void 0;try{for(var o,u=e.features[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=r.get(l);c&&this.addFeatureIcon_(c,l)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var p,m=e.drm[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){switch(p.value){case n.WIDEVINE:this.addFeatureIcon_("widevine","Widevine DRM");break;case n.CLEAR_KEY:this.addFeatureIcon_("clear_key","Clear Key DRM");break;case n.PLAYREADY:this.addFeatureIcon_("playready","PlayReady DRM")}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}},{key:"markAsUnsupported",value:function(e){this.card_.classList.add("asset-card-unsupported"),this.makeUnsupportedButton_("Not Available",e)}},{key:"makeUnsupportedButton_",value:function(e,t){var n=this.addButton(e,function(){});if(n.setAttribute("disabled",""),t){var r=document.createElement("div");n.parentElement&&n.parentElement.removeChild(n),r.classList.add("tooltip-attach-point"),r.appendChild(n),this.actions_.appendChild(r),S.make(r,t)}return n}},{key:"selectByAsset",value:function(e){this.card_.classList.remove("selected"),this.asset_==e&&this.card_.classList.add("selected")}},{key:"remakeButtons",value:function(){$a.removeAllChildren(this.actions_),this.remakeButtonsFn_(this)}},{key:"addStoreButton",value:function(){var e=this,t=function(e,t,n){t.classList.add("asset-card-corner-button");var r=document.createElement("i");r.textContent=n,r.classList.add("material-icons"),e.appendChild(r)},n=Ga.getAssetUnsupportedReason(this.asset_,!0);if(!n&&this.asset_.storeCallback)if(this.asset_.isStored()){var r=this.addButton("",function(){e.makeDeleteDialog_(r)});t(r,r,"offline_pin")}else{var i=this.addButton("",Ya(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.disabled=!0,t.next=3,e.asset_.storeCallback();case 3:e.remakeButtons();case 4:case"end":return t.stop()}},t)})));t(i,i,"get_app")}else{var a=this.makeUnsupportedButton_("",n);t(a,a.parentElement||a,"get_app")}}},{key:"makeDeleteDialog_",value:function(e){var t=this,n=this.card_.parentElement;if(n){var r=document.createElement("dialog");r.classList.add("mdl-dialog"),n.appendChild(r),r.showModal||qa.registerDialog(r);var i=document.createElement("h2");i.classList.add("mdl-typography--title"),i.textContent="Delete the offline copy?",r.appendChild(i);var a=document.createElement("div");r.appendChild(a);var s=function(e,t){var n=document.createElement("button");n.textContent=e,n.classList.add("mdl-button"),n.classList.add("mdl-button--colored"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.addEventListener("click",function(){t()}),a.appendChild(n),n.blur()};s("Yes",Ya(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.close(),e.disabled=!0,n.next=4,t.asset_.unstoreCallback();case 4:t.remakeButtons();case 5:case"end":return n.stop()}},n)}))),s("No",function(){r.close()}),r.showModal()}}},{key:"updateProgress",value:function(){if(this.asset_.storedProgress<1){this.progressBar_.classList.remove("hidden");var e=!0,t=!1,n=void 0;try{for(var r,i=this.actions_.childNodes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.disabled=!0}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}else{this.progressBar_.classList.add("hidden");var a=!0,s=!1,o=void 0;try{for(var u,l=this.actions_.childNodes[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.disabled=!1}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}}this.progressBar_.setAttribute("value",this.asset_.storedProgress)}},{key:"addButton",value:function(e,t){var n=document.createElement("button");return n.classList.add("mdl-button"),n.classList.add("mdl-button--colored"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.textContent=e,n.addEventListener("click",function(){n.hasAttribute("disabled")||t()}),this.actions_.appendChild(n),n}}])&&Xa(t.prototype,n),r&&Xa(t,r),e}();function Za(e){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t){return!t||"object"!==Za(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function es(e){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ts(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ns(e,t)}function ns(e,t){return(ns=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function is(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var as=function(){function e(t,n,r,i,a){var s=this;if(rs(this,e),this.container_=document.createElement(r),t.latestElementContainer.appendChild(this.container_),this.input_=document.createElement(n),this.input_.onchange=function(){a(s.input_)},this.input_.id=e.generateNewId_("input"),this.container_.appendChild(this.input_),t.latestTooltip){var o=document.createElement("span");o.textContent=t.latestTooltip,o.classList.add("hidden"),o.id=e.generateNewId_("extra-info"),this.container_.appendChild(o),this.input_.setAttribute("aria-describedby",o.id)}this.extra_=null,i&&(this.extra_=document.createElement(i),this.container_.appendChild(this.extra_))}var t,n,r;return t=e,r=[{key:"generateNewId_",value:function(t){var n=e.lastId_;return e.lastId_+=1,t+"-labeled-"+n}}],(n=[{key:"input",value:function(){return this.input_}},{key:"container",value:function(){return this.container_}},{key:"extra",value:function(){return this.extra_}}])&&is(t.prototype,n),r&&is(t,r),e}();as.lastId_=0;var ss=function(e){function t(e,n,r,i){var a;rs(this,t),(a=Ja(this,es(t).call(this,e,"select","div","label",r))).container_.classList.add("mdl-textfield"),a.container_.classList.add("mdl-js-textfield"),a.container_.classList.add("mdl-textfield--floating-label"),a.input_.classList.add("mdl-textfield__input"),a.extra_.classList.add("mdl-textfield__label"),a.extra_.setAttribute("for",a.input_.id);for(var s=0,o=Object.keys(i);s<o.length;s++){var u=o[s],l=document.createElement("option");l.textContent=i[u],l.value=u,a.input_.appendChild(l)}return a}return ts(t,as),t}(),os=function(e){function t(e,n,r){var i;return rs(this,t),(i=Ja(this,es(t).call(this,e,"input","label","span",r))).input_.type="checkbox",i.container_.classList.add("mdl-switch"),i.container_.classList.add("mdl-js-switch"),i.container_.classList.add("mdl-js-ripple-effect"),i.container_.setAttribute("for",i.input_.id),i.input_.classList.add("mdl-switch__input"),i.extra_.classList.add("mdl-switch__label"),i}return ts(t,as),t}(),us=function(e){function t(e,n,r){var i;return rs(this,t),(i=Ja(this,es(t).call(this,e,"input","div","label",r))).container_.classList.add("mdl-textfield"),i.container_.classList.add("mdl-js-textfield"),i.container_.classList.add("mdl-textfield--floating-label"),i.input_.classList.add("mdl-textfield__input"),i.extra_.classList.add("mdl-textfield__label"),i.extra_.setAttribute("for",i.input_.id),i}return ts(t,as),t}(),ls=function(e){function t(e,n,r,i){var a;rs(this,t),a=Ja(this,es(t).call(this,e,n,r));try{var o=new s.a(a.input_);o.list=i.slice(),o.minChars=0,a.input_.addEventListener("focus",function(){o.evaluate()})}catch(e){console.log({Awesomplete:s.a})}return a}return ts(t,us),t}(),cs=function(e){function t(e,n,r,i,a,s){var o;rs(this,t),o=Ja(this,es(t).call(this,e,n,r));var u=document.createElement("span");return u.classList.add("mdl-textfield__error"),o.container_.appendChild(u),u.textContent="Must be a positive",o.input_.pattern="(Infinity|",a?o.input_.pattern+="[0-9]*":(o.input_.pattern+="[0-9]*[1-9][0-9]*",u.textContent+=", nonzero"),i?(o.input_.pattern+="(.[0-9]+)?",u.textContent+=" number."):u.textContent+=" integer.",o.input_.pattern+=")",s&&(o.input_.pattern+="?"),o}return ts(t,us),t}();function ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hs=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.style_=r,this.header_,this.table_=document.createElement("div"),this.latestRow_,this.latestElementContainer,this.latestTooltip,this.numRows_=0,n&&this.createHeader_(t,n),this.table_.classList.add(r),r==e.Style.ACCORDION&&this.table_.classList.add("hidden"),t.appendChild(this.table_),i&&this.addDocLink_(this.table_,i)}var t,n,r;return t=e,(n=[{key:"getIsOpen",value:function(){return this.style_==e.Style.ACCORDION&&this.table_.classList.contains("show")}},{key:"open",value:function(){var t=this;!this.style_!=e.Style.ACCORDION&&(this.table_.classList.remove("hidden"),setTimeout(function(){t.table_.classList.add("show")},20),this.header_.classList.add("mdl-button--colored"))}},{key:"close",value:function(){var t=this;this.style_==e.Style.ACCORDION&&(this.table_.classList.remove("show"),this.table_.addEventListener("transitionend",function(e){t.table_.classList.add("hidden")},{once:!0}),this.header_.classList.remove("mdl-button--colored"))}},{key:"createHeader_",value:function(t,n){var r=this;this.style_==e.Style.ACCORDION?(this.header_=document.createElement("button"),this.header_.classList.add("mdl-button--raised"),this.header_.classList.add("mdl-button"),this.header_.classList.add("mdl-js-button"),this.header_.classList.add("mdl-js-ripple-effect"),this.header_.addEventListener("click",function(){r.getIsOpen()?r.close():r.open()})):this.header_=document.createElement("h3"),this.header_.textContent=n,t.appendChild(this.header_)}},{key:"addDocLink_",value:function(e,t){var n=document.createElement("a");n.href=t,n.target="_blank",n.classList.add("mdl-button"),n.classList.add("mdl-js-button"),n.classList.add("mdl-js-ripple-effect"),n.classList.add("mdl-button--colored");var r=document.createElement("i");r.classList.add("material-icons"),r.textContent="help",n.appendChild(r),e.appendChild(n)}},{key:"addRow",value:function(e,t,n){this.latestRow_=document.createElement("div"),n&&this.latestRow_.classList.add(n),this.table_.appendChild(this.latestRow_);var r="input-container-row-"+this.numRows_;if(this.numRows_+=1,e){var i=document.createElement("label");i.setAttribute("for",r),i.classList.add("input-container-label");var a=document.createElement("b");a.textContent=e,i.appendChild(a),this.latestRow_.appendChild(i)}this.latestElementContainer=document.createElement("div"),this.latestRow_.appendChild(this.latestElementContainer),this.latestElementContainer.classList.add("input-container-row"),this.latestElementContainer.id=r,this.latestTooltip=t,t&&(S.make(this.latestRow_,t),this.latestRow_.setAttribute("tabindex",-1),this.latestRow_.classList.add("borderless"))}}])&&ds(t.prototype,n),r&&ds(t,r),e}();function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ps(e,t,n){return t&&fs(e.prototype,t),n&&fs(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hs.Style={VERTICAL:"input-container-style-vertical",ACCORDION:"input-container-style-accordion",FLEX:"input-container-style-flex"};var ms=c.util.Dom,vs=(window.shaka,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetCards_=[],this.messageDiv_=document.createElement("div"),this.assetCardDiv_=document.createElement("div"),t.appendChild(this.messageDiv_),this.makeMessage_(),t.appendChild(this.assetCardDiv_),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.assetCardDiv_.childNodes.length||t.classList.contains("hidden")||n.remakeAssetCards_()})}return ps(e,null,[{key:"init",value:function(){var t=Ga.addNavButton("front");new e(t)}}]),ps(e,[{key:"makeMessage_",value:function(){var e=this,t="shakaPlayerHideFrontMessage";if(!window.localStorage.getItem(t)){var n=function(t,n){var r=document.createElement("h2");r.classList.add("mdl-typography--"+t),r.textContent=n,e.messageDiv_.appendChild(r)};n("body-2","This is a demo of Google's Shaka Player, a JavaScript library for adaptive video streaming."),n("body-1","Choose a video to playback; more assets are available via the search tab.");var r=document.createElement("button");r.classList.add("mdl-button"),r.classList.add("mdl-button--colored"),r.classList.add("mdl-js-button"),r.classList.add("mdl-js-ripple-effect"),r.textContent="Dismiss",r.addEventListener("click",function(){ms.removeAllChildren(e.messageDiv_),window.localStorage.setItem(t,"true")}),this.messageDiv_.appendChild(r)}}},{key:"remakeAssetCards_",value:function(){var e=this;ms.removeAllChildren(this.assetCardDiv_);var t=g.testAssets.filter(function(e){return e.isFeatured&&!e.disabled});console.log(t),this.assetCards_=t.map(function(t){return e.createAssetCardFor_(t,e.assetCardDiv_)}),this.updateSelected_()}},{key:"createAssetCardFor_",value:function(e,t){var n=this;return new Qa(t,e,!0,function(t){var r=Ga.getAssetUnsupportedReason(e,!1);r?t.markAsUnsupported(r):(t.addButton("Play",function(){Ga.loadAsset(e),n.updateSelected_()}),t.addStoreButton())})}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Ga.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}]),e}());function ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gs(e,t,n){return t&&ys(e.prototype,t),n&&ys(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */document.addEventListener("shaka-main-loaded",vs.init);var _s=c.util.Dom,bs=(window.shaka,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.desiredFeatures_=[],this.desiredSource_,this.desiredDRM_,this.makeSearchDiv_(t),this.assetCards_=[],this.resultsDiv_=document.createElement("div"),t.appendChild(this.resultsDiv_),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.resultsDiv_.childNodes.length||t.classList.contains("hidden")||n.remakeResultsDiv_()})}return gs(e,null,[{key:"init",value:function(){var t=Ga.addNavButton("search");new e(t)}}]),gs(e,[{key:"createAssetCardFor_",value:function(e){var t=this,n=this.resultsDiv_;return new Qa(n,e,!1,function(n){var r=Ga.getAssetUnsupportedReason(e,!1);r?n.markAsUnsupported(r):(n.addButton("Play",function(){Ga.loadAsset(e),t.updateSelected_()}),n.addStoreButton())})}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Ga.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"remakeResultsDiv_",value:function(){var e=this;_s.removeAllChildren(this.resultsDiv_);var t=this.searchResults_();this.assetCards_=t.map(function(t){return e.createAssetCardFor_(t)}),this.updateSelected_()}},{key:"addDesiredTerm_",value:function(t,n,r){switch(n){case e.TermType.DRM:this.desiredDRM_=t;break;case e.TermType.SOURCE:this.desiredSource_=t;break;case e.TermType.FEATURE:var i=!0,a=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=this.desiredFeatures_.indexOf(l);-1!=c&&this.desiredFeatures_.splice(c,1)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}this.desiredFeatures_.push(t)}}},{key:"removeDesiredTerm_",value:function(t,n){var r;switch(n){case e.TermType.DRM:this.desiredDRM_=null;break;case e.TermType.SOURCE:this.desiredSource_=null;break;case e.TermType.FEATURE:-1!=(r=this.desiredFeatures_.indexOf(t))&&this.desiredFeatures_.splice(r,1)}}},{key:"makeBooleanInput_",value:function(e,t,n){var r=this;e.addRow(t,null,"significant-right-padding");new os(e,t,function(e){e.checked?r.addDesiredTerm_(t,n,[t]):r.removeDesiredTerm_(t,n),r.remakeResultsDiv_(),componentHandler.upgradeDom()})}},{key:"makeSelectInput_",value:function(e,t,n,r){var i=this;e.addRow(null,null);var a={},s=!0,o=!1,u=void 0;try{for(var l,c=n[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;if("DRM"==r){for(var h in g.KeySystem)if(g.KeySystem[h]==d){a[d]=h.split("_").map(function(e){return e[0]+e.substr(1).toLowerCase()}).join(" ");break}}else a[d]=d}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}a.Unspecified="Unspecified";var f="Unspecified",p=new ss(e,t,function(e){"Unspecified"!=e.value?i.addDesiredTerm_(e.value,r,n):i.removeDesiredTerm_(f,r),f=e.value,i.remakeResultsDiv_(),componentHandler.upgradeDom()},a);p.extra().textContent=t,p.input().value="Unspecified"}},{key:"makeSearchDiv_",value:function(t){var n=g.Feature,r=e.TermType.FEATURE,i=e.TermType.DRM,a=e.TermType.SOURCE,s=new hs(t,null,hs.Style.FLEX,null);this.makeSelectInput_(s,"Manifest",[n.DASH,n.HLS],r),this.makeSelectInput_(s,"Container",[n.MP4,n.MP2TS,n.WEBM],r),this.makeSelectInput_(s,"DRM",Object.values(g.KeySystem),i),this.makeSelectInput_(s,"Source",Object.values(g.Source).filter(function(e){return"Custom"!=e}),a);var o=hs.Style.FLEX,u=new hs(t,null,o,null);this.makeBooleanInput_(u,n.LIVE,r),this.makeBooleanInput_(u,n.HIGH_DEFINITION,r),this.makeBooleanInput_(u,n.XLINK,r),this.makeBooleanInput_(u,n.SUBTITLES,r),this.makeBooleanInput_(u,n.TRICK_MODE,r),this.makeBooleanInput_(u,n.SURROUND,r),this.makeBooleanInput_(u,n.OFFLINE,r),this.makeBooleanInput_(u,n.STORED,r)}},{key:"searchResults_",value:function(){var e=this;return g.testAssets.filter(function(t){if(t.disabled)return!1;if(e.desiredDRM_&&!t.drm.includes(e.desiredDRM_))return!1;if(e.desiredSource_&&t.source!=e.desiredSource_)return!1;var n=!0,r=!1,i=void 0;try{for(var a,s=e.desiredFeatures_[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(o==g.Feature.STORED){if(!t.isStored())return!1}else if(!t.features.includes(o))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0})}}]),e}());function ws(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Es(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ws(a,r,i,s,o,"next",e)}function o(e){ws(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ts(e,t,n){return t&&Ss(e.prototype,t),n&&Ss(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bs.SearchTerm={},bs.TermType={FEATURE:"Feature",DRM:"DRM",SOURCE:"Source"},document.addEventListener("shaka-main-loaded",bs.init);var ks=c.util.Dom,Cs=(window.shaka,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dialog_=document.createElement("dialog"),this.dialog_.classList.add("mdl-dialog"),t.appendChild(this.dialog_),this.dialog_.showModal||qa.registerDialog(this.dialog_),this.assets_=this.loadAssetInfos_(),this.assetCards_=[],this.savedList_=document.createElement("div"),t.appendChild(this.savedList_);var r=document.createElement("div");r.classList.add("add-button-container"),t.appendChild(r);var i=this.makeButton_("add",!0,function(){n.showAssetDialog_(p.makeBlankAsset())});r.appendChild(i),document.addEventListener("shaka-main-selected-asset-changed",function(){n.updateSelected_()}),document.addEventListener("shaka-main-offline-progress",function(){n.updateOfflineProgress_()}),document.addEventListener("shaka-main-page-changed",function(){n.savedList_.childNodes.length||t.classList.contains("hidden")||n.remakeSavedList_()})}return Ts(e,null,[{key:"init",value:function(){var t=Ga.addNavButton("custom");new e(t)}}]),Ts(e,[{key:"assets",value:function(){return Array.from(this.assets_)}},{key:"updateOfflineProgress_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.updateProgress()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"showAssetDialog_",value:function(e){var t=this;ks.removeAllChildren(this.dialog_);var n=document.createElement("div");this.dialog_.appendChild(n);var r=document.createElement("div");this.dialog_.appendChild(r);var i,a,s=[],o=function(){var t=i.value,n=a.value;if(t){e.licenseServers.clear();var r=!0,s=!1,o=void 0;try{for(var u,l=ShakaDemoMain.commonDrmSystems[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var c=u.value;e.licenseServers.set(c,t)}}catch(e){s=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(s)throw o}}n&&e.licenseServers.set(n,t)}else e.licenseServers.clear()},u=hs.Style.VERTICAL,l=new hs(n,null,u,null),c=function(e,t,n){l.addRow(null,null);var r=new us(l,e,n);r.extra().textContent=e,t(r.input(),r.container())};c("Manifest URL",function(t,n){t.value=e.manifestUri,s.push(t);var r=document.createElement("span");r.classList.add("mdl-textfield__error"),r.textContent="Must have a manifest URL.",n.appendChild(r),t.required=!0,t.pattern="^(?!([\r\n\t\f\v ]+)$).*$"},function(t){e.manifestUri=t.value});c("Custom License Server URL",function(t,n){i=t;var r=e.licenseServers.keys().next();r&&r.value&&(t.value=e.licenseServers.get(r.value))},function(e){o()});c("Custom License Certificate URL",function(t,n){e.certificateUri&&(t.value=e.certificateUri)},function(t){e.certificateUri=t.value});c("Custom DRM System",function(t,n){a=t;var r=e.licenseServers.keys(),i=!0,s=!1,o=void 0;try{for(var u,l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;if(!ShakaDemoMain.commonDrmSystems.includes(c)){t.value=c;break}}}catch(e){s=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(s)throw o}}},function(e){o()});c("Name",function(n,r){n.value=e.name,s.push(n);var i=document.createElement("span");i.classList.add("mdl-textfield__error"),i.textContent="Must be a unique name.",r.appendChild(i),n.required=!0,n.pattern="^(?!( *";var a=!0,o=!1,u=void 0;try{for(var l,c=t.assets_[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var d=l.value;d!=e&&(n.pattern+="|"+function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(d.name))}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}n.pattern+=")$).*$"},function(t){e.name=t.value});c("Icon URL",function(t,n){if(e.iconUri){t.value=e.iconUri;var i=document.createElement("img");i.src=t.value,i.alt="",r.appendChild(i)}},function(t){if(ks.removeAllChildren(r),e.iconUri=t.value,t.value){var n=document.createElement("img");n.src=t.value,n.alt="",r.appendChild(n)}});var d=document.createElement("tr");n.appendChild(d),d.appendChild(this.makeButton_("Save",!1,function(){for(var n=0,r=s;n<r.length;n++){if(!r[n].validity.valid)return}Ga.setupOfflineSupport(e),t.assets_.add(e),t.saveAssetInfos_(t.assets_),t.remakeSavedList_(),t.dialog_.close()})),d.appendChild(this.makeButton_("Cancel",!1,function(){t.dialog_.close()})),componentHandler.upgradeDom(),this.dialog_.showModal()}},{key:"loadAssetInfos_",value:function(){var t=window.localStorage.getItem(e.saveId_);if(t){var n=JSON.parse(t);return new Set(n.map(function(e){var t=p.fromJSON(e);return Ga.setupOfflineSupport(t),t}))}return new Set}},{key:"saveAssetInfos_",value:function(t){var n=e.saveId_,r=Array.from(t);window.localStorage.setItem(n,JSON.stringify(r))}},{key:"makeButton_",value:function(e,t,n){var r=document.createElement("button");if(t){r.classList.add("mdl-button--fab"),r.classList.add("mdl-button--colored");var i=document.createElement("i");i.classList.add("material-icons"),i.textContent=e,r.appendChild(i)}else r.textContent=e,r.classList.add("mdl-button--raised");return r.addEventListener("click",n),r.classList.add("mdl-button"),r.classList.add("mdl-js-button"),r.classList.add("mdl-js-ripple-effect"),r}},{key:"createAssetCardFor_",value:function(e){var t=this,n=this.savedList_;return new AssetCard(n,e,!1,function(n){n.addButton("Play",function(){Ga.loadAsset(e),t.updateSelected_()}),n.addButton("Edit",Es(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.unstoreCallback){n.next=3;break}return n.next=3,e.unstoreCallback();case 3:t.showAssetDialog_(e);case 4:case"end":return n.stop()}},n)}))),n.addButton("Delete",Es(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.assets_.delete(e),!e.unstoreCallback){n.next=4;break}return n.next=4,e.unstoreCallback();case 4:t.saveAssetInfos_(t.assets_),t.remakeSavedList_();case 6:case"end":return n.stop()}},n)}))),n.addStoreButton()})}},{key:"updateSelected_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.assetCards_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.selectByAsset(Ga.selectedAsset)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"remakeSavedList_",value:function(){var e=this;if(ks.removeAllChildren(this.savedList_),0==this.assets_.size){var t=function(t,n){var r=document.createElement("h2");r.classList.add("mdl-typography--"+t),r.textContent=n,e.savedList_.appendChild(r)};t("title","Try Shaka Player with your own content!"),t("body-2","Press the button below to add a custom asset."),t("body-1","Custom assets will remain even after reloading the page.")}else this.assetCards_=Array.from(this.assets_).map(function(t){return e.createAssetCardFor_(t)}),this.updateSelected_()}}]),e}());function Is(e){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function As(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xs(e,t,n){return t&&As(e.prototype,t),n&&As(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs.saveId_="shakaPlayerDemoSavedAssets",document.addEventListener("shaka-main-loaded",Cs.init);var Ls=c.util.Dom,Ns=window.shaka,Rs=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container_=t,this.sections_=[],this.latestInput_=null,this.addedFields_=new Set,this.reload_(),document.addEventListener("shaka-main-config-change",function(){n.reloadAndSaveState_()}),document.addEventListener("shaka-main-drawer-state-change",function(){n.setContentAvailability_(Ga.getIsDrawerOpen())}),this.setContentAvailability_(Ga.getIsDrawerOpen())}return xs(e,null,[{key:"init",value:function(){var t=Ga.getHamburgerMenu();new e(t)}}]),xs(e,[{key:"setContentAvailability_",value:function(e){e?this.container_.classList.remove("hidden"):this.container_.classList.add("hidden")}},{key:"reload_",value:function(){Ls.removeAllChildren(this.container_),this.sections_=[],this.addMetaSection_(),this.addLanguageSection_(),this.addAbrSection_(),this.addOfflineSection_(),this.addDrmSection_(),this.addStreamingSection_(),this.addManifestSection_(),this.addRetrictionsSection_("",""),this.checkSectionCompleteness_(),this.checkSectionValidity_()}},{key:"reloadAndSaveState_",value:function(){var e=this.sections_.map(function(e){return e.getIsOpen()});this.reload_();for(var t=0;t<e.length;t++){var n=e[t],r=this.sections_[t];n&&r.open()}Oa.upgradeDom()}},{key:"addDrmSection_",value:function(){var e=this,t=this.resolveExternLink_(".DrmConfiguration");this.addSection_("DRM",t).addBoolInput_("Delay License Request Until Played","drm.delayLicenseRequestUntilPlayed");var n=Ga.getConfiguration().drm.advanced||{},r=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],i=function(t,i){e.addDatalistInput_(t,r,function(e){for(var t in n)n[t][i]=e.value;Ga.configure("drm.advanced",n),Ga.remakeHash()});var a=Object.keys(n)[0];if(a){var s=n[a][i];e.latestInput_.input().value=s}};i("Video Robustness","videoRobustness"),i("Audio Robustness","audioRobustness"),this.addRetrySection_("drm","DRM")}},{key:"addManifestSection_",value:function(){var e=this.resolveExternLink_(".ManifestConfiguration");this.addSection_("Manifest",e).addBoolInput_("Ignore DASH DRM Info","manifest.dash.ignoreDrmInfo").addBoolInput_("Auto-Correct DASH Drift","manifest.dash.autoCorrectDrift").addBoolInput_("Xlink Should Fail Gracefully","manifest.dash.xlinkFailGracefully").addNumberInput_("Availability Window Override","manifest.availabilityWindowOverride",!0,!1,!0).addTextInput_("Clock Sync URI","manifest.dash.clockSyncUri").addBoolInput_("Ignore DRM Info","manifest.dash.ignoreDrmInfo").addNumberInput_("Default Presentation Delay","manifest.dash.defaultPresentationDelay").addBoolInput_("Ignore Min Buffer Time","manifest.dash.ignoreMinBufferTime"),this.addRetrySection_("manifest","Manifest")}},{key:"addAbrSection_",value:function(){var e=this.resolveExternLink_(".AbrConfiguration");this.addSection_("Adaptation",e).addBoolInput_("Enabled","abr.enabled").addNumberInput_("Default Bandwidth Estimate","abr.defaultBandwidthEstimate").addNumberInput_("Bandwidth Downgrade Target","abr.bandwidthDowngradeTarget",!0).addNumberInput_("Bandwidth Upgrade Target","abr.bandwidthUpgradeTarget",!0).addNumberInput_("Switch Interval","abr.switchInterval",!0),this.addRetrictionsSection_("abr","Adaptation")}},{key:"addRetrictionsSection_",value:function(e,t){var n=(e?e+".":"")+"restrictions.",r=(t?t+" ":"")+"Restrictions",i=this.resolveExternLink_(".Restrictions");this.addSection_(r,i).addNumberInput_("Min Width",n+"minWidth").addNumberInput_("Max Width",n+"maxWidth").addNumberInput_("Min Height",n+"minHeight").addNumberInput_("Max Height",n+"maxHeight").addNumberInput_("Min Pixels",n+"minPixels").addNumberInput_("Max Pixels",n+"maxPixels").addNumberInput_("Min Bandwidth",n+"minBandwidth").addNumberInput_("Max Bandwidth",n+"maxBandwidth")}},{key:"addRetrySection_",value:function(e,t){var n=e+".retryParameters.",r=this.resolveExternLink_(".RetryParameters");this.addSection_(t+" Retry Parameters",r).addNumberInput_("Max Attempts",n+"maxAttempts").addNumberInput_("Base Delay",n+"baseDelay",!0).addNumberInput_("Backoff Factor",n+"backoffFactor",!0).addNumberInput_("Fuzz Factor",n+"fuzzFactor",!0).addNumberInput_("Timeout",n+"timeout",!0)}},{key:"addOfflineSection_",value:function(){var e=this.resolveExternLink_(".OfflineConfiguration");this.addSection_("Offline",e).addBoolInput_("Use Persistent Licenses","offline.usePersistentLicense")}},{key:"addStreamingSection_",value:function(){var e=this.resolveExternLink_(".StreamingConfiguration");if(this.addSection_("Streaming",e).addNumberInput_("Maximum Small Gap Size","streaming.smallGapLimit",!0).addNumberInput_("Buffering Goal","streaming.bufferingGoal",!0).addNumberInput_("Duration Backoff","streaming.durationBackoff",!0).addNumberInput_("Rebuffering Goal","streaming.rebufferingGoal",!0).addNumberInput_("Buffer Behind","streaming.bufferBehind",!0).addNumberInput_("Safe Seek Offset","streaming.safeSeekOffset",!0).addNumberInput_("Stall Threshold","streaming.stallThreshold",!0).addNumberInput_("Safe Skip Distance","streaming.stallSkip",!0),Ga.getNativeControlsEnabled()){this.addCustomBoolInput_("Always Stream Text",function(e){},"Text must always be streamed while native controls are enabled, for captions to work."),this.latestInput_.input().disabled=!0,this.latestInput_.input().checked=!0}else this.addBoolInput_("Always Stream Text","streaming.alwaysStreamText");this.addBoolInput_("Jump Large Gaps","streaming.jumpLargeGaps").addBoolInput_("Force Transmux TS","streaming.forceTransmuxTS").addBoolInput_("Start At Segment Boundary","streaming.startAtSegmentBoundary").addBoolInput_("Ignore Text Stream Failures","streaming.ignoreTextStreamFailures").addBoolInput_("Stall Detector Enabled","streaming.stallEnabled"),this.addRetrySection_("streaming","Streaming")}},{key:"addLanguageSection_",value:function(){var e=this.resolveExternLink_(".PlayerConfiguration");this.addSection_("Language",e).addTextInput_("Preferred Audio Language","preferredAudioLanguage").addTextInput_("Preferred Text Language","preferredTextLanguage");this.addCustomTextInput_("Preferred UI Locale",function(e){Ga.setUILocale(e.value)}),this.latestInput_.input().value=Ga.getUILocale(),this.addNumberInput_("Preferred Audio Channel Count","preferredAudioChannelCount")}},{key:"addMetaSection_",value:function(){var e=this;if(this.addSection_("",null),this.addCustomBoolInput_("Shaka Controls",function(t){Ga.setNativeControlsEnabled(!t.checked),t.checked&&(Ga.configure("streaming.alwaysStreamText",!0),Ga.remakeHash()),e.reloadAndSaveState_()}),Ga.getNativeControlsEnabled()||(this.latestInput_.input().checked=!0),Ns.log){var t=Ns.log.Level,n=Ns.log.setLevel;this.addSelectInput_("Log Level",{info:"Info",debug:"Debug",v:"Verbose",vv:"Very Verbose"},function(e){switch(e.value){case"info":n(t.INFO);break;case"debug":n(t.DEBUG);break;case"vv":n(t.V2);break;case"v":n(t.V1)}Ga.remakeHash()});var r=this.latestInput_.input();switch(Ns.log.currentLevel){case t.DEBUG:r.value="debug";break;case t.V2:r.value="vv";break;case t.V1:r.value="v";break;default:r.value="info"}}}},{key:"resolveExternLink_",value:function(e){return"../docs/api/shaka.extern.html#"+e}},{key:"addSection_",value:function(e,t){var n=e?hs.Style.ACCORDION:hs.Style.VERTICAL;return this.sections_.push(new hs(this.container_,e,n,t)),this}},{key:"addBoolInput_",value:function(e,t,n){return this.addCustomBoolInput_(e,function(e){Ga.configure(t,e.checked),Ga.remakeHash()},n),Ga.getCurrentConfigValue(t)&&(this.latestInput_.input().checked=!0),this.addedFields_.add(t),this}},{key:"addCustomBoolInput_",value:function(e,t,n){return this.createRow_(e,n),this.latestInput_=new os(this.getLatestSection_(),e,t),this}},{key:"addTextInput_",value:function(e,t,n){return this.addCustomTextInput_(e,function(e){Ga.configure(t,e.value),Ga.remakeHash()},n),this.latestInput_.input().value=Ga.getCurrentConfigValue(t),this.addedFields_.add(t),this}},{key:"addCustomTextInput_",value:function(e,t,n){return this.createRow_(e,n),this.latestInput_=new us(this.getLatestSection_(),e,t),this}},{key:"addNumberInput_",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;return this.createRow_(e,a),this.latestInput_=new cs(this.getLatestSection_(),e,function(e){if(Ga.resetConfiguration(t),Ga.remakeHash(),"Infinity"==e.value)return Ga.configure(t,1/0),void Ga.remakeHash();if(""!=e.value||!i){var a=Number(e.value);if((0!=a||r)&&!isNaN(a)){if(Math.floor(a)!=a&&!n)return;Ga.configure(t,a),Ga.remakeHash()}}},n,r,i),this.latestInput_.input().value=Ga.getCurrentConfigValue(t),isNaN(Number(this.latestInput_.input().value))&&i&&(this.latestInput_.input().value=""),this.addedFields_.add(t),this}},{key:"addDatalistInput_",value:function(e,t,n,r){return this.createRow_(e,r),this.latestInput_=new ls(this.getLatestSection_(),e,n,t),this}},{key:"addSelectInput_",value:function(e,t,n,r){return this.createRow_(e,r),this.latestInput_=new ss(this.getLatestSection_(),e,n,t),this}},{key:"createRow_",value:function(e,t){this.getLatestSection_().addRow(e,t||null)}},{key:"checkSectionCompleteness_",value:function(){var e=this,t=new Set(["number","string","boolean"]);!function n(r,i){for(var a in r){var s=i?i+"."+a:a,o=r[a];t.has(Is(o))?e.addedFields_.has(s)||console.warn("WARNING: Does not have config field for "+s):n(o,s)}}(Ga.getConfiguration(),"")}},{key:"checkSectionValidity_",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.addedFields_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;null==Ga.getCurrentConfigValue(a)&&console.warn("WARNING: Invalid config field "+a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"getLatestSection_",value:function(){return window.asserts.assert(this.sections_.length>0,"Must have at least one section."),this.sections_[this.sections_.length-1]}}]),e}();function Ms(e){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ps(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Os(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ps(a,r,i,s,o,"next",e)}function o(e){Ps(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Us(e,t){return!t||"object"!==Ms(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fs(e){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bs(e,t){return(Bs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */document.addEventListener("shaka-main-loaded",Rs.init);var Vs=window.shaka,js=function(e){function t(e,n,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Us(this,Fs(t).call(this))).video_=e,a.player_=n,a.eventManager_=new EventManager,a.targets_={video:e,player:n},a.appDataCallback_=r||function(){},a.contentIdCallback_=i||function(e){return e},a.isConnected_=!1,a.isIdle_=!0,a.updateNumber_=0,a.startUpdatingUpdateNumber_=!1,a.initialStatusUpdatePending_=!0,a.shakaBus_=null,a.genericBus_=null,a.pollTimer_=new Timer(function(){a.pollAttributes_()}),a.init_(),a}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bs(e,t)}(t,H),n=t,(r=[{key:"isConnected",value:function(){return this.isConnected_}},{key:"isIdle",value:function(){return this.isIdle_}},{key:"destroy",value:function(){var e=Os(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),t=[],this.player_&&(t.push(this.player_.destroy()),this.player_=null),this.pollTimer_&&(this.pollTimer_.stop(),this.pollTimer_=null),this.video_=null,this.targets_=null,this.appDataCallback_=null,this.isConnected_=!1,this.isIdle_=!0,this.shakaBus_=null,this.genericBus_=null,e.next=13,Promise.all(t);case 13:cast.receiver.CastReceiverManager.getInstance().stop();case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"init_",value:function(){var e=this,t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return e.onSendersChanged_()},t.onSenderDisconnected=function(){return e.onSendersChanged_()},t.onSystemVolumeChanged=function(){return e.fakeVolumeChangeEvent_()},this.genericBus_=t.getCastMessageBus(CastUtils.GENERIC_MESSAGE_NAMESPACE),this.genericBus_.onMessage=function(t){return e.onGenericMessage_(t)},this.shakaBus_=t.getCastMessageBus(CastUtils.SHAKA_MESSAGE_NAMESPACE),this.shakaBus_.onMessage=function(t){return e.onShakaMessage_(t)},goog.DEBUG?Platform.isChromecast()&&t.start():t.start();var n=!0,r=!1,i=void 0;try{for(var a,s=CastUtils.VideoEvents[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;this.eventManager_.listen(this.video_,o,function(t){return e.proxyEvent_("video",t)})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var u=!0,l=!1,c=void 0;try{for(var d,h=CastUtils.PlayerEvents[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value;this.eventManager_.listen(this.player_,f,function(t){return e.proxyEvent_("player",t)})}}catch(e){l=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(l)throw c}}cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?this.player_.setMaxHardwareResolution(3840,2160):this.player_.setMaxHardwareResolution(1920,1080),this.eventManager_.listen(this.video_,"loadeddata",function(){e.startUpdatingUpdateNumber_=!0}),this.eventManager_.listen(this.player_,"loading",function(){e.isIdle_=!1,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"playing",function(){e.isIdle_=!1,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"pause",function(){e.onCastStatusChanged_()}),this.eventManager_.listen(this.player_,"unloading",function(){e.isIdle_=!0,e.onCastStatusChanged_()}),this.eventManager_.listen(this.video_,"ended",function(){new Vs.util.Timer(function(){e.video_&&e.video_.ended&&(e.isIdle_=!0,e.onCastStatusChanged_())}).tickAfter(Vs.cast.CastReceiver.IDLE_INTERVAL)})}},{key:"onSendersChanged_",value:function(){this.updateNumber_=0,this.initialStatusUpdatePending_=!0;var e=cast.receiver.CastReceiverManager.getInstance();this.isConnected_=0!=e.getSenders().length,this.onCastStatusChanged_()}},{key:"onCastStatusChanged_",value:function(){var e=Os(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(this.player_){e.next=4;break}return e.abrupt("return");case 4:t=new Vs.util.FakeEvent("caststatuschanged"),this.dispatchEvent(t),this.maybeSendMediaInfoMessage_()||this.sendMediaStatus_(0);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initState_",value:function(){var e=Os(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t.player)i=t.player[r],this.player_[r](i);if(this.appDataCallback_(n),a=this.video_.autoplay,!t.manifest){e.next=18;break}return this.video_.autoplay=!1,e.prev=5,e.next=8,this.player_.load(t.manifest,t.startTime);case 8:e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(5),window.asserts.assert(e.t0 instanceof Vs.util.Error,"Wrong error type!"),s=new Vs.util.FakeEvent("error",{detail:e.t0}),this.player_.dispatchEvent(s),e.abrupt("return");case 16:e.next=20;break;case 18:return e.next=20,Promise.resolve();case 20:if(this.player_){e.next=22;break}return e.abrupt("return");case 22:for(o in t.video)u=t.video[o],this.video_[o]=u;for(l in t.playerAfterLoad)c=t.playerAfterLoad[l],this.player_[l](c);this.video_.autoplay=a,t.manifest&&(this.video_.play(),this.sendMediaStatus_(0));case 26:case"end":return e.stop()}},e,this,[[5,10]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"proxyEvent_",value:function(e,t){this.player_&&(this.pollAttributes_(),this.sendMessage_({type:"event",targetName:e,event:t},this.shakaBus_))}},{key:"pollAttributes_",value:function(){this.pollTimer_.tickAfter(t.POLL_INTERVAL);var e={video:{},player:{}},n=!0,r=!1,i=void 0;try{for(var a,s=CastUtils.VideoAttributes[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;e.video[o]=this.video_[o]}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(this.player_.isLive()){var u=CastUtils.PlayerGetterMethodsThatRequireLive;for(var l in u){var c=u[l];this.updateNumber_%c==0&&(e.player[l]=this.player_[l]())}}for(var d in CastUtils.PlayerGetterMethods){var h=CastUtils.PlayerGetterMethods[d];this.updateNumber_%h==0&&(e.player[d]=this.player_[d]())}var f=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();f&&(e.video.volume=f.level,e.video.muted=f.muted),this.startUpdatingUpdateNumber_&&(this.updateNumber_+=1),this.sendMessage_({type:"update",update:e},this.shakaBus_),this.maybeSendMediaInfoMessage_()}},{key:"maybeSendMediaInfoMessage_",value:function(){return!(!this.initialStatusUpdatePending_||!this.video_.duration&&!this.player_.isLive())&&(this.sendMediaInfoMessage_(),this.initialStatusUpdatePending_=!1,!0)}},{key:"sendMediaInfoMessage_",value:function(){var e={contentId:this.player_.getAssetUri(),streamType:this.player_.isLive()?"LIVE":"BUFFERED",duration:this.video_.duration,contentType:""};this.sendMediaStatus_(0,e)}},{key:"fakeVolumeChangeEvent_",value:function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();window.asserts.assert(e,"System volume should not be null!"),e&&this.sendMessage_({type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.shakaBus_),this.sendMessage_({type:"event",targetName:"video",event:{type:"volumechange"}},this.shakaBus_)}},{key:"onShakaMessage_",value:function(e){var t=this,n=CastUtils.deserialize(e.data);switch(Vs.log.debug("CastReceiver: message",n),n.type){case"init":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.initState_(n.initState,n.appData),this.pollAttributes_();break;case"appData":this.appDataCallback_(n.appData);break;case"set":var r=n.targetName,i=n.property,a=n.value;if("video"==r){var s=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){s.setSystemVolumeLevel(a);break}if("muted"==i){s.setSystemVolumeMuted(a);break}}this.targets_[r][i]=a;break;case"call":var o=n.targetName,u=n.methodName,l=n.args,c=this.targets_[o];c[u].apply(c,l);break;case"asyncCall":var d=n.targetName,h=n.methodName;"player"==d&&"load"==h&&(this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1);var f=n.args,p=n.id,m=e.senderId,v=this.targets_[d],y=v[h].apply(v,f);"player"==d&&"load"==h&&(y=y.then(function(){t.initialStatusUpdatePending_=!0})),y.then(function(){return t.sendAsyncComplete_(m,p,null)},function(e){return t.sendAsyncComplete_(m,p,e)})}}},{key:"onGenericMessage_",value:function(e){var t=this,n=CastUtils.deserialize(e.data);switch(Vs.log.debug("CastReceiver: message",n),n.type){case"PLAY":this.video_.play(),this.sendMediaStatus_(0);break;case"PAUSE":this.video_.pause(),this.sendMediaStatus_(0);break;case"SEEK":var r=n.currentTime,i=n.resumeState;null!=r&&(this.video_.currentTime=Number(r)),i&&"PLAYBACK_START"==i?(this.video_.play(),this.sendMediaStatus_(0)):i&&"PLAYBACK_PAUSE"==i&&(this.video_.pause(),this.sendMediaStatus_(0));break;case"STOP":this.player_.unload().then(function(){t.player_&&t.sendMediaStatus_(0)});break;case"GET_STATUS":this.sendMediaStatus_(Number(n.requestId));break;case"VOLUME":var a=n.volume,s=a.level,o=a.muted,u=this.video_.volume,l=this.video_.muted;null!=s&&(this.video_.volume=Number(s)),null!=o&&(this.video_.muted=o),u==this.video_.volume&&l==this.video_.muted||this.sendMediaStatus_(0);break;case"LOAD":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!1;var c=n.media,d=c.contentId,h=n.currentTime,f=this.contentIdCallback_(d),p=n.autoplay||!0,m=c.customData;this.appDataCallback_(m),p&&(this.video_.autoplay=!0),this.player_.load(f,h).then(function(){t.player_&&t.sendMediaInfoMessage_()}).catch(function(e){var r="LOAD_FAILED";e.category==Vs.util.Error.Category.PLAYER&&e.code==Vs.util.Error.Code.LOAD_INTERRUPTED&&(r="LOAD_CANCELLED"),t.sendMessage_({requestId:Number(n.requestId),type:r},t.genericBus_)});break;default:Vs.log.warning("Unrecognized message type from the generic Chromecast controller!",n.type),this.sendMessage_({requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.genericBus_)}}},{key:"sendAsyncComplete_",value:function(e,t,n){this.player_&&this.sendMessage_({type:"asyncComplete",id:t,error:n},this.shakaBus_,e)}},{key:"sendMessage_",value:function(e,t,n){if(this.isConnected_){var r=CastUtils.serialize(e);n?t.getCastChannel(n).send(r):t.broadcast(r)}}},{key:"getPlayState_",value:function(){var e=t.PLAY_STATE;return this.isIdle_?e.IDLE:this.player_.isBuffering()?e.BUFFERING:this.video_.paused?e.PAUSED:e.PLAYING}},{key:"sendMediaStatus_",value:function(e,t){var n={mediaSessionId:0,playbackRate:this.video_.playbackRate,playerState:this.getPlayState_(),currentTime:this.video_.currentTime,supportedMediaCommands:15,volume:{level:this.video_.volume,muted:this.video_.muted}};t&&(n.media=t);var r={requestId:e,type:"MEDIA_STATUS",status:[n]};this.sendMessage_(r,this.genericBus_)}}])&&Ds(n.prototype,r),i&&Ds(n,i),t}();js.POLL_INTERVAL=.5,js.IDLE_INTERVAL=5,js.PLAY_STATE={IDLE:"IDLE",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED"};function Hs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ks=window.shaka,Gs=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"findChild",value:function(t,n){var r=e.findChildren(t,n);return 1!=r.length?null:r[0]}},{key:"findChildNS",value:function(t,n,r){var i=e.findChildrenNS(t,n,r);return 1!=i.length?null:i[0]}},{key:"findChildren",value:function(e,t){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.tagName==t})}},{key:"findChildrenNS",value:function(e,t,n){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t})}},{key:"getAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}},{key:"getContents",value:function(e){return Array.from(e.childNodes).every(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null}},{key:"parseAttr",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null,a=e.getAttribute(t);return null!=a&&(i=n(a)),null==i?r:i}},{key:"parseDate",value:function(e){if(!e)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");var t=Date.parse(e);return isNaN(t)?null:Math.floor(t/1e3)}},{key:"parseDuration",value:function(e){if(!e)return null;var t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return Ks.log.warning("Invalid duration string:",e),null;var n=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(n)?n:null}},{key:"parseRange",value:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var n=Number(t[1]);if(!isFinite(n))return null;var r=Number(t[2]);return isFinite(r)?{start:n,end:r}:null}},{key:"parseInt",value:function(e){var t=Number(e);return t%1==0?t:null}},{key:"parsePositiveInt",value:function(e){var t=Number(e);return t%1==0&&t>0?t:null}},{key:"parseNonNegativeInt",value:function(e){var t=Number(e);return t%1==0&&t>=0?t:null}},{key:"parseFloat",value:function(e){var t=Number(e);return isNaN(t)?null:t}},{key:"evalDivision",value:function(e){var t,n;return n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(n)?null:n}},{key:"parseXmlString",value:function(e,t){var n=new DOMParser,r=null,i=null;try{i=n.parseFromString(e,"text/xml")}catch(e){}return i&&i.documentElement.tagName==t&&(r=i.documentElement),r&&r.getElementsByTagName("parsererror").length>0?null:r}},{key:"parseXml",value:function(t,n){try{var r=ft.fromUTF8(t);return e.parseXmlString(r,n)}catch(e){return null}}}],(n=null)&&Hs(t.prototype,n),r&&Hs(t,r),e}());function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qs=new A,zs=window.shaka,Ys=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parseFromAdaptationSet",value:function(t,n,r){var i=e.parseElements_(t),a=null,s=[],o=[],u=new Set(i.map(function(e){return e.keyId}));if(u.delete(null),u.size>1)throw new A(qs.severity.CRITICAL,qs.category.MANIFEST,qs.code.DASH_CONFLICTING_KEY_IDS);if(r||(o=i.filter(function(t){return t.schemeUri!=e.MP4Protection_||(window.asserts.assert(!t.init||t.init.length,"Init data must be null or non-empty."),a=t.init||a,!1)})).length&&0==(s=e.convertElements_(a,n,o)).length&&(s=[ee.createDrmInfo("",a)]),i.length&&(r||!o.length)){s=[];var l=e.defaultKeySystems_,c=!0,d=!1,h=void 0;try{for(var f,p=l.values()[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;if("org.w3.clearkey"!=m){var v=ee.createDrmInfo(m,a);s.push(v)}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}}var y=Array.from(u)[0]||null;if(y){var g=!0,_=!1,b=void 0;try{for(var w,E=s[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var S=w.value,T=!0,k=!1,C=void 0;try{for(var I,x=S.initData[Symbol.iterator]();!(T=(I=x.next()).done);T=!0){I.value.keyId=y}}catch(e){k=!0,C=e}finally{try{T||null==x.return||x.return()}finally{if(k)throw C}}}}catch(e){_=!0,b=e}finally{try{g||null==E.return||E.return()}finally{if(_)throw b}}}return{defaultKeyId:y,defaultInit:a,drmInfos:s,firstRepresentation:!0}}},{key:"parseFromRepresentation",value:function(t,n,r,i){var a=e.parseFromAdaptationSet(t,n,i);if(r.firstRepresentation){var s=1==r.drmInfos.length&&!r.drmInfos[0].keySystem,o=0==r.drmInfos.length,u=0==a.drmInfos.length;(o||s&&!u)&&(r.drmInfos=a.drmInfos),r.firstRepresentation=!1}else if(a.drmInfos.length>0&&(r.drmInfos=r.drmInfos.filter(function(e){return a.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==r.drmInfos.length))throw new A(qs.severity.CRITICAL,qs.category.MANIFEST,qs.code.DASH_NO_COMMON_KEY_SYSTEM);return a.defaultKeyId||r.defaultKeyId}},{key:"getWidevineLicenseUrl",value:function(e){var t=Gs.findChildNS(e.node,"urn:microsoft","laurl");return t&&t.getAttribute("licenseUrl")||""}},{key:"parseMsProRecords_",value:function(e,t){for(var n=[],r=new DataView(e);t<e.byteLength-1;){var i=r.getUint16(t,!0);t+=2;var a=r.getUint16(t,!0);t+=2,window.asserts.assert(0==(1&a),"expected byteLength to be an even number");var s=new Uint8Array(e,t,a);n.push({type:i,value:s}),t+=a}return n}},{key:"parseMsPro_",value:function(t){var n=0,r=new DataView(t).getUint32(n,!0);return n+=4,r!==t.byteLength?(zs.log.warning("PlayReady Object with invalid length encountered."),[]):(n+=2,e.parseMsProRecords_(t,n))}},{key:"getLaurl_",value:function(e){var t=e.querySelector("DATA > LA_URL");return t?t.textContent:""}},{key:"getPlayReadyLicenseUrl",value:function(t){var n=Gs.findChildNS(t.node,"urn:microsoft:playready","pro");if(!n)return"";var r=e.PLAYREADY_RECORD_TYPES,i=mt.fromBase64(n.textContent),a=e.parseMsPro_(i.buffer).filter(function(e){return e.type===r.RIGHTS_MANAGEMENT})[0];if(!a)return"";var s=StringUtils.fromUTF16(a.value,!0),o=Gs.parseXmlString(s,"WRMHEADER");return o?e.getLaurl_(o):""}},{key:"convertElements_",value:function(t,n,r){var i=e.defaultKeySystems_,a=e.licenseUrlParsers_,s=[],o=!0,u=!1,l=void 0;try{for(var c,d=r[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=i.get(h.schemeUri);if(f){window.asserts.assert(!h.init||h.init.length,"Init data must be null or non-empty.");var p=h.init||t,m=ee.createDrmInfo(f,p),v=a.get(f);v&&(m.licenseServerUri=v(h)),s.push(m)}else{window.asserts.assert(n,"ContentProtection callback is required");var y=n(h.node)||[],g=!0,_=!1,b=void 0;try{for(var w,E=y[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var S=w.value;s.push(S)}}catch(e){_=!0,b=e}finally{try{g||null==E.return||E.return()}finally{if(_)throw b}}}}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}return s}},{key:"parseElements_",value:function(t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=e.parseElement_(u);l&&n.push(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"parseElement_",value:function(t){var n=e.CencNamespaceUri_,r=t.getAttribute("schemeIdUri"),i=Gs.getAttributeNS(t,n,"default_KID"),a=Gs.findChildrenNS(t,n,"pssh").map(Gs.getContents);if(!r)return zs.log.error("Missing required schemeIdUri attribute on","ContentProtection element",t),null;if(r=r.toLowerCase(),i&&(i=i.replace(/-/g,"").toLowerCase()).includes(" "))throw new A(qs.severity.CRITICAL,qs.category.MANIFEST,qs.code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);var s=[];try{s=a.map(function(e){return{initDataType:"cenc",initData:mt.fromBase64(e),keyId:null}})}catch(e){throw new A(qs.severity.CRITICAL,qs.category.MANIFEST,qs.code.DASH_PSSH_BAD_ENCODING)}return{node:t,schemeUri:r,keyId:i,init:s.length>0?s:null}}}],(n=null)&&Ws(t.prototype,n),r&&Ws(t,r),e}();function Xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ys.PlayReadyRecord,Ys.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},Ys.Context,Ys.Element,Ys.defaultKeySystems_=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime"),Ys.licenseUrlParsers_=(new Map).set("com.widevine.alpha",Ys.getWidevineLicenseUrl).set("com.microsoft.playready",Ys.getPlayReadyLicenseUrl),Ys.MP4Protection_="urn:mpeg:dash:mp4protection:2011",Ys.CencNamespaceUri_="urn:mpeg:cenc:2013";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
c.net.NetworkingEngine;var $s=c.util.AbortableOperation,Qs=window.shaka,Zs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fillUriTemplate",value:function(e,t,n,r,i){var a={RepresentationID:t,Number:n,Bandwidth:r,Time:i};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,r,i){if("$$"==t)return"$";var s,o=a[n];if(window.asserts.assert(void 0!==o,"Unrecognized identifier"),null==o)return Qs.log.warning("URL template does not have an available substitution for ",'identifier "'+n+'":',e),t;switch("RepresentationID"==n&&r&&(Qs.log.warning("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),r=void 0),"Time"==n&&(window.asserts.assert(Math.abs(o-Math.round(o))<.2,"Calculated $Time$ values must be close to integers"),o=Math.round(o)),i){case void 0:case"d":case"i":case"u":s=o.toString();break;case"o":s=o.toString(8);break;case"x":s=o.toString(16);break;case"X":s=o.toString(16).toUpperCase();break;default:window.asserts.assert(!1,"Unhandled format specifier"),s=o.toString()}var u=window.parseInt(r,10)||1,l=Math.max(0,u-s.length);return new Array(l+1).join("0")+s})}},{key:"createTimeline",value:function(e,t,n,r){window.asserts.assert(t>0&&t<1/0,"timescale must be a positive, finite integer"),window.asserts.assert(r>0,"period duration must be a positive integer");for(var i=Gs.findChildren(e,"S"),a=[],s=0,o=0;o<i.length;++o){var u=i[o],l=Gs.parseAttr(u,"t",Gs.parseNonNegativeInt),c=Gs.parseAttr(u,"d",Gs.parseNonNegativeInt),d=Gs.parseAttr(u,"r",Gs.parseInt);if(null!=l&&(l-=n),!c)return Qs.log.warning('"S" element must have a duration:','ignoring the remaining "S" elements.',u),a;var h=null!=l?l:s,f=d||0;if(f<0)if(o+1<i.length){var p=i[o+1],m=Gs.parseAttr(p,"t",Gs.parseNonNegativeInt);if(null==m)return Qs.log.warning('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',u),a;if(h>=m)return Qs.log.warning('An "S" element cannot have a negative repeatif its start ','time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',u),a;f=Math.ceil((m-h)/c)-1}else{if(r==1/0)return Qs.log.warning('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',u),a;if(h/t>=r)return Qs.log.warning('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',u),a;f=Math.ceil((r*t-h)/c)-1}if(a.length>0&&h!=s){var v=h-s;Math.abs(v/t)>=ee.GAP_OVERLAP_TOLERANCE_SECONDS&&Qs.log.warning("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",u),a[a.length-1].end=h/t}for(var y=0;y<=f;++y){var g=h+c,_={start:h/t,end:g/t,unscaledStart:h};a.push(_),h=g,s=g}}return a}},{key:"parseSegmentInfo",value:function(t,n){window.asserts.assert(n(t.representation),"There must be at least one element of the given type.");var r=e.inheritAttribute(t,n,"timescale"),i=1;r&&(i=Gs.parsePositiveInt(r)||1);var a=e.inheritAttribute(t,n,"duration"),s=Gs.parsePositiveInt(a||"");s&&(s/=i);var o=e.inheritAttribute(t,n,"startNumber"),u=Number(e.inheritAttribute(t,n,"presentationTimeOffset"))||0,l=Gs.parseNonNegativeInt(o||"");null!=o&&null!=l||(l=1);var c=e.inheritChild(t,n,"SegmentTimeline"),d=null;return c&&(d=e.createTimeline(c,i,u,t.periodInfo.duration||1/0)),{timescale:i,segmentDuration:s,startNumber:l,scaledPresentationTimeOffset:u/i||0,unscaledPresentationTimeOffset:u,timeline:d}}},{key:"inheritAttribute",value:function(e,t,n){return window.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(q.isNotNull).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}},{key:"inheritChild",value:function(e,t,n){return window.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(q.isNotNull).map(function(e){return Gs.findChild(e,n)}).reduce(function(e,t){return e||t})}},{key:"handleXlinkInElement_",value:function(t,n,r,i,a,s){for(var o=e.XlinkNamespaceUri_,u=Gs.getAttributeNS(t,o,"href"),l=Gs.getAttributeNS(t,o,"actuate")||"onRequest",c=0;c<t.attributes.length;c++){var d=t.attributes[c];d.namespaceURI==o&&(t.removeAttributeNS(d.namespaceURI,d.localName),c-=1)}if(s>=5)return $s.failed(new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_XLINK_DEPTH_LIMIT));if("onLoad"!=l)return $s.failed(new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_UNSUPPORTED_XLINK_ACTUATE));var h=ee.resolveUris([i],[u]),f=Qs.net.NetworkingEngine.RequestType.MANIFEST,p=vt(h,n),m=a.request(f,p);return window.asserts.assert(m instanceof $s,"Unexpected implementation of IAbortableOperation!"),m.chain(function(i){var o=Gs.parseXml(i.data,t.tagName);if(!o)return $s.failed(new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_INVALID_XML,u));for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);for(;o.childNodes.length;){var l=o.childNodes[0];o.removeChild(l),t.appendChild(l)}for(var c=0;c<o.attributes.length;c++){var d=o.attributes[c].nodeName,f=o.getAttribute(d);t.setAttribute(d,f)}return e.processXlinks(t,n,r,h[0],a,s+1)})}},{key:"processXlinks",value:function(t,n,r,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=e.XlinkNamespaceUri_;if(Gs.getAttributeNS(t,o,"href")){var u=e.handleXlinkInElement_(t,n,r,i,a,s);return r&&(u=u.chain(void 0,function(o){return e.processXlinks(t,n,r,i,a,s)})),u}for(var l=[],c=0;c<t.childNodes.length;c++){var d=t.childNodes[c];if(d instanceof Element){"urn:mpeg:dash:resolve-to-zero:2013"==Gs.getAttributeNS(d,o,"href")?(t.removeChild(d),c-=1):"SegmentTimeline"!=d.tagName&&l.push(e.processXlinks(d,n,r,i,a,s))}}return $s.all(l).chain(function(){return t})}}],(n=null)&&Xs(t.prototype,n),r&&Xs(t,r),e}();function Js(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Zs.TimeRange,Zs.SegmentInfo,Zs.XlinkNamespaceUri_="http://www.w3.org/1999/xlink";
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var eo=window.shaka,to=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){var a,s=(new Ai).fullBox("sidx",function(t){a=e.parseSIDX_(n,i,r,t)});if(t&&s.parse(t),a)return a;throw eo.log.error('Invalid box type, expected "sidx".'),new A(A.severity.CRITICAL,A.category.MEDIA,A.code.MP4_SIDX_WRONG_BOX_TYPE)}},{key:"parseSIDX_",value:function(e,t,n,r){window.asserts.assert(null!=r.version,"SIDX is a full box and should have a valid version.");var i=[];r.reader.skip(4);var a,s,o=r.reader.readUint32();if(0==o)throw eo.log.error("Invalid timescale."),new A(A.severity.CRITICAL,A.category.MEDIA,A.code.MP4_SIDX_INVALID_TIMESCALE);0==r.version?(a=r.reader.readUint32(),s=r.reader.readUint32()):(a=r.reader.readUint64(),s=r.reader.readUint64()),r.reader.skip(2);for(var u=r.reader.readUint16(),l=a,c=e+r.size+s,d=0;d<u;d++){var h=r.reader.readUint32(),f=(2147483648&h)>>>31,p=2147483647&h,m=r.reader.readUint32();if(r.reader.skip(4),1==f)throw eo.log.error("Heirarchical SIDXs are not supported."),new A(A.severity.CRITICAL,A.category.MEDIA,A.code.MP4_SIDX_TYPE_NOT_SUPPORTED);i.push(new ir(i.length,l/o-t,(l+m)/o-t,function(){return n},c,c+p-1)),l+=m,c+=p}return r.parser.stop(),i}}],(n=null)&&Js(t.prototype,n),r&&Js(t,r),e}());function no(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function io(e,t,n){return t&&ro(e.prototype,t),n&&ro(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ao=new A,so=(window.shaka,window.goog,function(){function e(t){no(this,e),this.dataView_=t,this.reader_=new Ti(t,Ti.Endianness.BIG_ENDIAN)}return io(e,[{key:"hasMoreData",value:function(){return this.reader_.hasMoreData()}},{key:"parseElement",value:function(){var t,n=this.parseId_(),r=this.parseVint_();t=e.isDynamicSizeValue_(r)?this.dataView_.byteLength-this.reader_.getPosition():e.getVintValue_(r);var i=this.reader_.getPosition()+t<=this.dataView_.byteLength?t:this.dataView_.byteLength-this.reader_.getPosition(),a=new DataView(this.dataView_.buffer,this.dataView_.byteOffset+this.reader_.getPosition(),i);return this.reader_.skip(i),new oo(n,a)}},{key:"parseId_",value:function(){var e=this.parseVint_();if(e.length>7)throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.EBML_OVERFLOW);var t=0,n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){t=256*t+a.value}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}},{key:"parseVint_",value:function(){var e=this.reader_.readUint8();if(0==e)throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.EBML_OVERFLOW);var t=8-Math.floor(Math.log2(e));window.asserts.assert(t<=8&&t>=1,"Incorrect log2 value");var n=new Uint8Array(t);n[0]=e;for(var r=1;r<t;r++)n[r]=this.reader_.readUint8();return n}}],[{key:"getVintValue_",value:function(e){if(8==e.length&&224&e[1])throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.JS_INTEGER_OVERFLOW);for(var t=1<<8-e.length,n=e[0]&t-1,r=1;r<e.length;r++)n=256*n+e[r];return n}},{key:"isDynamicSizeValue_",value:function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.DYNAMIC_SIZES[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(mt.equal(t,o))return!0}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!1}}]),e}());so.DYNAMIC_SIZES=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];var oo=function(){function e(t,n){no(this,e),this.id=t,this.dataView_=n}return io(e,[{key:"getOffset",value:function(){return this.dataView_.byteOffset}},{key:"createParser",value:function(){return new so(this.dataView_)}},{key:"getUint",value:function(){if(this.dataView_.byteLength>8)throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.EBML_OVERFLOW);if(8==this.dataView_.byteLength&&224&this.dataView_.getUint8(0))throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.JS_INTEGER_OVERFLOW);for(var e=0,t=0;t<this.dataView_.byteLength;t++){e=256*e+this.dataView_.getUint8(t)}return e}},{key:"getFloat",value:function(){if(4==this.dataView_.byteLength)return this.dataView_.getFloat32(0);if(8==this.dataView_.byteLength)return this.dataView_.getFloat64(0);throw new A(ao.severity.CRITICAL,ao.category.MEDIA,ao.code.EBML_BAD_FLOATING_POINT_SIZE)}}]),e}();function uo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var lo=window.shaka,co=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parse",value:function(t,n,r,i){var a=e.parseWebmContainer_(n),s=new so(new DataView(t)).parseElement();if(s.id!=e.CUES_ID)throw lo.log.error("Not a Cues element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_CUES_ELEMENT_MISSING);return e.parseCues_(s,a.segmentOffset,a.timecodeScale,a.duration,r,i)}},{key:"parseWebmContainer_",value:function(t){var n=new so(new DataView(t));if(n.parseElement().id!=e.EBML_ID)throw lo.log.error("Not an EBML element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);var r=n.parseElement();if(r.id!=e.SEGMENT_ID)throw lo.log.error("Not a Segment element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_SEGMENT_ELEMENT_MISSING);var i=r.getOffset(),a=e.parseSegment_(r);return{segmentOffset:i,timecodeScale:a.timecodeScale,duration:a.duration}}},{key:"parseSegment_",value:function(t){for(var n=t.createParser(),r=null;n.hasMoreData();){var i=n.parseElement();if(i.id==e.INFO_ID){r=i;break}}if(!r)throw lo.log.error("Not an Info element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_INFO_ELEMENT_MISSING);return e.parseInfo_(r)}},{key:"parseInfo_",value:function(t){for(var n=t.createParser(),r=1e6,i=null;n.hasMoreData();){var a=n.parseElement();a.id==e.TIMECODE_SCALE_ID?r=a.getUint():a.id==e.DURATION_ID&&(i=a.getFloat())}if(null==i)throw new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_DURATION_ELEMENT_MISSING);var s=r/1e9;return{timecodeScale:s,duration:i*s}}},{key:"parseCues_",value:function(t,n,r,i,a,s){for(var o=[],u=function(){return a},l=t.createParser(),c=null,d=null;l.hasMoreData();){var h=l.parseElement();if(h.id==e.CUE_POINT_ID){var f=e.parseCuePoint_(h);if(f){var p=r*f.unscaledTime,m=n+f.relativeOffset;null!=c&&(window.asserts.assert(null!=d,"last offset cannot be null"),o.push(new ir(o.length,c-s,p-s,u,d,m-1))),c=p,d=m}}}return null!=c&&(window.asserts.assert(null!=d,"last offset cannot be null"),o.push(new ir(o.length,c-s,i-s,u,d,null))),o}},{key:"parseCuePoint_",value:function(t){var n=t.createParser(),r=n.parseElement();if(r.id!=e.CUE_TIME_ID)throw lo.log.warning("Not a CueTime element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_CUE_TIME_ELEMENT_MISSING);var i=r.getUint(),a=n.parseElement();if(a.id!=e.CUE_TRACK_POSITIONS_ID)throw lo.log.warning("Not a CueTrackPositions element."),new A(A.Severity.CRITICAL,A.Category.MEDIA,A.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);for(var s=a.createParser(),o=0;s.hasMoreData();){var u=s.parseElement();if(u.id==e.CUE_CLUSTER_POSITION){o=u.getUint();break}}return{unscaledTime:i,relativeOffset:o}}}],(n=null)&&uo(t.prototype,n),r&&uo(t,r),e}());function ho(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}co.EBML_ID=440786851,co.SEGMENT_ID=408125543,co.INFO_ID=357149030,co.TIMECODE_SCALE_ID=2807729,co.DURATION_ID=17545,co.CUES_ID=475249515,co.CUE_POINT_ID=187,co.CUE_TIME_ID=179,co.CUE_TRACK_POSITIONS_ID=183,co.CUE_CLUSTER_POSITION=241;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var po=new A,mo=window.shaka,vo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createInitSegment",value:function(e,t){var n=Zs.inheritChild(e,t,"Initialization");if(!n)return null;var r=e.representation.baseUris,i=n.getAttribute("sourceURL");i&&(r=ee.resolveUris(e.representation.baseUris,[i]));var a=0,s=null,o=Gs.parseAttr(n,"range",Gs.parseRange);o&&(a=o.start,s=o.end);return new rr(function(){return r},a,s)}},{key:"createStream",value:function(t,n){window.asserts.assert(t.representation.segmentBase,"Should only be called with SegmentBase");var r=Number(Zs.inheritAttribute(t,e.fromInheritance_,"presentationTimeOffset"))||0,i=Zs.inheritAttribute(t,e.fromInheritance_,"timescale"),a=1;i&&(a=Gs.parsePositiveInt(i)||1);var s=r/a||0,o=e.createInitSegment(t,e.fromInheritance_),u=e.createSegmentIndex_(t,n,o,s);return{createSegmentIndex:u.createSegmentIndex,findSegmentPosition:u.findSegmentPosition,getSegmentReference:u.getSegmentReference,initSegmentReference:o,scaledPresentationTimeOffset:s}}},{key:"createSegmentIndexFromUris",value:function(e,t,n,r,i,a,s,o){var u=e.presentationTimeline,l=!e.dynamic||!e.periodInfo.isLastPeriod,c=e.periodInfo.start,d=e.periodInfo.duration,h=t,f=null;return{createSegmentIndex:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,p,m,v,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[h(r,i,a),"webm"==s?h(n.getUris(),n.startByte,n.endByte):null],h=null,e.next=4,Promise.all(t);case 4:return p=e.sent,m=p[0],v=p[1]||null,y=null,"mp4"==s?y=to.parse(m,i,r,o):(window.asserts.assert(v,"WebM requires init data"),y=co.parse(m,v,r,o)),u.notifySegments(y,c),window.asserts.assert(!f,"Should not call createSegmentIndex twice"),f=new ur(y),l&&f.fit(d),e.abrupt("return",p);case 14:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ho(a,r,i,s,o,"next",e)}function o(e){ho(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}(),findSegmentPosition:function(e){return window.asserts.assert(f,"Must call createSegmentIndex first"),f.find(e)},getSegmentReference:function(e){return window.asserts.assert(f,"Must call createSegmentIndex first"),f.get(e)}}}},{key:"fromInheritance_",value:function(e){return e.segmentBase}},{key:"createSegmentIndex_",value:function(t,n,r,i){var a=ee.ContentType,s=t.representation.contentType,o=t.representation.mimeType.split("/")[1];if(s!=a.TEXT&&"mp4"!=o&&"webm"!=o)throw mo.log.error("SegmentBase specifies an unsupported container type.",t.representation),new A(po.severity.CRITICAL,po.category.MANIFEST,po.code.DASH_UNSUPPORTED_CONTAINER);if("webm"==o&&!r)throw mo.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",t.representation),new A(po.severity.CRITICAL,po.category.MANIFEST,po.code.DASH_WEBM_MISSING_INIT);var u=Zs.inheritChild(t,e.fromInheritance_,"RepresentationIndex"),l=Zs.inheritAttribute(t,e.fromInheritance_,"indexRange"),c=t.representation.baseUris,d=Gs.parseRange(l||"");if(u){var h=u.getAttribute("sourceURL");h&&(c=ee.resolveUris(t.representation.baseUris,[h])),d=Gs.parseAttr(u,"range",Gs.parseRange,d)}if(!d)throw mo.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",t.representation),new A(po.severity.CRITICAL,po.category.MANIFEST,po.code.DASH_NO_SEGMENT_INFO);return e.createSegmentIndexFromUris(t,n,r,c,d.start,d.end,o,i)}}],(n=null)&&fo(t.prototype,n),r&&fo(t,r),e}();function yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var go=window.shaka,_o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createStream",value:function(e,t){window.asserts.assert(e.representation.segmentList,"Should only be called with SegmentList");var n=n,r=SegmentBase.createInitSegment(e,n.fromInheritance_),i=n.parseSegmentListInfo_(e);n.checkSegmentListInfo_(e,i);var a=null,s=null;e.period.id&&e.representation.id&&(s=e.period.id+","+e.representation.id,a=t[s]);var o=n.createSegmentReferences_(e.periodInfo.duration,i.startNumber,e.representation.baseUris,i);if(a){a.merge(o);var u=e.presentationTimeline.getSegmentAvailabilityStart();a.evict(u-e.periodInfo.start)}else e.presentationTimeline.notifySegments(o,e.periodInfo.start),a=new SegmentIndex(o),s&&e.dynamic&&(t[s]=a);return e.dynamic&&e.periodInfo.isLastPeriod||a.fit(e.periodInfo.duration),{createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return a.find(e)},getSegmentReference:function(e){return a.get(e)},initSegmentReference:r,scaledPresentationTimeOffset:i.scaledPresentationTimeOffset}}},{key:"fromInheritance_",value:function(e){return e.segmentList}},{key:"parseSegmentListInfo_",value:function(t){var n=e.parseMediaSegments_(t),r=MpdUtils.parseSegmentInfo(t,e.fromInheritance_),i=r.startNumber;0==i&&(go.log.warning("SegmentList@startNumber must be > 0"),i=1);var a=0;return r.segmentDuration?a=r.segmentDuration*(i-1):r.timeline&&r.timeline.length>0&&(a=r.timeline[0].start),{segmentDuration:r.segmentDuration,startTime:a,startNumber:i,scaledPresentationTimeOffset:r.scaledPresentationTimeOffset,timeline:r.timeline,mediaSegments:n}}},{key:"checkSegmentListInfo_",value:function(e,t){if(!t.segmentDuration&&!t.timeline&&t.mediaSegments.length>1)throw go.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.representation),new go.util.Error(go.util.Error.Severity.CRITICAL,go.util.Error.Category.MANIFEST,go.util.Error.Code.DASH_NO_SEGMENT_INFO);if(!t.segmentDuration&&!e.periodInfo.duration&&!t.timeline&&1==t.mediaSegments.length)throw go.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.representation),new go.util.Error(go.util.Error.Severity.CRITICAL,go.util.Error.Category.MANIFEST,go.util.Error.Code.DASH_NO_SEGMENT_INFO);if(t.timeline&&0==t.timeline.length)throw go.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.representation),new go.util.Error(go.util.Error.Severity.CRITICAL,go.util.Error.Category.MANIFEST,go.util.Error.Code.DASH_NO_SEGMENT_INFO)}},{key:"createSegmentReferences_",value:function(e,t,n,r){var i=go.util.ManifestParserUtils,a=r.mediaSegments.length;r.timeline&&r.timeline.length!=r.mediaSegments.length&&(a=Math.min(r.timeline.length,r.mediaSegments.length),go.log.warning("The number of items in the segment timeline and the number of ","segment URLs do not match, truncating",r.mediaSegments.length,"to",a));for(var s=[],o=r.startTime,u=function(a){var u=r.mediaSegments[a],l=i.resolveUris(n,[u.mediaUri]),c=o,d=void 0;null!=r.segmentDuration?d=c+r.segmentDuration:r.timeline?d=r.timeline[a].end:(window.asserts.assert(1==r.mediaSegments.length&&e,"There should be exactly one segment with a Period duration."),d=c+e);s.push(new SegmentReference(a+t,c,d,function(){return l},u.start,u.end)),o=d},l=0;l<a;l++)u(l);return s}},{key:"parseMediaSegments_",value:function(e){return[e.representation.segmentList,e.adaptationSet.segmentList,e.period.segmentList].filter(Functional.isNotNull).map(function(e){return XmlUtils.findChildren(e,"SegmentURL")}).reduce(function(e,t){return e.length>0?e:t}).map(function(t){t.getAttribute("indexRange")&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0,go.log.warning("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var n=t.getAttribute("media"),r=XmlUtils.parseAttr(t,"mediaRange",XmlUtils.parseRange,{start:0,end:null});return{mediaUri:n,start:r.start,end:r.end}})}}],(n=null)&&yo(t.prototype,n),r&&yo(t,r),e}();function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}_o.MediaSegment,_o.SegmentListInfo;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wo=window.shaka,Eo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createStream",value:function(t,n,r,i){window.asserts.assert(t.representation.segmentTemplate,"Should only be called with SegmentTemplate");var a=e.createInitSegment_(t),s=e.parseSegmentTemplateInfo_(t);e.checkSegmentTemplateInfo_(t,s);var o=null;if(s.indexTemplate)o=e.createFromIndexTemplate_(t,n,a,s);else if(s.segmentDuration)i||(t.presentationTimeline.notifyMaxSegmentDuration(s.segmentDuration),t.presentationTimeline.notifyMinSegmentStartTime(t.periodInfo.start)),o=e.createFromDuration_(t,s);else{var u=null,l=null;t.period.id&&t.representation.id&&(l=t.period.id+","+t.representation.id,u=r[l]);var c=e.createFromTimeline_(t,s),d=!t.dynamic||!t.periodInfo.isLastPeriod;if(u){if(d)new ur(c).fit(t.periodInfo.duration);u.merge(c);var h=t.presentationTimeline.getSegmentAvailabilityStart();u.evict(h-t.periodInfo.start)}else t.presentationTimeline.notifySegments(c,t.periodInfo.start),u=new ur(c),l&&t.dynamic&&(r[l]=u);d&&u.fit(t.periodInfo.duration),o={createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return u.find(e)},getSegmentReference:function(e){return u.get(e)}}}return{createSegmentIndex:o.createSegmentIndex,findSegmentPosition:o.findSegmentPosition,getSegmentReference:o.getSegmentReference,initSegmentReference:a,scaledPresentationTimeOffset:s.scaledPresentationTimeOffset}}},{key:"fromInheritance_",value:function(e){return e.segmentTemplate}},{key:"parseSegmentTemplateInfo_",value:function(t){var n=Zs.parseSegmentInfo(t,e.fromInheritance_),r=Zs.inheritAttribute(t,e.fromInheritance_,"media"),i=Zs.inheritAttribute(t,e.fromInheritance_,"index");return{segmentDuration:n.segmentDuration,timescale:n.timescale,startNumber:n.startNumber,scaledPresentationTimeOffset:n.scaledPresentationTimeOffset,unscaledPresentationTimeOffset:n.unscaledPresentationTimeOffset,timeline:n.timeline,mediaTemplate:r,indexTemplate:i}}},{key:"checkSegmentTemplateInfo_",value:function(e,t){var n=0;if(n+=t.indexTemplate?1:0,n+=t.timeline?1:0,0==(n+=t.segmentDuration?1:0))throw wo.log.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_NO_SEGMENT_INFO);if(1!=n&&(wo.log.warning("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.representation),t.indexTemplate?(wo.log.info("Using the index URL template by default."),t.timeline=null,t.segmentDuration=null):(window.asserts.assert(t.timeline,"There should be a timeline"),wo.log.info("Using the SegmentTimeline by default."),t.segmentDuration=null)),!t.indexTemplate&&!t.mediaTemplate)throw wo.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_NO_SEGMENT_INFO)}},{key:"createFromIndexTemplate_",value:function(e,t,n,r){var i=e.representation.mimeType.split("/")[1];if("mp4"!=i&&"webm"!=i)throw wo.log.error("SegmentTemplate specifies an unsupported container type.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_UNSUPPORTED_CONTAINER);if("webm"==i&&!n)throw wo.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.representation),new Error(Error.Severity.CRITICAL,Error.Category.MANIFEST,Error.Code.DASH_WEBM_MISSING_INIT);window.asserts.assert(r.indexTemplate,"must be using index template");var a=Zs.fillUriTemplate(r.indexTemplate,e.representation.id,null,e.bandwidth||null,null),s=ee.resolveUris(e.representation.baseUris,[a]);return vo.createSegmentIndexFromUris(e,t,n,s,0,null,i,r.scaledPresentationTimeOffset)}},{key:"createFromDuration_",value:function(e,t){window.asserts.assert(t.mediaTemplate,"There should be a media template with duration");var n=e.periodInfo.duration,r=t.segmentDuration,i=t.startNumber,a=t.timescale,s=t.mediaTemplate,o=e.bandwidth||null,u=e.representation.id,l=e.representation.baseUris;return{createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return e<0?null:n&&e>=n?null:Math.floor(e/r)},getSegmentReference:function(e){var t=e*r,c=t+r;if(n&&(c=Math.min(c,n)),c<0)return null;if(n&&t>=n)return null;return new ir(e,t,c,function(){var n=Zs.fillUriTemplate(s,u,e+i,o,t*a);return ee.resolveUris(l,[n])},0,null)}}}},{key:"createFromTimeline_",value:function(e,t){for(var n=[],r=function(r){var i=t.timeline[r].start,a=t.timeline[r].unscaledStart,s=t.timeline[r].end,o=r+t.startNumber,u=a+t.unscaledPresentationTimeOffset;n.push(new ir(o,i,s,function(){window.asserts.assert(t.mediaTemplate,"There should be a media template with a timeline");var n=Zs.fillUriTemplate(t.mediaTemplate,e.representation.id,o,e.bandwidth||null,u);return ee.resolveUris(e.representation.baseUris,[n]).map(function(e){return e.toString()})},0,null))},i=0;i<t.timeline.length;i++)r(i);return n}},{key:"createInitSegment_",value:function(t){var n=Zs.inheritAttribute(t,e.fromInheritance_,"initialization");if(!n)return null;var r=t.representation.id,i=t.bandwidth||null,a=t.representation.baseUris;return new rr(function(){window.asserts.assert(n,"Should have returned earler");var e=Zs.fillUriTemplate(n,r,null,i,null);return ee.resolveUris(a,[e])},0,null)}}],(n=null)&&bo(t.prototype,n),r&&bo(t,r),e}();function So(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Eo.SegmentTemplateInfo;
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var To=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operations_=[]}var t,n,r;return t=e,(n=[{key:"manage",value:function(e){var t=this;this.operations_.push(e.finally(function(){Fn.remove(t.operations_,e)}))}},{key:"destroy",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.operations_[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;s.promise.catch(function(){}),e.push(s.abort())}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return this.operations_=[],Promise.all(e)}}])&&So(t.prototype,n),r&&So(t,r),e}();function ko(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Co(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Io(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Co(a,r,i,s,o,"next",e)}function o(e){Co(a,r,i,s,o,"throw",e)}s(void 0)})}}function Ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xo=c.net.NetworkingEngine,Lo=new A,No=window.shaka,Ro=window.goog,Mo=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config_=null,this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,this.periodIds_=[],this.globalId_=1,this.segmentIndexMap_={},this.updatePeriod_=0,this.averageUpdateDuration_=new $e(5),this.updateTimer_=new ve(function(){t.onUpdate_()}),this.operationManager_=new To}var t,n,r;return t=e,n=[{key:"configure",value:function(e){window.asserts.assert(null!=e.dash,"DashManifestConfiguration should not be null!"),this.config_=e}},{key:"start",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"Must call configure() before start()!"),this.manifestUris_=[t],this.playerInterface_=n,e.next=5,this.requestManifest_();case 5:if(r=e.sent,this.playerInterface_&&this.setUpdateTimer_(r),this.playerInterface_){e.next=9;break}throw new A(Lo.severity.CRITICAL,Lo.category.PLAYER,Lo.code.OPERATION_ABORTED);case 9:return window.asserts.assert(this.manifest_,"Manifest should be non-null!"),e.abrupt("return",this.manifest_);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){return this.playerInterface_=null,this.config_=null,this.manifestUris_=[],this.manifest_=null,this.periodIds_=[],this.segmentIndexMap_={},null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.operationManager_.destroy()}},{key:"update",value:function(){var e=Io(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.requestManifest_();case 3:e.next=11;break;case 5:if(e.prev=5,e.t0=e.catch(0),this.playerInterface_&&e.t0){e.next=9;break}return e.abrupt("return");case 9:window.asserts.assert(e.t0 instanceof A,"Bad error type"),this.playerInterface_.onError(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"onExpirationUpdated",value:function(e,t){}},{key:"requestManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(){var t,n,r,i,a,s,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=xo.RequestType.MANIFEST,n=vt(this.manifestUris_,this.config_.retryParameters),r=this.playerInterface_.networkingEngine,i=Date.now(),a=r.request(t,n),this.operationManager_.manage(a),e.next=8,a.promise;case 8:if(s=e.sent,this.playerInterface_){e.next=11;break}return e.abrupt("return",0);case 11:return s.uri&&!this.manifestUris_.includes(s.uri)&&this.manifestUris_.unshift(s.uri),e.next=14,this.parseManifest_(s.data,s.uri);case 14:return o=Date.now(),u=(o-i)/1e3,this.averageUpdateDuration_.sample(1,u),e.abrupt("return",u);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Gs.parseXml(t,"MPD")){e.next=3;break}throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_INVALID_XML,n);case 3:return i=this.config_.dash.xlinkFailGracefully,a=Zs.processXlinks(r,this.config_.retryParameters,i,n,this.playerInterface_.networkingEngine),this.operationManager_.manage(a),e.next=8,a.promise;case 8:return s=e.sent,e.abrupt("return",this.processManifest_(s,n));case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"processManifest_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[n],(i=Gs.findChildren(t,"Location").map(Gs.getContents).filter(q.isNotNull)).length>0&&(a=ee.resolveUris(r,i),this.manifestUris_=a,r=a),s=Gs.findChildren(t,"BaseURL").map(Gs.getContents),o=ee.resolveUris(r,s),this.config_.dash.ignoreMinBufferTime||(u=Gs.parseAttr(t,"minBufferTime",Gs.parseDuration)),this.updatePeriod_=Gs.parseAttr(t,"minimumUpdatePeriod",Gs.parseDuration,-1),l=Gs.parseAttr(t,"availabilityStartTime",Gs.parseDate),c=Gs.parseAttr(t,"timeShiftBufferDepth",Gs.parseDuration),d=Gs.parseAttr(t,"suggestedPresentationDelay",Gs.parseDuration),h=Gs.parseAttr(t,"maxSegmentDuration",Gs.parseDuration),f=t.getAttribute("type")||"static",this.manifest_?p=this.manifest_.presentationTimeline:(m=Math.max(this.config_.dash.defaultPresentationDelay,1.5*u),p=new Jn(l,null!=d?d:m,this.config_.dash.autoCorrectDrift)),v={dynamic:"static"!=f,presentationTimeline:p,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1},y=this.parsePeriods_(v,o,t),g=y.duration,_=y.periods,p.setStatic("static"==f),"static"!=f&&y.durationDerivedFromPeriods||p.setDuration(g||1/0),p.isLive()&&!isNaN(this.config_.availabilityWindowOverride)&&(c=this.config_.availabilityWindowOverride),null==c&&(c=1/0),p.setSegmentAvailabilityDuration(c),p.notifyMaxSegmentDuration(h||1),Ro.DEBUG&&p.assertIsValid(),this.manifest_){e.next=36;break}if(this.manifest_={presentationTimeline:p,periods:_,offlineSessionIds:[],minBufferTime:u||0},!p.usingPresentationStartTime()){e.next=36;break}return b=Gs.findChildren(t,"UTCTiming"),e.next=32,this.parseUtcTiming_(o,b);case 32:if(w=e.sent,this.playerInterface_){e.next=35;break}return e.abrupt("return");case 35:p.setClockOffset(w);case 36:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"parsePeriods_",value:function(e,t,n){for(var r=Gs.parseAttr(n,"mediaPresentationDuration",Gs.parseDuration),i=[],a=0,s=Gs.findChildren(n,"Period"),o=0;o<s.length;o++){var u=s[o],l=Gs.parseAttr(u,"start",Gs.parseDuration,a),c=Gs.parseAttr(u,"duration",Gs.parseDuration),d=null;if(o!=s.length-1){var h=s[o+1],f=Gs.parseAttr(h,"start",Gs.parseDuration);null!=f&&(d=f-l)}else null!=r&&(d=r-l);var p=ee.GAP_OVERLAP_TOLERANCE_SECONDS;d&&c&&Math.abs(d-c)>p&&No.log.warning("There is a gap/overlap between Periods",u),null==d&&(d=c);var m={start:l,duration:d,node:u,isLastPeriod:null==d||o==s.length-1},v=this.parsePeriod_(e,t,m);i.push(v);var y=e.period.id;if(window.asserts.assert(y,"Period IDs should not be null!"),this.periodIds_.includes(y)||(this.periodIds_.push(y),this.manifest_&&(this.playerInterface_.filterNewPeriod(v),this.manifest_.periods.push(v))),null==d){o!=s.length-1&&No.log.warning("Skipping Period",o+1,"and any subsequent Periods:","Period",o+1,"does not have a valid start time.",i[o+1]),a=null;break}a=l+d}return null==this.manifest_&&this.playerInterface_.filterAllPeriods(i),null!=r?(a!=r&&No.log.warning("@mediaPresentationDuration does not match the total duration of ","all Periods."),{periods:i,duration:r,durationDerivedFromPeriods:!1}):{periods:i,duration:a,durationDerivedFromPeriods:!0}}},{key:"parsePeriod_",value:function(e,t,n){var r=this,i=ee.ContentType;e.period=this.createFrame_(n.node,null,t),e.periodInfo=n,e.period.id||(No.log.info("No Period ID given for Period with start time "+n.start+",  Assigning a default"),e.period.id="__shaka_period_"+n.start);var a=Gs.findChildren(n.node,"EventStream"),s=!0,o=!1,u=void 0;try{for(var l,c=a[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;this.parseEventStream_(n.start,n.duration,d)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}var h=Gs.findChildren(n.node,"AdaptationSet").map(function(t){return r.parseAdaptationSet_(e,t)}).filter(q.isNotNull);if(e.dynamic){var f=[],p=!0,m=!1,v=void 0;try{for(var y,g=h[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value,b=!0,w=!1,E=void 0;try{for(var S,T=_.representationIds[Symbol.iterator]();!(b=(S=T.next()).done);b=!0){var k=S.value;f.push(k)}}catch(e){w=!0,E=e}finally{try{b||null==T.return||T.return()}finally{if(w)throw E}}}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}var C=new Set(f);if(f.length!=C.size)throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_DUPLICATE_REPRESENTATION_ID)}var I=h.filter(function(e){return!e.trickModeFor}),x=h.filter(function(e){return e.trickModeFor}),L=!0,N=!1,R=void 0;try{for(var M,P=x[Symbol.iterator]();!(L=(M=P.next()).done);L=!0){var O=M.value,D=O.streams[0],U=O.trickModeFor,F=!0,B=!1,V=void 0;try{for(var j,H=I[Symbol.iterator]();!(F=(j=H.next()).done);F=!0){var K=j.value;if(K.id==U){var G=!0,W=!1,z=void 0;try{for(var Y,X=K.streams[Symbol.iterator]();!(G=(Y=X.next()).done);G=!0){Y.value.trickModeVideo=D}}catch(e){W=!0,z=e}finally{try{G||null==X.return||X.return()}finally{if(W)throw z}}}}}catch(e){B=!0,V=e}finally{try{F||null==H.return||H.return()}finally{if(B)throw V}}}}catch(e){N=!0,R=e}finally{try{L||null==P.return||P.return()}finally{if(N)throw R}}var $=this.getSetsOfType_(I,i.VIDEO),Q=this.getSetsOfType_(I,i.AUDIO);if(!$.length&&!Q.length)throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_EMPTY_PERIOD);Q.length||(Q=[null]),$.length||($=[null]);var Z=[],J=!0,te=!1,ne=void 0;try{for(var re,ie=Q[Symbol.iterator]();!(J=(re=ie.next()).done);J=!0){var ae=re.value,se=!0,oe=!1,ue=void 0;try{for(var le,ce=$[Symbol.iterator]();!(se=(le=ce.next()).done);se=!0){var de=le.value;this.createVariants_(ae,de,Z)}}catch(e){oe=!0,ue=e}finally{try{se||null==ce.return||ce.return()}finally{if(oe)throw ue}}}}catch(e){te=!0,ne=e}finally{try{J||null==ie.return||ie.return()}finally{if(te)throw ne}}var he=this.getSetsOfType_(I,i.TEXT),fe=[],pe=!0,me=!1,ve=void 0;try{for(var ye,ge=he[Symbol.iterator]();!(pe=(ye=ge.next()).done);pe=!0){var _e=ye.value;fe.push.apply(fe,ko(_e.streams))}}catch(e){me=!0,ve=e}finally{try{pe||null==ge.return||ge.return()}finally{if(me)throw ve}}return{startTime:n.start,textStreams:fe,variants:Z}}},{key:"getSetsOfType_",value:function(e,t){return e.filter(function(e){return e.contentType==t})}},{key:"createVariants_",value:function(e,t,n){var r,i,a=ee.ContentType;if(window.asserts.assert(!e||e.contentType==a.AUDIO,"Audio parameter mismatch!"),window.asserts.assert(!t||t.contentType==a.VIDEO,"Video parameter mismatch!"),e||t)if(e&&t){if(Tt.areDrmCompatible(e.drmInfos,t.drmInfos)){var s=Tt.getCommonDrmInfos(e.drmInfos,t.drmInfos),o=!0,u=!1,l=void 0;try{for(var c,d=e.streams[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=!0,p=!1,m=void 0;try{for(var v,y=t.streams[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;r=(g.bandwidth||0)+(h.bandwidth||0),i={id:this.globalId_++,language:e.language,primary:e.main||t.main,audio:h,video:g,bandwidth:r,drmInfos:s,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}}else{var _=e||t,b=!0,w=!1,E=void 0;try{for(var S,T=_.streams[Symbol.iterator]();!(b=(S=T.next()).done);b=!0){var k=S.value;r=k.bandwidth||0,i={id:this.globalId_++,language:_.language||"und",primary:_.main,audio:e?k:null,video:t?k:null,bandwidth:r,drmInfos:_.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},n.push(i)}}catch(e){w=!0,E=e}finally{try{b||null==T.return||T.return()}finally{if(w)throw E}}}}},{key:"parseAdaptationSet_",value:function(t,n){var r=this,i=ee.ContentType;t.adaptationSet=this.createFrame_(n,t.period,null);var a=!1,s=Gs.findChildren(n,"Role"),o=s.map(function(e){return e.getAttribute("value")}).filter(q.isNotNull),u=void 0,l=t.adaptationSet.contentType==i.TEXT;l&&(u=ee.TextStreamKind.SUBTITLE);var c=!0,d=!1,h=void 0;try{for(var f,p=s[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value,v=m.getAttribute("schemeIdUri");if(null==v||"urn:mpeg:dash:role:2011"==v){var y=m.getAttribute("value");switch(y){case"main":a=!0;break;case"caption":case"subtitle":u=y}}}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var g=Gs.findChildren(n,"EssentialProperty"),_=null,b=!1,w=!0,E=!1,S=void 0;try{for(var T,k=g[Symbol.iterator]();!(w=(T=k.next()).done);w=!0){var C=T.value;"http://dashif.org/guidelines/trickmode"==C.getAttribute("schemeIdUri")?_=C.getAttribute("value"):b=!0}}catch(e){E=!0,S=e}finally{try{w||null==k.return||k.return()}finally{if(E)throw S}}var I=Gs.findChildren(n,"Accessibility"),x=new Map,L=!0,N=!1,R=void 0;try{for(var M,P=I[Symbol.iterator]();!(L=(M=P.next()).done);L=!0){var O=M.value,D=O.getAttribute("schemeIdUri");if("urn:scte:dash:cc:cea-608:2015"==D||"urn:scte:dash:cc:cea-708:2015"==D){var U=1,F=O.getAttribute("value");if(null!=F){var B=!0,V=!1,j=void 0;try{for(var H,K=F.split(";")[Symbol.iterator]();!(B=(H=K.next()).done);B=!0){var G=H.value,W=void 0,z=void 0;if(G.includes("=")){var Y=G.split("=");W=Y[0].startsWith("CC")?Y[0]:"CC"+Y[0],z=Y[1].split(",")[0].split(":").pop()}else W="CC"+U,U+=2,z=G;x.set(W,ne.normalize(z))}}catch(e){V=!0,j=e}finally{try{B||null==K.return||K.return()}finally{if(V)throw j}}}else x.set("CC1","und")}}}catch(e){N=!0,R=e}finally{try{L||null==P.return||P.return()}finally{if(N)throw R}}if(b)return null;var X=Gs.findChildren(n,"ContentProtection"),$=Ys.parseFromAdaptationSet(X,this.config_.dash.customScheme,this.config_.dash.ignoreDrmInfo),Q=ne.normalize(n.getAttribute("lang")||"und"),Z=n.getAttribute("label"),J=Gs.findChildren(n,"Representation"),te=J.map(function(e){return r.parseRepresentation_(t,$,u,Q,Z,a,o,x,e)}).filter(function(e){return!!e});if(0==te.length){if(l)return null;throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.DASH_EMPTY_ADAPTATION_SET)}if(!t.adaptationSet.contentType||t.adaptationSet.contentType==i.APPLICATION){var re=te[0].mimeType,ie=te[0].codecs;t.adaptationSet.contentType=e.guessContentType_(re,ie);var ae=!0,se=!1,oe=void 0;try{for(var ue,le=te[Symbol.iterator]();!(ae=(ue=le.next()).done);ae=!0){ue.value.type=t.adaptationSet.contentType}}catch(e){se=!0,oe=e}finally{try{ae||null==le.return||le.return()}finally{if(se)throw oe}}}var ce=!0,de=!1,he=void 0;try{for(var fe,pe=te[Symbol.iterator]();!(ce=(fe=pe.next()).done);ce=!0){var me=fe.value,ve=!0,ye=!1,ge=void 0;try{for(var _e,be=$.drmInfos[Symbol.iterator]();!(ve=(_e=be.next()).done);ve=!0){var we=_e.value;me.keyId&&we.keyIds.push(me.keyId)}}catch(e){ye=!0,ge=e}finally{try{ve||null==be.return||be.return()}finally{if(ye)throw ge}}}}catch(e){de=!0,he=e}finally{try{ce||null==pe.return||pe.return()}finally{if(de)throw he}}var Ee=J.map(function(e){return e.getAttribute("id")}).filter(q.isNotNull);return{id:t.adaptationSet.id||"__fake__"+this.globalId_++,contentType:t.adaptationSet.contentType,language:Q,main:a,streams:te,drmInfos:$.drmInfos,trickModeFor:_,representationIds:Ee}}},{key:"parseRepresentation_",value:function(e,t,n,r,i,a,s,o,u){var l,c=this,d=ee.ContentType;if(e.representation=this.createFrame_(u,e.adaptationSet,null),!this.verifyRepresentation_(e.representation))return No.log.warning("Skipping Representation",e.representation),null;e.bandwidth=Gs.parseAttr(u,"bandwidth",Gs.parsePositiveInt)||0;var h=e.representation.contentType,f=h==d.TEXT||h==d.APPLICATION;try{var p=function(e,t,n){return c.requestInitSegment_(e,t,n)};if(e.representation.segmentBase)l=vo.createStream(e,p);else if(e.representation.segmentList)l=_o.createStream(e,this.segmentIndexMap_);else if(e.representation.segmentTemplate){var m=!!this.manifest_;l=Eo.createStream(e,p,this.segmentIndexMap_,m)}else{window.asserts.assert(f,"Must have Segment* with non-text streams.");var v=e.representation.baseUris,y=e.periodInfo.duration||0;l={createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return e>=0&&e<y?1:null},getSegmentReference:function(e){return 1!=e?null:new ir(1,0,y,function(){return v},0,null)},initSegmentReference:null,scaledPresentationTimeOffset:0}}}catch(e){if(f&&e.code==A.Code.DASH_NO_SEGMENT_INFO)return null;throw e}var g=Gs.findChildren(u,"ContentProtection"),_=Ys.parseFromRepresentation(g,this.config_.dash.customScheme,t,this.config_.dash.ignoreDrmInfo);return{id:this.globalId_++,originalId:e.representation.id,createSegmentIndex:l.createSegmentIndex,findSegmentPosition:l.findSegmentPosition,getSegmentReference:l.getSegmentReference,initSegmentReference:l.initSegmentReference,presentationTimeOffset:l.scaledPresentationTimeOffset,mimeType:e.representation.mimeType,codecs:e.representation.codecs,frameRate:e.representation.frameRate,bandwidth:e.bandwidth,width:e.representation.width,height:e.representation.height,kind:n,encrypted:t.drmInfos.length>0,keyId:_,language:r,label:i,type:e.adaptationSet.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.representation.emsgSchemeIdUris,roles:s,channelsCount:e.representation.numChannels,closedCaptions:o}}},{key:"onUpdate_",value:function(){var e=Io(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.updatePeriod_>=0,"There should be an update period"),No.log.info("Updating manifest..."),t=0,e.prev=3,e.next=6,this.requestManifest_();case 6:t=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),window.asserts.assert(e.t0 instanceof A,"Should only receive a Shaka error"),this.playerInterface_&&(e.t0.severity=A.Severity.RECOVERABLE,this.playerInterface_.onError(e.t0));case 13:if(this.playerInterface_){e.next=15;break}return e.abrupt("return");case 15:this.setUpdateTimer_(t);case 16:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"setUpdateTimer_",value:function(t){if(!(this.updatePeriod_<0)){var n=Math.max(e.MIN_UPDATE_PERIOD_,this.updatePeriod_-t,this.averageUpdateDuration_.getEstimate());this.updateTimer_.tickAfter(n)}}},{key:"createFrame_",value:function(t,n,r){window.asserts.assert(n||r,"Must provide either parent or baseUris"),n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,numChannels:null},r=r||n.baseUris;var i=Gs.parseNonNegativeInt,a=Gs.evalDivision,s=Gs.findChildren(t,"BaseURL").map(Gs.getContents),o=t.getAttribute("contentType")||n.contentType,u=t.getAttribute("mimeType")||n.mimeType,l=t.getAttribute("codecs")||n.codecs,c=Gs.parseAttr(t,"frameRate",a)||n.frameRate,d=this.emsgSchemeIdUris_(Gs.findChildren(t,"InbandEventStream"),n.emsgSchemeIdUris),h=Gs.findChildren(t,"AudioChannelConfiguration"),f=this.parseAudioChannels_(h)||n.numChannels;return o||(o=e.guessContentType_(u,l)),{baseUris:ee.resolveUris(r,s),segmentBase:Gs.findChild(t,"SegmentBase")||n.segmentBase,segmentList:Gs.findChild(t,"SegmentList")||n.segmentList,segmentTemplate:Gs.findChild(t,"SegmentTemplate")||n.segmentTemplate,width:Gs.parseAttr(t,"width",i)||n.width,height:Gs.parseAttr(t,"height",i)||n.height,contentType:o,mimeType:u,codecs:l,frameRate:c,emsgSchemeIdUris:d,id:t.getAttribute("id"),numChannels:f}}},{key:"emsgSchemeIdUris_",value:function(e,t){var n=t.slice(),r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value.getAttribute("schemeIdUri");n.includes(u)||n.push(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"parseAudioChannels_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s.getAttribute("schemeIdUri");if(o){var u=s.getAttribute("value");if(u)switch(o){case"urn:mpeg:dash:outputChannelPositionList:2012":return u.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var l=parseInt(u,10);if(!l){No.log.warning("Channel parsing failure! Ignoring scheme and value",o,u);continue}return l;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":var c=parseInt(u,16);if(!c){No.log.warning("Channel parsing failure! Ignoring scheme and value",o,u);continue}for(var d=0;c;)1&c&&++d,c>>=1;return d;default:No.log.warning("Unrecognized audio channel scheme:",o,u);continue}}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"verifyRepresentation_",value:function(e){var t=ee.ContentType,n=0;return n+=e.segmentBase?1:0,n+=e.segmentList?1:0,0==(n+=e.segmentTemplate?1:0)?e.contentType==t.TEXT||e.contentType==t.APPLICATION||(No.log.warning("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1):(1!=n&&(No.log.warning("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.segmentBase?(No.log.info("Using SegmentBase by default."),e.segmentList=null,e.segmentTemplate=null):(window.asserts.assert(e.segmentList,"There should be a SegmentList"),No.log.info("Using SegmentList by default."),e.segmentTemplate=null)),!0)}},{key:"requestForTiming_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,u,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ee.resolveUris(t,[n]),(a=vt(i,this.config_.retryParameters)).method=r,s=xo.RequestType.TIMING,o=this.playerInterface_.networkingEngine.request(s,a),this.operationManager_.manage(o),e.next=8,o.promise;case 8:if(u=e.sent,"HEAD"!=r){e.next=16;break}if(u.headers&&u.headers.date){e.next=13;break}return No.log.warning("UTC timing response is missing","expected date header"),e.abrupt("return",0);case 13:l=u.headers.date,e.next=17;break;case 16:l=ft.fromUTF8(u.data);case 17:if(c=Date.parse(l),!isNaN(c)){e.next=21;break}return No.log.warning("Unable to parse date from UTC timing response"),e.abrupt("return",0);case 21:return e.abrupt("return",c-Date.now());case 22:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"parseUtcTiming_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}),i=this.config_.dash.clockSyncUri,!r.length&&i&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),a=!0,s=!1,o=void 0,e.prev=6,u=r[Symbol.iterator]();case 8:if(a=(l=u.next()).done){e.next=36;break}c=l.value,e.prev=10,d=c.scheme,h=c.value,e.t0=d,e.next="urn:mpeg:dash:utc:http-head:2014"===e.t0?16:"urn:mpeg:dash:utc:http-head:2012"===e.t0?16:"urn:mpeg:dash:utc:http-xsdate:2014"===e.t0?19:"urn:mpeg:dash:utc:http-iso:2014"===e.t0?19:"urn:mpeg:dash:utc:http-xsdate:2012"===e.t0?19:"urn:mpeg:dash:utc:http-iso:2012"===e.t0?19:"urn:mpeg:dash:utc:direct:2014"===e.t0?22:"urn:mpeg:dash:utc:direct:2012"===e.t0?22:"urn:mpeg:dash:utc:http-ntp:2014"===e.t0?24:"urn:mpeg:dash:utc:ntp:2014"===e.t0?24:"urn:mpeg:dash:utc:sntp:2014"===e.t0?24:26;break;case 16:return e.next=18,this.requestForTiming_(t,h,"HEAD");case 18:return e.abrupt("return",e.sent);case 19:return e.next=21,this.requestForTiming_(t,h,"GET");case 21:return e.abrupt("return",e.sent);case 22:return f=Date.parse(h),e.abrupt("return",isNaN(f)?0:f-Date.now());case 24:return No.log.alwaysWarn("NTP UTCTiming scheme is not supported"),e.abrupt("break",28);case 26:return No.log.alwaysWarn("Unrecognized scheme in UTCTiming element",d),e.abrupt("break",28);case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(10),No.log.warning("Error fetching time from UTCTiming elem",e.t1.message);case 33:a=!0,e.next=8;break;case 36:e.next=42;break;case 38:e.prev=38,e.t2=e.catch(6),s=!0,o=e.t2;case 42:e.prev=42,e.prev=43,a||null==u.return||u.return();case 45:if(e.prev=45,!s){e.next=48;break}throw o;case 48:return e.finish(45);case 49:return e.finish(42);case 50:return No.log.alwaysWarn("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),e.abrupt("return",0);case 52:case"end":return e.stop()}},e,this,[[6,38,42,50],[10,30],[43,,45,49]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"parseEventStream_",value:function(e,t,n){var r=Gs.parseNonNegativeInt,i=n.getAttribute("schemeIdUri")||"",a=n.getAttribute("value")||"",s=Gs.parseAttr(n,"timescale",r)||1,o=!0,u=!1,l=void 0;try{for(var c,d=Gs.findChildren(n,"Event")[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,f=Gs.parseAttr(h,"presentationTime",r)||0,p=Gs.parseAttr(h,"duration",r)||0,m=f/s+e,v=m+p/s;null!=t&&(m=Math.min(m,e+t),v=Math.min(v,e+t));var y={schemeIdUri:i,value:a,startTime:m,endTime:v,id:h.getAttribute("id")||"",eventElement:h};this.playerInterface_.onTimelineRegionAdded(y)}}catch(e){u=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}},{key:"requestInitSegment_",value:function(){var e=Io(regeneratorRuntime.mark(function e(t,n,r){var i,a,s,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=xo.RequestType.SEGMENT,a=Sr.createSegmentRequest(t,n,r,this.config_.retryParameters),s=this.playerInterface_.networkingEngine,o=s.request(i,a),this.operationManager_.manage(o),e.next=7,o.promise;case 7:return u=e.sent,e.abrupt("return",u.data);case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}],r=[{key:"guessContentType_",value:function(e,t){var n=st.getFullType(e,t);return Ht.isTypeSupported(n)?ee.ContentType.TEXT:e.split("/")[0]}}],n&&Ao(t.prototype,n),r&&Ao(t,r),e}();function Po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mo.MIN_UPDATE_PERIOD_=3,Mo.RequestInitSegmentCallback={},Mo.InheritanceFrame={},Mo.Context={},Mo.PeriodInfo={},Mo.AdaptationInfo={},Mo.SegmentIndexFunctions={},Mo.StreamInfo={},Tn.registerParserByExtension("mpd",Mo),Tn.registerParserByMime("application/dash+xml",Mo);window.shaka,window.goog;var Do=function e(t,n,r,i){Oo(this,e),this.absoluteUri=t,this.type=n,this.tags=r,this.segments=i||null},Uo=0,Fo=1,Bo=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Oo(this,e),this.id=t,this.name=n,this.attributes=r,this.value=i}var t,n,r;return t=e,(n=[{key:"toString",value:function(){var e="#"+this.name,t=this.attributes?this.attributes.map(function(e){var t=isNaN(Number(e.value))?'"'+e.value+'"':e.value;return e.name+"="+t}):[];return this.value&&t.unshift(this.value),t.length>0&&(e+=":"+t.join(",")),e}},{key:"addAttribute",value:function(e){this.attributes.push(e)}},{key:"getAttribute",value:function(e){var t=this.attributes.filter(function(t){return t.name==e});return window.asserts.assert(t.length<2,"A tag should not have multiple attributes with the same name!"),t.length?t[0]:null}},{key:"getAttributeValue",value:function(e,t){var n=this.getAttribute(e);return n?n.value:t||null}}])&&Po(t.prototype,n),r&&Po(t,r),e}(),Vo=function e(t,n){Oo(this,e),this.name=t,this.value=n},jo=function e(t,n){Oo(this,e),this.tags=n,this.absoluteUri=t};function Ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Ko=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"filterTagsByName",value:function(e,t){return e.filter(function(e){return e.name==t})}},{key:"getFirstTagWithName",value:function(t,n){var r=e.filterTagsByName(t,n);return r.length?r[0]:null}},{key:"findMediaTags",value:function(e,t,n){return e.filter(function(e){var r=e.getAttribute("TYPE"),i=e.getAttribute("GROUP-ID");return r.value==t&&i.value==n})}},{key:"constructAbsoluteUri",value:function(e,t){return ee.resolveUris([e],[t])[0]}},{key:"isComment",value:function(e){return/^#(?!EXT)/m.test(e)}}],(n=null)&&Ho(t.prototype,n),r&&Ho(t,r),e}();function Go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var Wo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data_=t,this.position_=0}var t,n,r;return t=e,(n=[{key:"atEnd",value:function(){return this.position_==this.data_.length}},{key:"readLine",value:function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)}},{key:"readWord",value:function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)}},{key:"skipWhitespace",value:function(){this.readRegex(/[ \t]+/gm)}},{key:"readRegex",value:function(e){var t=this.indexOf_(e);return this.atEnd()||null==t||t.position!=this.position_?null:(this.position_+=t.length,t.results)}},{key:"readRegexReturnCapture_",value:function(e,t){if(this.atEnd())return null;var n=this.readRegex(e);return n?n[t]:null}},{key:"indexOf_",value:function(e){window.asserts.assert(e.global,"global flag should be set"),e.lastIndex=this.position_;var t=e.exec(this.data_);return null==t?null:{position:t.index,length:t[0].length,results:t}}}])&&Go(t.prototype,n),r&&Go(t,r),e}();function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var zo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalId_=0}var t,n,r;return t=e,r=[{key:"parseTag",value:function(e,t){var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.INVALID_HLS_TAG,t);var r,i=n[1],a=n[2],s=[];if(a){var o,u=new Wo(a),l=u.readRegex(/^([^,=]+)(?:,|$)/g);l&&(r=l[1]);for(var c=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=u.readRegex(c);){var d=o[1],h=o[2]||o[3],f=new Vo(d,h);s.push(f)}}return new Bo(e,i,s,r)}}],(n=[{key:"parsePlaylist",value:function(t,n){var r=e.MEDIA_PLAYLIST_TAGS,i=e.SEGMENT_TAGS,a=ft.fromUTF8(t),s=(a=a.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(s[0]))throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.HLS_PLAYLIST_HEADER_MISSING);for(var o=Uo,u=1;u<s.length;u++)if(!Ko.isComment(s[u])){var l=this.parseTag_(s[u]);if(this.globalId_-=1,r.includes(l.name)){o=Fo;break}"EXT-X-STREAM-INF"==l.name&&(u+=1)}for(var c=[],d=1;d<s.length;)if(Ko.isComment(s[d]))d+=1;else{var h=this.parseTag_(s[d]);if(i.includes(h.name)){if(o!=Fo)throw new A(A.Severity.CRITICAL,A.Category.MANIFEST,A.Code.HLS_INVALID_PLAYLIST_HIERARCHY);var f=s.splice(d,s.length-d),p=this.parseSegments_(n,f,c);return new Do(n,o,c,p)}if(c.push(h),d+=1,"EXT-X-STREAM-INF"==h.name){var m=new Vo("URI",s[d]);h.addAttribute(m),d+=1}}return new Do(n,o,c)}},{key:"parseSegments_",value:function(t,n,r){var i=[],a=[],s=!0,o=!1,u=void 0;try{for(var l,c=n[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;if(/^(#EXT)/.test(d)){var h=this.parseTag_(d);e.MEDIA_PLAYLIST_TAGS.includes(h.name)?r.push(h):a.push(h)}else if(Ko.isComment(d));else{var f=d.trim(),p=Ko.constructAbsoluteUri(t,f),m=new jo(p,a);i.push(m),a=[]}}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}return i}},{key:"parseTag_",value:function(t){return e.parseTag(this.globalId_++,t)}}])&&qo(t.prototype,n),r&&qo(t,r),e}();function Yo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xo(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function $o(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Xo(a,r,i,s,o,"next",e)}function o(e){Xo(a,r,i,s,o,"throw",e)}s(void 0)})}}function Qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}zo.MEDIA_PLAYLIST_TAGS=["EXT-X-TARGETDURATION","EXT-X-MEDIA-SEQUENCE","EXT-X-DISCONTINUITY-SEQUENCE","EXT-X-PLAYLIST-TYPE","EXT-X-MAP","EXT-X-I-FRAMES-ONLY","EXT-X-ENDLIST"],zo.SEGMENT_TAGS=["EXTINF","EXT-X-BYTERANGE","EXT-X-DISCONTINUITY","EXT-X-PROGRAM-DATE-TIME","EXT-X-KEY","EXT-X-DATERANGE"];
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Zo=c.net.NetworkingEngine,Jo=c.net.DataUriPlugin,eu=new A,tu=window.shaka,nu=(window.goog,function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playerInterface_=null,this.config_=null,this.globalId_=1,this.mediaTagsToStreamInfosMap_=new Map,this.variantUriSet_=new Set,this.uriToStreamInfosMap_=new Map,this.presentationTimeline_=null,this.masterPlaylistUri_="",this.manifestTextParser_=new zo,this.updatePlaylistDelay_=0,this.updatePlaylistTimer_=new ve(function(){t.onUpdate_()}),this.presentationType_=e.PresentationType_.VOD,this.manifest_=null,this.maxTargetDuration_=0,this.minTargetDuration_=1/0,this.operationManager_=new To,this.segmentsToNotifyByStream_=[],this.groupIdToClosedCaptionsMap_=new Map,this.aesEncrypted_=!1}var t,n,r;return t=e,n=[{key:"configure",value:function(e){this.config_=e}},{key:"start",value:function(){var e=$o(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.config_,"Must call configure() before start()!"),this.playerInterface_=n,e.next=4,this.requestManifest_(t);case 4:return r=e.sent,this.masterPlaylistUri_=r.uri,window.asserts.assert(r.data,"Response data should be non-null!"),e.next=9,this.parseManifest_(r.data);case 9:return(i=this.updatePlaylistDelay_)>0&&this.updatePlaylistTimer_.tickAfter(i),window.asserts.assert(this.manifest_,"Manifest should be non-null"),e.abrupt("return",this.manifest_);case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.updatePlaylistTimer_&&(this.updatePlaylistTimer_.stop(),this.updatePlaylistTimer_=null);var e=[];return this.operationManager_&&(e.push(this.operationManager_.destroy()),this.operationManager_=null),this.playerInterface_=null,this.config_=null,this.mediaTagsToStreamInfosMap_.clear(),this.variantUriSet_.clear(),this.uriToStreamInfosMap_.clear(),this.manifest_=null,Promise.all(e)}},{key:"update",value:function(){if(!this.isLive_())return Promise.resolve();var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.push(this.updateStream_(s))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return Promise.all(e)}},{key:"updateStream_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.PresentationType_,i=n.absoluteMediaPlaylistUri,t.next=4,this.requestManifest_(i);case 4:if(a=t.sent,(s=this.manifestTextParser_.parsePlaylist(a.data,a.uri)).type==Fo){t.next=8;break}throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_INVALID_PLAYLIST_HIERARCHY);case 8:return o=Ko.getFirstTagWithName(s.tags,"EXT-X-MEDIA-SEQUENCE"),u=o?Number(o.value):0,l=n.stream,t.next=13,this.createSegments_(n.verbatimMediaPlaylistUri,s,u,l.mimeType,l.codecs);case 13:c=t.sent,n.segmentIndex.replace(c),d=c[c.length-1],window.asserts.assert(d,"Should have segments!"),Ko.getFirstTagWithName(s.tags,"EXT-X-ENDLIST")&&(this.setPresentationType_(r.VOD),this.presentationTimeline_.setDuration(d.endTime));case 19:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onExpirationUpdated",value:function(e,t){}},{key:"parseManifest_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,E,S,T,k,C,I,x,L,N;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert(this.masterPlaylistUri_,"Master playlist URI must be set before calling parseManifest_!"),(r=this.manifestTextParser_.parsePlaylist(n,this.masterPlaylistUri_)).type==Uo){t.next=4;break}throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_MASTER_PLAYLIST_NOT_PROVIDED);case 4:return t.next=6,this.createPeriod_(r);case 6:if(i=t.sent,this.playerInterface_){t.next=9;break}throw new A(eu.severity.CRITICAL,eu.category.PLAYER,eu.code.OPERATION_ABORTED);case 9:if(!this.aesEncrypted_||0!=i.variants.length){t.next=12;break}throw tu.log.info("No stream is created, because we don't support AES-128","encryption yet"),new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_AES_128_ENCRYPTION_NOT_SUPPORTED);case 12:for(this.playerInterface_.filterAllPeriods([i]),a=1/0,s=0,o=0,u=1/0,l=!0,c=!1,d=void 0,t.prev=20,h=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(l=(f=h.next()).done);l=!0)p=f.value,a=Math.min(a,p.minTimestamp),s=Math.max(s,p.minTimestamp),o=Math.max(o,p.maxTimestamp),"text"!=p.stream.type&&(u=Math.min(u,p.duration));t.next=28;break;case 24:t.prev=24,t.t0=t.catch(20),c=!0,d=t.t0;case 28:t.prev=28,t.prev=29,l||null==h.return||h.return();case 31:if(t.prev=31,!c){t.next=34;break}throw d;case 34:return t.finish(31);case 35:return t.finish(28);case 36:if(window.asserts.assert(null==this.presentationTimeline_,"Presentation timeline created early!"),this.createPresentationTimeline_(o),window.asserts.assert(this.presentationTimeline_,"Presentation timeline not created!"),!this.isLive_()){t.next=69;break}for(this.updatePlaylistDelay_=this.minTargetDuration_,m=e.PresentationType_,this.presentationType_==m.LIVE&&(v=this.presentationTimeline_.getDelay(),isNaN(this.config_.availabilityWindowOverride)||(v=this.config_.availabilityWindowOverride),this.presentationTimeline_.setSegmentAvailabilityDuration(v)),y=e.TS_ROLLOVER_/e.TS_TIMESCALE_,g=0;s>=y;)g+=y,s-=y;if(!g){t.next=67;break}for(tu.log.debug("Offsetting live streams by",g,"to compensate for rollover"),_=!0,b=!1,w=void 0,t.prev=51,E=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(_=(S=E.next()).done);_=!0)(T=S.value).minTimestamp<y?(tu.log.v1("Offset applied to",T.stream.type),T.stream.presentationTimeOffset=-g,T.segmentIndex.offset(g)):tu.log.v1("Offset NOT applied to",T.stream.type);t.next=59;break;case 55:t.prev=55,t.t1=t.catch(51),b=!0,w=t.t1;case 59:t.prev=59,t.prev=60,_||null==E.return||E.return();case 62:if(t.prev=62,!b){t.next=65;break}throw w;case 65:return t.finish(62);case 66:return t.finish(59);case 67:t.next=90;break;case 69:for(this.presentationTimeline_.setDuration(u),this.presentationTimeline_.offset(-a),k=!0,C=!1,I=void 0,t.prev=74,x=this.uriToStreamInfosMap_.values()[Symbol.iterator]();!(k=(L=x.next()).done);k=!0)(N=L.value).stream.presentationTimeOffset=a,N.segmentIndex.offset(-a),N.segmentIndex.fit(u);t.next=82;break;case 78:t.prev=78,t.t2=t.catch(74),C=!0,I=t.t2;case 82:t.prev=82,t.prev=83,k||null==x.return||x.return();case 85:if(t.prev=85,!C){t.next=88;break}throw I;case 88:return t.finish(85);case 89:return t.finish(82);case 90:this.manifest_={presentationTimeline:this.presentationTimeline_,periods:[i],offlineSessionIds:[],minBufferTime:0};case 91:case"end":return t.stop()}},t,this,[[20,24,28,36],[29,,31,35],[51,55,59,67],[60,,62,66],[74,78,82,90],[83,,85,89]])}));return function(e){return t.apply(this,arguments)}}()},{key:"createPeriod_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n){var r,i,a,s,o,u,l,c,d,h,f=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.tags,i=Ko.filterTagsByName(n.tags,"EXT-X-MEDIA"),a=i.filter(function(t){return"SUBTITLES"==e.getRequiredAttributeValue_(t,"TYPE")}),s=a.map(function(e){return f.createTextStream_(e,n)}),o=i.filter(function(t){return"CLOSED-CAPTIONS"==e.getRequiredAttributeValue_(t,"TYPE")}),this.parseClosedCaptions_(o),t.next=8,Promise.all(s);case 8:return u=t.sent,l=Ko.filterTagsByName(r,"EXT-X-STREAM-INF"),c=l.map(function(e){return f.createVariantsForTag_(e,n)}),t.next=13,Promise.all(c);case 13:return d=t.sent,h=(h=d.reduce(q.collapseArrays,[])).filter(function(e){return null!=e}),t.abrupt("return",{startTime:0,variants:h,textStreams:u});case 17:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createVariantsForTag_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,u,l,c,d,h,f,p,m,v,y,g,_,b,w,E,S,T,k,C,I,A,x=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert("EXT-X-STREAM-INF"==n.name,"Should only be called on variant tags!"),i=ee.ContentType,"avc1.42E01E,mp4a.40.2",a=n.getAttributeValue("CODECS","avc1.42E01E,mp4a.40.2"),s=e.filterDuplicateCodecs_(a.split(/\s*,\s*/)),o=n.getAttribute("RESOLUTION"),u=null,l=null,c=n.getAttributeValue("FRAME-RATE"),d=Number(e.getRequiredAttributeValue_(n,"BANDWIDTH")),o&&(h=o.value.split("x"),u=h[0],l=h[1]),f=(f=(f=Ko.filterTagsByName(r.tags,"EXT-X-MEDIA")).filter(function(t){return"CLOSED-CAPTIONS"!=e.getRequiredAttributeValue_(t,"TYPE")})).filter(function(e){var t=e.getAttributeValue("URI")||"";return"SUBTITLES"==(e.getAttributeValue("TYPE")||"")||""!=t}),p=n.getAttributeValue("AUDIO"),m=n.getAttributeValue("VIDEO"),window.asserts.assert(null==p||null==m,"Unexpected: both video and audio described by media tags!"),p?f=Ko.findMediaTags(f,"AUDIO",p):m&&(f=Ko.findMediaTags(f,"VIDEO",m)),(v=this.guessCodecsSafe_(i.TEXT,s))&&((y=n.getAttributeValue("SUBTITLES"))&&(g=Ko.findMediaTags(f,"SUBTITLES",y),window.asserts.assert(1==g.length,"Exactly one text tag expected!"),g.length&&(this.mediaTagsToStreamInfosMap_.get(g[0].id).stream.codecs=v)),Fn.remove(s,v)),_=f.map(function(e){return x.createStreamInfoFromMediaTag_(e,s)}),b=[],w=[],t.next=25,Promise.all(_);case 25:if(S=(S=t.sent).filter(function(e){return null!=e}),p?b=S:m&&(w=S),tu.log.debug("Guessing stream type for",n.toString()),k=!1,b.length||w.length?b.length?(I=e.getRequiredAttributeValue_(n,"URI"),A=b[0].verbatimMediaPlaylistUri,I==A?(tu.log.debug("Guessing audio-only."),T=i.AUDIO,k=!0):(tu.log.debug("Guessing video."),T=i.VIDEO)):(window.asserts.assert(w.length,"No video streams!  This should have been handled already!"),tu.log.debug("Guessing audio."),T=i.AUDIO):1==s.length?(C=this.guessCodecsSafe_(i.VIDEO,s),o||c||C?(tu.log.debug("Guessing video-only."),T=i.VIDEO):(tu.log.debug("Guessing audio-only."),T=i.AUDIO)):(tu.log.debug("Guessing multiplexed audio+video."),T=i.VIDEO,s=[s.join(",")]),window.asserts.assert(T,"Type should have been set by now!"),k){t.next=36;break}return t.next=35,this.createStreamInfoFromVariantTag_(n,s,T);case 35:E=t.sent;case 36:if(!E){t.next=40;break}E.stream.type==i.AUDIO?b=[E]:w=[E],t.next=43;break;case 40:if(null!==E){t.next=43;break}return tu.log.debug("streamInfo is null"),t.abrupt("return",[]);case 43:return window.asserts.assert(w.length||b.length,"We should have created a stream!"),w&&this.filterLegacyCodecs_(w),b&&this.filterLegacyCodecs_(b),t.abrupt("return",this.createVariants_(b,w,d,u,l,c));case 47:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"filterLegacyCodecs_",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value,o=s.stream.codecs.split(",");o=o.filter(function(e){return"mp4a.40.34"!=e}),s.stream.codecs=o.join(",")}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"createVariants_",value:function(e,t,n,r,i,a){var s=!0,o=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;this.addVideoAttributes_(d.stream,r,i,a)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}e.length||(e=[null]),t.length||(t=[null]);var h=[],f=!0,p=!1,m=void 0;try{for(var v,y=e[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value,_=!0,b=!1,w=void 0;try{for(var E,S=t[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var T=E.value,k=g?g.stream:null,C=T?T.stream:null,I=g?g.drmInfos:null,A=T?T.drmInfos:null,x=(T?T.verbatimMediaPlaylistUri:"")+" - "+(g?g.verbatimMediaPlaylistUri:""),L=void 0;if(k&&C){if(!Tt.areDrmCompatible(I,A)){tu.log.warning("Incompatible DRM info in HLS variant.  Skipping.");continue}L=Tt.getCommonDrmInfos(I,A)}else k?L=I:C&&(L=A);if(this.variantUriSet_.has(x))tu.log.debug("Skipping variant which only differs in text streams.");else{var N=this.createVariant_(k,C,n,L);h.push(N),this.variantUriSet_.add(x)}}}catch(e){b=!0,w=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw w}}}}catch(e){p=!0,m=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw m}}return h}},{key:"createVariant_",value:function(e,t,n,r){var i=ee.ContentType;return window.asserts.assert(!e||e.type==i.AUDIO,"Audio parameter mismatch!"),window.asserts.assert(!t||t.type==i.VIDEO,"Video parameter mismatch!"),{id:this.globalId_++,language:e?e.language:"und",primary:!!e&&e.primary||!!t&&t.primary,audio:e,video:t,bandwidth:n,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}},{key:"createTextStream_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.asserts.assert("EXT-X-MEDIA"==n.name,"Should only be called on media tags!"),i=e.getRequiredAttributeValue_(n,"TYPE"),window.asserts.assert("SUBTITLES"==i,'Should only be called on tags with TYPE="SUBTITLES"!'),t.next=5,this.createStreamInfoFromMediaTag_(n,[]);case 5:return a=t.sent,window.asserts.assert(a,"Should always have a streamInfo for text"),t.abrupt("return",a.stream);case 8:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"parseClosedCaptions_",value:function(t){var n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;window.asserts.assert("EXT-X-MEDIA"==o.name,"Should only be called on media tags!");var u=e.getRequiredAttributeValue_(o,"TYPE");window.asserts.assert("CLOSED-CAPTIONS"==u,'Should only be called on tags with TYPE="CLOSED-CAPTIONS"!');var l=o.getAttributeValue("LANGUAGE")||"und",c=ne.normalize(l),d=e.getRequiredAttributeValue_(o,"GROUP-ID"),h=e.getRequiredAttributeValue_(o,"INSTREAM-ID");this.groupIdToClosedCaptionsMap_.get(d)||this.groupIdToClosedCaptionsMap_.set(d,new Map),this.groupIdToClosedCaptionsMap_.get(d).set(h,c)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"createStreamInfoFromMediaTag_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r){var i,a,s,o,u,l,c,d,h,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert("EXT-X-MEDIA"==n.name,"Should only be called on media tags!"),i=e.getRequiredAttributeValue_(n,"URI"),!this.uriToStreamInfosMap_.has(i)){t.next=4;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(i));case 4:return a=e.getRequiredAttributeValue_(n,"TYPE").toLowerCase(),s=ee.ContentType,"subtitles"==a&&(a=s.TEXT),o=ne.normalize(n.getAttributeValue("LANGUAGE","und")),u=n.getAttributeValue("NAME"),l=n.getAttribute("DEFAULT"),c=n.getAttribute("AUTOSELECT"),d=n.getAttributeValue("CHANNELS"),h="audio"==a?this.getChannelCount_(d):null,f=!!l||!!c,t.next=16,this.createStreamInfo_(i,r,a,o,f,u,h,null);case 16:if(null!=(p=t.sent)){t.next=19;break}return t.abrupt("return",null);case 19:if(!this.uriToStreamInfosMap_.has(i)){t.next=21;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(i));case 21:return this.mediaTagsToStreamInfosMap_.set(n.id,p),this.uriToStreamInfosMap_.set(i,p),t.abrupt("return",p);case 24:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getChannelCount_",value:function(e){if(!e)return null;var t=e.split("/")[0];return parseInt(t,10)}},{key:"createStreamInfoFromVariantTag_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r,i){var a,s,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.asserts.assert("EXT-X-STREAM-INF"==n.name,"Should only be called on media tags!"),a=ee.ContentType,s=e.getRequiredAttributeValue_(n,"URI"),!this.uriToStreamInfosMap_.has(s)){t.next=5;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(s));case 5:return o=n.getAttributeValue("CLOSED-CAPTIONS"),u=null,i==a.VIDEO&&o&&"NONE"!=o&&(u=this.groupIdToClosedCaptionsMap_.get(o)),t.next=10,this.createStreamInfo_(s,r,i,"und",!1,null,null,u);case 10:if(null!=(l=t.sent)){t.next=13;break}return t.abrupt("return",null);case 13:if(!this.uriToStreamInfosMap_.has(s)){t.next=15;break}return t.abrupt("return",this.uriToStreamInfosMap_.get(s));case 15:return this.uriToStreamInfosMap_.set(s,l),t.abrupt("return",l);case 17:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"createStreamInfo_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r,i,a,s,o,u,l){var c,d,h,f,p,m,v,y,g,_,b,w,E,S,T,k,C,I,x,L,N,R,M,P,O,D,U,F,B,V,j,H,K,G;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=Ko.constructAbsoluteUri(this.masterPlaylistUri_,n),d="",t.next=4,this.requestManifest_(c);case 4:if(h=t.sent,c=h.uri,(f=this.manifestTextParser_.parsePlaylist(h.data,c)).type==Fo){t.next=9;break}throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_INVALID_PLAYLIST_HIERARCHY);case 9:if(p=[],!f.segments){t.next=30;break}for(m=!0,v=!1,y=void 0,t.prev=14,g=f.segments[Symbol.iterator]();!(m=(_=g.next()).done);m=!0)b=_.value,w=Ko.filterTagsByName(b.tags,"EXT-X-KEY"),p.push.apply(p,Yo(w));t.next=22;break;case 18:t.prev=18,t.t0=t.catch(14),v=!0,y=t.t0;case 22:t.prev=22,t.prev=23,m||null==g.return||g.return();case 25:if(t.prev=25,!v){t.next=28;break}throw y;case 28:return t.finish(25);case 29:return t.finish(22);case 30:E=!1,S=[],T=null,k=0,C=p;case 34:if(!(k<C.length)){t.next=50;break}if(I=C[k],"NONE"==(x=e.getRequiredAttributeValue_(I,"METHOD"))){t.next=47;break}if(E=!0,"AES-128"!=x){t.next=43;break}return tu.log.warning("Unsupported HLS Encryption",x),this.aesEncrypted_=!0,t.abrupt("return",null);case 43:L=e.getRequiredAttributeValue_(I,"KEYFORMAT"),N=e.KEYFORMATS_TO_DRM_PARSERS_[L],(R=N?N(I):null)?(R.keyIds.length&&(T=R.keyIds[0]),S.push(R)):tu.log.warning("Unsupported HLS KEYFORMAT",L);case 47:k++,t.next=34;break;case 50:if(!E||S.length){t.next=52;break}throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_KEYFORMATS_NOT_SUPPORTED);case 52:return window.asserts.assert(null!=f.segments,"Media playlist should have segments!"),this.determinePresentationType_(f),d=this.guessCodecs_(i,r),t.next=57,this.guessMimeType_(i,d,f);case 57:return M=t.sent,P=M,O=Ko.getFirstTagWithName(f.tags,"EXT-X-MEDIA-SEQUENCE"),D=O?Number(O.value):0,t.next=63,this.createSegments_(n,f,D,P,d);case 63:return U=t.sent,F=U[0].startTime,B=U[U.length-1].endTime,V=B-F,j=new ur(U),H=this.createInitSegmentReference_(f),K=void 0,i==ee.ContentType.TEXT&&(K=ee.TextStreamKind.SUBTITLE),G={id:this.globalId_++,originalId:o,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return j.find(e)},getSegmentReference:function(e){return j.get(e)},initSegmentReference:H,presentationTimeOffset:0,mimeType:P,codecs:d,kind:K,encrypted:E,keyId:T,language:a,label:o,type:i,primary:s,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:u,closedCaptions:l},t.abrupt("return",{stream:G,segmentIndex:j,drmInfos:S,verbatimMediaPlaylistUri:n,absoluteMediaPlaylistUri:c,minTimestamp:F,maxTimestamp:B,duration:V});case 73:case"end":return t.stop()}},t,this,[[14,18,22,30],[23,,25,29]])}));return function(e,n,r,i,a,s,o,u){return t.apply(this,arguments)}}()},{key:"determinePresentationType_",value:function(t){var n=e.PresentationType_,r=Ko.getFirstTagWithName(t.tags,"EXT-X-PLAYLIST-TYPE"),i=Ko.getFirstTagWithName(t.tags,"EXT-X-ENDLIST"),a=r&&"VOD"==r.value||i,s=r&&"EVENT"==r.value&&!a,o=!a&&!s;if(a)this.setPresentationType_(n.VOD);else{o?this.setPresentationType_(n.LIVE):this.setPresentationType_(n.EVENT);var u=this.getRequiredTag_(t.tags,"EXT-X-TARGETDURATION"),l=Number(u.value);this.maxTargetDuration_=Math.max(l,this.maxTargetDuration_),this.minTargetDuration_=Math.min(l,this.minTargetDuration_)}}},{key:"createPresentationTimeline_",value:function(e){this.isLive_()?(this.presentationTimeline_=new Jn(0,3*this.maxTargetDuration_),this.presentationTimeline_.setStatic(!1)):(this.presentationTimeline_=new Jn(null,0),this.presentationTimeline_.setStatic(!0)),this.notifySegments_(),window.asserts.assert(!this.presentationTimeline_.usingPresentationStartTime(),"We should not be using the presentation start time in HLS!")}},{key:"createInitSegmentReference_",value:function(t){var n=Ko.filterTagsByName(t.tags,"EXT-X-MAP");if(!n.length)return null;if(n.length>1)throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND);var r=n[0],i=e.getRequiredAttributeValue_(r,"URI"),a=Ko.constructAbsoluteUri(t.absoluteUri,i),s=0,o=null,u=r.getAttributeValue("BYTERANGE");if(u){var l=u.split("@"),c=Number(l[0]);o=(s=Number(l[1]))+c-1}return new rr(function(){return[a]},s,o)}},{key:"createSegmentReference_",value:function(e,t,n,r,i){var a=n.tags,s=n.absoluteUri,o=this.getRequiredTag_(a,"EXTINF").value.split(","),u=i+Number(o[0]),l=0,c=null,d=Ko.getFirstTagWithName(a,"EXT-X-BYTERANGE");if(d){var h=d.value.split("@"),f=Number(h[0]);h[1]?l=Number(h[1]):(window.asserts.assert(t,"Cannot refer back to previous HLS segment!"),l=t.endByte+1),c=l+f-1}return new ir(r,i,u,function(){return[s]},l,c)}},{key:"notifySegments_",value:function(){if(this.presentationTimeline_){var e=!0,t=!1,n=void 0;try{for(var r,i=this.segmentsToNotifyByStream_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;this.presentationTimeline_.notifySegments(a,0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.segmentsToNotifyByStream_=[]}}},{key:"createSegments_",value:function(){var e=$o(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,u,l,c,d,h,f,p,m,v,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.segments,o=[],window.asserts.assert(s.length,"Playlist should have segments!"),u=s[0].absoluteUri,l=this.createSegmentReference_(n,null,s[0],r,0),c=this.createInitSegmentReference_(n),e.next=8,this.getStartTime_(t,c,l,i,a);case 8:for(d=e.sent,tu.log.debug("First segment",u.split("/").pop(),"starts at",d),h=0;h<s.length;++h)f=s[h],p=o[o.length-1],m=0==h?d:p.endTime,v=r+h,y=this.createSegmentReference_(n,p,f,v,m),o.push(y);return this.segmentsToNotifyByStream_.push(o),this.notifySegments_(),e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"fetchPartialSegment_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n){var r,i,a,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Zo.RequestType,i=Sr.createSegmentRequest(n.getUris(),n.startByte,n.startByte+e.PARTIAL_SEGMENT_SIZE_-1,this.config_.retryParameters),a=Sr.createSegmentRequest(n.getUris(),n.startByte,n.endByte,this.config_.retryParameters),t.prev=3,t.next=6,this.makeNetworkRequest_(i,r.SEGMENT);case 6:return s=t.sent,t.abrupt("return",s);case 10:if(t.prev=10,t.t0=t.catch(3),t.t0.code!=eu.code.OPERATION_ABORTED){t.next=14;break}throw t.t0;case 14:return tu.log.alwaysWarn("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),t.next=17,this.makeNetworkRequest_(a,r.SEGMENT);case 17:return o=t.sent,t.abrupt("return",o);case 19:case"end":return t.stop()}},t,this,[[3,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"getStartTime_",value:function(){var e=$o(regeneratorRuntime.mark(function e(t,n,r,i,a){var s,o,u,l,c,d,h,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.manifest_){e.next=8;break}if(s=this.uriToStreamInfosMap_.get(t),o=s.segmentIndex,!(u=o.get(r.position))){e.next=7;break}return tu.log.v1("Found segment start time in previous manifest"),e.abrupt("return",u.startTime);case 7:tu.log.debug("Unable to find segment start time in previous manifest!");case 8:if(tu.log.v1("Fetching segment to find start time"),"audio/mpeg"!=i){e.next=11;break}return e.abrupt("return",0);case 11:if("video/mp4"!=i&&"audio/mp4"!=i){e.next=20;break}return l=[this.fetchPartialSegment_(r)],n&&l.push(this.fetchPartialSegment_(n)),e.next=16,Promise.all(l);case 16:return c=e.sent,d=c[0],h=c[1]||c[0],e.abrupt("return",this.getStartTimeFromMp4Segment_(d.data,h.data));case 20:if("video/mp2t"!=i){e.next=26;break}return e.next=23,this.fetchPartialSegment_(r);case 23:return f=e.sent,window.asserts.assert(f.data,"Should have a response body!"),e.abrupt("return",this.getStartTimeFromTsSegment_(f.data));case 26:if("application/mp4"!=i&&!i.startsWith("text/")){e.next=32;break}return e.next=29,this.fetchPartialSegment_(r);case 29:return p=e.sent,window.asserts.assert(p.data,"Should have a response body!"),e.abrupt("return",this.getStartTimeFromTextSegment_(i,a,p.data));case 32:throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);case 33:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"getStartTimeFromMp4Segment_",value:function(e,t){var n=0;if((new Ai).box("moov",Ai.children).box("trak",Ai.children).box("mdia",Ai.children).fullBox("mdhd",function(e){window.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),e.reader.skip(0==e.version?8:16),n=e.reader.readUint32(),e.parser.stop()}).parse(t,!0),!n)throw tu.log.error("Unable to find timescale in init segment!"),new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);var r=0,i=!1;if((new Ai).box("moof",Ai.children).box("traf",Ai.children).fullBox("tfdt",function(e){window.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1");var t=0==e.version?e.reader.readUint32():e.reader.readUint64();r=t/n,i=!0,e.parser.stop()}).parse(e,!0),!i)throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME);return r}},{key:"getStartTimeFromTsSegment_",value:function(t){for(var n=new Ti(new DataView(t),Ti.Endianness.BIG_ENDIAN),r=function(){throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_PARSE_SEGMENT_START_TIME)},i=0,a=0;;){i=n.getPosition(),71!=(a=n.readUint8())&&r(),16384&n.readUint16()||r();var s=(48&n.readUint8())>>4;if(0!=s&&2!=s||r(),3==s){var o=n.readUint8();n.skip(o)}if(1==n.readUint32()>>8){n.skip(3);var u=n.readUint8()>>6;0!=u&&1!=u||r();var l=n.readUint8();return 0==l&&r(),2==u?window.asserts.assert(5==l,"Bad PES header?"):3==u&&window.asserts.assert(10==l,"Bad PES header?"),(((14&n.readUint8())>>1)*(1<<30)+((65534&n.readUint16())<<14|(65534&n.readUint16())>>1))/e.TS_TIMESCALE_}n.seek(i+188),71!=(a=n.readUint8())&&(n.seek(i+192),a=n.readUint8()),71!=a&&(n.seek(i+204),a=n.readUint8()),71!=a&&r(),n.rewind(1)}}},{key:"getStartTimeFromTextSegment_",value:function(e,t,n){var r=st.getFullType(e,t);if(!Ht.isTypeSupported(r))return 0;var i=new Ht(null);return i.initParser(r),i.getStartTime(n)}},{key:"guessCodecsSafe_",value:function(t,n){var r=ee.ContentType,i=e.CODEC_REGEXPS_BY_CONTENT_TYPE_[t],a=!0,s=!1,o=void 0;try{for(var u,l=i[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=!0,h=!1,f=void 0;try{for(var p,m=n[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(c.test(v.trim()))return v.trim()}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}return t==r.TEXT?"":null}},{key:"guessCodecs_",value:function(e,t){if(1==t.length)return t[0];var n=this.guessCodecsSafe_(e,t);if(null!=n)return n;throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_GUESS_CODECS,t)}},{key:"guessMimeType_",value:function(){var t=$o(regeneratorRuntime.mark(function t(n,r,i){var a,s,o,u,l,c,d,h,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=ee.ContentType,s=Zo.RequestType,window.asserts.assert(i.segments.length,"Playlist should have segments!"),o=i.segments[0].absoluteUri,u=new Z(o),l=u.getPath().split(".").pop(),c=e.EXTENSION_MAP_BY_CONTENT_TYPE_[n],!(d=c[l])){t.next=10;break}return t.abrupt("return",d);case 10:if(n!=a.TEXT){t.next=16;break}if(r&&"vtt"!=r){t.next=15;break}return t.abrupt("return","text/vtt");case 15:return t.abrupt("return","application/mp4");case 16:return(h=vt([o],this.config_.retryParameters)).method="HEAD",t.next=20,this.makeNetworkRequest_(h,s.SEGMENT);case 20:if(f=t.sent,p=f.headers["content-type"]){t.next=24;break}throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_COULD_NOT_GUESS_MIME_TYPE,l);case 24:return t.abrupt("return",p.split(";")[0]);case 25:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getRequiredTag_",value:function(e,t){var n=Ko.getFirstTagWithName(e,t);if(!n)throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_REQUIRED_TAG_MISSING,t);return n}},{key:"addVideoAttributes_",value:function(e,t,n,r){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(r)||void 0)}},{key:"requestManifest_",value:function(e){var t=Zo.RequestType,n=vt([e],this.config_.retryParameters);return this.makeNetworkRequest_(n,t.MANIFEST)}},{key:"onUpdate_",value:function(){var e=$o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(tu.log.info("Updating manifest..."),window.asserts.assert(this.updatePlaylistDelay_>0,"We should only call |onUpdate_| when we are suppose to be updating."),this.playerInterface_){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,this.update();case 7:t=this.updatePlaylistDelay_,this.updatePlaylistTimer_.tickAfter(t),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(4),window.asserts.assert(e.t0 instanceof A,"Should only receive a Shaka error"),e.t0.severity=eu.severity.RECOVERABLE,this.playerInterface_.onError(e.t0),this.updatePlaylistTimer_.tickAfter(.1);case 17:case"end":return e.stop()}},e,this,[[4,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"isLive_",value:function(){var t=e.PresentationType_;return this.presentationType_!=t.VOD}},{key:"setPresentationType_",value:function(e){this.presentationType_=e,this.presentationTimeline_&&this.presentationTimeline_.setStatic(!this.isLive_()),this.isLive_()||this.updatePlaylistTimer_.stop()}},{key:"makeNetworkRequest_",value:function(e,t){if(!this.operationManager_)throw new A(eu.severity.CRITICAL,eu.category.PLAYER,eu.code.OPERATION_ABORTED);var n=this.playerInterface_.networkingEngine.request(t,e);return this.operationManager_.manage(n),n.promise}}],r=[{key:"filterDuplicateCodecs_",value:function(e){var t=new Set,n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=st.getCodecBase(u);t.has(l)?tu.log.debug("Ignoring duplicate codec"):(n.push(u),t.add(l))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}},{key:"getRequiredAttributeValue_",value:function(e,t){var n=e.getAttribute(t);if(!n)throw new A(eu.severity.CRITICAL,eu.category.MANIFEST,eu.code.HLS_REQUIRED_ATTRIBUTE_MISSING,t);return n.value}},{key:"widevineDrmParser_",value:function(t){var n=e.getRequiredAttributeValue_(t,"METHOD");tu.Deprecate.deprecateFeature(2,6,"HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var r=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!r.includes(n))return tu.log.error("Widevine in HLS is only supported with [",r.join(", "),"], not",n),null;var i=e.getRequiredAttributeValue_(t,"URI"),a=Jo.parseRaw(i),s=new Uint8Array(a.data),o=ee.createDrmInfo("com.widevine.alpha",[{initDataType:"cenc",initData:s}]),u=t.getAttributeValue("KEYID");return u&&(window.asserts.assert(u.startsWith("0x"),"Incorrect KEYID format!"),o.keyIds=[u.substr(2).toLowerCase()]),o}}],n&&Qo(t.prototype,n),r&&Qo(t,r),e}());nu.StreamInfo={},nu.VIDEO_CODEC_REGEXPS_=[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],nu.AUDIO_CODEC_REGEXPS_=[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],nu.TEXT_CODEC_REGEXPS_=[/^vtt$/,/^wvtt/,/^stpp/],nu.CODEC_REGEXPS_BY_CONTENT_TYPE_={audio:nu.AUDIO_CODEC_REGEXPS_,video:nu.VIDEO_CODEC_REGEXPS_,text:nu.TEXT_CODEC_REGEXPS_},nu.AUDIO_EXTENSIONS_TO_MIME_TYPES_={mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},nu.VIDEO_EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},nu.TEXT_EXTENSIONS_TO_MIME_TYPES_={mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"},nu.EXTENSION_MAP_BY_CONTENT_TYPE_={audio:nu.AUDIO_EXTENSIONS_TO_MIME_TYPES_,video:nu.VIDEO_EXTENSIONS_TO_MIME_TYPES_,text:nu.TEXT_EXTENSIONS_TO_MIME_TYPES_},nu.DrmParser_,nu.KEYFORMATS_TO_DRM_PARSERS_={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":nu.widevineDrmParser_},nu.PresentationType_={VOD:"VOD",EVENT:"EVENT",LIVE:"LIVE"},nu.TS_TIMESCALE_=9e4,nu.TS_ROLLOVER_=8589934592,nu.PARTIAL_SEGMENT_SIZE_=2048;Tn.registerParserByExtension("m3u8",nu),Tn.registerParserByMime("application/x-mpegurl",nu),Tn.registerParserByMime("application/vnd.apple.mpegurl",nu);n(21);function ru(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function iu(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ru(a,r,i,s,o,"next",e)}function o(e){ru(a,r,i,s,o,"throw",e)}s(void 0)})}}function au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var su=window.shaka,ou=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uri_=null}var t,n,r;return t=e,(n=[{key:"configure",value:function(e){}},{key:"start",value:function(){var e=iu(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pn.parse(t),this.uri_=r,null!=r&&r.isManifest()){e.next=4;break}throw new su.util.Error(su.util.Error.Severity.CRITICAL,su.util.Error.Category.NETWORK,su.util.Error.Code.MALFORMED_OFFLINE_URI,t);case 4:return i=new Xn,e.prev=5,e.next=8,i.init();case 8:return e.next=10,i.getCell(r.mechanism(),r.cell());case 10:return a=e.sent,e.next=13,a.getManifests([r.key()]);case 13:return s=e.sent,o=s[0],u=new cr(r.mechanism(),r.cell()),e.abrupt("return",u.fromManifestDB(o));case 17:return e.prev=17,e.next=20,i.destroy();case 20:return e.finish(17);case 21:case"end":return e.stop()}},e,this,[[5,,17,21]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){return Promise.resolve()}},{key:"update",value:function(){}},{key:"onExpirationUpdated",value:function(){var e=iu(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.asserts.assert(this.uri_,"Should not get update event before start has been called"),r=this.uri_,i=new Xn,e.prev=3,e.next=6,i.init();case 6:return e.next=8,i.getCell(r.mechanism(),r.cell());case 8:return a=e.sent,e.next=11,a.getManifests([r.key()]);case 11:if(s=e.sent,o=s[0],u=o.sessionIds.includes(t),l=null==o.expiration||o.expiration>n,!u||!l){e.next=19;break}return su.log.debug("Updating expiration for stored content"),e.next=19,a.updateManifestExpiration(r.key(),n);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),su.log.error("There was an error updating",r,e.t0);case 24:return e.prev=24,e.next=27,i.destroy();case 27:return e.finish(24);case 28:case"end":return e.stop()}},e,this,[[3,21,24,28]])}));return function(t,n){return e.apply(this,arguments)}}()}])&&au(t.prototype,n),r&&au(t,r),e}());Tn.registerParserByMime("application/x-offline-manifest",ou);function uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var lu=c.net.NetworkingEngine,cu=c.util.AbortableOperation,du=(window.shaka,window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"plugin",value:function(t,n,r,i){var a=Pn.parse(t);return a&&a.isManifest()?e.getManifest_(t):a&&a.isSegment()?e.getSegment_(a.key(),a):cu.failed(new A(A.Severity.CRITICAL,A.Category.NETWORK,A.Code.MALFORMED_OFFLINE_URI,t))}},{key:"getManifest_",value:function(e){var t={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return cu.completed(t)}},{key:"getSegment_",value:function(e,t){window.asserts.assert(t.isSegment(),"Only segment uri's should be given to getSegment");var n=new Xn;return cu.completed(void 0).chain(function(){return n.init()}).chain(function(){return n.getCell(t.mechanism(),t.cell())}).chain(function(e){return e.getSegments([t.key()])}).chain(function(e){var n=e[0];return{uri:t,data:n.data,headers:{}}}).finally(function(){return n.destroy()})}}],(n=null)&&uu(t.prototype,n),r&&uu(t,r),e}());function hu(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}lu.registerScheme("offline",du.plugin);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var pu=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.transaction_=t,this.store_=t.objectStore(n),this.promise_=new we,t.onabort=function(e){e.preventDefault(),r.promise_.reject()},t.onerror=function(e){e.preventDefault(),r.promise_.reject()},t.oncomplete=function(e){r.promise_.resolve()}}var t,n,r;return t=e,(n=[{key:"abort",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.transaction_.abort()}catch(e){}return e.prev=1,e.next=4,this.promise_;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,this,[[1,6]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){hu(a,r,i,s,o,"next",e)}function o(e){hu(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"forEachEntry",value:function(e){var t=this;return new Promise(function(n,r){var i=t.store_.openCursor();i.onerror=r,i.onsuccess=function(t){var r=t.target.result;r?(e(r.key,r.value,r),r.continue()):n()}})}},{key:"store",value:function(){return this.store_}},{key:"promise",value:function(){return this.promise_}}])&&fu(t.prototype,n),r&&fu(t,r),e}();function mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka,window.goog;var vu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=t,this.pending_=[]}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return Promise.all(this.pending_.map(function(e){return e.abort()}))}},{key:"startReadOnlyOperation",value:function(e){return this.startOperation_(e,"readonly")}},{key:"startReadWriteOperation",value:function(e){return this.startOperation_(e,"readwrite")}},{key:"startOperation_",value:function(e,t){var n=this,r=this.connection_.transaction([e],t),i=new pu(r,e);return this.pending_.push(i),i.promise().then(function(){return n.stopTracking_(i)},function(){return n.stopTracking_(i)}),i}},{key:"stopTracking_",value:function(e){Fn.remove(this.pending_,e)}}])&&mu(t.prototype,n),r&&mu(t,r),e}();function yu(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function gu(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){yu(a,r,i,s,o,"next",e)}function o(e){yu(a,r,i,s,o,"throw",e)}s(void 0)})}}function _u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var bu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new vu(t),this.store_=n}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"getAll",value:function(){var e=gu(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.connection_.startReadOnlyOperation(this.store_),n=[],e.next=4,t.forEachEntry(function(e,t){n.push(t)});case 4:return e.next=6,t.promise();case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(e){var t=this.connection_.startReadWriteOperation(this.store_),n=t.store(),r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;n.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return t.promise()}},{key:"remove",value:function(){var e=gu(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.connection_.startReadWriteOperation(this.store_),e.next=3,n.forEachEntry(function(e,n,r){t.indexOf(n.sessionId)>=0&&r.delete()});case 3:return e.next=5,n.promise();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}])&&_u(t.prototype,n),r&&_u(t,r),e}();function wu(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Eu(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){wu(a,r,i,s,o,"next",e)}function o(e){wu(a,r,i,s,o,"throw",e)}s(void 0)})}}function Su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Tu=window.shaka,ku=(window.goog,function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new vu(t),this.segmentStore_=n,this.manifestStore_=r}var t,n,r;return t=e,n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"hasFixedKeySpace",value:function(){return!0}},{key:"addSegments",value:function(e){return this.rejectAdd_(this.segmentStore_)}},{key:"removeSegments",value:function(e,t){return this.remove_(this.segmentStore_,e,t)}},{key:"getSegments",value:function(){var t=Eu(regeneratorRuntime.mark(function t(n){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.convertSegmentData_,t.next=3,this.get_(this.segmentStore_,n);case 3:return i=t.sent,t.abrupt("return",i.map(r));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"addManifests",value:function(e){return this.rejectAdd_(this.manifestStore_)}},{key:"updateManifestExpiration",value:function(){var e=Eu(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.connection_.startReadWriteOperation(this.manifestStore_),i=r.store(),a=new we,i.get(t).onsuccess=function(e){var r=e.target.result;r?(window.asserts.assert(r.key==t,"With in-line keys, the keys should match"),r.expiration=n,i.put(r),a.resolve()):a.reject(new Tu.util.Error(Tu.util.Error.Severity.CRITICAL,Tu.util.Error.Category.STORAGE,Tu.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+t))},e.next=6,Promise.all([r.promise(),a]);case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeManifests",value:function(e,t){return this.remove_(this.manifestStore_,e,t)}},{key:"getManifests",value:function(){var t=Eu(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get_(this.manifestStore_,n);case 2:return r=t.sent,t.abrupt("return",r.map(e.convertManifest_));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getAllManifests",value:function(){var t=Eu(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.connection_.startReadOnlyOperation(this.manifestStore_),r=new Map,t.next=4,n.forEachEntry(function(t,n){r.set(t,e.convertManifest_(n))});case 4:return t.next=6,n.promise();case 6:return t.abrupt("return",r);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"rejectAdd_",value:function(e){return Promise.reject(new Tu.util.Error(Tu.util.Error.Severity.CRITICAL,Tu.util.Error.Category.STORAGE,Tu.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+e))}},{key:"remove_",value:function(e,t,n){var r=this.connection_.startReadWriteOperation(e),i=r.store(),a=!0,s=!1,o=void 0;try{for(var u,l=function(){var e=u.value;i.delete(e).onsuccess=function(){return n(e)}},c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)l()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}return r.promise()}},{key:"get_",value:function(){var e=Eu(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.connection_.startReadOnlyOperation(t),i=r.store(),a={},s=[],o=!0,u=!1,l=void 0,e.prev=7,c=function(){var e=h.value;i.get(e).onsuccess=function(t){var n=t.target.result;null==n&&s.push(e),a[e]=n}},d=n[Symbol.iterator]();!(o=(h=d.next()).done);o=!0)c();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(7),u=!0,l=e.t0;case 16:e.prev=16,e.prev=17,o||null==d.return||d.return();case 19:if(e.prev=19,!u){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:if(!s.length){e.next=28;break}throw new Tu.util.Error(Tu.util.Error.Severity.CRITICAL,Tu.util.Error.Category.STORAGE,Tu.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+s);case 28:return e.abrupt("return",n.map(function(e){return a[e]}));case 29:case"end":return e.stop()}},e,this,[[7,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()}],r=[{key:"convertManifest_",value:function(t){return window.asserts.assert(null!=t.originalManifestUri,"Old manifest format should have an originalManifestUri field"),window.asserts.assert(null!=t.duration,"Old manifest format should have a duration field"),window.asserts.assert(null!=t.size,"Old manifest format should have a size field"),window.asserts.assert(null!=t.periods,"Old manifest format should have a periods field"),window.asserts.assert(null!=t.sessionIds,"Old manifest format should have a session ids field"),window.asserts.assert(null!=t.appMetadata,"Old manifest format should have an app metadata field"),{originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:null==t.expiration?1/0:t.expiration,periods:t.periods.map(e.convertPeriod_),sessionIds:t.sessionIds,drmInfo:t.drmInfo,appMetadata:t.appMetadata}}},{key:"convertPeriod_",value:function(t){window.asserts.assert(null!=t.startTime,"Old period format should have a start time field"),window.asserts.assert(null!=t.streams,"Old period format should have a streams field"),e.fillMissingVariants_(t);var n=!0,r=!1,i=void 0;try{for(var a,s=t.streams[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;window.asserts.assert(o.variantIds,"After filling in missing variants, each stream should have variant ids")}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return{startTime:t.startTime,streams:t.streams.map(e.convertStream_)}}},{key:"convertStream_",value:function(t){window.asserts.assert(null!=t.id,"Old stream format should have an id field"),window.asserts.assert(null!=t.primary,"Old stream format should have a primary field"),window.asserts.assert(null!=t.presentationTimeOffset,"Old stream format should have a presentation time offset field"),window.asserts.assert(null!=t.contentType,"Old stream format should have a content type field"),window.asserts.assert(null!=t.mimeType,"Old stream format should have a mime type field"),window.asserts.assert(null!=t.codecs,"Old stream format should have a codecs field"),window.asserts.assert(null!=t.language,"Old stream format should have a language field"),window.asserts.assert(null!=t.encrypted,"Old stream format should have an encrypted field"),window.asserts.assert(null!=t.segments,"Old stream format should have a segments field");var n=t.initSegmentUri?e.getKeyFromSegmentUri_(t.initSegmentUri):null;return{id:t.id,originalId:null,primary:t.primary,presentationTimeOffset:t.presentationTimeOffset,contentType:t.contentType,mimeType:t.mimeType,codecs:t.codecs,frameRate:t.frameRate,kind:t.kind,language:t.language,label:t.label,width:t.width,height:t.height,initSegmentKey:n,encrypted:t.encrypted,keyId:t.keyId,segments:t.segments.map(e.convertSegment_),variantIds:t.variantIds}}},{key:"convertSegment_",value:function(t){window.asserts.assert(null!=t.startTime,"The old segment format should have a start time field"),window.asserts.assert(null!=t.endTime,"The old segment format should have an end time field"),window.asserts.assert(null!=t.uri,"The old segment format should have a uri field");var n=e.getKeyFromSegmentUri_(t.uri);return{startTime:t.startTime,endTime:t.endTime,dataKey:n}}},{key:"convertSegmentData_",value:function(e){return window.asserts.assert(null!=e.key,"The old segment data format should have a key field"),window.asserts.assert(null!=e.data,"The old segment data format should have a data field"),{data:e.data}}},{key:"getKeyFromSegmentUri_",value:function(e){var t=null;if(t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))return Number(t[1]);if(t=/^offline:segment\/([0-9]+)$/.exec(e))return Number(t[1]);throw new Tu.util.Error(Tu.util.Error.Severity.CRITICAL,Tu.util.Error.Category.STORAGE,Tu.util.Error.Code.MALFORMED_OFFLINE_URI,"Could not parse uri "+e)}},{key:"fillMissingVariants_",value:function(e){var t=ee.ContentType.AUDIO,n=ee.ContentType.VIDEO,r=e.streams.filter(function(e){return e.contentType==t}),i=e.streams.filter(function(e){return e.contentType==n});if(!r.every(function(e){return e.variantIds})||!i.every(function(e){return e.variantIds})){window.asserts.assert(r.every(function(e){return!e.variantIds}),"Some audio streams have variant ids and some do not."),window.asserts.assert(i.every(function(e){return!e.variantIds}),"Some video streams have variant ids and some do not.");var a=!0,s=!1,o=void 0;try{for(var u,l=r[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.variantIds=[]}}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}var c=!0,d=!1,h=void 0;try{for(var f,p=i[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){f.value.variantIds=[]}}catch(e){d=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw h}}var m=0;if(i.length&&!r.length){Tu.log.debug("Found video-only content. Creating variants for video.");var v=m++,y=!0,g=!1,_=void 0;try{for(var b,w=i[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){b.value.variantIds.push(v)}}catch(e){g=!0,_=e}finally{try{y||null==w.return||w.return()}finally{if(g)throw _}}}if(!i.length&&r.length){Tu.log.debug("Found audio-only content. Creating variants for audio.");var E=m++,S=!0,T=!1,k=void 0;try{for(var C,I=r[Symbol.iterator]();!(S=(C=I.next()).done);S=!0){C.value.variantIds.push(E)}}catch(e){T=!0,k=e}finally{try{S||null==I.return||I.return()}finally{if(T)throw k}}}if(i.length&&r.length){Tu.log.debug("Found audio-video content. Creating variants.");var A=!0,x=!1,L=void 0;try{for(var N,R=r[Symbol.iterator]();!(A=(N=R.next()).done);A=!0){var M=N.value,P=!0,O=!1,D=void 0;try{for(var U,F=i[Symbol.iterator]();!(P=(U=F.next()).done);P=!0){var B=U.value,V=m++;M.variantIds.push(V),B.variantIds.push(V)}}catch(e){O=!0,D=e}finally{try{P||null==F.return||F.return()}finally{if(O)throw D}}}}catch(e){x=!0,L=e}finally{try{A||null==R.return||R.return()}finally{if(x)throw L}}}}}}],n&&Su(t.prototype,n),r&&Su(t,r),e}());function Cu(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Iu(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Cu(a,r,i,s,o,"next",e)}function o(e){Cu(a,r,i,s,o,"throw",e)}s(void 0)})}}function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xu=window.shaka,Lu=(window.goog,function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connection_=new vu(t),this.segmentStore_=n,this.manifestStore_=r,this.isFixedKey_=i}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.connection_.destroy()}},{key:"hasFixedKeySpace",value:function(){return this.isFixedKey_}},{key:"addSegments",value:function(e){return this.add_(this.segmentStore_,e)}},{key:"removeSegments",value:function(e,t){return this.remove_(this.segmentStore_,e,t)}},{key:"getSegments",value:function(e){return this.get_(this.segmentStore_,e)}},{key:"addManifests",value:function(e){return this.add_(this.manifestStore_,e)}},{key:"updateManifestExpiration",value:function(e,t){var n=this.connection_.startReadWriteOperation(this.manifestStore_),r=n.store();return r.get(e).onsuccess=function(n){var i=n.target.result;i&&(i.expiration=t,r.put(i,e))},n.promise()}},{key:"removeManifests",value:function(e,t){return this.remove_(this.manifestStore_,e,t)}},{key:"getManifests",value:function(e){return this.get_(this.manifestStore_,e)}},{key:"getAllManifests",value:function(){var e=Iu(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.connection_.startReadOnlyOperation(this.manifestStore_),n=new Map,e.next=4,t.forEachEntry(function(e,t){n.set(e,t)});case 4:return e.next=6,t.promise();case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"add_",value:function(){var e=Iu(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFixedKey_){e.next=2;break}throw new xu.util.Error(xu.util.Error.Severity.CRITICAL,xu.util.Error.Category.STORAGE,xu.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+t);case 2:for(r=this.connection_.startReadWriteOperation(t),i=r.store(),a=[],s=!0,o=!1,u=void 0,e.prev=8,l=n[Symbol.iterator]();!(s=(c=l.next()).done);s=!0)d=c.value,i.add(d).onsuccess=function(e){var t=e.target.result;a.push(t)};e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,u=e.t0;case 16:e.prev=16,e.prev=17,s||null==l.return||l.return();case 19:if(e.prev=19,!o){e.next=22;break}throw u;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:return e.abrupt("return",a);case 27:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"remove_",value:function(e,t,n){var r=this.connection_.startReadWriteOperation(e),i=r.store(),a=!0,s=!1,o=void 0;try{for(var u,l=function(){var e=u.value;i.delete(e).onsuccess=function(){return n(e)}},c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)l()}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}return r.promise()}},{key:"get_",value:function(){var e=Iu(regeneratorRuntime.mark(function e(t,n){var r,i,a,s,o,u,l,c,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.connection_.startReadOnlyOperation(t),i=r.store(),a={},s=[],o=!0,u=!1,l=void 0,e.prev=7,c=function(){var e=h.value,t=i.get(e);t.onsuccess=function(){null==t.result&&s.push(e),a[e]=t.result}},d=n[Symbol.iterator]();!(o=(h=d.next()).done);o=!0)c();e.next=16;break;case 12:e.prev=12,e.t0=e.catch(7),u=!0,l=e.t0;case 16:e.prev=16,e.prev=17,o||null==d.return||d.return();case 19:if(e.prev=19,!u){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,r.promise();case 26:if(!s.length){e.next=28;break}throw new xu.util.Error(xu.util.Error.Severity.CRITICAL,xu.util.Error.Category.STORAGE,xu.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+s);case 28:return e.abrupt("return",n.map(function(e){return a[e]}));case 29:case"end":return e.stop()}},e,this,[[7,12,16,24],[17,,19,23]])}));return function(t,n){return e.apply(this,arguments)}}()}])&&Au(t.prototype,n),r&&Au(t,r),e}());function Nu(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ru(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Nu(a,r,i,s,o,"next",e)}function o(e){Nu(a,r,i,s,o,"throw",e)}s(void 0)})}}function Mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Pu=window.shaka,Ou=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.db_=null,this.v1_=null,this.v2_=null,this.v3_=null,this.sessions_=null}var t,n,r;return t=e,n=[{key:"init",value:function(){var t=this,n=e.DB_NAME,r=e.VERSION,i=new we,a=window.indexedDB.open(n,r);return a.onsuccess=function(n){var r=n.target.result;t.db_=r,t.v1_=e.createV1_(r),t.v2_=e.createV2_(r),t.v3_=e.createV3_(r),t.sessions_=e.createEmeSession_(r),i.resolve()},a.onupgradeneeded=function(e){t.createStores_(e.target.result)},a.onerror=function(e){i.reject(new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.INDEXED_DB_ERROR,a.error)),e.preventDefault()},i}},{key:"destroy",value:function(){var e=Ru(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.v1_){e.next=3;break}return e.next=3,this.v1_.destroy();case 3:if(!this.v2_){e.next=6;break}return e.next=6,this.v2_.destroy();case 6:if(!this.v3_){e.next=9;break}return e.next=9,this.v3_.destroy();case 9:if(!this.sessions_){e.next=12;break}return e.next=12,this.sessions_.destroy();case 12:this.db_&&this.db_.close();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getCells",value:function(){var e=new Map;return this.v1_&&e.set("v1",this.v1_),this.v2_&&e.set("v2",this.v2_),this.v3_&&e.set("v3",this.v3_),e}},{key:"getEmeSessionCell",value:function(){return window.asserts.assert(this.sessions_,"Cannot be destroyed."),this.sessions_}},{key:"erase",value:function(){var t=Ru(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.v1_){t.next=3;break}return t.next=3,this.v1_.destroy();case 3:if(!this.v2_){t.next=6;break}return t.next=6,this.v2_.destroy();case 6:if(!this.v3_){t.next=9;break}return t.next=9,this.v3_.destroy();case 9:return this.db_&&this.db_.close(),t.next=12,e.deleteAll_();case 12:return this.db_=null,this.v1_=null,this.v2_=null,this.v3_=null,t.next=18,this.init();case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createStores_",value:function(t){for(var n=0,r=[e.V3_SEGMENT_STORE,e.V3_MANIFEST_STORE,e.SESSION_ID_STORE];n<r.length;n++){var i=r[n];t.objectStoreNames.contains(i)||t.createObjectStore(i,{autoIncrement:!0})}}}],r=[{key:"createV1_",value:function(t){var n=e.V1_SEGMENT_STORE,r=e.V1_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Pu.log.debug("Mounting v1 idb storage cell"),new ku(t,n,r)):null}},{key:"createV2_",value:function(t){var n=e.V2_SEGMENT_STORE,r=e.V2_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Pu.log.debug("Mounting v2 idb storage cell"),new Lu(t,n,r,!0)):null}},{key:"createV3_",value:function(t){var n=e.V3_SEGMENT_STORE,r=e.V3_MANIFEST_STORE,i=t.objectStoreNames;return i.contains(r)&&i.contains(n)?(Pu.log.debug("Mounting v3 idb storage cell"),new Lu(t,n,r,!1)):null}},{key:"createEmeSession_",value:function(t){var n=e.SESSION_ID_STORE;return t.objectStoreNames.contains(n)?(Pu.log.debug("Mounting session ID idb storage cell"),new bu(t,n)):null}},{key:"deleteAll_",value:function(){var t=e.DB_NAME,n=new we,r=window.indexedDB.deleteDatabase(t);return r.onblocked=function(e){Pu.log.warning("Deleting",t,"is being blocked")},r.onsuccess=function(e){n.resolve()},r.onerror=function(e){n.reject(new A(A.Severity.CRITICAL,A.Category.STORAGE,A.Code.INDEXED_DB_ERROR,r.error)),e.preventDefault()},n}}],n&&Mu(t.prototype,n),r&&Mu(t,r),e}());Ou.DB_NAME="shaka_offline_db",Ou.VERSION=4,Ou.V1_SEGMENT_STORE="segment",Ou.V2_SEGMENT_STORE="segment-v2",Ou.V3_SEGMENT_STORE="segment-v3",Ou.V1_MANIFEST_STORE="manifest",Ou.V2_MANIFEST_STORE="manifest-v2",Ou.V3_MANIFEST_STORE="manifest-v3",Ou.SESSION_ID_STORE="session-ids",Xn.register("idb",function(){return window.indexedDB?new Ou:null});function Du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Uu=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=[],(n="polyfills_")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,r=[{key:"installAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.polyfills_[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.callback()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"register",value:function(e,t){for(var n={priority:t=t||0,callback:e},r=0;r<this.polyfills_.length;r++)if(this.polyfills_[r].priority<t)return void this.polyfills_.splice(r,0,n);this.polyfills_.push(n)}}],(n=null)&&Du(t.prototype,n),r&&Du(t,r),e}();Uu.polyfills_=[];var Fu=Uu;function Bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Vu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled}}));var n=e.proxyEvent_;document.addEventListener("webkitfullscreenchange",n),document.addEventListener("webkitfullscreenerror",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("mozfullscreenerror",n),document.addEventListener("MSFullscreenChange",n),document.addEventListener("MSFullscreenError",n)}}},{key:"proxyEvent_",value:function(e){var t,n=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?t=new Event(n,e):(t=document.createEvent("Event")).initEvent(n,e.bubbles,e.cancelable),e.target.dispatchEvent(t)}}],(n=null)&&Bu(t.prototype,n),r&&Bu(t,r),e}();function ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Fu.register(Vu.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hu=window.shaka,Ku=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){Hu.log.debug("IndexedDB.install"),lt.isChromecast()&&(Hu.log.debug("Removing IndexedDB from ChromeCast"),delete window.indexedDB,window.asserts.assert(!window.indexedDB,"Failed to override window.indexedDB"))}}],(n=null)&&ju(t.prototype,n),r&&ju(t,r),e}();function Gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Fu.register(Ku.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wu=window.shaka,qu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){Wu.log.debug("InputEvent.install"),lt.isIE()&&(HTMLInputElement.prototype.originalAddEventListener||(Wu.log.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Wu.polyfill.InputEvent.addEventListener_))}},{key:"addEventListener_",value:function(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}}],(n=null)&&Gu(t.prototype,n),r&&Gu(t,r),e}();function zu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Fu.register(qu.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yu=window.shaka,Xu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){Yu.log.debug("mathRound.install");var t=e.MAX_ACCURATE_INPUT_+1;if(Math.round(t)!=t){Yu.log.debug("polyfill Math.round");var n=Math.round;Math.round=function(t){var r=t;return t<=e.MAX_ACCURATE_INPUT_&&(r=n(t)),r}}}}],(n=null)&&zu(t.prototype,n),r&&zu(t,r),e}();function $u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Xu.MAX_ACCURATE_INPUT_=4503599627370496,Fu.register(Xu.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qu=window.shaka,Zu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(Qu.log.debug("MediaSource.install"),window.MediaSource)if(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType)Qu.log.info("Patching Chromecast MSE bugs."),e.patchCastIsTypeSupported_();else if(lt.isApple()){var t=navigator.appVersion;Fu.MediaSource.rejectTsContent_(),t.includes("Version/8")?(Qu.log.info("Blacklisting Safari 8 MSE."),Fu.MediaSource.blacklist_()):t.includes("Version/9")?(Qu.log.info("Patching Safari 9 MSE bugs."),Fu.MediaSource.stubAbort_()):t.includes("Version/10")?(Qu.log.info("Patching Safari 10 MSE bugs."),Fu.MediaSource.stubAbort_(),Fu.MediaSource.patchEndOfStreamEvents_()):(t.includes("Version/11")||t.includes("Version/12"))&&(Qu.log.info("Patching Safari 11/12 MSE bugs."),Fu.MediaSource.stubAbort_(),Fu.MediaSource.patchRemovalRange_())}else lt.isTizen()?Fu.MediaSource.rejectCodec_("opus"):Qu.log.info("Using native MSE as-is.");else Qu.log.info("No MSE implementation available.")}},{key:"blacklist_",value:function(){window.MediaSource=null}},{key:"stubAbort_",value:function(){var t=e.prototype.addSourceBuffer;e.prototype.addSourceBuffer=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t.apply(this,n);return i.abort=function(){},i}}},{key:"patchRemovalRange_",value:function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}},{key:"patchEndOfStreamEvents_",value:function(){var t=e.prototype.endOfStream;e.prototype.endOfStream=function(){var e=0,n=!0,r=!1,i=void 0;try{for(var a,s=(this.sourceBuffers||[])[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=o.buffered.end(o.buffered.length-1);e=Math.max(e,u)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}if(!isNaN(this.duration)&&e<this.duration){this.ignoreUpdateEnd_=!0;var l=!0,c=!1,d=void 0;try{for(var h,f=(this.sourceBuffers||[])[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){h.value.eventSuppressed_=!1}}catch(e){c=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw d}}}for(var p=arguments.length,m=new Array(p),v=0;v<p;v++)m[v]=arguments[v];return t.apply(this,m)};var n=!1,r=e.prototype.addSourceBuffer;e.prototype.addSourceBuffer=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var s=r.apply(this,i);return s.mediaSource_=this,s.addEventListener("updateend",e.ignoreUpdateEnd_,!1),n||(this.addEventListener("sourceclose",e.cleanUpListeners_,!1),n=!0),s}}},{key:"ignoreUpdateEnd_",value:function(e){var t=e.target,n=t.mediaSource_;if(n.ignoreUpdateEnd_){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.eventSuppressed_=!0;var r=!0,i=!1,a=void 0;try{for(var s,o=n.sourceBuffers[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){if(0==s.value.eventSuppressed_)return}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}n.ignoreUpdateEnd_=!1}}},{key:"cleanUpListeners_",value:function(t){var n=t.target,r=!0,i=!1,a=void 0;try{for(var s,o=(n.sourceBuffers||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.removeEventListener("updateend",e.ignoreUpdateEnd_,!1)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}n.removeEventListener("sourceclose",e.cleanUpListeners_,!1)}},{key:"rejectTsContent_",value:function(){var t=e.isTypeSupported;e.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1]&&t(e)}}},{key:"rejectCodec_",value:function(t){var n=e.isTypeSupported;e.isTypeSupported=function(e){return st.getCodecBase(e)!=t&&n(e)}}},{key:"patchCastIsTypeSupported_",value:function(){var t=e.isTypeSupported,n=/^dv(?:h[e1]|a[v1])\./;e.isTypeSupported=function(e){for(var r=e.split(/ *; */),i=r[0],a={},s=1;s<r.length;++s){var o=r[s].split("="),u=o[0],l=o[1].replace(/"(.*)"/,"$1");a[u]=l}var c=a.codecs;if(!c)return t(e);var d=!1,h=!1,f=c.split(",").filter(function(e){return n.test(e)&&(h=!0),/^(hev|hvc)1\.2/.test(e)&&(d=!0),!0});h&&(d=!1),a.codecs=f.join(","),d&&(a.eotf="smpte2084");var p=i;for(var m in a){p+="; "+m+'="'+a[m]+'"'}return cast.__platform__.canDisplayType(p)}}}],(n=null)&&$u(t.prototype,n),r&&$u(t,r),e}();function Ju(e){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function el(e,t){return!t||"object"!==Ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tl(e){return(tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nl(e,t){return(nl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function il(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function al(e,t,n){return t&&il(e.prototype,t),n&&il(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fu.register(Zu.install);var sl=window.shaka,ol=window.goog,ul=function(){function e(){rl(this,e)}return al(e,null,[{key:"install",value:function(){if(window.HTMLVideoElement&&window.WebKitMediaKeys){sl.log.info("Using Apple-prefixed EME");var e=sl.polyfill.PatchedMediaKeysApple;e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess}}},{key:"requestMediaKeySystemAccess",value:function(e,t){sl.log.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var n=sl.polyfill.PatchedMediaKeysApple;try{var r=new n.MediaKeySystemAccess(e,t);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"setMediaKeys",value:function(e){sl.log.debug("PatchedMediaKeysApple.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=sl.polyfill.PatchedMediaKeysApple,n=e,r=this.mediaKeys;return r&&r!=n&&(window.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,this.mediaKeys=e,n?(window.asserts.assert(n instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),n.setMedia(this)):Promise.resolve()}},{key:"rebuildInitData_",value:function(e,t){var n=new Uint8Array(e);if(new DataView(n.buffer).getUint32(0,!0)+4!=n.byteLength)throw new Error("Malformed init data!");var r=ft.fromUTF16(n.slice(4),!0),i=new ol.Uri(r).getDomain(),a=new Uint8Array(ft.toUTF16(i,!0)),s=new Uint8Array(n.byteLength+4+a.byteLength+4+t.byteLength),o=0,u=function(e){s.set(e,o),o+=e.byteLength},l=function(e){var t=new DataView(s.buffer),n=e.byteLength;t.setUint32(o,n,!0),o+=4,u(e)};return u(n),l(a),l(new Uint8Array(t)),s}},{key:"onWebkitNeedKey_",value:function(e){sl.log.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e);var t=sl.polyfill.PatchedMediaKeysApple,n=this.mediaKeys;window.asserts.assert(n instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),window.asserts.assert(null!=e.initData,"missing init data!");var r=n.certificate;window.asserts.assert(null!=r,"missing certificate!");var i=new Event("encrypted");i.initDataType="cenc",i.initData=t.rebuildInitData_(e.initData,r),this.dispatchEvent(i)}}]),e}();function ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ul.MediaKeySystemAccess=function(){function e(t,n){if(rl(this,e),sl.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=t,this.configuration_,t.startsWith("com.apple.fps")){var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=this.checkConfig_(u);if(l)return void(this.configuration_=l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}var c=new Error("Unsupported keySystem");throw c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}return al(e,[{key:"checkConfig_",value:function(e){if("required"==e.persistentState)return null;var t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},n=!1,r=!1;if(e.audioCapabilities){var i=!0,a=!1,s=void 0;try{for(var o,u=e.audioCapabilities[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value;if(l.contentType){n=!0;var c=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(t.audioCapabilities.push(l),r=!0)}}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}}if(e.videoCapabilities){var d=!0,h=!1,f=void 0;try{for(var p,m=e.videoCapabilities[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value;if(v.contentType){n=!0;var y=v.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,y)&&(t.videoCapabilities.push(v),r=!0)}}}catch(e){h=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}}return n||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r?t:null}},{key:"createMediaKeys",value:function(){sl.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new sl.polyfill.PatchedMediaKeysApple.MediaKeys(this.keySystem);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return sl.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.configuration_}}]),e}(),ul.MediaKeys=function(){function e(t){rl(this,e),sl.log.debug("PatchedMediaKeysApple.MediaKeys"),this.nativeMediaKeys_=new WebKitMediaKeys(t),this.eventManager_=new he,this.certificate=null}return al(e,[{key:"createSession",value:function(e){if(sl.log.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new sl.polyfill.PatchedMediaKeysApple.MediaKeySession(this.nativeMediaKeys_,e)}},{key:"setServerCertificate",value:function(e){return sl.log.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),this.certificate=e?new Uint8Array(e):null,Promise.resolve(!0)}},{key:"setMedia",value:function(e){var t=this,n=sl.polyfill.PatchedMediaKeysApple;if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"webkitneedkey",n.onWebkitNeedKey_);try{return e.readyState>=1?e.webkitSetMediaKeys(this.nativeMediaKeys_):this.eventManager_.listenOnce(e,"loadedmetadata",function(){e.webkitSetMediaKeys(t.nativeMediaKeys_)}),Promise.resolve()}catch(e){return Promise.reject(e)}}}]),e}(),ul.MediaKeySession=function(e){function t(e,n){var r;return rl(this,t),sl.log.debug("PatchedMediaKeysApple.MediaKeySession"),(r=el(this,tl(t).call(this))).nativeMediaKeySession_=null,r.nativeMediaKeys_=e,r.generateRequestPromise_=null,r.updatePromise_=null,r.eventManager_=new he,r.sessionId="",r.expiration=NaN,r.closed=new we,r.keyStatuses=new sl.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nl(e,t)}(t,H),al(t,[{key:"generateRequest",value:function(e,t){var n=this;sl.log.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.generateRequestPromise_=new we;try{var r=this.nativeMediaKeys_.createSession("video/mp4",new Uint8Array(t));this.nativeMediaKeySession_=r,this.eventManager_.listen(this.nativeMediaKeySession_,"webkitkeymessage",function(e){return n.onWebkitKeyMessage_(e)}),this.eventManager_.listen(r,"webkitkeyadded",function(e){return n.onWebkitKeyAdded_(e)}),this.eventManager_.listen(r,"webkitkeyerror",function(e){return n.onWebkitKeyError_(e)}),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_}},{key:"load",value:function(){return sl.log.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(new Error("MediaKeySession.load not yet supported"))}},{key:"update",value:function(e){sl.log.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.updatePromise_=new we;try{this.nativeMediaKeySession_.update(new Uint8Array(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_}},{key:"close",value:function(){sl.log.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed}},{key:"remove",value:function(){return sl.log.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(new Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))}},{key:"onWebkitKeyMessage_",value:function(e){sl.log.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),window.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ should be set before now!"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus(),n=new D("message",{messageType:t?"license-request":"license-renewal",message:e.message.buffer});this.dispatchEvent(n)}},{key:"onWebkitKeyAdded_",value:function(e){sl.log.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),window.asserts.assert(!this.generateRequestPromise_,"Key added during generate!"),window.asserts.assert(this.updatePromise_,"updatePromise_ should be set before now!"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)}},{key:"onWebkitKeyError_",value:function(e){sl.log.debug("PatchedMediaKeysApple.onWebkitKeyError_",e);var t=new Error("EME PatchedMediaKeysApple key error");if(t.errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(t),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(t),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new D("keystatuseschange");this.dispatchEvent(t)}}]),t}(),ul.MediaKeyStatusMap=function(){function e(){rl(this,e),this.size=0,this.status_=void 0}return al(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=sl.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=ul.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!mt.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}}]),e}(),ul.MediaKeyStatusMap.KEY_ID_,Fu.register(ul.install);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var cl=window.shaka,dl=(window.goog,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.systemIds=[],this.cencKeyIds=[],this.dataBoundaries=[],(new Ai).fullBox("pssh",function(e){return n.parseBox_(e)}).parse(t.buffer),0==this.dataBoundaries.length&&cl.log.warning("No pssh box found!")}var t,n,r;return t=e,(n=[{key:"parseBox_",value:function(e){var t;if(window.asserts.assert(null!=e.version,"PSSH boxes are full boxes and must have a valid version"),window.asserts.assert(null!=e.flags,"PSSH boxes are full boxes and must have a valid flag"),e.version>1)cl.log.warning("Unrecognized PSSH version found!");else{var n=mt.toHex(e.reader.readBytes(16)),r=[];if(e.version>0)for(var i=e.reader.readUint32(),a=0;a<i;++a){var s=mt.toHex(e.reader.readBytes(16));r.push(s)}var o=e.reader.readUint32();e.reader.skip(o),(t=this.cencKeyIds).push.apply(t,r),this.systemIds.push(n),this.dataBoundaries.push({start:e.start,end:e.start+e.size-1}),e.reader.getPosition()!=e.reader.getLength()&&cl.log.warning("Mismatch between box size and data size!")}}}])&&ll(t.prototype,n),r&&ll(t,r),e}());function hl(e){return(hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fl(e,t){return!t||"object"!==hl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pl(e){return(pl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ml(e,t){return(ml=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gl(e,t,n){return t&&yl(e.prototype,t),n&&yl(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _l=window.shaka,bl=(window.goog,function(){function e(){vl(this,e)}return gl(e,null,[{key:"install",value:function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(_l.log.info("Using ms-prefixed EME v20140218"),e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,HTMLMediaElement.prototype.setMediaKeys=e.MediaKeySystemAccess.setMediaKeys)}},{key:"requestMediaKeySystemAccess",value:function(t,n){_l.log.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');try{var r=new e.MediaKeySystemAccess(t,n);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"onMsNeedKey_",value:function(t){if(_l.log.debug("PatchedMediaKeysMs.onMsNeedKey_",t),t.initData){var n=document.createEvent("CustomEvent");n.initCustomEvent("encrypted",!1,!1,null),n.initDataType="cenc",n.initData=e.normaliseInitData_(t.initData),this.dispatchEvent(n)}}},{key:"normaliseInitData_",value:function(e){if(!e)return e;var t=new dl(e);if(t.dataBoundaries.length<=1)return e;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t.dataBoundaries[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,l=e.subarray(u.start,u.end+1);n.push(l)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}for(var c=[],d=function(){var e=f[h];c.some(function(t){return mt.equal(t,e)})||c.push(e)},h=0,f=n;h<f.length;h++)d();for(var p=0,m=0,v=c;m<v.length;m++){p+=v[m].length}for(var y=new Uint8Array(p),g=0,_=0,b=c;_<b.length;_++){var w=b[_];y.set(w,g),g+=w.length}return y}}]),e}());function wl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function El(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sl(e,t,n){return t&&El(e.prototype,t),n&&El(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bl.MediaKeySystemAccess=function(){function e(t,n){vl(this,e),_l.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=t,this.configuration_;var r=!1,i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label},d=!1;if(l.audioCapabilities){var h=!0,f=!1,p=void 0;try{for(var m,v=l.audioCapabilities[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;if(y.contentType){d=!0;var g=y.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,g)&&(c.audioCapabilities.push(y),r=!0)}}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}if(l.videoCapabilities){var _=!0,b=!1,w=void 0;try{for(var E,S=l.videoCapabilities[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var T=E.value;if(T.contentType){d=!0;var k=T.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,k)&&(c.videoCapabilities.push(T),r=!0)}}}catch(e){b=!0,w=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw w}}}if(d||(r=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==l.persistentState&&(r=!1),r)return void(this.configuration_=c)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var C=new Error("Unsupported keySystem");throw C.name="NotSupportedError",C.code=DOMException.NOT_SUPPORTED_ERR,C}return gl(e,[{key:"createMediaKeys",value:function(){_l.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new bl.MediaKeys(this.keySystem);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return _l.log.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.configuration_}}],[{key:"setMediaKeys",value:function(e){_l.log.debug("PatchedMediaKeysMs.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=e,n=this.mediaKeys;return n&&n!=t&&(window.asserts.assert(n instanceof bl.MediaKeys,"non-polyfill instance of oldMediaKeys"),n.setMedia(null)),delete this.mediaKeys,this.mediaKeys=e,t?(window.asserts.assert(t instanceof bl.MediaKeys,"non-polyfill instance of newMediaKeys"),t.setMedia(this)):Promise.resolve()}}]),e}(),bl.MediaKeys=function(){function e(t){vl(this,e),_l.log.debug("PatchedMediaKeysMs.MediaKeys"),this.nativeMediaKeys_=new MSMediaKeys(t),this.eventManager_=new he}return gl(e,[{key:"createSession",value:function(e){if(_l.log.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new bl.MediaKeySession(this.nativeMediaKeys_,e)}},{key:"setServerCertificate",value:function(e){return _l.log.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)}},{key:"setMedia",value:function(e){if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"msneedkey",bl.onMsNeedKey_);var t=this;try{return e.readyState>=1?e.msSetMediaKeys(this.nativeMediaKeys_):e.addEventListener("loadedmetadata",function n(){e.msSetMediaKeys(t.nativeMediaKeys_),e.removeEventListener("loadedmetadata",n)}),Promise.resolve()}catch(e){return Promise.reject(e)}}}]),e}(),bl.MediaKeySession=function(e){function t(e,n){var r;return vl(this,t),_l.log.debug("PatchedMediaKeysMs.MediaKeySession"),(r=fl(this,pl(t).call(this))).nativeMediaKeySession_=null,r.nativeMediaKeys_=e,r.generateRequestPromise_=null,r.updatePromise_=null,r.eventManager_=new he,r.sessionId="",r.expiration=NaN,r.closed=new _l.util.PublicPromise,r.keyStatuses=new bl.MediaKeyStatusMap,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ml(e,t)}(t,H),gl(t,[{key:"generateRequest",value:function(e,t){var n=this;_l.log.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.generateRequestPromise_=new _l.util.PublicPromise;try{this.nativeMediaKeySession_=this.nativeMediaKeys_.createSession("video/mp4",new Uint8Array(t),null),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeymessage",function(e){return n.onMsKeyMessage_(e)}),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeyadded",function(e){return n.onMsKeyAdded_(e)}),this.eventManager_.listen(this.nativeMediaKeySession_,"mskeyerror",function(e){return n.onMsKeyError_(e)}),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_}},{key:"load",value:function(){return _l.log.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(new Error("MediaKeySession.load not yet supported"))}},{key:"update",value:function(e){_l.log.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.updatePromise_=new we;try{this.nativeMediaKeySession_.update(new Uint8Array(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_}},{key:"close",value:function(){_l.log.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed}},{key:"remove",value:function(){return _l.log.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(new Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))}},{key:"onMsKeyMessage_",value:function(e){_l.log.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),window.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ not set in onMsKeyMessage_"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus(),n=new D("message",{messageType:t?"license-request":"license-renewal",message:e.message.buffer});this.dispatchEvent(n)}},{key:"onMsKeyAdded_",value:function(e){if(_l.log.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.generateRequestPromise_)return _l.log.debug("Simulating completion for a PR persistent license."),window.asserts.assert(!this.updatePromise_,"updatePromise_ and generateRequestPromise_ set in onMsKeyAdded_"),this.updateKeyStatus_("usable"),this.generateRequestPromise_.resolve(),void(this.generateRequestPromise_=null);window.asserts.assert(this.updatePromise_,"updatePromise_ not set in onMsKeyAdded_"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)}},{key:"onMsKeyError_",value:function(e){_l.log.debug("PatchedMediaKeysMs.onMsKeyError_",e);var t=new Error("EME PatchedMediaKeysMs key error");if(t.errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(t),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(t),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new D("keystatuseschange");this.dispatchEvent(t)}}]),t}(),bl.MediaKeyStatusMap=function(){function e(){vl(this,e),this.size=0,this.status_=void 0}return gl(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=_l.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=bl.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!mt.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for the compiler.")}}]),e}(),bl.MediaKeyStatusMap.KEY_ID_,Fu.register(bl.install);var Tl=window.shaka,kl=(window.goog,function(){function e(){wl(this,e)}return Sl(e,null,[{key:"install",value:function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){Tl.log.info("EME not available.");var e=Tl.polyfill.PatchedMediaKeysNop;navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess}}},{key:"requestMediaKeySystemAccess",value:function(e,t){return Tl.log.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess'),Promise.reject(new Error("The key system specified is not supported."))}},{key:"setMediaKeys",value:function(e){return Tl.log.debug("PatchedMediaKeysNop.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys'),null==e?Promise.resolve():Promise.reject(new Error("MediaKeys not supported."))}}]),e}());kl.MediaKeys=function(){function e(){throw wl(this,e),new TypeError("Illegal constructor.")}return Sl(e,[{key:"createSession",value:function(){}},{key:"setServerCertificate",value:function(){}}]),e}(),kl.MediaKeySystemAccess=function(){function e(){throw wl(this,e),this.keySystem="",new TypeError("Illegal constructor.")}return Sl(e,[{key:"getConfiguration",value:function(){}},{key:"createMediaKeys",value:function(){}}]),e}(),Fu.register(kl.install,-10);function Cl(e){return(Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Il(e,t){return!t||"object"!==Cl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Al(e){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xl(e,t){return(xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ll(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rl(e,t,n){return t&&Nl(e.prototype,t),n&&Nl(e,n),e}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ml=window.shaka,Pl=(window.goog,function(){function e(){Ll(this,e)}return Rl(e,null,[{key:"install",value:function(){var t=e.prefixApi_;if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Ml.log.info("Using webkit-prefixed EME v0.1b"),e.prefix_="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;Ml.log.info("Using nonprefixed EME v0.1b")}window.asserts.assert(HTMLMediaElement.prototype[t("generateKeyRequest")],"PatchedMediaKeysWebkit APIs not available!"),e.MediaKeyStatusMap.KEY_ID_=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess}}},{key:"prefixApi_",value:function(t){var n=e.prefix_;return n?n+t.charAt(0).toUpperCase()+t.slice(1):t}},{key:"requestMediaKeySystemAccess",value:function(t,n){Ml.log.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess"),window.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');try{var r=new e.MediaKeySystemAccess(t,n);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}},{key:"setMediaKeys",value:function(t){Ml.log.debug("PatchedMediaKeysWebkit.setMediaKeys"),window.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var n=t,r=this.mediaKeys;return r&&r!=n&&(window.asserts.assert(r instanceof e.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,this.mediaKeys=t,n&&(window.asserts.assert(n instanceof e.MediaKeys,"non-polyfill instance of newMediaKeys"),n.setMedia(this)),Promise.resolve()}},{key:"getVideoElement_",value:function(){var e=document.getElementsByTagName("video");return e.length?e[0]:document.createElement("video")}}]),e}());Pl.MediaKeySystemAccess=function(){function e(t,n){Ll(this,e),Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.keySystem=t,this.internalKeySystem_=t,this.configuration_;var r=!1;"org.w3.clearkey"==t&&(this.internalKeySystem_="webkit-org.w3.clearkey",r=!1);var i=!1,a=Pl.getVideoElement_(),s=!0,o=!1,u=void 0;try{for(var l,c=n[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value,h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:d.initDataTypes,sessionTypes:["temporary"],label:d.label},f=!1;if(d.audioCapabilities){var p=!0,m=!1,v=void 0;try{for(var y,g=d.audioCapabilities[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value;if(_.contentType){f=!0;var b=_.contentType.split(";")[0];a.canPlayType(b,this.internalKeySystem_)&&(h.audioCapabilities.push(_),i=!0)}}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}}if(d.videoCapabilities){var w=!0,E=!1,S=void 0;try{for(var T,k=d.videoCapabilities[Symbol.iterator]();!(w=(T=k.next()).done);w=!0){var C=T.value;C.contentType&&(f=!0,a.canPlayType(C.contentType,this.internalKeySystem_)&&(h.videoCapabilities.push(C),i=!0))}}catch(e){E=!0,S=e}finally{try{w||null==k.return||k.return()}finally{if(E)throw S}}}if(f||(i=a.canPlayType("video/mp4",this.internalKeySystem_)||a.canPlayType("video/webm",this.internalKeySystem_)),"required"==d.persistentState&&(r?(h.persistentState="required",h.sessionTypes=["persistent-license"]):i=!1),i)return void(this.configuration_=h)}}catch(e){o=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}var I="Unsupported keySystem";"org.w3.clearkey"!=t&&"com.widevine.alpha"!=t||(I="None of the requested configurations were supported.");var A=new Error(I);throw A.name="NotSupportedError",A.code=DOMException.NOT_SUPPORTED_ERR,A}return Rl(e,[{key:"createMediaKeys",value:function(){Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new Pl.MediaKeys(this.internalKeySystem_);return Promise.resolve(e)}},{key:"getConfiguration",value:function(){return Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.configuration_}}]),e}(),Pl.MediaKeys=function(){function e(t){Ll(this,e),Ml.log.debug("PatchedMediaKeysWebkit.MediaKeys"),this.keySystem_=t,this.media_=null,this.eventManager_=new he,this.newSessions_=[],this.sessionMap_=new Map}return Rl(e,[{key:"setMedia",value:function(e){var t=this;this.media_=e,this.eventManager_.removeAll();var n=Pl.prefix_;e&&(this.eventManager_.listen(e,n+"needkey",function(e){return t.onWebkitNeedKey_(e)}),this.eventManager_.listen(e,n+"keymessage",function(e){return t.onWebkitKeyMessage_(e)}),this.eventManager_.listen(e,n+"keyadded",function(e){return t.onWebkitKeyAdded_(e)}),this.eventManager_.listen(e,n+"keyerror",function(e){return t.onWebkitKeyError_(e)}))}},{key:"createSession",value:function(e){if(Ml.log.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.media_||document.createElement("video");t.src||(t.src="about:blank");var n=new Pl.MediaKeySession(t,this.keySystem_,e);return this.newSessions_.push(n),n}},{key:"setServerCertificate",value:function(e){return Ml.log.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)}},{key:"onWebkitNeedKey_",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e),window.asserts.assert(this.media_,"media_ not set in onWebkitNeedKey_");var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.media_.dispatchEvent(t)}},{key:"onWebkitKeyMessage_",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=this.findSession_(e.sessionId);if(t){var n=null==t.keyStatuses.getStatus(),r=new Ml.util.FakeEvent("message",{messageType:n?"licenserequest":"licenserenewal",message:e.message});t.generated(),t.dispatchEvent(r)}else Ml.log.error("Session not found",e.sessionId)}},{key:"onWebkitKeyAdded_",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e);var t=this.findSession_(e.sessionId);window.asserts.assert(t,"unable to find session in onWebkitKeyAdded_"),t&&t.ready()}},{key:"onWebkitKeyError_",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=this.findSession_(e.sessionId);window.asserts.assert(t,"unable to find session in onWebkitKeyError_"),t&&t.handleError(e)}},{key:"findSession_",value:function(e){var t=this.sessionMap_.get(e);return t?(Ml.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):(t=this.newSessions_.shift())?(t.sessionId=e,this.sessionMap_.set(e,t),Ml.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):null}}]),e}(),Pl.MediaKeySession=function(e){function t(e,n,r){var i;return Ll(this,t),Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession"),(i=Il(this,Al(t).call(this))).media_=e,i.initialized_=!1,i.generatePromise_=null,i.updatePromise_=null,i.keySystem_=n,i.type_=r,i.sessionId="",i.expiration=NaN,i.closed=new we,i.keyStatuses=new Pl.MediaKeyStatusMap,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xl(e,t)}(t,H),Rl(t,[{key:"generated",value:function(){Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),this.generatePromise_&&(this.generatePromise_.resolve(),this.generatePromise_=null)}},{key:"ready",value:function(){Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),this.updateKeyStatus_("usable"),this.updatePromise_&&this.updatePromise_.resolve(),this.updatePromise_=null}},{key:"handleError",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=new Error("EME v0.1b key error");if(t.errorCode=e.errorCode,t.errorCode.systemCode=e.systemCode,!e.sessionId&&this.generatePromise_)t.method="generateRequest",45==e.systemCode&&(t.message="Unsupported session type."),this.generatePromise_.reject(t),this.generatePromise_=null;else if(e.sessionId&&this.updatePromise_)t.method="update",this.updatePromise_.reject(t),this.updatePromise_=null;else{var n=e.errorCode.code,r=e.systemCode;n==MediaKeyError.MEDIA_KEYERR_OUTPUT?this.updateKeyStatus_("output-restricted"):1==r?this.updateKeyStatus_("expired"):this.updateKeyStatus_("internal-error")}}},{key:"generate_",value:function(e,t){var n,r=this;if(this.initialized_){var i=new Error("The session is already initialized.");return Promise.reject(i)}this.initialized_=!0;try{if("persistent-license"==this.type_){var a=Ml.util.StringUtils;if(t)n=new Uint8Array(a.toUTF8("LOAD_SESSION|"+t));else{var s=a.toUTF8("PERSISTENT|"),o=new Uint8Array(s.byteLength+e.byteLength);o.set(new Uint8Array(s),0),o.set(new Uint8Array(e),s.byteLength),n=o}}else window.asserts.assert("temporary"==this.type_,"expected temporary session"),window.asserts.assert(!t,"unexpected offline session ID"),n=new Uint8Array(e);window.asserts.assert(n,"init data not set!")}catch(e){return Promise.reject(e)}window.asserts.assert(null==this.generatePromise_,"generatePromise_ should be null"),this.generatePromise_=new we;var u=(0,Ml.polyfill.PatchedMediaKeysWebkit.prefixApi_)("generateKeyRequest");try{this.media_[u](this.keySystem_,n)}catch(e){if("InvalidStateError"!=e.name)return this.generatePromise_=null,Promise.reject(e);new ve(function(){try{r.media_[u](r.keySystem_,n)}catch(e){r.generatePromise_.reject(e),r.generatePromise_=null}}).tickAfter(.01)}return this.generatePromise_}},{key:"update_",value:function(e,t){var n=this;if(this.updatePromise_)this.updatePromise_.then(function(){return n.update_(e,t)}).catch(function(){return n.update_(e,t)});else{var r,i;if(this.updatePromise_=e,"webkit-org.w3.clearkey"==this.keySystem_){var a=ft.fromUTF8(t),s=JSON.parse(a);"oct"!=s.keys[0].kty&&(this.updatePromise_.reject(new Error("Response is not a valid JSON Web Key Set.")),this.updatePromise_=null),r=mt.fromBase64(s.keys[0].k),i=mt.fromBase64(s.keys[0].kid)}else r=new Uint8Array(t),i=null;var o=(0,Pl.prefixApi_)("addKey");try{this.media_[o](this.keySystem_,r,i,this.sessionId)}catch(e){this.updatePromise_.reject(e),this.updatePromise_=null}}}},{key:"updateKeyStatus_",value:function(e){this.keyStatuses.setStatus(e);var t=new D("keystatuseschange");this.dispatchEvent(t)}},{key:"generateRequest",value:function(e,t){return Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),this.generate_(t,null)}},{key:"load",value:function(e){return Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.type_?this.generate_(null,e):Promise.reject(new Error("Not a persistent session."))}},{key:"update",value:function(e){Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e),window.asserts.assert(this.sessionId,"update without session ID");var t=new we;return this.update_(t,e),t}},{key:"close",value:function(){if(Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.type_){if(!this.sessionId)return this.closed.reject(new Error("The session is not callable.")),this.closed;var e=(0,Pl.prefixApi_)("cancelKeyRequest");try{this.media_[e](this.keySystem_,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed}},{key:"remove",value:function(){return Ml.log.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.type_?Promise.reject(new Error("Not a persistent session.")):this.close()}}]),t}(),Pl.MediaKeyStatusMap=function(){function e(){Ll(this,e),this.size=0,this.status_=void 0}return Rl(e,[{key:"setStatus",value:function(e){this.size=null==e?0:1,this.status_=e}},{key:"getStatus",value:function(){return this.status_}},{key:"forEach",value:function(e){if(this.status_){var t=Pl.MediaKeyStatusMap.KEY_ID_;e(this.status_,t)}}},{key:"get",value:function(e){if(this.has(e))return this.status_}},{key:"has",value:function(e){var t=Pl.MediaKeyStatusMap.KEY_ID_;return!(!this.status_||!Ml.util.Uint8ArrayUtils.equal(new Uint8Array(e),new Uint8Array(t)))}},{key:"entries",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}},{key:"keys",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}},{key:"values",value:function(){window.asserts.assert(!1,"Not used!  Provided only for compiler.")}}]),e}(),Pl.prefix_="",Pl.MediaKeyStatusMap.KEY_ID_,Fu.register(Pl.install);function Ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Dl=window.shaka,Ul=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||t.webkitSupportsPresentationMode&&(Dl.log.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=e.requestPictureInPicture_,document.exitPictureInPicture=e.exitPictureInPicture_,document.addEventListener("webkitpresentationmodechanged",e.proxyEvent_,!0))}}},{key:"proxyEvent_",value:function(t){var n=t.target;if(n.webkitPresentationMode==e.PIP_MODE_){document.pictureInPictureElement=n;var r=new Event("enterpictureinpicture");n.dispatchEvent(r)}else{document.pictureInPictureElement==n&&(document.pictureInPictureElement=null);var i=new Event("leavepictureinpicture");n.dispatchEvent(i)}}},{key:"requestPictureInPicture_",value:function(){if(this.webkitSupportsPresentationMode(e.PIP_MODE_))return this.webkitSetPresentationMode(e.PIP_MODE_),document.pictureInPictureElement=this,Promise.resolve();var t=new Error("PiP not allowed by video element");return Promise.reject(t)}},{key:"exitPictureInPicture_",value:function(){var t=document.pictureInPictureElement;if(t)return t.webkitSetPresentationMode(e.INLINE_MODE_),document.pictureInPictureElement=null,Promise.resolve();var n=new Error("No picture in picture element found");return Promise.reject(n)}}],(n=null)&&Ol(t.prototype,n),r&&Ol(t,r),e}();Ul.PIP_MODE_="picture-in-picture",Ul.INLINE_MODE_="inline",Fu.register(Ul.install);function Fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Bl=window.shaka,Vl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.VTTCue)Bl.log.info("Using native VTTCue.");else if(window.TextTrackCue){var t=TextTrackCue.length;3==t?(Bl.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=e.from3ArgsTextTrackCue_):6==t?(Bl.log.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=e.from6ArgsTextTrackCue_):e.canUse3ArgsTextTrackCue_()&&(Bl.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=e.from3ArgsTextTrackCue_)}else Bl.log.error("VTTCue not available.")}},{key:"from3ArgsTextTrackCue_",value:function(e,t,n){return new window.TextTrackCue(e,t,n)}},{key:"from6ArgsTextTrackCue_",value:function(e,t,n){var r=e+"-"+t+"-"+n;return new window.TextTrackCue(r,e,t,n)}},{key:"canUse3ArgsTextTrackCue_",value:function(){try{return!!e.from3ArgsTextTrackCue_(1,2,"")}catch(e){return!1}}}],(n=null)&&Fl(t.prototype,n),r&&Fl(t,r),e}();Fu.register(Vl.install);function jl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hl=window.shaka,Kl=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(Hl.log.debug("VideoPlayPromise.install"),window.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}}],(n=null)&&jl(t.prototype,n),r&&jl(t,r),e}());Fu.register(Kl.install);function Gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka;var Wl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"install",value:function(){if(window.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.getVideoPlaybackQuality||"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=e.webkit_)}}},{key:"webkit_",value:function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}}],(n=null)&&Gl(t.prototype,n),r&&Gl(t,r),e}();Fu.register(Wl.install);function ql(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yl=window.shaka,Xl=(window.goog,function(){function e(){ql(this,e)}var t,n,r;return t=e,r=[{key:"getLeafNodes_",value:function(e){var t=[];if(!e)return t;for(var n=e.childNodes,r=0;r<n.length;r++){var i="span"==n[r].nodeName&&"p"==e.nodeName;if(n[r].nodeType==Node.ELEMENT_NODE&&"br"!=n[r].nodeName&&!i){window.asserts.assert(n[r]instanceof Element,"Node should be Element!");var a=Yl.text.TtmlTextParser.getLeafNodes_(n[r]);window.asserts.assert(a.length>0,"Only a null Element should return no leaves!"),t=t.concat(a)}}return t.length||t.push(e),t}},{key:"addNewLines_",value:function(e,t){for(var n=e.childNodes,r=0;r<n.length;r++)if("br"==n[r].nodeName&&r>0)n[r-1].textContent+="\n";else if(n[r].childNodes.length>0)Yl.text.TtmlTextParser.addNewLines_(n[r],t);else if(t){var i=n[r].textContent.trim();i=i.replace(/\s+/g," "),n[r].textContent=i}}},{key:"parseCue_",value:function(e,t,n,r,i,a,s,o){if(!e.hasAttribute("begin")&&!e.hasAttribute("end")&&/^\s*$/.test(e.textContent))return null;Yl.text.TtmlTextParser.addNewLines_(e,o);var u=Yl.text.TtmlTextParser.parseTime_(e.getAttribute("begin"),n),l=Yl.text.TtmlTextParser.parseTime_(e.getAttribute("end"),n),c=Yl.text.TtmlTextParser.parseTime_(e.getAttribute("dur"),n),d=e.textContent;if(null==l&&null!=c&&(l=u+c),null==u||null==l)throw new Yl.util.Error(Yl.util.Error.Severity.CRITICAL,Yl.util.Error.Category.TEXT,Yl.util.Error.Code.INVALID_TEXT_CUE);u+=t,l+=t;var h=new Yl.text.Cue(u,l,d),f=Yl.text.TtmlTextParser.getElementFromCollection_(e,"region",a,"");if(f&&f.getAttribute("xml:id")){var p=f.getAttribute("xml:id"),m=s.filter(function(e){return e.id==p});h.region=m[0]}var v=Yl.text.TtmlTextParser.getElementFromCollection_(e,"smpte:backgroundImage",r,"#");return Yl.text.TtmlTextParser.addStyle_(h,e,f,v,i),h}},{key:"parseCueRegion_",value:function(e,t,n){var r=Yl.text.TtmlTextParser,i=new Yl.text.CueRegion,a=e.getAttribute("xml:id");if(!a)return Yl.log.warning("TtmlTextParser parser encountered a region with no id. Region will be ignored."),null;i.id=a;var s=null;n&&(s=r.percentValues_.exec(n)||r.pixelValues_.exec(n));var o=s?Number(s[1]):null,u=s?Number(s[2]):null,l=null,c=null,d=r.getStyleAttributeFromRegion_(e,t,"extent");d&&null!=(l=(c=r.percentValues_.exec(d))||r.pixelValues_.exec(d))&&(i.width=null!=o?100*Number(l[1])/o:Number(l[1]),i.height=null!=u?100*Number(l[2])/u:Number(l[2]),i.widthUnits=c||null!=o?Yl.text.CueRegion.units.PERCENTAGE:Yl.text.CueRegion.units.PX,i.heightUnits=c||null!=u?Yl.text.CueRegion.units.PERCENTAGE:Yl.text.CueRegion.units.PX);var h=r.getStyleAttributeFromRegion_(e,t,"origin");return h&&null!=(l=(c=r.percentValues_.exec(h))||r.pixelValues_.exec(h))&&(i.viewportAnchorX=null!=u?100*Number(l[1])/u:Number(l[1]),i.viewportAnchorY=null!=o?100*Number(l[2])/o:Number(l[2]),i.viewportAnchorUnits=c||null!=o?Yl.text.CueRegion.units.PERCENTAGE:Yl.text.CueRegion.units.PX),i}},{key:"addStyle_",value:function(e,t,n,r,i){var a=Yl.text.TtmlTextParser,s=Yl.text.Cue;"rtl"==a.getStyleAttribute_(t,n,i,"direction")&&(e.direction=s.direction.HORIZONTAL_RIGHT_TO_LEFT);var o=a.getStyleAttribute_(t,n,i,"writingMode");"tb"==o||"tblr"==o?e.writingMode=s.writingMode.VERTICAL_LEFT_TO_RIGHT:"tbrl"==o?e.writingMode=s.writingMode.VERTICAL_RIGHT_TO_LEFT:"rltb"==o||"rl"==o?e.direction=s.direction.HORIZONTAL_RIGHT_TO_LEFT:o&&(e.direction=s.direction.HORIZONTAL_LEFT_TO_RIGHT);var u=a.getStyleAttribute_(t,n,i,"textAlign");u&&(e.positionAlign=a.textAlignToPositionAlign_[u],e.lineAlign=a.textAlignToLineAlign_[u],window.asserts.assert(u.toUpperCase()in s.textAlign,u.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=s.textAlign[u.toUpperCase()]);var l=a.getStyleAttribute_(t,n,i,"displayAlign");l&&(window.asserts.assert(l.toUpperCase()in s.displayAlign,l.toUpperCase()+" Should be in Cue.displayAlign values!"),e.displayAlign=s.displayAlign[l.toUpperCase()]);var c=a.getStyleAttribute_(t,n,i,"color");c&&(e.color=c);var d=a.getStyleAttribute_(t,n,i,"backgroundColor");d&&(e.backgroundColor=d);var h=a.getStyleAttribute_(t,n,i,"fontFamily");h&&(e.fontFamily=h);var f=a.getStyleAttribute_(t,n,i,"fontWeight");f&&"bold"==f&&(e.fontWeight=s.fontWeight.BOLD);var p=a.getStyleAttribute_(t,n,i,"wrapOption");p&&"noWrap"==p&&(e.wrapLine=!1);var m=a.getStyleAttribute_(t,n,i,"lineHeight");m&&m.match(a.unitValues_)&&(e.lineHeight=m);var v=a.getStyleAttribute_(t,n,i,"fontSize");v&&v.match(a.unitValues_)&&(e.fontSize=v);var y=a.getStyleAttribute_(t,n,i,"fontStyle");if(y&&(window.asserts.assert(y.toUpperCase()in s.fontStyle,y.toUpperCase()+" Should be in Cue.fontStyle values!"),e.fontStyle=s.fontStyle[y.toUpperCase()]),r){var g=r.getAttribute("imagetype"),_=r.getAttribute("encoding"),b=r.textContent;"PNG"==g&&"Base64"==_&&b&&(e.backgroundImage="data:image/png;base64,"+b)}var w=a.getStyleAttributeFromRegion_(n,i,"textDecoration");w&&a.addTextDecoration_(e,w);var E=a.getStyleAttributeFromElement_(t,i,"textDecoration");E&&a.addTextDecoration_(e,E)}},{key:"addTextDecoration_",value:function(e,t){for(var n=Yl.text.Cue,r=t.split(" "),i=0;i<r.length;i++)switch(r[i]){case"underline":e.textDecoration.includes(n.textDecoration.UNDERLINE)||e.textDecoration.push(n.textDecoration.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(n.textDecoration.UNDERLINE)&&Fn.remove(e.textDecoration,n.textDecoration.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(n.textDecoration.LINE_THROUGH)||e.textDecoration.push(n.textDecoration.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(n.textDecoration.LINE_THROUGH)&&Fn.remove(e.textDecoration,n.textDecoration.LINE_THROUGH);break;case"overline":e.textDecoration.includes(n.textDecoration.OVERLINE)||e.textDecoration.push(n.textDecoration.OVERLINE);break;case"noOverline":e.textDecoration.includes(n.textDecoration.OVERLINE)&&Fn.remove(e.textDecoration,n.textDecoration.OVERLINE)}}},{key:"getStyleAttribute_",value:function(e,t,n,r){var i=Yl.text.TtmlTextParser,a=i.getStyleAttributeFromElement_(e,n,r);return a||i.getStyleAttributeFromRegion_(t,n,r)}},{key:"getStyleAttributeFromRegion_",value:function(e,t,n){for(var r=Yl.text.TtmlTextParser.styleNs_,i=Yl.text.TtmlTextParser.getLeafNodes_(e),a=0;a<i.length;a++){var s=Gs.getAttributeNS(i[a],r,n);if(s)return s}var o=Yl.text.TtmlTextParser.getElementFromCollection_(e,"style",t,"");return o?Gs.getAttributeNS(o,r,n):null}},{key:"getStyleAttributeFromElement_",value:function(e,t,n){var r=Yl.text.TtmlTextParser.styleNs_,i=(0,Yl.text.TtmlTextParser.getElementFromCollection_)(e,"style",t,"");return i?Gs.getAttributeNS(i,r,n):null}},{key:"getElementFromCollection_",value:function(e,t,n,r){if(!e||n.length<1)return null;var i=null,a=Yl.text.TtmlTextParser.getInheritedAttribute_(e,t);if(a)for(var s=0;s<n.length;s++)if(r+n[s].getAttribute("xml:id")==a){i=n[s];break}return i}},{key:"getInheritedAttribute_",value:function(e,t){for(var n=null;e&&!(n=e.getAttribute(t));){var r=e.parentNode;if(!(r instanceof Element))break;e=r}return n}},{key:"parseTime_",value:function(e,t){var n=null,r=Yl.text.TtmlTextParser;return r.timeColonFormatFrames_.test(e)?n=r.parseColonTimeWithFrames_(t,e):r.timeColonFormat_.test(e)?n=r.parseTimeFromRegex_(r.timeColonFormat_,e):r.timeColonFormatMilliseconds_.test(e)?n=r.parseTimeFromRegex_(r.timeColonFormatMilliseconds_,e):r.timeFramesFormat_.test(e)?n=r.parseFramesTime_(t,e):r.timeTickFormat_.test(e)?n=r.parseTickTime_(t,e):r.timeHMSFormat_.test(e)&&(n=r.parseTimeFromRegex_(r.timeHMSFormat_,e)),n}},{key:"parseFramesTime_",value:function(e,t){var n=Yl.text.TtmlTextParser.timeFramesFormat_.exec(t);return Number(n[1])/e.frameRate}},{key:"parseTickTime_",value:function(e,t){var n=Yl.text.TtmlTextParser.timeTickFormat_.exec(t);return Number(n[1])/e.tickRate}},{key:"parseColonTimeWithFrames_",value:function(e,t){var n=Yl.text.TtmlTextParser.timeColonFormatFrames_.exec(t),r=Number(n[1]),i=Number(n[2]),a=Number(n[3]),s=Number(n[4]);return(a+=(s+=(Number(n[5])||0)/e.subFrameRate)/e.frameRate)+60*i+3600*r}},{key:"parseTimeFromRegex_",value:function(e,t){var n=e.exec(t);if(null==n||""==n[0])return null;var r=Number(n[1])||0,i=Number(n[2])||0,a=Number(n[3])||0;return(Number(n[4])||0)/1e3+a+60*i+3600*r}}],(n=[{key:"parseInit",value:function(e){window.asserts.assert(!1,"TTML does not have init segments")}},{key:"parseMedia",value:function(t,n){var r=e.parameterNs_,i=ft.fromUTF8(t),a=[],s=new DOMParser,o=null;try{o=s.parseFromString(i,"text/xml")}catch(e){throw new Yl.util.Error(Yl.util.Error.Severity.CRITICAL,Yl.util.Error.Category.TEXT,Yl.util.Error.Code.INVALID_XML)}if(o){var u=null,l=null,c=null,d=null,h=null,f=null,p=o.getElementsByTagName("tt")[0];if(!p)throw new Yl.util.Error(Yl.util.Error.Severity.CRITICAL,Yl.util.Error.Category.TEXT,Yl.util.Error.Code.INVALID_XML);if(u=Gs.getAttributeNS(p,r,"frameRate"),l=Gs.getAttributeNS(p,r,"subFrameRate"),c=Gs.getAttributeNS(p,r,"frameRateMultiplier"),d=Gs.getAttributeNS(p,r,"tickRate"),h=p.getAttribute("xml:space")||"default",f=p.getAttribute("tts:extent"),"default"!=h&&"preserve"!=h)throw new Yl.util.Error(Yl.util.Error.Severity.CRITICAL,Yl.util.Error.Category.TEXT,Yl.util.Error.Code.INVALID_XML);for(var m="default"==h,v=new e.RateInfo_(u,l,c,d),y=e.getLeafNodes_(p.getElementsByTagName("metadata")[0]),g=e.getLeafNodes_(p.getElementsByTagName("styling")[0]),_=e.getLeafNodes_(p.getElementsByTagName("layout")[0]),b=[],w=0;w<_.length;w++){var E=e.parseCueRegion_(_[w],g,f);E&&b.push(E)}for(var S=e.getLeafNodes_(p.getElementsByTagName("body")[0]),T=0;T<S.length;T++){var k=e.parseCue_(S[T],n.periodStart,v,y,g,_,b,m);k&&a.push(k)}}return a}}])&&zl(t.prototype,n),r&&zl(t,r),e}());Xl.RateInfo_=function(){return function e(t,n,r,i){if(ql(this,e),this.frameRate=Number(t)||30,this.subFrameRate=Number(n)||1,this.tickRate=Number(i),0==this.tickRate&&(this.tickRate=t?this.frameRate*this.subFrameRate:1),r){var a=/^(\d+) (\d+)$/g.exec(r);if(a){var s=Number(a[1])/Number(a[2]);this.frameRate*=s}}}}(),Xl.percentValues_=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,Xl.unitValues_=/^(\d+px|\d+em)$/,Xl.pixelValues_=/^(\d+)px (\d+)px$/,Xl.timeColonFormatFrames_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Xl.timeColonFormat_=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Xl.timeColonFormatMilliseconds_=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Xl.timeFramesFormat_=/^(\d*(?:\.\d*)?)f$/,Xl.timeTickFormat_=/^(\d*(?:\.\d*)?)t$/,Xl.timeHMSFormat_=new RegExp(["^(?:(\\d*(?:\\.\\d*)?)h)?","(?:(\\d*(?:\\.\\d*)?)m)?","(?:(\\d*(?:\\.\\d*)?)s)?","(?:(\\d*(?:\\.\\d*)?)ms)?$"].join("")),Xl.textAlignToLineAlign_={left:Dt.lineAlign.START,center:Dt.lineAlign.CENTER,right:Dt.lineAlign.END,start:Dt.lineAlign.START,end:Dt.lineAlign.END},Xl.textAlignToPositionAlign_={left:Dt.positionAlign.LEFT,center:Dt.positionAlign.CENTER,right:Dt.positionAlign.RIGHT},Xl.parameterNs_="http://www.w3.org/ns/ttml#parameter",Xl.styleNs_="http://www.w3.org/ns/ttml#styling",Ht.registerParser("application/ttml+xml",Xl);var $l=Xl;function Ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Zl=window.shaka,Jl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parser_=new $l}var t,n,r;return t=e,(n=[{key:"parseInit",value:function(e){var t=!1;if((new Ai).box("moov",Ai.children).box("trak",Ai.children).box("mdia",Ai.children).box("minf",Ai.children).box("stbl",Ai.children).fullBox("stsd",Ai.sampleDescription).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_MP4_TTML)}},{key:"parseMedia",value:function(e,t){var n=this,r=Zl.util.Mp4Parser,i=!1,a=[];if((new r).box("mdat",r.allData(function(e){i=!0,a=a.concat(n.parser_.parseMedia(e,t))})).parse(e),!i)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_MP4_TTML);return a}}])&&Ql(t.prototype,n),r&&Ql(t,r),e}();Ht.registerParser('application/mp4; codecs="stpp"',Jl),Ht.registerParser('application/mp4; codecs="stpp.TTML.im1t"',Jl);function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var tc=window.shaka,nc=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parseRegion_",value:function(t){var n=new Wo(t),r=new Ut;n.readWord(),n.skipWhitespace();for(var i=n.readWord();i;)e.parseRegionSetting_(r,i)||tc.log.warning("VTT parser encountered an invalid VTTRegion setting: ",i," The setting will be ignored."),n.skipWhitespace(),i=n.readWord();return r}},{key:"parseCue_",value:function(t,n,r){if(1==t.length&&!t[0])return null;if(/^NOTE($|[ \t])/.test(t[0]))return null;if("STYLE"==t[0])return null;var i=null;t[0].includes("--\x3e")||(i=t[0],t.splice(0,1));var a=new Wo(t[0]),s=e.parseTime_(a),o=a.readRegex(/[ \t]+-->[ \t]+/g),u=e.parseTime_(a);if(null==s||null==o||null==u)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_TEXT_CUE);s+=n,u+=n;var l=t.slice(1).join("\n").trim(),c=new Dt(s,u,l);a.skipWhitespace();for(var d=a.readWord();d;)e.parseCueSetting(c,d,r)||tc.log.warning("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),a.skipWhitespace(),d=a.readWord();return null!=i&&(c.id=i),c}},{key:"parseCueSetting",value:function(t,n,r){var i=null;if(i=/^align:(start|middle|center|end|left|right)$/.exec(n))e.setTextAlign_(t,i[1]);else if(i=/^vertical:(lr|rl)$/.exec(n))e.setVerticalWritingMode_(t,i[1]);else if(i=/^size:([\d.]+)%$/.exec(n))t.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(n))t.position=Number(i[1]),i[2]&&e.setPositionAlign_(t,i[2]);else{if(!(i=/^region:(.*)$/.exec(n)))return e.parsedLineValueAndInterpretation_(t,n);var a=e.getRegionById_(r,i[1]);a&&(t.region=a)}return!0}},{key:"getRegionById_",value:function(e,t){var n=e.filter(function(e){return e.id==t});return n.length?(window.asserts.assert(1==n.length,"VTTRegion ids should be unique!"),n[0]):(tc.log.warning("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}},{key:"parseRegionSetting_",value:function(e,t){var n=null;if(n=/^id=(.*)$/.exec(t))e.id=n[1];else if(n=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(n[1]);else if(n=/^lines=(\d+)$/.exec(t))e.height=Number(n[1]),e.heightUnits=tc.text.CueRegion.units.LINES;else if(n=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(n[1]),e.regionAnchorY=Number(n[2]);else if(n=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(n[1]),e.viewportAnchorY=Number(n[2]);else{if(!(n=/^scroll=up$/.exec(t)))return!1;e.scroll=tc.text.CueRegion.scrollMode.UP}return!0}},{key:"setTextAlign_",value:function(e,t){"middle"==t?e.textAlign=Dt.textAlign.CENTER:(window.asserts.assert(t.toUpperCase()in Dt.textAlign,t.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=Dt.textAlign[t.toUpperCase()])}},{key:"setPositionAlign_",value:function(e,t){var n=tc.text.Cue;e.positionAlign="line-left"==t||"start"==t?n.positionAlign.LEFT:"line-right"==t||"end"==t?n.positionAlign.RIGHT:n.positionAlign.CENTER}},{key:"setVerticalWritingMode_",value:function(e,t){e.writingMode="lr"==t?Dt.writingMode.VERTICAL_LEFT_TO_RIGHT:Dt.writingMode.VERTICAL_RIGHT_TO_LEFT}},{key:"parsedLineValueAndInterpretation_",value:function(e,t){var n=null;if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=Dt.lineInterpretation.PERCENTAGE,e.line=Number(n[1]),n[2]&&(window.asserts.assert(n[2].toUpperCase()in Dt.lineAlign,n[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=Dt.lineAlign[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=Dt.lineInterpretation.LINE_NUMBER,e.line=Number(n[1]),n[2]&&(window.asserts.assert(n[2].toUpperCase()in Dt.lineAlign,n[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=Dt.lineAlign[n[2].toUpperCase()])}return!0}},{key:"parseTime_",value:function(e){var t=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==t)return null;var n=Number(t[1])||0,r=Number(t[2]),i=Number(t[3]),a=Number(t[4]);return r>59||i>59?null:a/1e3+i+60*r+3600*n}}],(n=[{key:"parseInit",value:function(e){window.asserts.assert(!1,"VTT does not have init segments")}},{key:"parseMedia",value:function(t,n){var r=ft.fromUTF8(t),i=(r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(i[0]))throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_TEXT_HEADER);var a=n.segmentStart;if(null==a&&(a=0,i[0].includes("X-TIMESTAMP-MAP"))){var s=i[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=i[0].match(/MPEGTS:(\d+)/m);if(s&&o){var u=new Wo(s[1]),l=e.parseTime_(u);if(null==l)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_TEXT_HEADER);var c=Number(o[1]),d=e.MPEG_TIMESCALE_;a=n.periodStart+(c/d-l)}}for(var h=[],f=i[0].split("\n"),p=1;p<f.length;p++)if(/^Region:/.test(f[p])){var m=e.parseRegion_(f[p]);h.push(m)}for(var v=[],y=1;y<i.length;y++){f=i[y].split("\n");var g=e.parseCue_(f,a,h);g&&v.push(g)}return v}}])&&ec(t.prototype,n),r&&ec(t,r),e}());nc.MPEG_TIMESCALE_=9e4,Ht.registerParser("text/vtt",nc),Ht.registerParser('text/vtt; codecs="vtt"',nc);var rc=nc;function ic(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ac=window.shaka,sc=(window.goog,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timescale_=null}var t,n,r;return t=e,r=[{key:"parseTFHD_",value:function(e,t){return t.skip(4),1&e&&t.skip(8),2&e&&t.skip(4),8&e?t.readUint32():null}},{key:"parseTRUN_",value:function(e,t,n){var r=n.readUint32();1&t&&n.skip(4),4&t&&n.skip(4);for(var i=[],a=0;a<r;a++){var s={duration:null,sampleSize:null,timeOffset:null};256&t&&(s.duration=n.readUint32()),512&t&&(s.sampleSize=n.readUint32()),1024&t&&n.skip(4),2048&t&&(s.timeOffset=0==e?n.readUint32():n.readInt32()),i.push(s)}return i}},{key:"parseVTTC_",value:function(e,t,n){var r,i,a;return(new ac.util.Mp4Parser).box("payl",ac.util.Mp4Parser.allData(function(e){r=ft.fromUTF8(e)})).box("iden",ac.util.Mp4Parser.allData(function(e){i=ft.fromUTF8(e)})).box("sttg",ac.util.Mp4Parser.allData(function(e){a=ft.fromUTF8(e)})).parse(e),r?ac.text.Mp4VttParser.assembleCue_(r,i,a,t,n):null}},{key:"assembleCue_",value:function(e,t,n,r,i){var a=new Dt(r,i,e);if(t&&(a.id=t),n)for(var s=new Wo(n),o=s.readWord();o;)rc.parseCueSetting(a,o,[])||ac.log.warning("VTT parser encountered an invalid VTT setting: ",o," The setting will be ignored."),s.skipWhitespace(),o=s.readWord();return a}}],(n=[{key:"parseInit",value:function(e){var t=this,n=!1;if((new Ai).box("moov",Ai.children).box("trak",Ai.children).box("mdia",Ai.children).fullBox("mdhd",function(e){window.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),0==e.version?(e.reader.skip(4),e.reader.skip(4),t.timescale_=e.reader.readUint32(),e.reader.skip(4)):(e.reader.skip(8),e.reader.skip(8),t.timescale_=e.reader.readUint32(),e.reader.skip(8)),e.reader.skip(4)}).box("minf",Ai.children).box("stbl",Ai.children).fullBox("stsd",Ai.sampleDescription).box("wvtt",function(e){n=!0}).parse(e),!this.timescale_)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_MP4_VTT);if(!n)throw new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_MP4_VTT)}},{key:"parseMedia",value:function(t,n){if(!this.timescale_)throw ac.log.error("No init segment for MP4+VTT!"),new A(A.Severity.CRITICAL,A.Category.TEXT,A.Code.INVALID_MP4_VTT);var r,i=0,a=[],s=[],o=!1,u=!1,l=!1,c=null;if((new Ai).box("moof",Ai.children).box("traf",Ai.children).fullBox("tfdt",function(e){o=!0,window.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),i=0==e.version?e.reader.readUint32():e.reader.readUint64()}).fullBox("tfhd",function(t){window.asserts.assert(null!=t.flags,"A TFHD box should have a valid flags value"),c=e.parseTFHD_(t.flags,t.reader)}).fullBox("trun",function(t){u=!0,window.asserts.assert(null!=t.version,"A TRUN box should have a valid version value"),window.asserts.assert(null!=t.flags,"A TRUN box should have a valid flags value"),a=e.parseTRUN_(t.version,t.flags,t.reader)}).box("mdat",Ai.allData(function(e){window.asserts.assert(!l,"VTT cues in mp4 with multiple MDAT are not currently supported"),l=!0,r=e})).parse(t),!l&&!o&&!u)throw new ac.util.Error(ac.util.Error.Severity.CRITICAL,ac.util.Error.Category.TEXT,ac.util.Error.Code.INVALID_MP4_VTT);var d=i,h=new DataView(r.buffer,r.byteOffset,r.byteLength),f=new Ti(h,Ti.Endianness.BIG_ENDIAN),p=!0,m=!1,v=void 0;try{for(var y,g=a[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var _=y.value,b=_.duration||c,w=_.timeOffset?i+_.timeOffset:d;d=w+(b||0);var E=0;do{var S=f.readUint32();E+=S;var T=f.readUint32(),k=ac.util.Mp4Parser.typeToString(T),C=null;"vttc"==k?S>8&&(C=f.readBytes(S-8)):"vtte"==k?f.skip(S-8):(ac.log.error("Unknown box "+k+"! Skipping!"),f.skip(S-8)),b?C&&(window.asserts.assert(null!=this.timescale_,"Timescale should not be null!"),s.push(ac.text.Mp4VttParser.parseVTTC_(C,n.periodStart+w/this.timescale_,n.periodStart+d/this.timescale_))):ac.log.error("WVTT sample duration unknown, and no default found!"),window.asserts.assert(!_.sampleSize||E<=_.sampleSize,"The samples do not fit evenly into the sample sizes given in the TRUN box!")}while(_.sampleSize&&E<_.sampleSize)}}catch(e){m=!0,v=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw v}}return window.asserts.assert(!f.hasMoreData(),"MDAT which contain VTT cues and non-VTT data are not currently supported!"),s.filter(q.isNotNull)}}])&&ic(t.prototype,n),r&&ic(t,r),e}());sc.TimeSegment,Ht.registerParser('application/mp4; codecs="wvtt"',sc);function oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var uc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.controls=n,this.eventManager=new he,this.localization=this.controls.getLocalization(),this.player=this.controls.getPlayer(),this.video=this.controls.getVideo()}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){return this.eventManager.release(),this.parent=null,this.controls=null,this.eventManager=null,this.localization=null,this.player=null,this.video=null,Promise.resolve()}}])&&oc(t.prototype,n),r&&oc(t,r),e}();function lc(e){return(lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cc(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function dc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fc(e,t,n){return t&&hc(e.prototype,t),n&&hc(e,n),e}function pc(e,t){return!t||"object"!==lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mc(e,t,n){return(mc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function vc(e){return(vc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yc(e,t){return(yc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gc=c.util.Dom;window.shaka=window.shaka||{};var _c=window.shaka;window.goog=window.goog||{};window.goog;var bc=function(e){function t(e,n){var r;dc(this,t),(r=pc(this,vc(t).call(this,e,n))).config_=r.controls.getConfig(),r.controlsContainer_=r.controls.getControlsContainer(),r.children_=[],r.addOverflowMenuButton_(),r.addOverflowMenu_(),r.createChildren_();for(var i=r.controls.getVideoContainer().getElementsByClassName("shaka-back-to-overflow-button"),a=0;a<i.length;a++){var s=i[a];r.eventManager.listen(s,"click",function(){r.controls.hideSettingsMenus(),oe.setDisplay(r.overflowMenu_,!0),r.overflowMenu_.childNodes.length&&r.overflowMenu_.childNodes[0].focus(),r.controls.overrideCssShowControls()})}return r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.controls,"submenuopen",function(){oe.setDisplay(r.overflowMenu_,!1)}),r.eventManager.listen(r.overflowMenu_,"touchstart",function(e){r.controls.setLastTouchEventTime(Date.now()),e.stopPropagation()}),r.eventManager.listen(r.overflowMenuButton_,"click",function(){r.onOverflowMenuButtonClick_()}),r.eventManager.listen(r.controlsContainer_,"touchstart",function(e){r.overflowMenu_.classList.contains("shaka-displayed")&&(oe.setDisplay(r.overflowMenu_,!1),e.preventDefault())}),r.updateAriaLabel_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yc(e,t)}(t,uc),fc(t,[{key:"destroy",value:function(){var e,n=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.controlsContainer_=null,e.next=3,Promise.all(this.children_.map(function(e){return e.destroy()}));case 3:return this.children_=[],e.next=6,mc(vc(t.prototype),"destroy",this).call(this);case 6:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){cc(a,r,i,s,o,"next",e)}function o(e){cc(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return n.apply(this,arguments)}}()},{key:"addOverflowMenu_",value:function(){this.overflowMenu_=gc.createHTMLElement("div"),this.overflowMenu_.classList.add("shaka-overflow-menu"),this.overflowMenu_.classList.add("shaka-no-propagation"),this.overflowMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.overflowMenu_.classList.add("shaka-settings-menu"),this.controlsContainer_.appendChild(this.overflowMenu_)}},{key:"addOverflowMenuButton_",value:function(){this.overflowMenuButton_=gc.createHTMLElement("button"),this.overflowMenuButton_.classList.add("shaka-overflow-menu-button"),this.overflowMenuButton_.classList.add("shaka-no-propagation"),this.overflowMenuButton_.classList.add("material-icons"),this.overflowMenuButton_.textContent=R.MaterialDesignIcons.OPEN_OVERFLOW,this.parent.appendChild(this.overflowMenuButton_)}},{key:"createChildren_",value:function(){for(var e=0;e<this.config_.overflowMenuButtons.length;e++){var n=this.config_.overflowMenuButtons[e];if(t.elementNamesToFactories_.get(n)){var r=t.elementNamesToFactories_.get(n);window.asserts.assert(this.controls,"Controls should not be null!"),this.children_.push(r.create(this.overflowMenu_,this.controls))}else _c.log.alwaysWarn("Unrecognized overflow menu element requested:",n)}}},{key:"onOverflowMenuButtonClick_",value:function(){if(this.controls.anySettingsMenusAreOpen())this.controls.hideSettingsMenus();else{oe.setDisplay(this.overflowMenu_,!0),this.controls.overrideCssShowControls();var e=function(e){return 0==e.classList.contains("shaka-hidden")};if(G.some(this.overflowMenu_.childNodes,e))G.filter(this.overflowMenu_.childNodes,e)[0].focus()}}},{key:"updateAriaLabel_",value:function(){var e=P.Ids;this.overflowMenuButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.MORE_SETTINGS))}}],[{key:"registerElement",value:function(e,n){t.elementNamesToFactories_.set(e,n)}}]),t}();bc.Factory=function(){function e(){dc(this,e)}return fc(e,[{key:"create",value:function(e,t){return new bc(e,t)}}]),e}(),Ke.registerElement("overflow_menu",new bc.Factory),bc.elementNamesToFactories_=new Map;for(var wc=bc,Ec={LanguageMapping:{ach:{nativeName:"Lwo",englishName:"Acholi"},ady:{nativeName:"Адыгэбзэ",englishName:"Adyghe"},af:{nativeName:"Afrikaans",englishName:"Afrikaans"},"af-NA":{nativeName:"Afrikaans (Namibia)",englishName:"Afrikaans (Namibia)"},"af-ZA":{nativeName:"Afrikaans (South Africa)",englishName:"Afrikaans (South Africa)"},ak:{nativeName:"Tɕɥi",englishName:"Akan"},ar:{nativeName:"العربية",englishName:"Arabic"},"ar-AR":{nativeName:"العربية",englishName:"Arabic"},"ar-MA":{nativeName:"العربية",englishName:"Arabic (Morocco)"},"ar-SA":{nativeName:"العربية (السعودية)",englishName:"Arabic (Saudi Arabia)"},"ay-BO":{nativeName:"Aymar aru",englishName:"Aymara"},az:{nativeName:"Azərbaycan dili",englishName:"Azerbaijani"},"az-AZ":{nativeName:"Azərbaycan dili",englishName:"Azerbaijani"},"be-BY":{nativeName:"Беларуская",englishName:"Belarusian"},bg:{nativeName:"Български",englishName:"Bulgarian"},"bg-BG":{nativeName:"Български",englishName:"Bulgarian"},bn:{nativeName:"বাংলা",englishName:"Bengali"},"bn-IN":{nativeName:"বাংলা (ভারত)",englishName:"Bengali (India)"},"bn-BD":{nativeName:"বাংলা(বাংলাদেশ)",englishName:"Bengali (Bangladesh)"},"bs-BA":{nativeName:"Bosanski",englishName:"Bosnian"},ca:{nativeName:"Català",englishName:"Catalan"},"ca-ES":{nativeName:"Català",englishName:"Catalan"},cak:{nativeName:"Maya Kaqchikel",englishName:"Kaqchikel"},"ck-US":{nativeName:"ᏣᎳᎩ (tsalagi)",englishName:"Cherokee"},cs:{nativeName:"Čeština",englishName:"Czech"},"cs-CZ":{nativeName:"Čeština",englishName:"Czech"},cy:{nativeName:"Cymraeg",englishName:"Welsh"},"cy-GB":{nativeName:"Cymraeg",englishName:"Welsh"},da:{nativeName:"Dansk",englishName:"Danish"},"da-DK":{nativeName:"Dansk",englishName:"Danish"},de:{nativeName:"Deutsch",englishName:"German"},"de-AT":{nativeName:"Deutsch (Österreich)",englishName:"German (Austria)"},"de-DE":{nativeName:"Deutsch (Deutschland)",englishName:"German (Germany)"},"de-CH":{nativeName:"Deutsch (Schweiz)",englishName:"German (Switzerland)"},dsb:{nativeName:"Dolnoserbšćina",englishName:"Lower Sorbian"},el:{nativeName:"Ελληνικά",englishName:"Greek"},"el-GR":{nativeName:"Ελληνικά",englishName:"Greek (Greece)"},en:{nativeName:"English",englishName:"English"},"en-GB":{nativeName:"English (UK)",englishName:"English (UK)"},"en-AU":{nativeName:"English (Australia)",englishName:"English (Australia)"},"en-CA":{nativeName:"English (Canada)",englishName:"English (Canada)"},"en-IE":{nativeName:"English (Ireland)",englishName:"English (Ireland)"},"en-IN":{nativeName:"English (India)",englishName:"English (India)"},"en-PI":{nativeName:"English (Pirate)",englishName:"English (Pirate)"},"en-UD":{nativeName:"English (Upside Down)",englishName:"English (Upside Down)"},"en-US":{nativeName:"English (US)",englishName:"English (US)"},"en-ZA":{nativeName:"English (South Africa)",englishName:"English (South Africa)"},"en@pirate":{nativeName:"English (Pirate)",englishName:"English (Pirate)"},eo:{nativeName:"Esperanto",englishName:"Esperanto"},"eo-EO":{nativeName:"Esperanto",englishName:"Esperanto"},es:{nativeName:"Español",englishName:"Spanish"},"es-AR":{nativeName:"Español (Argentine)",englishName:"Spanish (Argentina)"},"es-419":{nativeName:"Español (Latinoamérica)",englishName:"Spanish (Latin America)"},"es-CL":{nativeName:"Español (Chile)",englishName:"Spanish (Chile)"},"es-CO":{nativeName:"Español (Colombia)",englishName:"Spanish (Colombia)"},"es-EC":{nativeName:"Español (Ecuador)",englishName:"Spanish (Ecuador)"},"es-ES":{nativeName:"Español (España)",englishName:"Spanish (Spain)"},"es-LA":{nativeName:"Español (Latinoamérica)",englishName:"Spanish (Latin America)"},"es-NI":{nativeName:"Español (Nicaragua)",englishName:"Spanish (Nicaragua)"},"es-MX":{nativeName:"Español (México)",englishName:"Spanish (Mexico)"},"es-US":{nativeName:"Español (Estados Unidos)",englishName:"Spanish (United States)"},"es-VE":{nativeName:"Español (Venezuela)",englishName:"Spanish (Venezuela)"},et:{nativeName:"eesti keel",englishName:"Estonian"},"et-EE":{nativeName:"Eesti (Estonia)",englishName:"Estonian (Estonia)"},eu:{nativeName:"Euskara",englishName:"Basque"},"eu-ES":{nativeName:"Euskara",englishName:"Basque"},fa:{nativeName:"فارسی",englishName:"Persian"},"fa-IR":{nativeName:"فارسی",englishName:"Persian"},"fb-LT":{nativeName:"Leet Speak",englishName:"Leet"},ff:{nativeName:"Fulah",englishName:"Fulah"},fi:{nativeName:"Suomi",englishName:"Finnish"},"fi-FI":{nativeName:"Suomi",englishName:"Finnish"},"fo-FO":{nativeName:"Føroyskt",englishName:"Faroese"},fr:{nativeName:"Français",englishName:"French"},"fr-CA":{nativeName:"Français (Canada)",englishName:"French (Canada)"},"fr-FR":{nativeName:"Français (France)",englishName:"French (France)"},"fr-BE":{nativeName:"Français (Belgique)",englishName:"French (Belgium)"},"fr-CH":{nativeName:"Français (Suisse)",englishName:"French (Switzerland)"},"fy-NL":{nativeName:"Frysk",englishName:"Frisian (West)"},ga:{nativeName:"Gaeilge",englishName:"Irish"},"ga-IE":{nativeName:"Gaeilge (Gaelic)",englishName:"Irish (Gaelic)"},gl:{nativeName:"Galego",englishName:"Galician"},"gl-ES":{nativeName:"Galego",englishName:"Galician"},"gn-PY":{nativeName:"Avañe'ẽ",englishName:"Guarani"},"gu-IN":{nativeName:"ગુજરાતી",englishName:"Gujarati"},"gx-GR":{nativeName:"Ἑλληνική ἀρχαία",englishName:"Classical Greek"},he:{nativeName:"עברית‏",englishName:"Hebrew"},"he-IL":{nativeName:"עברית‏",englishName:"Hebrew"},hi:{nativeName:"हिन्दी",englishName:"Hindi"},"hi-IN":{nativeName:"हिन्दी",englishName:"Hindi"},hr:{nativeName:"Hrvatski",englishName:"Croatian"},"hr-HR":{nativeName:"Hrvatski",englishName:"Croatian"},hsb:{nativeName:"Hornjoserbšćina",englishName:"Upper Sorbian"},ht:{nativeName:"Kreyòl",englishName:"Haitian Creole"},hu:{nativeName:"Magyar",englishName:"Hungarian"},"hu-HU":{nativeName:"Magyar",englishName:"Hungarian"},"hy-AM":{nativeName:"Հայերեն",englishName:"Armenian"},id:{nativeName:"Bahasa Indonesia",englishName:"Indonesian"},"id-ID":{nativeName:"Bahasa Indonesia",englishName:"Indonesian"},is:{nativeName:"Íslenska",englishName:"Icelandic"},"is-IS":{nativeName:"Íslenska (Iceland)",englishName:"Icelandic (Iceland)"},it:{nativeName:"Italiano",englishName:"Italian"},"it-IT":{nativeName:"Italiano",englishName:"Italian"},ja:{nativeName:"日本語",englishName:"Japanese"},"ja-JP":{nativeName:"日本語",englishName:"Japanese"},"jv-ID":{nativeName:"Basa Jawa",englishName:"Javanese"},"ka-GE":{nativeName:"ქართული",englishName:"Georgian"},"kk-KZ":{nativeName:"Қазақша",englishName:"Kazakh"},km:{nativeName:"ភាសាខ្មែរ",englishName:"Khmer"},"km-KH":{nativeName:"ភាសាខ្មែរ",englishName:"Khmer"},kab:{nativeName:"Taqbaylit",englishName:"Kabyle"},kn:{nativeName:"ಕನ್ನಡ",englishName:"Kannada"},"kn-IN":{nativeName:"ಕನ್ನಡ (India)",englishName:"Kannada (India)"},ko:{nativeName:"한국어",englishName:"Korean"},"ko-KR":{nativeName:"한국어 (韩国)",englishName:"Korean (Korea)"},ku:{nativeName:"Kurdî",englishName:"Kurdish"},"ku-TR":{nativeName:"Kurdî",englishName:"Kurdish"},la:{nativeName:"Latin",englishName:"Latin"},"la-VA":{nativeName:"Latin",englishName:"Latin"},lb:{nativeName:"Lëtzebuergesch",englishName:"Luxembourgish"},"li-NL":{nativeName:"Lèmbörgs",englishName:"Limburgish"},lt:{nativeName:"Lietuvių",englishName:"Lithuanian"},"lt-LT":{nativeName:"Lietuvių",englishName:"Lithuanian"},lv:{nativeName:"Latviešu",englishName:"Latvian"},"lv-LV":{nativeName:"Latviešu",englishName:"Latvian"},mai:{nativeName:"मैथिली, মৈথিলী",englishName:"Maithili"},"mg-MG":{nativeName:"Malagasy",englishName:"Malagasy"},mk:{nativeName:"Македонски",englishName:"Macedonian"},"mk-MK":{nativeName:"Македонски (Македонски)",englishName:"Macedonian (Macedonian)"},ml:{nativeName:"മലയാളം",englishName:"Malayalam"},"ml-IN":{nativeName:"മലയാളം",englishName:"Malayalam"},"mn-MN":{nativeName:"Монгол",englishName:"Mongolian"},mr:{nativeName:"मराठी",englishName:"Marathi"},"mr-IN":{nativeName:"मराठी",englishName:"Marathi"},ms:{nativeName:"Bahasa Melayu",englishName:"Malay"},"ms-MY":{nativeName:"Bahasa Melayu",englishName:"Malay"},mt:{nativeName:"Malti",englishName:"Maltese"},"mt-MT":{nativeName:"Malti",englishName:"Maltese"},my:{nativeName:"ဗမာစကာ",englishName:"Burmese"},nb:{nativeName:"Norsk (bokmål)",englishName:"Norwegian (bokmal)"},"nb-NO":{nativeName:"Norsk (bokmål)",englishName:"Norwegian (bokmal)"},ne:{nativeName:"नेपाली",englishName:"Nepali"},"ne-NP":{nativeName:"नेपाली",englishName:"Nepali"},nl:{nativeName:"Nederlands",englishName:"Dutch"},"nl-BE":{nativeName:"Nederlands (België)",englishName:"Dutch (Belgium)"},"nl-NL":{nativeName:"Nederlands (Nederland)",englishName:"Dutch (Netherlands)"},"nn-NO":{nativeName:"Norsk (nynorsk)",englishName:"Norwegian (nynorsk)"},no:{nativeName:"Norsk",englishName:"Norwegian"},oc:{nativeName:"Occitan",englishName:"Occitan"},"or-IN":{nativeName:"ଓଡ଼ିଆ",englishName:"Oriya"},pa:{nativeName:"ਪੰਜਾਬੀ",englishName:"Punjabi"},"pa-IN":{nativeName:"ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)",englishName:"Punjabi (India)"},pl:{nativeName:"Polski",englishName:"Polish"},"pl-PL":{nativeName:"Polski",englishName:"Polish"},"ps-AF":{nativeName:"پښتو",englishName:"Pashto"},pt:{nativeName:"Português",englishName:"Portuguese"},"pt-BR":{nativeName:"Português (Brasil)",englishName:"Portuguese (Brazil)"},"pt-PT":{nativeName:"Português (Portugal)",englishName:"Portuguese (Portugal)"},"qu-PE":{nativeName:"Qhichwa",englishName:"Quechua"},"rm-CH":{nativeName:"Rumantsch",englishName:"Romansh"},ro:{nativeName:"Română",englishName:"Romanian"},"ro-RO":{nativeName:"Română",englishName:"Romanian"},ru:{nativeName:"Русский",englishName:"Russian"},"ru-RU":{nativeName:"Русский",englishName:"Russian"},"sa-IN":{nativeName:"संस्कृतम्",englishName:"Sanskrit"},"se-NO":{nativeName:"Davvisámegiella",englishName:"Northern Sámi"},"si-LK":{nativeName:"පළාත",englishName:"Sinhala (Sri Lanka)"},sk:{nativeName:"Slovenčina",englishName:"Slovak"},"sk-SK":{nativeName:"Slovenčina (Slovakia)",englishName:"Slovak (Slovakia)"},sl:{nativeName:"Slovenščina",englishName:"Slovenian"},"sl-SI":{nativeName:"Slovenščina",englishName:"Slovenian"},"so-SO":{nativeName:"Soomaaliga",englishName:"Somali"},sq:{nativeName:"Shqip",englishName:"Albanian"},"sq-AL":{nativeName:"Shqip",englishName:"Albanian"},sr:{nativeName:"Српски",englishName:"Serbian"},"sr-RS":{nativeName:"Српски (Serbia)",englishName:"Serbian (Serbia)"},su:{nativeName:"Basa Sunda",englishName:"Sundanese"},sv:{nativeName:"Svenska",englishName:"Swedish"},"sv-SE":{nativeName:"Svenska",englishName:"Swedish"},sw:{nativeName:"Kiswahili",englishName:"Swahili"},"sw-KE":{nativeName:"Kiswahili",englishName:"Swahili (Kenya)"},ta:{nativeName:"தமிழ்",englishName:"Tamil"},"ta-IN":{nativeName:"தமிழ்",englishName:"Tamil"},te:{nativeName:"తెలుగు",englishName:"Telugu"},"te-IN":{nativeName:"తెలుగు",englishName:"Telugu"},tg:{nativeName:"забо́ни тоҷикӣ́",englishName:"Tajik"},"tg-TJ":{nativeName:"тоҷикӣ",englishName:"Tajik"},th:{nativeName:"ภาษาไทย",englishName:"Thai"},"th-TH":{nativeName:"ภาษาไทย (ประเทศไทย)",englishName:"Thai (Thailand)"},tl:{nativeName:"Filipino",englishName:"Filipino"},"tl-PH":{nativeName:"Filipino",englishName:"Filipino"},tlh:{nativeName:"tlhIngan-Hol",englishName:"Klingon"},tr:{nativeName:"Türkçe",englishName:"Turkish"},"tr-TR":{nativeName:"Türkçe",englishName:"Turkish"},"tt-RU":{nativeName:"татарча",englishName:"Tatar"},uk:{nativeName:"Українська",englishName:"Ukrainian"},"uk-UA":{nativeName:"Українська",englishName:"Ukrainian"},ur:{nativeName:"اردو",englishName:"Urdu"},"ur-PK":{nativeName:"اردو",englishName:"Urdu"},uz:{nativeName:"O'zbek",englishName:"Uzbek"},"uz-UZ":{nativeName:"O'zbek",englishName:"Uzbek"},vi:{nativeName:"Tiếng Việt",englishName:"Vietnamese"},"vi-VN":{nativeName:"Tiếng Việt",englishName:"Vietnamese"},"xh-ZA":{nativeName:"isiXhosa",englishName:"Xhosa"},yi:{nativeName:"ייִדיש",englishName:"Yiddish"},"yi-DE":{nativeName:"ייִדיש (German)",englishName:"Yiddish (German)"},zh:{nativeName:"中文",englishName:"Chinese"},"zh-HANS":{nativeName:"中文简体",englishName:"Chinese Simplified"},"zh-HANT":{nativeName:"中文繁體",englishName:"Chinese Traditional"},"zh-CN":{nativeName:"中文（中国）",englishName:"Chinese Simplified (China)"},"zh-HK":{nativeName:"中文（香港）",englishName:"Chinese Traditional (Hong Kong)"},"zh-SG":{nativeName:"中文（新加坡）",englishName:"Chinese Simplified (Singapore)"},"zh-TW":{nativeName:"中文（台灣）",englishName:"Chinese Traditional (Taiwan)"},"zu-ZA":{nativeName:"isiZulu",englishName:"Zulu"}}},Sc=Ec,Tc=0,kc=Object.keys(Ec.LanguageMapping)
/**
 * @license
 * Copyright 2013 Ali Al Dallal
 *
 * Licensed under the MIT license.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */;Tc<kc.length;Tc++){var Cc=kc[Tc];Ec.LanguageMapping[Cc.toLowerCase()]=Ec.LanguageMapping[Cc]}function Ic(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ac=c.util.Dom,xc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"updateLanguages",value:function(t,n,r,i,a,s,o){var u=t.filter(function(e){return 1==e.active})[0],l=oe.getFirstDescendantWithClassName(n,"shaka-back-to-overflow-button");Ac.removeAllChildren(n),n.appendChild(l);var c=!0,d=!1,h=void 0;try{for(var f,p=function(){var t=f.value,r=Ac.createHTMLElement("button");r.addEventListener("click",function(){i(t)});var l=Ac.createHTMLElement("span");l.textContent=e.getLanguageName(t,o),r.appendChild(l),a&&t==u.language&&(r.appendChild(oe.checkmarkIcon()),l.classList.add("shaka-chosen-item"),r.setAttribute("aria-selected","true"),s.textContent=l.textContent),n.appendChild(r)},m=r[Symbol.iterator]();!(c=(f=m.next()).done);c=!0)p()}catch(e){d=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw h}}}},{key:"getLanguageName",value:function(e,t){if(!e&&!t)return"";var n=function(e){return t.resolve(e)};switch(e){case"mul":return n(P.Ids.MULTIPLE_LANGUAGES);case"und":return n(P.Ids.UNDETERMINED_LANGUAGE);case"zxx":return n(P.Ids.NOT_APPLICABLE)}var r=ne.getBase(e);return e in Sc.LanguageMapping?Sc.LanguageMapping[e].nativeName:r in Sc.LanguageMapping?Sc.LanguageMapping[r].nativeName+" ("+e+")":n(P.Ids.UNRECOGNIZED_LANGUAGE)+" ("+e+")"}}],(n=null)&&Ic(t.prototype,n),r&&Ic(t,r),e}();function Lc(e){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mc(e,t,n){return t&&Rc(e.prototype,t),n&&Rc(e,n),e}function Pc(e,t){return!t||"object"!==Lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oc(e){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dc(e,t){return(Dc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uc=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Fc=function(e){function t(e,n){var r;return Nc(this,t),(r=Pc(this,Oc(t).call(this,e,n))).addLanguagesButton_(),r.addAudioLangMenu_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r.eventManager.listen(r.player,"variantchanged",function(){r.updateAudioLanguages_()}),r.eventManager.listen(r.languagesButton_,"click",function(){r.onLanguagesClick_()}),r.updateLocalizedStrings_(),r.updateAudioLanguages_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dc(e,t)}(t,uc),Mc(t,[{key:"addAudioLangMenu_",value:function(){this.audioLangMenu_=Uc.createHTMLElement("div"),this.audioLangMenu_.classList.add("shaka-audio-languages"),this.audioLangMenu_.classList.add("shaka-no-propagation"),this.audioLangMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.audioLangMenu_.classList.add("shaka-settings-menu"),this.backFromLanguageButton_=Uc.createHTMLElement("button"),this.backFromLanguageButton_.classList.add("shaka-back-to-overflow-button"),this.audioLangMenu_.appendChild(this.backFromLanguageButton_);var e=Uc.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=R.MaterialDesignIcons.BACK,this.backFromLanguageButton_.appendChild(e),this.backFromLanguageSpan_=Uc.createHTMLElement("span"),this.backFromLanguageButton_.appendChild(this.backFromLanguageSpan_),this.controls.getControlsContainer().appendChild(this.audioLangMenu_)}},{key:"addLanguagesButton_",value:function(){this.languagesButton_=Uc.createHTMLElement("button"),this.languagesButton_.classList.add("shaka-language-button");var e=Uc.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=R.MaterialDesignIcons.LANGUAGE,this.languagesButton_.appendChild(e);var t=Uc.createHTMLElement("label");t.classList.add("shaka-overflow-button-label"),this.languageNameSpan_=Uc.createHTMLElement("span"),this.languageNameSpan_.classList.add("languageSpan"),t.appendChild(this.languageNameSpan_),this.currentAudioLanguage_=Uc.createHTMLElement("span"),this.currentAudioLanguage_.classList.add("shaka-current-selection-span");var n=this.player.getConfiguration().preferredAudioLanguage;this.currentAudioLanguage_.textContent=xc.getLanguageName(n,this.localization),t.appendChild(this.currentAudioLanguage_),this.languagesButton_.appendChild(t),this.parent.appendChild(this.languagesButton_)}},{key:"onLanguagesClick_",value:function(){this.controls.dispatchEvent(new D("submenuopen")),oe.setDisplay(this.audioLangMenu_,!0),oe.focusOnTheChosenItem(this.audioLangMenu_)}},{key:"updateAudioLanguages_",value:function(){var e=this,t=this.player.getVariantTracks(),n=this.player.getAudioLanguages();xc.updateLanguages(t,this.audioLangMenu_,n,function(t){return e.onAudioLanguageSelected_(t)},!0,this.currentAudioLanguage_,this.localization),oe.focusOnTheChosenItem(this.audioLangMenu_),this.controls.dispatchEvent(new D("languageselectionupdated"))}},{key:"onTracksChanged_",value:function(){var e=this.player.getVariantTracks().length>0;oe.setDisplay(this.languagesButton_,e),this.updateAudioLanguages_()}},{key:"onAudioLanguageSelected_",value:function(e){this.player.selectAudioLanguage(e)}},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.backFromLanguageButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.BACK)),this.languagesButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.LANGUAGE)),this.languageNameSpan_.textContent=this.localization.resolve(e.LANGUAGE),this.backFromLanguageSpan_.textContent=this.localization.resolve(e.LANGUAGE)}}]),t}();function Bc(e){return(Bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vc(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function jc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kc(e,t,n){return t&&Hc(e.prototype,t),n&&Hc(e,n),e}function Gc(e,t){return!t||"object"!==Bc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wc(e){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qc(e,t){return(qc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fc.Factory=function(){function e(){Nc(this,e)}return Mc(e,[{key:"create",value:function(e,t){return new Fc(e,t)}}]),e}(),wc.registerElement("language",new Fc.Factory);var zc=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Yc=function(e){function t(e,n){var r;jc(this,t),(r=Gc(this,Wc(t).call(this,e,n))).castProxy_=r.controls.getCastProxy(),r.castButton_=zc.createHTMLElement("button"),r.castButton_.classList.add("shaka-cast-button"),r.castButton_.setAttribute("aria-pressed","false"),r.castIcon_=zc.createHTMLElement("i"),r.castIcon_.classList.add("material-icons"),r.castIcon_.textContent=R.MaterialDesignIcons.CAST,r.castButton_.appendChild(r.castIcon_);var i=zc.createHTMLElement("label");return i.classList.add("shaka-overflow-button-label"),r.castNameSpan_=zc.createHTMLElement("span"),i.appendChild(r.castNameSpan_),r.castCurrentSelectionSpan_=zc.createHTMLElement("span"),r.castCurrentSelectionSpan_.classList.add("shaka-current-selection-span"),i.appendChild(r.castCurrentSelectionSpan_),r.castButton_.appendChild(i),r.parent.appendChild(r.castButton_),r.updateLocalizedStrings_(),r.onCastStatusChange_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.castButton_,"click",function(){r.onCastClick_()}),r.eventManager.listen(r.controls,"caststatuschanged",function(){r.onCastStatusChange_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qc(e,t)}(t,uc),Kc(t,[{key:"onCastClick_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.castProxy_.isCasting()){e.next=4;break}this.castProxy_.suggestDisconnect(),e.next=15;break;case 4:return e.prev=4,this.castButton_.disabled=!0,e.next=8,this.castProxy_.cast();case 8:this.castButton_.disabled=!1,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),this.castButton_.disabled=!1,e.t0.code!=Error.Code.CAST_CANCELED_BY_USER&&this.controls.dispatchEvent(new FakeEvent("error",{detail:e.t0}));case 15:case"end":return e.stop()}},e,this,[[4,11]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Vc(a,r,i,s,o,"next",e)}function o(e){Vc(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"onCastStatusChange_",value:function(){var e=this.castProxy_.canCast()&&this.controls.isCastAllowed(),t=this.castProxy_.isCasting(),n=R.MaterialDesignIcons;oe.setDisplay(this.castButton_,e),this.castIcon_.textContent=t?n.EXIT_CAST:n.CAST,e&&(t?this.castButton_.setAttribute("aria-pressed","true"):this.castButton_.setAttribute("aria-pressed","false")),this.setCurrentCastSelection_()}},{key:"setCurrentCastSelection_",value:function(){this.castProxy_.isCasting()?this.castCurrentSelectionSpan_.textContent=this.castProxy_.receiverName():this.castCurrentSelectionSpan_.textContent=this.localization.resolve(P.Ids.OFF)}},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.castButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.CAST)),this.castNameSpan_.textContent=this.localization.resolve(e.CAST),this.setCurrentCastSelection_()}}]),t}();Yc.Factory=function(){function e(){jc(this,e)}return Kc(e,[{key:"create",value:function(e,t){return new Yc(e,t)}}]),e}(),wc.registerElement("cast",new Yc.Factory);function Xc(e){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e,t,n){return t&&Qc(e.prototype,t),n&&Qc(e,n),e}function Jc(e,t){return!t||"object"!==Xc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ed(e){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function td(e,t){return(td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nd=c.util.Dom;window.shaka=window.shaka||{};var rd=window.shaka;window.goog=window.goog||{};window.goog;var id=function(e){function t(e,n){var r;return $c(this,t),(r=Jc(this,ed(t).call(this,e,n))).button_=nd.createHTMLElement("button"),r.button_.classList.add("material-icons"),r.button_.classList.add("shaka-fast-forward-button"),r.button_.textContent=rd.ui.Enums.MaterialDesignIcons.FAST_FORWARD,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.fastForward_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&td(e,t)}(t,uc),Zc(t,[{key:"updateAriaLabel_",value:function(){this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(Locales.Ids.FAST_FORWARD))}},{key:"fastForward_",value:function(){if(this.video.duration){var e=this.player.getPlaybackRate(),t=e<0||e>4?1:2*e;this.player.trickPlay(t)}}}]),t}();function ad(e){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sd(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function od(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ud(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ld(e,t,n){return t&&ud(e.prototype,t),n&&ud(e,n),e}function cd(e,t){return!t||"object"!==ad(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dd(e){return(dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hd(e,t){return(hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */id.Factory=function(){function e(){$c(this,e)}return Zc(e,[{key:"create",value:function(e,t){return new id(e,t)}}]),e}(),Ke.registerElement("fast_forward",new id.Factory);var fd=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var pd=function(e){function t(e,n){var r;return od(this,t),(r=cd(this,dd(t).call(this,e,n))).button_=fd.createHTMLElement("button"),r.button_.classList.add("shaka-fullscreen-button"),r.button_.classList.add("material-icons"),document.fullscreenEnabled||r.button_.classList.add("shaka-hidden"),r.button_.textContent=R.MaterialDesignIcons.FULLSCREEN,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.videoContainer_=r.controls.getVideoContainer(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.toggleFullScreen_()}),screen.orientation&&r.eventManager.listen(screen.orientation,"change",function(){r.onScreenRotation_()}),r.eventManager.listen(document,"fullscreenchange",function(){r.updateIcon_(),r.updateAriaLabel_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hd(e,t)}(t,uc),ld(t,[{key:"updateAriaLabel_",value:function(){var e=P.Ids,t=document.fullscreenElement?e.EXIT_FULL_SCREEN:e.FULL_SCREEN;this.button_.setAttribute(L.ARIA_LABEL,this.localization.resolve(t))}},{key:"updateIcon_",value:function(){this.button_.textContent=document.fullscreenElement?R.MaterialDesignIcons.EXIT_FULLSCREEN:R.MaterialDesignIcons.FULLSCREEN}},{key:"toggleFullScreen_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.fullscreenElement){e.next=4;break}document.exitFullscreen(),e.next=15;break;case 4:if(e.prev=4,!document.pictureInPictureElement){e.next=8;break}return e.next=8,document.exitPictureInPicture();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),this.controls.dispatchEvent(new FakeEvent("error",{detail:e.t0}));case 13:return e.next=15,this.videoContainer_.requestFullscreen();case 15:case"end":return e.stop()}},e,this,[[4,10]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){sd(a,r,i,s,o,"next",e)}function o(e){sd(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"onScreenRotation_",value:function(){this.video&&0!=this.video.readyState&&!this.controls.getCastProxy().isCasting()&&(screen.orientation.type.includes("landscape")&&!document.fullscreenElement?this.videoContainer_.requestFullscreen():screen.orientation.type.includes("portrait")&&document.fullscreenElement&&document.exitFullscreen())}}]),t}();function md(e){return(md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gd(e,t,n){return t&&yd(e.prototype,t),n&&yd(e,n),e}function _d(e){return(_d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wd(e,t){return(wd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}pd.Factory=function(){function e(){od(this,e)}return ld(e,[{key:"create",value:function(e,t){return new pd(e,t)}}]),e}(),Ke.registerElement("fullscreen",new pd.Factory);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ed=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Sd=function(e){function t(e,n){var r,i,a,s,o,u;return vd(this,t),i=this,a=_d(t).call(this,e,n),r=!a||"object"!==md(a)&&"function"!=typeof a?bd(i):a,s=bd(r),u=function(){var e=P.Ids,t=r.video.muted?e.UNMUTE:e.MUTE;r.button_.setAttribute(L.ARIA_LABEL,r.localization.resolve(t))},(o="updateAriaLabel_")in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,r.button_=Ed.createHTMLElement("button"),r.button_.classList.add("shaka-mute-button"),r.button_.classList.add("material-icons"),r.button_.textContent=R.MaterialDesignIcons.MUTE,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.video.muted=!r.video.muted}),r.eventManager.listen(r.video,"volumechange",function(){r.updateAriaLabel_(),r.updateIcon_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wd(e,t)}(t,uc),gd(t,[{key:"updateIcon_",value:function(){this.button_.textContent=this.video.muted?R.MaterialDesignIcons.UNMUTE:R.MaterialDesignIcons.MUTE}}]),t}();function Td(e){return(Td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kd(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Sd.Factory=function(){function e(){vd(this,e)}return gd(e,[{key:"create",value:function(e,t){return new Sd(e,t)}}]),e}(),Ke.registerElement("mute",new Sd.Factory);
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Id=c.util.ConfigUtils,Ad=c.util.Dom;window.shaka=window.shaka||{};var xd=window.shaka;window.goog=window.goog||{};window.goog;var Ld=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.player_=t,this.config_=this.defaultConfig_(),n.dataset.shakaPlayerContainer="",n.ui=this,this.isMobile()&&n.classList.add("shaka-mobile"),this.controls_=new Ke(t,n,r,this.config_),this.configure({})}var t,n,r;return t=e,n=[{key:"destroy",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controls_.destroy();case 2:return this.controls_=null,e.next=5,this.player_.destroy();case 5:this.player_=null;case 6:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){kd(a,r,i,s,o,"next",e)}function o(e){kd(a,r,i,s,o,"throw",e)}s(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"isMobile",value:function(){return lt.isMobile()}},{key:"getConfiguration",value:function(){var e=this.defaultConfig_();return Id.mergeConfigObjects(e,this.config_,this.defaultConfig_(),{},""),e}},{key:"configure",value:function(e,t){window.asserts.assert("object"==Td(e)||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=Id.convertToConfigObject(e,t)),window.asserts.assert("object"==Td(e),"Should be an object!"),Id.mergeConfigObjects(this.config_,e,this.defaultConfig_(),{},""),this.config_.castReceiverAppId&&!this.config_.overflowMenuButtons.includes("cast")&&this.config_.overflowMenuButtons.push("cast"),window.asserts.assert(null!=this.player_,"Should have a player!"),this.controls_.configure(this.config_),this.controls_.dispatchEvent(new D("uiupdated"))}},{key:"getPlayer",value:function(){return xd.Deprecate.deprecateFeature(2,6,"ui.Overlay.getPlayer()","Please use getControls().getPlayer() instead."),this.controls_.getPlayer()}},{key:"getControls",value:function(){return this.controls_}},{key:"setEnabled",value:function(e){this.controls_.setEnabledShakaControls(e)}},{key:"defaultConfig_",value:function(){return{controlPanelElements:["time_and_duration","spacer","mute","volume","fullscreen","overflow_menu"],overflowMenuButtons:["captions","quality","language","picture_in_picture","cast"],addSeekBar:!0,castReceiverAppId:""}}}],r=[{key:"scanPageForShakaElements_",value:function(){if(Fu.installAll(),!ga.isBrowserSupported())return xd.log.error("Shaka Player does not support this browser. Please see https://tinyurl.com/y7s4j9tr for the list of supported browsers."),void e.dispatchLoadedEvent_("shaka-ui-load-failed");var t=document.querySelectorAll("[data-shaka-player-container]"),n=document.querySelectorAll("[data-shaka-player]");if(n.length||t.length)if(n.length&&!t.length){var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;window.asserts.assert("video"==u.tagName.toLowerCase(),"Should be a video element!");var l=document.createElement("div");u.parentElement.replaceChild(l,u),l.appendChild(u);var c="";u.dataset&&u.dataset.shakaPlayerCastReceiverId&&(c=u.dataset.shakaPlayerCastReceiverId);var d=e.createUI_(Ad.asHTMLElement(l),Ad.asHTMLMediaElement(u));d.configure({castReceiverAppId:c}),Ad.asHTMLMediaElement(u).controls&&d.getControls().setEnabledNativeControls(!0)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}else{var h=!0,f=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var y=m.value;window.asserts.assert("div"==y.tagName.toLowerCase(),"Container should be a div!");var g="";y.dataset&&y.dataset.shakaPlayerCastReceiverId&&(g=y.dataset.shakaPlayerCastReceiverId);var _=null,b=!0,w=!1,E=void 0;try{for(var S,T=n[Symbol.iterator]();!(b=(S=T.next()).done);b=!0){var k=S.value;if(window.asserts.assert("video"==k.tagName.toLowerCase(),"Should be a video element!"),k.parentElement==y){_=k;break}}}catch(e){w=!0,E=e}finally{try{b||null==T.return||T.return()}finally{if(w)throw E}}_||((_=document.createElement("video")).setAttribute("playsinline",""),y.appendChild(_)),_.dataset&&_.dataset.shakaPlayerCastReceiverId&&(g=_.dataset.shakaPlayerCastReceiverId),e.createUI_(Ad.asHTMLElement(y),Ad.asHTMLMediaElement(_)).configure({castReceiverAppId:g})}}catch(e){f=!0,p=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw p}}}else;e.dispatchLoadedEvent_("shaka-ui-loaded")}},{key:"dispatchLoadedEvent_",value:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,null),document.dispatchEvent(t)}},{key:"createUI_",value:function(t,n){var r=new ga(n),i=new e(r,t,n);if(!n.controls){r.configure("textDisplayFactory",function(){return new La(n,t)})}return t.ui=i,n.ui=i,i}}],n&&Cd(t.prototype,n),r&&Cd(t,r),e}();function Nd(e){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rd(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Md(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Rd(a,r,i,s,o,"next",e)}function o(e){Rd(a,r,i,s,o,"throw",e)}s(void 0)})}}function Pd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Od(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dd(e,t,n){return t&&Od(e.prototype,t),n&&Od(e,n),e}function Ud(e,t){return!t||"object"!==Nd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fd(e){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bd(e,t){return(Bd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"complete"==document.readyState?Promise.resolve().then(Ld.scanPageForShakaElements_):window.addEventListener("load",Ld.scanPageForShakaElements_);var Vd=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var jd=function(e){function t(e,n){var r;Pd(this,t),(r=Ud(this,Fd(t).call(this,e,n))).localVideo_=r.controls.getLocalVideo();var i=P.Ids;r.pipButton_=Vd.createHTMLElement("button"),r.pipButton_.classList.add("shaka-pip-button"),r.pipIcon_=Vd.createHTMLElement("i"),r.pipIcon_.classList.add("material-icons"),r.pipIcon_.textContent=R.MaterialDesignIcons.PIP,r.pipButton_.appendChild(r.pipIcon_);var a=Vd.createHTMLElement("label");return a.classList.add("shaka-overflow-button-label"),r.pipNameSpan_=Vd.createHTMLElement("span"),r.pipNameSpan_.textContent=r.localization.resolve(i.PICTURE_IN_PICTURE),a.appendChild(r.pipNameSpan_),r.currentPipState_=Vd.createHTMLElement("span"),r.currentPipState_.classList.add("shaka-current-selection-span"),a.appendChild(r.currentPipState_),r.pipButton_.appendChild(a),r.updateLocalizedStrings_(),r.parent.appendChild(r.pipButton_),r.isPipAllowed_()||oe.setDisplay(r.pipButton_,!1),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.pipButton_,"click",function(){r.onPipClick_()}),r.eventManager.listen(r.localVideo_,"enterpictureinpicture",function(){r.onEnterPictureInPicture_()}),r.eventManager.listen(r.localVideo_,"leavepictureinpicture",function(){r.onLeavePictureInPicture_()}),r.eventManager.listen(r.controls,"caststatuschange",function(e){r.onCastStatusChange_(e)}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bd(e,t)}(t,uc),Dd(t,[{key:"isPipAllowed_",value:function(){return document.pictureInPictureEnabled&&!this.video.disablePictureInPicture}},{key:"onPipClick_",value:function(){var e=Md(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,document.pictureInPictureElement){e.next=7;break}return document.fullscreenElement&&document.exitFullscreen(),e.next=5,this.video.requestPictureInPicture();case 5:e.next=9;break;case 7:return e.next=9,document.exitPictureInPicture();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.controls.dispatchEvent(new D("error",{detail:e.t0}));case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"onEnterPictureInPicture_",value:function(){var e=P.Ids;this.pipIcon_.textContent=R.MaterialDesignIcons.EXIT_PIP,this.pipButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.EXIT_PICTURE_IN_PICTURE)),this.currentPipState_.textContent=this.localization.resolve(e.ON)}},{key:"onLeavePictureInPicture_",value:function(){var e=P.Ids;this.pipIcon_.textContent=R.MaterialDesignIcons.PIP,this.pipButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.ENTER_PICTURE_IN_PICTURE)),this.currentPipState_.textContent=this.localization.resolve(e.OFF)}},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.pipNameSpan_.textContent=this.localization.resolve(e.PICTURE_IN_PICTURE);var t=document.pictureInPictureElement?e.EXIT_PICTURE_IN_PICTURE:e.ENTER_PICTURE_IN_PICTURE;this.pipButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(t));var n=document.pictureInPictureElement?e.ON:e.OFF;this.currentPipState_.textContent=this.localization.resolve(n)}},{key:"onCastStatusChange_",value:function(e){e.newStatus?this.isPipAllowed_()&&oe.setDisplay(this.pipButton_,!1):this.isPipAllowed_()&&oe.setDisplay(this.pipButton_,!0)}},{key:"onTracksChanged_",value:function(){var e=Md(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPipAllowed_()){e.next=4;break}oe.setDisplay(this.pipButton_,!1),e.next=12;break;case 4:if(!this.player||!this.player.isAudioOnly()){e.next=11;break}if(oe.setDisplay(this.pipButton_,!1),!document.pictureInPictureElement){e.next=9;break}return e.next=9,document.exitPictureInPicture();case 9:e.next=12;break;case 11:oe.setDisplay(this.pipButton_,!0);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();function Hd(e){return(Hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wd(e,t,n){return t&&Gd(e.prototype,t),n&&Gd(e,n),e}function qd(e,t){return!t||"object"!==Hd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zd(e){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yd(e,t){return(Yd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jd.Factory=function(){function e(){Pd(this,e)}return Dd(e,[{key:"create",value:function(e,t){return new jd(e,t)}}]),e}(),wc.registerElement("picture_in_picture",new jd.Factory);var Xd=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var $d=function(e){function t(e,n){var r;Kd(this,t),(r=qd(this,zd(t).call(this,e,n))).button_=Xd.createHTMLElement("button"),r.button_.classList.add("shaka-play-pause-button"),r.button_.classList.add("material-icons"),r.parent.appendChild(r.button_),r.updateIcon_(),r.updateAriaLabel_();var i=ie.LOCALE_UPDATED;r.eventManager.listen(r.localization,i,function(){r.updateAriaLabel_()});var a=ie.LOCALE_CHANGED;return r.eventManager.listen(r.localization,a,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.video,"play",function(){r.updateAriaLabel_(),r.updateIcon_()}),r.eventManager.listen(r.video,"pause",function(){r.updateAriaLabel_(),r.updateIcon_()}),r.eventManager.listen(r.button_,"click",function(){r.isPaused_()?r.video.play():r.video.pause()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yd(e,t)}(t,uc),Wd(t,[{key:"isPaused_",value:function(){return this.video.paused&&!this.controls.isSeeking()}},{key:"updateAriaLabel_",value:function(){var e=Locales.Ids,t=this.isPaused_()?e.PLAY:e.PAUSE;this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(t))}},{key:"updateIcon_",value:function(){var e=R.MaterialDesignIcons;this.button_.textContent=this.isPaused_()?e.PLAY:e.PAUSE}}]),t}();function Qd(e){return(Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eh(e,t,n){return t&&Jd(e.prototype,t),n&&Jd(e,n),e}function th(e,t){return!t||"object"!==Qd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nh(e){return(nh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rh(e,t){return(rh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$d.Factory=function(){function e(){Kd(this,e)}return Wd(e,[{key:"create",value:function(e,t){return new $d(e,t)}}]),e}(),Ke.registerElement("play_pause",new $d.Factory);var ih=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var ah=function(e){function t(e,n){var r;return Zd(this,t),(r=th(this,nh(t).call(this,e,n))).currentTime_=ih.createHTMLElement("button"),r.currentTime_.classList.add("shaka-current-time"),r.currentTime_.textContent="0:00",r.parent.appendChild(r.currentTime_),r.eventManager.listen(r.currentTime_,"click",function(){r.player.isLive()&&(r.video.currentTime=r.player.seekRange().end)}),r.eventManager.listen(r.controls,"timeandseekrangeupdated",function(){r.updateTime_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rh(e,t)}(t,uc),eh(t,[{key:"updateTime_",value:function(){var e=this.controls.isSeeking(),t=this.controls.getDisplayTime(),n=this.video.duration,r=this.player.seekRange(),i=r.end-r.start;if(this.player.isLive()){var a=Math.floor(r.end-t),s=i>=3600;(t=Math.max(0,a))>=1||e?(this.currentTime_.textContent="- "+this.buildTimeString_(t,s),this.currentTime_.disabled=!1):(this.currentTime_.textContent=this.localization.resolve(P.Ids.LIVE),this.currentTime_.disabled=!0)}else{var o=n>=3600;this.currentTime_.textContent=this.buildTimeString_(t,o),n&&(this.currentTime_.textContent+=" / "+this.buildTimeString_(n,o)),this.currentTime_.disabled=!0}}},{key:"buildTimeString_",value:function(e,t){var n=Math.floor(e/3600),r=Math.floor(e/60%60),i=Math.floor(e%60);i<10&&(i="0"+i);var a=r+":"+i;return t&&(r<10&&(a="0"+a),a=n+":"+a),a}},{key:"onTracksChanged_",value:function(){if(this.player.isLive()){var e=P.Ids.SKIP_TO_LIVE;this.currentTime_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e))}}}]),t}();function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lh(e,t,n){return t&&uh(e.prototype,t),n&&uh(e,n),e}function ch(e,t){return!t||"object"!==sh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dh(e){return(dh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hh(e,t){return(hh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ah.Factory=function(){function e(){Zd(this,e)}return eh(e,[{key:"create",value:function(e,t){return new ah(e,t)}}]),e}(),Ke.registerElement("time_and_duration",new ah.Factory);var fh=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var ph=function(e){function t(e,n){var r;return oh(this,t),(r=ch(this,dh(t).call(this,e,n))).addResolutionButton_(),r.addResolutionMenu_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateLocalizedStrings_()}),r.eventManager.listen(r.resolutionButton_,"click",function(){r.onResolutionClick_()}),r.eventManager.listen(r.player,"variantchanged",function(){r.updateResolutionSelection_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.updateResolutionSelection_()}),r.eventManager.listen(r.player,"abrstatuschanged",function(){r.updateResolutionSelection_()}),r.updateResolutionSelection_(),r.updateLocalizedStrings_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hh(e,t)}(t,uc),lh(t,[{key:"addResolutionButton_",value:function(){this.resolutionButton_=fh.createHTMLElement("button"),this.resolutionButton_.classList.add("shaka-resolution-button");var e=fh.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=R.MaterialDesignIcons.RESOLUTION,this.resolutionButton_.appendChild(e);var t=fh.createHTMLElement("label");t.classList.add("shaka-overflow-button-label"),this.resolutionNameSpan_=fh.createHTMLElement("span"),t.appendChild(this.resolutionNameSpan_),this.currentResolution_=fh.createHTMLElement("span"),this.currentResolution_.classList.add("shaka-current-selection-span"),t.appendChild(this.currentResolution_),this.resolutionButton_.appendChild(t),this.parent.appendChild(this.resolutionButton_)}},{key:"addResolutionMenu_",value:function(){this.resolutionMenu_=fh.createHTMLElement("div"),this.resolutionMenu_.classList.add("shaka-resolutions"),this.resolutionMenu_.classList.add("shaka-no-propagation"),this.resolutionMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.resolutionMenu_.classList.add("shaka-settings-menu"),this.backFromResolutionButton_=fh.createHTMLElement("button"),this.backFromResolutionButton_.classList.add("shaka-back-to-overflow-button"),this.resolutionMenu_.appendChild(this.backFromResolutionButton_);var e=fh.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=R.MaterialDesignIcons.BACK,this.backFromResolutionButton_.appendChild(e),this.backFromResolutionSpan_=fh.createHTMLElement("span"),this.backFromResolutionButton_.appendChild(this.backFromResolutionSpan_),this.controls.getControlsContainer().appendChild(this.resolutionMenu_)}},{key:"updateResolutionSelection_",value:function(){var e=this,t=this.player.getVariantTracks();if(t.length&&!t[0].height)return oe.setDisplay(this.resolutionMenu_,!1),void oe.setDisplay(this.resolutionButton_,!1);oe.setDisplay(this.resolutionButton_,!0),t.sort(function(e,t){return e.height-t.height}),t.reverse();var n=t.find(function(e){return e.active});if(n){var r=n.language;t=t.filter(function(e){return e.language==r})}var i=oe.getFirstDescendantWithClassName(this.resolutionMenu_,"shaka-back-to-overflow-button");fh.removeAllChildren(this.resolutionMenu_),this.resolutionMenu_.appendChild(i);var a=this.player.getConfiguration().abr.enabled,s=!0,o=!1,u=void 0;try{for(var l,c=function(){var t=l.value,r=fh.createHTMLElement("button");r.classList.add("explicit-resolution"),e.eventManager.listen(r,"click",function(){return e.onTrackSelected_(t)});var i=fh.createHTMLElement("span");i.textContent=t.height+"p",r.appendChild(i),a||t!=n||(r.setAttribute("aria-selected","true"),r.appendChild(oe.checkmarkIcon()),i.classList.add("shaka-chosen-item"),e.currentResolution_.textContent=i.textContent),e.resolutionMenu_.appendChild(r)},d=t[Symbol.iterator]();!(s=(l=d.next()).done);s=!0)c()}catch(e){o=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(o)throw u}}var h=fh.createHTMLElement("button");h.classList.add("shaka-enable-abr-button"),this.eventManager.listen(h,"click",function(){e.player.configure({abr:{enabled:!0}}),e.updateResolutionSelection_()}),this.abrOnSpan_=fh.createHTMLElement("span"),this.abrOnSpan_.classList.add("shaka-auto-span"),this.abrOnSpan_.textContent=this.localization.resolve(P.Ids.AUTO_QUALITY),h.appendChild(this.abrOnSpan_),a&&(h.setAttribute("aria-selected","true"),h.appendChild(oe.checkmarkIcon()),this.abrOnSpan_.classList.add("shaka-chosen-item"),this.currentResolution_.textContent=this.localization.resolve(P.Ids.AUTO_QUALITY)),this.resolutionMenu_.appendChild(h),oe.focusOnTheChosenItem(this.resolutionMenu_),this.controls.dispatchEvent(new D("resolutionselectionupdated"))}},{key:"onResolutionClick_",value:function(){this.controls.dispatchEvent(new D("submenuopen")),oe.setDisplay(this.resolutionMenu_,!0),oe.focusOnTheChosenItem(this.resolutionMenu_)}},{key:"onTrackSelected_",value:function(e){this.player.configure({abr:{enabled:!1}}),this.player.selectVariantTrack(e,!0)}},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.resolutionButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.RESOLUTION)),this.backFromResolutionButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.RESOLUTION)),this.backFromResolutionSpan_.textContent=this.localization.resolve(e.RESOLUTION),this.resolutionNameSpan_.textContent=this.localization.resolve(e.RESOLUTION),this.abrOnSpan_.textContent=this.localization.resolve(e.AUTO_QUALITY),this.player.getConfiguration().abr.enabled&&(this.currentResolution_.textContent=this.localization.resolve(P.Ids.AUTO_QUALITY))}}]),t}();function mh(e){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gh(e,t,n){return t&&yh(e.prototype,t),n&&yh(e,n),e}function _h(e,t){return!t||"object"!==mh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bh(e){return(bh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wh(e,t){return(wh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ph.Factory=function(){function e(){oh(this,e)}return lh(e,[{key:"create",value:function(e,t){return new ph(e,t)}}]),e}(),wc.registerElement("quality",new ph.Factory);var Eh=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Sh=function(e){function t(e,n){var r;return vh(this,t),(r=_h(this,bh(t).call(this,e,n))).button_=Eh.createHTMLElement("button"),r.button_.classList.add("material-icons"),r.button_.classList.add("shaka-rewind-button"),r.button_.textContent=R.MaterialDesignIcons.REWIND,r.parent.appendChild(r.button_),r.updateAriaLabel_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.button_,"click",function(){r.rewind_()}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wh(e,t)}(t,uc),gh(t,[{key:"updateAriaLabel_",value:function(){this.button_.setAttribute(Constants.ARIA_LABEL,this.localization.resolve(Locales.Ids.REWIND))}},{key:"rewind_",value:function(){if(this.video.duration){var e=this.player.getPlaybackRate(),t=e>0||e<-4?-1:2*e;this.player.trickPlay(t)}}}]),t}();function Th(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ch(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ih(e,t){return!t||"object"!==kh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ah(e){return(Ah=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sh.Factory=function(){function e(){vh(this,e)}return gh(e,[{key:"create",value:function(e,t){return new Sh(e,t)}}]),e}(),Ke.registerElement("rewind",new Sh.Factory);var Lh=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var Nh=function(e){function t(e,n){var r;Ch(this,t),r=Ih(this,Ah(t).call(this,e,n));var i=Lh.createHTMLElement("div");return i.classList.add("shaka-spacer"),i.setAttribute("aria-hidden",!0),r.parent.appendChild(i),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(t,uc),t}();function Rh(e){return(Rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mh(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ph(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dh(e,t,n){return t&&Oh(e.prototype,t),n&&Oh(e,n),e}function Uh(e,t){return!t||"object"!==Rh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fh(e){return(Fh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bh(e,t){return(Bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nh.Factory=function(){function e(){Ch(this,e)}var t,n,r;return t=e,(n=[{key:"create",value:function(e,t){return new Nh(e,t)}}])&&Th(t.prototype,n),r&&Th(t,r),e}(),Ke.registerElement("spacer",new Nh.Factory);var Vh=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var jh=function(e){function t(e,n){var r;return Ph(this,t),(r=Uh(this,Fh(t).call(this,e,n))).addCaptionButton_(),r.addTextLangMenu_(),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateLocalizedStrings_(),r.updateTextLanguages_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateLocalizedStrings_(),r.updateTextLanguages_()}),r.eventManager.listen(r.player,"texttrackvisibility",function(){r.onCaptionStateChange_()}),r.eventManager.listen(r.captionButton_,"click",function(){r.onCaptionClick_()}),r.eventManager.listen(r.player,"textchanged",function(){r.updateTextLanguages_()}),r.eventManager.listen(r.player,"trackschanged",function(){r.onTracksChanged_()}),r.onCaptionStateChange_(),r.updateLocalizedStrings_(),r.updateTextLanguages_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bh(e,t)}(t,uc),Dh(t,[{key:"addCaptionButton_",value:function(){this.captionButton_=Vh.createHTMLElement("button"),this.captionButton_.classList.add("shaka-caption-button"),this.captionIcon_=Vh.createHTMLElement("i"),this.captionIcon_.classList.add("material-icons"),this.captionIcon_.textContent=R.MaterialDesignIcons.CLOSED_CAPTIONS,this.player&&this.player.isTextTrackVisible()?this.captionButton_.setAttribute("aria-pressed","true"):this.captionButton_.setAttribute("aria-pressed","false"),this.captionButton_.appendChild(this.captionIcon_);var e=Vh.createHTMLElement("label");e.classList.add("shaka-overflow-button-label"),this.captionsNameSpan_=Vh.createHTMLElement("span"),e.appendChild(this.captionsNameSpan_),this.currentCaptions_=Vh.createHTMLElement("span"),this.currentCaptions_.classList.add("shaka-current-selection-span"),e.appendChild(this.currentCaptions_),this.captionButton_.appendChild(e),this.parent.appendChild(this.captionButton_)}},{key:"addTextLangMenu_",value:function(){this.textLangMenu_=Vh.createHTMLElement("div"),this.textLangMenu_.classList.add("shaka-text-languages"),this.textLangMenu_.classList.add("shaka-no-propagation"),this.textLangMenu_.classList.add("shaka-show-controls-on-mouse-over"),this.textLangMenu_.classList.add("shaka-settings-menu"),this.backFromCaptionsButton_=Vh.createHTMLElement("button"),this.backFromCaptionsButton_.classList.add("shaka-back-to-overflow-button"),this.textLangMenu_.appendChild(this.backFromCaptionsButton_);var e=Vh.createHTMLElement("i");e.classList.add("material-icons"),e.textContent=R.MaterialDesignIcons.BACK,this.backFromCaptionsButton_.appendChild(e),this.backFromCaptionsSpan_=Vh.createHTMLElement("span"),this.backFromCaptionsButton_.appendChild(this.backFromCaptionsSpan_);var t=Vh.createHTMLElement("button");t.setAttribute("aria-selected","true"),this.textLangMenu_.appendChild(t),t.appendChild(oe.checkmarkIcon()),this.captionsOffSpan_=Vh.createHTMLElement("span"),this.captionsOffSpan_.classList.add("shaka-auto-span"),t.appendChild(this.captionsOffSpan_),this.controls.getControlsContainer().appendChild(this.textLangMenu_)}},{key:"onCaptionClick_",value:function(){this.controls.dispatchEvent(new D("submenuopen")),oe.setDisplay(this.textLangMenu_,!0),oe.focusOnTheChosenItem(this.textLangMenu_)}},{key:"onCaptionStateChange_",value:function(){this.player.isTextTrackVisible()?(this.captionIcon_.classList.add("shaka-captions-on"),this.captionIcon_.classList.remove("shaka-captions-off"),this.captionButton_.setAttribute("aria-pressed","true")):(this.captionIcon_.classList.add("shaka-captions-off"),this.captionIcon_.classList.remove("shaka-captions-on"),this.captionButton_.setAttribute("aria-pressed","false")),this.controls.dispatchEvent(new D("captionselectionupdated"))}},{key:"updateTextLanguages_",value:function(){var e=this,t=this.player.getTextTracks(),n=this.player.getTextLanguagesAndRoles().map(function(e){return e.language});xc.updateLanguages(t,this.textLangMenu_,n,function(t){return e.onTextLanguageSelected_(t)},this.player.isTextTrackVisible(),this.currentCaptions_,this.localization);var r=Vh.createHTMLElement("button");r.classList.add("shaka-turn-captions-off-button"),this.eventManager.listen(r,"click",function(){e.player.setTextTrackVisibility(!1).catch(function(){}),e.updateTextLanguages_()}),r.appendChild(this.captionsOffSpan_),this.textLangMenu_.appendChild(r),this.player.isTextTrackVisible()||(r.setAttribute("aria-selected","true"),r.appendChild(oe.checkmarkIcon()),this.captionsOffSpan_.classList.add("shaka-chosen-item"),this.currentCaptions_.textContent=this.localization.resolve(P.Ids.OFF)),oe.focusOnTheChosenItem(this.textLangMenu_),this.controls.dispatchEvent(new D("captionselectionupdated"))}},{key:"onTextLanguageSelected_",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.player.setTextTrackVisibility(!0);case 2:this.player&&this.player.selectTextLanguage(t);case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Mh(a,r,i,s,o,"next",e)}function o(e){Mh(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"updateLocalizedStrings_",value:function(){var e=P.Ids;this.captionButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.CAPTIONS)),this.backFromCaptionsButton_.setAttribute(L.ARIA_LABEL,this.localization.resolve(e.BACK)),this.captionsNameSpan_.textContent=this.localization.resolve(e.CAPTIONS),this.backFromCaptionsSpan_.textContent=this.localization.resolve(e.CAPTIONS),this.captionsOffSpan_.textContent=this.localization.resolve(e.OFF)}},{key:"onTracksChanged_",value:function(){var e=this.player.getTextTracks().length>0;oe.setDisplay(this.captionButton_,e),this.updateTextLanguages_()}}]),t}();function Hh(e){return(Hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wh(e,t,n){return t&&Gh(e.prototype,t),n&&Gh(e,n),e}function qh(e,t){return!t||"object"!==Hh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zh(e){return(zh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yh(e,t){return(Yh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}
/**
 * @license
 * Copyright 2019 Anish M Prasad
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jh.Factory=function(){function e(){Ph(this,e)}return Dh(e,[{key:"create",value:function(e,t){return new jh(e,t)}}]),e}(),wc.registerElement("captions",new jh.Factory);var Xh=c.util.Dom;window.shaka=window.shaka||{};window.shaka;window.goog=window.goog||{};window.goog;var $h=function(e){function t(e,n){var r;return Kh(this,t),(r=qh(this,zh(t).call(this,e,n))).container_=Xh.createHTMLElement("div"),r.container_.classList.add("shaka-volume-bar-container"),r.bar_=document.createElement("input"),r.bar_.classList.add("shaka-volume-bar"),r.bar_.setAttribute("type","range"),r.bar_.setAttribute("step","any"),r.bar_.setAttribute("min","0"),r.bar_.setAttribute("max","1"),r.bar_.setAttribute("value","0"),r.container_.appendChild(r.bar_),r.parent.appendChild(r.container_),r.updateAriaLabel_(),r.eventManager.listen(r.video,"volumechange",function(){r.onVolumeStateChange_()}),r.eventManager.listen(r.bar_,"input",function(){r.onVolumeInput_()}),r.eventManager.listen(r.localization,ie.LOCALE_UPDATED,function(){r.updateAriaLabel_()}),r.eventManager.listen(r.localization,ie.LOCALE_CHANGED,function(){r.updateAriaLabel_()}),r.onVolumeStateChange_(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yh(e,t)}(t,uc),Wh(t,[{key:"onVolumeStateChange_",value:function(){this.video.muted?this.bar_.value=0:this.bar_.value=this.video.volume;var e=["to right"];e.push(L.VOLUME_BAR_VOLUME_LEVEL_COLOR+100*this.bar_.value+"%"),e.push(L.VOLUME_BAR_BASE_COLOR+100*this.bar_.value+"%"),e.push(L.VOLUME_BAR_BASE_COLOR+"100%"),this.container_.style.background="linear-gradient("+e.join(",")+")"}},{key:"onVolumeInput_",value:function(){this.video.volume=parseFloat(this.bar_.value),0==this.video.volume?this.video.muted=!0:this.video.muted=!1}},{key:"updateAriaLabel_",value:function(){this.bar_.setAttribute(L.ARIA_LABEL,this.localization.resolve(P.Ids.VOLUME))}}]),t}();function Qh(e){return(Qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jh(e,t){return!t||"object"!==Qh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ef(e){return(ef=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tf(e,t){return(tf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}$h.Factory=function(){function e(){Kh(this,e)}return Wh(e,[{key:"create",value:function(e,t){return new $h(e,t)}}]),e}(),Ke.registerElement("volume",new $h.Factory);var nf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jh(this,ef(t).apply(this,arguments))}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tf(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"error-display",className:"hidden"},i.a.createElement("div",{id:"error-display-close-button"},"x"),i.a.createElement("a",{id:"error-display-link",href:"#"})),i.a.createElement("main",{className:"mdl-layout__content",id:"main-div"},i.a.createElement("div",{id:"video-bar",className:"hidden"},i.a.createElement("div",{"data-shaka-player-container":!0,"data-shaka-player-cast-receiver-id":"7B25EC44",className:"video-container"},i.a.createElement("video",{"data-shaka-player":!0,autoPlay:!0,playsInline:!0,id:"video"}))),i.a.createElement("div",{id:"contents"})))}}])&&Zh(n.prototype,a),s&&Zh(n,s),t}();function rf(e){return i.a.createElement("div",{id:"main-layout",className:"mdl-layout mdl-js-layout mdl-layout--fixed-header"},i.a.createElement("header",{className:"app-header mdl-layout__header"},i.a.createElement("header",{className:"mdl-layout__header-row",id:"nav-button-container"},i.a.createElement("button",{id:"nav-button-front",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail",defaultselected:!0},"HOME"),i.a.createElement("button",{id:"nav-button-search",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail"},"SEARCH"),i.a.createElement("button",{id:"nav-button-custom",className:"mdl-button mdl-js-button mdl-js-ripple-effect should-disable-on-fail"},"CUSTOM CONTENT"),i.a.createElement("div",{className:"mdl-layout-spacer"}),i.a.createElement("div",{id:"version-block"},i.a.createElement("span",{id:"version-string"})))),i.a.createElement("div",{className:"mdl-layout__drawer hamburger-menu"},i.a.createElement("div",{id:"hamburger-menu-title",className:"mdl-layout-title"},"Demo",i.a.createElement("div",{className:"mdl-layout-spacer"}),i.a.createElement("button",{id:"drawer-close-button",className:"mdl-button mdl-js-button mdl-button--icon should-disable-on-fail"},i.a.createElement("i",{className:"material-icons"},"close"))),i.a.createElement("nav",{className:"mdl-navigation",id:"hamburger-menu-contents"})),i.a.createElement(nf,null))}n.d(t,"default",function(){return rf})}])});